import{a as ee}from"./chunk-6RJC4GG3.js";import"./chunk-HFNTQIPJ.js";import{a as Z}from"./chunk-LUUJI5GI.js";import{b as Y}from"./chunk-CERT6F7Z.js";import{a as k}from"./chunk-LXRIBXQ3.js";import"./chunk-3KEFNAKY.js";import{a as H}from"./chunk-UVO2NCSB.js";import"./chunk-24DMSAFT.js";import"./chunk-J5MSA5AP.js";import{a as U}from"./chunk-EAERQNF5.js";import"./chunk-5EJKCVNW.js";import"./chunk-CQEFCIFT.js";import"./chunk-TT7XXVKE.js";import{k as j}from"./chunk-5NZQP5GA.js";import"./chunk-CTEOCYOX.js";import{a as W}from"./chunk-EPPWFHNT.js";import"./chunk-K64Q6LJ6.js";import{G as J}from"./chunk-ZMFSGBQT.js";import{h as Q,k as q}from"./chunk-B4HPT77T.js";import{Cb as f,Db as p,Dc as G,Ec as w,Gb as x,Hb as y,Ib as N,Jb as r,Kb as i,Lb as l,Qc as X,Rc as z,U as b,Vb as A,Xb as c,Xd as V,Za as a,_b as S,ac as m,e as P,fa as T,ic as K,jc as F,ka as u,la as M,mb as O,mc as B,oc as s,pc as d,qb as $,xa as v,ya as D}from"./chunk-S3YUDFSI.js";var ne=(o,g)=>g.track.id;function ie(o,g){if(o&1){let e=A();r(0,"tr",20),S("click",function(){let t=u(e).$implicit;return M(t.selected=!t.selected)}),r(1,"td",11),s(2),i(),r(3,"td",12),s(4),i(),r(5,"td",13),s(6),i(),r(7,"td",14),s(8),i(),r(9,"td",15),s(10),i(),r(11,"td",16),s(12),i(),r(13,"td",17),s(14),i(),r(15,"td",18),s(16),G(17,"duration"),i()()}if(o&2){let e=g.$implicit;B("selected",e.selected),a(2),d(e.track.tag==null?null:e.track.tag.trackNr),a(2),d(e.track.tag==null?null:e.track.tag.title),a(2),d(e.track.tag==null?null:e.track.tag.artist),a(2),d(e.track.tag==null?null:e.track.tag.album),a(2),d(e.track.media==null?null:e.track.media.format),a(2),d(e.track.media==null?null:e.track.media.bitRate),a(2),d(e.track.media==null?null:e.track.media.sampleRate),a(2),d(w(17,10,e.track.duration))}}function oe(o,g){if(o&1&&(r(0,"table",9)(1,"tr",10)(2,"td",11),c(3,0),i(),r(4,"td",12),c(5,1),i(),r(6,"td",13),c(7,2),i(),r(8,"td",14),c(9,3),i(),r(10,"td",15),c(11,4),i(),r(12,"td",16),c(13,5),i(),r(14,"td",17),c(15,6),i(),r(16,"td",18),c(17,7),i()(),x(18,ie,18,12,"tr",19,ne),i()),o&2){let e=m();a(18),y(e.trackItems)}}var I=(()=>{class o{constructor(){this.tracks=X([]),this.router=T(Q)}getSortValue(e,n){switch(e){case"number":return n.track.tag?.trackNr;case"name":return n.track.name;case"artist":return n.track.tag?.artist;case"album":return n.track.tag?.album;case"duration":return n.track.duration;default:return}}ngOnChanges(){this.trackItems=this.tracks().map(e=>({track:e}))}toTrackFolder(e){this.router.navigate([`/admin/folder/${e.parentID}/overview`]).catch(n=>{console.error(n)})}static{this.\u0275fac=function(n){return new(n||o)}}static{this.\u0275cmp=O({type:o,selectors:[["app-admin-track-list"]],inputs:{tracks:[1,"tracks"]},features:[v],decls:2,vars:2,consts:()=>{let e;e=$localize`:␟be498c96e976cb06e12d105d3174b0d47460886f␟8381503740832172353:Track Nr.`;let n;n=$localize`:␟fdf7cbdc140d0aab0f0b6c06065a0fd448ed6a2e␟5701618810648052610:Title`;let t;t=$localize`:␟378660a509ecaa4d2dd3b4b0b8975760cfe3576d␟2492300395471245755:Artist`;let _;_=$localize`:␟842a4fcf548e0c52ebab1cb5362f47ab2ca83e12␟1393837337557373364:Album`;let E;E=$localize`:␟7722a92a1fc887570b4f4d8a7bb916f067f32028␟7513076467032912668:Format`;let R;R=$localize`:␟1e4b5c71ea539e7ba3415dbf4b15a6b684cf892a␟3813020320794017449:BitRate`;let h;h=$localize`:␟d256d70c89c6d6a1d085e7bac659374528239056␟3186270570067508524:SampleRate`;let L;return L=$localize`:␟a02ea1d4e7424ca989929da5e598f379940fdbf2␟7410432243549869948:Duration`,[e,n,t,_,E,R,h,L,["name","Tracks",3,"list"],[1,"tracks"],[1,"track","heading"],[1,"number"],[1,"title"],[1,"artist"],[1,"album"],[1,"format"],[1,"bitrate"],[1,"samplerate"],[1,"duration"],[1,"track",3,"selected"],[1,"track",3,"click"]]},template:function(n,t){n&1&&(l(0,"app-background-text-list",8),f(1,oe,20,0,"table",9)),n&2&&(N("list",t.tracks()),a(),p(t.tracks()&&t.tracks().length>0?1:-1))},dependencies:[k,U],styles:["[_nghost-%COMP%]{width:100%;overflow:auto;display:block}[_nghost-%COMP%]   .tracks[_ngcontent-%COMP%]{padding:15px;font-size:.8em;width:100%}[_nghost-%COMP%]   .heading[_ngcontent-%COMP%]{font-size:.9em}[_nghost-%COMP%]   .track[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:5px 10px}[_nghost-%COMP%]   .track[_ngcontent-%COMP%]{border-bottom:1px solid var(--control-border)}[_nghost-%COMP%]   .track[_ngcontent-%COMP%]:hover{background-color:var(--background-hover)}[_nghost-%COMP%]   .track.selected[_ngcontent-%COMP%]{background-color:var(--background-active)}"]})}}return o})();function re(o,g){o&1&&l(0,"app-loading")}function ae(o,g){if(o&1){let e=A();r(0,"div",1)(1,"div",2)(2,"button",3),S("click",function(){u(e);let t=m();return M(t.refresh())}),l(3,"i",4),i(),r(4,"button",5),S("click",function(){u(e);let t=m();return M(t.moveTracks())}),l(5,"i",6),i(),r(6,"button",7),S("click",function(){u(e);let t=m();return M(t.deleteTracks())}),l(7,"i",8),i()(),l(8,"app-admin-track-list",9),i()}if(o&2){let e=m();a(8),N("tracks",e.folder.tracks)}}var Ee=(()=>{class o extends Z{constructor(){super(...arguments),this.tracks=z(I),this.jam=T(V),this.notify=T(J),this.folderService=T(Y),this.dialogsService=T(H),this.dialogOverlay=T(j)}ngOnInit(){super.ngOnInit(),this.folderService.foldersChange.pipe(b(this.unsubscribe)).subscribe(e=>{e.id===this.id&&this.refresh()})}ngOnDestroy(){super.ngOnDestroy()}deleteTracks(){let e=this.getTrackIDs();e.length!==0&&this.dialogsService.confirm("Remove Tracks?",`Sure to remove ${e.length} Track${e.length>1?"s":""}?`,()=>{for(let n of e)this.jam.track.remove({id:n}).then(t=>{this.folderService.waitForQueueResult("Removing Track",t,[],[],[n])}).catch(t=>{this.notify.error(t)})})}getTrackIDs(){let e=this.tracks();if(!e?.trackItems||!this.folder?.tracks)return[];let n=e.trackItems.filter(t=>t.selected).map(t=>t.track.id);return n.length>0?n:this.folder.tracks.map(t=>t.id)}moveTracks(){let e=this.getTrackIDs();if(e.length===0)return;let n={selectID:this.id};this.dialogOverlay.open({childComponent:ee,title:"Move Tracks to",data:n,panelClass:"overlay-panel-large-buttons",onOkBtn:()=>P(this,null,function*(){let t=n.folder;if(t)return this.jam.track.move({ids:e,folderID:t.id}).then(_=>{this.folderService.waitForQueueResult("Moving Tracks",_,[],[t.id,...this.folder?.parentID?[this.folder.parentID]:[]],e)}).catch(_=>{this.notify.error(_)}),Promise.resolve()}),onCancelBtn:()=>P(this,null,function*(){return Promise.resolve()})})}refresh(){this.folder=void 0,this.id&&this.jam.folder.id({id:this.id,folderIncTracks:!0,trackIncTag:!0,trackIncMedia:!0}).then(e=>{this.folder=e}).catch(e=>{this.notify.error(e)})}static{this.\u0275fac=(()=>{let e;return function(t){return(e||(e=D(o)))(t||o)}})()}static{this.\u0275cmp=O({type:o,selectors:[["app-admin-folder-tracks"]],viewQuery:function(n,t){n&1&&K(t.tracks,I,5),n&2&&F()},features:[$],decls:3,vars:3,consts:()=>{let e;e=$localize`:␟c8d1785038d461ec66b5799db21864182b35900a␟1102717806459547726:Refresh`;let n;n=$localize`:␟5599dad966c719b3feae9735c1c2555c63945d62␟5954283971273891723:Move Tracks…`;let t;return t=$localize`:␟d01e8b8bbe3093f1bfe3f7849f8856d20862aa60␟3929773193703989963:Delete Tracks…`,[["name","Tracks",3,"list"],[1,"tracks"],[1,"actions"],["title",e,1,"button-on-control",3,"click"],[1,"icon-reload"],["title",n,1,"button-on-control",3,"click"],[1,"icon-right-bold"],["title",t,1,"button-on-control",3,"click"],[1,"icon-trash"],[1,"content",3,"tracks"]]},template:function(n,t){n&1&&(f(0,re,1,0,"app-loading"),l(1,"app-background-text-list",0),f(2,ae,9,1,"div",1)),n&2&&(p(t.folder?-1:0),a(),N("list",t.folder==null?null:t.folder.tracks),a(),p(t.folder&&t.folder.tracks&&t.folder.tracks.length>0?2:-1))},dependencies:[q,I,k,W],styles:["[_nghost-%COMP%]{height:100%;width:100%;display:block;overflow:hidden}[_nghost-%COMP%]   .tracks[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;width:100%}[_nghost-%COMP%]   .tracks[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{padding:10px 15px 0;border-bottom-color:var(--background-border);border-bottom-width:1px;border-bottom-style:solid}[_nghost-%COMP%]   .tracks[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{margin-right:5px;margin-bottom:10px}[_nghost-%COMP%]   .tracks[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%] > label[_ngcontent-%COMP%]{text-transform:uppercase;letter-spacing:1px;font-size:11px;margin-left:5px;margin-right:5px}[_nghost-%COMP%]   .tracks[_ngcontent-%COMP%]   app-admin-track-list[_ngcontent-%COMP%]{overflow-y:auto}"]})}}return o})();export{Ee as AdminFolderTracksComponent};
