import{a as me,b as he,c as de,d as be}from"./chunk-33GLPMOM.js";import{b as J,c as V,d as Q}from"./chunk-55GTWUAS.js";import{b as ie}from"./chunk-FNYIAIY2.js";import{a as ye}from"./chunk-GZZSVLKI.js";import{c as pe}from"./chunk-4IQGZQCR.js";import{d as _e}from"./chunk-Q63CSAYE.js";import{a as ce,g as ue}from"./chunk-ALNDELZX.js";import{a as ge}from"./chunk-U3AJXI6D.js";import{G as le}from"./chunk-SR2DRA4F.js";import{$b as y,Db as re,Eb as se,Gb as ne,Gd as o,Hb as A,Ib as k,Jb as te,Kb as R,Lb as D,Mb as u,Qb as T,Qc as U,Rb as f,Rd as G,Sd as E,Wb as C,Wd as oe,Yb as v,_a as g,aa as ae,bc as P,e as n,fa as b,jc as B,ka as m,kc as L,la as h,nb as j,oc as $,pc as F,rc as X,sb as d}from"./chunk-MRX5UB2X.js";var Y=class{constructor(e){this.base=e,this.name=e.name,this.id=e.id}};var p=class extends Y{constructor(e,t){super(e),this.base=e,this.library=t}download(){this.library.actions.download(this.base)}onContextMenu(e,t){this.library.openJamObjectMenu(this,e,{hideGoto:t})}},x=class extends p{constructor(e,t){super(e,t),this.album=e,this.type=o.album,this.childrenTypes=[o.track],this.year=e.seriesNr?`Episode ${e.seriesNr}`:`${e.year??""}`,this.parent=e.artistName,this.mediaType=e.albumType,this.group=e.albumType,e.albumType===E.series&&Number.isNaN(e.seriesNr??"")&&(this.group=`${e.albumType} Extras`),this.genre=e.genres?.length?e.genres.map(i=>i.name).join(" / "):void 0}navigTo(){this.library.navig.toAlbum(this.album)}play(){this.library.player.startAlbum(this.album)}navigToParent(){this.library.navig.toArtistID(this.album.artistID,this.album.artistName)}toggleFav(){return n(this,null,function*(){return this.library.actions.toggleAlbumFav(this.album)})}loadChildren(){return n(this,null,function*(){if(!this.tracks)try{let e=yield this.library.jam.album.tracks({ids:[this.base.id],trackIncTag:!0,trackIncState:!0});this.tracks=e.items}catch(e){this.tracks=[],this.library.notify.error(e)}})}groupType(){return this.group}addToPlaylist(){this.library.playlistDialogsService.addAlbum(this.album)}addToQueue(){this.library.player.addAlbum(this.album)}getInfos(){return this.album.albumType===E.series?[{label:"Artist",value:this.album.artistName,click:()=>{this.navigToParent()}},{label:"Series",value:this.album.seriesID?this.album.series:void 0,click:()=>{this.library.navig.toSeriesID(this.album.seriesID??"",this.album.series??"")}},{label:"Episode",value:this.album.seriesNr}].filter(e=>e.value!==void 0):[{label:"Artist",value:this.album.artistName,click:()=>{this.navigToParent()}},{label:"Year",value:this.album.year},{label:"Genre",value:this.genre}].filter(e=>e.value!==void 0)}},M=class extends p{constructor(e,t){switch(super(e,t),this.folder=e,this.type=o.folder,this.childrenTypes=[o.track,o.folder],this.name=e.name,this.mediaType=e.type,this.genre=e.tag?.genres?.length?e.tag.genres.join(" / "):void 0,e.type){case G.artist:{this.name=e.tag?.artist??"[Unknown Artist]";break}case G.album:case G.multialbum:{this.name=e.tag?.album??"[Unknown Album]",this.parent=e.tag?.artist,this.year=e.tag?.year?`${e.tag.year}`:void 0;break}default:}}navigTo(){this.library.navig.toFolder(this.folder)}play(){this.library.player.startFolder(this.folder)}navigToParent(){this.folder.parentID&&this.library.navig.toFolderID(this.folder.parentID,"")}toggleFav(){return n(this,null,function*(){return this.library.actions.toggleFolderFav(this.folder)})}loadChildren(){return n(this,null,function*(){if(!this.tracks)try{let e=yield this.library.jam.folder.tracks({ids:[this.base.id],trackIncTag:!0,trackIncState:!0});this.tracks=e.items}catch(e){this.tracks=[],this.library.notify.error(e)}})}groupType(){return this.folder.type}addToPlaylist(){this.library.playlistDialogsService.addFolder(this.folder)}addToQueue(){this.library.player.addFolder(this.folder)}getInfos(){return(ue.includes(this.folder.type)?[{label:"Artist",value:this.folder.tag?.artist},{label:"Year",value:this.folder.tag?.year},{label:"Genre",value:this.genre}]:[]).filter(e=>e.value!==void 0)}},S=class extends p{constructor(e,t){super(e,t),this.artist=e,this.type=o.artist,this.mediaType=o.artist,this.childrenTypes=[o.album,o.series],this.name=this.artist.name,this.genre=e.genres?.length?e.genres.map(i=>i.name).join(" / "):void 0}navigTo(){this.library.navig.toArtist(this.artist)}play(){this.library.player.startArtist(this.artist)}navigToParent(){}toggleFav(){return n(this,null,function*(){return this.library.actions.toggleArtistFav(this.artist)})}loadChildren(){return n(this,null,function*(){if(!this.albums)try{let e=yield this.library.jam.artist.albums({ids:[this.base.id],albumIncState:!0});this.albums=e.items}catch(e){this.library.notify.error(e)}})}groupType(){return this.artist.albumTypes.join("/")}addToPlaylist(){this.library.playlistDialogsService.addArtist(this.artist)}addToQueue(){this.library.player.addArtist(this.artist)}getInfos(){return[{label:"Albums",value:this.artist.albumCount},{label:"Tracks",value:this.artist.trackCount},{label:"Genre",value:this.genre}].filter(e=>e.value!==void 0)}},I=class extends p{constructor(e,t){super(e,t),this.playlist=e,this.type=o.playlist,this.childrenTypes=["media"],this.name=this.playlist.name}navigTo(){this.library.navig.toPlaylist(this.playlist)}play(){this.library.player.startPlaylist(this.playlist)}navigToParent(){}toggleFav(){return n(this,null,function*(){return this.library.actions.togglePlaylistFav(this.playlist)})}onContextMenu(e,t){let i=[];this.playlist.userID===this.library.jam.auth.user?.id&&(i=[{text:"Edit Playlist",icon:"icon-edit",click:()=>{this.library.playlistDialogsService.editPlaylist(this.playlist)}},{text:"Remove Playlist",icon:"icon-remove",click:()=>{this.library.playlistDialogsService.removePlaylist(this.playlist)}}]),this.library.openJamObjectMenu(this,e,{extras:i,hideGoto:t})}loadChildren(){return n(this,null,function*(){if(!this.tracks)try{let e=yield this.library.jam.playlist.entries({ids:[this.base.id],trackIncTag:!0,trackIncState:!0,episodeIncTag:!0,episodeIncState:!0});this.media=e.items}catch(e){this.library.notify.error(e)}})}groupType(){return this.playlist.isPublic?"Public":"Private"}addToPlaylist(){this.library.playlistDialogsService.addPlaylist(this.playlist)}addToQueue(){this.library.player.addPlaylist(this.playlist)}getInfos(){return[]}},Te=class extends p{constructor(e,t){super(e,t),this.track=e,this.type=o.track,this.mediaType=o.track,this.childrenTypes=[],this.name=e.tag?.title??e.name,this.genre=e.tag?.genres?e.tag.genres.join(" / "):void 0}navigTo(){this.library.navig.toTrack(this.track)}play(){this.library.player.startTrack(this.track)}navigToParent(){}toggleFav(){return n(this,null,function*(){return this.library.actions.toggleMediaBaseFav(this.track)})}loadChildren(){return n(this,null,function*(){if(!this.tracks)try{let e=yield this.library.jam.playlist.entries({ids:[this.base.id],trackIncTag:!0,trackIncState:!0,episodeIncState:!0,episodeIncTag:!0});this.media=e.items}catch(e){this.library.notify.error(e)}})}groupType(){return this.track.tag?.genres?this.track.tag.genres.join(" / "):""}addToPlaylist(){this.library.playlistDialogsService.addTrack(this.track)}addToQueue(){this.library.player.addTrack(this.track)}getInfos(){return[{label:"Artist",value:this.track.tag?.artist,click:()=>{this.library.navig.toArtistID(this.track.artistID??"",this.track.tag?.artist??"")}},{label:"Album",value:this.track.tag?.album,click:()=>{this.library.navig.toAlbumID(this.track.albumID??"",this.track.tag?.album??"")}},{label:"Genre",value:this.genre}].filter(e=>e.value!==void 0)}},N=class extends p{constructor(e,t){super(e,t),this.genreObj=e,this.type=o.genre,this.childrenTypes=[]}navigTo(){this.library.navig.toGenre(this.genreObj)}play(){}navigToParent(){}toggleFav(){return n(this,null,function*(){return this.library.actions.toggleGenreFav(this.genreObj)})}loadChildren(){return n(this,null,function*(){})}groupType(){return""}addToPlaylist(){}addToQueue(){}getInfos(){return[]}},O=class extends p{constructor(e,t){super(e,t),this.series=e,this.type=o.series,this.mediaType=o.series,this.childrenTypes=[o.album],this.name=this.series.name,this.parent=this.series.artist}navigTo(){this.library.navig.toSeries(this.series)}play(){this.library.player.startSeries(this.series)}navigToParent(){this.library.navig.toArtistID(this.series.artistID,this.series.artist)}toggleFav(){return n(this,null,function*(){return this.library.actions.toggleSeriesFav(this.series)})}loadChildren(){return n(this,null,function*(){if(!this.albums)try{let e=yield this.library.jam.series.albums({ids:[this.base.id],albumIncState:!0});this.albums=e.items}catch(e){this.library.notify.error(e)}})}groupType(){return this.series.albumTypes.join("/")}addToPlaylist(){this.library.playlistDialogsService.addSeries(this.series)}addToQueue(){this.library.player.addSeries(this.series)}getInfos(){return[{label:"Artist",value:this.series.artist,click:()=>{this.navigToParent()}},{label:"Albums",value:this.series.albumCount},{label:"Genre",value:this.genre}].filter(e=>e.value!==void 0)}},w=class extends p{constructor(e,t){super(e,t),this.podcast=e,this.type=o.podcast,this.mediaType=o.podcast,this.childrenTypes=[o.episode],this.name=this.podcast.name}navigTo(){this.library.navig.toPodcast(this.podcast)}play(){this.library.player.startPodcast(this.podcast)}navigToParent(){}toggleFav(){return n(this,null,function*(){return this.library.actions.togglePodcastFav(this.podcast)})}onContextMenu(e,t){let i=this.library.jam.auth.user?.roles.podcast?[{text:"Refresh Podcast Feed",icon:"icon-rescan",click:()=>{this.library.podcastService.checkPodcast(this.podcast)}},{text:"Remove Podcast",icon:"icon-remove",click:()=>{this.library.podcastService.removePodcast(this.podcast)}}]:[];this.library.openJamObjectMenu(this,e,{extras:i,hideGoto:t})}loadChildren(){return n(this,null,function*(){if(!this.episodes)try{let e=yield this.library.jam.episode.search({podcastIDs:[this.base.id],episodeIncTag:!0,episodeIncState:!0,take:10});this.episodes=e.items}catch(e){this.library.notify.error(e)}})}groupType(){return""}addToPlaylist(){this.library.playlistDialogsService.addPodcast(this.podcast)}addToQueue(){this.library.player.addPodcast(this.podcast)}getInfos(){return[]}},fe=class extends p{constructor(e,t){super(e,t),this.episode=e,this.type=o.episode,this.mediaType=o.episode,this.childrenTypes=[],this.name=this.episode.name,this.parent=this.episode.podcastName}navigTo(){this.library.navig.toPodcastEpisode(this.episode)}play(){this.library.player.startEpisode(this.episode)}navigToParent(){this.library.navig.toPodcastID(this.episode.podcastID,this.episode.podcastName)}toggleFav(){return n(this,null,function*(){return this.library.actions.toggleMediaBaseFav(this.episode)})}loadChildren(){return n(this,null,function*(){})}groupType(){return this.episode.status}addToPlaylist(){this.library.playlistDialogsService.addEpisode(this.episode)}addToQueue(){this.library.player.addEpisode(this.episode)}getInfos(){return[{label:"Podcast",value:this.episode.podcastName,click:()=>{this.navigToParent()}},{label:"Played",value:this.episode.state?.played??0}]}};var Ie=["objMenu"];function Ne(r,e){r&1&&(u(0,"i",8),T(1),v(2,1),f())}function Oe(r,e){if(r&1){let t=C();d(0,Ne,3,0,"ng-template",7),y("execute",function(a){m(t);let s=P();return h(s.toLibraryObject(a.item).navigTo())})}}function we(r,e){r&1&&(u(0,"i",9),T(1),v(2,2),f())}function Pe(r,e){if(r&1&&u(0,"app-context-entry-fav",10),r&2){let t=e.item;te("base",t.base)}}function Ee(r,e){if(r&1&&u(0,"app-context-entry-rate",11),r&2){let t=e.item;te("baseType",t.type)("base",t.base)}}function je(r,e){r&1&&(u(0,"i",12),T(1),v(2,3),f())}function Ae(r,e){r&1&&(u(0,"i",13),T(1),v(2,4),f())}function ke(r,e){r&1&&(u(0,"i",14),T(1),v(2,5),f())}function Re(r,e){if(r&1&&(u(0,"i"),F(1)),r&2){let t=P().$implicit;$(t.icon),g(),X(" ",t.text)}}function De(r,e){if(r&1){let t=C();d(0,Re,2,3,"ng-template",7),y("execute",function(){let a=m(t).$implicit;return h(a.click())})}}var ve=(()=>{class r{constructor(){this.contextMenu=U.required("objMenu"),this.extras=[],this.showGoto=!0}initOpts(t){this.showGoto=!t?.hideGoto,this.extras=t?t.extras:[]}toLibraryObject(t){return t}static{this.\u0275fac=function(i){return new(i||r)}}static{this.\u0275cmp=j({type:r,selectors:[["app-context-menu-obj"]],viewQuery:function(i,a){i&1&&B(a.contextMenu,Ie,5),i&2&&L()},decls:11,vars:1,consts:()=>{let t;t=$localize`:␟bb4671d1c6b230ec821cf7f9c72210f32e8a6e7b␟5229197663852117796:Navigate to`;let i;i=$localize`:␟9b00b4b718d67ef6351bba15acd4ad0f2bc47927␟8564202903947049539:Play`;let a;a=$localize`:␟13d6506e20a7c3de5afb84bcddae391ff2a114c5␟1031630537877741580:Add To Playlist`;let s;s=$localize`:␟1dbc0611006fca3293442eb71ddf1c018a4d3a00␟5372865088552952611:Add To Queue`;let l;return l=$localize`:␟dc75033a5238fdc4f462212c847a45ba8018a3fd␟3099741642167775297:Download`,[["objMenu",""],t,i,a,s,l,["contextMenuItem",""],["contextMenuItem","",3,"execute"],[1,"icon-view-details"],[1,"icon-play"],[3,"base"],[3,"baseType","base"],[1,"icon-playlist"],[1,"icon-list-add"],[1,"icon-download-cloud"]]},template:function(i,a){if(i&1){let s=C();R(0,"context-menu",null,0),re(2,Oe,1,0,null,6),d(3,we,3,0,"ng-template",7),y("execute",function(c){return m(s),h(a.toLibraryObject(c.item).play())}),d(4,Pe,1,1,"ng-template",7),y("execute",function(c){return m(s),h(a.toLibraryObject(c.item).toggleFav())}),d(5,Ee,1,2,"ng-template",6)(6,je,3,0,"ng-template",7),y("execute",function(c){return m(s),h(a.toLibraryObject(c.item).addToPlaylist())}),d(7,Ae,3,0,"ng-template",7),y("execute",function(c){return m(s),h(a.toLibraryObject(c.item).addToQueue())}),d(8,ke,3,0,"ng-template",7),y("execute",function(c){return m(s),h(a.toLibraryObject(c.item).download())}),A(9,De,1,0,null,6,ne),D()}i&2&&(g(2),se(a.showGoto?2:-1),g(7),k(a.extras))},dependencies:[Q,V,J,me,he],encapsulation:2})}}return r})();var Be=["entriesMenu"],Le=(r,e)=>e.text;function $e(r,e){if(r&1&&(u(0,"i"),F(1)),r&2){let t=P().$implicit;$(t.icon),g(),X(" ",t.text)}}function Fe(r,e){if(r&1){let t=C();d(0,$e,2,3,"ng-template",2),y("execute",function(){let a=m(t).$implicit;return h(a.click())})}}var xe=(()=>{class r{constructor(){this.contextMenu=U.required("entriesMenu"),this.entries=[]}initOpts(t){this.entries=t.entries}static{this.\u0275fac=function(i){return new(i||r)}}static{this.\u0275cmp=j({type:r,selectors:[["app-context-menu-simple"]],viewQuery:function(i,a){i&1&&B(a.contextMenu,Be,5),i&2&&L()},decls:4,vars:0,consts:[["entriesMenu",""],["contextMenuItem",""],["contextMenuItem","",3,"execute"]],template:function(i,a){i&1&&(R(0,"context-menu",null,0),A(2,Fe,1,0,null,1,Le),D()),i&2&&(g(2),k(a.entries))},dependencies:[Q,V,J],encapsulation:2})}}return r})();var _=class{constructor(e){this.library=e}},q=class extends _{constructor(){super(...arguments),this.typeName="Albums"}search(e,t,i){return n(this,null,function*(){let a=yield this.library.jam.album.search({query:e.query,genres:e.genre?[e.genre]:void 0,genreIDs:e.genreID?[e.genreID]:void 0,skip:t,take:i,albumIncState:!0});return{list:a,items:a.items.map(s=>new x(s,this.library))}})}all(e,t){return n(this,null,function*(){let i=yield this.library.jam.album.search({skip:e,take:t,albumIncState:!0});return{list:i,items:i.items.map(a=>new x(a,this.library))}})}list(e,t,i){return n(this,null,function*(){let a=e.albumType===E.compilation?ce:void 0,s=yield this.library.jam.album.search({list:e.listType,skip:t,take:i,albumIncState:!0,albumTypes:e.albumType?[e.albumType]:void 0,mbArtistIDs:a?[a]:void 0});return{list:s,items:s.items.map(l=>new x(l,this.library))}})}},z=class extends _{constructor(){super(...arguments),this.typeName="Artists"}search(e,t,i){return n(this,null,function*(){let a=yield this.library.jam.artist.search({query:e.query,genres:e.genre?[e.genre]:void 0,genreIDs:e.genreID?[e.genreID]:void 0,skip:t,take:i,artistIncState:!0});return{list:a,items:a.items.map(s=>new S(s,this.library))}})}all(e,t){return n(this,null,function*(){let i=yield this.library.jam.artist.search({skip:e,take:t,artistIncState:!0});return{list:i,items:i.items.map(a=>new S(a,this.library))}})}list(e,t,i){return n(this,null,function*(){let a=yield this.library.jam.artist.search({list:e.listType,skip:t,take:i,artistIncState:!0,albumTypes:e.albumType?[e.albumType]:void 0});return{list:a,items:a.items.map(s=>new S(s,this.library))}})}},Z=class extends _{constructor(){super(...arguments),this.typeName="Folders"}search(e,t,i){return n(this,null,function*(){let a=yield this.library.jam.folder.search({query:e.query,genres:e.genre?[e.genre]:void 0,skip:t,take:i,folderIncTag:!0,folderIncState:!0});return{list:a,items:a.items.map(s=>new M(s,this.library))}})}all(e,t){return n(this,null,function*(){let i=yield this.library.jam.folder.search({skip:e,take:t,folderIncTag:!0,folderIncState:!0});return{list:i,items:i.items.map(a=>new M(a,this.library))}})}list(e,t,i){return n(this,null,function*(){let a=yield this.library.jam.folder.search({list:e.listType,skip:t,take:i,folderIncTag:!0,folderIncState:!0});return{list:a,items:a.items.map(s=>new M(s,this.library))}})}},H=class extends _{constructor(){super(...arguments),this.typeName="Playlists"}search(e,t,i){return n(this,null,function*(){let a=yield this.library.jam.playlist.search({query:e.query,skip:t,take:i,playlistIncState:!0});return{list:a,items:a.items.map(s=>new I(s,this.library))}})}all(e,t){return n(this,null,function*(){let i=yield this.library.jam.playlist.search({skip:e,take:t,playlistIncState:!0});return{list:i,items:i.items.map(a=>new I(a,this.library))}})}list(e,t,i){return n(this,null,function*(){let a=yield this.library.jam.playlist.search({list:e.listType,skip:t,take:i,playlistIncState:!0});return{list:a,items:a.items.map(s=>new I(s,this.library))}})}},K=class extends _{constructor(){super(...arguments),this.typeName="Genres"}search(e,t,i){return n(this,null,function*(){let a=yield this.library.jam.genre.search({query:e.query,skip:t,take:i,genreState:!0});return{list:a,items:a.items.map(s=>new N(s,this.library))}})}all(e,t){return n(this,null,function*(){let i=yield this.library.jam.genre.search({skip:e,take:t,genreState:!0});return{list:i,items:i.items.map(a=>new N(a,this.library))}})}list(e,t,i){return n(this,null,function*(){let a=yield this.library.jam.genre.search({list:e.listType,skip:t,take:i,genreState:!0});return{list:a,items:a.items.map(s=>new N(s,this.library))}})}},W=class extends _{constructor(){super(...arguments),this.typeName="Podcasts"}search(e,t,i){return n(this,null,function*(){let a=yield this.library.jam.podcast.search({query:e.query,skip:t,take:i,podcastIncState:!0});return{list:a,items:a.items.map(s=>new w(s,this.library))}})}all(e,t){return n(this,null,function*(){let i=yield this.library.jam.podcast.search({skip:e,take:t,podcastIncState:!0});return{list:i,items:i.items.map(a=>new w(a,this.library))}})}list(e,t,i){return n(this,null,function*(){let a=yield this.library.jam.podcast.search({list:e.listType,skip:t,take:i,podcastIncState:!0});return{list:a,items:a.items.map(s=>new w(s,this.library))}})}},ee=class extends _{constructor(){super(...arguments),this.typeName="Series"}search(e,t,i){return n(this,null,function*(){let a=yield this.library.jam.series.search({query:e.query,skip:t,take:i,seriesIncState:!0});return{list:a,items:a.items.map(s=>new O(s,this.library))}})}all(e,t){return n(this,null,function*(){let i=yield this.library.jam.series.search({skip:e,take:t,seriesIncState:!0});return{list:i,items:i.items.map(a=>new O(a,this.library))}})}list(e,t,i){return n(this,null,function*(){let a=yield this.library.jam.series.search({list:e.listType,skip:t,take:i,seriesIncState:!0});return{list:a,items:a.items.map(s=>new O(s,this.library))}})}};var vt=(()=>{class r{constructor(){this.actions=b(pe),this.player=b(_e),this.playlistDialogsService=b(de),this.navig=b(ge),this.jam=b(oe),this.notify=b(le),this.podcastService=b(ye),this.folderLoader=new Z(this),this.albumLoader=new q(this),this.artistLoader=new z(this),this.genreLoader=new K(this),this.playlistLoader=new H(this),this.podcastLoader=new W(this),this.seriesLoader=new ee(this),this.menuService=b(be)}buildTabs(t){let a=ie.find(s=>s.path==="library").children?.find(s=>s.path===t);return a?.children?a.children.filter(s=>!!s.data).map(s=>({label:s.data?.name??"",link:{route:`/library/${t}${s.path?"/":""}${s.path}`,exact:s.path?.length===0},click:()=>{}})):[]}buildIDTabs(t,i){let s=ie.find(l=>l.path==="library").children?.find(l=>l.path===`${t}/id/:id`);return s?.children?s.children.filter(l=>!!l.data).map(l=>({label:l.data?.name??"",link:{route:`/library/${t}/id/${i}${l.path?"/":""}${l.path}`,exact:l.path?.length===0},click:()=>{}})):[]}openJamObjectMenu(t,i,a){this.menuService.openMenuComponent(ve,t,i,a)}openSimpleMenu(t,i){this.menuService.openMenuComponent(xe,void 0,i,{entries:t})}static{this.\u0275fac=function(i){return new(i||r)}}static{this.\u0275prov=ae({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();export{x as a,M as b,S as c,I as d,Te as e,O as f,w as g,fe as h,vt as i};
