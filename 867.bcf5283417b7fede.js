"use strict";(self.webpackChunkjamberry=self.webpackChunkjamberry||[]).push([[867],{7867:(hi,ut,p)=>{p.r(ut),p.d(ut,{TagEditorModule:()=>D});var c=p(1180),wt=p(7612),C=p(6895),g=p(433),Rt=p(3926),at=p(2486),At=p(2170),dt=p(1208),gt=p(1491),rt=p(7579),K=p(2722),m=p(5861);class st{constructor(){(0,c.Z)(this,"cell",void 0)}}var j=p(1837),_=p(3689),$=p(7111);const pt=["2 Tone","2-Step Garage","4-Beat","A Cappella","Abstract","Acid","Acid Breaks","Acid House","Acid Jazz","Acid Punk","Acid Rock","Acid Techno","Acid Trance","Acousmatic Music","Acoustic","Adult Contemporary","African","African Blues","African Heavy Metal","African Hip Hop","Afro / Cosmic Disco","Afro-Cuban Jazz","Afrobeat","Aggrotech","Alternative","Alternative Country","Alternative Dance","Alternative Hip Hop","Alternative Metal","Alternative Rock","Ambient","Ambient Dub","Ambient House","American Folk Revival","Americana","Anarcho Punk","Anime","Anti-folk","Apala","Arab Pop","Art Punk","Art Rock","Asian","Asian American Jazz","Asian Underground","Atlanta Hip Hop","Audio Theatre","Audiobook","Australian Country Music","Australian Hip Hop","AustroPop","Avant-garde","Avant-garde Jazz","Avant-garde Metal","Avantgarde","Ax\xe9","Bachata","Background Music","Baila","Baithak Gana","Bakersfield sound","Balearic Beat","Balearic Trance","Ballad","Baltimore Club","Banda","Baroque","Baroque Pop","Bass","Bassline","Baul","Beat","Beat Music","Beautiful Music","Bebop","Benga","Berlin School","Bhangra","Big Band","Big Beat","Big Room","Bikutsi","BitPop","Black Metal","Blue-Eyed Soul","Bluegrass","Blues","Blues Country","Blues Rock","Blues Shouter","Bolero","Bongo Flava","Boogie","Boogie-Woogie","Booty Bass","Bossa Nova","Bounce Music","Bouncy House","Bouncy Techno","Bouyon","Brazilian","Brazilian Rock","Breakbeat","Breakbeat Hardcore","Breakcore","Breakstep","Brega","Brick City club","Brill Building","British Blues","British Dance Band","British Folk revival","British Hip Hop","BritPop","Broken Beat","Brostep","Bubblegum Dance","Bubblegum Pop","Bullerengue","C-Pop","Cabaret","Cadence-lypso","Cajun","Cajun fiddle tunes","Calypso","Canadian Blues","Canci\xf3n","Canterbury scene","Canzone","Cape Jazz","Caribbean","Celtic","Celtic Metal","Celtic Music","Celtic Punk","Cha Cha Cha","Chalga","Chamber Jazz","Chamber Music","Chanson","Chap Hop","Chicago Blues","Chicago Hip Hop","Chicago House","Chicano Rap","Chicha","Chill-out","Chillout","Chillstep","Chillwave","Chimurenga","Chinese Rock","Chiptune","Chopped & Screwed","Choro","Chorus","Christian Country Music","Christian Gangsta Rap","Christian Hip Hop","Christian Metal","Christian Pop","Christian Punk","Christian Rap","Christian Rock","Chutney","Chutney soca","Classic Country","Classic female Blues","Classic Rock","Classical","Classical crossover","Close harmony","Club","Club-House","Coldwave","Comedy","Compas","Complextro","Congolese rumba","Conscious Hip Hop","Contemporary Christian","Contemporary Folk","Contemporary R&B","Continental Jazz","Cool Jazz","Country","Country Blues","Country Pop","Country Rap","Country Rock","Country-Rap","Coup\xe9-D\xe9cal\xe9","Western Music","CowPunk","Criolla","Crossover","Crossover Jazz","Crossover Thrash","Crunk","Crunkcore","Crust Punk","Crustgrind","Cult","Cumbia","Cumbia Rap","Cybergrind","D-beat","Dance","Dance Hall","Dance-Pop","Dance-Punk","Dance-Rock","Dancehall","Dancehall Music","Dangdut","Dansband Music","Dark Ambient","Dark Cabaret","Dark Electro","Dark Wave","Darkcore","Darkcore jungle","Darkstep","Darkwave","Death 'n' roll","Death industrial","Death Metal","Death-Doom","Deathcore","DeathRock","Deep Funk","Deep House","Delta Blues","Desert Rock","Detroit Blues","Detroit Hip Hop","Detroit Techno","Digital hardcore","Disco","Disco polo","Diva House","Dixieland","Djent","Doom Metal","Doomcore","Downtempo","Dream","Dream Pop","Dream Trance","Drill","Drill & Bass","Drone Metal","Drone Music","Drum & Bass","Drum Solo","Drumstep","Dub","Dub Techno","Dubstep","Dubstyle","Dubtronica","Duet","Dunedin Sound","Dutch House","East Coast Hip Hop","Easy Listening","EBM","Eclectic","Electric Blues","Electro","Electro House","Electro Music","Electro Swing","Electro-Industrial","Electroacoustic","Electroacoustic Music","Electroclash","Electronic","Electronic Body Music","Electronic Rock","Electronica","Electronicore","ElectroPop","ElectroPunk","Elevator Music","Emo","Ethereal Wave","Ethnic","Ethnic electronica","Ethno Jazz","Euro Disco","Euro-House","Euro-Techno","Eurobeat","Eurodance","European free Jazz","EuroPop","Experimental","Experimental Hip Hop","Experimental Music","Experimental Rock","Fado","Fann at-Tanbura","Fast Fusion","Fidget House","Fijiri","Filk Music","Filmi","Flamenco","Florida Breaks","Folk","Folk Metal","Folk Pop","Folk Punk","Folk Rock","Folk-Rock","Folklore","Folktronica","Forr\xf3","Franco-Country","Freak Folk","Freakbeat","Free Funk","Free Improvisation","Free Jazz","Free Tekno","Freestyle","Freestyle Music","Freestyle Rap","French House","French Pop","Frevo","Fuji Music","Full On","Funk","Funk Carioca","Funk Metal","Funkstep","Funktronica","Funky House","Furniture Music","Fusion","Future Garage","Future House","FuturePop","G-Funk","Gabba","Game","Game Boy Music","Gamelan","Gangsta Rap","Garage","Garage House","Garage Punk","Garage Rock","Genge","Ghetto House","Ghettotech","Glam Metal","Glam Rock","Glitch","Glitch Hop","Global","Go-go","Goa","Goa Trance","Golden Age Hip Hop","Goregrind","Gospel","Gospel Blues","Gothic","Gothic Metal","Gothic Rock","Grime","Grindcore","Grindie","Groove Metal","Grunge","Grupera","Guajira","Gypsy Jazz","Gypsy Punk","Happy Hardcore","Hard Bop","Hard House","Hard NRG","Hard Rock","Hard Trance","Hardbag","Hardcore","Hardcore Rap","Hardcore Hip Hop","Hardcore Punk","Hardstep","Hardstyle","Heavy Metal","Hellbilly Music","Hi-NRG","Highlife","Hill Country Blues","Hip Hop","Hip Hop Soul","Hip House","Hip Pop","Hip Hop","Hiplife","Hokum","Hokum Blues","Honky Tonk","Horror Punk","Horrorcore","House","House Music","Houston Hip Hop","Huayno","Humour","Hyphy","IDM","Igbo highlife","Igbo Rap","Illbient","Indian Pop","Indie","Indie Folk","Indie Pop","Indie Rock","Indietronica","Industrial","Industrial Folk","Industrial Hip Hop","Industrial Metal","Industrial Music","Industrial Rock","Industro-Goth","Instrumental","Instrumental Country","Instrumental Hip Hop","Instrumental Pop","Instrumental Rock","Iranian Pop","Isicathamiya","Isolationism","Italo Dance","Italo Disco","Italo House","J-Pop","Jam Band","Jangle Pop","Japanoise","Jazz","Jazz Blues","Jazz Fusion","Jazz House","Jazz Rap","Jazz Rock","Jazz-Funk","Jazz+Funk","Jerkin'","Jersey Club","Jit","JPop","J\xf9j\xfa","Jump Blues","Jump-up","Jumpstyle","Jungle","K-Pop","Kadongo Kamu","Kansas City Blues","Kansas City Jazz","Kapuka","Keroncong","Khaliji","Kizomba","Krautrock","Kuduro","Kwaito","Kwassa Kwassa","Kwela","La\xefk\xf3","Lambada","Laptronica","Latin","Latin alternative","Latin ballad","Latin Christian","Latin House","Latin Jazz","Latin Metal","Latin Pop","Latin Rock","Latin Swing","Lavani","Leftfield","Lento Violento","Liquid Dubstep","Liquid Funk","Livetronica","Liwa","Lo-fi","Lo-Fi","Louisiana Blues","Louisiana Swamp Pop","Lounge","Lounge Music","Lovers Rock","Low Bap","Lowercase","Luk Krung","Luk Thung","Lyrical Hip Hop","M-Base","Mafioso Rap","Mainstream Jazz","M\xe1kina","Makossa","Maloya","Mambo","MandoPop","Manila Sound","Maracatu","Mariachi","Marrabenta","Math Rock","Mathcore","Mbalax","Mbaqanga","Mbube","Medieval Metal","Meditative","Melbourne Bounce","Melodic Death Metal","Melodic Metalcore","Memphis Blues","Merengue","MerenRap","M\xe9ringue","Metal","Metalcore","Mexican Pop","Mexican Son","Miami Bass","Microhouse","Middle of the road","Midwest Hip Hop","Minimal Techno","Minimal Wave","Modal Jazz","Moombahcore","Moombahton","Morlam","Morna","Mosambique","Motswako","M\xfasica Criolla","M\xfasica Popular Brasileira","M\xfasica Sertaneja","Musical","Musique Concr\xe8te","Nagoya Kei","Nashville Sound","National Folk","Native American","NDW","Ndombolo","NederPop","Neo Soul","Neo-Bop Jazz","Neo-Psychedelia","Neo-Swing","Neoclassical","Neoclassical Metal","Neofolk","Neotraditional Country","Nerdcore","Neue Deutsche Welle","NeuroFunk","Neurohop","New Age","New Beat","New jack swing","New Jersey Hip Hop","New Prog","New Rave","New Romantic","New Romanticism","New School Hip Hop","New Wave","New-age Music","Nintendocore","Nitzhonot","No wave","Noise","Noise Rock","Noisegrind","Nortec","Norte\xf1o","Northern Soul","Novelty Ragtime","Nu Jazz","Nu Metal","Nu Skool Breaks","Nu-Breakz","Nu-Disco","Nu-Funk","Nu-Gaze","Nu-NRG","Nueva canci\xf3n","Old School Hip Hop","Oldies","Opera","Operatic Pop","Orchestral Jazz","Original Pilipino Music","Other","Outlaw Country","Outsider House","P-Funk","Pagan Metal","Pagode","Paisley Underground","Palm-wine","Piedmont Blues","Pinoy Pop","Podcast","Political Hip Hop","Polka","Polsk Punk","Pop","Pop Punk","Pop Rap","Pop Rock","Pop Soul","Pop Sunda","Pop-Folk","Pop-Funk","Porn Groove","Porro","Post-Bop","Post-Disco","Post-Grunge","Post-Hardcore","Post-Metal","Post-Punk","Post-Punk Revival","Post-Rock","Power Ballad","Power Electronics","Power Metal","Power Noise","Power Pop","Powerviolence","Pranks","Primus","Progressive Bluegrass","Progressive Country","Progressive Folk","Progressive House","Progressive Metal","Progressive Pop","Progressive Rock","Progressive Trance","Protest Song","Psybient","Psychedelic","Psychedelic Folk","Psychedelic Pop","Psychedelic Rock","Psychedelic Trance","Psychobilly","Punkabilly","Psytrance","Punk","Punk Blues","Punk Jazz","Punk Rock","Punta","Punta Rock","R&B","Raga Rock","Ragga","Ragga Jungle","Raggacore","Ragini","Ragtime","Ra\xef","Ranchera","Rap","Rap Metal","Rap Music","Rap Opera","Rap Rock","Rapcore","Rara tech","Rasin","Rave","Reactionary Bluegrass","Rebetiko","Red Dirt","Reggae","Reggae Espa\xf1ol","Spanish Reggae","Reggae Fusion","Reggaestep","Reggaeton","Regional Mexican","Retro","Revival","Rhythm & Blues","Rhythmic Soul","Riot grrrl","Rock","Rock & Roll","Rock en Espa\xf1ol","Rock in Opposition","Rockabilly","Rocksteady","Rumba","Russian Pop","Sadcore","Sakara","Salsa","Salsa rom\xe1ntica","Samba","Samba Rock","Sambass","Satire","Sawt","Schlager","Screamo","Sega","Seggae","Semba","Sertanejo","Shangaan electro","Shibuya-kei","Shoegaze","Showtunes","Singer-songwriter","Ska","Ska Jazz","Ska Punk","Skate Punk","Skiffle","Skweee","Slow Jam","Slow Rock","Slowcore","Sludge Metal","Smooth Jazz","Snap Music","Soca","Soft Rock","Son","Son Cubano","Sonata","Songo","Songo-Salsa","Sophisti-Pop","Soukous","Soul","Soul Blues","Soul Jazz","Sound Clip","Soundtrack","Southern Hip Hop","Southern Rock","Southern Soul","Space","Space Age Pop","Space Disco","Space Music","Space Rock","Speech","Speed garage","Speed Metal","Speedcore","St.Louis Blues","St.Louis Hip Hop","Stoner Rock","Straight-ahead Jazz","Street Punk","Stride Jazz","Sufi Rock","SungPoetry","Sunshine Pop","Suomisaundi","Surf Pop","Surf Rock","Swamp Blues","Swing","Symphonic black Metal","Symphonic Metal","Symphonic Rock","Symphony","Synthpop","SynthPop","Synthwave","Taarab","Tango","Tech House","Tech Trance","Techdombe","Technical death Metal","Techno","Techno-Industrial","Techstep","Tecno Brega","Tecnobrega","Teen Pop","Tejano","Terror","Texas Blues","Texas Country","Thai Pop","Third stream","Thrash Metal","Thrashcore","Timba","Top 40","Trad Jazz","Traditional Country Music","Traditional Pop Music","Trailer","Trance","Trance Music","TRap","TRapstep","Tribal","Tribal House","Trip hop","Trip-Hop","Trival","Trop Rock","Tropical","Tropical House","Tropicalia","TropiPop","Truck-driving Country","Turkish Pop","Turntablism","Twin Cities Hip Hop","Twoubadou","UK Funky","UK Garage","UK Hardcore","Unblack Metal","Underground Hip Hop","Uplifting Trance","Urban Pasifika","V-Pop","Vallenato","Vaporwave","Video game Music","Viking Metal","VisPop","Visual Kei","Vocal","Vocal Jazz","Vocal Trance","War Metal","Weltmusik","West Coast Blues","West Coast Hip Hop","West Coast Jazz","Western swing","Witch House","Wonky","Wonky Pop","World Fusion","World Music","Worldbeat","Zouglou","Zouk","Zouk-Lambada","Zydeco"];var s=(()=>{return(a=s||(s={}))[a.Filename=1]="Filename",a[a.IdText=2]="IdText",a[a.IdBin=3]="IdBin",a[a.Text=4]="Text",a[a.TextList=5]="TextList",a[a.LangDescText=6]="LangDescText",a[a.PlayCounter=7]="PlayCounter",a[a.Popularimeter=8]="Popularimeter",a[a.MusicCDId=9]="MusicCDId",a[a.EventTimingCodes=10]="EventTimingCodes",a[a.SYLT=11]="SYLT",a[a.GEOB=12]="GEOB",a[a.ETCO=13]="ETCO",a[a.PCST=14]="PCST",a[a.LINK=15]="LINK",a[a.AENC=16]="AENC",a[a.Pic=17]="Pic",a[a.RVAD=18]="RVAD",a[a.RGAD=19]="RGAD",a[a.RVAD2=20]="RVAD2",a[a.CTOC=21]="CTOC",a[a.CHAP=22]="CHAP",a[a.Bool=23]="Bool",a[a.Unknown=24]="Unknown",s;var a})();const f={internal_file:{title:"Filename",versions:[2,3,4],impl:s.Filename},UFI:{title:"Unique file identifier",versions:[2],impl:s.IdText,upgrade:"UFID"},TOT:{title:"Original album/Movie/Show title",versions:[2],impl:s.Text,upgrade:"TOAL"},CDM:{title:"Compressed Data Metaframe",versions:[2],impl:s.Unknown},CRM:{title:"Encrypted meta",versions:[2],impl:s.Unknown},TT1:{title:"Content group",versions:[2],impl:s.Text,upgrade:"TIT1"},TT2:{title:"Title",versions:[2],impl:s.Text,upgrade:"TIT2"},TT3:{title:"Subtitle",versions:[2],impl:s.Text,upgrade:"TIT3"},TP1:{title:"Artist",versions:[2],impl:s.Text,upgrade:"TPE1"},TP2:{title:"Album Artist",versions:[2],impl:s.Text,upgrade:"TPE2"},TP3:{title:"Conductor",versions:[2],impl:s.Text,upgrade:"TPE3"},TP4:{title:"Remixer",versions:[2],impl:s.Text,upgrade:"TPE4"},TCM:{title:"Composer",versions:[2],impl:s.Text,upgrade:"TCOM"},TXT:{title:"Lyricist",versions:[2],impl:s.Text,upgrade:"TEXT"},TLA:{title:"Languages",versions:[2],impl:s.Text,upgrade:"TLAN"},TCO:{title:"Genre",versions:[2],impl:s.Text,upgrade:"TCON"},TAL:{title:"Album",versions:[2],impl:s.Text,upgrade:"TALB"},TPA:{title:"Part of a set",versions:[2],impl:s.Text,upgrade:"TPOS"},TRK:{title:"Track number",versions:[2],impl:s.Text,upgrade:"TRCK"},TRC:{title:"ISRC (international standard recording code)",versions:[2],impl:s.Text,upgrade:"TSRC"},TYE:{title:"Year",versions:[2],impl:s.Text,upgrade:"TYER"},TDA:{title:"Date",versions:[2],impl:s.Text,upgrade:"TDAT"},TIM:{title:"Time",versions:[2],impl:s.Text,upgrade:"TIME"},TRD:{title:"Recording dates",versions:[2],impl:s.Text,upgrade:"TRDA"},TMT:{title:"Media type",versions:[2],impl:s.Text,upgrade:"TMED"},TBP:{title:"BPM",versions:[2],impl:s.Text,upgrade:"TBPM"},TCR:{title:"Copyright message",versions:[2],impl:s.Text,upgrade:"TCOP"},TPB:{title:"Publisher",versions:[2],impl:s.Text,upgrade:"TPUB"},TEN:{title:"Encoded by",versions:[2],impl:s.Text,upgrade:"TENC"},TSS:{title:"Encoding Software/Hardware",versions:[2],impl:s.Text,upgrade:"TSSE"},TOF:{title:"Original filename",versions:[2],impl:s.Text,upgrade:"TOFN"},TLE:{title:"Length",versions:[2],impl:s.Text,upgrade:"TLEN"},TSI:{title:"Size",versions:[2],impl:s.Text,upgrade:"TSIZ"},TDY:{title:"Playlist delay",versions:[2],impl:s.Text,upgrade:"TDLY"},TKE:{title:"Initial key",versions:[2],impl:s.Text,upgrade:"TKEY"},TOL:{title:"Original lyricist",versions:[2],impl:s.Text,upgrade:"TOLY"},TOA:{title:"Original artist",versions:[2],impl:s.Text,upgrade:"TOPE"},TOR:{title:"Original release year",versions:[2],impl:s.Text,upgrade:"TORY"},TXX:{title:"User defined text",versions:[2],impl:s.IdText,upgrade:"TXXX"},WAF:{title:"Official audio file webpage",versions:[2],impl:s.Text,upgrade:"WOAF"},WAR:{title:"Official artist/performer webpage",versions:[2],impl:s.Text,upgrade:"WOAR"},WAS:{title:"Official audio source webpage",versions:[2],impl:s.Text,upgrade:"WOAS"},WCM:{title:"Commercial information",versions:[2],impl:s.Text,upgrade:"WCOM"},WCP:{title:"Copyright/Legal information",versions:[2],impl:s.Text,upgrade:"WCOP"},WPB:{title:"Publishers official webpage",versions:[2],impl:s.Text,upgrade:"WPUB"},WXX:{title:"User defined URL link frame",versions:[2],impl:s.IdText,upgrade:"WXXX"},IPL:{title:"Involved people list",versions:[2],impl:s.TextList,upgrade:"IPLS"},ETC:{title:"Event timing codes",versions:[2],impl:s.EventTimingCodes,upgrade:"ETCO"},MLL:{title:"MPEG location lookup table",versions:[2],impl:s.Unknown,upgrade:"MLLT"},STC:{title:"Synchronised tempo codes",versions:[2],impl:s.Unknown,upgrade:"SYTC"},ULT:{title:"Lyrics",versions:[2],impl:s.LangDescText,upgrade:"USLT"},SLT:{title:"Synchronised Lyrics",versions:[2],impl:s.SYLT,upgrade:"SYLT"},COM:{title:"Comments",versions:[2],impl:s.LangDescText,upgrade:"COMM"},RVA:{title:"Relative volume adjustment",versions:[2],impl:s.RVAD,upgrade:"RVAD"},EQU:{title:"Equalisation",versions:[2],impl:s.Unknown,upgrade:"EQUA"},REV:{title:"Reverb",versions:[2],impl:s.Unknown,upgrade:"RVRB"},PIC:{title:"Attached picture",versions:[2],impl:s.Pic,upgrade:"APIC"},GEO:{title:"General encapsulated object",versions:[2],impl:s.GEOB,upgrade:"GEOB"},CNT:{title:"Play counter",versions:[2],impl:s.PlayCounter,upgrade:"PCNT"},POP:{title:"Popularimeter",versions:[2],impl:s.Popularimeter,upgrade:"POPM"},BUF:{title:"Recommended buffer size",versions:[2],impl:s.Unknown,upgrade:"RBUF"},CRA:{title:"Audio encryption",versions:[2],impl:s.AENC,upgrade:"AENC"},LNK:{title:"Linked information",versions:[2],impl:s.LINK,upgrade:"LINK"},NCO:{title:"MusicMatch Binary",versions:[2],impl:s.Unknown,upgrade:"NCON"},PRI:{title:"Private frame",versions:[2],impl:s.IdBin,upgrade:"PRIV"},TCP:{title:"iTunes Compilation Flag",versions:[2],impl:s.Bool,upgrade:"TCMP"},TST:{title:"Title sort order",versions:[2],impl:s.Text,upgrade:"XSOT"},TSP:{title:"Artist sort order",versions:[2],impl:s.Text,upgrade:"XSOP"},TSA:{title:"Album sort order",versions:[2],impl:s.Text,upgrade:"XSOA"},TS2:{title:"Album Artist sort order",versions:[2],impl:s.Text,upgrade:"TSO2"},TSC:{title:"Composer sort order",versions:[2],impl:s.Text,upgrade:"TSOC"},TDR:{title:"Release time",versions:[2],impl:s.Text,upgrade:"TDRL"},TDS:{title:"iTunes podcast description",versions:[2],impl:s.Text,upgrade:"TDES"},TID:{title:"Podcast URL",versions:[2],impl:s.Text,upgrade:"TGID"},WFD:{title:"Podcast feed URL",versions:[2],impl:s.Text,upgrade:"WFED"},PCS:{title:"iTunes podcast marker",versions:[2],impl:s.PCST,upgrade:"PCST"},XSOA:{title:"Album sort order",versions:[3],impl:s.Text,upgrade:"TSOA"},XSOP:{title:"Performer sort order",versions:[3],impl:s.Text,upgrade:"TSOP"},XSOT:{title:"Title sort order",versions:[3],impl:s.Text,upgrade:"TSOT"},XDOR:{title:"Original release time",versions:[3],impl:s.Text,upgrade:"TDOR"},TIT1:{title:"Group",versions:[3,4],impl:s.Text},TIT2:{title:"Title",versions:[3,4],impl:s.Text},TIT3:{title:"Subtitle",versions:[3,4],impl:s.Text},TALB:{title:"Album",versions:[3,4],impl:s.Text},TOAL:{title:"Original album",versions:[3,4],impl:s.Text},TRCK:{title:"Track number",versions:[3,4],impl:s.Text},TPOS:{title:"Part of a set",versions:[3,4],impl:s.Text},TSRC:{title:"ISRC (international standard recording code)",versions:[3,4],impl:s.Text},TPE1:{title:"Artist",versions:[3,4],impl:s.Text},TPE2:{title:"Album Artist",versions:[3,4],impl:s.Text},TPE3:{title:"Conductor",versions:[3,4],impl:s.Text},TPE4:{title:"Remixer",versions:[3,4],impl:s.Text},TOPE:{title:"Original artist",versions:[3,4],impl:s.Text},TEXT:{title:"Lyricist",versions:[3,4],impl:s.Text},TOLY:{title:"Original lyricist",versions:[3,4],impl:s.Text},TCOM:{title:"Composer",versions:[3,4],impl:s.Text},TENC:{title:"Encoded by",versions:[3,4],impl:s.Text},TBPM:{title:"BPM",versions:[3,4],impl:s.Text},TLEN:{title:"Length",versions:[3,4],impl:s.Text},TKEY:{title:"Initial key",versions:[3,4],impl:s.Text},TLAN:{title:"Languages",versions:[3,4],impl:s.Text},TCON:{title:"Genre",versions:[3,4],impl:s.Text},TFLT:{title:"File type",versions:[3,4],impl:s.Text},TMED:{title:"Media type",versions:[3,4],impl:s.Text},TCOP:{title:"Copyright message",versions:[3,4],impl:s.Text},TPUB:{title:"Publisher",versions:[3,4],impl:s.Text},TOWN:{title:"File owner",versions:[3,4],impl:s.Text},TRSN:{title:"Internet radio station name",versions:[3,4],impl:s.Text},TRSO:{title:"Internet radio station owner",versions:[3,4],impl:s.Text},TOFN:{title:"Original filename",versions:[3,4],impl:s.Text},TDLY:{title:"Playlist delay",versions:[3,4],impl:s.Text},TSSE:{versions:[3,4],title:"Encoding Software/Hardware",impl:s.Text},TSST:{versions:[3,4],title:"Set subtitle",impl:s.Text},TDAT:{title:"Date",versions:[3],impl:s.Text},TIME:{title:"Time",versions:[3],impl:s.Text},TORY:{title:"Original release year",versions:[3],impl:s.Text},TRDA:{title:"Recording dates",versions:[3],impl:s.Text},TSIZ:{title:"Size",versions:[3],impl:s.Text},TYER:{title:"Year",versions:[3],impl:s.Text},TMCL:{versions:[4],title:"Musician credits list",impl:s.TextList},TIPL:{versions:[4],title:"Involved people list",impl:s.TextList},TMOO:{title:"Mood",versions:[4],impl:s.Text},TPRO:{title:"Produced notice",versions:[4],impl:s.Text},TDOR:{title:"Original release time",versions:[4],impl:s.Text},TDRC:{versions:[4],title:"Recording time",impl:s.Text},TDRL:{versions:[3,4],title:"Release time",impl:s.Text},TDTG:{versions:[4],title:"Tagging time",impl:s.Text},TSOA:{versions:[4],title:"Album sort order",impl:s.Text},TSOP:{versions:[4],title:"Artist sort order",impl:s.Text},TSOT:{versions:[4],title:"Title sort order",impl:s.Text},WCOM:{title:"Commercial information",versions:[3,4],impl:s.Text},WCOP:{title:"Copyright/Legal information",versions:[3,4],impl:s.Text},WOAF:{title:"Official audio file webpage",versions:[3,4],impl:s.Text},WOAR:{title:"Official artist/performer webpage",versions:[3,4],impl:s.Text},WOAS:{title:"Official audio source webpage",versions:[3,4],impl:s.Text},WORS:{title:"Official internet radio station homepage",versions:[3,4],impl:s.Text},WPAY:{title:"Payment",versions:[3,4],impl:s.Text},WPUB:{title:"Publishers official webpage",versions:[3,4],impl:s.Text},TXXX:{title:"User defined text",versions:[3,4],impl:s.IdText},WXXX:{title:"User defined URL link frame",versions:[3,4],impl:s.IdText},UFID:{title:"Unique file identifier",versions:[3,4],impl:s.IdText},MCDI:{title:"Music CD identifier",versions:[3,4],impl:s.MusicCDId},ETCO:{title:"Event timing codes",versions:[3,4],impl:s.ETCO},MLLT:{title:"MPEG location lookup table",versions:[3,4],impl:s.Unknown},SYTC:{title:"Synchronised tempo codes",versions:[3,4],impl:s.Unknown},USLT:{title:"Lyrics",versions:[3,4],impl:s.LangDescText},SYLT:{title:"Synchronised Lyrics",versions:[3,4],impl:s.SYLT},COMM:{title:"Comments",versions:[3,4],impl:s.LangDescText},RVAD:{title:"Relative volume adjustment",versions:[3,4],impl:s.RVAD},RVA2:{title:"Relative volume adjustment 2",versions:[4],impl:s.RVAD2},EQUA:{title:"Equalisation",versions:[3,4],impl:s.Unknown},RVRB:{title:"Reverb",versions:[3,4],impl:s.Unknown},APIC:{title:"Attached picture",versions:[3,4],impl:s.Pic},GEOB:{title:"General encapsulated object",versions:[3,4],impl:s.GEOB},PCNT:{title:"Play counter",versions:[3,4],impl:s.PlayCounter},POPM:{title:"Popularimeter",versions:[3,4],impl:s.Popularimeter},RBUF:{title:"Recommended buffer size",versions:[3,4],impl:s.Unknown},AENC:{title:"Audio encryption",versions:[3,4],impl:s.AENC},LINK:{title:"Linked information",versions:[3,4],impl:s.LINK},POSS:{title:"Position synchronisation",versions:[3,4],impl:s.Unknown},USER:{title:"Terms of use",versions:[3,4],impl:s.Unknown},OWNE:{title:"Ownership",versions:[3,4],impl:s.Unknown},COMR:{title:"Commercial",versions:[3,4],impl:s.Unknown},ENCR:{title:"Encryption method registration",versions:[3,4],impl:s.Unknown},GRID:{title:"Group ID registration",versions:[3,4],impl:s.Unknown},PRIV:{title:"Private frame",versions:[3,4],impl:s.IdBin},IPLS:{title:"Involved people list",versions:[3],impl:s.TextList},SIGN:{title:"Signature",versions:[4],impl:s.Unknown},SEEK:{title:"Seek",versions:[4],impl:s.Unknown},ASPI:{title:"Audio seek point index",versions:[4],impl:s.Unknown},RGAD:{title:"Replay Gain Adjustment",versions:[3,4],impl:s.RGAD},TCMP:{title:"iTunes Compilation Flag",versions:[3,4],impl:s.Bool},TSO2:{title:"Album Artist sort order",versions:[3,4],impl:s.Text},TSOC:{title:"Composer sort order",versions:[3,4],impl:s.Text},PCST:{title:"iTunes podcast marker",versions:[3,4],impl:s.PCST},TDES:{title:"iTunes podcast description",versions:[3,4],impl:s.Text},TKWD:{title:"iTunes podcast keywords",versions:[3,4],impl:s.Unknown},TGID:{title:"Podcast URL",versions:[3,4],impl:s.Text},TDEN:{title:"Encoding time",versions:[3,4],impl:s.Text},WFED:{title:"Podcast feed URL",versions:[3,4],impl:s.Text},GRP1:{title:"Group Number",versions:[3,4],impl:s.Text},NCON:{title:"MusicMatch Binary",versions:[3,4],impl:s.Unknown},CTOC:{title:"Chapter TOC",versions:[4],impl:s.CTOC},CHAP:{title:"Chapter",versions:[4],impl:s.CHAP},XHD3:{title:"mp3hd",versions:[3,4],impl:s.Unknown},CM1:{title:"User defined text",versions:[2],impl:s.Text,upgrade:"TXXX"}},V={ASIN:"ASIN Id",CATALOGNUMBER:"Catalog Nr",SCRIPT:"Script",BARCODE:"Barcode",originalyear:"Original Year",replaygain_track_gain:"Replaygain track gain",replaygain_album_gain:"Replaygain album gain",replaygain_track_peak:"Replaygain track peak",replaygain_album_peak:"Replaygain album peak",Artists:"Artists",Supplier:"Supplier","Release type":"Release type","Acoustid Id":"Acoustid Id","MusicBrainz Track Disambiguation":"MusicBrainz Track Disambiguation","MusicBrainz Album Type":"MusicBrainz Album Type","MusicBrainz Album Artist Id":"MusicBrainz Album Artist Id","MusicBrainz Artist Id":"MusicBrainz Artist Id","MusicBrainz Album Id":"MusicBrainz Album Id","MusicBrainz Release Track Id":"MusicBrainz Release Track Id","MusicBrainz Release Group Id":"MusicBrainz Release Group Id","MusicBrainz Recording Id":"MusicBrainz Recording Id","MusicBrainz Album Status":"MusicBrainz Album Status","MusicBrainz Album Release Country":"MusicBrainz Album Release Country","MusicBrainz TRM Id":"MusicBrainz TRM Id","Discogs Artist ID":"Discogs Artist Id","Discogs Label ID":"Discogs Label Id","Discogs Master Release ID":"Discogs Master Release Id","Discogs Release ID":"Discogs Master Release Id","Discogs Votes":"Discogs Votes","Discogs Rating":"Discogs Rating"},S={"http://musicbrainz.org":"MusicBrainz Track Id"},W={"http://musicbrainz.org":"MusicBrainz Track Id","":"Default Comment"},w="internal_file",B=[{id:w,width:200,force:!0},{id:"TRCK",width:60,force:!0},{id:"TIT2",width:200,force:!0},{id:"TALB",width:200,force:!0},{id:"TPE1",width:140,force:!0},{id:"TPE2",width:140,force:!0},{id:"TOPE",width:140},{id:"TCON",width:100,force:!0},{id:"TPOS",width:60,force:!0},{id:"TIT1",width:200,force:!0},{id:"GRP1",width:60,force:!0},{id:"TMOO",width:100},{id:"APIC",width:100,force:!0},{id:"USLT",width:200,force:!0},{id:"TSOP",width:140},{id:"TSO2",width:140},{id:"TXXX",subid:"Artists",width:140},{id:"IPLS",width:140},{id:"TIPL",width:140},{id:"TMCL",width:140},{id:"TYER",width:100},{id:"TDOR",width:100,force:!0},{id:"TDRC",width:100,force:!0},{id:"TDRL",width:80},{id:"TDAT",width:60},{id:"TORY",width:60},{id:"TXXX",subid:"originalyear",width:60},{id:"TXXX",subid:"MusicBrainz Album Type",width:100,force:!0},{id:"TXXX",subid:"MusicBrainz Album Status",width:60,force:!0},{id:"TXXX",subid:"MusicBrainz Album Release Country",width:60},{id:"TXXX",subid:"MusicBrainz Track Disambiguation",width:100},{id:"TXXX",subid:"Release type",width:100},{id:"TXXX",subid:"SCRIPT",width:60},{id:"TLAN",width:60},{id:"TMED",width:40},{id:"TLEN",width:60},{id:"TIME",width:60},{id:"TKEY",width:60},{id:"TBPM",width:60},{id:"APIC",width:80},{id:"TPUB",width:140},{id:"WPUB",width:140},{id:"WCOP",width:140},{id:"TCOP",width:140},{id:"TCOM",width:140},{id:"TSOC",width:140},{id:"MCDI",width:40},{id:"TXXX",subid:"Acoustid Id",width:40},{id:"TXXX",subid:"ASIN",width:100},{id:"UFID",subid:"http://musicbrainz.org",width:80},{id:"TXXX",subid:"MusicBrainz Release Track Id",width:80},{id:"TXXX",subid:"MusicBrainz Album Id",width:80},{id:"TXXX",subid:"MusicBrainz Album Artist Id",width:80},{id:"TXXX",subid:"MusicBrainz Artist Id",width:80},{id:"TXXX",subid:"MusicBrainz Release Group Id",width:80},{id:"TSSE",width:80},{id:"TFLT",width:80},{id:"TSST",width:80},{id:"TXXX",subid:"Ripping tool",width:80},{id:"TXXX",subid:"Ripping date",width:80},{id:"TDEN",width:80},{id:"TXXX",subid:"Rip date",width:80},{id:"TXXX",subid:"Source",width:80},{id:"TXXX",subid:"Supplier",width:80},{id:"TENC",width:80},{id:"TXXX",subid:"ASIN",width:110},{id:"TSRC",width:110},{id:"TXXX",subid:"BARCODE",width:110},{id:"PRIV",subid:"http://www.cdtag.com",width:100},{id:"TXXX",subid:"CATALOGNUMBER",width:110},{id:"TCMP",width:40},{id:"COMM",width:140},{id:"WXXX",width:140},{id:"GEOB",width:140}],ht={0:"Other",1:"32x32 pixels 'file icon' (PNG only)",2:"Other file icon",3:"Cover (front)",4:"Cover (back)",5:"Leaflet page",6:"Media (e.g. lable side of CD)",7:"Lead artist/lead performer/soloist",8:"Artist/performer",9:"Conductor",10:"Band/Orchestra",11:"Composer",12:"Lyricist/text writer",13:"Recording Location",14:"During recording",15:"During performance",16:"Movie/video screen capture",17:"A bright coloured fish",18:"Illustration",19:"Band/artist logotype",20:"Publisher/Studio logotype"};var b=p(1687);function mt(a){const e={};for(const n of a.cells)if(n.column.def.id!==w)for(const o of n.frames){const i=e[n.column.def.id]||[];i.push(o),e[n.column.def.id]=i}return{version:4,frames:e}}function _t(a){let e=(0,b.RQ)(a);if(e=e.filter(n=>!isNaN(Number(n))),e.length>0)return e[0]}function tt(a){const e=a.cells.find(n=>"TPOS"===n.column.def.id);return`${a.track.parentID}|${e&&e.frames.length>0?e.frames[0].value.text:""}`}function It(a,e){const n=[];let o="";if(e.frames.TPOS&&e.frames.TPOS.length>0){const r=e.frames.TPOS[0];let l=(r.value.text||"").split("/")[0];const u=(r.value.text||"").split("/")[1]||"99";if(Number(u)>1){for(;l.length<u.length;)l=`0${l}`;o+=`${l}-`}}if(e.frames.TRCK&&e.frames.TRCK.length>0){const r=e.frames.TRCK[0];let l=(r.value.text||"").split("/")[0];const u=(r.value.text||"").split("/")[1]||"99";for(;l.length<u.length;)l=`0${l}`;o+=l}n.push(o),e.frames.TIT2&&e.frames.TIT2.length>0&&n.push(e.frames.TIT2[0].value.text),e.frames.TPE1&&e.frames.TPE1.length>0&&n.push(e.frames.TPE1[0].value.text);const i=`.${(0,b.VI)(a.name)}`;return`${(0,b.kQ)(n.join(" - "),"")}${i}`}class k{constructor(e){(0,c.Z)(this,"jam",void 0),(0,c.Z)(this,"columns",[]),(0,c.Z)(this,"edits",[]),this.jam=e}removeColumnText(e,n){const o=this.columns.indexOf(e);for(const i of this.edits){const r=i.cells[o],l=r.frames.length>0?r.frames[0].value.text:void 0;l&&this.updateEditTextCell(i,e,l.replace(n,""))}}updateEditTextCell(e,n,o){const i=this.columns.indexOf(n),r=e.cells[i],l=o||"";let u=[];l.length>0&&(u=[{id:r.column.def.id,value:s.LangDescText===n.def.impl?{id:"",language:"",text:l}:{id:r.column.def.subid,text:l}}]),(0===r.frames.length||r.frames[0].value.text!==l)&&(e.cells[i]={parent:e,track:r.track,column:n,frames:u,changed:!0},e.changed=!0)}setColumnTrackNrFromFile(e){const n={};for(const o of this.edits){const i=tt(o);n[i]=(n[i]||0)+1}for(const o of this.edits){const i=_t(o.track.name);if(i){const l=`${i}/${(n[tt(o)]||0).toString()}`;this.updateEditTextCell(o,e,l)}}}setColumnFilenames(e){const n=this.columns.indexOf(e);for(const o of this.edits){const r=It(o.cells[n].track,mt(o));this.updateEditTextCell(o,e,r)}}setColumnTrackNrByIndex(e){const n={},o={};for(const i of this.edits){const r=tt(i);n[r]=(n[r]||0)+1}for(const i of this.edits){const r=tt(i);o[r]=(o[r]||0)+1;const l=`${(o[r]||0).toString()}/${(n[r]||0).toString()}`;this.updateEditTextCell(i,e,l)}}addIndexToTitleCol(e){const n=this.columns.indexOf(e);this.edits.forEach((o,i)=>{const r=o.cells[n];let l=r.frames.length>0?r.frames[0].value.text:"";l=`${l} ${(i+1).toString()}`.trim(),this.updateEditTextCell(o,e,l)})}setColumnPartOfSet(e){const n=this.columns.indexOf(e),o=[];for(const i of this.edits)o.includes(i.track.parentID)||o.push(i.track.parentID);for(const i of this.edits){const l=`${(o.indexOf(i.cells[n].track.parentID)+1).toString()}/${o.length.toString()}`;this.updateEditTextCell(i,e,l)}}setColumnTotalTrack(e){const n={};for(const i of this.edits)n[i.track.parentID]=(n[i.track.parentID]||0)+1;const o=this.columns.indexOf(e);this.edits.forEach((i,r)=>{const l=i.cells[o];let u;l.frames.length>0?(u=l.frames[0].value.text.split("/")[0],isNaN(Number(u))||(u=Number(u).toString())):u=_t(i.track.name),u||(u=(r+1).toString());const d=`${u||""}/${(n[i.track.parentID]||0).toString()}`;this.updateEditTextCell(i,e,d)})}setAlbumArtistFrames(e){const n=this.columns.findIndex(o=>"TPE1"===o.def.id);if(n>=0)for(const o of this.edits){const i=o.cells[n],r=i.frames.length>0?i.frames[0].value.text:void 0;r&&this.updateEditTextCell(o,e,r)}}setReleaseDateFromYearFrames(e){this.copyColumn(this.columns.findIndex(n=>"TYER"===n.def.id),e)}getCellText(e){return e.frames.length>0?e.frames[0].value.text:void 0}insertFromColumn(e,n,o){const i=this.columns.indexOf(o);if(e>=0)for(const r of this.edits){const l=this.getCellText(r.cells[e]),u=this.getCellText(r.cells[i])||"";if(l){const d=u.slice(0,n)+l+u.slice(n);this.updateEditTextCell(r,o,d)}}}copyColumn(e,n){if(e>=0)for(const o of this.edits){const i=o.cells[e],r=i.frames.length>0?i.frames[0].value.text:void 0;r&&this.updateEditTextCell(o,n,r)}}appendFromColumn(e,n){const o=this.columns.indexOf(n);if(e>=0)for(const i of this.edits){const r=this.getCellText(i.cells[e]);if(r){const l=this.getCellText(i.cells[o])||"";this.updateEditTextCell(i,n,l+r)}}}setColumnText(e,n){for(const o of this.edits)this.updateEditTextCell(o,e,n)}appendColumnText(e,n){const o=this.columns.indexOf(e);for(const i of this.edits){const r=this.getCellText(i.cells[o])||"";this.updateEditTextCell(i,e,r+n)}}setColumnFromTitleFrames(e){this.copyColumn(this.columns.findIndex(n=>"TIT2"===n.def.id),e)}clearColumn(e){const n=this.columns.indexOf(e);for(const o of this.edits)o.cells[n].frames.length>0&&(o.cells[n]={parent:o,track:o.cells[n].track,column:o.cells[n].column,frames:[],changed:!0},o.changed=!0)}findMissingLyrics(e=[]){var n=this;return(0,m.Z)(function*(){const o=n.findOrAddColumn(e,{frameDef:f.USLT,id:"USLT"}),i=n.findOrAddColumn(e,{frameDef:f.TPE1,id:"TPE1"}),r=n.findOrAddColumn(e,{frameDef:f.TIT2,id:"TIT2"}),l=n.columns.indexOf(o),u=n.columns.indexOf(i),d=n.columns.indexOf(r);for(const h of n.edits)if(!n.getCellText(h.cells[l])){const M=n.getCellText(h.cells[u]),O=n.getCellText(h.cells[d]);if(O&&M){const x=yield n.jam.metadata.lyricsovhSearch({title:O,artist:M});x?.data?.lyrics&&n.updateEditTextCell(h,o,x.data.lyrics)}}})()}setAudiobookFrames(e=[]){const n=this.findOrAddColumn(e,{frameDef:f.TCON,id:"TCON"}),o=this.findOrAddColumn(e,{frameDef:f.TXXX,id:"TXXX",subid:"MusicBrainz Album Type"});for(const i of this.edits)this.updateEditTextCell(i,n,"Audiobook"),this.updateEditTextCell(i,o,"album/audiobook")}setAudioSeriesFrames(e=[]){const n=this.findOrAddColumn(e,{frameDef:f.TCON,id:"TCON"}),o=this.findOrAddColumn(e,{frameDef:f.TXXX,id:"TXXX",subid:"MusicBrainz Album Type"});for(const i of this.edits)this.updateEditTextCell(i,n,"Audio Series"),this.updateEditTextCell(i,o,"album/audiodrama")}setSoundtrackFrames(e=[]){const n=this.findOrAddColumn(e,{frameDef:f.TCON,id:"TCON"}),o=this.findOrAddColumn(e,{frameDef:f.TXXX,id:"TXXX",subid:"MusicBrainz Album Type"});for(const i of this.edits)this.updateEditTextCell(i,n,"Soundtrack"),this.updateEditTextCell(i,o,"album/soundtrack")}setVariousArtistFrames(e=[]){const n=this.findOrAddColumn(e,{frameDef:f.TXXX,id:"TXXX",subid:"MusicBrainz Album Type"}),o=this.findOrAddColumn(e,{frameDef:f.TXXX,id:"TXXX",subid:"MusicBrainz Album Artist Id"}),i=this.findOrAddColumn(e,{frameDef:f.TPE2,id:"TPE2"});for(const r of this.edits)this.updateEditTextCell(r,n,"album/compilation"),this.updateEditTextCell(r,i,$.HF),this.updateEditTextCell(r,o,$.V6)}setBootlegFrames(e=[]){const n=this.findOrAddColumn(e,{frameDef:f.TXXX,id:"TXXX",subid:"MusicBrainz Album Status"}),o=this.findOrAddColumn(e,{frameDef:f.TXXX,id:"TXXX",subid:"MusicBrainz Album Type"});for(const i of this.edits)this.updateEditTextCell(i,n,"bootleg"),this.updateEditTextCell(i,o,"album/live")}build(e){this.edits=[],this.upgradeTrackTags(e),this.buildColumns(e),this.buildEdits(e)}upgradeTrackTags(e){for(const n of e)this.upgradeTrackTag(n)}upgradeTrackTag(e){const n=e.tagRaw;if(n&&void 0!==n.version&&n.version<4){let o=k.getRawTagFrames(n);const i={version:4,frames:{}},r=this.upgradeDateFramesTov24Date(o);r&&(o=o.filter(l=>!r.dateFrames.includes(l)),o.push(r.newFrame));for(const l of o){const u=this.ensureID3v2FrameVersionDef(l.id,4);u?(l.id=u,i.frames[u]=i.frames[u]||[],i.frames[u].push(l)):console.error("upgradeTrackTag","missing id3v2 update",l.id,"=>",u)}e.tagRaw=i}}ensureID3v2FrameVersionDef(e,n){const o=f[e];if(!o)return;if(o.versions.indexOf(n)>=0)return e;if(o.versions[0]>n){const l=Object.keys(f).find(d=>f[d].upgrade===e);if(!l)return void console.error(`ensureID3v2FrameVersionDef: Missing v2.${o.versions} -> v2.${n} mapping ${e}`);const u=f[l];return u.versions.indexOf(n)<0?u.versions[0]>n?this.ensureID3v2FrameVersionDef(l,n):void 0:l}if(!o.upgrade)return void console.error(`ensureID3v2FrameVersionDef: Missing v2.${o.versions} -> v2.${n} mapping ${e}`);const i=o.upgrade,r=f[i];return r.versions.indexOf(n)<0?r.versions[0]<n?this.ensureID3v2FrameVersionDef(i,n):void 0:i}upgradeDateFramesTov24Date(e){const n=e.find(u=>["TYER","TYE"].indexOf(u.id)>=0),o=e.find(u=>["TDAT","TDA"].indexOf(u.id)>=0),i=e.find(u=>["TIME","TIM"].indexOf(u.id)>=0);if(!n&&!o&&!i)return;const r=[],l=[];return n&&n.value&&Object.prototype.hasOwnProperty.call(n.value,"text")&&(r.push(n),l.push(n.value.text)),o&&o.value&&Object.prototype.hasOwnProperty.call(o.value,"text")&&(r.push(o),l.push(o.value.text)),i&&i.value&&Object.prototype.hasOwnProperty.call(i.value,"text")&&(r.push(i),l.push(i.value.text)),{newFrame:{id:"TDRC",value:{text:l.join("-")}},dateFrames:r}}findOrAddColumn(e,n){const o=this.columns.find(r=>r.def.id===n.id&&r.def.subid===n.subid);if(o)return o;const i=this.frameDef2Column(n.id,n.subid,n.frameDef,B.findIndex(r=>k.matchColumn({id:n.id,value:n.subid?{id:n.subid}:void 0},r)));return this.columns.push(i),this.buildEdits(e),i}updateColumns(e,n){const o=[],i=[];for(const r of this.columns)n.find(u=>u.id===r.def.id&&u.subid===r.def.subid)||o.push(r);for(const r of n)if(!this.columns.find(u=>u.def.id===r.id&&u.def.subid===r.subid)){const u=this.frameDef2Column(r.id,r.subid,r.frameDef,0);i.push(u)}this.columns=this.columns.filter(r=>!o.includes(r)).concat(i),this.buildEdits(e)}static getRawTagFrames(e){let n=[];return Object.keys(e.frames).forEach(o=>{n=n.concat(e.frames[o])}),n}static getFrameDefName(e,n,o){let i=o.title;const r=n||"";return o.impl===s.IdText?"TXXX"===e&&V[r]?i=V[r]:"UFID"===e&&S[r]?i=S[r]:n&&(i+=` (${n})`):o.impl===s.LangDescText?"COMM"===e&&W[r]?i=W[r]:n&&(i+=` (${n})`):o.impl===s.IdBin&&n&&(i+=` (${n})`),i}static matchColumn(e,n){return!!(!n.subid||e.value&&e.value.id&&e.value.id===n.subid)&&e.id===n.id}getAutoCompleteList(e,n){if("TCON"===e.def.id)return pt;if("TXXX"===e.def.id&&"MusicBrainz Album Type"===e.def.subid)return["album","album/compilation","album/soundtrack","album/spokenword","album/interview","album/audiobook","album/audiodrama","album/live","album/remix","album/dj-mix","album/mixtape/street","single","ep","broadcast","other","other/spokenword","other/audiodrama","other/interview"];if("TXXX"===e.def.id&&"MusicBrainz Album Status"===e.def.subid)return["official","promotional","bootleg","pseudo-release"];if("TPOS"===e.def.id)return["1/1","1/2","2/2","1/3","2/3","3/3","1/4","2/4","3/4","4/4"];const o=this.columns.indexOf(e),i=[];for(const r of this.edits){const l=r.cells[o];if(l!==n&&l.frames.length>0&&l.frames[0].value&&l.frames[0].value.text){const u=l.frames[0].value.text;i.includes(u)||i.push(u)}}return"TPE2"===e.def.id&&!i.includes($.HF)&&i.push($.HF),i}setColumnActions(e,n,o,i){const r=[];[s.IdText,s.Text,s.LangDescText].includes(i)&&(e.multi=!0,"TRCK"===n?(r.push({icon:"icon-down-thin",title:"Set Track Nr by Index",click:()=>{this.setColumnTrackNrByIndex(e)}}),r.push({icon:"icon-down-thin",title:"Set Track Nr by Filename",click:()=>{this.setColumnTrackNrFromFile(e)}}),r.push({icon:"icon-down-thin",title:"Set Total Tracks",click:()=>{this.setColumnTotalTrack(e)}})):"TPOS"===n?r.push({icon:"icon-down-thin",title:"Try find Part of Set",click:()=>{this.setColumnPartOfSet(e)}}):"TIT2"===n?r.push({icon:"icon-down-thin",title:"Add Index Nr to Title",click:()=>{this.addIndexToTitleCol(e)}}):"TPE2"===n?r.push({icon:"icon-down-thin",title:"Copy from Artist Column",click:()=>{this.setAlbumArtistFrames(e)}}):"TALB"===n?r.push({icon:"icon-down-thin",title:"Copy from Title Column",click:()=>{this.setColumnFromTitleFrames(e)}}):"TDOR"===n?r.push({icon:"icon-down-thin",title:"Copy from Year Column",click:()=>{this.setReleaseDateFromYearFrames(e)}}):"USLT"===n&&r.push({icon:"icon-down-thin",title:"Search for missing Lyrics",click:()=>{this.findMissingLyrics().catch(l=>{console.error(l)})}})),i!==s.Filename?r.push({icon:"icon-remove",title:"Clear all Cells in this Column",click:()=>{this.clearColumn(e)}}):i===s.Filename&&r.push({icon:"icon-down-thin",title:"Set Filenames by Meta Data",click:()=>{this.setColumnFilenames(e)}}),e.actions=r}frameDef2Column(e,n,o,i){const r=k.getFrameDefName(e,n,o);let l=o.impl;"UFID"===e&&S[n||""]&&(l=s.IdText);const u={def:{id:e,subid:n,name:r,width:i>=0?B[i].width:100,impl:l},sort:i>=0?i+1:-1,actions:[]};return this.setColumnActions(u,e,n,l),u.getAutoCompleteList=d=>this.getAutoCompleteList(u,d),u}frame2Column(e,n){const o={def:{id:e.id,name:e.id+(e.value&&e.value.id?` - ${e.value.id}`:""),subid:e.value&&e.value.id?e.value.id:void 0,width:n>=0?B[n].width:100,impl:s.Unknown},sort:n,actions:[]};return o.getAutoCompleteList=i=>this.getAutoCompleteList(o,i),o}buildColumns(e){this.columns=[],e&&0!==e.length&&(B.forEach((n,o)=>{if(n.force){const i=this.frameDef2Column(n.id,n.subid,f[n.id],o);this.columns.push(i)}}),e.forEach(n=>{if(!n.tagRaw||!n.tagRaw.frames)return;const o=k.getRawTagFrames(n.tagRaw);o.unshift({id:w,value:{text:n.name}});for(const i of o)if(!this.columns.find(l=>k.matchColumn(i,l.def))){const l=f[i.id],u=B.findIndex(d=>k.matchColumn(i,d));if(l){let d;i.value&&void 0!==i.value.id&&(d=i.value.id),this.columns.push(this.frameDef2Column(i.id,d,f[i.id],u))}else this.columns.push(this.frame2Column(i,u))}}))}buildEdits(e){this.columns.sort((i,r)=>i.sort<0?1:r.sort<0?-1:i.sort-r.sort);const n=(i,r,l,u,d)=>this.columns.map(h=>{const T=d?d.cells.find(M=>M.column.def.id===h.def.id&&M.column.def.subid===h.def.subid):void 0;return{parent:u,track:i,tag:r,column:h,frames:T?T.frames:l.filter(M=>k.matchColumn(M,h.def)),changed:!!T&&T.changed}}),o=this.edits||[];this.edits=e.map(i=>{let r=[];r.push({id:w,value:{text:i.name}}),i.tagRaw&&Object.keys(i.tagRaw.frames).forEach(d=>{r=r.concat(i.tagRaw?.frames[d]||[])});const l=o.find(d=>d.track===i),u={track:i,tag:i.tagRaw,cells:[],editing:!1,changed:!!l&&l.changed,saving:!1};return u.cells=n(i,i.tagRaw,r,u,l),u})}}var t=p(4650),ft=p(6377),Ct=p(7940),Tt=p(5712),vt=p(9010),Mt=p(279);function Dt(a,e){if(1&a&&(t.TgZ(0,"app-autocomplete-option-header"),t._uU(1),t.qZA()),2&a){const n=t.oxw().$implicit;t.xp6(1),t.Oqu(n.header)}}function St(a,e){if(1&a&&(t.ynx(0),t.YNc(1,Dt,2,1,"app-autocomplete-option-header",5),t.TgZ(2,"app-autocomplete-option",6),t._uU(3),t.qZA(),t.BQk()),2&a){const n=e.$implicit,o=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",n.header),t.xp6(1),t.Q6J("option",n)("control",o),t.xp6(1),t.Oqu(n.data.text)}}function Bt(a,e){1&a&&t.YNc(0,St,4,4,"ng-container",4),2&a&&t.Q6J("ngForOf",e.$implicit.options)}const Et=function(){return{allowEmpty:!0}};class R{constructor(){(0,c.Z)(this,"list",[]),(0,c.Z)(this,"focused",!1),(0,c.Z)(this,"edit",""),(0,c.Z)(this,"standalone",!1),(0,c.Z)(this,"field","text"),(0,c.Z)(this,"value",""),(0,c.Z)(this,"data",void 0),(0,c.Z)(this,"getList",void 0),(0,c.Z)(this,"onAutoComplete",void 0),(0,c.Z)(this,"valueChange",new t.vpe)}ngOnChanges(e){e.value&&e.value.currentValue&&e.value.currentValue!==this.edit&&(this.edit=e.value.currentValue)}autocompleteGetData(e){var n=this;return(0,m.Z)(function*(){return 0===e.length?n.list.map(o=>({data:o})):n.list.filter(o=>o.text.includes(e)).map(o=>({data:o}))})()}autocompleteSelectResult(e){return this.edit=e.data.text,this.edit}autocompleteEnter(e){this.edit=e}onValueChange(){this.value!==this.edit&&this.valueChange.emit(this.edit)}onFocus(){this.focused=!0,void 0===this.edit&&(this.edit=""),this.getList&&(this.list=this.getList(this.data).map(e=>({text:e})))}onBlur(){this.focused=!1,this.list=[]}}(0,c.Z)(R,"\u0275fac",function(e){return new(e||R)}),(0,c.Z)(R,"\u0275cmp",t.Xpm({type:R,selectors:[["app-tag-editor-autocomplete"]],inputs:{standalone:"standalone",field:"field",value:"value",data:"data",getList:"getList",onAutoComplete:"onAutoComplete"},outputs:{valueChange:"valueChange"},features:[t.TTD],decls:5,vars:10,consts:[["autocomplete","appAutocomplete"],["appAutocompleteContent",""],[1,"input-group"],["type","text","name","auto","autocomplete","off",3,"ngModel","value","appAutocomplete","appAutocompleteControl","appAutocompleteSettings","ngModelChange","change","focus","blur"],[4,"ngFor","ngForOf"],[4,"ngIf"],[3,"option","control"]],template:function(e,n){if(1&e&&(t.TgZ(0,"app-autocomplete",null,0),t.YNc(2,Bt,1,1,"ng-template",1),t.qZA(),t.TgZ(3,"div",2)(4,"input",3),t.NdJ("ngModelChange",function(i){return n.edit=i})("change",function(){return n.onValueChange()})("focus",function(){return n.onFocus()})("blur",function(){return n.onBlur()}),t.qZA()()),2&e){const o=t.MAs(1);t.xp6(3),t.ekj("focused",n.focused)("cell",!n.standalone),t.xp6(1),t.Q6J("ngModel",n.edit)("value",n.edit)("appAutocomplete",o)("appAutocompleteControl",n)("appAutocompleteSettings",t.DdM(9,Et))}},dependencies:[C.sg,C.O5,g.Fj,g.JJ,g.On,ft.Y,Ct.oK,Tt.G,vt.x,Mt.B],styles:["[_nghost-%COMP%]{width:100%}[_nghost-%COMP%]   .input-group[_ngcontent-%COMP%]{height:100%;width:100%}[_nghost-%COMP%]   .input-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{height:100%;width:100%;background-color:var(--input);color:var(--on-input);border-radius:3px;padding-left:3px;padding-right:3px}[_nghost-%COMP%]   .input-group.cell[_ngcontent-%COMP%]{display:block;border:none}[_nghost-%COMP%]   .input-group.cell[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding-left:0;padding-right:0;border-radius:0;border:none;color:inherit;background-color:inherit}"],changeDetection:0}));const Nt=function(){return{standalone:!0}};function Ft(a,e){if(1&a){const n=t.EpF();t.TgZ(0,"div",1)(1,"label")(2,"input",2),t.NdJ("ngModelChange",function(i){const l=t.CHM(n).$implicit;return t.KtG(l.enabled=i)}),t.qZA(),t._uU(3),t.qZA(),t.TgZ(4,"app-tag-editor-autocomplete",3),t.NdJ("valueChange",function(i){const l=t.CHM(n).$implicit;return t.KtG(l.value=i)}),t.qZA()()}if(2&a){const n=e.$implicit;t.xp6(2),t.Q6J("ngModel",n.enabled)("ngModelOptions",t.DdM(6,Nt)),t.xp6(1),t.hij(" ",n.title,""),t.xp6(1),t.Q6J("value",n.value)("getList",n.getList)("standalone",!0)}}class E{constructor(){(0,c.Z)(this,"data",void 0),(0,c.Z)(this,"edit",{title:{title:"Album Title",value:"",enabled:!0,autocomplete:[]},artist:{title:"Artist",value:"",enabled:!1,autocomplete:[]},albumArtist:{title:"Album Artist",value:"",enabled:!0,autocomplete:[]},originalReleaseTime:{title:"Original Release Time",value:"",enabled:!0,autocomplete:[]},recordingTime:{title:"Recording Time",value:"",enabled:!0,autocomplete:[]},genre:{title:"Genre",value:"",enabled:!0,autocomplete:[]},part:{title:"Part of Set",value:"",enabled:!0,autocomplete:[]},status:{title:"Album Status",value:"",enabled:!0,autocomplete:[]},type:{title:"Album Type",value:"",enabled:!0,autocomplete:[]}}),(0,c.Z)(this,"edits",Object.keys(this.edit).map(e=>{const n=this.edit[e];return n.getList=()=>this.getAutoCompleteList(n),n}))}getAutoCompleteList(e){return e.autocomplete}dialogInit(e,n){this.data=n.data}}function Gt(a,e){if(1&a){const n=t.EpF();t.TgZ(0,"div",7)(1,"div",8)(2,"label")(3,"input",9),t.NdJ("ngModelChange",function(i){const l=t.CHM(n).$implicit;return t.KtG(l.checked=i)})("change",function(){const r=t.CHM(n).$implicit,l=t.oxw();return t.KtG(l.checkChange(r))}),t.qZA(),t._uU(4),t.qZA()(),t.TgZ(5,"div",10),t._uU(6),t.qZA()()}if(2&a){const n=e.$implicit;t.xp6(3),t.Q6J("ngModel",n.checked)("checked",n.checked),t.xp6(1),t.hij(" ",n.name||n.frameDef.title," "),t.xp6(2),t.hij(" ",n.id," ")}}(0,c.Z)(E,"\u0275fac",function(e){return new(e||E)}),(0,c.Z)(E,"\u0275cmp",t.Xpm({type:E,selectors:[["app-dialog-album"]],decls:3,vars:1,consts:[["class","user-form-control",4,"ngFor","ngForOf"],[1,"user-form-control"],["type","checkbox",3,"ngModel","ngModelOptions","ngModelChange"],[3,"value","getList","standalone","valueChange"]],template:function(e,n){1&e&&(t.TgZ(0,"div")(1,"form"),t.YNc(2,Ft,5,7,"div",0),t.qZA()()),2&e&&(t.xp6(2),t.Q6J("ngForOf",n.edits))},dependencies:[C.sg,g._Y,g.Wl,g.JJ,g.JL,g.On,g.F,R],styles:["[_nghost-%COMP%]   .user-form-control[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]{width:100%}"]}));class N{constructor(){(0,c.Z)(this,"data",void 0),(0,c.Z)(this,"filteredColumns",[]),(0,c.Z)(this,"allColumns",[]),(0,c.Z)(this,"version",4),(0,c.Z)(this,"urls",{2:"http://id3.org/id3v2-00",3:"http://id3.org/id3v2.3.0",4:"http://id3.org/id3v2.4.0-frames"})}checkChange(e){this.setResult()}setResult(){this.data&&(this.data.resultColumns=this.filteredColumns.filter(e=>e.checked))}refresh(){this.filteredColumns=this.allColumns.filter(e=>e.frameDef.versions.includes(this.version)),this.setResult()}setVersion(e){this.version=e,this.refresh()}dialogInit(e,n){this.data=n.data,this.allColumns=[];const o=this.data?.columns||[];Object.keys(f).forEach(i=>{const r=function Zt(a){return"TXXX"===a?Object.keys(V).map(e=>({subid:e,name:V[e]})):"UFID"===a?Object.keys(S).map(e=>({subid:e,name:S[e]})):"COMM"===a?Object.keys(W).map(e=>({subid:e,name:W[e]})):[]}(i);if(0===r.length){const l=o.find(u=>u.def.id===i);this.allColumns.push({id:i,frameDef:f[i],column:l,checked:!!l})}else for(const l of r){const u=o.find(d=>d.def.id===i&&d.def.subid===l.subid);this.allColumns.push({id:i,subid:l.subid,name:l.name,frameDef:f[i],column:u,checked:!!u})}}),this.allColumns=this.allColumns.sort((i,r)=>(i.name||i.frameDef.title).localeCompare(r.name||r.frameDef.title)),this.refresh()}}function Jt(a,e){const n=[];if(a)for(const o of a)if(o.recordings)for(const i of o.recordings)if(i.releasegroups&&i.id)for(const r of i.releasegroups)if(r.id&&r.releases)for(const l of r.releases)if(l.id&&l.mediums)for(const u of l.mediums)n.push({releaseGroupID:r.id,releaseGroupName:r.title,releaseID:l.id,releaseName:l.title,mediaNr:u.position,mediaTrackCount:u.track_count,recordingID:i.id,recordingName:i.title,recordingDuration:i.duration,trackID:e.id,trackName:e.name,trackDuration:e.duration,score:o.score,acoustID:o.id});return n}(0,c.Z)(N,"\u0275fac",function(e){return new(e||N)}),(0,c.Z)(N,"\u0275cmp",t.Xpm({type:N,selectors:[["app-dialog-choose-columns"]],decls:19,vars:6,consts:[[1,"choose-version"],[1,"select"],["type","radio","name","release",3,"checked","click"],["target","_blank","rel","noopener",3,"href"],[1,"icon-info"],[1,"columns"],["class","column",4,"ngFor","ngForOf"],[1,"column"],[1,"title"],["type","checkbox",3,"ngModel","checked","ngModelChange","change"],[1,"id"]],template:function(e,n){1&e&&(t.TgZ(0,"form",0)(1,"fieldset")(2,"span"),t._uU(3,"ID3v2 Tag Version"),t.qZA(),t.TgZ(4,"label",1)(5,"input",2),t.NdJ("click",function(){return n.setVersion(4)}),t.qZA(),t._uU(6," 2.4"),t.qZA(),t.TgZ(7,"label",1)(8,"input",2),t.NdJ("click",function(){return n.setVersion(3)}),t.qZA(),t._uU(9," 2.3"),t.qZA(),t.TgZ(10,"label",1)(11,"input",2),t.NdJ("click",function(){return n.setVersion(2)}),t.qZA(),t._uU(12," 2.2"),t.qZA(),t._UZ(13,"br"),t.TgZ(14,"a",3),t._UZ(15,"i",4),t._uU(16),t.qZA()()(),t.TgZ(17,"div",5),t.YNc(18,Gt,7,4,"div",6),t.qZA()),2&e&&(t.xp6(5),t.Q6J("checked",4===n.version),t.xp6(3),t.Q6J("checked",3===n.version),t.xp6(3),t.Q6J("checked",2===n.version),t.xp6(3),t.Q6J("href",n.urls[n.version],t.LSH),t.xp6(2),t.hij(" ",n.urls[n.version],""),t.xp6(2),t.Q6J("ngForOf",n.filteredColumns))},dependencies:[C.sg,g._Y,g.Wl,g.JJ,g.JL,g.On,g.F],styles:["[_nghost-%COMP%]   .choose-version[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{margin-left:15px}[_nghost-%COMP%]   .choose-version[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{font-size:.8em}[_nghost-%COMP%]   .columns[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap}[_nghost-%COMP%]   .column[_ngcontent-%COMP%]{width:33%;border-top-width:1px;border-top-style:solid;border-bottom-width:0;border-bottom-style:solid;border-color:var(--control-border);padding-top:5px;padding-bottom:5px;padding-right:15px;display:flex;flex-flow:row nowrap;align-items:center;font-size:.8em}[_nghost-%COMP%]   .column[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{color:var(--on-control-hover)}[_nghost-%COMP%]   .column[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.8em;color:var(--on-control)}[_nghost-%COMP%]   .column[_ngcontent-%COMP%]   .id[_ngcontent-%COMP%]{margin-left:auto;width:80px;padding-right:15px;text-align:right;font-size:.8em}[_nghost-%COMP%]   .column[_ngcontent-%COMP%]:last-child{border-bottom-width:1px}@media (max-width: 1400px){[_nghost-%COMP%]   .column[_ngcontent-%COMP%]{width:50%}}@media (max-width: 768px){[_nghost-%COMP%]   .column[_ngcontent-%COMP%]{width:100%}}"]}));class Lt{constructor(){(0,c.Z)(this,"releasegroups",[])}add(e){let n=this.releasegroups.find(u=>u.id===e.releaseGroupID);n||(n={id:e.releaseGroupID,name:e.releaseGroupName,releases:[],score:0},this.releasegroups.push(n));let o=n.releases.find(u=>u.id===e.releaseID);o||(o={id:e.releaseID,name:e.releaseName,mediums:[],score:0},n.releases.push(o));let i=o.mediums.find(u=>u.nr===e.mediaNr);i||(i={nr:e.mediaNr,recordings:[],trackCount:e.mediaTrackCount,score:0},o.mediums.push(i));let r=i.recordings.find(u=>u.id===e.recordingID);r||(r={id:e.recordingID,name:e.recordingName,duration:e.recordingDuration,matches:[]},i.recordings.push(r));const l=r.matches.find(u=>u.trackID===e.trackID);l?l.score<e.score&&(l.score=e.score):r.matches.push({trackID:e.trackID,trackName:e.trackName,trackDuration:e.trackDuration,score:e.score,acoustID:e.acoustID})}}let P;function et(a){return a.replace(/[& \-.]/g,"").toLowerCase()}function ct(a){const e=et(a);return P||(P={},pt.forEach(n=>{P[et(n)]=n})),P[e]}function lt(a,e){const n=a.slice(0);for(const o of e){const i=n.find(r=>r.name===o.name);i?i.count+=o.count:n.push(o)}return n}function xt(a){if(!a)return[];const e=[];for(const n of a){const o=ct(n.name);if(o){const i=e.find(r=>r.name===o);i?i.count+=1:e.push({name:o,count:1})}}return e}function Ot(a){return a.replace(/[ .\-()[\]]/g,"").toLowerCase()}class Yt{constructor(e,n,o){(0,c.Z)(this,"mbTrack",void 0),(0,c.Z)(this,"index",void 0),(0,c.Z)(this,"currentMatch",void 0),(0,c.Z)(this,"matchings",[]),(0,c.Z)(this,"abData",void 0),this.mbTrack=e,this.index=o,this.matchings=this.createMatchingScores(n),this.currentMatch=this.matchings[0]}createMatchingScores(e){let n=[];return e.forEach((o,i)=>{const r={match:o,score:0,scores:this.createScores(o,i)};r.score=function Qt(a){const e=a.map(n=>[n.score*n.weight,n.weight]).reduce((n,o)=>[n[0]+o[0],n[1]+o[1]],[0,0]);return e[0]/e[1]}(r.scores),n.push(r)}),n=n.filter(o=>o.score>0).sort((o,i)=>i.score-o.score),n}createScores(e,n){const o=[];return this.scoreTitle(e,o),this.scoreTrackNr(e,o),this.scoreDuration(e,o),this.scoreAcoustid(e,o),o.push({name:"index",score:n===this.index?1:0,weight:.1}),o}scoreAcoustid(e,n){if(e.acoustidEntries&&this.mbTrack.recording?.id){const o=this.mbTrack.recording.id,i=e.acoustidEntries.find(r=>r.recordingID===o);i&&n.push({name:"acoustid",score:i.score,weight:1})}}scoreDuration(e,n){if(void 0!==this.mbTrack.length){const o=Math.abs(1e3*Math.round(e.track.duration||0)-(this.mbTrack.length||0));let i=0;0===o?i=1:o<1e3?i=.8:o<1e4&&(i=.2),n.push({name:"duration",score:i,weight:.2})}}scoreTrackNr(e,n){const o=e.track.tag?.trackNr||(0,b.Cb)(e.track.name);o>0&&n.push({name:"trackNr",score:o===this.mbTrack.position?1:0,weight:.2})}scoreTitle(e,n){const o=e.track.tag?.title||(0,b.f_)(e.track.name);if(o&&o.trim().length>0){const i=[Ot(this.mbTrack.title||this.mbTrack.recording?.title||"Unknown")];for(const l of this.mbTrack.recording?.aliases||[]){const u=Ot(l.name);i.push(u)}const r=i.map(l=>({title:l,score:(0,b.C6)(o,l)})).sort((l,u)=>u.score-l.score);r.length>0&&n.push({name:"title",score:r[0].score,weight:1})}}}class jt{constructor(e,n,o){(0,c.Z)(this,"mbMedia",void 0),(0,c.Z)(this,"tracks",[]),(0,c.Z)(this,"score",0),(0,c.Z)(this,"expanded",void 0),(0,c.Z)(this,"complete",!1),this.mbMedia=e,this.tracks=(e.tracks||[]).map((i,r)=>new Yt(i,n,o+r))}updateScore(){this.score=0,this.complete=this.tracks.length>0;for(const e of this.tracks)e.currentMatch?this.score+=e.currentMatch.score:this.complete=!1;this.tracks.length>0?this.score=this.score/this.tracks.length:this.complete=!1}}class $t{constructor(e){(0,c.Z)(this,"mbRelease",void 0),(0,c.Z)(this,"media",[]),(0,c.Z)(this,"score",0),(0,c.Z)(this,"loaded",!1),(0,c.Z)(this,"isLoading",!1),(0,c.Z)(this,"sortDate",0),(0,c.Z)(this,"totalTrack",0),(0,c.Z)(this,"expanded",void 0),(0,c.Z)(this,"complete",void 0),this.mbRelease=e,this.sortDate=function Kt(a){const e=(a||"").split("-");return new Date(e[0]?Number(e[0]):9999,e[1]?Number(e[1]):12,e[2]?Number(e[2]):31).valueOf()}(e.date),this.totalTrack=this.mbRelease.media.reduce((n,o)=>n+o.trackCount,0)}updateScore(){this.score=0,this.complete=this.media.length>0;for(const e of this.media)e.updateScore(),this.score=Math.max(e.score,this.score),e.complete||(this.complete=!1)}setLookupRelease(e,n){this.mbRelease=e,this.totalTrack=this.mbRelease.media.reduce((i,r)=>i+r.trackCount,0);let o=0;this.media=e.media.map(i=>{const r=new jt(i,n,o);return o+=i.trackCount,r}),this.cleanDuplicateMatchings(),this.updateScore()}cleanDuplicateMatchings(){const e={};for(const n of this.media)for(const o of n.tracks)o.currentMatch&&(e[o.currentMatch.match.track.id]=e[o.currentMatch.match.track.id]||[],e[o.currentMatch.match.track.id].push(o));for(const n of Object.keys(e)){let o=e[n];if(o.length>1){o=o.sort((i,r)=>(r.currentMatch?.score||0)-(i.currentMatch?.score||0)),o.shift();for(const i of o)i.currentMatch=void 0}}}}class Vt{constructor(e){(0,c.Z)(this,"mbGroup",void 0),(0,c.Z)(this,"releases",[]),(0,c.Z)(this,"score",0),(0,c.Z)(this,"expanded",void 0),(0,c.Z)(this,"selecting",void 0),(0,c.Z)(this,"currentRelease",void 0),this.mbGroup=e;for(const n of e.releases||[])this.releases.push(new $t(n));this.releases=this.releases.sort((n,o)=>n.sortDate-o.sortDate)}findRelease(e){return this.releases.find(n=>n.mbRelease.id===e)}updateScore(){for(const e of this.releases)e.updateScore();this.score=this.currentRelease?this.currentRelease.score:0}enough(e){return!(!this.currentRelease||this.currentRelease.totalTrack!==e||!this.currentRelease.complete)}}class Pt{constructor(){(0,c.Z)(this,"groups",[])}enough(e){return!!this.groups.find(n=>n.enough(e))}addReleaseGroup(e){const n=new Vt(e);return this.groups.push(n),n}findReleaseGroup(e){return this.groups.find(n=>n.mbGroup.id===e)}sort(){for(const e of this.groups)e.updateScore();this.groups=this.groups.sort((e,n)=>n.score-e.score)}}class Wt{constructor(){(0,c.Z)(this,"frameValues",{})}build(){return this.frameValues}text(e,n){return n&&(this.frameValues[e]=[{id:e,value:{text:n}}]),this}idText(e,n,o){if(o){const i={id:e,value:{id:n,text:o}},r=(this.frameValues[e]||[]).filter(l=>l.value.id!==n);this.frameValues[e]=r.concat([i])}return this}nrAndTotal(e,n,o){if(n){const i=n.toString()+(o?`/${o.toString()}`:"");this.frameValues[e]=[{id:e,value:{text:i}}]}return this}keyTextList(e,n,o){if(o){const i=this.frameValues[e]||[],r=i.length>0?i[0]:{id:e,value:{list:[]}};r.value.list.push(n),r.value.list.push(o),this.frameValues[e]=[r]}return this}bool(e,n){return void 0!==n&&(this.frameValues[e]=[{id:e,value:{bool:n}}]),this}idLangText(e,n,o,i){if(n){const r=i||"",l=(this.frameValues[e]||[]).filter(d=>d.value.id!==r);this.frameValues[e]=l.concat([{id:e,value:{id:r,language:o||"",text:n}}])}return this}addPicture(e,n,o,i,r){return this.frameValues[e]=(this.frameValues[e]||[]).concat([{id:e,value:{description:o||"",pictureType:n,bin:r,mimeType:i}}]),this}addChapter(e,n,o,i,r,l,u){return this.frameValues[e]=(this.frameValues[e]||[]).concat([{id:e,value:{id:n,start:o,end:i,offset:r,offsetEnd:l},subframes:u}]),this}}class te{constructor(){(0,c.Z)(this,"rawBuilder",new Wt)}buildFrames(){return this.rawBuilder.build()}artist(e){return this.rawBuilder.text("TPE1",e),this}artistSort(e){return this.rawBuilder.text("TSOP",e),this}albumArtist(e){return this.rawBuilder.text("TPE2",e),this}albumArtistSort(e){return this.rawBuilder.text("TSO2",e),this}album(e){return this.rawBuilder.text("TALB",e),this}albumSort(e){return this.rawBuilder.text("TSOA",e),this}originalAlbum(e){return this.rawBuilder.text("TOAL",e),this}originalArtist(e){return this.rawBuilder.text("TOPE",e),this}originalDate(e){return this.rawBuilder.text("TDOR",e),this}title(e){return this.rawBuilder.text("TIT2",e),this}work(e){return this.rawBuilder.text("TIT1",e),this}titleSort(e){return this.rawBuilder.text("TSOT",e),this}genre(e){return this.rawBuilder.text("TCON",e),this}bmp(e){return this.rawBuilder.text("TBPM",e?e.toString():void 0),this}mood(e){return this.rawBuilder.text("TMOO",e),this}media(e){return this.rawBuilder.text("TMED",e),this}language(e){return this.rawBuilder.text("TLAN",e),this}grouping(e){return this.rawBuilder.text("GRP1",e),this}date(e){return this.rawBuilder.text("TDRC",e),this}track(e,n){return this.rawBuilder.nrAndTotal("TRCK",e,n),this}disc(e,n){return this.rawBuilder.nrAndTotal("TPOS",e,n),this}year(e){return this.rawBuilder.text("TORY",e?e.toString():void 0),this}artists(e){return this.rawBuilder.idText("TXXX","Artists",e),this}isCompilation(e){return void 0!==e&&this.rawBuilder.bool("TCMP",1===e||"true"===e||!0===e),this}originalYear(e){return this.rawBuilder.text("TYER",e),this}composer(e){return this.rawBuilder.text("TCOM",e),this}composerSort(e){return this.rawBuilder.text("TSOC",e),this}remixer(e){return this.rawBuilder.text("TPE4",e),this}label(e){return this.rawBuilder.text("TPUB",e),this}subtitle(e){return this.rawBuilder.text("TIT3",e),this}discSubtitle(e){return this.rawBuilder.text("TSST",e),this}lyricist(e){return this.rawBuilder.text("TEXT",e),this}lyrics(e,n,o){return this.rawBuilder.idLangText("USLT",e,n,o),this}encoder(e){return this.rawBuilder.text("TENC",e),this}encoderSettings(e){return this.rawBuilder.text("TSSE",e),this}key(e){return this.rawBuilder.text("TKEY",e),this}copyright(e){return this.rawBuilder.text("TCOP",e),this}isrc(e){return this.rawBuilder.text("TSRC",e),this}barcode(e){return this.rawBuilder.idText("TXXX","BARCODE",e),this}asin(e){return this.rawBuilder.idText("TXXX","ASIN",e),this}catalogNumber(e){return this.rawBuilder.idText("TXXX","CATALOGNUMBER",e),this}script(e){return this.rawBuilder.idText("TXXX","SCRIPT",e),this}license(e){return this.rawBuilder.idText("TXXX","LICENSE",e),this}website(e){return this.rawBuilder.text("WOAR",e),this}movement(e){return this.rawBuilder.text("MVNM",e),this}movementNr(e,n){return this.rawBuilder.nrAndTotal("MVIN",e,n),this}writer(e){return this.rawBuilder.idText("TXXX","Writer",e),this}custom(e,n){return this.rawBuilder.idText("TXXX","VERSION",n),this}musicianCredit(e,n){return this.rawBuilder.keyTextList("TMCL",e,n),this}involved(e,n){return this.rawBuilder.keyTextList("TIPL",e,n),this}discogsArtistID(e){return this.rawBuilder.idText("TXXX","Discogs Artist ID",e),this}discogsAlbumArtistID(e){return this.rawBuilder.idText("TXXX","Discogs Album Artist ID",e),this}discogsLabelID(e){return this.rawBuilder.idText("TXXX","Discogs Label ID",e),this}discogsMasterReleaseID(e){return this.rawBuilder.idText("TXXX","Discogs Master Release ID",e),this}discogsReleaseID(e){return this.rawBuilder.idText("TXXX","Discogs Release ID",e),this}discogsVotes(e){return this.rawBuilder.idText("TXXX","Discogs Votes",e),this}discogsRating(e){return this.rawBuilder.idText("TXXX","Discogs Rating",e),this}mbAlbumStatus(e){return this.rawBuilder.idText("TXXX","MusicBrainz Album Status",e),this}mbAlbumType(e){return this.rawBuilder.idText("TXXX","MusicBrainz Album Type",e),this}mbAlbumReleaseCountry(e){return this.rawBuilder.idText("TXXX","MusicBrainz Album Release Country",e),this}mbTrackID(e){return this.rawBuilder.idText("UFID","http://musicbrainz.org",e),this}mbReleaseTrackID(e){return this.rawBuilder.idText("TXXX","MusicBrainz Release Track Id",e),this}mbAlbumID(e){return this.rawBuilder.idText("TXXX","MusicBrainz Album Id",e),this}mbOriginalAlbumID(e){return this.rawBuilder.idText("TXXX","MusicBrainz Original Album Id",e),this}mbArtistID(e){return this.rawBuilder.idText("TXXX","MusicBrainz Artist Id",e),this}mbOriginalArtistID(e){return this.rawBuilder.idText("TXXX","MusicBrainz Original Artist Id",e),this}mbAlbumArtistID(e){return this.rawBuilder.idText("TXXX","MusicBrainz Album Artist Id",e),this}mbReleaseGroupID(e){return this.rawBuilder.idText("TXXX","MusicBrainz Release Group Id",e),this}mbWorkID(e){return this.rawBuilder.idText("TXXX","MusicBrainz Work Id",e),this}mbTRMID(e){return this.rawBuilder.idText("TXXX","MusicBrainz TRM Id",e),this}mbDiscID(e){return this.rawBuilder.idText("TXXX","MusicBrainz Disc Id",e),this}acoustidID(e){return this.rawBuilder.idText("TXXX","Acoustid Id",e),this}acoustidFingerprint(e){return this.rawBuilder.idText("TXXX","Acoustid Fingerprint",e),this}musicIPPUID(e){return this.rawBuilder.idText("TXXX","MusicIP PUID",e),this}comment(e,n){return this.rawBuilder.idText("COMM",e,n),this}trackLength(e){return this.rawBuilder.text("TLEN",e?e.toString():void 0),this}mbTrackDisambiguation(e){return this.rawBuilder.idText("TXXX","MusicBrainz Track Disambiguation",e),this}addPicture(e,n,o,i){return this.rawBuilder.addPicture("APIC",e,n,o,i),this}chapter(e,n,o,i,r,l){return this.rawBuilder.addChapter("CHAP",e,n,o,i,r,l),this}}function se(a,e,n){if(!a.mbTrack)return;const o=a.mbTrack,i=a.mbRelease,r=a.mbGroup,l=a.mbMedia,u=new te;return function ne(a,e,n,o,i,r){a.mbTrackID(n.recording?.id).date(o?.date).originalDate(i?.firstReleaseDate).album(o?.title).albumSort(o?.sortName).title(n.title).media(r?.format).track(n.position,r?.trackCount).disc(r?.position,o?.media.length).trackLength(n.length).language(o?.textRepresentation.language).script(o?.textRepresentation.script).barcode(o?.barcode).isrc(n.recording?.isrcs&&n.recording.isrcs.length>0?n.recording.isrcs[0]:void 0).mbAlbumStatus(o?.status?o.status.toLowerCase():void 0).mbAlbumReleaseCountry(o?.country).mbAlbumID(o?.id).mbReleaseTrackID(n.id).mbReleaseGroupID(o?.releaseGroup.id).mbTrackDisambiguation(n.recording?.disambiguation).asin(o?.asin).discSubtitle(r?.title),n.recording?.aliases&&n.recording.aliases.length>0&&n.recording.aliases[0].sortName&&n.recording.aliases[0].sortName!==n.title&&a.titleSort(n.recording.aliases[0].sortName);const l=o?.artistCredit[0];if(l&&a.albumArtist(l.name).albumArtistSort(l.artist.sortName).mbAlbumArtistID(l.artist.id),n.artistCredit&&n.artistCredit.length>0){const d=n.artistCredit.map(T=>`${T.artist.name} ${T.joinphrase}`).join(" ").replace(/ {2}/g," ").trim(),h=n.artistCredit.map(T=>(T.artist.sortName?T.artist.sortName:"").trim()).filter(T=>T.length>0).join(" & ").replace(/ {2}/g," ").trim();a.artist(d).artistSort(h).mbArtistID(n.artistCredit[0].artist.id)}else l&&a.artist(l.name).artistSort(l.artist.sortName).mbArtistID(l.artist.id);const u=o?.labelInfo[0];u&&(u.label&&a.label(u.label.name),a.catalogNumber(u.catalogNumber))}(u,0,o,i,r,l),function ie(a,e,n,o){let i=[];o?.releaseGroup.primaryType&&i.push(o.releaseGroup.primaryType),o?.releaseGroup.secondaryTypes&&(i=i.concat(o.releaseGroup.secondaryTypes)),i.length>0&&a.mbAlbumType(i.map(r=>r.toLowerCase()).join("/")),i.includes("compilation")&&a.isCompilation(!0)}(u,0,0,i),function ee(a,e,n){if(n&&n.length>0)a.genre(n.slice(0,2).join("/"));else if(e.track.tagRaw){const o=e.track.tagRaw.frames.TCON;if(o){const i=o.map(r=>r.value.text);a.genre(i.slice(0,2).join("/"))}}}(u,a,e),function oe(a,e,n){if(n&&n.length>0)for(const o of n){let i=0;o.image.types.includes("Medium")?i=6:o.image.types.includes("Booklet")?i=5:o.image.types.includes("Front")?i=3:o.image.types.includes("Back")&&(i=4),o.base64&&a.addPicture(i,"",o.base64.mimeType,o.base64.base64)}else if(e.track.tagRaw){const o=e.track.tagRaw.frames.APIC;if(o)for(const i of o)a.addPicture(i.value.pictureType,i.value.description,i.value.mimeType,i.value.bin)}}(u,a,n),function ae(a,e){e.abdata?.moods&&e.abdata.moods.length>0&&a.mood(e.abdata.moods.join("/"))}(u,a),function re(a,e,n){if(e.acoustidEntries&&n.recording?.id){const o=e.acoustidEntries.find(i=>i.recordingID===n.recording?.id);o&&a.acoustidID(o.acoustID)}}(u,a,o),a.lyrics&&u.lyrics(a.lyrics.lyrics),{version:4,frames:u.buildFrames()}}var ce=p(2689),A=p(9291),le=p(2569);function ue(a,e){if(1&a&&t._UZ(0,"img",1),2&a){const n=t.oxw();t.Q6J("src",n.src,t.LSH)("alt",null==n.image?null:n.image.title)}}class F{constructor(){(0,c.Z)(this,"image",void 0),(0,c.Z)(this,"src",void 0)}ngOnChanges(e){this.src=void 0,this.image&&(this.src=`data:${this.image.mimeType||"image/jpeg"};base64,${this.image.base64}`)}}function de(a,e){1&a&&t._UZ(0,"i",7)}function ge(a,e){if(1&a&&(t.ynx(0),t.TgZ(1,"div",14),t._UZ(2,"app-image-base64",15),t.qZA(),t.TgZ(3,"div",16)(4,"div",17)(5,"label"),t._UZ(6,"input",18),t._uU(7),t.qZA()()(),t.BQk()),2&a){const n=t.oxw().$implicit;t.xp6(2),t.Q6J("image",n.base64),t.xp6(4),t.Q6J("checked",n.checked),t.xp6(1),t.hij(" ",n.image.types,"")}}function pe(a,e){if(1&a&&(t.TgZ(0,"div",12),t.YNc(1,ge,8,3,"ng-container",13),t.qZA()),2&a){const n=e.$implicit;t.xp6(1),t.Q6J("ngIf",n.base64)}}function he(a,e){if(1&a&&(t.TgZ(0,"div",8),t._UZ(1,"app-background-text-list",9),t.TgZ(2,"div",10),t.YNc(3,pe,2,1,"div",11),t.qZA()()),2&a){const n=t.oxw();t.xp6(1),t.Q6J("list",n.images),t.xp6(2),t.Q6J("ngForOf",n.images)}}(0,c.Z)(F,"\u0275fac",function(e){return new(e||F)}),(0,c.Z)(F,"\u0275cmp",t.Xpm({type:F,selectors:[["app-image-base64"]],inputs:{image:"image"},features:[t.TTD],decls:1,vars:1,consts:[[3,"src","alt",4,"ngIf"],[3,"src","alt"]],template:function(e,n){1&e&&t.YNc(0,ue,1,2,"img",0),2&e&&t.Q6J("ngIf",n.src)},dependencies:[C.O5],styles:["[_nghost-%COMP%]{display:block}[_nghost-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:auto}"]}));class Z{constructor(e,n,o){(0,c.Z)(this,"app",void 0),(0,c.Z)(this,"jam",void 0),(0,c.Z)(this,"notify",void 0),(0,c.Z)(this,"data",void 0),(0,c.Z)(this,"isImageSearchRunning",!1),(0,c.Z)(this,"showFrontImagesOnly",!0),(0,c.Z)(this,"images",void 0),(0,c.Z)(this,"coverArtArchive",void 0),this.app=e,this.jam=n,this.notify=o}ngOnChanges(e){this.data?this.loadCoverartImages(this.data).catch(n=>{this.notify.error(n)}):(this.images=void 0,this.coverArtArchive=void 0)}onToggleShowFrontImagesOnly(){if(!this.showFrontImagesOnly&&this.coverArtArchive)for(const e of this.coverArtArchive)!e.base64&&!e.requested&&this.getBase64Image(e).catch(n=>{console.error(n)});this.coverArtArchive&&(this.images=this.coverArtArchive.filter(e=>e.image.front||!this.showFrontImagesOnly))}getChecked(){return this.coverArtArchive?this.coverArtArchive.filter(e=>e.checked&&e.base64):[]}loadImages(e){var n=this;return(0,m.Z)(function*(){if(e.images){n.coverArtArchive=e.images.map(r=>{if(0===r.types.length&&r.types.push("Other"),r.image&&(r.image=r.image.replace("http:","https:")),r.thumbnails){const u=r.thumbnails;Object.keys(u).forEach(d=>{u[d]=u[d].replace("http:","https:")})}return{image:r,checked:!1}});const o=n.coverArtArchive.filter(r=>r.image.front||r.image.types.includes("Front")).sort((r,l)=>r.image.types.length-l.image.types.length);n.images=n.showFrontImagesOnly?o:n.coverArtArchive,n.images.forEach(r=>{n.getBase64Image(r).catch(l=>{console.error(l)})});let i=o.find(r=>1===r.image.types.length);i||(i=o[0]),i&&(i.checked=!0)}else n.images=void 0,n.coverArtArchive=[]})()}loadCoverartImages(e){var n=this;return(0,m.Z)(function*(){if(e.mbReleaseID){n.isImageSearchRunning=!0;let o=yield n.jam.metadata.coverartarchiveLookup({type:_.xB.release,mbID:e.mbReleaseID});yield n.loadImages(o.data),n.coverArtArchive&&0===n.coverArtArchive.length&&e.mbReleaseGroupID&&(n.images=void 0,n.coverArtArchive=void 0,o=yield n.jam.metadata.coverartarchiveLookup({type:_.xB.releaseGroup,mbID:e.mbReleaseGroupID}),yield n.loadImages(o.data)),n.isImageSearchRunning=!1}})()}getBase64Image(e){var n=this;return(0,m.Z)(function*(){if(e.requested)return;const o=e.image.thumbnails[500]||e.image.thumbnails.small;let i;e.requested=!0;try{i=yield n.jam.metadata.coverartarchiveImageBinary({url:o})}catch(r){console.error(r)}e.requested=!1,i?e.base64={title:o,mimeType:i.contentType,base64:(0,ce.q)(i.buffer)}:n.notify.error({error:"Invalid result from https://coverartarchive.org"})})()}}(0,c.Z)(Z,"\u0275fac",function(e){return new(e||Z)(t.Y36(A.zi),t.Y36(_.K4),t.Y36(A.c))}),(0,c.Z)(Z,"\u0275cmp",t.Xpm({type:Z,selectors:[["app-match-coverart"]],inputs:{data:"data"},features:[t.TTD],decls:9,vars:4,consts:[[1,"match-album-images"],[1,"front-only-choice"],["type","checkbox",3,"ngModel","checked","ngModelChange","change"],[1,"section"],["href","https://coverartarchive.org/","rel","noopener","target","_blank"],["class","icon-spin icon-spinner",4,"ngIf"],["class","match-images",4,"ngIf"],[1,"icon-spin","icon-spinner"],[1,"match-images"],["name","Images",3,"list"],[1,"media-cards"],["class","media-card no-hover",4,"ngFor","ngForOf"],[1,"media-card","no-hover"],[4,"ngIf"],[1,"image"],[3,"image"],[1,"footer"],[1,"footer-content"],["type","checkbox",3,"checked"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"label",1)(2,"input",2),t.NdJ("ngModelChange",function(i){return n.showFrontImagesOnly=i})("change",function(){return n.onToggleShowFrontImagesOnly()}),t.qZA(),t._uU(3," Front only "),t.qZA(),t.TgZ(4,"div",3)(5,"a",4),t._uU(6,"Coverart"),t.qZA()(),t.YNc(7,de,1,0,"i",5),t.YNc(8,he,4,2,"div",6),t.qZA()),2&e&&(t.xp6(2),t.Q6J("ngModel",n.showFrontImagesOnly)("checked",n.showFrontImagesOnly),t.xp6(5),t.Q6J("ngIf",n.isImageSearchRunning),t.xp6(1),t.Q6J("ngIf",n.images&&!n.isImageSearchRunning))},dependencies:[C.sg,C.O5,le.$,g.Wl,g.JJ,g.On,F],styles:["[_nghost-%COMP%]{padding-top:15px}[_nghost-%COMP%]   .section[_ngcontent-%COMP%]{color:var(--on-background-active);text-transform:uppercase;padding-bottom:10px;white-space:nowrap}[_nghost-%COMP%]   .section[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--on-background-active)}[_nghost-%COMP%]   .section[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:var(--on-background)}[_nghost-%COMP%]   .front-only-choice[_ngcontent-%COMP%]{float:right;font-size:.8em}[_nghost-%COMP%]   .match-images[_ngcontent-%COMP%]{min-height:200px;display:flex;flex-flow:row wrap}@media (max-width: 768px){[_nghost-%COMP%]   .match-images[_ngcontent-%COMP%]{justify-content:space-around}}[_nghost-%COMP%]   .match-images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{max-width:200px;max-height:200px}"]}));var me=p(529),bt=p(6596),kt=p(7423);function _e(a,e){if(1&a&&(t.TgZ(0,"span",1),t.ALo(1,"number"),t.O4$(),t.TgZ(2,"svg",2),t._UZ(3,"rect",3),t.qZA()()),2&a){const n=t.oxw();t.MGl("title","Score: ",t.lcZ(1,3,n.score),""),t.xp6(3),t.uIk("y",12-10*n.score)("fill",n.color)}}class G{constructor(){(0,c.Z)(this,"score",void 0),(0,c.Z)(this,"color",void 0)}getMatchColor(e){return e>.7?"green":e>.3?"yellow":"red"}ngOnChanges(e){this.color=void 0===this.score?void 0:this.getMatchColor(this.score)}}(0,c.Z)(G,"\u0275fac",function(e){return new(e||G)}),(0,c.Z)(G,"\u0275cmp",t.Xpm({type:G,selectors:[["app-score-box"]],inputs:{score:"score"},features:[t.TTD],decls:1,vars:1,consts:[[3,"title",4,"ngIf"],[3,"title"],["xmlns","http://www.w3.org/2000/svg","width","10","height","12"],["height","12","width","10"]],template:function(e,n){1&e&&t.YNc(0,_e,4,5,"span",0),2&e&&t.Q6J("ngIf",n.score)},dependencies:[C.O5,C.JJ],styles:["[_nghost-%COMP%]{width:100%;height:100%}[_nghost-%COMP%]   svg[_ngcontent-%COMP%]{overflow:hidden;vertical-align:middle;background-color:var(--background-hover);border:1px solid var(--background-border)}"]}));var fe=p(1680),Ce=p(689),Te=p(8986);const ve=["actionMenu"];function Me(a,e){1&a&&(t.TgZ(0,"a",12),t._UZ(1,"i",13),t._uU(2," Show Tracks"),t.qZA())}function xe(a,e){1&a&&(t.TgZ(0,"a",12),t._UZ(1,"i",14),t._uU(2," Show Matchings"),t.qZA())}function Oe(a,e){if(1&a&&(t.TgZ(0,"div")(1,"span",20),t._uU(2,"Moods:"),t.qZA(),t._uU(3,"\xa0"),t.TgZ(4,"span",22),t._uU(5),t.qZA()()),2&a){const n=t.oxw(2).$implicit;t.xp6(5),t.Oqu(n.abdata.moods)}}function Pe(a,e){1&a&&(t.TgZ(0,"div")(1,"span",20),t._uU(2,"Lyrics:"),t.qZA(),t._uU(3,"\xa0"),t.TgZ(4,"span",22),t._uU(5,"yes"),t.qZA()())}function be(a,e){if(1&a&&(t.TgZ(0,"div")(1,"span",20),t._uU(2,"TrackNr:"),t.qZA(),t._uU(3,"\xa0"),t.TgZ(4,"span",21),t._uU(5),t.qZA(),t._uU(6,"\xa0 "),t.TgZ(7,"span",20),t._uU(8,"Title:"),t.qZA(),t._uU(9,"\xa0"),t.TgZ(10,"span",22),t._uU(11),t.qZA(),t._uU(12,"\xa0 "),t.TgZ(13,"span",20),t._uU(14,"Artist:"),t.qZA(),t._uU(15,"\xa0"),t.TgZ(16,"span",22),t._uU(17),t.ALo(18,"mbArtistCredits"),t.qZA(),t._uU(19,"\xa0 "),t.TgZ(20,"span",20),t._uU(21,"Album:"),t.qZA(),t._uU(22,"\xa0"),t.TgZ(23,"span",22),t._uU(24),t.qZA(),t._uU(25,"\xa0 "),t.YNc(26,Oe,6,1,"div",19),t.YNc(27,Pe,6,0,"div",19),t.qZA()),2&a){const n=t.oxw().$implicit;t.xp6(5),t.Oqu(n.mbTrack.position),t.xp6(6),t.Oqu(n.mbTrack.title||"?"),t.xp6(6),t.Oqu(t.lcZ(18,6,n.mbTrack.artistCredit)),t.xp6(7),t.Oqu((null==n.mbRelease?null:n.mbRelease.title)||"?"),t.xp6(2),t.Q6J("ngIf",n.abdata),t.xp6(1),t.Q6J("ngIf",n.lyrics)}}function ke(a,e){if(1&a){const n=t.EpF();t.TgZ(0,"div",15),t.NdJ("dragstart",function(i){const l=t.CHM(n).$implicit,u=t.oxw();return t.KtG(u.drag(i,l))}),t.TgZ(1,"div",16),t._UZ(2,"span",17),t.qZA(),t.TgZ(3,"div",18),t._uU(4),t.YNc(5,be,28,8,"div",19),t.qZA()()}if(2&a){const n=e.$implicit;t.xp6(4),t.hij(" ",n.track.name," "),t.xp6(1),t.Q6J("ngIf",n.mbTrack)}}function ye(a,e){1&a&&t._UZ(0,"i",30)}function we(a,e){if(1&a){const n=t.EpF();t.TgZ(0,"label",35)(1,"input",33),t.NdJ("ngModelChange",function(i){const l=t.CHM(n).$implicit;return t.KtG(l.checked=i)}),t.qZA(),t._uU(2),t.qZA()}if(2&a){const n=e.$implicit;t.MGl("title","Usage Count: ",n.tag.count,""),t.xp6(1),t.Q6J("ngModel",n.checked),t.xp6(1),t.AsE(" ",n.tag.name," [",n.tag.count,"] ")}}function Re(a,e){if(1&a){const n=t.EpF();t.ynx(0),t.YNc(1,we,3,4,"label",31),t.TgZ(2,"label",32)(3,"input",33),t.NdJ("ngModelChange",function(i){t.CHM(n);const r=t.oxw(2);return t.KtG(r.customGenre.checked=i)}),t.qZA(),t.TgZ(4,"input",34),t.NdJ("ngModelChange",function(i){t.CHM(n);const r=t.oxw(2);return t.KtG(r.customGenre.text=i)}),t.qZA()(),t.BQk()}if(2&a){const n=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",n.genres),t.xp6(2),t.Q6J("ngModel",n.customGenre.checked),t.xp6(1),t.Q6J("ngModel",n.customGenre.text)}}function Ae(a,e){if(1&a){const n=t.EpF();t.TgZ(0,"div",23)(1,"div",24)(2,"div")(3,"div",25),t._uU(4,"Genres"),t.qZA(),t.YNc(5,ye,1,0,"i",26),t.YNc(6,Re,5,3,"ng-container",19),t.qZA(),t._UZ(7,"app-match-coverart",27),t.TgZ(8,"div",28)(9,"div",25),t._uU(10,"More"),t.qZA(),t.TgZ(11,"button",29),t.NdJ("click",function(){t.CHM(n);const i=t.oxw();return t.KtG(i.loadLyrics(i.current.group.currentRelease))}),t._uU(12,"Load Lyrics"),t.qZA(),t.TgZ(13,"button",29),t.NdJ("click",function(){t.CHM(n);const i=t.oxw();return t.KtG(i.loadMoods(i.current.group.currentRelease))}),t._uU(14,"Load AcousticBrainz Moods"),t.qZA()()()()}if(2&a){const n=t.oxw();t.xp6(5),t.Q6J("ngIf",n.isGenreSearchRunning),t.xp6(1),t.Q6J("ngIf",n.genres&&!n.isGenreSearchRunning),t.xp6(1),t.Q6J("data",n.coverArtSearch),t.xp6(4),t.ekj("disabled",!n.isRunning),t.xp6(2),t.ekj("disabled",!n.isRunning)}}function Ze(a,e){if(1&a&&(t.TgZ(0,"span",22),t._uU(1),t.qZA()),2&a){const n=t.oxw(2).$implicit;t.xp6(1),t.Oqu(n.mbGroup.artistCredit[0].name)}}function Ie(a,e){if(1&a&&(t.ynx(0),t._uU(1),t.BQk()),2&a){const n=e.$implicit;t.xp6(1),t.hij("/",n,"")}}function De(a,e){if(1&a&&(t.ynx(0),t.YNc(1,Ie,2,1,"ng-container",48),t.BQk()),2&a){const n=t.oxw(2).$implicit;t.xp6(1),t.Q6J("ngForOf",n.mbGroup.secondaryTypes)}}function Se(a,e){1&a&&t._UZ(0,"i",51)}function Be(a,e){1&a&&t._UZ(0,"i",52)}function Ee(a,e){if(1&a&&(t.ynx(0),t.TgZ(1,"span",22),t._uU(2),t.YNc(3,Se,1,0,"i",49),t.YNc(4,Be,1,0,"i",50),t.qZA(),t.BQk()),2&a){const n=e.$implicit;t.xp6(2),t.hij("",n.tracks.length," "),t.xp6(1),t.Q6J("ngIf",n.complete),t.xp6(1),t.Q6J("ngIf",!n.complete)}}function Ne(a,e){if(1&a&&(t.ynx(0),t.TgZ(1,"span",20),t._uU(2,"Total Tracks:"),t.qZA(),t.TgZ(3,"span",22),t._uU(4),t.qZA(),t.BQk()),2&a){const n=t.oxw(2).$implicit;t.xp6(4),t.Oqu(n.currentRelease.totalTrack)}}function Fe(a,e){if(1&a&&(t.TgZ(0,"div",45)(1,"span",20),t._uU(2,"Score:"),t.qZA(),t.TgZ(3,"span",22),t._UZ(4,"app-score-box",46),t.qZA(),t.TgZ(5,"span",20),t._uU(6,"Artist: "),t.qZA(),t.YNc(7,Ze,2,1,"span",47),t.TgZ(8,"span",20),t._uU(9,"Type: "),t.qZA(),t.TgZ(10,"span",22),t._uU(11),t.YNc(12,De,2,1,"ng-container",19),t.qZA(),t._UZ(13,"br"),t.TgZ(14,"span",20),t._uU(15,"Date:"),t.qZA(),t.TgZ(16,"span",22),t._uU(17),t.qZA(),t.TgZ(18,"span",20),t._uU(19,"Country:"),t.qZA(),t.TgZ(20,"span",22),t._uU(21),t.qZA(),t._UZ(22,"br"),t.TgZ(23,"span",20),t._uU(24,"Tracks:"),t.qZA(),t.YNc(25,Ee,5,3,"ng-container",48),t.YNc(26,Ne,5,1,"ng-container",19),t.qZA()),2&a){const n=t.oxw().$implicit;t.xp6(4),t.Q6J("score",n.currentRelease.score),t.xp6(3),t.Q6J("ngIf",n.mbGroup.artistCredit),t.xp6(4),t.hij("",n.mbGroup.primaryType," "),t.xp6(1),t.Q6J("ngIf",n.mbGroup.secondaryTypes),t.xp6(5),t.Oqu(n.currentRelease.mbRelease.date||"?"),t.xp6(4),t.Oqu(n.currentRelease.mbRelease.country||"?"),t.xp6(4),t.Q6J("ngForOf",n.currentRelease.media),t.xp6(1),t.Q6J("ngIf",n.currentRelease.media.length>1)}}function Ge(a,e){if(1&a){const n=t.EpF();t.TgZ(0,"button",29),t.NdJ("click",function(){t.CHM(n);const i=t.oxw().$implicit;return t.KtG(i.expanded=!i.expanded)}),t._uU(1,"Tracks"),t.qZA()}}function Je(a,e){if(1&a){const n=t.EpF();t.TgZ(0,"button",29),t.NdJ("click",function(){t.CHM(n);const i=t.oxw().$implicit;return t.KtG(i.selecting=!i.selecting)}),t._uU(1,"Releases"),t.qZA()}}const Le=function(a,e){return{"button-primary":a,"button-on-background":e}};function Xe(a,e){if(1&a){const n=t.EpF();t.TgZ(0,"button",53),t.NdJ("click",function(){t.CHM(n);const i=t.oxw().$implicit,r=t.oxw(2);return t.KtG(r.chooseRelease(i,i.currentRelease))}),t._uU(1,"Choose"),t.qZA()}if(2&a){const n=t.oxw().$implicit;t.Q6J("ngClass",t.WLB(1,Le,n.currentRelease.complete,!n.currentRelease.complete))}}function Ue(a,e){1&a&&(t.ynx(0),t._uU(1,"/"),t.BQk())}function ze(a,e){if(1&a&&(t.ynx(0),t.YNc(1,Ue,2,0,"ng-container",19),t._uU(2),t.BQk()),2&a){const n=e.$implicit,o=e.index;t.xp6(1),t.Q6J("ngIf",o>0),t.xp6(1),t.hij(" ",n.trackCount,"")}}function He(a,e){if(1&a&&(t.ynx(0),t.YNc(1,ze,3,2,"ng-container",48),t.BQk()),2&a){const n=t.oxw().$implicit;t.xp6(1),t.Q6J("ngForOf",n.mbRelease.media)}}function qe(a,e){1&a&&(t.ynx(0),t._uU(1,"?"),t.BQk())}function Qe(a,e){if(1&a){const n=t.EpF();t.TgZ(0,"label",55),t.NdJ("click",function(){const r=t.CHM(n).$implicit,l=t.oxw(2).$implicit,u=t.oxw(2);return t.KtG(u.setRelease(l,r))}),t._UZ(1,"input",56),t.TgZ(2,"span",20),t._uU(3,"Score:"),t.qZA(),t.TgZ(4,"span",22),t._UZ(5,"app-score-box",46),t.qZA(),t.TgZ(6,"span",20),t._uU(7,"Date:"),t.qZA(),t.TgZ(8,"span",22),t._uU(9),t.qZA(),t.TgZ(10,"span",20),t._uU(11,"Country:"),t.qZA(),t.TgZ(12,"span",22),t._uU(13),t.qZA(),t.TgZ(14,"span",20),t._uU(15,"Tracks:"),t.qZA(),t.TgZ(16,"span",22),t.YNc(17,He,2,1,"ng-container",19),t.YNc(18,qe,2,0,"ng-container",19),t.qZA()()}if(2&a){const n=e.$implicit,o=t.oxw(2).$implicit;t.xp6(1),t.Q6J("checked",n===o.currentRelease),t.xp6(4),t.Q6J("score",n.score),t.xp6(4),t.Oqu(n.mbRelease.date||"?"),t.xp6(4),t.Oqu(n.mbRelease.country||"?"),t.xp6(4),t.Q6J("ngIf",n.mbRelease.media),t.xp6(1),t.Q6J("ngIf",!n.mbRelease.media)}}function Ye(a,e){if(1&a&&(t.TgZ(0,"div")(1,"form")(2,"fieldset"),t.YNc(3,Qe,19,6,"label",54),t.qZA()()()),2&a){const n=t.oxw().$implicit;t.xp6(3),t.Q6J("ngForOf",n.releases)}}function Ke(a,e){1&a&&t._UZ(0,"i",51)}function je(a,e){1&a&&t._UZ(0,"i",52)}function $e(a,e){if(1&a){const n=t.EpF();t.TgZ(0,"div",59),t.NdJ("click",function(){t.CHM(n);const i=t.oxw().$implicit;return t.KtG(i.expanded=!i.expanded)}),t.TgZ(1,"i"),t.ALo(2,"stringToggle"),t.qZA(),t._uU(3),t.YNc(4,Ke,1,0,"i",49),t.YNc(5,je,1,0,"i",50),t.qZA()}if(2&a){const n=t.oxw().$implicit;t.xp6(1),t.Tol(t.Dn7(2,5,n.expanded,"icon-minus","icon-plus")),t.xp6(2),t.hij(" Media ",n.mbMedia.position," "),t.xp6(1),t.Q6J("ngIf",n.complete),t.xp6(1),t.Q6J("ngIf",!n.complete)}}function Ve(a,e){if(1&a){const n=t.EpF();t.TgZ(0,"div",63),t.ALo(1,"number"),t.ALo(2,"json"),t._UZ(3,"app-score-box",46),t.TgZ(4,"a",64),t.NdJ("click",function(){t.CHM(n);const i=t.oxw().$implicit,r=t.oxw(4).$implicit,l=t.oxw(2);return t.KtG(l.removeMatching(r,r.currentRelease,i))}),t._UZ(5,"i",65),t.qZA(),t._uU(6),t.qZA()}if(2&a){const n=t.oxw().$implicit;t.hYB("title","Score: ",t.lcZ(1,4,n.currentMatch.score)," ",t.lcZ(2,6,n.currentMatch.scores),""),t.xp6(3),t.Q6J("score",n.currentMatch.score),t.xp6(3),t.hij(" ",n.currentMatch.match.track.name," ")}}const We=function(a){return{missing:a}};function tn(a,e){if(1&a){const n=t.EpF();t.TgZ(0,"div",61),t.NdJ("drop",function(i){const l=t.CHM(n).$implicit,u=t.oxw(4).$implicit,d=t.oxw(2);return t.KtG(d.drop(i,u,u.currentRelease,l))})("dragover",function(i){t.CHM(n);const r=t.oxw(6);return t.KtG(r.allowDrop(i))}),t._uU(1),t.ALo(2,"mbArtistCredits"),t.YNc(3,Ve,7,8,"div",62),t.qZA()}if(2&a){const n=e.$implicit;t.Q6J("ngClass",t.VKq(7,We,!n.currentMatch)),t.xp6(1),t.lnq(" ",n.mbTrack.position," - ",n.mbTrack.title," - ",t.lcZ(2,5,n.mbTrack.artistCredit)," "),t.xp6(2),t.Q6J("ngIf",n.currentMatch)}}function en(a,e){if(1&a&&(t.TgZ(0,"div"),t.YNc(1,tn,4,9,"div",60),t.qZA()),2&a){const n=t.oxw().$implicit;t.xp6(1),t.Q6J("ngForOf",n.tracks)}}function nn(a,e){if(1&a&&(t.TgZ(0,"div"),t.YNc(1,$e,6,9,"div",58),t.YNc(2,en,2,1,"div",19),t.qZA()),2&a){const n=e.$implicit,o=t.oxw(2).$implicit;t.xp6(1),t.Q6J("ngIf",o.currentRelease.media.length>1),t.xp6(1),t.Q6J("ngIf",n.expanded||o.currentRelease.media.length<2)}}function on(a,e){if(1&a&&(t.TgZ(0,"div",57),t.YNc(1,nn,3,2,"div",48),t.qZA()),2&a){const n=t.oxw().$implicit;t.xp6(1),t.Q6J("ngForOf",n.currentRelease.media)}}function an(a,e){if(1&a&&(t.TgZ(0,"div",38)(1,"div",39)(2,"span",22),t._uU(3),t.qZA()(),t.YNc(4,Fe,27,8,"div",40),t.TgZ(5,"div",41),t.YNc(6,Ge,2,0,"button",42),t.YNc(7,Je,2,0,"button",42),t.YNc(8,Xe,2,4,"button",43),t.YNc(9,Ye,4,1,"div",19),t.qZA(),t.YNc(10,on,2,1,"div",44),t.qZA()),2&a){const n=e.$implicit,o=t.oxw(2);t.xp6(3),t.Oqu(n.mbGroup.title),t.xp6(1),t.Q6J("ngIf",n.currentRelease),t.xp6(2),t.Q6J("ngIf",!o.isRunning),t.xp6(1),t.Q6J("ngIf",!o.isRunning&&n.releases.length>1),t.xp6(1),t.Q6J("ngIf",!o.isRunning&&n.currentRelease),t.xp6(1),t.Q6J("ngIf",n.selecting),t.xp6(1),t.Q6J("ngIf",n.expanded&&n.currentRelease)}}function rn(a,e){if(1&a&&(t.TgZ(0,"div",23)(1,"div",36),t.YNc(2,an,11,7,"div",37),t.qZA()()),2&a){const n=t.oxw();t.xp6(2),t.Q6J("ngForOf",n.matchTree.groups)}}function sn(a,e){if(1&a&&(t.TgZ(0,"div",66),t._UZ(1,"i",30),t._uU(2),t.qZA()),2&a){const n=t.oxw();t.xp6(2),t.hij(" ",n.currentAction,"")}}function cn(a,e){1&a&&(t.TgZ(0,"button",72),t._UZ(1,"i",30),t.qZA())}function ln(a,e){if(1&a){const n=t.EpF();t.TgZ(0,"button",73),t.NdJ("click",function(){t.CHM(n);const i=t.oxw(2);return t.KtG(i.apply())}),t._uU(1,"Apply"),t.qZA()}}function un(a,e){if(1&a){const n=t.EpF();t.TgZ(0,"div",67)(1,"div",68),t.YNc(2,cn,2,0,"button",69),t.YNc(3,ln,2,0,"button",70),t.TgZ(4,"button",71),t.NdJ("click",function(){t.CHM(n);const i=t.oxw();return t.KtG(i.stopApply())}),t._uU(5,"Cancel"),t.qZA()()()}if(2&a){const n=t.oxw();t.xp6(2),t.Q6J("ngIf",n.isRunning),t.xp6(1),t.Q6J("ngIf",!n.isRunning)}}function dn(a,e){1&a&&t._uU(0,"Manual Search with MusicBrainz")}function gn(a,e){1&a&&t._uU(0,"Match with AcoustID")}function pn(a,e){1&a&&t._uU(0,"Match with MusicBrainz (Text)")}function hn(a,e){1&a&&t._uU(0,"Match with MusicBrainz (Musicbrainz IDs)")}function mn(a,e){if(1&a){const n=t.EpF();t.TgZ(0,"div")(1,"button",75),t.NdJ("click",function(){t.CHM(n);const i=t.oxw(3);return t.KtG(i.start(i.RunType.auto))}),t._uU(2,"Auto Match"),t.qZA(),t.TgZ(3,"button",76),t.NdJ("click",function(i){t.CHM(n);const r=t.oxw(3);return t.KtG(r.onContextMenu(i))}),t._uU(4,"\xa0\u2026\xa0"),t.qZA()()}}function _n(a,e){if(1&a){const n=t.EpF();t.TgZ(0,"div")(1,"button",71),t.NdJ("click",function(){t.CHM(n);const i=t.oxw(3);return t.KtG(i.stop())}),t._uU(2,"Stop"),t.qZA()()}}function fn(a,e){if(1&a&&(t.TgZ(0,"div",68),t.YNc(1,mn,5,0,"div",19),t.YNc(2,_n,3,0,"div",19),t.qZA()),2&a){const n=t.oxw(2);t.xp6(1),t.Q6J("ngIf",!n.isRunning),t.xp6(1),t.Q6J("ngIf",n.isRunning)}}function Cn(a,e){if(1&a){const n=t.EpF();t.TgZ(0,"div")(1,"button",73),t.NdJ("click",function(){t.CHM(n);const i=t.oxw(3);return t.KtG(i.manualSearch())}),t._uU(2,"Search"),t.qZA(),t.TgZ(3,"button",71),t.NdJ("click",function(){t.CHM(n);const i=t.oxw(3);return t.KtG(i.clear())}),t._uU(4,"Clear"),t.qZA(),t.TgZ(5,"button",71),t.NdJ("click",function(){t.CHM(n);const i=t.oxw(3);return t.KtG(i.manual=!1)}),t._uU(6,"Close"),t.qZA()()}}function Tn(a,e){if(1&a){const n=t.EpF();t.TgZ(0,"div")(1,"button",71),t.NdJ("click",function(){t.CHM(n);const i=t.oxw(3);return t.KtG(i.stop())}),t._uU(2,"Stop"),t.qZA()()}}function vn(a,e){if(1&a){const n=t.EpF();t.TgZ(0,"div",68)(1,"div",77)(2,"div")(3,"div"),t._uU(4,"Album Name"),t.qZA(),t.TgZ(5,"app-tag-editor-autocomplete",78),t.NdJ("valueChange",function(i){t.CHM(n);const r=t.oxw(2);return t.KtG(r.manualSearchData.releaseGroup=i)}),t.qZA()(),t.TgZ(6,"div")(7,"div"),t._uU(8,"Artist"),t.qZA(),t.TgZ(9,"app-tag-editor-autocomplete",78),t.NdJ("valueChange",function(i){t.CHM(n);const r=t.oxw(2);return t.KtG(r.manualSearchData.artist=i)}),t.qZA()()(),t.YNc(10,Cn,7,0,"div",19),t.YNc(11,Tn,3,0,"div",19),t.qZA()}if(2&a){const n=t.oxw(2);t.xp6(5),t.Q6J("value",n.manualSearchData.releaseGroup)("getList",n.manualSearchData.getAutoCompleteAlbumList)("standalone",!0),t.xp6(4),t.Q6J("value",n.manualSearchData.artist)("getList",n.manualSearchData.getAutoCompleteArtistList)("standalone",!0),t.xp6(1),t.Q6J("ngIf",!n.isRunning),t.xp6(1),t.Q6J("ngIf",n.isRunning)}}function Mn(a,e){if(1&a&&(t.TgZ(0,"div",67),t.YNc(1,fn,3,2,"div",74),t.YNc(2,vn,12,8,"div",74),t.qZA()),2&a){const n=t.oxw();t.xp6(1),t.Q6J("ngIf",!n.manual),t.xp6(1),t.Q6J("ngIf",n.manual)}}function xn(a){let e=a.indexOf("("),n=a;return e>1&&(n=n.slice(0,e)),e=n.indexOf("["),e>1&&(n=n.slice(0,e)),n=n.trim(),0===n.length?a:n}class nt{constructor(e){(0,c.Z)(this,"q",void 0),(0,c.Z)(this,"id",void 0),(0,c.Z)(this,"name",void 0),(0,c.Z)(this,"matchings",[]),this.q=e,this.id=`musicbrainz-${JSON.stringify(e)}`,this.name=`MusicBrainz Search for ${Object.keys(e).filter(n=>"type"!==n).map(n=>`${n}: "${e[n]}"`).join(", ")}`}}var y=(()=>{return(a=y||(y={}))[a.acoustID=0]="acoustID",a[a.musicbrainzRefresh=1]="musicbrainzRefresh",a[a.musicbrainzByTags=2]="musicbrainzByTags",a[a.auto=3]="auto",y;var a})();class J{constructor(e,n,o,i,r,l){(0,c.Z)(this,"app",void 0),(0,c.Z)(this,"jam",void 0),(0,c.Z)(this,"notify",void 0),(0,c.Z)(this,"contextMenuService",void 0),(0,c.Z)(this,"client",void 0),(0,c.Z)(this,"cd",void 0),(0,c.Z)(this,"data",void 0),(0,c.Z)(this,"isRunning",!1),(0,c.Z)(this,"isGenreSearchRunning",!1),(0,c.Z)(this,"isAborted",!1),(0,c.Z)(this,"currentAction",void 0),(0,c.Z)(this,"customGenre",{text:"",checked:!0}),(0,c.Z)(this,"rightActive",!0),(0,c.Z)(this,"coverArt",void 0),(0,c.Z)(this,"actionMenu",void 0),(0,c.Z)(this,"matchings",[]),(0,c.Z)(this,"matchTree",new Pt),(0,c.Z)(this,"manual",!1),(0,c.Z)(this,"manualSearchData",{artists:[],albums:[],artist:"",releaseGroup:"",getAutoCompleteAlbumList:()=>{if(0===this.manualSearchData.albums.length)for(const u of this.matchings){const d=(u.track?.tag?.album||"").trim();d.length>0&&!this.manualSearchData.albums.includes(d)&&this.manualSearchData.albums.push(d)}return this.manualSearchData.albums},getAutoCompleteArtistList:()=>{if(0===this.manualSearchData.artists.length)for(const u of this.matchings){const d=(u.track?.tag?.artist||"").trim();d.length>0&&!this.manualSearchData.artists.includes(d)&&this.manualSearchData.artists.push(d)}return this.manualSearchData.artists}}),(0,c.Z)(this,"coverArtSearch",void 0),(0,c.Z)(this,"current",void 0),(0,c.Z)(this,"genres",void 0),(0,c.Z)(this,"RunType",y),this.app=e,this.jam=n,this.notify=o,this.contextMenuService=i,this.client=r,this.cd=l}ngOnChanges(e){this.data?(this.matchings=this.data.matchings.map(n=>({track:n.track})),this.isRunning||(this.isAborted=!1)):(this.matchings=[],this.isAborted=!0)}ngOnDestroy(){this.isAborted=!0}allowDrop(e){e.preventDefault()}drag(e,n){this.cd.markForCheck(),e.dataTransfer&&e.dataTransfer.setData("text",n.track.id)}drop(e,n,o,i){if(e.preventDefault(),!e.dataTransfer)return;const r=e.dataTransfer.getData("text"),l=this.matchings.find(d=>d.track.id===r);if(!l)return;let u=i.matchings.find(d=>d.match.track.id===r);u||(u={match:l,score:1,scores:[]},i.matchings.push(u)),u.score=1,u.scores.find(d=>"Manual Match"===d.name)||u.scores.push({name:"Manual Match",score:1,weight:1});for(const d of o.media)for(const h of d.tracks)h.currentMatch&&h.currentMatch.match.track.id===l.track.id&&(h.currentMatch=void 0);i.currentMatch=u,n.updateScore()}start(e){this.isRunning||(this.isAborted=!1,this.isRunning=!0,this.run(e).then(()=>{this.matchTree.sort(),this.isRunning=!1,this.isAborted=!1,this.currentAction=""}).catch(n=>{this.notify.error(n),this.isRunning=!1,this.isAborted=!1,this.currentAction=""}))}setManualSearch(){if(this.manual=!0,0===this.manualSearchData.artist.length){const e=this.manualSearchData.getAutoCompleteArtistList();e.length>0&&(this.manualSearchData.artist=e[0])}if(0===this.manualSearchData.releaseGroup.length){const e=this.manualSearchData.getAutoCompleteAlbumList();e.length>0?this.manualSearchData.releaseGroup=e[0]:this.data?.folder&&(this.manualSearchData.releaseGroup=this.data.folder.name)}}clear(){this.isRunning||(this.matchTree=new Pt)}manualSearch(){this.isRunning||(this.isAborted=!1,this.isRunning=!0,this.searchManual().then(()=>{this.isRunning=!1,this.isAborted=!1,this.currentAction=""}).catch(e=>{this.notify.error(e),this.isRunning=!1,this.isAborted=!1,this.currentAction=""}))}stop(){this.isRunning&&(this.isAborted=!0)}apply(){const e=(this.genres||[]).filter(n=>n.checked).map(n=>n.tag.name);this.customGenre.checked&&this.customGenre.text.trim().length>0&&e.push(this.customGenre.text.trim());for(const n of this.matchings)n.genres=e;if(this.data){const n=this.coverArt?this.coverArt.getChecked():[];for(const o of this.data.matchings){const i=this.matchings.find(r=>r.track.id===o.track.id);o.rawTag=i?se(i,e,n):void 0}this.data.apply&&this.data.apply(),this.data.close&&this.data.close()}}setRelease(e,n){e.currentRelease=n,n.loaded||this.loadRelease(n).catch(o=>{this.notify.error(o)})}chooseRelease(e,n){this.stopApply(),this.current={group:e,release:n},this.coverArtSearch={mbReleaseID:n.mbRelease.id,mbReleaseGroupID:e.mbGroup.id};for(const o of n.media)for(const i of o.tracks)i.currentMatch&&(i.currentMatch.match.mbTrack=i.mbTrack,i.currentMatch.match.mbMedia=o.mbMedia,i.currentMatch.match.mbRelease=n.mbRelease,i.currentMatch.match.mbGroup=e.mbGroup);this.loadGenres(e,n).catch(o=>{this.notify.error(o)})}stopApply(){this.current=void 0,this.genres=void 0;for(const e of this.matchings)e.mbTrack=void 0,e.mbMedia=void 0,e.mbRelease=void 0,e.mbGroup=void 0,e.genres=void 0}setRunning(e){this.currentAction=e,this.isRunning=!0}stopRunning(){this.isRunning=!1,this.currentAction=""}loadMoods(e){this.isRunning||!e||(this.setRunning("Searching Moods"),this.loadAcousticBrainz(e).then(()=>{this.stopRunning()}).catch(n=>{this.stopRunning(),this.notify.error(n)}))}loadLyrics(e){this.isRunning||!e||(this.setRunning("Searching Lyrics"),this.loadLyricsOVH(e).then(()=>{this.stopRunning()}).catch(n=>{this.stopRunning(),this.notify.error(n)}))}removeMatching(e,n,o){o.currentMatch=void 0,e.updateScore()}onContextMenu(e){this.contextMenuService.show.next({contextMenu:this.actionMenu,event:e,item:void 0}),e.preventDefault(),e.stopPropagation()}shouldStop(){return this.matchTree.enough(this.matchings.length)||this.isAborted}searchManual(){var e=this;return(0,m.Z)(function*(){const n={type:_.xI.releaseGroup};if(e.manualSearchData.artist&&e.manualSearchData.artist.trim().length>0&&(n.artist=e.manualSearchData.artist),e.manualSearchData.releaseGroup&&e.manualSearchData.releaseGroup.trim().length>0&&(n.releasegroup=e.manualSearchData.releaseGroup),Object.keys(n).length>1){const o=new nt(n);yield e.runQuery(o,[])}})()}run(e){var n=this;return(0,m.Z)(function*(){switch(e){case y.acoustID:yield n.acoustId();break;case y.musicbrainzByTags:if(yield n.musicBrainzByQuickTags(),n.shouldStop())return;yield n.musicBrainzByTags();break;case y.musicbrainzRefresh:yield n.musicBrainzRefresh();break;case y.auto:if(yield n.musicBrainzRefresh(),n.shouldStop()||(yield n.musicBrainzByQuickTags(),n.shouldStop())||(yield n.acoustId(),n.shouldStop()))return;yield n.musicBrainzByTags()}})()}loadGenres(e,n){var o=this;return(0,m.Z)(function*(){if(!o.data)return;o.isGenreSearchRunning=!0;const i=[];e.mbGroup.secondaryTypes&&e.mbGroup.secondaryTypes.find(d=>["audiobook","audio drama","spokenword"].includes(d))&&i.push({count:1,name:"Audiobook"});for(const d of o.data.matchings)if(d.track.tag?.genres&&d.track.tag.genres.length>0){const h=d.track.tag.genres[0],T=i.find(M=>M.name===h);T?T.count++:i.push({count:1,name:h})}let r=function Ut(a){if(!a||!a.length)return[];const e=[];for(const n of a){const o=n.name.split("/").map(i=>i.trim()).filter(i=>i.length>0);for(const i of o){const r=ct(i);if(r){const l=e.find(u=>u.name===r);l?l.count+=n.count:e.push({name:r,count:n.count})}}}return e.sort((n,o)=>o.count-n.count)}(i),l=[];n.mbRelease.tags&&(l=l.concat(n.mbRelease.tags)),e.mbGroup.tags&&(l=l.concat(e.mbGroup.tags)),r=lt(r,function zt(a){if(!a||!a.length)return[];const e=[];for(const n of a){const o=n.name.split(";").map(i=>i.trim()).filter(i=>i.length>0);for(const i of o){const r=ct(i);if(r){const l=e.find(u=>u.name===r);l?l.count+=n.count:e.push({name:r,count:n.count})}}}return e.sort((n,o)=>o.count-n.count)}(l));const u=(yield o.jam.metadata.lastfmLookup({type:_.WQ.album,mbID:n.mbRelease.id})).data;if(u.album&&(r=lt(r,function Ht(a){return a.tags?xt(a.tags):[]}(u.album))),0===r.length&&n.mbRelease.artistCredit.length>0){const d=(yield o.jam.metadata.lastfmLookup({type:_.WQ.artist,mbID:n.mbRelease.artistCredit[0].artist.id})).data;d&&d.artist&&(r=lt(r,function qt(a){return a?xt(a.tags):[]}(d.artist)))}o.genres=r.sort((d,h)=>h.count-d.count).map((d,h)=>({tag:d,checked:0===h})),o.isGenreSearchRunning=!1})()}loadAcousticBrainz(e){var n=this;return(0,m.Z)(function*(){for(const o of e.media)for(const i of o.tracks)if(!i.abData&&i.currentMatch?.match?.mbTrack?.recording?.id){const r=(yield n.jam.metadata.acousticbrainzLookup({mbID:i.currentMatch.match.mbTrack.recording.id})).data;if(r.highlevel){const l=[],u=[],d=[],h=[],T=Object.keys(r.highlevel);for(const O of T){const x=r.highlevel[O].value;r.highlevel[O].probability>.8&&!x.includes("not_")&&(O.startsWith("mood_")||"timbre"===O||"danceability"===O?u.includes(x)||u.push(x):O.startsWith("genre_")?l.includes(x)||l.push(x):O.startsWith("tonal_")||"voice_instrumental"===O?d.includes(x)||d.push(x):h.includes(x)||h.push(x))}const M={genres:l,moods:u,tonal:d,other:h};i.abData=M,i.currentMatch.match.abdata=M}}})()}loadLyricsOVH(e){var n=this;return(0,m.Z)(function*(){for(const o of e.media)for(const i of o.tracks)if(i.currentMatch&&!i.currentMatch.match.lyrics&&i.mbTrack.artistCredit&&i.mbTrack.artistCredit.length>0){const r=i.mbTrack.artistCredit[0].name,l=i.mbTrack.title;i.currentMatch.match.lyrics=(yield n.jam.metadata.lyricsovhSearch({title:l,artist:r})).data}})()}loadRelease(e){var n=this;return(0,m.Z)(function*(){if(e&&!e.loaded&&!e.isLoading){e.isLoading=!0;try{n.currentAction=`Loading MusicBrainz Release: ${e.mbRelease.id}`;const o=yield n.jam.metadata.musicbrainzLookup({type:_.ej.release,mbID:e.mbRelease.id});if(!o.data?.release)return Promise.reject(Error("Got empty data"));e.setLookupRelease(o.data.release,n.matchings),e.loaded=!0,e.isLoading=!1}catch(o){return e.isLoading=!1,Promise.reject(o)}}})()}addReleaseGroupByReleaseID(e){var n=this;return(0,m.Z)(function*(){n.currentAction=`Loading MusicBrainz Release: ${e}`;const o=yield n.jam.metadata.musicbrainzLookup({type:_.ej.release,mbID:e});return o.data.release?n.addReleaseGroupByID(o.data.release.releaseGroup.id):Promise.reject(Error("Got empty data"))})()}addReleaseGroupByID(e){var n=this;return(0,m.Z)(function*(){let o=n.matchTree.findReleaseGroup(e);if(!o){n.currentAction=`Loading MusicBrainz Release Group: ${e}`;const i=yield n.jam.metadata.musicbrainzLookup({type:_.ej.releaseGroup,mbID:e});o=n.matchTree.addReleaseGroup(i.data.releaseGroup)}return o})()}acoustId(){var e=this;return(0,m.Z)(function*(){e.currentAction="Checking files with AcoustID";let n=[];for(const i of e.matchings){if(!i.acoustidEntries){e.currentAction=`Checking files with AcoustID: ${i.track.name}`;try{const r=yield e.jam.metadata.acoustidLookup({trackID:i.track.id});i.acoustidEntries=Jt(r.data,i.track)}catch(r){console.error(r)}if(e.isAborted)return}i.acoustidEntries&&(n=n.concat(i.acoustidEntries))}const o=new Lt;for(const i of n)o.add(i);for(const i of o.releasegroups){if(e.shouldStop())return;let r=e.matchTree.findReleaseGroup(i.id);if(r||(r=yield e.addReleaseGroupByID(i.id)),r&&!r.currentRelease&&(yield e.loadBestMatchingCurrentRelease(r),e.shouldStop()))return;e.matchTree.sort()}})()}buildQuickQueries(){const e=[],n=[],o=[];for(const i of this.matchings)if(i.track.tag&&i.track.tag.album){const r=xn(i.track.tag.album);i.track.tag.album&&!n.includes(r)&&n.push(r),i.track.tag.artist&&!o.includes(i.track.tag.artist)&&o.push(i.track.tag.artist)}return 1===n.length&&e.push(new nt({type:_.xI.releaseGroup,releasegroup:n[0],artist:o.length>0?o[0]:void 0})),this.data?.folder?.tag&&e.push(new nt({type:_.xI.releaseGroup,releasegroup:this.data.folder.name,artist:this.data.folder.tag.artist})),e}buildQueries(){const e=[],o=(i,r,l)=>{const u={type:i.type};for(const d of Object.keys(i)){const h=i[d];if(void 0===h||""===h||""===h.toString().trim())return;const T=h.toString().split("(");T.length>0&&(u[d]=T[0])}l&&(u.tracks=this.matchings.length),((i,r)=>{const l=e.find(u=>u.id===i.id);l?l.matchings.push(r):(i.matchings.push(r),e.push(i))})(new nt(u),r)};for(const i of this.matchings)o({type:_.xI.releaseGroup,releasegroup:i.track.tag?.album,artist:i.track.tag?.artist},i);for(const i of this.matchings)o({type:_.xI.release,release:i.track.tag?.album,artist:i.track.tag?.artist},i,!0);for(const i of this.matchings)o({type:_.xI.release,release:i.track.tag?.album,artist:i.track.tag?.artist},i);for(const i of this.matchings)if(i.track.tag?.title)o({type:_.xI.recording,recording:i.track.tag.title,release:i.track.tag.album,artist:i.track.tag.artist},i);else{const r=(0,b.f_)(i.track.name);o({type:_.xI.recording,recording:r,release:i.track.tag?.album,artist:i.track.tag?.artist},i)}for(const i of this.matchings)if(i.track.tag?.title)o({type:_.xI.recording,recording:i.track.tag.title,release:i.track.tag.album},i),o({type:_.xI.recording,recording:i.track.tag.title,artist:i.track.tag.artist},i);else{const r=(0,b.f_)(i.track.name);o({type:_.xI.recording,recording:r,release:i.track.tag?.album},i),o({type:_.xI.recording,recording:r,artist:i.track.tag?.artist},i)}for(const i of this.matchings)o({type:_.xI.releaseGroup,releasegroup:i.track.tag?.album},i),o({type:_.xI.release,release:i.track.tag?.album},i,!0),o({type:_.xI.release,release:i.track.tag?.album},i);for(const i of this.matchings)if(i.track.tag?.title)o({type:_.xI.recording,recording:i.track.tag.title},i);else{const r=(0,b.f_)(i.track.name);o({type:_.xI.recording,recording:r},i)}return e}loadBestMatchingCurrentRelease(e){var n=this;return(0,m.Z)(function*(){const o=e.releases.sort((i,r)=>{const l=Math.abs((i.totalTrack||0)-n.matchings.length),u=Math.abs((r.totalTrack||0)-n.matchings.length);return l===u?i.sortDate-r.sortDate:l-u});for(const i of o){if(n.shouldStop())return;if(yield n.loadRelease(i),i.complete)return void(e.currentRelease=i)}e.releases.length>0&&(yield n.loadRelease(e.releases[0]),e.currentRelease=e.releases[0])})()}loadByReleaseGroups(e){var n=this;return(0,m.Z)(function*(){for(const o of e){if(n.shouldStop())return;let i=n.matchTree.findReleaseGroup(o.id);i||(i=yield n.addReleaseGroupByID(o.id)),i&&!i.currentRelease&&(yield n.loadBestMatchingCurrentRelease(i))}})()}loadByReleases(e){var n=this;return(0,m.Z)(function*(){for(const o of e){if(n.shouldStop())return;let i=n.matchTree.findReleaseGroup(o.releaseGroup.id);i||(i=yield n.addReleaseGroupByID(o.releaseGroup.id)),i&&!i.currentRelease&&(yield n.loadBestMatchingCurrentRelease(i))}})()}loadByRecordings(e){var n=this;return(0,m.Z)(function*(){for(const o of e){if(n.shouldStop())return;if(o.releases)for(const i of o.releases){if(n.shouldStop())return;let r=n.matchTree.findReleaseGroup(i.releaseGroup.id);r||(r=yield n.addReleaseGroupByID(i.releaseGroup.id)),r&&!r.currentRelease&&(yield n.loadBestMatchingCurrentRelease(r))}}})()}runQuery(e,n){var o=this;return(0,m.Z)(function*(){if(o.shouldStop())return;o.currentAction=e.name;const i=(yield o.jam.metadata.musicbrainzSearch(e.q)).data;if(i.releaseGroups?yield o.loadByReleaseGroups(i.releaseGroups):i.releases?yield o.loadByReleases(i.releases):i.recordings?yield o.loadByRecordings(i.recordings):console.error("TODO",i),o.matchTree.sort(),o.shouldStop())return;const r=n.shift();r&&(yield o.runQuery(r,n))})()}musicBrainzByQuickTags(){var e=this;return(0,m.Z)(function*(){const n=e.buildQuickQueries(),o=n.shift();o&&(yield e.runQuery(o,n))})()}musicBrainzByTags(){var e=this;return(0,m.Z)(function*(){const n=e.buildQueries(),o=n.shift();o&&(yield e.runQuery(o,n))})()}musicBrainzRefresh(){var e=this;return(0,m.Z)(function*(){for(const n of e.matchings){if(e.shouldStop())return;if(n.track.tag){let o;if(n.track.tag.mbReleaseGroupID&&(o=yield e.addReleaseGroupByID(n.track.tag.mbReleaseGroupID)),!o&&n.track.tag.mbReleaseID&&(o=yield e.addReleaseGroupByReleaseID(n.track.tag.mbReleaseID)),o){if(n.track.tag.mbReleaseID){const i=o.findRelease(n.track.tag.mbReleaseID);i?yield e.loadRelease(i):console.error("Could not find the release with id",n.track.tag.mbReleaseID),o.currentRelease=i,o.enough(e.matchings.length)||(o.currentRelease=void 0)}o.currentRelease||(yield e.loadBestMatchingCurrentRelease(o))}}}})()}}(0,c.Z)(J,"\u0275fac",function(e){return new(e||J)(t.Y36(A.zi),t.Y36(_.K4),t.Y36(A.c),t.Y36(at.Lk),t.Y36(me.eN),t.Y36(t.sBO))}),(0,c.Z)(J,"\u0275cmp",t.Xpm({type:J,selectors:[["app-match-release"]],viewQuery:function(e,n){if(1&e&&(t.Gf(Z,5),t.Gf(ve,5)),2&e){let o;t.iGM(o=t.CRH())&&(n.coverArt=o.first),t.iGM(o=t.CRH())&&(n.actionMenu=o.first)}},hostVars:2,hostBindings:function(e,n){2&e&&t.ekj("right-active",n.rightActive)},inputs:{data:"data"},features:[t.TTD],decls:20,vars:9,consts:[[1,"toggle",3,"click"],["class","button-on-control",4,"ngIf"],[1,"content"],[1,"match-files"],[1,"match-file-list"],[1,"match-file-list-header"],["class","match-file","draggable","true",3,"dragstart",4,"ngFor","ngForOf"],["class","match-releases",4,"ngIf"],["class","current-log",4,"ngIf"],["class","buttons",4,"ngIf"],["actionMenu",""],["contextMenuItem","",3,"execute"],[1,"button-on-control"],[1,"icon-left"],[1,"icon-right"],["draggable","true",1,"match-file",3,"dragstart"],[1,"handle"],[1,"grippy"],[1,"title"],[4,"ngIf"],[1,"label"],[1,"currentRelease"],[1,"value"],[1,"match-releases"],[1,"match-apply"],[1,"section"],["class","icon-spin icon-spinner",4,"ngIf"],[3,"data"],[1,"match-track-moods"],[1,"button-on-background",3,"click"],[1,"icon-spin","icon-spinner"],["class","select",3,"title",4,"ngFor","ngForOf"],[1,"select"],["type","checkbox",3,"ngModel","ngModelChange"],["type","text",3,"ngModel","ngModelChange"],[1,"select",3,"title"],[1,"match-results"],["class","match-releasegroup",4,"ngFor","ngForOf"],[1,"match-releasegroup"],[1,"match-releasegroup-title"],["class","match-release-info",4,"ngIf"],[1,"match-select-releases"],["class","button-on-background",3,"click",4,"ngIf"],["class","button-primary",3,"ngClass","click",4,"ngIf"],["class","match-tracks-info",4,"ngIf"],[1,"match-release-info"],[3,"score"],["class","value",4,"ngIf"],[4,"ngFor","ngForOf"],["class","icon-checkmark","title","All tracks matched",4,"ngIf"],["title","Unmatched tracks!","class","icon-warning",4,"ngIf"],["title","All tracks matched",1,"icon-checkmark"],["title","Unmatched tracks!",1,"icon-warning"],[1,"button-primary",3,"ngClass","click"],["class","select",3,"click",4,"ngFor","ngForOf"],[1,"select",3,"click"],["type","radio","name","release",3,"checked"],[1,"match-tracks-info"],[3,"click",4,"ngIf"],[3,"click"],["class","match-track-info",3,"ngClass","drop","dragover",4,"ngFor","ngForOf"],[1,"match-track-info",3,"ngClass","drop","dragover"],[3,"title",4,"ngIf"],[3,"title"],["title","Remove Matching",3,"click"],[1,"icon-trash"],[1,"current-log"],[1,"buttons"],[1,"match-actions"],["class","button-primary",4,"ngIf"],["class","button-primary",3,"click",4,"ngIf"],[1,"button-accent",3,"click"],[1,"button-primary"],[1,"button-primary",3,"click"],["class","match-actions",4,"ngIf"],[1,"button-on-control","button-with-add-on",3,"click"],[1,"button-on-control","button-add-on",3,"click"],[1,"match-search"],[3,"value","getList","standalone","valueChange"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0),t.NdJ("click",function(){return n.rightActive=!n.rightActive}),t.YNc(1,Me,3,0,"a",1),t.YNc(2,xe,3,0,"a",1),t.qZA(),t.TgZ(3,"div",2)(4,"div",3)(5,"div",4)(6,"div",5),t._uU(7),t.qZA(),t.YNc(8,ke,6,2,"div",6),t.qZA()(),t.YNc(9,Ae,15,7,"div",7),t.YNc(10,rn,3,1,"div",7),t.qZA(),t.YNc(11,sn,3,1,"div",8),t.YNc(12,un,6,2,"div",9),t.TgZ(13,"context-menu",null,10),t.YNc(15,dn,1,0,"ng-template",11),t.NdJ("execute",function(){return n.setManualSearch()}),t.YNc(16,gn,1,0,"ng-template",11),t.NdJ("execute",function(){return n.start(n.RunType.acoustID)}),t.YNc(17,pn,1,0,"ng-template",11),t.NdJ("execute",function(){return n.start(n.RunType.musicbrainzByTags)}),t.YNc(18,hn,1,0,"ng-template",11),t.NdJ("execute",function(){return n.start(n.RunType.musicbrainzRefresh)}),t.qZA(),t.YNc(19,Mn,3,2,"div",9)),2&e&&(t.xp6(1),t.Q6J("ngIf",n.rightActive),t.xp6(1),t.Q6J("ngIf",!n.rightActive),t.xp6(5),t.hij("",n.matchings.length," Tracks"),t.xp6(1),t.Q6J("ngForOf",n.matchings),t.xp6(1),t.Q6J("ngIf",n.current),t.xp6(1),t.Q6J("ngIf",!n.current),t.xp6(1),t.Q6J("ngIf",n.isRunning),t.xp6(1),t.Q6J("ngIf",n.current),t.xp6(7),t.Q6J("ngIf",!n.current))},dependencies:[C.mk,C.sg,C.O5,g._Y,g.Fj,g.Wl,g.JJ,g.JL,g.On,g.F,bt.G,kt.n,Z,R,G,C.JJ,fe.T,Ce.N,Te.C],styles:['[_nghost-%COMP%]{display:flex;flex-direction:column;width:100%;height:100%;overflow:hidden}[_nghost-%COMP%]   .toggle[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex:1 1 auto;overflow-y:auto}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{padding-right:4px;font-size:.9em;text-transform:uppercase}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .select[_ngcontent-%COMP%]{padding-top:2px;padding-bottom:2px;display:block;font-size:.9em}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .select[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{margin-right:4px}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .select[_ngcontent-%COMP%]:hover{background-color:var(--background-hover)}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]{overflow-y:auto;overflow-x:auto;display:block;height:100%;width:50%;font-size:.8em;padding-right:15px}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]{display:flex;flex-flow:column wrap;-webkit-user-select:none;user-select:none;width:100%;padding-top:5px;background-color:var(--background);color:var(--on-background);margin-bottom:15px}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file-list-header[_ngcontent-%COMP%]{text-align:center;padding-bottom:5px}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]{min-height:48px;display:flex;flex-flow:row nowrap;align-items:center;align-content:space-evenly;width:100%;line-height:1.25em;margin-bottom:1px;border-top-width:1px;border-top-style:solid;border-bottom-width:0;border-bottom-style:solid;border-bottom-color:var(--background-border);border-top-color:var(--background-border);padding:10px 10px 10px 0}@media (max-width: 1000px){[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]{height:auto}}@media (max-width: 522px){[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]{font-size:.9em}}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .number[_ngcontent-%COMP%]{min-width:32px;text-align:right}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .play-count[_ngcontent-%COMP%]{min-width:20px;text-align:right}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .rating[_ngcontent-%COMP%]{min-width:30px;text-align:center}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .play-date[_ngcontent-%COMP%]{min-width:100px}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .fav[_ngcontent-%COMP%]{min-width:30px;text-align:center}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{flex-grow:1}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .length[_ngcontent-%COMP%]{min-width:80px;text-align:right}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{margin-left:15px}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:last-of-type{margin-right:15px}@media (max-width: 400px){[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{margin-left:0}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:last-of-type{margin-right:0}}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]:hover{background-color:var(--background-hover)}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]:last-child{border-bottom-width:1px}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .small-screen-icon[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{color:var(--on-background-active)}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--on-background);font-size:.8em}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{padding:0;display:inline-block;margin:0 10px 0 0}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{font-size:.8em;vertical-align:middle}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   a.title-link[_ngcontent-%COMP%]{font-size:inherit;margin-right:10px;color:var(--on-background-active)}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--on-background)}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:var(--on-background-hover)}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]{width:0;margin-left:0;cursor:move}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]   span.grippy[_ngcontent-%COMP%]{display:inline-block;width:26px;height:8px;transform:rotate(90deg);margin-left:-8px}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]   span.grippy[_ngcontent-%COMP%], [_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]   span.grippy[_ngcontent-%COMP%]:before{background-image:radial-gradient(#7b7b7b 40%,transparent 40%);background-size:4px 4px;background-position:0 100%;background-repeat:repeat-x}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]   span.grippy[_ngcontent-%COMP%]:before{content:"";display:block;width:100%;height:33%}@media (max-width: 1000px){[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]{height:auto;min-height:48px}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{display:block}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:inline-block;margin-left:0}}@media (max-width: 400px){[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]{flex-flow:row wrap;align-items:inherit;width:100%;font-size:.9em}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .small-screen-icon[_ngcontent-%COMP%]{display:inline-block}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]{order:2;width:25%;text-align:center}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]   span.grippy[_ngcontent-%COMP%]{transform:rotate(0)}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{order:6;margin-left:0;margin-right:0;padding-right:0;padding-left:0;width:100%}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{margin-left:0;margin-right:0;padding-right:0;padding-left:0;overflow:hidden;text-overflow:ellipsis}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{width:100%;margin-left:0;margin-right:0;overflow:hidden;text-overflow:ellipsis}}@media (max-width: 1200px){[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .fav[_ngcontent-%COMP%]{display:none}}@media (max-width: 400px){[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .number[_ngcontent-%COMP%], [_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .play-count[_ngcontent-%COMP%], [_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .rating[_ngcontent-%COMP%], [_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .play-date[_ngcontent-%COMP%], [_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .length[_ngcontent-%COMP%]{margin-left:0;margin-right:0;padding-right:0;padding-left:0;font-size:.8em;width:30%;flex-grow:1;text-align:center}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .number[_ngcontent-%COMP%]{order:1;width:25%;text-align:left}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .play-count[_ngcontent-%COMP%]{order:2}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .rating[_ngcontent-%COMP%]{order:3}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .play-date[_ngcontent-%COMP%]{order:4}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .length[_ngcontent-%COMP%]{order:5;width:25%;text-align:right}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{order:6}}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:11px}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   span.value[_ngcontent-%COMP%]{color:var(--on-background-active);padding-right:5px}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-releases[_ngcontent-%COMP%]{border-left:1px solid var(--background-border);display:flex;flex-direction:column;flex:1 1 auto;width:50%;font-size:.9em}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-releases[_ngcontent-%COMP%]   .icon-checkmark[_ngcontent-%COMP%]{color:var(--primary)}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-releases[_ngcontent-%COMP%]   .icon-warning[_ngcontent-%COMP%]{color:var(--accent)}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-releases[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:var(--on-background-active);padding-right:5px}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-releases[_ngcontent-%COMP%]   .match-results[_ngcontent-%COMP%]{flex:1 1 auto;overflow-y:auto;overflow-x:auto}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-releases[_ngcontent-%COMP%]   .match-results[_ngcontent-%COMP%]   .match-releasegroup[_ngcontent-%COMP%]{padding:5px 5px 5px 15px}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-releases[_ngcontent-%COMP%]   .match-results[_ngcontent-%COMP%]   .match-releasegroup[_ngcontent-%COMP%]   .match-release-info[_ngcontent-%COMP%], [_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-releases[_ngcontent-%COMP%]   .match-results[_ngcontent-%COMP%]   .match-releasegroup[_ngcontent-%COMP%]   .match-tracks-info[_ngcontent-%COMP%]{font-size:.8em}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-releases[_ngcontent-%COMP%]   .match-results[_ngcontent-%COMP%]   .match-releasegroup[_ngcontent-%COMP%]   .match-release-info[_ngcontent-%COMP%], [_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-releases[_ngcontent-%COMP%]   .match-results[_ngcontent-%COMP%]   .match-releasegroup[_ngcontent-%COMP%]   .match-tracks-info[_ngcontent-%COMP%], [_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-releases[_ngcontent-%COMP%]   .match-results[_ngcontent-%COMP%]   .match-releasegroup[_ngcontent-%COMP%]   .match-select-releases[_ngcontent-%COMP%]{padding-top:4px}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-releases[_ngcontent-%COMP%]   .match-results[_ngcontent-%COMP%]   .match-releasegroup[_ngcontent-%COMP%]   .match-select-releases[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:.7em;line-height:.7em;vertical-align:top}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-releases[_ngcontent-%COMP%]   .match-results[_ngcontent-%COMP%]   .match-releasegroup[_ngcontent-%COMP%]   app-image-base64[_ngcontent-%COMP%]{height:32px;width:32px}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-releases[_ngcontent-%COMP%]   .match-results[_ngcontent-%COMP%]   .match-releasegroup[_ngcontent-%COMP%]   .match-track-info[_ngcontent-%COMP%]{padding-top:2px;padding-bottom:2px;border-top:1px solid var(--background-border)}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-releases[_ngcontent-%COMP%]   .match-results[_ngcontent-%COMP%]   .match-releasegroup[_ngcontent-%COMP%]   .match-track-info.missing[_ngcontent-%COMP%]{color:var(--accent)}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-releases[_ngcontent-%COMP%]   .match-results[_ngcontent-%COMP%]   .match-releasegroup[_ngcontent-%COMP%]   .match-release[_ngcontent-%COMP%]{white-space:nowrap;padding:5px 5px 5px 42px}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-releases[_ngcontent-%COMP%]   .match-apply[_ngcontent-%COMP%]{flex:1 1 auto;overflow-y:auto;overflow-x:auto;padding:15px}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-releases[_ngcontent-%COMP%]   .match-apply[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{padding-bottom:10px}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-releases[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]{color:var(--on-background-active);text-transform:uppercase;padding-bottom:10px;white-space:nowrap}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-releases[_ngcontent-%COMP%]   app-match-coverart[_ngcontent-%COMP%]{border-top:1px solid var(--background-border)}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-releases[_ngcontent-%COMP%]   .match-album-images[_ngcontent-%COMP%]{border-top:1px solid var(--background-border);padding-top:15px}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-releases[_ngcontent-%COMP%]   .match-album-images[_ngcontent-%COMP%]   .front-only-choice[_ngcontent-%COMP%]{float:right;font-size:.8em}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-releases[_ngcontent-%COMP%]   .match-album-images[_ngcontent-%COMP%]   .match-images[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap}@media (max-width: 768px){[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-releases[_ngcontent-%COMP%]   .match-album-images[_ngcontent-%COMP%]   .match-images[_ngcontent-%COMP%]{justify-content:space-around}}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-releases[_ngcontent-%COMP%]   .match-track-moods[_ngcontent-%COMP%]{border-top:1px solid var(--background-border);padding-top:15px}[_nghost-%COMP%]   .buttons[_ngcontent-%COMP%]{flex:0 0 auto;padding:5px;display:flex;align-items:center;justify-content:center;border-top:1px solid var(--background-border)}[_nghost-%COMP%]   .buttons[_ngcontent-%COMP%]   .match-actions[_ngcontent-%COMP%]{text-align:center;vertical-align:middle;margin-top:10px;margin-bottom:30px}[_nghost-%COMP%]   .buttons[_ngcontent-%COMP%]   .match-actions[_ngcontent-%COMP%]   app-tag-editor-autocomplete[_ngcontent-%COMP%]{height:28px;display:block}[_nghost-%COMP%]   .buttons[_ngcontent-%COMP%]   .match-actions[_ngcontent-%COMP%]   .match-search[_ngcontent-%COMP%]{display:flex;flex-direction:row;text-align:left;margin-bottom:10px}@media (max-width: 768px){[_nghost-%COMP%]   .buttons[_ngcontent-%COMP%]   .match-actions[_ngcontent-%COMP%]   .match-search[_ngcontent-%COMP%]{flex-direction:column}}[_nghost-%COMP%]   .buttons[_ngcontent-%COMP%]   .match-actions[_ngcontent-%COMP%]   .match-search[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{flex:1;padding-left:10px;padding-right:10px}[_nghost-%COMP%]   .buttons[_ngcontent-%COMP%]   .match-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:10px;margin-right:10px}[_nghost-%COMP%]   .buttons[_ngcontent-%COMP%]   .match-actions[_ngcontent-%COMP%]   .match-progress[_ngcontent-%COMP%]{display:block;font-size:.9em}[_nghost-%COMP%]   .current-log[_ngcontent-%COMP%]{font-size:.8em;padding:5px}@media (max-width: 768px){[_nghost-%COMP%]   .toggle[_ngcontent-%COMP%]{display:block;position:relative;width:100%;height:auto;text-align:center;padding-top:5px;padding-bottom:5px}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]{overflow-y:auto}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]{height:auto;width:100%;overflow-y:inherit;display:block;padding-right:0}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-releases[_ngcontent-%COMP%]{height:auto;width:100%;display:none;border-left:none}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-releasegroup[_ngcontent-%COMP%]{padding-left:0}.right-active[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-releases[_ngcontent-%COMP%]{display:block}.right-active[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]{display:none}}']}));class L{constructor(){(0,c.Z)(this,"data",void 0),(0,c.Z)(this,"unsubscribe",new rt.x)}dialogInit(e,n){this.data=n.data,this.data&&(this.data.close=()=>{e.close()}),e.beforeClose().pipe((0,K.R)(this.unsubscribe)).subscribe(()=>{this.data=void 0})}ngOnDestroy(){this.unsubscribe.next(),this.unsubscribe.complete()}}(0,c.Z)(L,"\u0275fac",function(e){return new(e||L)}),(0,c.Z)(L,"\u0275cmp",t.Xpm({type:L,selectors:[["app-dialog-match-release"]],decls:1,vars:1,consts:[[3,"data"]],template:function(e,n){1&e&&t._UZ(0,"app-match-release",0),2&e&&t.Q6J("data",n.data)},dependencies:[J]}));var yt=p(7841),On=p(7480),Pn=p(7199);const bn=["inputEl"];class X{constructor(){(0,c.Z)(this,"original",""),(0,c.Z)(this,"val",""),(0,c.Z)(this,"cell",void 0),(0,c.Z)(this,"navigKeyDownRequest",new t.vpe),(0,c.Z)(this,"navigBlur",new t.vpe),(0,c.Z)(this,"navigChange",new t.vpe),(0,c.Z)(this,"input",void 0)}ngOnChanges(e){this.changeCell(this.cell)}onNavigKeyDown(e){this.cell&&this.navigKeyDownRequest.emit({cell:this.cell,event:e})}changeCell(e){e&&(this.original=0!==e.frames.length&&e.frames[0].value&&e.frames[0].value.text?this.original=e.frames[0].value.text:"",this.val=this.original)}ngAfterViewInit(){setTimeout(()=>{this.input?.nativeElement&&this.input.nativeElement.focus()},0)}onEnter(){this.onChange(),this.navigBlur.emit()}onChange(){this.cell&&this.val!==this.original&&(0===this.cell.frames.length&&this.cell.frames.push({id:this.cell.column.def.id,value:{id:this.cell.column.def.subid,text:this.val}}),this.cell.frames[0].value.text=this.val,this.navigChange.emit())}onBlur(){this.onChange(),this.navigBlur.emit()}autocompleteEnter(e){this.val=e}autocompleteGetData(e){return(0,m.Z)(function*(){return[]})()}autocompleteSelectResult(e){return this.val=e.data,this.val}}function kn(a,e){if(1&a){const n=t.EpF();t.TgZ(0,"image-cropper",4),t.NdJ("cropperReady",function(){t.CHM(n);const i=t.oxw();return t.KtG(i.cropperReady())})("loadImageFailed",function(){t.CHM(n);const i=t.oxw();return t.KtG(i.loadImageFailed())})("imageLoaded",function(){t.CHM(n);const i=t.oxw();return t.KtG(i.imageLoaded())})("imageCropped",function(i){t.CHM(n);const r=t.oxw();return t.KtG(r.imageCropped(i))}),t.qZA()}if(2&a){const n=t.oxw();t.Q6J("maintainAspectRatio",n.maintainAspectRatio)("format","jpeg")("imageBase64",n.current.source)}}(0,c.Z)(X,"\u0275fac",function(e){return new(e||X)}),(0,c.Z)(X,"\u0275cmp",t.Xpm({type:X,selectors:[["app-cell-editor-txt"]],viewQuery:function(e,n){if(1&e&&t.Gf(bn,7),2&e){let o;t.iGM(o=t.CRH())&&(n.input=o.first)}},inputs:{cell:"cell"},outputs:{navigKeyDownRequest:"navigKeyDownRequest",navigBlur:"navigBlur",navigChange:"navigChange"},features:[t.TTD],decls:2,vars:1,consts:[["type","text","autocomplete","off",3,"ngModel","ngModelChange","blur","keydown.enter"],["inputEl",""]],template:function(e,n){1&e&&(t.TgZ(0,"input",0,1),t.NdJ("ngModelChange",function(i){return n.val=i})("blur",function(){return n.onBlur()})("keydown.enter",function(){return n.onEnter()}),t.qZA()),2&e&&t.Q6J("ngModel",n.val)},dependencies:[g.Fj,g.JJ,g.On],styles:["[_nghost-%COMP%]{width:100%;height:100%}[_nghost-%COMP%]   input[_ngcontent-%COMP%]{width:100%;height:100%;text-align:left}"]}));class U{constructor(){(0,c.Z)(this,"edit",void 0),(0,c.Z)(this,"maintainAspectRatio",!0),(0,c.Z)(this,"current",{})}dialogInit(e,n){this.edit=n.data,this.edit&&(this.edit.result=this.edit.frames.map(o=>({id:o.id,value:{...o.value}})),this.edit.result.length>0&&this.displayFrame(this.edit.result[0]))}displayFrame(e){const n=`data:${e.value.mimeType||"image/jpeg"};base64,${e.value.bin}`;this.current.frame=e,this.current.source=n}onDropFile(e){e.preventDefault(),this.uploadFile(e.dataTransfer?.files)}selectFile(e){this.uploadFile(e.target.files)}onDragOverFile(e){e.stopPropagation(),e.preventDefault()}splitBase64(e){return{mimeType:e.slice(5,e.indexOf(";")),base64:e.slice(e.indexOf("base64,")+7)}}buildFrame(e){const{mimeType:n,base64:o}=this.splitBase64(e);return{id:"APIC",value:{mimeType:n,description:"",bin:o,pictureType:3}}}uploadFile(e){if(!e||0===e.length)return;const n=e[0],o=new FileReader;o.readAsDataURL(n),o.onload=i=>{const r=i.target.result;this.current.frame||(this.current.frame=this.buildFrame(r),this.edit?.result&&this.edit.result.push(this.current.frame)),this.current.source=r;const{mimeType:l,base64:u}=this.splitBase64(r);this.current.frame.value.mimeType=l,this.current.frame.value.bin=u},o.onerror=i=>{console.error(i)}}loadImageFailed(){}cropperReady(){}imageLoaded(){}imageCropped(e){if(this.current?.frame&&e.base64){const{mimeType:n,base64:o}=this.splitBase64(e.base64);this.current.frame.value.mimeType=n,this.current.frame.value.bin=o}}}function yn(a,e){if(1&a){const n=t.EpF();t.TgZ(0,"textarea",1),t.NdJ("ngModelChange",function(i){t.CHM(n);const r=t.oxw();return t.KtG(r.currentLyrics.value.text=i)}),t.qZA()}if(2&a){const n=t.oxw();t.Q6J("ngModel",n.currentLyrics.value.text)}}(0,c.Z)(U,"\u0275fac",function(e){return new(e||U)}),(0,c.Z)(U,"\u0275cmp",t.Xpm({type:U,selectors:[["app-dialog-tag-image"]],decls:7,vars:3,consts:[["type","checkbox",3,"ngModel","checked","ngModelChange"],[1,"drop-zone",3,"drop","dragover"],[3,"maintainAspectRatio","format","imageBase64","cropperReady","loadImageFailed","imageLoaded","imageCropped",4,"ngIf"],["type","file","placeholder","Upload image","accept",".png,.jpeg,.jpg",3,"change"],[3,"maintainAspectRatio","format","imageBase64","cropperReady","loadImageFailed","imageLoaded","imageCropped"]],template:function(e,n){1&e&&(t.TgZ(0,"label")(1,"input",0),t.NdJ("ngModelChange",function(i){return n.maintainAspectRatio=i}),t.qZA(),t._uU(2," Maintain Aspect Ratio\n"),t.qZA(),t.TgZ(3,"div",1),t.NdJ("drop",function(i){return n.onDropFile(i)})("dragover",function(i){return n.onDragOverFile(i)}),t.YNc(4,kn,1,3,"image-cropper",2),t.TgZ(5,"form")(6,"input",3),t.NdJ("change",function(i){return n.selectFile(i)}),t.qZA()()()),2&e&&(t.xp6(1),t.Q6J("ngModel",n.maintainAspectRatio)("checked",n.maintainAspectRatio),t.xp6(3),t.Q6J("ngIf",n.current.source))},dependencies:[C.O5,g._Y,g.Wl,g.JJ,g.JL,g.On,g.F,dt.ap],styles:["[_nghost-%COMP%]   .drop-zone[_ngcontent-%COMP%]{padding:10px 20px;border-width:2px;border-style:dotted;border-color:var(--secondary)}"]}));class z{constructor(){(0,c.Z)(this,"edit",void 0),(0,c.Z)(this,"currentLyrics",void 0)}dialogInit(e,n){this.edit=n.data,this.edit&&(this.edit.result=this.edit.frames.map(o=>({id:o.id,value:{...o.value}})),0===this.edit.result.length&&this.edit.result.push({id:"USLT",value:{id:"",language:"",text:""}}),this.currentLyrics=this.edit.result[0])}}function wn(a,e){if(1&a&&(t.TgZ(0,"div",1),t._uU(1),t.qZA()),2&a){const n=e.$implicit;t.Q6J("title",n),t.xp6(1),t.Oqu(n)}}(0,c.Z)(z,"\u0275fac",function(e){return new(e||z)}),(0,c.Z)(z,"\u0275cmp",t.Xpm({type:z,selectors:[["app-dialog-tag-lyrics"]],decls:1,vars:1,consts:[["autocomplete","off","autocorrect","off","autocapitalize","off","spellcheck","false",3,"ngModel","ngModelChange",4,"ngIf"],["autocomplete","off","autocorrect","off","autocapitalize","off","spellcheck","false",3,"ngModel","ngModelChange"]],template:function(e,n){1&e&&t.YNc(0,yn,1,1,"textarea",0),2&e&&t.Q6J("ngIf",n.currentLyrics)},dependencies:[C.O5,g.Fj,g.JJ,g.On],styles:["[_nghost-%COMP%]   textarea[_ngcontent-%COMP%]{width:100%;height:100%}"]}));class H{constructor(){(0,c.Z)(this,"lines",void 0)}}(0,c.Z)(H,"\u0275fac",function(e){return new(e||H)}),(0,c.Z)(H,"\u0275cmp",t.Xpm({type:H,selectors:[["app-cell-editor-display"]],inputs:{lines:"lines"},decls:1,vars:1,consts:[[3,"title",4,"ngFor","ngForOf"],[3,"title"]],template:function(e,n){1&e&&t.YNc(0,wn,2,2,"div",0),2&e&&t.Q6J("ngForOf",n.lines)},dependencies:[C.sg],styles:["[_nghost-%COMP%]   div[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;text-align:left;padding-left:6px;padding-right:6px}"],changeDetection:0}));const Rn=["cellContainer"];function An(a,e){if(1&a&&t._UZ(0,"app-cell-editor-display",2),2&a){const n=t.oxw();t.Q6J("lines",n.lines)}}function Zn(a,e){1&a&&t.GkF(0,null,3)}class v extends st{constructor(e,n){super(),(0,c.Z)(this,"dialogOverlay",void 0),(0,c.Z)(this,"resolver",void 0),(0,c.Z)(this,"cell",void 0),(0,c.Z)(this,"navigKeyDownRequest",new t.vpe),(0,c.Z)(this,"lines",[]),(0,c.Z)(this,"inactive",!0),(0,c.Z)(this,"container",void 0),(0,c.Z)(this,"unsubscribe",new rt.x),(0,c.Z)(this,"componentRef",void 0),this.dialogOverlay=e,this.resolver=n}ngOnDestroy(){this.clearEdit(),this.unsubscribe.next(),this.unsubscribe.complete()}clickEvent(e){this.edit()}onCellEditorNavigationKeyDown(e){this.navigKeyDownRequest.emit(e)}ngOnChanges(e){e.cell&&this.display()}navigTo(){}static picFrameToString(e){return ht[e.value.pictureType]||"image"}static popularimeterFrameToString(e){return`${e.value.rating} - ${e.value.email} - ${e.value.count}`}static boolFrameToString(e){return`${e.value.bool}`}static textListFrameToString(e){return e.value.list.join("\n")}static textFrameToString(e){return e.value.text}static idTextFrameToString(e){return e.value.text}static playCounterFrameToString(e){return`${e.value.num}`}static geobFrameToString(e){return`Binary ${e.value&&e.value.bin?e.value.bin.length:0} bytes`}static idBinFrameToString(e){return`Binary ${e.value&&e.value.bin?e.value.bin.length:0} bytes`}static langDescFrameToString(e){return e.value.text}edit(){switch(this.cell?.column.def.impl){case s.Filename:case s.IdText:case s.LangDescText:case s.Text:"USLT"===this.cell.column.def.id?this.editLyrics():this.startEdit(X);break;case s.Bool:this.editBool();break;case s.Pic:this.editPictures()}}startEdit(e){this.inactive&&(this.inactive=!1,setTimeout(()=>{this.createComponent(e),this.componentRef&&(this.componentRef.instance.cell=this.cell,this.componentRef.instance.ngOnChanges&&this.componentRef.instance.ngOnChanges({cell:{current:this.cell}}),this.componentRef.instance.navigBlur&&this.componentRef.instance.navigBlur.pipe((0,K.R)(this.unsubscribe)).subscribe(()=>{this.clearEdit(),this.inactive=!0}),this.componentRef.instance.navigChange&&this.componentRef.instance.navigChange.pipe((0,K.R)(this.unsubscribe)).subscribe(()=>{this.setChanged()}))}))}clearEdit(){this.componentRef&&this.componentRef.destroy(),this.container&&this.container.clear()}createComponent(e){if(this.clearEdit(),this.container){const n=this.resolver.resolveComponentFactory(e);this.componentRef=this.container.createComponent(n)}}editBool(){this.cell&&(0===this.cell.frames.length&&this.cell.frames.push({id:this.cell.column.def.id,value:{bool:!1}}),this.cell.frames[0].value.bool=!this.cell.frames[0].value.bool,this.setChanged())}setChanged(){this.cell&&(this.cell.changed=!0,this.cell.parent.changed=!0,this.display())}editPictures(){var e=this;const n=this.cell;if(n){const o={frames:n.frames};this.dialogOverlay.open({title:"Tag Pictures",childComponent:U,data:o,onOkBtn:(i=(0,m.Z)(function*(){return n.frames=o.result||[],e.setChanged(),Promise.resolve()}),function(){return i.apply(this,arguments)}),onCancelBtn:function(){var i=(0,m.Z)(function*(){return Promise.resolve()});return function(){return i.apply(this,arguments)}}()})}var i}editLyrics(){var e=this;const n=this.cell;if(n){const o={frames:n.frames};this.dialogOverlay.open({title:"Tag Lyrics",childComponent:z,data:o,panelClass:"overlay-panel-large-buttons",onOkBtn:(i=(0,m.Z)(function*(){return n.frames=o.result?o.result.filter(r=>r.value.text.length>0):[],e.setChanged(),Promise.resolve()}),function(){return i.apply(this,arguments)}),onCancelBtn:function(){var i=(0,m.Z)(function*(){return Promise.resolve()});return function(){return i.apply(this,arguments)}}()})}var i}display(){this.lines=this.cell?this.cell.frames.map(e=>this.frameToString(e)):[]}frameToString(e){switch(this.cell?.column.def.impl){case s.Filename:case s.Text:return v.textFrameToString(e);case s.LangDescText:return v.langDescFrameToString(e);case s.IdText:return v.idTextFrameToString(e);case s.Pic:return v.picFrameToString(e);case s.TextList:return v.textListFrameToString(e);case s.IdBin:return v.idBinFrameToString(e);case s.GEOB:return v.geobFrameToString(e);case s.Bool:return v.boolFrameToString(e);case s.Popularimeter:return v.popularimeterFrameToString(e);case s.PlayCounter:return v.playCounterFrameToString(e);default:return`TODO CELLEDITOR: ${this.cell?.column.def.name}`}}}function In(a,e){if(1&a){const n=t.EpF();t.TgZ(0,"div",8),t._uU(1," Column Text "),t.TgZ(2,"div",9)(3,"app-tag-editor-autocomplete",16),t.NdJ("valueChange",function(i){t.CHM(n);const r=t.oxw(2);return t.KtG(r.multiStr=i)}),t.qZA()(),t.TgZ(4,"button",12),t.NdJ("click",function(){t.CHM(n);const i=t.oxw(2);return t.KtG(i.editor.setColumnText(i.activeCol,i.multiStr))}),t._uU(5,"Set"),t.qZA(),t.TgZ(6,"button",12),t.NdJ("click",function(){t.CHM(n);const i=t.oxw(2);return t.KtG(i.editor.appendColumnText(i.activeCol,i.multiStr))}),t._uU(7,"Append"),t.qZA(),t.TgZ(8,"button",12),t.NdJ("click",function(){t.CHM(n);const i=t.oxw(2);return t.KtG(i.editor.removeColumnText(i.activeCol,i.multiStr))}),t._uU(9,"Remove"),t.qZA()()}if(2&a){const n=t.oxw(2);t.xp6(3),t.Q6J("value",n.multiStr)("getList",n.activeCol.getAutoCompleteList)}}function Dn(a,e){if(1&a&&(t.TgZ(0,"option",17),t._uU(1),t.qZA()),2&a){const n=e.$implicit;t.Q6J("value",e.index),t.xp6(1),t.Oqu(n.def.name)}}function Sn(a,e){if(1&a){const n=t.EpF();t.TgZ(0,"div",8),t._uU(1),t._UZ(2,"br"),t.TgZ(3,"button",12),t.NdJ("click",function(){const r=t.CHM(n).$implicit;return t.KtG(r.click())}),t._UZ(4,"i",18),t.qZA()()}if(2&a){const n=e.$implicit;t.xp6(1),t.hij(" ",n.title,"")}}function Bn(a,e){if(1&a){const n=t.EpF();t.TgZ(0,"div",1)(1,"div",2)(2,"div",3)(3,"a",4),t.NdJ("click",function(){t.CHM(n);const i=t.oxw();return t.KtG(i.close())})("keydown.enter",function(){t.CHM(n);const i=t.oxw();return t.KtG(i.close())}),t._UZ(4,"i",5),t.qZA()(),t._uU(5," Current Column: "),t.TgZ(6,"span"),t._uU(7),t.qZA()(),t.TgZ(8,"div",6),t.YNc(9,In,10,2,"div",7),t.TgZ(10,"div",8),t._uU(11," Column Source "),t.TgZ(12,"div",9)(13,"select",10),t.NdJ("ngModelChange",function(i){t.CHM(n);const r=t.oxw();return t.KtG(r.sourceColumnIndex=i)}),t.YNc(14,Dn,2,2,"option",11),t.qZA()(),t.TgZ(15,"button",12),t.NdJ("click",function(){t.CHM(n);const i=t.oxw();return t.KtG(i.editor.copyColumn(i.sourceColumnIndex,i.activeCol))}),t._uU(16,"Copy"),t.qZA(),t.TgZ(17,"button",12),t.NdJ("click",function(){t.CHM(n);const i=t.oxw();return t.KtG(i.editor.appendFromColumn(i.sourceColumnIndex,i.activeCol))}),t._uU(18,"Append"),t.qZA(),t.TgZ(19,"div",13)(20,"button",12),t.NdJ("click",function(){t.CHM(n);const i=t.oxw();return t.KtG(i.editor.insertFromColumn(i.sourceColumnIndex,0,i.activeCol))}),t._uU(21,"Insert at"),t.qZA(),t._UZ(22,"input",14),t.qZA()(),t.YNc(23,Sn,5,1,"div",15),t.qZA()()}if(2&a){const n=t.oxw();t.xp6(7),t.Oqu(n.activeCol.def.name),t.xp6(2),t.Q6J("ngIf",n.activeCol.multi),t.xp6(4),t.Q6J("ngModel",n.sourceColumnIndex),t.xp6(1),t.Q6J("ngForOf",n.editor.columns),t.xp6(9),t.Q6J("ngForOf",n.activeCol.actions)}}(0,c.Z)(v,"\u0275fac",function(e){return new(e||v)(t.Y36(yt.SL),t.Y36(t._Vd))}),(0,c.Z)(v,"\u0275cmp",t.Xpm({type:v,selectors:[["app-cell-editor"]],viewQuery:function(e,n){if(1&e&&t.Gf(Rn,5,t.s_b),2&e){let o;t.iGM(o=t.CRH())&&(n.container=o.first)}},hostBindings:function(e,n){1&e&&t.NdJ("click",function(i){return n.clickEvent(i)})},inputs:{cell:"cell"},outputs:{navigKeyDownRequest:"navigKeyDownRequest"},features:[t._Bn([{provide:st,useExisting:(0,t.Gpc)(()=>v)}]),t.qOj,t.TTD],decls:2,vars:2,consts:[[3,"lines",4,"ngIf"],[4,"ngIf"],[3,"lines"],["cellContainer",""]],template:function(e,n){1&e&&(t.YNc(0,An,1,1,"app-cell-editor-display",0),t.YNc(1,Zn,2,0,"ng-container",1)),2&e&&(t.Q6J("ngIf",n.inactive),t.xp6(1),t.Q6J("ngIf",!n.inactive))},dependencies:[C.O5,H]}));class q{constructor(){(0,c.Z)(this,"editor",void 0),(0,c.Z)(this,"activeCol",void 0),(0,c.Z)(this,"requestClose",new t.vpe),(0,c.Z)(this,"sourceColumnIndex",0),(0,c.Z)(this,"multiStr","")}close(){this.requestClose.emit()}}(0,c.Z)(q,"\u0275fac",function(e){return new(e||q)}),(0,c.Z)(q,"\u0275cmp",t.Xpm({type:q,selectors:[["app-admin-tag-editor-column-tool"]],inputs:{editor:"editor",activeCol:"activeCol"},outputs:{requestClose:"requestClose"},decls:1,vars:1,consts:[["class","column-tools",4,"ngIf"],[1,"column-tools"],[1,"column-tools-title"],[1,"close-panel"],["tabindex","0","title","Close",1,"close",3,"click","keydown.enter"],["aria-hidden","true"],[1,"column-tool-content"],["class","column-tool",4,"ngIf"],[1,"column-tool"],[1,"input-box"],[3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[1,"button-on-background",3,"click"],[1,"button-with-add-on","button-insert-at"],["type","number"],["class","column-tool",4,"ngFor","ngForOf"],[3,"value","getList","valueChange"],[3,"value"],[1,"icon-down-thin"]],template:function(e,n){1&e&&t.YNc(0,Bn,24,5,"div",0),2&e&&t.Q6J("ngIf",n.activeCol&&n.editor)},dependencies:[C.sg,C.O5,g.YN,g.Kr,g.EJ,g.JJ,g.On,R],styles:['[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]{border:1px solid var(--control-border);padding-bottom:15px}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .close-panel[_ngcontent-%COMP%]{float:right;display:inline-block;overflow:hidden;width:2.5rem;height:2.5rem;max-width:2.5rem;max-height:2.5rem;margin-top:-15px}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .close-panel[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:2.5rem;height:2.5rem;border:none;background-color:transparent;font-size:1.5rem;transition:.25s linear}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .close-panel[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]:before, [_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .close-panel[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]:after{position:absolute;content:"";width:.75rem;height:.125rem;background-color:var(--on-control-hover);overflow:hidden}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .close-panel[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]:before{transform:rotate(-45deg)}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .close-panel[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]:after{transform:rotate(45deg)}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .close-panel[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]:hover{transform:rotate(360deg)}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .close-panel[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]:hover:before, [_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .close-panel[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]:hover:after{background-color:var(--accent)}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .column-tools-title[_ngcontent-%COMP%]{padding-top:15px;padding-left:15px;padding-right:15px}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .column-tools-title[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--on-control-active)}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .input-box[_ngcontent-%COMP%]{border-radius:3px;padding-left:3px;padding-right:3px;align-items:center;background-color:var(--input);border:1px solid var(--input-border)}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .input-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{flex:1;border:none;min-height:20px;background-color:var(--input);color:var(--on-input)}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .input-box[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:var(--on-input);font-size:14px;cursor:pointer}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .input-box[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]:hover{color:var(--on-input-hover)}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .input-box[_ngcontent-%COMP%]{display:flex}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .button-insert-at[_ngcontent-%COMP%]{display:inline-flex}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .button-insert-at[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:50px;border-color:var(--on-control-ambient)}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   app-tag-editor-autocomplete[_ngcontent-%COMP%]{flex:1;border:none;min-height:24px;height:24px;background-color:var(--input);color:var(--on-input)}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{flex:1;border:none;height:24px;background-color:var(--input);color:var(--on-input);width:100%}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .column-tool-content[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .column-tool[_ngcontent-%COMP%]{padding:15px 15px 0;font-size:.8em;align-self:center}']}));const En=["actionMenu"];function Nn(a,e){1&a&&t._UZ(0,"app-loading")}function Fn(a,e){1&a&&(t._UZ(0,"i",3),t._uU(1," Set Audiobook Frames"))}function Gn(a,e){1&a&&(t._UZ(0,"i",3),t._uU(1," Set Audio Series Frames"))}function Jn(a,e){1&a&&(t._UZ(0,"i",3),t._uU(1," Set Soundtrack Frames"))}function Ln(a,e){1&a&&(t._UZ(0,"i",3),t._uU(1," Set Bootleg Frames"))}function Xn(a,e){1&a&&(t._UZ(0,"i",3),t._uU(1," Set Various Artists Compilation Frames"))}function Un(a,e){1&a&&(t._UZ(0,"i",3),t._uU(1," Search & Fill Missing Lyrics Frames"))}function zn(a,e){if(1&a){const n=t.EpF();t.TgZ(0,"div",8),t._uU(1," This folder does not contain any tracks with tags."),t._UZ(2,"br"),t._uU(3,"Do you want to load all tracks from subfolders?"),t._UZ(4,"br"),t.TgZ(5,"button",9),t.NdJ("click",function(){t.CHM(n);const i=t.oxw(2);return t.KtG(i.loadRecursive())}),t._UZ(6,"i",10),t._uU(7," Load recursive"),t.qZA()()}}function Hn(a,e){if(1&a){const n=t.EpF();t.TgZ(0,"button",20),t.NdJ("click",function(){t.CHM(n);const i=t.oxw(3);return t.KtG(i.save())}),t._UZ(1,"i",21),t.qZA()}}function qn(a,e){1&a&&(t.TgZ(0,"button",22),t._UZ(1,"i",23),t.qZA())}function Qn(a,e){if(1&a){const n=t.EpF();t.TgZ(0,"div",11)(1,"button",12),t.NdJ("click",function(){t.CHM(n);const i=t.oxw(2);return t.KtG(i.refresh())}),t._UZ(2,"i",10),t.qZA(),t.TgZ(3,"button",13),t.NdJ("click",function(){t.CHM(n);const i=t.oxw(2);return t.KtG(i.brainz())}),t._UZ(4,"app-mb-icon",14),t.qZA(),t.TgZ(5,"button",15),t.NdJ("click",function(){t.CHM(n);const i=t.oxw(2);return t.KtG(i.chooseColumns())}),t._UZ(6,"i",16),t.qZA(),t.YNc(7,Hn,2,0,"button",17),t.YNc(8,qn,2,0,"button",18),t.TgZ(9,"button",19),t.NdJ("click",function(i){t.CHM(n);const r=t.oxw(2);return t.KtG(r.onContextMenu(i))}),t._uU(10,"\u2026"),t.qZA()()}if(2&a){const n=t.oxw(2);t.xp6(4),t.Q6J("size",12),t.xp6(3),t.Q6J("ngIf",!n.isSaving),t.xp6(1),t.Q6J("ngIf",n.isSaving)}}function Yn(a,e){1&a&&t._UZ(0,"app-loading")}function Kn(a,e){if(1&a){const n=t.EpF();t.TgZ(0,"th",29),t.NdJ("click",function(){const r=t.CHM(n).$implicit,l=t.oxw(3);return t.KtG(l.activeCol=r)}),t.TgZ(1,"div")(2,"span",30),t._uU(3),t.qZA()()()}if(2&a){const n=e.$implicit;t.xp6(2),t.Q6J("title",n.def.id),t.xp6(1),t.Oqu(n.def.name)}}function jn(a,e){1&a&&t._UZ(0,"col"),2&a&&t.Udp("min-width",e.$implicit.def.width||60,"px")}function $n(a,e){if(1&a){const n=t.EpF();t.TgZ(0,"i",35),t.NdJ("click",function(){t.CHM(n);const i=t.oxw(2).$implicit,r=t.oxw(3);return t.KtG(r.saveEdit(i))}),t.qZA()}}function Vn(a,e){1&a&&t._UZ(0,"i",36)}function Wn(a,e){if(1&a&&(t.ynx(0),t.YNc(1,$n,1,0,"i",33),t.YNc(2,Vn,1,0,"i",34),t.BQk()),2&a){const n=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",!n.saving),t.xp6(1),t.Q6J("ngIf",n.saving)}}function ti(a,e){if(1&a){const n=t.EpF();t.TgZ(0,"td")(1,"app-cell-editor",37),t.NdJ("navigKeyDownRequest",function(i){t.CHM(n);const r=t.oxw(4);return t.KtG(r.onCellEditorNavigationKeyDown(i))}),t.qZA()()}if(2&a){const n=e.$implicit;t.xp6(1),t.ekj("changed",n.changed),t.Q6J("cell",n)}}function ei(a,e){if(1&a&&(t.TgZ(0,"tr")(1,"td",31)(2,"div",32),t.YNc(3,Wn,3,2,"ng-container",0),t.qZA()(),t.YNc(4,ti,2,3,"td",28),t.qZA()),2&a){const n=e.$implicit,o=t.oxw(3);t.xp6(3),t.Q6J("ngIf",n.changed),t.xp6(1),t.Q6J("ngForOf",n.cells)("ngForTrackBy",o.trackByCellFn)}}function ni(a,e){if(1&a&&(t.TgZ(0,"div",24)(1,"table")(2,"thead")(3,"tr",25),t._UZ(4,"th"),t.YNc(5,Kn,4,2,"th",26),t.qZA()(),t.TgZ(6,"colgroup"),t._UZ(7,"col"),t.YNc(8,jn,1,2,"col",27),t.qZA(),t.TgZ(9,"tbody"),t.YNc(10,ei,5,3,"tr",28),t.qZA()()()),2&a){const n=t.oxw(2);t.xp6(5),t.Q6J("ngForOf",n.editor.columns)("ngForTrackBy",n.trackByColumnFn),t.xp6(2),t.Udp("min-width",60,"px"),t.xp6(1),t.Q6J("ngForOf",n.editor.columns)("ngForTrackBy",n.trackByColumnFn),t.xp6(2),t.Q6J("ngForOf",n.editor.edits)("ngForTrackBy",n.trackByEditFn)}}function ii(a,e){if(1&a){const n=t.EpF();t.ynx(0),t.YNc(1,zn,8,0,"div",4),t.YNc(2,Qn,11,3,"div",5),t.TgZ(3,"app-admin-tag-editor-column-tool",6),t.NdJ("requestClose",function(){t.CHM(n);const i=t.oxw();return t.KtG(i.activeCol=void 0)}),t.qZA(),t.YNc(4,Yn,1,0,"app-loading",0),t.YNc(5,ni,11,8,"div",7),t.BQk()}if(2&a){const n=t.oxw();t.xp6(1),t.Q6J("ngIf",n.canLoadRecursive),t.xp6(1),t.Q6J("ngIf",n.tracks&&n.tracks.length>0&&n.editor.edits),t.xp6(1),t.Q6J("editor",n.editor)("activeCol",n.activeCol),t.xp6(1),t.Q6J("ngIf",!n.tracks),t.xp6(1),t.Q6J("ngIf",n.tracks&&n.tracks.length>0&&n.editor.edits)}}class I{constructor(e,n,o,i,r,l){(0,c.Z)(this,"app",void 0),(0,c.Z)(this,"folderService",void 0),(0,c.Z)(this,"contextMenuService",void 0),(0,c.Z)(this,"jam",void 0),(0,c.Z)(this,"notify",void 0),(0,c.Z)(this,"dialogOverlay",void 0),(0,c.Z)(this,"folder",void 0),(0,c.Z)(this,"tracks",void 0),(0,c.Z)(this,"editor",void 0),(0,c.Z)(this,"canLoadRecursive",!1),(0,c.Z)(this,"activeCol",void 0),(0,c.Z)(this,"isSaving",!1),(0,c.Z)(this,"id",void 0),(0,c.Z)(this,"cellEditors",void 0),(0,c.Z)(this,"actionMenu",void 0),this.app=e,this.folderService=n,this.contextMenuService=o,this.jam=i,this.notify=r,this.dialogOverlay=l,this.editor=new k(i)}onScroll(){}canDeactivate(){return!this.isSaving}ngOnChanges(e){this.refresh()}refresh(){this.folder=void 0,this.tracks=void 0,this.activeCol=void 0,this.id&&this.jam.folder.id({id:this.id,folderIncFolders:!0,folderIncTracks:!0,folderIncParents:!0,folderIncTag:!0,trackIncTag:!0,trackIncRawTag:!0,folderChildIncTag:!0}).then(e=>{this.display(e)}).catch(e=>{this.notify.error(e)})}trackByEditFn(e,n){return n.track.id}trackByColumnFn(e,n){return`${n.def.id}${n.def.subid}`}trackByCellFn(e,n){return`${n.column.def.id}${n.column.def.subid}`}loadRecursive(){this.folder&&(this.canLoadRecursive=!1,this.tracks=void 0,this.jam.track.search({childOfID:this.folder.id,trackIncTag:!0,trackIncRawTag:!0,orderBy:_.zj.filename}).then(e=>{this.tracks=e.items,this.editor.build(this.tracks)}).catch(e=>{this.notify.error(e)}))}onCellEditorNavigationKeyDown(e){if((0,j.o)(e.event)){const n=this.editor.edits.findIndex(i=>i===e.cell.parent),o=this.editor.edits[n+((0,j.up)(e.event)?1:-1)];if(o){const i=o.cells[e.cell.parent.cells.indexOf(e.cell)];if(i){const r=this.cellEditors.find(l=>l.cell===i);r&&setTimeout(()=>{r.navigTo()})}}}else if((0,j.ME)(e.event)){const n=e.cell.parent.cells[e.cell.parent.cells.indexOf(e.cell)+((0,j.V8)(e.event)?1:-1)];if(n){const o=this.cellEditors.find(i=>i.cell===n);o&&setTimeout(()=>{o.navigTo()})}}}save(){if(this.isSaving)return;const e=this.editor.edits.filter(i=>i.changed);if(0===e.length)return;const n=[];for(const i of e)i.saving=!0,n.push(this.prepareEditSave(i));const o=n.shift();o&&(this.isSaving=!0,this.runSave(o,n).then(()=>{this.isSaving=!1}).catch(i=>{this.isSaving=!1;for(const r of e)r.saving=!1;this.notify.error(i)}))}prepareEditSave(e){const n={edit:e,track:e.track};let o=e.cells.filter(r=>r.changed);const i=o.find(r=>r.column.def.id===w);if(i){o=o.filter(l=>l.column.def.id!==w);const r=i.frames[0].value.text;r&&e.track.name!==r&&(n.filename=r)}return o.length>0&&(n.rawTag=mt(e)),n}saveEdit(e){if(!e.changed||this.isSaving)return;this.isSaving=!0;const n=this.prepareEditSave(e);this.runSave(n,[]).then(()=>{this.isSaving=!1}).catch(o=>{this.isSaving=!1,this.notify.error(o)})}chooseColumns(){var e=this;this.isSaving&&this.notify.error(Error("Saving is in progress"));const n={columns:this.editor.columns,resultColumns:[]};var o;this.dialogOverlay.open({title:"Choose Columns",childComponent:N,panelClass:"overlay-panel-large-buttons",data:n,onOkBtn:(o=(0,m.Z)(function*(){try{e.tracks&&e.editor.updateColumns(e.tracks,n.resultColumns)}catch(i){return e.notify.error(i),Promise.reject(i)}}),function(){return o.apply(this,arguments)}),onCancelBtn:function(){var o=(0,m.Z)(function*(){return Promise.resolve()});return function(){return o.apply(this,arguments)}}()})}brainz(){if(!this.folder||!this.tracks)return;this.canDeactivate()||this.notify.error(Error("Saving is in progress"));const e={folder:this.folder,matchings:this.tracks.map(n=>({track:n})),apply:()=>{for(const n of e.matchings)n.track&&n.rawTag&&(n.track.tagRaw=n.rawTag);if(this.tracks){this.editor.build(this.tracks);for(const n of e.matchings)if(n.track&&n.rawTag){const o=this.editor.edits.find(i=>i.track===n.track);if(o){o.changed=!0;for(const i of o.cells)i.column.def.id!==w&&(i.changed=!0)}}}}};this.dialogOverlay.open({title:"Release Matching",childComponent:L,data:e,panelClass:"overlay-panel-large"})}editAlbumValues(){var n;(this.canDeactivate()||this.notify.error(Error("Saving is in progress")),this.tracks)&&this.dialogOverlay.open({title:"Edit Album Values",childComponent:E,data:{tracks:this.tracks},onOkBtn:(n=(0,m.Z)(function*(){return Promise.resolve()}),function(){return n.apply(this,arguments)}),onCancelBtn:function(){var n=(0,m.Z)(function*(){return Promise.resolve()});return function(){return n.apply(this,arguments)}}()})}onContextMenu(e){this.contextMenuService.show.next({contextMenu:this.actionMenu,event:e,item:void 0}),e.preventDefault(),e.stopPropagation()}runSave(e,n){var o=this;return(0,m.Z)(function*(){try{if(e.filename){const r=yield o.jam.track.rename({id:e.track.id,name:e.filename});o.folderService.waitForQueueResult("Renaming Track",r,[e.track.parentID],[],[e.track.id])}if(e.rawTag){const r=yield o.jam.track.rawTagSet({id:e.track.id,tag:e.rawTag});o.folderService.waitForQueueResult("Writing Track Tag",r,[e.track.parentID],[],[e.track.id])}e.edit.saving=!1,e.rawTag&&(e.edit.tag=e.rawTag),e.edit.changed=!1}catch(r){return Promise.reject(r)}const i=n.shift();i&&(yield o.runSave(i,n))})()}display(e){this.folder=e,this.tracks=e.tracks||[],this.editor.build(this.tracks),this.canLoadRecursive=0===this.tracks.length&&(e.folders||[]).length>0,this.canLoadRecursive&&e.type===_.Sr.multialbum&&this.loadRecursive()}}(0,c.Z)(I,"\u0275fac",function(e){return new(e||I)(t.Y36(A.zi),t.Y36(A.Cr),t.Y36(at.Lk),t.Y36(_.K4),t.Y36(A.c),t.Y36(yt.SL))}),(0,c.Z)(I,"\u0275cmp",t.Xpm({type:I,selectors:[["app-admin-tag-editor"]],viewQuery:function(e,n){if(1&e&&(t.Gf(En,5),t.Gf(st,5)),2&e){let o;t.iGM(o=t.CRH())&&(n.actionMenu=o.first),t.iGM(o=t.CRH())&&(n.cellEditors=o)}},hostBindings:function(e,n){1&e&&t.NdJ("beforeunload",function(){return n.canDeactivate()},!1,t.Jf7)},inputs:{id:"id"},features:[t.TTD],decls:10,vars:2,consts:[[4,"ngIf"],["actionMenu",""],["contextMenuItem","",3,"execute"],[1,"icon-edit"],["class","load-recursive",4,"ngIf"],["class","actions",4,"ngIf"],[3,"editor","activeCol","requestClose"],["class","editor",4,"ngIf"],[1,"load-recursive"],["title","Load all Tracks",1,"button-on-control",3,"click"],[1,"icon-reload"],[1,"actions"],["title","Refresh",1,"button-on-control",3,"click"],["title","Match with MusicBrainz",1,"button-on-control",3,"click"],[3,"size"],["title","Choose Columns",1,"button-on-control",3,"click"],[1,"icon-list-add"],["class","button-on-control","title","Save",3,"click",4,"ngIf"],["class","button-on-control","title","Save",4,"ngIf"],["title","More",1,"button-on-control",3,"click"],["title","Save",1,"button-on-control",3,"click"],[1,"icon-floppy"],["title","Save",1,"button-on-control"],[1,"icon-spin","icon-spnner"],[1,"editor"],[1,"header-row"],["class","header-row-title",3,"click",4,"ngFor","ngForOf","ngForTrackBy"],[3,"min-width",4,"ngFor","ngForOf","ngForTrackBy"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"header-row-title",3,"click"],[3,"title"],[1,"col-state"],[1,"cell-editor"],["class","icon-floppy",3,"click",4,"ngIf"],["class","icon-spin icon-spinner",4,"ngIf"],[1,"icon-floppy",3,"click"],[1,"icon-spin","icon-spinner"],[1,"cell-editor",3,"cell","navigKeyDownRequest"]],template:function(e,n){1&e&&(t.YNc(0,Nn,1,0,"app-loading",0),t.TgZ(1,"context-menu",null,1),t.YNc(3,Fn,2,0,"ng-template",2),t.NdJ("execute",function(){return n.editor.setAudiobookFrames(n.tracks)}),t.YNc(4,Gn,2,0,"ng-template",2),t.NdJ("execute",function(){return n.editor.setAudioSeriesFrames(n.tracks)}),t.YNc(5,Jn,2,0,"ng-template",2),t.NdJ("execute",function(){return n.editor.setSoundtrackFrames(n.tracks)}),t.YNc(6,Ln,2,0,"ng-template",2),t.NdJ("execute",function(){return n.editor.setBootlegFrames(n.tracks)}),t.YNc(7,Xn,2,0,"ng-template",2),t.NdJ("execute",function(){return n.editor.setVariousArtistFrames(n.tracks)}),t.YNc(8,Un,2,0,"ng-template",2),t.NdJ("execute",function(){return n.editor.findMissingLyrics(n.tracks)}),t.qZA(),t.YNc(9,ii,6,6,"ng-container",0)),2&e&&(t.Q6J("ngIf",!n.folder),t.xp6(9),t.Q6J("ngIf",n.folder))},dependencies:[C.sg,C.O5,On.N,Pn.J,bt.G,kt.n,v,q],styles:["[_nghost-%COMP%]{height:100%;width:100%;overflow:hidden;display:flex;flex-direction:column}[_nghost-%COMP%]   .actions[_ngcontent-%COMP%]{padding:10px 15px 0;border-bottom-color:var(--background-border);border-bottom-width:1px;border-bottom-style:solid}[_nghost-%COMP%]   .actions[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{margin-right:5px;margin-bottom:10px}[_nghost-%COMP%]   .actions[_ngcontent-%COMP%] > label[_ngcontent-%COMP%]{text-transform:uppercase;letter-spacing:1px;font-size:11px;margin-left:5px;margin-right:5px}[_nghost-%COMP%]   .load-recursive[_ngcontent-%COMP%]{text-align:center;margin-top:30px;margin-left:30px;margin-right:30px}[_nghost-%COMP%]   .load-recursive[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-top:10px}[_nghost-%COMP%]   .editor[_ngcontent-%COMP%]{width:100%;height:100%;display:block;position:relative;overflow:auto}[_nghost-%COMP%]   .editor[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{table-layout:fixed;border-width:0;width:auto}[_nghost-%COMP%]   .editor[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .cell-editor[_ngcontent-%COMP%]{width:100%;height:34px;border-top-width:1px;border-top-style:solid;border-left-width:1px;border-left-style:solid;text-align:left;padding-bottom:1px;padding-top:1px;font-size:11px;color:var(--on-background);border-color:var(--background-border);overflow:hidden;display:flex;align-items:center}[_nghost-%COMP%]   .editor[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .cell-editor.changed[_ngcontent-%COMP%]{padding-bottom:0;padding-top:0;border-width:1px;border-style:solid;border-left-width:2px;border-top-width:2px;border-color:var(--background-box)}[_nghost-%COMP%]   .editor[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .cell-editor[_ngcontent-%COMP%]:focus-within{padding-bottom:0;padding-top:0;border-width:1px;border-style:solid;border-left-width:2px;border-top-width:2px;color:var(--on-background-active)}[_nghost-%COMP%]   .editor[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{border-right-width:1px;border-right-style:solid;border-right-color:var(--background-border)}[_nghost-%COMP%]   .editor[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr.header-row[_ngcontent-%COMP%]{border-top-width:1px;border-top-style:solid;border-top-color:var(--background-border)}[_nghost-%COMP%]   .editor[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr.header-row[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;font-size:.8em;padding-left:4px;padding-right:4px;border-top:none;border-bottom:none;color:var(--on-background-active);background-color:var(--background);position:sticky}[_nghost-%COMP%]   .editor[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr.header-row[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{padding:0;visibility:hidden}[_nghost-%COMP%]   .editor[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr.header-row[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:hover   .actions[_ngcontent-%COMP%]{visibility:inherit}[_nghost-%COMP%]   .editor[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th.header-row-title[_ngcontent-%COMP%]{cursor:pointer;-webkit-user-select:none;user-select:none}[_nghost-%COMP%]   .editor[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border:none;max-width:200px}[_nghost-%COMP%]   .editor[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td.col-state[_ngcontent-%COMP%]{text-align:center}[_nghost-%COMP%]   .editor[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td.col-state[_ngcontent-%COMP%]   .cell-editor[_ngcontent-%COMP%]{padding-top:6px;font-size:18px}[_nghost-%COMP%]   .editor[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:last-of-type   .cell-editor[_ngcontent-%COMP%]{border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:var(--background-border)}"]}));class Q{constructor(e){(0,c.Z)(this,"route",void 0),(0,c.Z)(this,"id",void 0),(0,c.Z)(this,"child",void 0),(0,c.Z)(this,"unsubscribe",new rt.x),this.route=e}ngOnInit(){this.route.parent?.parent?.params&&this.route.parent.parent.params.pipe((0,K.R)(this.unsubscribe)).subscribe(e=>{this.id=e.id})}ngOnDestroy(){this.unsubscribe.next(),this.unsubscribe.complete()}canDeactivate(){return!(!this.child||!this.child.canDeactivate())}}(0,c.Z)(Q,"\u0275fac",function(e){return new(e||Q)(t.Y36(gt.gz))}),(0,c.Z)(Q,"\u0275cmp",t.Xpm({type:Q,selectors:[["app-admin-folder-tag-editor"]],viewQuery:function(e,n){if(1&e&&t.Gf(I,7),2&e){let o;t.iGM(o=t.CRH())&&(n.child=o.first)}},decls:1,vars:1,consts:[[3,"id"]],template:function(e,n){1&e&&t._UZ(0,"app-admin-tag-editor",0),2&e&&t.Q6J("id",n.id)},dependencies:[I],styles:["[_nghost-%COMP%]{height:100%;width:100%;overflow:hidden;display:block}"]}));const ai=gt.Bz.forChild([{path:"",component:Q}]);class it{constructor(){(0,c.Z)(this,"edit",void 0),(0,c.Z)(this,"current",void 0),(0,c.Z)(this,"currentText",void 0)}dialogInit(e,n){this.edit=n.data,this.edit&&(this.edit.result=this.edit.frames.map(o=>({id:o.id,value:{...o.value}})),0===this.edit.result.length&&this.edit.result.push({id:this.edit.id,value:{list:[]}}),this.current=this.edit.result[0],this.currentText=this.current.value.list.join("\n"))}onBlur(){this.current&&this.currentText&&(this.current.value.list=this.currentText.split("\n"))}}(0,c.Z)(it,"\u0275fac",function(e){return new(e||it)}),(0,c.Z)(it,"\u0275cmp",t.Xpm({type:it,selectors:[["app-dialog-tag-textlist"]],decls:1,vars:1,consts:[["autocomplete","off","autocorrect","off","autocapitalize","off","spellcheck","false",3,"ngModel","ngModelChange","blur"]],template:function(e,n){1&e&&(t.TgZ(0,"textarea",0),t.NdJ("ngModelChange",function(i){return n.currentText=i})("blur",function(){return n.onBlur()}),t.qZA()),2&e&&t.Q6J("ngModel",n.currentText)},dependencies:[g.Fj,g.JJ,g.On],styles:["[_nghost-%COMP%]   textarea[_ngcontent-%COMP%]{width:100%;height:100%}"]}));const ri=["editorStart"],si=["editorInput"];function ci(a,e){if(1&a&&(t.TgZ(0,"app-autocomplete-option-header"),t._uU(1),t.qZA()),2&a){const n=t.oxw().$implicit;t.xp6(1),t.Oqu(n.header)}}function li(a,e){if(1&a&&(t.ynx(0),t.YNc(1,ci,2,1,"app-autocomplete-option-header",0),t.TgZ(2,"app-autocomplete-option",7),t._uU(3),t.qZA(),t.BQk()),2&a){const n=e.$implicit,o=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",n.header),t.xp6(1),t.Q6J("option",n)("control",o),t.xp6(1),t.Oqu(n.data)}}function ui(a,e){1&a&&t.YNc(0,li,4,4,"ng-container",6),2&a&&t.Q6J("ngForOf",e.$implicit.options)}const di=function(){return{allowEmpty:!0}};function gi(a,e){if(1&a){const n=t.EpF();t.ynx(0),t.TgZ(1,"app-autocomplete",null,2),t.YNc(3,ui,1,1,"ng-template",3),t.qZA(),t.TgZ(4,"input",4,5),t.NdJ("ngModelChange",function(i){t.CHM(n);const r=t.oxw();return t.KtG(r.value=i)})("blur",function(){t.CHM(n);const i=t.oxw();return t.KtG(i.onBlur())})("appAutocompleteNavigKeyDown",function(i){t.CHM(n);const r=t.oxw();return t.KtG(r.onNavigKeyDown(i))}),t.qZA(),t.BQk()}if(2&a){const n=t.MAs(2),o=t.oxw();t.xp6(4),t.Q6J("ngModel",o.value)("value",o.value)("appAutocomplete",n)("appAutocompleteControl",o)("appAutocompleteSettings",t.DdM(5,di))}}function pi(a,e){if(1&a){const n=t.EpF();t.TgZ(0,"div",8,9),t.NdJ("focus",function(){t.CHM(n);const i=t.oxw();return t.KtG(i.editValue())}),t._uU(2),t.qZA()}if(2&a){const n=t.oxw();t.Q6J("title",n.value),t.xp6(2),t.Oqu(n.value)}}class Y{constructor(){(0,c.Z)(this,"getList",void 0),(0,c.Z)(this,"value",void 0),(0,c.Z)(this,"data",void 0),(0,c.Z)(this,"valueChange",new t.vpe),(0,c.Z)(this,"endEditRequest",new t.vpe),(0,c.Z)(this,"navigKeyDownRequest",new t.vpe),(0,c.Z)(this,"editorStartRef",void 0),(0,c.Z)(this,"editorInput",void 0),(0,c.Z)(this,"editing",!1),(0,c.Z)(this,"list",[]),(0,c.Z)(this,"autoCompleteValue",""),(0,c.Z)(this,"onChange",Function.prototype),(0,c.Z)(this,"onTouched",Function.prototype)}startEdit(){this.editorStartRef&&this.editorStartRef.nativeElement.focus()}onNavigKeyDown(e){this.navigKeyDownRequest.emit(e)}writeValue(e){this.autoCompleteValue=e}registerOnChange(e){this.onChange=e}registerOnTouched(e){this.onTouched=e}onBlur(){this.autoCompleteValue!==this.value&&this.valueChange.emit(this.value),this.editing=!1,this.endEditRequest.emit()}apply(){this.editing=!1,this.endEditRequest.emit()}editValue(){this.list=[],this.editing=!0,this.autoCompleteValue=this.value,this.getList&&(this.list=this.getList(this.data)),setTimeout(()=>{this.editorInput&&this.editorInput.nativeElement.focus()})}autocompleteEnter(e){this.value=e}autocompleteGetData(e){var n=this;return(0,m.Z)(function*(){return 0===e.length?n.list.map(o=>({data:o})):n.list.filter(o=>o.includes(e)).map(o=>({data:o}))})()}autocompleteSelectResult(e){return this.autoCompleteValue=e.data,this.value=e.data,this.value||""}}(0,c.Z)(Y,"\u0275fac",function(e){return new(e||Y)}),(0,c.Z)(Y,"\u0275cmp",t.Xpm({type:Y,selectors:[["app-tag-editor-inline-autocomplete"]],viewQuery:function(e,n){if(1&e&&(t.Gf(ri,5),t.Gf(si,5)),2&e){let o;t.iGM(o=t.CRH())&&(n.editorStartRef=o.first),t.iGM(o=t.CRH())&&(n.editorInput=o.first)}},inputs:{getList:"getList",value:"value",data:"data"},outputs:{valueChange:"valueChange",endEditRequest:"endEditRequest",navigKeyDownRequest:"navigKeyDownRequest"},features:[t._Bn([{provide:g.JU,useExisting:Y,multi:!0}])],decls:2,vars:2,consts:[[4,"ngIf"],["tabindex","0",3,"title","focus",4,"ngIf"],["autocomplete","appAutocomplete"],["appAutocompleteContent",""],["type","text","autocomplete","off",3,"ngModel","value","appAutocomplete","appAutocompleteControl","appAutocompleteSettings","ngModelChange","blur","appAutocompleteNavigKeyDown"],["editorInput",""],[4,"ngFor","ngForOf"],[3,"option","control"],["tabindex","0",3,"title","focus"],["editorStart",""]],template:function(e,n){1&e&&(t.YNc(0,gi,6,6,"ng-container",0),t.YNc(1,pi,3,2,"div",1)),2&e&&(t.Q6J("ngIf",n.editing),t.xp6(1),t.Q6J("ngIf",!n.editing))},dependencies:[C.sg,C.O5,g.Fj,g.JJ,g.On,ft.Y,Ct.oK,Tt.G,vt.x,Mt.B],styles:["[_nghost-%COMP%]{height:100%;width:100%;display:block}[_nghost-%COMP%]   div[_ngcontent-%COMP%]{height:100%;width:100%;cursor:pointer;overflow:hidden;display:block;white-space:nowrap;text-overflow:ellipsis;padding-top:8px;padding-left:7px;padding-right:7px}[_nghost-%COMP%]   input[_ngcontent-%COMP%]{height:100%;width:100%;border:0;padding-left:5px;background-color:var(--control-box);color:var(--on-control-ambient-hover)}"]}));class ot{transform(e){return ht[e]||"image"}}(0,c.Z)(ot,"\u0275fac",function(e){return new(e||ot)}),(0,c.Z)(ot,"\u0275pipe",t.Yjl({name:"picType",type:ot,pure:!0}));class D{}(0,c.Z)(D,"\u0275fac",function(e){return new(e||D)}),(0,c.Z)(D,"\u0275mod",t.oAB({type:D})),(0,c.Z)(D,"\u0275inj",t.cJS({imports:[C.ez,At.m,g.u5,dt.QG,at.vI,wt.Cl,Rt.In,ai]}))}}]);