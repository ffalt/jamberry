import{a as xe,b as _e,c as Ie}from"./chunk-F6BYEP4R.js";import{A as Me,B as ye,q as ve,v as ge,y as Ce,z as be}from"./chunk-ZVKVGF76.js";import{$a as P,Da as Y,Gb as ne,Gc as Q,Hb as B,Ib as U,Kb as oe,Lb as ie,Mb as se,Nb as I,O as z,Ob as w,Pb as S,Pc as le,Uc as a,Vc as l,Wc as X,Xc as me,Zc as de,_a as C,_b as N,_c as f,a as h,ab as x,b as O,da as $,db as Z,dc as E,ea as G,f as y,fc as c,ga as J,h as W,ia as p,jc as re,k as H,kc as ue,lc as ae,mc as ce,na as v,nb as _,nc as F,oa as g,ob as ee,oc as D,pb as te,pd as pe,rc as A,rd as fe,sb as q,wd as he}from"./chunk-H2EXZDP6.js";var Ee=["content"],we=i=>({item:i});function De(i,o){}function ke(i,o){if(i&1){let s=N();w(0,"span",3,0),E("click",function(t){v(s);let n=c(2);return g(n.stopEvent(t))})("contextmenu",function(t){v(s);let n=c(2);return g(n.stopEvent(t))}),q(2,De,0,0,"ng-template",4),S()}if(i&2){let s=c(2);A("disabled",!s.menuItem().isEnabled),x(2),I("ngTemplateOutlet",s.menuItem().template)("ngTemplateOutletContext",Q(4,we,s.item()))}}function Te(i,o){}function Oe(i,o){if(i&1){let s=N();w(0,"a",5,0),E("click",function(t){v(s);let n=c(2);return g(n.onMenuItemSelect(t))})("mouseenter",function(t){v(s);let n=c(2);return g(n.onOpenSubMenu(t))}),q(2,Te,0,0,"ng-template",4),S()}if(i&2){let s=c(2);A("active",s.menuItem().isActive&&s.menuItem().isEnabled)("disabled",!s.menuItem().isEnabled)("hasSubMenu",!!s.menuItem().subMenu()),x(2),I("ngTemplateOutlet",s.menuItem().template)("ngTemplateOutletContext",Q(8,we,s.item()))}}function Ne(i,o){if(i&1&&B(0,ke,3,6,"span",1)(1,Oe,3,10,"a",2),i&2){let s=c();U(s.menuItem().passive()?0:1)}}var V=(()=>{let o=class o{constructor(){this.menuItem=l.required(),this.item=l.required(),this.itemRef=X("content"),this.itemSelect=a(),this.openSubmenu=a()}stopEvent(e){e.stopPropagation()}focus(){this.itemRef()?.nativeElement.focus()}onMenuItemSelect(e){e.preventDefault(),e.stopPropagation(),this.itemSelect.emit({event:e,menuItem:this.menuItem()})}onOpenSubMenu(e){this.openSubmenu.emit({event:e,menuItem:this.menuItem()})}};o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=_({type:o,selectors:[["context-menu-content-item"]],viewQuery:function(t,n){t&1&&F(n.itemRef,Ee,5),t&2&&D()},inputs:{menuItem:[1,"menuItem"],item:[1,"item"]},outputs:{itemSelect:"itemSelect",openSubmenu:"openSubmenu"},decls:1,vars:1,consts:[["content",""],["role","menuitem",1,"passive",3,"disabled"],["href","","role","menuitem","tabindex","-1",3,"active","disabled","hasSubMenu"],["role","menuitem",1,"passive",3,"click","contextmenu"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["href","","role","menuitem","tabindex","-1",3,"click","mouseenter"]],template:function(t,n){t&1&&B(0,Ne,2,1),t&2&&U(n.menuItem().divider()?-1:0)},dependencies:[fe],encapsulation:2});let i=o;return i})();var k=new J("CONTEXT_MENU_OPTIONS");var Fe=["menu"],Ae=["li"];function Le(i,o){if(i&1){let s=N();w(0,"li",null,1)(2,"context-menu-content-item",5),E("itemSelect",function(t){v(s);let n=c();return g(n.onMenuItemSelect(t))})("openSubmenu",function(t){v(s);let n=c();return g(n.onOpenSubMenu(t))}),S()()}if(i&2){let s=o.$implicit,e=c();A("disabled",!s.isEnabled)("divider",s.divider())("dropdown-divider",s.divider())("active",s.isActive&&s.isEnabled),ne("role",s.divider()?"separator":void 0),x(2),I("item",e.item())("menuItem",s)}}var Se=(()=>{let o=class o{constructor(){this.menuItems=f([]),this.item=f(),this.event=f(),this.parentContextMenu=f(),this.menuClass=f(),this.overlay=f(),this.isLeaf=f(!1),this.execute=a(),this.openSubMenu=a(),this.closeLeafMenu=a(),this.closeAllMenus=a(),this.menuElement=X.required("menu"),this.menuItemElements=me("li"),this.autoFocus=!1,this.options=p(k,{optional:!0}),this.subscription=new y,this.options&&(this.autoFocus=!!this.options.autoFocus)}ngOnInit(){let e=this.menuItems(),t=this.item();for(let n of e)n.currentItem=t,this.subscription.add(n.execute.subscribe(u=>{this.execute.emit(O(h({},u),{menuItem:n}))}))}registerKeys(){this.keyManager=new Ie(this.menuItemFocusElements).withWrap()}ngAfterViewInit(){this.autoFocus&&setTimeout(()=>{this.focus()}),this.registerKeys(),this.menuItemFocusElements.changes.subscribe(()=>{this.registerKeys()}),this.overlay()?.updatePosition()}ngOnDestroy(){this.subscription.unsubscribe()}focus(){this.autoFocus&&this.menuElement().nativeElement.focus()}getKeyManagerMenuItem(){return this.menuItems()[this.keyManager.activeItemIndex??-1]}onKeyEvent(e){this.keyManager.onKeydown(e)}keyboardOpenSubMenu(e){if(!this.isLeaf())return;this.cancelEvent(e);let t=this.getKeyManagerMenuItem();t&&this.onOpenSubMenu({menuItem:t,event:e})}keyboardMenuItemSelect(e){if(!this.isLeaf())return;this.cancelEvent(e);let t=this.getKeyManagerMenuItem();t&&this.onMenuItemSelect({menuItem:t,event:e})}onCloseLeafMenu(e){this.isLeaf()&&(this.cancelEvent(e),this.closeLeafMenu.emit({exceptRootMenu:e.code==="ArrowLeft",event:e}))}closeMenu(e){e.type==="click"&&e.button===2||this.closeAllMenus.emit({event:e})}onOpenSubMenu(e){let n=(this.keyManager.activeItemIndex===null?void 0:this.menuItemElements().at(this.keyManager.activeItemIndex))?.nativeElement;this.openSubMenu.emit({anchorElement:n,contextMenu:e.menuItem.subMenu(),event:e.event,item:this.item(),parentContextMenu:this})}onMenuItemSelect(e){e.menuItem.subMenu()?this.onOpenSubMenu(e):e.menuItem.triggerExecute(this.item(),e.event)}cancelEvent(e){let t=e.target;["INPUT","TEXTAREA","SELECT"].includes(t.tagName)||t.isContentEditable||(e.preventDefault(),e.stopPropagation())}};o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=_({type:o,selectors:[["context-menu-content"]],viewQuery:function(t,n){if(t&1&&(F(n.menuElement,Fe,5),F(n.menuItemElements,Ae,5),re(V,5)),t&2){D(2);let u;ue(u=ae())&&(n.menuItemFocusElements=u)}},hostBindings:function(t,n){t&1&&E("keydown.ArrowDown",function(r){return n.onKeyEvent(r)},C)("keydown.ArrowUp",function(r){return n.onKeyEvent(r)},C)("keydown.ArrowRight",function(r){return n.keyboardOpenSubMenu(r)},C)("keydown.Space",function(r){return n.keyboardMenuItemSelect(r)},C)("keydown.Enter",function(r){return n.keyboardMenuItemSelect(r)},C)("keydown.ArrowLeft",function(r){return n.onCloseLeafMenu(r)},C)("keydown.Escape",function(r){return n.onCloseLeafMenu(r)},C)("contextmenu",function(r){return n.closeMenu(r)},P)("click",function(r){return n.closeMenu(r)},P)},inputs:{menuItems:[1,"menuItems"],item:[1,"item"],event:[1,"event"],parentContextMenu:[1,"parentContextMenu"],menuClass:[1,"menuClass"],overlay:[1,"overlay"],isLeaf:[1,"isLeaf"]},outputs:{menuItems:"menuItemsChange",item:"itemChange",event:"eventChange",parentContextMenu:"parentContextMenuChange",menuClass:"menuClassChange",overlay:"overlayChange",isLeaf:"isLeafChange",execute:"execute",openSubMenu:"openSubMenu",closeLeafMenu:"closeLeafMenu",closeAllMenus:"closeAllMenus"},decls:5,vars:1,consts:[["menu",""],["li",""],[1,"dropdown","open","show","ngx-contextmenu",3,"ngClass"],["cdkTrapFocus","","role","menu","tabindex","0",1,"dropdown-menu","show",2,"position","static","float","none"],[3,"disabled","divider","dropdown-divider","active"],[3,"itemSelect","openSubmenu","item","menuItem"]],template:function(t,n){t&1&&(w(0,"div",2)(1,"ul",3,0),ie(3,Le,3,11,"li",4,oe),S()()),t&2&&(I("ngClass",n.menuClass()||""),x(3),se(n.menuItems()))},dependencies:[pe,xe,V],styles:['.passive[_ngcontent-%COMP%]{display:block;padding:3px 20px;clear:both;font-weight:400;white-space:nowrap}.hasSubMenu[_ngcontent-%COMP%]:before{content:"u25B6";float:right}']});let i=o;return i})();function j(i){let o=le(i);return new W(s=>{let e=o?.onDestroy(()=>s.complete()),t=i.subscribe(n=>s.next(n));return()=>{t.unsubscribe(),e?.()}})}var R=(()=>{let o=class o{constructor(){this.isDestroyingLeafMenu=!1,this.show=new H,this.close=new H,this.overlay=p(be),this.scrollStrategy=p(ge),this.fakeElement={getBoundingClientRect:()=>({bottom:0,height:0,left:0,right:0,top:0,width:0})},this.overlays=[]}openContextMenu(e){let{anchorElement:t,event:n,parentContextMenu:u}=e;if(u){let r=this.overlay.position().flexibleConnectedTo(new Y(n?n.target:t)).withPositions([{originX:"end",originY:"top",overlayX:"start",overlayY:"top"},{originX:"start",originY:"top",overlayX:"end",overlayY:"top"},{originX:"end",originY:"bottom",overlayX:"start",overlayY:"bottom"},{originX:"start",originY:"bottom",overlayX:"end",overlayY:"bottom"}]).withFlexibleDimensions(!1),b=this.overlay.create({positionStrategy:r,panelClass:"ngx-contextmenu",scrollStrategy:this.scrollStrategy.close()});this.destroySubMenus(u),this.overlays=[...this.overlays,b],this.attachContextMenu(b,e)}else{let r=n;this.fakeElement.getBoundingClientRect=()=>({left:r.clientX,top:r.clientY,right:r.clientX,bottom:r.clientY,height:0,width:0}),this.closeAllContextMenus({eventType:"cancel",event:n});let b=this.overlay.position().flexibleConnectedTo(new Y(t??this.fakeElement)).withPositions([{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom"},{originX:"end",originY:"top",overlayX:"start",overlayY:"top"},{originX:"start",originY:"top",overlayX:"end",overlayY:"top"},{originX:"end",originY:"center",overlayX:"start",overlayY:"center"},{originX:"start",originY:"center",overlayX:"end",overlayY:"center"}]).withFlexibleDimensions(!1);this.overlays=[this.overlay.create({positionStrategy:b,panelClass:"ngx-contextmenu",scrollStrategy:this.scrollStrategy.close()})],this.attachContextMenu(this.overlays[0],e)}}attachContextMenu(e,t){let{event:n,item:u,menuItems:r,menuClass:b}=t,m=e.attach(new ve(Se)),M=m.instance;M.event.set(n),M.item.set(u),M.menuItems.set(r),M.overlay.set(e),M.isLeaf.set(!0),M.menuClass.set(b),e.contextMenu=m.instance;let T=new y;T.add(j(m.instance.execute).subscribe(d=>{this.closeAllContextMenus(h({eventType:"execute"},d))})),T.add(j(m.instance.closeAllMenus).subscribe(d=>{this.closeAllContextMenus(h({eventType:"cancel"},d))})),T.add(j(m.instance.closeLeafMenu).subscribe(d=>{this.destroyLeafMenu(d)})),T.add(j(m.instance.openSubMenu).subscribe(d=>{if(this.destroySubMenus(m.instance),!d.contextMenu){m.instance.isLeaf.set(!0);return}m.instance.isLeaf.set(!1),this.show.next(d)})),m.onDestroy(()=>{for(let d of r)d.isActive=!1;T.unsubscribe()}),m.changeDetectorRef.detectChanges()}closeAllContextMenus(e){this.close.next(e);for(let t of this.overlays)t.detach(),t.dispose();this.overlays=[]}getLastAttachedOverlay(){let e=this.overlays.at(-1);for(;this.overlays.length>1&&e&&!e.hasAttached();)e.detach(),e.dispose(),this.overlays=this.overlays.slice(0,-1),e=this.overlays.at(-1);return e}destroyLeafMenu({exceptRootMenu:e,event:t}={}){this.isDestroyingLeafMenu||(this.isDestroyingLeafMenu=!0,setTimeout(()=>{let n=this.getLastAttachedOverlay();this.overlays.length>1&&n&&(n.detach(),n.dispose()),!e&&this.overlays.length>0&&n&&(this.close.next({eventType:"cancel",event:t}),n.detach(),n.dispose());let u=this.getLastAttachedOverlay();u?.contextMenu&&u.contextMenu.isLeaf.set(!0),this.isDestroyingLeafMenu=!1}))}destroySubMenus(e){let t=e.overlay();if(t){let n=this.overlays.indexOf(t),u=this.overlays.slice(n+1);for(let r of u)r.detach(),r.dispose()}}};o.\u0275fac=function(t){return new(t||o)},o.\u0275prov=$({token:o,factory:o.\u0275fac});let i=o;return i})();var K=(()=>{let o=class o{constructor(){this.subMenu=l(),this.divider=l(!1),this.enabled=l(!0),this.passive=l(!1),this.visible=l(!0),this.execute=a(),this.template=p(Z),this.isActive=!1}get isVisible(){return this.evaluateIfFunction(this.visible(),this)}get isEnabled(){return this.evaluateIfFunction(this.enabled(),this)}get disabled(){return this.passive()||this.divider()||!this.evaluateIfFunction(this.enabled(),this.currentItem)}evaluateIfFunction(e,t){return typeof e=="function"?e(t):e}setActiveStyles(){this.isActive=!0}setInactiveStyles(){this.isActive=!1}triggerExecute(e,t){this.isEnabled&&this.execute.emit({event:t,item:e})}};o.\u0275fac=function(t){return new(t||o)},o.\u0275dir=te({type:o,selectors:[["","contextMenuItem",""]],inputs:{subMenu:[1,"subMenu"],divider:[1,"divider"],enabled:[1,"enabled"],passive:[1,"passive"],visible:[1,"visible"]},outputs:{execute:"execute"}});let i=o;return i})();var Tt=(()=>{let o=class o{constructor(){this.menuClass=l(""),this.disabled=l(!1),this.autoFocus=f(!1),this.closeEvent=a(),this.openEvent=a(),this.menuItems=de(K),this.visibleMenuItems=[],this.subscription=new y,this.contextMenuService=p(R),this.options=p(k,{optional:!0}),this.options&&this.autoFocus.set(this.options.autoFocus),this.subscription.add(this.contextMenuService.show.subscribe(e=>{this.onMenuEvent(e)}))}ngOnDestroy(){this.subscription.unsubscribe()}onMenuEvent(e){if(this.disabled())return;let{contextMenu:t,event:n,item:u}=e;t&&t!==this||(this.event=n,this.item=u,this.setVisibleMenuItems(),this.contextMenuService.openContextMenu(O(h({},e),{menuItems:this.visibleMenuItems,menuClass:this.menuClass()})),this.contextMenuService.close.asObservable().pipe(z()).subscribe(r=>{this.closeEvent.emit(r)}),this.openEvent.emit(e))}setVisibleMenuItems(){this.visibleMenuItems=this.menuItems().filter(e=>e.isVisible)}};o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=_({type:o,selectors:[["context-menu"]],contentQueries:function(t,n,u){t&1&&ce(u,n.menuItems,K,4),t&2&&D()},inputs:{menuClass:[1,"menuClass"],disabled:[1,"disabled"],autoFocus:[1,"autoFocus"]},outputs:{autoFocus:"autoFocusChange",closeEvent:"closeEvent",openEvent:"openEvent"},decls:0,vars:0,template:function(t,n){},styles:[`.cdk-overlay-container{position:fixed;z-index:1000;pointer-events:none;top:0;left:0;width:100%;height:100%}.ngx-contextmenu.cdk-overlay-pane{position:absolute;pointer-events:auto;box-sizing:border-box}
`],encapsulation:2});let i=o;return i})();var Wt=(()=>{let o=class o{static forRoot(e){return{ngModule:o,providers:[R,{provide:k,useValue:e},{provide:Ce,useClass:ye}]}}};o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=ee({type:o}),o.\u0275inj=G({imports:[he,_e,Me]});let i=o;return i})();export{R as a,K as b,Tt as c,Wt as d};
