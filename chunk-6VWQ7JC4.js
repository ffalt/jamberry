import{k as z}from"./chunk-AQDYGNZB.js";import{$b as v,$d as S,Aa as b,Hb as m,Ib as h,Rb as f,Sb as p,Sd as M,Tb as w,Vc as a,Ya as c,_b as u,ab as O,ec as C,fc as s,ia as _,na as d,nb as g,oa as l,qc as x,rc as y}from"./chunk-H2EXZDP6.js";function j(n,o){n&1&&w(0,"i",0)}function D(n,o){if(n&1){let r=u();m(0,j,1,0,"i",0),f(1,"img",1),C("load",function(){d(r);let e=s();return l(e.onLoad())}),p()}if(n&2){let r=s();h(r.loading?0:-1),O(),v("src",r.data.url,c)("alt",r.data.name)}}var P=(()=>{let o=class o{constructor(){this.loading=!0}dialogInit(i,e){this.data=e.data}onLoad(){this.loading=!1}};o.\u0275fac=function(e){return new(e||o)},o.\u0275cmp=g({type:o,selectors:[["app-image-overlay-content"]],decls:1,vars:1,consts:[[1,"icon-spinner","icon-spin"],[3,"load","src","alt"]],template:function(e,t){e&1&&m(0,D,2,3),e&2&&h(t.data?0:-1)},styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;align-items:center}[_nghost-%COMP%]   img[_ngcontent-%COMP%]{width:100%;max-width:500px;height:auto}"]});let n=o;return n})();function E(n,o){if(n&1){let r=u();f(0,"img",1),C("click",function(e){d(r);let t=s();return l(t.showImageOverlay(e))})("load",function(){d(r);let e=s();return l(e.onImgLoad())}),p()}if(n&2){let r=s();v("src",r.imageSrc,c)("alt",r.altSrc)}}var B=(()=>{let o=class o{constructor(){this.coverArtObj=a(),this.size=a(),this.alt=a(""),this.refreshRandom=a(""),this.allowEnlarge=a(!1),this.fill=a(!1),this.round=a(!1),this.border=a(!0),this.hoverBorder=a(!1),this.isLoaded=!1,this.imageSrc="",this.altSrc="",this.jam=_(S),this.dialogOverlay=_(z)}ngAfterContentInit(){this.updateSize(),this.buildUrl()}updateSize(){let i=this.size();this.fill()?(this.minSize=void 0,this.hostSize=void 0):i&&(this.minSize=i-(this.border()?2:0),this.hostSize=this.minSize)}ngOnChanges(i){i.coverArtObj?.currentValue&&(this.isLoaded?this.buildUrl():(this.imageSrc="",this.buildUrl())),this.isLoaded&&i.refreshRandom&&this.buildUrl(),!(this.imageSrc.length>0)&&(i.size||i.border||i.fill)&&this.updateSize()}onImgLoad(){this.isLoaded=!0,this.altSrc=this.alt()}showImageOverlay(i){let e=this.coverArtObj();this.allowEnlarge()&&e&&(i.stopPropagation(),this.dialogOverlay.open({childComponent:P,title:e.name,data:{name:e.name,url:this.jam.image.imageUrl({id:e.id})}}))}buildUrl(){let i=this.coverArtObj();if(i){let e=this.jam.image.imageUrl({id:i.id,size:this.size(),format:M.webp}),t=this.refreshRandom();t&&(e+=`${e.includes("?")?"&":"?"}refresh=${t}`),this.imageSrc=e}}};o.\u0275fac=function(e){return new(e||o)},o.\u0275cmp=g({type:o,selectors:[["app-coverart-image"]],hostVars:16,hostBindings:function(e,t){e&2&&(x("min-width",t.minSize,"px")("min-height",t.minSize,"px")("width",t.hostSize,"px")("height",t.hostSize,"px"),y("fill",t.fill())("round",t.round())("border",t.border())("border-hover",t.hoverBorder()))},inputs:{coverArtObj:[1,"coverArtObj"],size:[1,"size"],alt:[1,"alt"],refreshRandom:[1,"refreshRandom"],allowEnlarge:[1,"allowEnlarge"],fill:[1,"fill"],round:[1,"round"],border:[1,"border"],hoverBorder:[1,"hoverBorder"]},features:[b],decls:1,vars:1,consts:[[3,"src","alt"],[3,"click","load","src","alt"]],template:function(e,t){e&1&&m(0,E,1,2,"img",0),e&2&&h(t.imageSrc?0:-1)},styles:["[_nghost-%COMP%]{display:block;overflow:hidden}[_nghost-%COMP%]   img[_ngcontent-%COMP%]{border:0;display:inline;height:auto;width:100%;text-align:center;object-fit:contain}.round[_nghost-%COMP%]{border-radius:50%}.fill[_nghost-%COMP%]{display:block;width:100%;height:100%;max-width:100%;max-height:100%;min-width:inherit!important;min-height:inherit!important;text-align:center;overflow:hidden}.fill[_nghost-%COMP%]   img[_ngcontent-%COMP%]{display:block;width:100%;height:100%}.border[_nghost-%COMP%]{border:1px solid var(--control-border)}.border-hover[_nghost-%COMP%]:hover{border:1px solid var(--control-border-hover)}"]});let n=o;return n})();export{B as a};
