import{$ as a,A as N,Ac as D,Bc as st,Ca as g,Da as w,E as R,Ea as v,Fa as y,Ga as G,Ha as J,Ia as _,Ja as O,Lb as nt,Ld as pt,Ma as Z,Nd as lt,O as q,Pd as at,Q as K,Qd as ct,Rd as ut,Sd as mt,Td as ht,V as j,W as V,Z as l,_ as F,a as b,aa as $,ab as tt,ba as d,ca as B,ea as A,f as h,fa as Q,hb as et,i as f,ka as L,la as X,m as I,n as T,o as P,qa as Y,qb as ot,r as s,ra as z,s as S,sa as U,u as M,vb as it,wa as W,y as H,z as p,zc as rt}from"./chunk-RPULQAHC.js";var E=(()=>{class o{tpl;constructor(e){this.tpl=e}static \u0275fac=function(t){return new(t||o)(l(V))};static \u0275dir=d({type:o,selectors:[["","appAutocompleteContent",""]],standalone:!1})}return o})();var ft=["root"],dt=o=>({control:o});function gt(o,u){o&1&&W(0)}function vt(o,u){if(o&1&&(z(0,"div",1),A(1,gt,1,0,"ng-container",2),U()),o&2){let e=w().control,t=w();j(),Y("ngTemplateOutlet",t.content.tpl)("ngTemplateOutletContext",tt(2,dt,e))}}function yt(o,u){if(o&1&&L(0,vt,2,4,"div",1),o&2){let e=u.control;X(e!=null&&e.isVisible?0:-1)}}var Ct=(()=>{class o{rootTemplate;content;static \u0275fac=function(t){return new(t||o)};static \u0275cmp=a({type:o,selectors:[["app-autocomplete"]],contentQueries:function(t,i,r){if(t&1&&G(r,E,7),t&2){let n;_(n=O())&&(i.content=n.first)}},viewQuery:function(t,i){if(t&1&&J(ft,7),t&2){let r;_(r=O())&&(i.rootTemplate=r.first)}},exportAs:["appAutocomplete"],standalone:!1,decls:2,vars:0,consts:[["root",""],[1,"ac-content"],[4,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(t,i){t&1&&A(0,yt,1,1,"ng-template",null,0,et)},dependencies:[ot],styles:[".ac-content[_ngcontent-%COMP%]{width:100%;display:block;overflow-y:auto;background-color:var(--control);color:var(--on-control);box-shadow:var(--control-box-shadow);border-color:var(--control-box-border);border-width:1px;border-style:solid;border-radius:0;font-size:14px}"]})}return o})();function xt(o){return o.target.value}var m=-1;function bt(o,u){return P(document,"click").pipe(s(e=>{let t=e.target,i=t!==u,r=!!o&&!o.overlayElement.contains(t);return i&&r}),p(o.detachments()))}var At=(()=>{class o{host;vcr;overlay;appAutocomplete;appAutocompleteControl;appAutocompleteSettings;appAutocompleteNavigKeyDown=new Q;isVisible=!1;activeIndex=m;query="";options=[];unsubscribe=new f;overlayRef;keydown$=new f;keyup$=new f;settings={allowEmpty:!1,debounceTime:300};isCreated=!1;constructor(e,t,i){this.host=e,this.vcr=t,this.overlay=i}ngOnInit(){this.filterEnterEvent(this.keydown$),this.listenAndSuggest(this.keyup$),this.navigateSuggestionsWithArrows(this.keydown$)}ngOnDestroy(){this.unsubscribe.next(),this.unsubscribe.complete()}ngOnChanges(e){e.appAutocompleteSettings&&(this.settings=b(b({},this.settings),this.appAutocompleteSettings))}selectOption(e){this.hide(),this.appAutocompleteControl&&(this.query=this.appAutocompleteControl.autocompleteSelectResult(e))}handleEsc(e){ht(e)&&(this.hide(),e.preventDefault()),this.keydown$.next(e)}onkeyup(e){e.preventDefault(),e.stopPropagation(),this.keyup$.next(e)}run(){!this.query||this.query.length==0||this.request(this.query).then(e=>{this.activeIndex=m,this.options=e,this.display()}).catch(e=>console.error(e))}static resolveNextIndex(e,t,i){let r=t?1:-1,n=i.length-1,k=m,C=e+r,x=C;return C===n+1&&(x=k),C===k-1&&(x=n),x}updateIndex(e){this.activeIndex=o.resolveNextIndex(this.activeIndex,ut(e),this.options)}listenAndSuggest(e){e.pipe(s(t=>!pt(t)),I(xt),S(this.settings.debounceTime),T,M(),N(t=>h(this,null,function*(){return this.query=t})),s(t=>this.settings.allowEmpty||t.length>0),H(t=>h(this,null,function*(){return this.request(t)})),p(this.unsubscribe)).subscribe(t=>{this.activeIndex=m,this.options=t,this.display()})}display(){if(!this.options||this.options.length===0){this.isVisible=!1;return}this.isCreated||this.openDropdown(),this.isVisible=this.options&&this.options.length>0}request(e){return h(this,null,function*(){return this.appAutocompleteControl?this.appAutocompleteControl.autocompleteGetData(e):[]})}filterEnterEvent(e){e.pipe(s(mt),p(this.unsubscribe)).subscribe(()=>{if(!this.isVisible){this.query=this.host.nativeElement.value,this.appAutocompleteControl&&this.appAutocompleteControl.autocompleteEnter(this.query);return}let t=this.options[this.activeIndex];this.hide(),t?this.selectOption(t):this.appAutocompleteControl&&this.appAutocompleteControl.autocompleteEnter(this.query)})}navigateSuggestionsWithArrows(e){e.pipe(s(lt),p(this.unsubscribe)).subscribe(t=>{at(t)?(this.hide(),this.host.nativeElement.selectionStart===this.host.nativeElement.value.length&&this.appAutocompleteNavigKeyDown.next(t)):ct(t)?(this.hide(),this.host.nativeElement.selectionEnd===0&&this.appAutocompleteNavigKeyDown.next(t)):this.isVisible?(this.updateIndex(t),this.display()):this.appAutocompleteNavigKeyDown.next(t)})}openDropdown(){if(!this.appAutocomplete?.rootTemplate)return;this.overlayRef=this.createOverlay();let e=new nt(this.appAutocomplete.rootTemplate,this.vcr,{control:this});this.overlayRef.attach(e),bt(this.overlayRef,this.host.nativeElement).pipe(p(this.unsubscribe)).subscribe(()=>{this.close()}),this.isCreated=!0,this.isVisible=!0}hide(){this.isVisible=!1,this.activeIndex=m}close(){this.overlayRef&&(this.overlayRef.detach(),this.overlayRef=void 0),this.isCreated=!1}createOverlay(){return this.overlay.create(this.getOverlayConfig())}getOverlayConfig(){return new rt({hasBackdrop:!1,backdropClass:"",panelClass:"ngx-autocomplete",scrollStrategy:this.overlay.scrollStrategies.block(),positionStrategy:this.getOverlayPosition()})}getOverlayPosition(){let e=[new D({originX:"start",originY:"bottom"},{overlayX:"start",overlayY:"top"}),new D({originX:"start",originY:"top"},{overlayX:"start",overlayY:"bottom"})];return this.overlay.position().flexibleConnectedTo(this.host).withFlexibleDimensions(!1).withPositions(e).withPush(!1)}static \u0275fac=function(t){return new(t||o)(l(K),l(F),l(st))};static \u0275dir=d({type:o,selectors:[["","appAutocomplete",""]],hostBindings:function(t,i){t&1&&g("keydown",function(n){return i.handleEsc(n)})("keyup",function(n){return i.onkeyup(n)})},inputs:{appAutocomplete:"appAutocomplete",appAutocompleteControl:"appAutocompleteControl",appAutocompleteSettings:"appAutocompleteSettings"},outputs:{appAutocompleteNavigKeyDown:"appAutocompleteNavigKeyDown"},standalone:!1,features:[q]})}return o})();var wt=(()=>{class o{transform(e,t){let i=t.replace(/[-[\]/{}()*+?.\\^$|]/g,"\\$&");i=i.split(" ").filter(n=>n.length>0).join("|");let r=new RegExp(i,"gi");return t?e.replace(r,n=>`<b>${n}</b>`):e}static \u0275fac=function(t){return new(t||o)};static \u0275pipe=B({name:"highlight",type:o,pure:!0,standalone:!1})}return o})();var _t=["*"],Ot=(()=>{class o{option;control;get getActive(){return this.control?this.control.options[this.control.activeIndex]===this.option:!1}mouseDownEvent(e){this.control&&this.option&&(this.control.selectOption(this.option),e.stopPropagation())}static \u0275fac=function(t){return new(t||o)};static \u0275cmp=a({type:o,selectors:[["app-autocomplete-option"]],hostVars:2,hostBindings:function(t,i){t&1&&g("mousedown",function(n){return i.mouseDownEvent(n)}),t&2&&Z("active",i.getActive)},inputs:{option:"option",control:"control"},standalone:!1,ngContentSelectors:_t,decls:1,vars:0,template:function(t,i){t&1&&(v(),y(0))},styles:["[_nghost-%COMP%]{display:block;padding:5px;cursor:pointer}[_nghost-%COMP%]:hover{background-color:var(--control-hover);color:var(--on-control-hover)}.active[_nghost-%COMP%]{background-color:var(--control-active);color:var(--on-control-active)}[_nghost-%COMP%]     b{color:var(--on-control-active)}"],changeDetection:0})}return o})();var Dt=["*"],Et=(()=>{class o{static \u0275fac=function(t){return new(t||o)};static \u0275cmp=a({type:o,selectors:[["app-autocomplete-option-header"]],standalone:!1,ngContentSelectors:Dt,decls:1,vars:0,template:function(t,i){t&1&&(v(),y(0))},styles:["[_nghost-%COMP%]{display:block;padding:5px;font-size:11px;background-color:var(--control-box);color:var(--on-control);text-transform:uppercase;letter-spacing:1px}"]})}return o})();var ee=(()=>{class o{static \u0275fac=function(t){return new(t||o)};static \u0275mod=$({type:o});static \u0275inj=R({imports:[it]})}return o})();export{E as a,Ct as b,At as c,Et as d,wt as e,Ot as f,ee as g};
