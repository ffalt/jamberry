!function(){"use strict";function t(e,n,i){return(t="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=r(t)););return t}(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(n):o.value}})(e,n,i||e)}function e(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&n(t,e)}function n(t,e){return(n=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function i(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=r(t);if(e){var a=r(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return o(this,n)}}function o(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function r(t){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function a(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return s(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,o=function(){};return{s:o,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a=!0,c=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){c=!0,r=t},f:function(){try{a||null==n.return||n.return()}finally{if(c)throw r}}}}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function d(t,e,n){return e&&l(t.prototype,e),n&&l(t,n),t}(self.webpackChunkjamberry=self.webpackChunkjamberry||[]).push([[11],{55819:function(t,e,n){n.d(e,{ap:function(){return C},QG:function(){return _},Ll:function(){return O}});var i=n(37716),o=n(64762),r=n(38583),a=n(39075),s=["wrapper"],l=["sourceImage"];function u(t,e){if(1&t){var n=i.EpF();i.TgZ(0,"img",4,5),i.NdJ("load",function(){return i.CHM(n),i.oxw().imageLoadedInView()}),i.qZA()}if(2&t){var o=i.oxw();i.Udp("visibility",o.imageVisible?"visible":"hidden")("transform",o.safeTransformStyle),i.Q6J("src",o.safeImgDataUrl,i.LSH)}}function g(t,e){if(1&t){var n=i.EpF();i.ynx(0),i.TgZ(1,"span",9),i.NdJ("mousedown",function(t){i.CHM(n);var e=i.oxw(2);return e.startMove(t,e.moveTypes.Resize,"topleft")})("touchstart",function(t){i.CHM(n);var e=i.oxw(2);return e.startMove(t,e.moveTypes.Resize,"topleft")}),i._UZ(2,"span",10),i.qZA(),i.TgZ(3,"span",11),i._UZ(4,"span",10),i.qZA(),i.TgZ(5,"span",12),i.NdJ("mousedown",function(t){i.CHM(n);var e=i.oxw(2);return e.startMove(t,e.moveTypes.Resize,"topright")})("touchstart",function(t){i.CHM(n);var e=i.oxw(2);return e.startMove(t,e.moveTypes.Resize,"topright")}),i._UZ(6,"span",10),i.qZA(),i.TgZ(7,"span",13),i._UZ(8,"span",10),i.qZA(),i.TgZ(9,"span",14),i.NdJ("mousedown",function(t){i.CHM(n);var e=i.oxw(2);return e.startMove(t,e.moveTypes.Resize,"bottomright")})("touchstart",function(t){i.CHM(n);var e=i.oxw(2);return e.startMove(t,e.moveTypes.Resize,"bottomright")}),i._UZ(10,"span",10),i.qZA(),i.TgZ(11,"span",15),i._UZ(12,"span",10),i.qZA(),i.TgZ(13,"span",16),i.NdJ("mousedown",function(t){i.CHM(n);var e=i.oxw(2);return e.startMove(t,e.moveTypes.Resize,"bottomleft")})("touchstart",function(t){i.CHM(n);var e=i.oxw(2);return e.startMove(t,e.moveTypes.Resize,"bottomleft")}),i._UZ(14,"span",10),i.qZA(),i.TgZ(15,"span",17),i._UZ(16,"span",10),i.qZA(),i.TgZ(17,"span",18),i.NdJ("mousedown",function(t){i.CHM(n);var e=i.oxw(2);return e.startMove(t,e.moveTypes.Resize,"top")})("touchstart",function(t){i.CHM(n);var e=i.oxw(2);return e.startMove(t,e.moveTypes.Resize,"top")}),i.qZA(),i.TgZ(18,"span",19),i.NdJ("mousedown",function(t){i.CHM(n);var e=i.oxw(2);return e.startMove(t,e.moveTypes.Resize,"right")})("touchstart",function(t){i.CHM(n);var e=i.oxw(2);return e.startMove(t,e.moveTypes.Resize,"right")}),i.qZA(),i.TgZ(19,"span",20),i.NdJ("mousedown",function(t){i.CHM(n);var e=i.oxw(2);return e.startMove(t,e.moveTypes.Resize,"bottom")})("touchstart",function(t){i.CHM(n);var e=i.oxw(2);return e.startMove(t,e.moveTypes.Resize,"bottom")}),i.qZA(),i.TgZ(20,"span",21),i.NdJ("mousedown",function(t){i.CHM(n);var e=i.oxw(2);return e.startMove(t,e.moveTypes.Resize,"left")})("touchstart",function(t){i.CHM(n);var e=i.oxw(2);return e.startMove(t,e.moveTypes.Resize,"left")}),i.qZA(),i.BQk()}}function h(t,e){if(1&t){var n=i.EpF();i.TgZ(0,"div",6),i.NdJ("keydown",function(t){return i.CHM(n),i.oxw().keyboardAccess(t)}),i.TgZ(1,"div",7),i.NdJ("mousedown",function(t){i.CHM(n);var e=i.oxw();return e.startMove(t,e.moveTypes.Move)})("touchstart",function(t){i.CHM(n);var e=i.oxw();return e.startMove(t,e.moveTypes.Move)}),i.qZA(),i.YNc(2,g,21,0,"ng-container",8),i.qZA()}if(2&t){var o=i.oxw();i.Udp("top",o.cropper.y1,"px")("left",o.cropper.x1,"px")("width",o.cropper.x2-o.cropper.x1,"px")("height",o.cropper.y2-o.cropper.y1,"px")("margin-left","center"===o.alignImage?o.marginLeft:null)("visibility",o.imageVisible?"visible":"hidden"),i.ekj("ngx-ic-round",o.roundCropper),i.xp6(2),i.Q6J("ngIf",!o.hideResizeSquares)}}var p,f=function(){function t(){c(this,t),this.format="png",this.maintainAspectRatio=!0,this.transform={},this.aspectRatio=1,this.resizeToWidth=0,this.resizeToHeight=0,this.cropperMinWidth=0,this.cropperMinHeight=0,this.cropperMaxHeight=0,this.cropperMaxWidth=0,this.cropperStaticWidth=0,this.cropperStaticHeight=0,this.canvasRotation=0,this.initialStepSize=3,this.roundCropper=!1,this.onlyScaleDown=!1,this.imageQuality=92,this.autoCrop=!0,this.backgroundColor=void 0,this.containWithinAspectRatio=!1,this.hideResizeSquares=!1,this.alignImage="center",this.cropperScaledMinWidth=20,this.cropperScaledMinHeight=20,this.cropperScaledMaxWidth=20,this.cropperScaledMaxHeight=20,this.stepSize=this.initialStepSize}return d(t,[{key:"setOptions",value:function(t){var e=this;Object.keys(t).filter(function(t){return t in e}).forEach(function(n){return e[n]=t[n]}),this.validateOptions()}},{key:"setOptionsFromChanges",value:function(t){var e=this;Object.keys(t).filter(function(t){return t in e}).forEach(function(n){return e[n]=t[n].currentValue}),this.validateOptions()}},{key:"validateOptions",value:function(){if(this.maintainAspectRatio&&!this.aspectRatio)throw new Error("`aspectRatio` should > 0 when `maintainAspectRatio` is enabled")}}]),t}(),m={Move:"move",Resize:"resize",Pinch:"pinch"},v=((p=function(){function t(){c(this,t)}return d(t,[{key:"crop",value:function(t,e,n,i){var o=this.getImagePosition(t,e,n,i),r=o.x2-o.x1,a=o.y2-o.y1,s=document.createElement("canvas");s.width=r,s.height=a;var c=s.getContext("2d");if(c){null!=i.backgroundColor&&(c.fillStyle=i.backgroundColor,c.fillRect(0,0,r,a));var l=(i.transform.scale||1)*(i.transform.flipH?-1:1),d=(i.transform.scale||1)*(i.transform.flipV?-1:1),u=e.transformed;c.setTransform(l,0,0,d,u.size.width/2,u.size.height/2),c.translate(-o.x1/l,-o.y1/d),c.rotate((i.transform.rotate||0)*Math.PI/180),c.drawImage(u.image,-u.size.width/2,-u.size.height/2);var g={width:r,height:a,imagePosition:o,cropperPosition:Object.assign({},n)};i.containWithinAspectRatio&&(g.offsetImagePosition=this.getOffsetImagePosition(t,e,n,i));var h=this.getResizeRatio(r,a,i);return 1!==h&&(g.width=Math.round(r*h),g.height=i.maintainAspectRatio?Math.round(g.width/i.aspectRatio):Math.round(a*h),function(t,e,n){var i=t.width,o=t.height,r=i/(e=Math.round(e)),a=o/(n=Math.round(n)),s=Math.ceil(r/2),c=Math.ceil(a/2),l=t.getContext("2d");if(l){for(var d=l.getImageData(0,0,i,o),u=l.createImageData(e,n),g=d.data,h=u.data,p=0;p<n;p++)for(var f=0;f<e;f++){var m=4*(f+p*e),v=p*a,M=0,x=0,C=0,_=0,O=0,y=0,b=0,k=Math.floor(f*r),P=Math.floor(p*a),w=Math.ceil((f+1)*r),Z=Math.ceil((p+1)*a);w=Math.min(w,i),Z=Math.min(Z,o);for(var A=P;A<Z;A++)for(var T=Math.abs(v-A)/c,I=f*r,q=T*T,S=k;S<w;S++){var U=Math.abs(I-S)/s,R=Math.sqrt(q+U*U);if(!(R>=1)){var J=4*(S+A*i);b+=(M=2*R*R*R-3*R*R+1)*g[J+3],C+=M,g[J+3]<255&&(M=M*g[J+3]/250),_+=M*g[J],O+=M*g[J+1],y+=M*g[J+2],x+=M}}h[m]=_/x,h[m+1]=O/x,h[m+2]=y/x,h[m+3]=b/C}t.width=e,t.height=n,l.putImageData(u,0,0)}}(s,g.width,g.height)),g.base64=s.toDataURL("image/"+i.format,this.getQuality(i)),g}}},{key:"getImagePosition",value:function(t,e,n,i){var o=e.transformed.size.width/t.nativeElement.offsetWidth,r={x1:Math.round(n.x1*o),y1:Math.round(n.y1*o),x2:Math.round(n.x2*o),y2:Math.round(n.y2*o)};return i.containWithinAspectRatio||(r.x1=Math.max(r.x1,0),r.y1=Math.max(r.y1,0),r.x2=Math.min(r.x2,e.transformed.size.width),r.y2=Math.min(r.y2,e.transformed.size.height)),r}},{key:"getOffsetImagePosition",value:function(t,e,n,i){var o,r,a=e.transformed.size.width/t.nativeElement.offsetWidth;(i.canvasRotation+e.exifTransform.rotate)%2?(o=(e.transformed.size.width-e.original.size.height)/2,r=(e.transformed.size.height-e.original.size.width)/2):(o=(e.transformed.size.width-e.original.size.width)/2,r=(e.transformed.size.height-e.original.size.height)/2);var s={x1:Math.round(n.x1*a)-o,y1:Math.round(n.y1*a)-r,x2:Math.round(n.x2*a)-o,y2:Math.round(n.y2*a)-r};return i.containWithinAspectRatio||(s.x1=Math.max(s.x1,0),s.y1=Math.max(s.y1,0),s.x2=Math.min(s.x2,e.transformed.size.width),s.y2=Math.min(s.y2,e.transformed.size.height)),s}},{key:"getResizeRatio",value:function(t,e,n){var i=n.resizeToWidth/t,o=n.resizeToHeight/e,r=new Array;n.resizeToWidth>0&&r.push(i),n.resizeToHeight>0&&r.push(o);var a=0===r.length?1:Math.min.apply(Math,r);return a>1&&!n.onlyScaleDown?a:Math.min(a,1)}},{key:"getQuality",value:function(t){return Math.min(1,Math.max(0,t.imageQuality/100))}}]),t}()).\u0275fac=function(t){return new(t||p)},p.\u0275prov=(0,i.Yz7)({factory:function(){return new p},token:p,providedIn:"root"}),p),M=function(){var t=function(){function t(){c(this,t)}return d(t,[{key:"resetCropperPosition",value:function(t,e,n){if(null==t?void 0:t.nativeElement){var i=t.nativeElement;if(n.cropperStaticHeight&&n.cropperStaticWidth)e.x1=0,e.x2=i.offsetWidth>n.cropperStaticWidth?n.cropperStaticWidth:i.offsetWidth,e.y1=0,e.y2=i.offsetHeight>n.cropperStaticHeight?n.cropperStaticHeight:i.offsetHeight;else{var o=Math.min(n.cropperScaledMaxWidth,i.offsetWidth),r=Math.min(n.cropperScaledMaxHeight,i.offsetHeight);if(n.maintainAspectRatio)if(i.offsetWidth/n.aspectRatio<i.offsetHeight){e.x1=0,e.x2=o;var a=o/n.aspectRatio;e.y1=(i.offsetHeight-a)/2,e.y2=e.y1+a}else{e.y1=0,e.y2=r;var s=r*n.aspectRatio;e.x1=(i.offsetWidth-s)/2,e.x2=e.x1+s}else e.x1=0,e.x2=o,e.y1=0,e.y2=r}}}},{key:"move",value:function(t,e,n){var i=this.getClientX(t)-e.clientX,o=this.getClientY(t)-e.clientY;n.x1=e.x1+i,n.y1=e.y1+o,n.x2=e.x2+i,n.y2=e.y2+o}},{key:"resize",value:function(t,e,n,i,o){var r=this.getClientX(t)-e.clientX,a=this.getClientY(t)-e.clientY;switch(e.position){case"left":n.x1=Math.min(Math.max(e.x1+r,n.x2-o.cropperScaledMaxWidth),n.x2-o.cropperScaledMinWidth);break;case"topleft":n.x1=Math.min(Math.max(e.x1+r,n.x2-o.cropperScaledMaxWidth),n.x2-o.cropperScaledMinWidth),n.y1=Math.min(Math.max(e.y1+a,n.y2-o.cropperScaledMaxHeight),n.y2-o.cropperScaledMinHeight);break;case"top":n.y1=Math.min(Math.max(e.y1+a,n.y2-o.cropperScaledMaxHeight),n.y2-o.cropperScaledMinHeight);break;case"topright":n.x2=Math.max(Math.min(e.x2+r,n.x1+o.cropperScaledMaxWidth),n.x1+o.cropperScaledMinWidth),n.y1=Math.min(Math.max(e.y1+a,n.y2-o.cropperScaledMaxHeight),n.y2-o.cropperScaledMinHeight);break;case"right":n.x2=Math.max(Math.min(e.x2+r,n.x1+o.cropperScaledMaxWidth),n.x1+o.cropperScaledMinWidth);break;case"bottomright":n.x2=Math.max(Math.min(e.x2+r,n.x1+o.cropperScaledMaxWidth),n.x1+o.cropperScaledMinWidth),n.y2=Math.max(Math.min(e.y2+a,n.y1+o.cropperScaledMaxHeight),n.y1+o.cropperScaledMinHeight);break;case"bottom":n.y2=Math.max(Math.min(e.y2+a,n.y1+o.cropperScaledMaxHeight),n.y1+o.cropperScaledMinHeight);break;case"bottomleft":n.x1=Math.min(Math.max(e.x1+r,n.x2-o.cropperScaledMaxWidth),n.x2-o.cropperScaledMinWidth),n.y2=Math.max(Math.min(e.y2+a,n.y1+o.cropperScaledMaxHeight),n.y1+o.cropperScaledMinHeight);break;case"center":var s=t.scale,c=Math.min(Math.max(o.cropperScaledMinWidth,Math.abs(e.x2-e.x1)*s),o.cropperScaledMaxWidth),l=Math.min(Math.max(o.cropperScaledMinHeight,Math.abs(e.y2-e.y1)*s),o.cropperScaledMaxHeight);n.x1=e.clientX-c/2,n.x2=e.clientX+c/2,n.y1=e.clientY-l/2,n.y2=e.clientY+l/2,n.x1<0?(n.x2-=n.x1,n.x1=0):n.x2>i.width&&(n.x1-=n.x2-i.width,n.x2=i.width),n.y1<0?(n.y2-=n.y1,n.y1=0):n.y2>i.height&&(n.y1-=n.y2-i.height,n.y2=i.height)}o.maintainAspectRatio&&this.checkAspectRatio(e.position,n,i,o)}},{key:"checkAspectRatio",value:function(t,e,n,i){var o=0,r=0;switch(t){case"top":e.x2=e.x1+(e.y2-e.y1)*i.aspectRatio,o=Math.max(e.x2-n.width,0),r=Math.max(0-e.y1,0),(o>0||r>0)&&(e.x2-=r*i.aspectRatio>o?r*i.aspectRatio:o,e.y1+=r*i.aspectRatio>o?r:o/i.aspectRatio);break;case"bottom":e.x2=e.x1+(e.y2-e.y1)*i.aspectRatio,o=Math.max(e.x2-n.width,0),r=Math.max(e.y2-n.height,0),(o>0||r>0)&&(e.x2-=r*i.aspectRatio>o?r*i.aspectRatio:o,e.y2-=r*i.aspectRatio>o?r:o/i.aspectRatio);break;case"topleft":e.y1=e.y2-(e.x2-e.x1)/i.aspectRatio,o=Math.max(0-e.x1,0),r=Math.max(0-e.y1,0),(o>0||r>0)&&(e.x1+=r*i.aspectRatio>o?r*i.aspectRatio:o,e.y1+=r*i.aspectRatio>o?r:o/i.aspectRatio);break;case"topright":e.y1=e.y2-(e.x2-e.x1)/i.aspectRatio,o=Math.max(e.x2-n.width,0),r=Math.max(0-e.y1,0),(o>0||r>0)&&(e.x2-=r*i.aspectRatio>o?r*i.aspectRatio:o,e.y1+=r*i.aspectRatio>o?r:o/i.aspectRatio);break;case"right":case"bottomright":e.y2=e.y1+(e.x2-e.x1)/i.aspectRatio,o=Math.max(e.x2-n.width,0),r=Math.max(e.y2-n.height,0),(o>0||r>0)&&(e.x2-=r*i.aspectRatio>o?r*i.aspectRatio:o,e.y2-=r*i.aspectRatio>o?r:o/i.aspectRatio);break;case"left":case"bottomleft":e.y2=e.y1+(e.x2-e.x1)/i.aspectRatio,o=Math.max(0-e.x1,0),r=Math.max(e.y2-n.height,0),(o>0||r>0)&&(e.x1+=r*i.aspectRatio>o?r*i.aspectRatio:o,e.y2-=r*i.aspectRatio>o?r:o/i.aspectRatio);break;case"center":e.x2=e.x1+(e.y2-e.y1)*i.aspectRatio,e.y2=e.y1+(e.x2-e.x1)/i.aspectRatio;var a=Math.max(0-e.x1,0),s=Math.max(e.x2-n.width,0),c=Math.max(e.y2-n.height,0),l=Math.max(0-e.y1,0);(a>0||s>0||c>0||l>0)&&(e.x1+=c*i.aspectRatio>a?c*i.aspectRatio:a,e.x2-=l*i.aspectRatio>s?l*i.aspectRatio:s,e.y1+=l*i.aspectRatio>s?l:s/i.aspectRatio,e.y2-=c*i.aspectRatio>a?c:a/i.aspectRatio)}}},{key:"getClientX",value:function(t){var e;return(null===(e=t.touches)||void 0===e?void 0:e[0].clientX)||t.clientX||0}},{key:"getClientY",value:function(t){var e;return(null===(e=t.touches)||void 0===e?void 0:e[0].clientY)||t.clientY||0}}]),t}();return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=(0,i.Yz7)({factory:function(){return new t},token:t,providedIn:"root"}),t}(),x=function(){var t=function(){function t(){c(this,t),this.autoRotateSupported=new Promise(function(t){var e=new Image;e.onload=function(){t(1===e.width&&2===e.height)},e.src="data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAEAAgMBEQACEQEDEQH/xABKAAEAAAAAAAAAAAAAAAAAAAALEAEAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAAAAAAAAAAAAAAAEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwA/8H//2Q=="})}return d(t,[{key:"loadImageFile",value:function(t,e){var n=this;return new Promise(function(i,o){var r=new FileReader;r.onload=function(r){n.loadImage(r.target.result,t.type,e).then(i).catch(o)},r.readAsDataURL(t)})}},{key:"loadImage",value:function(t,e,n){return this.isValidImageType(e)?this.loadBase64Image(t,n):Promise.reject(new Error("Invalid image type"))}},{key:"isValidImageType",value:function(t){return/image\/(png|jpg|jpeg|bmp|gif|tiff|webp)/.test(t)}},{key:"loadImageFromURL",value:function(t,e){var n=this;return new Promise(function(i,o){var r=new Image;r.onerror=function(){return o},r.onload=function(){var t=document.createElement("canvas"),o=t.getContext("2d");t.width=r.width,t.height=r.height,o.drawImage(r,0,0),n.loadBase64Image(t.toDataURL(),e).then(i)},r.crossOrigin="anonymous",r.src=t})}},{key:"loadBase64Image",value:function(t,e){var n=this;return new Promise(function(e,n){var i=new Image;i.onload=function(){return e({originalImage:i,originalBase64:t})},i.onerror=n,i.src=t}).then(function(t){return n.transformImageBase64(t,e)})}},{key:"transformImageBase64",value:function(t,e){return(0,o.mG)(this,void 0,void 0,regeneratorRuntime.mark(function n(){var i,o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.autoRotateSupported;case 2:return i=n.sent,n.next=5,function(t){switch("string"==typeof t&&(t=function(t){var e=new DataView(function(t){t=t.replace(/^data\:([^\;]+)\;base64,/gim,"");for(var e=atob(t),n=e.length,i=new Uint8Array(n),o=0;o<n;o++)i[o]=e.charCodeAt(o);return i.buffer}(t));if(65496!==e.getUint16(0,!1))return-2;for(var n=e.byteLength,i=2;i<n;){if(e.getUint16(i+2,!1)<=8)return-1;var o=e.getUint16(i,!1);if(i+=2,65505==o){if(1165519206!==e.getUint32(i+=2,!1))return-1;var r=18761==e.getUint16(i+=6,!1);i+=e.getUint32(i+4,r);var a=e.getUint16(i,r);i+=2;for(var s=0;s<a;s++)if(274==e.getUint16(i+12*s,r))return e.getUint16(i+12*s+8,r)}else{if(65280!=(65280&o))break;i+=e.getUint16(i,!1)}}return-1}(t)),t){case 2:return{rotate:0,flip:!0};case 3:return{rotate:2,flip:!1};case 4:return{rotate:2,flip:!0};case 5:return{rotate:1,flip:!0};case 6:return{rotate:1,flip:!1};case 7:return{rotate:3,flip:!0};case 8:return{rotate:3,flip:!1};default:return{rotate:0,flip:!1}}}(i?-1:t.originalBase64);case 5:return o=n.sent,n.abrupt("return",t.originalImage&&t.originalImage.complete?this.transformLoadedImage({original:{base64:t.originalBase64,image:t.originalImage,size:{width:t.originalImage.naturalWidth,height:t.originalImage.naturalHeight}},exifTransform:o},e):Promise.reject(new Error("No image loaded")));case 7:case"end":return n.stop()}},n,this)}))}},{key:"transformLoadedImage",value:function(t,e){return(0,o.mG)(this,void 0,void 0,regeneratorRuntime.mark(function n(){var i,o,r,a,s,c,l;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(i=e.canvasRotation+t.exifTransform.rotate,o={width:t.original.image.naturalWidth,height:t.original.image.naturalHeight},0!==i||t.exifTransform.flip||e.containWithinAspectRatio){n.next=3;break}return n.abrupt("return",{original:{base64:t.original.base64,image:t.original.image,size:Object.assign({},o)},transformed:{base64:t.original.base64,image:t.original.image,size:Object.assign({},o)},exifTransform:t.exifTransform});case 3:return r=this.getTransformedSize(o,t.exifTransform,e),(a=document.createElement("canvas")).width=r.width,a.height=r.height,(s=a.getContext("2d")).setTransform(t.exifTransform.flip?-1:1,0,0,1,a.width/2,a.height/2),s.rotate(Math.PI*(i/2)),s.drawImage(t.original.image,-o.width/2,-o.height/2),c=a.toDataURL(),n.next=10,this.loadImageFromBase64(c);case 10:return l=n.sent,n.abrupt("return",{original:{base64:t.original.base64,image:t.original.image,size:Object.assign({},o)},transformed:{base64:c,image:l,size:{width:l.width,height:l.height}},exifTransform:t.exifTransform});case 12:case"end":return n.stop()}},n,this)}))}},{key:"loadImageFromBase64",value:function(t){return new Promise(function(e,n){var i=new Image;i.onload=function(){return e(i)},i.onerror=n,i.src=t})}},{key:"getTransformedSize",value:function(t,e,n){var i=n.canvasRotation+e.rotate;if(n.containWithinAspectRatio){if(i%2){var o=t.height/n.aspectRatio;return{width:Math.max(t.height,t.width*n.aspectRatio),height:Math.max(t.width,o)}}var r=t.width/n.aspectRatio;return{width:Math.max(t.width,t.height*n.aspectRatio),height:Math.max(t.height,r)}}return i%2?{height:t.width,width:t.height}:{width:t.width,height:t.height}}}]),t}();return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=(0,i.Yz7)({factory:function(){return new t},token:t,providedIn:"root"}),t}(),C=function(){var t=function(){function t(e,n,o,r,a){c(this,t),this.cropService=e,this.cropperPositionService=n,this.loadImageService=o,this.sanitizer=r,this.cd=a,this.Hammer=(null==window?void 0:window.Hammer)||null,this.settings=new f,this.setImageMaxSizeRetries=0,this.marginLeft="0px",this.moveTypes=m,this.imageVisible=!1,this.format=this.settings.format,this.transform={},this.maintainAspectRatio=this.settings.maintainAspectRatio,this.aspectRatio=this.settings.aspectRatio,this.resizeToWidth=this.settings.resizeToWidth,this.resizeToHeight=this.settings.resizeToHeight,this.cropperMinWidth=this.settings.cropperMinWidth,this.cropperMinHeight=this.settings.cropperMinHeight,this.cropperMaxHeight=this.settings.cropperMaxHeight,this.cropperMaxWidth=this.settings.cropperMaxWidth,this.cropperStaticWidth=this.settings.cropperStaticWidth,this.cropperStaticHeight=this.settings.cropperStaticHeight,this.canvasRotation=this.settings.canvasRotation,this.initialStepSize=this.settings.initialStepSize,this.roundCropper=this.settings.roundCropper,this.onlyScaleDown=this.settings.onlyScaleDown,this.imageQuality=this.settings.imageQuality,this.autoCrop=this.settings.autoCrop,this.backgroundColor=this.settings.backgroundColor,this.containWithinAspectRatio=this.settings.containWithinAspectRatio,this.hideResizeSquares=this.settings.hideResizeSquares,this.cropper={x1:-100,y1:-100,x2:1e4,y2:1e4},this.alignImage=this.settings.alignImage,this.disabled=!1,this.imageCropped=new i.vpe,this.startCropImage=new i.vpe,this.imageLoaded=new i.vpe,this.cropperReady=new i.vpe,this.loadImageFailed=new i.vpe,this.reset()}return d(t,[{key:"ngOnChanges",value:function(t){var e,n=this;this.onChangesUpdateSettings(t),this.onChangesInputImage(t),(null===(e=this.loadedImage)||void 0===e?void 0:e.original.image.complete)&&(t.containWithinAspectRatio||t.canvasRotation)&&this.loadImageService.transformLoadedImage(this.loadedImage,this.settings).then(function(t){return n.setLoadedImage(t)}).catch(function(t){return n.loadImageError(t)}),(t.cropper||t.maintainAspectRatio||t.aspectRatio)&&(this.setMaxSize(),this.setCropperScaledMinSize(),this.setCropperScaledMaxSize(),this.maintainAspectRatio&&(t.maintainAspectRatio||t.aspectRatio)?this.resetCropperPosition():t.cropper&&(this.checkCropperPosition(!1),this.doAutoCrop()),this.cd.markForCheck()),t.transform&&(this.transform=this.transform||{},this.setCssTransform(),this.doAutoCrop())}},{key:"onChangesUpdateSettings",value:function(t){this.settings.setOptionsFromChanges(t),this.settings.cropperStaticHeight&&this.settings.cropperStaticWidth&&this.settings.setOptions({hideResizeSquares:!0,cropperMinWidth:this.settings.cropperStaticWidth,cropperMinHeight:this.settings.cropperStaticHeight,cropperMaxHeight:this.settings.cropperStaticHeight,cropperMaxWidth:this.settings.cropperStaticWidth,maintainAspectRatio:!1})}},{key:"onChangesInputImage",value:function(t){(t.imageChangedEvent||t.imageURL||t.imageBase64||t.imageFile)&&this.reset(),t.imageChangedEvent&&this.isValidImageChangedEvent()&&this.loadImageFile(this.imageChangedEvent.target.files[0]),t.imageURL&&this.imageURL&&this.loadImageFromURL(this.imageURL),t.imageBase64&&this.imageBase64&&this.loadBase64Image(this.imageBase64),t.imageFile&&this.imageFile&&this.loadImageFile(this.imageFile)}},{key:"isValidImageChangedEvent",value:function(){var t,e,n;return(null===(n=null===(e=null===(t=this.imageChangedEvent)||void 0===t?void 0:t.target)||void 0===e?void 0:e.files)||void 0===n?void 0:n.length)>0}},{key:"setCssTransform",value:function(){this.safeTransformStyle=this.sanitizer.bypassSecurityTrustStyle("scaleX("+(this.transform.scale||1)*(this.transform.flipH?-1:1)+")scaleY("+(this.transform.scale||1)*(this.transform.flipV?-1:1)+")rotate("+(this.transform.rotate||0)+"deg)")}},{key:"ngOnInit",value:function(){this.settings.stepSize=this.initialStepSize,this.activatePinchGesture()}},{key:"reset",value:function(){this.imageVisible=!1,this.loadedImage=null,this.safeImgDataUrl="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=",this.moveStart={active:!1,type:null,position:null,x1:0,y1:0,x2:0,y2:0,clientX:0,clientY:0},this.maxSize={width:0,height:0},this.cropper.x1=-100,this.cropper.y1=-100,this.cropper.x2=1e4,this.cropper.y2=1e4}},{key:"loadImageFile",value:function(t){var e=this;this.loadImageService.loadImageFile(t,this.settings).then(function(t){return e.setLoadedImage(t)}).catch(function(t){return e.loadImageError(t)})}},{key:"loadBase64Image",value:function(t){var e=this;this.loadImageService.loadBase64Image(t,this.settings).then(function(t){return e.setLoadedImage(t)}).catch(function(t){return e.loadImageError(t)})}},{key:"loadImageFromURL",value:function(t){var e=this;this.loadImageService.loadImageFromURL(t,this.settings).then(function(t){return e.setLoadedImage(t)}).catch(function(t){return e.loadImageError(t)})}},{key:"setLoadedImage",value:function(t){this.loadedImage=t,this.safeImgDataUrl=this.sanitizer.bypassSecurityTrustResourceUrl(t.transformed.base64),this.cd.markForCheck()}},{key:"loadImageError",value:function(t){console.error(t),this.loadImageFailed.emit()}},{key:"imageLoadedInView",value:function(){var t=this;null!=this.loadedImage&&(this.imageLoaded.emit(this.loadedImage),this.setImageMaxSizeRetries=0,setTimeout(function(){return t.checkImageMaxSizeRecursively()}))}},{key:"checkImageMaxSizeRecursively",value:function(){var t=this;this.setImageMaxSizeRetries>40?this.loadImageFailed.emit():this.sourceImageLoaded()?(this.setMaxSize(),this.setCropperScaledMinSize(),this.setCropperScaledMaxSize(),this.resetCropperPosition(),this.cropperReady.emit(Object.assign({},this.maxSize)),this.cd.markForCheck()):(this.setImageMaxSizeRetries++,setTimeout(function(){return t.checkImageMaxSizeRecursively()},50))}},{key:"sourceImageLoaded",value:function(){var t,e;return(null===(e=null===(t=this.sourceImage)||void 0===t?void 0:t.nativeElement)||void 0===e?void 0:e.offsetWidth)>0}},{key:"onResize",value:function(){!this.loadedImage||(this.resizeCropperPosition(),this.setMaxSize(),this.setCropperScaledMinSize(),this.setCropperScaledMaxSize())}},{key:"activatePinchGesture",value:function(){if(this.Hammer){var t=new this.Hammer(this.wrapper.nativeElement);t.get("pinch").set({enable:!0}),t.on("pinchmove",this.onPinch.bind(this)),t.on("pinchend",this.pinchStop.bind(this)),t.on("pinchstart",this.startPinch.bind(this))}else(0,i.X6Q)()&&console.warn("[NgxImageCropper] Could not find HammerJS - Pinch Gesture won't work")}},{key:"resizeCropperPosition",value:function(){var t=this.sourceImage.nativeElement;(this.maxSize.width!==t.offsetWidth||this.maxSize.height!==t.offsetHeight)&&(this.cropper.x1=this.cropper.x1*t.offsetWidth/this.maxSize.width,this.cropper.x2=this.cropper.x2*t.offsetWidth/this.maxSize.width,this.cropper.y1=this.cropper.y1*t.offsetHeight/this.maxSize.height,this.cropper.y2=this.cropper.y2*t.offsetHeight/this.maxSize.height)}},{key:"resetCropperPosition",value:function(){this.cropperPositionService.resetCropperPosition(this.sourceImage,this.cropper,this.settings),this.doAutoCrop(),this.imageVisible=!0}},{key:"keyboardAccess",value:function(t){this.changeKeyboardStepSize(t),this.keyboardMoveCropper(t)}},{key:"changeKeyboardStepSize",value:function(t){var e=+t.key;e>=1&&e<=9&&(this.settings.stepSize=e)}},{key:"keyboardMoveCropper",value:function(t){if(["ArrowUp","ArrowDown","ArrowRight","ArrowLeft"].includes(t.key)){var e=t.shiftKey?m.Resize:m.Move,n=t.altKey?function(t){switch(t){case"ArrowUp":return"bottom";case"ArrowRight":return"left";case"ArrowDown":return"top";case"ArrowLeft":default:return"right"}}(t.key):function(t){switch(t){case"ArrowUp":return"top";case"ArrowRight":return"right";case"ArrowDown":return"bottom";case"ArrowLeft":default:return"left"}}(t.key),i=function(t,e){switch(t){case"ArrowUp":return{clientX:0,clientY:-1*e};case"ArrowRight":return{clientX:e,clientY:0};case"ArrowDown":return{clientX:0,clientY:e};case"ArrowLeft":default:return{clientX:-1*e,clientY:0}}}(t.key,this.settings.stepSize);t.preventDefault(),t.stopPropagation(),this.startMove({clientX:0,clientY:0},e,n),this.moveImg(i),this.moveStop()}}},{key:"startMove",value:function(t,e){var n,i,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;(null===(n=this.moveStart)||void 0===n?void 0:n.active)&&(null===(i=this.moveStart)||void 0===i?void 0:i.type)===m.Pinch||(t.preventDefault&&t.preventDefault(),this.moveStart=Object.assign({active:!0,type:e,position:o,clientX:this.cropperPositionService.getClientX(t),clientY:this.cropperPositionService.getClientY(t)},this.cropper))}},{key:"startPinch",value:function(t){!this.safeImgDataUrl||(t.preventDefault&&t.preventDefault(),this.moveStart=Object.assign({active:!0,type:m.Pinch,position:"center",clientX:this.cropper.x1+(this.cropper.x2-this.cropper.x1)/2,clientY:this.cropper.y1+(this.cropper.y2-this.cropper.y1)/2},this.cropper))}},{key:"moveImg",value:function(t){this.moveStart.active&&(t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),this.moveStart.type===m.Move?(this.cropperPositionService.move(t,this.moveStart,this.cropper),this.checkCropperPosition(!0)):this.moveStart.type===m.Resize&&(!this.cropperStaticWidth&&!this.cropperStaticHeight&&this.cropperPositionService.resize(t,this.moveStart,this.cropper,this.maxSize,this.settings),this.checkCropperPosition(!1)),this.cd.detectChanges())}},{key:"onPinch",value:function(t){this.moveStart.active&&(t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),this.moveStart.type===m.Pinch&&(this.cropperPositionService.resize(t,this.moveStart,this.cropper,this.maxSize,this.settings),this.checkCropperPosition(!1)),this.cd.detectChanges())}},{key:"setMaxSize",value:function(){if(this.sourceImage){var t=this.sourceImage.nativeElement;this.maxSize.width=t.offsetWidth,this.maxSize.height=t.offsetHeight,this.marginLeft=this.sanitizer.bypassSecurityTrustStyle("calc(50% - "+this.maxSize.width/2+"px)")}}},{key:"setCropperScaledMinSize",value:function(){var t,e;(null===(e=null===(t=this.loadedImage)||void 0===t?void 0:t.transformed)||void 0===e?void 0:e.image)?(this.setCropperScaledMinWidth(),this.setCropperScaledMinHeight()):(this.settings.cropperScaledMinWidth=20,this.settings.cropperScaledMinHeight=20)}},{key:"setCropperScaledMinWidth",value:function(){this.settings.cropperScaledMinWidth=this.cropperMinWidth>0?Math.max(20,this.cropperMinWidth/this.loadedImage.transformed.image.width*this.maxSize.width):20}},{key:"setCropperScaledMinHeight",value:function(){this.settings.cropperScaledMinHeight=this.maintainAspectRatio?Math.max(20,this.settings.cropperScaledMinWidth/this.aspectRatio):this.cropperMinHeight>0?Math.max(20,this.cropperMinHeight/this.loadedImage.transformed.image.height*this.maxSize.height):20}},{key:"setCropperScaledMaxSize",value:function(){var t,e;if(null===(e=null===(t=this.loadedImage)||void 0===t?void 0:t.transformed)||void 0===e?void 0:e.image){var n=this.loadedImage.transformed.size.width/this.maxSize.width;this.settings.cropperScaledMaxWidth=this.cropperMaxWidth>20?this.cropperMaxWidth/n:this.maxSize.width,this.settings.cropperScaledMaxHeight=this.cropperMaxHeight>20?this.cropperMaxHeight/n:this.maxSize.height,this.maintainAspectRatio&&(this.settings.cropperScaledMaxWidth>this.settings.cropperScaledMaxHeight*this.aspectRatio?this.settings.cropperScaledMaxWidth=this.settings.cropperScaledMaxHeight*this.aspectRatio:this.settings.cropperScaledMaxWidth<this.settings.cropperScaledMaxHeight*this.aspectRatio&&(this.settings.cropperScaledMaxHeight=this.settings.cropperScaledMaxWidth/this.aspectRatio))}else this.settings.cropperScaledMaxWidth=this.maxSize.width,this.settings.cropperScaledMaxHeight=this.maxSize.height}},{key:"checkCropperPosition",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.cropper.x1<0&&(this.cropper.x2-=t?this.cropper.x1:0,this.cropper.x1=0),this.cropper.y1<0&&(this.cropper.y2-=t?this.cropper.y1:0,this.cropper.y1=0),this.cropper.x2>this.maxSize.width&&(this.cropper.x1-=t?this.cropper.x2-this.maxSize.width:0,this.cropper.x2=this.maxSize.width),this.cropper.y2>this.maxSize.height&&(this.cropper.y1-=t?this.cropper.y2-this.maxSize.height:0,this.cropper.y2=this.maxSize.height)}},{key:"moveStop",value:function(){this.moveStart.active&&(this.moveStart.active=!1,this.doAutoCrop())}},{key:"pinchStop",value:function(){this.moveStart.active&&(this.moveStart.active=!1,this.doAutoCrop())}},{key:"doAutoCrop",value:function(){this.autoCrop&&this.crop()}},{key:"crop",value:function(){var t,e;if(null!=(null===(e=null===(t=this.loadedImage)||void 0===t?void 0:t.transformed)||void 0===e?void 0:e.image)){this.startCropImage.emit();var n=this.cropService.crop(this.sourceImage,this.loadedImage,this.cropper,this.settings);return null!=n&&this.imageCropped.emit(n),n}return null}}]),t}();return t.\u0275fac=function(e){return new(e||t)(i.Y36(v),i.Y36(M),i.Y36(x),i.Y36(a.H7),i.Y36(i.sBO))},t.\u0275cmp=i.Xpm({type:t,selectors:[["image-cropper"]],viewQuery:function(t,e){var n;(1&t&&(i.Gf(s,7),i.Gf(l,5)),2&t)&&(i.iGM(n=i.CRH())&&(e.wrapper=n.first),i.iGM(n=i.CRH())&&(e.sourceImage=n.first))},hostVars:4,hostBindings:function(t,e){1&t&&i.NdJ("resize",function(){return e.onResize()},!1,i.Jf7)("mousemove",function(t){return e.moveImg(t)},!1,i.evT)("touchmove",function(t){return e.moveImg(t)},!1,i.evT)("mouseup",function(){return e.moveStop()},!1,i.evT)("touchend",function(){return e.moveStop()},!1,i.evT),2&t&&(i.Udp("text-align",e.alignImage),i.ekj("disabled",e.disabled))},inputs:{format:"format",transform:"transform",maintainAspectRatio:"maintainAspectRatio",aspectRatio:"aspectRatio",resizeToWidth:"resizeToWidth",resizeToHeight:"resizeToHeight",cropperMinWidth:"cropperMinWidth",cropperMinHeight:"cropperMinHeight",cropperMaxHeight:"cropperMaxHeight",cropperMaxWidth:"cropperMaxWidth",cropperStaticWidth:"cropperStaticWidth",cropperStaticHeight:"cropperStaticHeight",canvasRotation:"canvasRotation",initialStepSize:"initialStepSize",roundCropper:"roundCropper",onlyScaleDown:"onlyScaleDown",imageQuality:"imageQuality",autoCrop:"autoCrop",backgroundColor:"backgroundColor",containWithinAspectRatio:"containWithinAspectRatio",hideResizeSquares:"hideResizeSquares",cropper:"cropper",alignImage:"alignImage",disabled:"disabled",imageChangedEvent:"imageChangedEvent",imageURL:"imageURL",imageBase64:"imageBase64",imageFile:"imageFile"},outputs:{imageCropped:"imageCropped",startCropImage:"startCropImage",imageLoaded:"imageLoaded",cropperReady:"cropperReady",loadImageFailed:"loadImageFailed"},features:[i.TTD],decls:5,vars:10,consts:[["wrapper",""],["class","ngx-ic-source-image",3,"src","visibility","transform","load",4,"ngIf"],[1,"ngx-ic-overlay"],["class","ngx-ic-cropper","tabindex","0",3,"ngx-ic-round","top","left","width","height","margin-left","visibility","keydown",4,"ngIf"],[1,"ngx-ic-source-image",3,"src","load"],["sourceImage",""],["tabindex","0",1,"ngx-ic-cropper",3,"keydown"],[1,"ngx-ic-move",3,"mousedown","touchstart"],[4,"ngIf"],[1,"ngx-ic-resize","ngx-ic-topleft",3,"mousedown","touchstart"],[1,"ngx-ic-square"],[1,"ngx-ic-resize","ngx-ic-top"],[1,"ngx-ic-resize","ngx-ic-topright",3,"mousedown","touchstart"],[1,"ngx-ic-resize","ngx-ic-right"],[1,"ngx-ic-resize","ngx-ic-bottomright",3,"mousedown","touchstart"],[1,"ngx-ic-resize","ngx-ic-bottom"],[1,"ngx-ic-resize","ngx-ic-bottomleft",3,"mousedown","touchstart"],[1,"ngx-ic-resize","ngx-ic-left"],[1,"ngx-ic-resize-bar","ngx-ic-top",3,"mousedown","touchstart"],[1,"ngx-ic-resize-bar","ngx-ic-right",3,"mousedown","touchstart"],[1,"ngx-ic-resize-bar","ngx-ic-bottom",3,"mousedown","touchstart"],[1,"ngx-ic-resize-bar","ngx-ic-left",3,"mousedown","touchstart"]],template:function(t,e){1&t&&(i.TgZ(0,"div",null,0),i.YNc(2,u,2,5,"img",1),i._UZ(3,"div",2),i.YNc(4,h,3,15,"div",3),i.qZA()),2&t&&(i.Udp("background",e.imageVisible&&e.backgroundColor),i.xp6(2),i.Q6J("ngIf",e.safeImgDataUrl),i.xp6(1),i.Udp("width",e.maxSize.width,"px")("height",e.maxSize.height,"px")("margin-left","center"===e.alignImage?e.marginLeft:null),i.xp6(1),i.Q6J("ngIf",e.imageVisible))},directives:[r.O5],styles:['[_nghost-%COMP%]{display:flex;max-height:100%;max-width:100%;overflow:hidden;padding:5px;text-align:center}[_nghost-%COMP%], [_nghost-%COMP%] > div[_ngcontent-%COMP%]{position:relative;width:100%}[_nghost-%COMP%] > div[_ngcontent-%COMP%]   img.ngx-ic-source-image[_ngcontent-%COMP%]{max-height:100%;max-width:100%;transform-origin:center}[_nghost-%COMP%]   .ngx-ic-overlay[_ngcontent-%COMP%]{left:0;outline:var(--cropper-overlay-color,#fff) solid 100vw;pointer-events:none;position:absolute;top:0;touch-action:none}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]{background:transparent;color:#53535c;display:flex;outline:100vw solid hsla(0,0%,100%,.3);outline:var(--cropper-outline-color,hsla(0,0%,100%,.3)) solid 100vw;position:absolute;touch-action:none}@media (orientation:portrait){[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]{outline-width:100vh}}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]:after{border:1px dashed;bottom:0;color:inherit;content:"";left:0;opacity:.75;pointer-events:none;position:absolute;right:0;top:0;z-index:1}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-move[_ngcontent-%COMP%]{border:1px solid hsla(0,0%,100%,.5);cursor:move;width:100%}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]:focus   .ngx-ic-move[_ngcontent-%COMP%]{border-color:#1e90ff;border-width:2px}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize[_ngcontent-%COMP%]{display:inline-block;line-height:6px;opacity:.85;padding:8px;position:absolute;z-index:1}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize[_ngcontent-%COMP%]   .ngx-ic-square[_ngcontent-%COMP%]{background:#53535c;border:1px solid hsla(0,0%,100%,.5);box-sizing:content-box;display:inline-block;height:6px;width:6px}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-topleft[_ngcontent-%COMP%]{cursor:nwse-resize;left:-12px;top:-12px}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-top[_ngcontent-%COMP%]{cursor:ns-resize;left:calc(50% - 12px);top:-12px}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-topright[_ngcontent-%COMP%]{cursor:nesw-resize;right:-12px;top:-12px}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-right[_ngcontent-%COMP%]{cursor:ew-resize;right:-12px;top:calc(50% - 12px)}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-bottomright[_ngcontent-%COMP%]{bottom:-12px;cursor:nwse-resize;right:-12px}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-bottom[_ngcontent-%COMP%]{bottom:-12px;cursor:ns-resize;left:calc(50% - 12px)}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-bottomleft[_ngcontent-%COMP%]{bottom:-12px;cursor:nesw-resize;left:-12px}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-left[_ngcontent-%COMP%]{cursor:ew-resize;left:-12px;top:calc(50% - 12px)}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar[_ngcontent-%COMP%]{position:absolute;z-index:1}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-top[_ngcontent-%COMP%]{cursor:ns-resize;height:22px;left:11px;top:-11px;width:calc(100% - 22px)}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-right[_ngcontent-%COMP%]{cursor:ew-resize;height:calc(100% - 22px);right:-11px;top:11px;width:22px}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-bottom[_ngcontent-%COMP%]{bottom:-11px;cursor:ns-resize;height:22px;left:11px;width:calc(100% - 22px)}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-left[_ngcontent-%COMP%]{cursor:ew-resize;height:calc(100% - 22px);left:-11px;top:11px;width:22px}[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]{outline-color:transparent}[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]:after{border-radius:100%;box-shadow:0 0 0 100vw hsla(0,0%,100%,.3);box-shadow:0 0 0 100vw var(--cropper-outline-color,hsla(0,0%,100%,.3))}@media (orientation:portrait){[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]:after{box-shadow:0 0 0 100vh hsla(0,0%,100%,.3);box-shadow:0 0 0 100vh var(--cropper-outline-color,hsla(0,0%,100%,.3))}}[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]   .ngx-ic-move[_ngcontent-%COMP%]{border-radius:100%}.disabled[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-move[_ngcontent-%COMP%], .disabled[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize[_ngcontent-%COMP%], .disabled[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar[_ngcontent-%COMP%]{display:none}'],changeDetection:0}),t}(),_=function(){var t=function t(){c(this,t)};return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({imports:[[r.ez]]}),t}();function O(t){for(var e=t.split(","),n=e[0].replace("data:","").replace(";base64",""),i=atob(e[1]),o=new ArrayBuffer(i.length),r=new Uint8Array(o),a=0;a<i.length;a+=1)r[a]=i.charCodeAt(a);return new Blob([o],{type:n})}},70011:function(n,o,s){s.r(o),s.d(o,{AdminModule:function(){return ri}});var l,u=s(31664),g=s(38583),h=s(90665),p=s(39075),f=s(42976),m=s(35499),v=s(7838),M=s(55819),x=s(37716),C=((l=function t(){c(this,t)}).\u0275fac=function(t){return new(t||l)},l.\u0275cmp=x.Xpm({type:l,selectors:[["app-admin"]],decls:6,vars:0,consts:[[1,"left"],["role","main",1,"middle"]],template:function(t,e){1&t&&(x.TgZ(0,"aside",0),x._UZ(1,"app-admin-sidebar"),x.qZA(),x._UZ(2,"app-splitter"),x.TgZ(3,"main",1),x._UZ(4,"router-outlet"),x.qZA(),x._UZ(5,"app-admin-queue-requests"))},styles:["[_nghost-%COMP%]{width:100%;height:100%;flex:1;display:flex;flex-flow:row nowrap;overflow:hidden;align-items:flex-start;align-content:flex-start}[_nghost-%COMP%]   .left[_ngcontent-%COMP%]{width:15%;height:100%;min-width:140px}[_nghost-%COMP%]   .middle[_ngcontent-%COMP%]{width:85%;flex-grow:1;height:100%}@media (max-width: 1400px){[_nghost-%COMP%]   .left[_ngcontent-%COMP%]{width:20%}[_nghost-%COMP%]   .middle[_ngcontent-%COMP%]{width:80%}}@media (max-width: 768px){[_nghost-%COMP%]{min-height:100%;position:absolute;display:block;flex:none;flex-flow:inherit}[_nghost-%COMP%]   app-splitter[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .left[_ngcontent-%COMP%]{width:100%!important;height:auto}[_nghost-%COMP%]   .middle[_ngcontent-%COMP%]{width:100%;min-height:100%}}"]}),l),_=s(64762),O=s(76277),y=s(79765),b=s(46782),k=["overview","tags","health","tracks","tracks-health"],P=s(60918),w=s(75723),Z=s(37544),A=s(42205),T=s(96491),I=s(8986);function q(t,e){1&t&&x._UZ(0,"i",14)}function S(t,e){if(1&t&&(x.TgZ(0,"i"),x.ALo(1,"stringToggle"),x.qZA()),2&t){var n=x.oxw().$implicit;x.Tol(x.Dn7(1,2,n.expanded,"icon-minus","icon-plus"))}}function U(t,e){if(1&t){var n=x.EpF();x.ynx(0),x.TgZ(1,"div",7),x.NdJ("click",function(){var t=x.CHM(n).$implicit;return x.oxw().selectNode(t)})("keydown.enter",function(){var t=x.CHM(n).$implicit;return x.oxw().selectNode(t)})("keydown.arrowRight",function(){var t=x.CHM(n).$implicit;return x.oxw().toggleNode(t)})("keydown.arrowLeft",function(){var t=x.CHM(n).$implicit;return x.oxw().toggleNode(t)}),x.TgZ(2,"span",8),x.NdJ("clickenter",function(){var t=x.CHM(n).$implicit;return x.oxw().toggleNode(t)}),x.YNc(3,q,1,0,"i",9),x.YNc(4,S,2,6,"i",10),x.qZA(),x.TgZ(5,"span",11),x.NdJ("clickenter",function(){var t=x.CHM(n).$implicit;return x.oxw().toggleNode(t)}),x.TgZ(6,"i"),x.ALo(7,"stringToggle"),x.qZA(),x.qZA(),x.TgZ(8,"span",12),x._uU(9),x.qZA(),x.TgZ(10,"span",13),x._uU(11),x.qZA(),x.qZA(),x.BQk()}if(2&t){var i=e.$implicit,o=x.oxw();x.xp6(1),x.Udp("padding-left",12*i.level,"px"),x.ekj("active",i===o.selected),x.xp6(1),x.MGl("title","Subfolders: ",i.folder.folderCount,""),x.xp6(1),x.Q6J("ngIf",i.isLoading),x.xp6(1),x.Q6J("ngIf",!i.isLoading&&i.hasChildren),x.xp6(1),x.Udp("color",i.color),x.Q6J("title",i.folder.type),x.xp6(1),x.Tol(x.Dn7(7,15,i.expanded,"icon-folder-open","icon-folder")),x.xp6(2),x.Q6J("title",i.folder.name),x.xp6(1),x.Oqu(i.folder.name),x.xp6(2),x.hij("| ",i.folder.type,"")}}function R(t,e){if(t.children){var n,i=a(t.children);try{for(i.s();!(n=i.n()).done;){var o=n.value;e(o),R(o,e)}}catch(r){i.e(r)}finally{i.f()}}}var J=function(){var t=function(){function t(e,n,i,o){c(this,t),this.app=e,this.jam=n,this.notify=i,this.folderService=o,this.nodes=[],this.expandIDs=[],this.autoSelect=!1,this.selectionChange=new x.vpe,this.unsubscribe=new y.xQ}return d(t,[{key:"ngOnInit",value:function(){var t=this;this.folderService.foldersChange.pipe((0,b.R)(this.unsubscribe)).subscribe(function(e){var n=t.nodes.find(function(t){return t.folder.id===e.id});n&&t.jam.folder.id({id:e.id,folderIncTrackCount:!0,folderIncChildFolderCount:!0}).then(function(i){n.folder=i,e.mode===P.dw.fsnRefreshChilds&&n.expanded&&(t.collapseNode(n),n.hasChildren=(i.folderCount||0)>0,n.children=void 0,n.isLoading=!1,n.hasChildren&&(n.expanded=!0,t.checkLoadExpanded(n)))}).catch(function(t){console.error(t)})})}},{key:"ngOnDestroy",value:function(){this.unsubscribe.next(),this.unsubscribe.complete()}},{key:"selectNode",value:function(t){this.selectionChange.emit(t.folder),this.autoSelect&&(this.selected=t)}},{key:"toggleNode",value:function(t){t.expanded?this.collapseNode(t):this.expandNode(t)}},{key:"refresh",value:function(){var t=this;!this.jam.auth.isLoggedIn()||this.jam.folder.search({level:0,folderIncChildFolderCount:!0,folderIncTrackCount:!0}).then(function(e){t.nodes=e.items.map(function(e){return{folder:e,hasChildren:(e.folderCount||0)>0,level:0,color:t.typeToColor(e),expanded:t.expandIDs.includes(e.id),isLoading:!1}});var n,i=a(t.nodes);try{for(i.s();!(n=i.n()).done;){var o=n.value;t.checkLoadExpanded(o)}}catch(r){i.e(r)}finally{i.f()}}).catch(function(e){t.notify.error(e)})}},{key:"typeToColor",value:function(t){switch(t.type){case w.Sr.unknown:return"#ff9fAA";case w.Sr.artist:return"#6f806e";case w.Sr.collection:return"#adbced";case w.Sr.album:return"#bdbd9c";case w.Sr.multialbum:return"#bdaaae";case w.Sr.extras:return"#bdbdbd";default:return""}}},{key:"onFolderUpdate",value:function(t){var e=this.nodes.find(function(e){return e.folder.id===t.id});e&&(e.folder=t)}},{key:"selectFolderByID",value:function(t){var e=this,n=this.nodes.find(function(e){return e.folder.id===t});n?this.selected=n:this.jam.folder.id({id:t,folderIncParents:!0}).then(function(n){if(n.parents){var i,o=a(n.parents);try{for(o.s();!(i=o.n()).done;){var r=i.value;e.expandIDs.includes(r.id)||e.expandIDs.push(r.id)}}catch(d){o.e(d)}finally{o.f()}var s,c=a(e.nodes);try{for(c.s();!(s=c.n()).done;){var l=s.value;l.expanded=e.expandIDs.includes(l.folder.id),e.checkLoadExpanded(l,t)}}catch(d){c.e(d)}finally{c.f()}}}).catch(function(t){e.notify.error(t)})}},{key:"checkLoadExpanded",value:function(t,e){var n=this;t.expanded&&!t.isLoading&&this.loadChildren(t,function(t){var i,o=a(t);try{for(o.s();!(i=o.n()).done;){var r=i.value;n.checkLoadExpanded(r,e)}}catch(s){o.e(s)}finally{o.f()}}),t.folder.id===e&&(this.selected=t,this.viewport&&this.viewport.scrollToIndex(this.nodes.indexOf(t)))}},{key:"loadChildren",value:function(t,e){var n=this;t.isLoading||(t.isLoading=!0,this.jam.folder.search({parentIDs:[t.folder.id],folderIncChildFolderCount:!0,folderIncTrackCount:!0}).then(function(i){var o=i.items.sort(function(t,e){return t.name.localeCompare(e.name)}).map(function(e){return{folder:e,hasChildren:(e.folderCount||0)>0,level:t.level+1,color:n.typeToColor(e),expanded:n.expandIDs.includes(e.id),isLoading:!1}}),r=n.nodes.indexOf(t);r>=0&&(n.nodes=n.nodes.slice(0,r+1).concat(o).concat(n.nodes.slice(r+1))),t.children=o,t.isLoading=!1,e&&e(o)}).catch(function(t){n.notify.error(t)}))}},{key:"collapseNode",value:function(t){if(t.expanded){var e=[];R(t,function(t){return e.push(t.folder.id)}),this.nodes=this.nodes.filter(function(t){return!e.includes(t.folder.id)}),t.expanded=!1,t.children=void 0,this.expandIDs=(this.expandIDs||[]).filter(function(e){return e!==t.folder.id})}}},{key:"expandNode",value:function(t){if(!t.expanded){if(t.children){var e=this.nodes.indexOf(t);this.nodes=this.nodes.slice(0,e+1).concat(t.children).concat(this.nodes.slice(e+1))}else this.loadChildren(t);this.expandIDs.push(t.folder.id),t.expanded=!0}}}]),t}();return t.\u0275fac=function(e){return new(e||t)(x.Y36(P.zi),x.Y36(w.K4),x.Y36(P.c),x.Y36(P.Cr))},t.\u0275cmp=x.Xpm({type:t,selectors:[["app-admin-folder-tree"]],viewQuery:function(t,e){var n;(1&t&&x.Gf(u.N7,7),2&t)&&(x.iGM(n=x.CRH())&&(e.viewport=n.first))},inputs:{autoSelect:"autoSelect"},outputs:{selectionChange:"selectionChange"},decls:8,vars:2,consts:[[1,"actions"],[1,"name"],["title","Refresh Folder Tree",1,"button-on-control",3,"click"],["aria-hidden","true",1,"icon-reload"],["appFocusKeyList","",1,"tree"],[1,"list-container","list-group",2,"height","100%",3,"itemSize"],[4,"cdkVirtualFor","cdkVirtualForOf"],["appFocusKeyListItem","",1,"node",3,"click","keydown.enter","keydown.arrowRight","keydown.arrowLeft"],[1,"node-toggle",3,"title","clickenter"],["class","icon-spin icon-spinner",4,"ngIf"],[3,"class",4,"ngIf"],[1,"node-icon",3,"title","clickenter"],[3,"title"],[1,"node-type"],[1,"icon-spin","icon-spinner"]],template:function(t,e){1&t&&(x.TgZ(0,"div",0),x.TgZ(1,"span",1),x._uU(2,"Folders"),x.qZA(),x.TgZ(3,"button",2),x.NdJ("click",function(){return e.refresh()}),x._UZ(4,"i",3),x.qZA(),x.qZA(),x.TgZ(5,"div",4),x.TgZ(6,"cdk-virtual-scroll-viewport",5),x.YNc(7,U,12,19,"ng-container",6),x.qZA(),x.qZA()),2&t&&(x.xp6(6),x.Q6J("itemSize",22),x.xp6(1),x.Q6J("cdkVirtualForOf",e.nodes))},directives:[Z.R,u.N7,u.xd,u.x0,A.j,T.X,g.O5],pipes:[I.C],styles:["[_nghost-%COMP%]{width:100%;height:100%;display:flex;flex-direction:column}[_nghost-%COMP%]   .actions[_ngcontent-%COMP%]{padding:15px 15px 10px;background-color:var(--background-transparent);color:var(--on-control)}[_nghost-%COMP%]   .actions[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{padding-right:10px;vertical-align:middle;color:var(--on-control-active);font-size:20px;font-weight:100}[_nghost-%COMP%]   .tree[_ngcontent-%COMP%]{margin-top:10px;flex:1}[_nghost-%COMP%]   cdk-virtual-scroll-viewport[_ngcontent-%COMP%]{width:100%;height:100%;min-height:100%;overflow-x:hidden}[_nghost-%COMP%]   cdk-virtual-scroll-viewport[_ngcontent-%COMP%]     .cdk-virtual-scroll-content-wrapper{width:100%}[_nghost-%COMP%]   .node[_ngcontent-%COMP%]{width:100%;display:block;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;text-decoration:none;vertical-align:middle;height:22px;cursor:pointer;-webkit-user-select:none;user-select:none;font-size:.9em}[_nghost-%COMP%]   .node[_ngcontent-%COMP%]   .node-toggle[_ngcontent-%COMP%]{display:inline-block;min-width:20px}[_nghost-%COMP%]   .node[_ngcontent-%COMP%]   .node-type[_ngcontent-%COMP%]{padding-left:5px;font-size:.7em;text-transform:uppercase}[_nghost-%COMP%]   .node.active[_ngcontent-%COMP%]{color:var(--on-control-hover)}"]}),t}(),Q=s(40150);function N(t,e){1&t&&(x.TgZ(0,"a"),x._UZ(1,"i",8),x._uU(2," Show Folder Tools"),x.qZA())}function F(t,e){1&t&&(x.TgZ(0,"a"),x._UZ(1,"i",9),x._uU(2," Show Folder Tree"),x.qZA())}var H=function(t){return["/admin/folder",t,"overview"]},z=function(t){return["/admin/folder",t,"tracks"]},Y=function(t){return["/admin/folder",t,"sub-folders"]},D=function(t){return["/admin/folder",t,"tags"]},E=function(t){return["/admin/folder",t,"health"]},j=function(t){return["/admin/folder",t,"tracks-health"]};function B(t,e){if(1&t&&(x.TgZ(0,"nav",10),x.TgZ(1,"ul",11),x.TgZ(2,"li",12),x.TgZ(3,"a"),x._uU(4,"Overview"),x.qZA(),x.qZA(),x.TgZ(5,"li",12),x.TgZ(6,"a"),x._uU(7,"Tracks"),x.qZA(),x.qZA(),x.TgZ(8,"li",12),x.TgZ(9,"a"),x._uU(10,"Folders"),x.qZA(),x.qZA(),x.TgZ(11,"li",12),x.TgZ(12,"a"),x._uU(13,"Tags"),x.qZA(),x.qZA(),x.TgZ(14,"li",12),x.TgZ(15,"a"),x._uU(16,"Health"),x.qZA(),x.qZA(),x.TgZ(17,"li",12),x.TgZ(18,"a"),x._uU(19,"Track Health"),x.qZA(),x.qZA(),x.qZA(),x.qZA()),2&t){var n=x.oxw();x.xp6(2),x.Q6J("routerLink",x.VKq(6,H,n.id)),x.xp6(3),x.Q6J("routerLink",x.VKq(8,z,n.id)),x.xp6(3),x.Q6J("routerLink",x.VKq(10,Y,n.id)),x.xp6(3),x.Q6J("routerLink",x.VKq(12,D,n.id)),x.xp6(3),x.Q6J("routerLink",x.VKq(14,E,n.id)),x.xp6(3),x.Q6J("routerLink",x.VKq(16,j,n.id))}}var L=function(){var t=function(){function t(e,n,i){c(this,t),this.route=e,this.router=n,this.uiState=i,this.id="",this.rightActive=!1,this.unsubscribe=new y.xQ,this.mode="overview"}return d(t,[{key:"refresh",value:function(){this.tree&&this.tree.refresh()}},{key:"selectionChange",value:function(t){this.router.navigate(["/admin/folder/".concat(t.id,"/").concat(this.mode)]).catch(function(t){console.error(t)})}},{key:"onFolderUpdate",value:function(t){this.tree&&this.tree.onFolderUpdate(t)}},{key:"ngOnInit",value:function(){var t=this;this.router.events.pipe((0,b.R)(this.unsubscribe)).subscribe(function(e){if(e instanceof O.m2&&t.route.firstChild&&t.route.firstChild.snapshot.url[0]){var n=t.route.firstChild.snapshot.url[0].path;k.includes(n)&&(t.mode=n)}}),this.route&&this.route.params.pipe((0,b.R)(this.unsubscribe)).subscribe(function(e){var n=e.id;t.id=n,t.tree&&n&&setTimeout(function(){t.tree&&t.tree.selectFolderByID(n)})}),this.tree&&(this.tree.expandIDs=this.uiState.data["app-admin-folders"]||[]),this.refresh()}},{key:"ngOnDestroy",value:function(){this.tree&&(this.uiState.data["app-admin-folders"]=this.tree.expandIDs),this.unsubscribe.next(),this.unsubscribe.complete()}}]),t}();return t.\u0275fac=function(e){return new(e||t)(x.Y36(O.gz),x.Y36(O.F0),x.Y36(P.JU))},t.\u0275cmp=x.Xpm({type:t,selectors:[["app-admin-folder"]],viewQuery:function(t,e){var n;(1&t&&x.Gf(J,7),2&t)&&(x.iGM(n=x.CRH())&&(e.tree=n.first))},hostVars:2,hostBindings:function(t,e){2&t&&x.ekj("right-active",e.rightActive)},decls:11,vars:3,consts:[[1,"toggle",3,"click"],[4,"ngIf"],[1,"content"],[1,"left-content"],[3,"selectionChange"],[1,"right-content"],["class","navigation",4,"ngIf"],[1,"router-content"],[1,"icon-right"],[1,"icon-left"],[1,"navigation"],[1,"tabs"],["routerLinkActive","active",3,"routerLink"]],template:function(t,e){1&t&&(x.TgZ(0,"button",0),x.NdJ("click",function(){return e.rightActive=!e.rightActive}),x.YNc(1,N,3,0,"a",1),x.YNc(2,F,3,0,"a",1),x.qZA(),x.TgZ(3,"div",2),x.TgZ(4,"div",3),x.TgZ(5,"app-admin-folder-tree",4),x.NdJ("selectionChange",function(t){return e.selectionChange(t)}),x.qZA(),x.qZA(),x._UZ(6,"app-splitter"),x.TgZ(7,"div",5),x.YNc(8,B,20,18,"nav",6),x.TgZ(9,"div",7),x._UZ(10,"router-outlet"),x.qZA(),x.qZA(),x.qZA()),2&t&&(x.xp6(1),x.Q6J("ngIf",!e.rightActive),x.xp6(1),x.Q6J("ngIf",e.rightActive),x.xp6(6),x.Q6J("ngIf",e.id))},directives:[g.O5,J,Q.H,O.lC,O.Od,O.rH],styles:["[_nghost-%COMP%]{overflow-y:auto;overflow-x:hidden;height:100%;width:100%;min-height:100%;flex:1 1 auto;position:relative;display:flex;flex-direction:column;overflow:hidden}[_nghost-%COMP%]   .toggle[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]{width:100%;z-index:1;display:flex;flex-flow:row wrap;justify-content:space-between;align-items:center;background-color:var(--background-transparent);color:var(--on-control)}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%]{padding-left:0;margin-top:0;margin-bottom:0;list-style:none;border:none;display:flex;flex-flow:row wrap;width:100%}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{position:relative;display:block;margin-bottom:-1px;flex:1;align-self:stretch;border-top-width:4px;border-top-style:solid;border-top-color:transparent;border-bottom-width:4px;border-bottom-style:solid;border-bottom-color:transparent;padding:0}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]:hover{background-color:var(--control-hover);transition:all .4s ease;border-bottom-width:4px;border-bottom-style:solid;border-bottom-color:transparent}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{padding-bottom:15px}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{padding:10px 0;text-align:center;align-items:center;align-content:center;justify-content:center;margin-right:2px;line-height:1.42857143;border-radius:4px 4px 0 0;position:relative;display:flex;cursor:pointer;border:none;font-size:14px;text-transform:uppercase;letter-spacing:.5px;height:100%;color:var(--on-control);-webkit-user-select:none;user-select:none}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]:focus, [_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]:hover{background-color:unset;border:none;color:var(--on-control-hover)}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%] > li.active[_ngcontent-%COMP%]{cursor:default;border-bottom-color:var(--primary)!important}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%] > li.active[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:default;background-color:unset;color:var(--on-control-hover)}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%] > li.active[_ngcontent-%COMP%]:focus, [_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%] > li.active[_ngcontent-%COMP%]:hover{border-bottom-color:var(--primary)}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%] > li.disabled[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{color:var(--on-control-ambient-disabled)}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%] > li.disabled[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]:focus, [_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%] > li.disabled[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]:hover{color:var(--on-control-ambient-disabled);text-decoration:none;cursor:not-allowed;background-color:transparent}@media (max-width: 768px){[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%]{align-items:center;align-content:center;justify-content:center}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{padding:5px;min-width:33%}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{font-size:.8em}}@media (max-width: 400px){[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{padding:0 5px}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{font-size:.7em}}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs.mini[_ngcontent-%COMP%]{padding-left:15px;padding-right:15px}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs.mini[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{flex:0}@media (max-width: 768px){[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs.mini[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{min-width:20px}}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]{width:100%;height:100%;flex:1;display:flex;flex-flow:row nowrap;overflow:hidden;align-items:flex-start;align-content:flex-start;padding:0;min-height:100%}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .left-content[_ngcontent-%COMP%]{height:100%;width:20%;display:block;border-right:1px solid var(--background-border);min-width:240px}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .right-content[_ngcontent-%COMP%]{width:80%;flex-shrink:1;flex-grow:1;height:100%;display:flex;flex-flow:column nowrap;position:relative;overflow:hidden}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .right-content[_ngcontent-%COMP%]   .router-content[_ngcontent-%COMP%]{width:100%;height:100%;display:block;overflow:hidden}@media (max-width: 522px){[_nghost-%COMP%]{height:100%;width:100%;min-height:100%;overflow:hidden}[_nghost-%COMP%]   .toggle[_ngcontent-%COMP%]{display:block;position:relative;width:100%;height:33px;text-align:center;padding-top:5px;border-bottom:1px solid var(--background-border)}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]{width:100%;height:calc(100% - 33px);min-height:calc(100% - 33px);overflow:hidden;display:block;flex:none;position:relative}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   app-splitter[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .left-content[_ngcontent-%COMP%]{display:flex;height:100%;width:100%}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .right-content[_ngcontent-%COMP%]{display:none;height:100%;width:100%}.right-active[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .left-content[_ngcontent-%COMP%]{display:none}.right-active[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .right-content[_ngcontent-%COMP%]{display:flex}}"]}),t}(),W=function(){var t=function(){function t(e){c(this,t),this.route=e,this.unsubscribe=new y.xQ}return d(t,[{key:"ngOnInit",value:function(){var t=this;this.route&&this.route.parent&&this.route.parent.params.pipe((0,b.R)(this.unsubscribe)).subscribe(function(e){t.resolve(e),t.refresh()})}},{key:"idChanged",value:function(){}},{key:"refresh",value:function(){}},{key:"ngOnDestroy",value:function(){this.unsubscribe.next(),this.unsubscribe.complete()}},{key:"resolve",value:function(t){this.id=t.id,this.idChanged()}}]),t}();return t.\u0275fac=function(e){return new(e||t)(x.Y36(O.gz))},t.\u0275cmp=x.Xpm({type:t,selectors:[["app-admin-base-parent-view-id"]],decls:0,vars:0,template:function(t,e){},styles:[""]}),t}(),G=function(){var t=function(){function t(){c(this,t)}return d(t,[{key:"selectionChange",value:function(t){this.data&&(this.data.folder=t)}},{key:"dialogInit",value:function(t,e){var n;this.data=e.data,this.tree&&(this.tree.refresh(),(null===(n=this.data)||void 0===n?void 0:n.selectID)&&this.tree.selectFolderByID(this.data.selectID))}}]),t}();return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=x.Xpm({type:t,selectors:[["app-dialog-choose-folder"]],viewQuery:function(t,e){var n;(1&t&&x.Gf(J,7),2&t)&&(x.iGM(n=x.CRH())&&(e.tree=n.first))},decls:1,vars:1,consts:[[3,"autoSelect","selectionChange"]],template:function(t,e){1&t&&(x.TgZ(0,"app-admin-folder-tree",0),x.NdJ("selectionChange",function(t){return e.selectionChange(t)}),x.qZA()),2&t&&x.Q6J("autoSelect",!0)},directives:[J],styles:["[_nghost-%COMP%]{flex:1}"]}),t}(),$=function(){return{standalone:!0}};function V(t,e){if(1&t){var n=x.EpF();x.TgZ(0,"div"),x.TgZ(1,"form"),x.TgZ(2,"div",1),x.TgZ(3,"label",2),x._uU(4,"Name"),x.qZA(),x.TgZ(5,"input",3),x.NdJ("ngModelChange",function(t){return x.CHM(n),x.oxw().edit.name=t}),x.qZA(),x.qZA(),x.qZA(),x.qZA()}if(2&t){var i=x.oxw();x.xp6(5),x.Q6J("ngModel",i.edit.name)("ngModelOptions",x.DdM(2,$))}}var X=function(){var t=function(){function t(){c(this,t)}return d(t,[{key:"dialogInit",value:function(t,e){this.edit=e.data}}]),t}();return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=x.Xpm({type:t,selectors:[["app-dialog-folder"]],decls:1,vars:1,consts:[[4,"ngIf"],[1,"user-form-control"],["for","dialog-folder-edit"],["id","dialog-folder-edit","type","text","name","folder-name",3,"ngModel","ngModelOptions","ngModelChange"]],template:function(t,e){1&t&&x.YNc(0,V,6,3,"div",0),2&t&&x.Q6J("ngIf",e.edit)},directives:[g.O5,h._Y,h.JL,h.F,h.Fj,h.JJ,h.On],styles:["[_nghost-%COMP%] > div[_ngcontent-%COMP%]{margin-left:20px;margin-right:20px}[_nghost-%COMP%]   input[type=text][_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]   input[_ngcontent-%COMP%]{font-size:1.3em;line-height:1.3em}[_nghost-%COMP%]   .user-form-control[_ngcontent-%COMP%]{margin-bottom:8px;display:block}"]}),t}(),K=s(24654),tt=s(87639),et=s(7480),nt=s(62569);function it(t,e){if(1&t&&(x.ynx(0),x._uU(1),x.BQk()),2&t){var n=x.oxw().$implicit;x.xp6(1),x.hij(" / ",null==n.folder.tag?null:n.folder.tag.albumType,"")}}var ot=function(t){return["/admin/folder",t,"overview"]};function rt(t,e){if(1&t){var n=x.EpF();x.TgZ(0,"tr",10),x.NdJ("click",function(){var t=x.CHM(n).$implicit;return t.selected=!t.selected}),x.TgZ(1,"td",4),x.TgZ(2,"a",11),x._uU(3),x.qZA(),x.qZA(),x.TgZ(4,"td",5),x._uU(5),x.qZA(),x.TgZ(6,"td",6),x._uU(7),x.qZA(),x.TgZ(8,"td",7),x._uU(9),x.qZA(),x.TgZ(10,"td",8),x._uU(11),x.YNc(12,it,2,1,"ng-container",12),x.qZA(),x.qZA()}if(2&t){var i=e.$implicit;x.ekj("selected",i.selected),x.xp6(2),x.Q6J("routerLink",x.VKq(9,ot,i.folder.id)),x.xp6(1),x.Oqu(i.folder.name),x.xp6(2),x.Oqu(null==i.folder.tag?null:i.folder.tag.artist),x.xp6(2),x.Oqu(null==i.folder.tag?null:i.folder.tag.album),x.xp6(2),x.Oqu(null==i.folder.tag?null:i.folder.tag.year),x.xp6(2),x.hij(" ",i.folder.type," "),x.xp6(1),x.Q6J("ngIf",null==i.folder.tag?null:i.folder.tag.albumType)}}function at(t,e){if(1&t&&(x.TgZ(0,"table",2),x.TgZ(1,"tr",3),x.TgZ(2,"td",4),x._uU(3,"Title"),x.qZA(),x.TgZ(4,"td",5),x._uU(5,"Artist"),x.qZA(),x.TgZ(6,"td",6),x._uU(7,"Album"),x.qZA(),x.TgZ(8,"td",7),x._uU(9,"Year"),x.qZA(),x.TgZ(10,"td",8),x._uU(11,"Type"),x.qZA(),x.qZA(),x.YNc(12,rt,13,11,"tr",9),x.qZA()),2&t){var n=x.oxw();x.xp6(12),x.Q6J("ngForOf",n.folderItems)}}var st=function t(e){c(this,t),this.folder=e},ct=function(){var t=function(){function t(){c(this,t),this.folders=[],this.folderItems=[]}return d(t,[{key:"getSortValue",value:function(t,e){var n,i;switch(t){case"name":return e.name;case"artist":return null===(n=e.tag)||void 0===n?void 0:n.artist;case"album":return null===(i=e.tag)||void 0===i?void 0:i.album;case"type":return e.type;default:return}}},{key:"ngOnChanges",value:function(){this.folderItems=(this.folders||[]).map(function(t){return new st(t)})}}]),t}();return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=x.Xpm({type:t,selectors:[["app-admin-folder-list"]],inputs:{folders:"folders"},features:[x.TTD],decls:2,vars:2,consts:[["name","Folders",3,"list"],["class","folders",4,"ngIf"],[1,"folders"],[1,"folder","heading"],[1,"title"],[1,"artist"],[1,"album"],[1,"year"],[1,"type"],["class","folder",3,"selected","click",4,"ngFor","ngForOf"],[1,"folder",3,"click"],[3,"routerLink"],[4,"ngIf"]],template:function(t,e){1&t&&(x._UZ(0,"app-background-text-list",0),x.YNc(1,at,13,1,"table",1)),2&t&&(x.Q6J("list",e.folderItems),x.xp6(1),x.Q6J("ngIf",e.folderItems&&e.folderItems.length>0))},directives:[nt.$,g.O5,g.sg,O.yS],styles:["[_nghost-%COMP%]{width:100%;overflow:auto;display:block}[_nghost-%COMP%]   .folders[_ngcontent-%COMP%]{padding:15px;font-size:.8em;width:100%}[_nghost-%COMP%]   .heading[_ngcontent-%COMP%]{font-size:.9em}[_nghost-%COMP%]   .folder[_ngcontent-%COMP%]{border-bottom:1px solid var(--control-border)}[_nghost-%COMP%]   .folder[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:5px 10px}[_nghost-%COMP%]   .folder[_ngcontent-%COMP%]:hover{background-color:var(--background-hover)}[_nghost-%COMP%]   .folder.selected[_ngcontent-%COMP%]{background-color:var(--background-active)}"]}),t}();function lt(t,e){1&t&&x._UZ(0,"app-loading")}function dt(t,e){if(1&t){var n=x.EpF();x.TgZ(0,"button",11),x.NdJ("click",function(){return x.CHM(n),x.oxw(2).moveSubfolders()}),x._UZ(1,"i",12),x.qZA()}}function ut(t,e){if(1&t&&x._UZ(0,"app-admin-folder-list",13),2&t){var n=x.oxw(2);x.Q6J("folders",n.folder.folders)}}function gt(t,e){if(1&t){var n=x.EpF();x.TgZ(0,"div",2),x.TgZ(1,"div",3),x.TgZ(2,"button",4),x.NdJ("click",function(){return x.CHM(n),x.oxw().refresh()}),x._UZ(3,"i",5),x.qZA(),x.TgZ(4,"button",6),x.NdJ("click",function(){return x.CHM(n),x.oxw().newFolder()}),x._UZ(5,"i",7),x.qZA(),x.YNc(6,dt,2,0,"button",8),x.qZA(),x._UZ(7,"app-background-text-list",9),x.YNc(8,ut,1,1,"app-admin-folder-list",10),x.qZA()}if(2&t){var i=x.oxw();x.xp6(6),x.Q6J("ngIf",null==i.folder||null==i.folder.folders?null:i.folder.folders.length),x.xp6(1),x.Q6J("list",i.folder.folders),x.xp6(1),x.Q6J("ngIf",null==i.folder.folders?null:i.folder.folders.length)}}var ht=function(){var n=function(n){e(a,n);var o=i(a);function a(t,e,n,i,r,s){var l;return c(this,a),(l=o.call(this,t)).jam=e,l.notify=n,l.folderService=i,l.dialogsService=r,l.dialogOverlay=s,l}return d(a,[{key:"ngOnInit",value:function(){var e=this;t(r(a.prototype),"ngOnInit",this).call(this),this.folderService.foldersChange.pipe((0,b.R)(this.unsubscribe)).subscribe(function(t){t.id===e.id&&e.refresh()})}},{key:"ngOnDestroy",value:function(){t(r(a.prototype),"ngOnDestroy",this).call(this)}},{key:"refresh",value:function(){var t=this;this.folder=void 0,this.id&&this.jam.folder.id({id:this.id,folderIncFolders:!0,folderIncTag:!0}).then(function(e){t.folder=e}).catch(function(e){t.notify.error(e)})}},{key:"newFolder",value:function(){var t=this;if(this.folder){var e=this.folder,n={folder:e,name:""};this.dialogOverlay.open({childComponent:X,title:"New Folder",data:n,onOkBtn:function(){return(0,_.mG)(t,void 0,void 0,regeneratorRuntime.mark(function t(){var i=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:t.prev=0,this.jam.folder.create({id:e.id,name:n.name}).then(function(t){i.folderService.waitForQueueResult("Creating Folder",t,[],[e.id])}).catch(function(t){i.notify.error(t)}),t.next=7;break;case 4:return t.prev=4,t.t0=t.catch(0),t.abrupt("return",(this.notify.error(t.t0),Promise.reject(t.t0)));case 7:case"end":return t.stop()}},t,this,[[0,4]])}))},onCancelBtn:function(){return(0,_.mG)(t,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Promise.resolve());case 1:case"end":return t.stop()}},t)}))}})}}},{key:"moveSubfolders",value:function(){var t,e=this;if(this.id&&(null===(t=this.folder)||void 0===t?void 0:t.folders)){var n=this.id,i=this.folder.folders.map(function(t){return t.id}),o=[n].concat(i),r={selectID:n,disableIDs:o};this.dialogOverlay.open({title:"Move Subfolders to",childComponent:G,data:r,panelClass:"overlay-panel-large-buttons",onOkBtn:function(){return(0,_.mG)(e,void 0,void 0,regeneratorRuntime.mark(function t(){var e,n=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e=r.folder){t.next=4;break}return t.abrupt("return");case 4:o.push(e.id),this.jam.folder.move({ids:i,newParentID:e.id}).then(function(t){n.folderService.waitForQueueResult("Moving Folders",t,[],o)}).catch(function(t){n.notify.error(t)}),t.next=10;break;case 7:return t.prev=7,t.t0=t.catch(0),t.abrupt("return",(this.notify.error(t.t0),Promise.reject(t.t0)));case 10:case"end":return t.stop()}},t,this,[[0,7]])}))},onCancelBtn:function(){return(0,_.mG)(e,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Promise.resolve());case 1:case"end":return t.stop()}},t)}))}})}}}]),a}(W);return n.\u0275fac=function(t){return new(t||n)(x.Y36(O.gz),x.Y36(w.K4),x.Y36(P.c),x.Y36(P.Cr),x.Y36(K.Hr),x.Y36(tt.SL))},n.\u0275cmp=x.Xpm({type:n,selectors:[["app-admin-folder-folders"]],features:[x.qOj],decls:2,vars:2,consts:[[4,"ngIf"],["class","folders",4,"ngIf"],[1,"folders"],[1,"actions"],["title","Refresh",1,"button-on-control",3,"click"],[1,"icon-reload"],["title","New Folder\u2026",1,"button-on-control",3,"click"],[1,"icon-plus"],["class","button-on-control","title","Move Subfolders\u2026",3,"click",4,"ngIf"],["name","Folders",3,"list"],[3,"folders",4,"ngIf"],["title","Move Subfolders\u2026",1,"button-on-control",3,"click"],[1,"icon-right-bold"],[3,"folders"]],template:function(t,e){1&t&&(x.YNc(0,lt,1,0,"app-loading",0),x.YNc(1,gt,9,3,"div",1)),2&t&&(x.Q6J("ngIf",!e.folder),x.xp6(1),x.Q6J("ngIf",e.folder&&e.folder.folders))},directives:[g.O5,et.N,nt.$,ct],styles:["[_nghost-%COMP%]{height:100%;width:100%;display:block;overflow:hidden}[_nghost-%COMP%]   .folders[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;width:100%}[_nghost-%COMP%]   .folders[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{padding:10px 15px 0;border-bottom-color:var(--background-border);border-bottom-width:1px;border-bottom-style:solid}[_nghost-%COMP%]   .folders[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{margin-right:5px;margin-bottom:10px}[_nghost-%COMP%]   .folders[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%] > label[_ngcontent-%COMP%]{text-transform:uppercase;letter-spacing:1px;font-size:11px;margin-left:5px;margin-right:5px}[_nghost-%COMP%]   .folders[_ngcontent-%COMP%]   app-admin-folder-list[_ngcontent-%COMP%]{overflow-y:auto}"]}),n}(),pt=s(81515),ft=s(91841),mt=s(89888),vt=s(22689);function Mt(t,e){if(1&t){var n=x.EpF();x.TgZ(0,"image-cropper",6),x.NdJ("imageCropped",function(t){return x.CHM(n),x.oxw().imageCropped(t)})("imageLoaded",function(){return x.CHM(n),x.oxw().imageLoaded()})("cropperReady",function(){return x.CHM(n),x.oxw().cropperReady()})("loadImageFailed",function(){return x.CHM(n),x.oxw().loadImageFailed()}),x.qZA()}if(2&t){var i=x.oxw();x.Q6J("imageBase64",i.imageBase64)("format","jpeg")("maintainAspectRatio",i.maintainAspectRatio)}}function xt(t,e){if(1&t&&(x.TgZ(0,"div",7),x._UZ(1,"img",8),x.qZA()),2&t){var n=x.oxw();x.xp6(1),x.Q6J("src",n.croppedImage,x.LSH)}}var Ct=function(){var t=function(){function t(e,n,i,o){c(this,t),this.app=e,this.jam=n,this.folderService=i,this.notify=o,this.imageBase64="",this.mimeType="image/jpeg",this.maintainAspectRatio=!0,this.imageEdited=new x.vpe,this.unsubscribe=new y.xQ}return d(t,[{key:"ngOnDestroy",value:function(){this.unsubscribe.next(),this.unsubscribe.complete()}},{key:"load",value:function(){var t=this;this.data&&this.jam.image.imageBinary({id:this.data.artwork.id}).then(function(e){t.imageBase64="data:".concat(e.contentType||"image/jpeg",";base64,").concat((0,vt.q)(e.buffer))}).catch(function(e){t.notify.error(e)})}},{key:"imageCropped",value:function(t){t.base64&&(this.croppedImage=t.base64,this.croppedImageFile=(0,M.Ll)(t.base64))}},{key:"imageLoaded",value:function(){}},{key:"cropperReady",value:function(){}},{key:"loadImageFailed",value:function(){}},{key:"ngOnChanges",value:function(t){this.load()}},{key:"upload",value:function(){var t=this;if(this.croppedImageFile&&this.data){var e=this.data.folderID,n=new File([this.croppedImageFile],this.data.artwork.name,{type:this.croppedImageFile.type});this.jam.artwork.update({id:this.data.artwork.id},n).pipe((0,b.R)(this.unsubscribe)).subscribe(function(n){n.type===ft.dt.Response&&(t.folderService.waitForQueueResult("Updating Folder Artwork",n.body,[e]),t.imageEdited.emit())},function(e){t.notify.error(e)},function(){t.notify.success("Upload done")})}}}]),t}();return t.\u0275fac=function(e){return new(e||t)(x.Y36(P.zi),x.Y36(w.K4),x.Y36(P.Cr),x.Y36(P.c))},t.\u0275cmp=x.Xpm({type:t,selectors:[["app-admin-artwork-edit"]],inputs:{data:"data"},outputs:{imageEdited:"imageEdited"},features:[x.TTD],decls:9,vars:4,consts:[[1,"image-crop"],["type","checkbox",3,"ngModel","checked","ngModelChange"],[3,"imageBase64","format","maintainAspectRatio","imageCropped","imageLoaded","cropperReady","loadImageFailed",4,"ngIf"],["class","image-preview",4,"ngIf"],[1,"buttons"],[1,"button-on-control",3,"click"],[3,"imageBase64","format","maintainAspectRatio","imageCropped","imageLoaded","cropperReady","loadImageFailed"],[1,"image-preview"],["alt","Cropped Image",3,"src"]],template:function(t,e){1&t&&(x.TgZ(0,"div",0),x.TgZ(1,"label"),x.TgZ(2,"input",1),x.NdJ("ngModelChange",function(t){return e.maintainAspectRatio=t}),x.qZA(),x._uU(3," Maintain Aspect Ratio "),x.qZA(),x.YNc(4,Mt,1,3,"image-cropper",2),x.qZA(),x.YNc(5,xt,2,1,"div",3),x.TgZ(6,"div",4),x.TgZ(7,"button",5),x.NdJ("click",function(){return e.upload()}),x._uU(8,"Use Cropped Artwork"),x.qZA(),x.qZA()),2&t&&(x.xp6(2),x.Q6J("ngModel",e.maintainAspectRatio)("checked",e.maintainAspectRatio),x.xp6(2),x.Q6J("ngIf",e.imageBase64),x.xp6(1),x.Q6J("ngIf",e.croppedImage))},directives:[h.Wl,h.JJ,h.On,g.O5,M.ap],styles:["[_nghost-%COMP%]{width:100%;display:block;text-align:center}[_nghost-%COMP%]   image-cropper[_ngcontent-%COMP%]{width:300px;display:block}[_nghost-%COMP%]   .image-crop[_ngcontent-%COMP%]{display:inline-block;text-align:center;margin-left:10px;margin-right:10px}[_nghost-%COMP%]   .image-preview[_ngcontent-%COMP%]{margin-left:10px;margin-right:10px;display:inline-block}[_nghost-%COMP%]   .image-preview[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:300px}"]}),t}();function _t(t,e){if(1&t){var n=x.EpF();x.TgZ(0,"app-admin-artwork-edit",1),x.NdJ("imageEdited",function(){return x.CHM(n),x.oxw().onImageEdited()}),x.qZA()}if(2&t){var i=x.oxw();x.Q6J("data",i.data)}}var Ot=function(){var t=function(){function t(){c(this,t),this.loading=!0}return d(t,[{key:"dialogInit",value:function(t,e){this.data=e.data,this.reference=t}},{key:"onImageEdited",value:function(){this.reference&&this.reference.close()}}]),t}();return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=x.Xpm({type:t,selectors:[["app-image-edit-overlay-content"]],decls:1,vars:1,consts:[[3,"data","imageEdited",4,"ngIf"],[3,"data","imageEdited"]],template:function(t,e){1&t&&x.YNc(0,_t,1,1,"app-admin-artwork-edit",0),2&t&&x.Q6J("ngIf",e.data)},directives:[g.O5,Ct],styles:[""]}),t}(),yt=["inlineEditControl"];function bt(t,e){if(1&t){var n=x.EpF();x.TgZ(0,"div",2),x.TgZ(1,"input",3,4),x.NdJ("blur",function(t){return x.CHM(n),x.oxw().onBlur(t)})("keydown.enter",function(){return x.CHM(n),x.oxw().apply()})("ngModelChange",function(t){return x.CHM(n),x.oxw().value=t}),x.qZA(),x.qZA()}if(2&t){var i=x.oxw();x.xp6(1),x.Q6J("required",i.required)("name",i.value)("ngModel",i.value)("type",i.type)("placeholder",i.placeholder)}}function kt(t,e){if(1&t){var n=x.EpF();x.TgZ(0,"div"),x.TgZ(1,"div",5),x.NdJ("click",function(){x.CHM(n);var t=x.oxw();return t.edit(t.value)})("focus",function(){x.CHM(n);var t=x.oxw();return t.edit(t.value)}),x._uU(2),x._UZ(3,"i",6),x.qZA(),x.qZA()}if(2&t){var i=x.oxw();x.xp6(2),x.hij("",i.value,"\xa0")}}var Pt=function(){var t=function(){function t(){c(this,t),this.placeholder="",this.type="text",this.required=!1,this.disabled=!1,this.endEditRequest=new x.vpe,this.editing=!1,this.editValue="",this.preValue="",this.onChange=Function.prototype,this.onTouched=Function.prototype}return d(t,[{key:"value",get:function(){return this.editValue},set:function(t){t!==this.editValue&&(this.editValue=t,this.onChange(t))}},{key:"writeValue",value:function(t){this.editValue=t}},{key:"registerOnChange",value:function(t){this.onChange=t}},{key:"registerOnTouched",value:function(t){this.onTouched=t}},{key:"onBlur",value:function(t){this.editing=!1,this.preValue!==this.editValue&&this.endEditRequest.emit()}},{key:"apply",value:function(){this.editing=!1,this.endEditRequest.emit()}},{key:"edit",value:function(t){var e=this;this.disabled||(this.preValue=t,this.editing=!0,setTimeout(function(){var t;(null===(t=e.inlineEditControl)||void 0===t?void 0:t.nativeElement)&&e.inlineEditControl.nativeElement.focus()}))}}]),t}();return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=x.Xpm({type:t,selectors:[["app-inline-edit"]],viewQuery:function(t,e){var n;(1&t&&x.Gf(yt,5),2&t)&&(x.iGM(n=x.CRH())&&(e.inlineEditControl=n.first))},inputs:{placeholder:"placeholder",type:"type",required:"required",disabled:"disabled"},outputs:{endEditRequest:"endEditRequest"},features:[x._Bn([{provide:h.JU,useExisting:t,multi:!0}])],decls:2,vars:2,consts:[["class","inline-edit-edit",4,"ngIf"],[4,"ngIf"],[1,"inline-edit-edit"],[3,"required","name","ngModel","type","placeholder","blur","keydown.enter","ngModelChange"],["inlineEditControl",""],["title","Click to edit","tabindex","0",1,"inline-edit",3,"click","focus"],[1,"icon-edit"]],template:function(t,e){1&t&&(x.YNc(0,bt,3,5,"div",0),x.YNc(1,kt,4,1,"div",1)),2&t&&(x.Q6J("ngIf",e.editing),x.xp6(1),x.Q6J("ngIf",!e.editing))},directives:[g.O5,h.Fj,h.Q7,h.JJ,h.On],styles:[".inline-edit{cursor:pointer}.inline-edit i{font-size:.7em}.inline-edit-edit{width:100%;display:block}.inline-edit-edit input{width:100%}\n"],encapsulation:2}),t}(),wt=s(74627);function Zt(t,e){if(1&t){var n=x.EpF();x.TgZ(0,"div",2),x.NdJ("keydown.enter",function(){var t=x.CHM(n).$implicit;return x.oxw().editArtwork(t.artwork)}),x.TgZ(1,"div",3),x.TgZ(2,"img",4),x.NdJ("clickenter",function(){var t=x.CHM(n).$implicit;return x.oxw().editArtwork(t.artwork)}),x.qZA(),x.TgZ(3,"div",5),x._uU(4),x.qZA(),x.TgZ(5,"div",6),x._uU(6),x.qZA(),x.TgZ(7,"div",7),x._uU(8),x.qZA(),x.TgZ(9,"div",8),x._uU(10),x.ALo(11,"filesize"),x.qZA(),x.qZA(),x.TgZ(12,"div",9),x.TgZ(13,"app-inline-edit",10),x.NdJ("ngModelChange",function(t){return x.CHM(n).$implicit.name=t})("endEditRequest",function(){var t=x.CHM(n).$implicit;return x.oxw().editArtworkName(t)}),x.qZA(),x.TgZ(14,"a",11),x.NdJ("clickenter",function(){var t=x.CHM(n).$implicit;return x.oxw().removeArtwork(t)}),x._UZ(15,"i",12),x.qZA(),x.qZA(),x.qZA()}if(2&t){var i=e.$implicit;x.xp6(2),x.Q6J("src",i.thumbnail,x.LSH),x.xp6(2),x.Oqu(i.artwork.types),x.xp6(2),x.Oqu(i.artwork.format),x.xp6(2),x.AsE("",i.artwork.width,"x",i.artwork.height,""),x.xp6(2),x.Oqu(x.lcZ(11,7,i.artwork.size)),x.xp6(3),x.Q6J("ngModel",i.name)}}function At(t){var e=t.split(".");return e.pop(),e.join(".")}function Tt(t){var e=t.split(".");return e[e.length-1]}var It=function(){var t=function(){function t(e,n,i,o,r,a){c(this,t),this.app=e,this.jam=n,this.notify=i,this.folderService=o,this.dialogs=r,this.dialogOverlay=a}return d(t,[{key:"trackByFn",value:function(t,e){return e.artwork.id}},{key:"ngOnChanges",value:function(t){this.displayArtworks()}},{key:"editArtworkName",value:function(t){var e=this;this.jam.artwork.rename({id:t.artwork.id,newName:t.name}).then(function(t){e.folderService.waitForQueueResult("Renaming Artwork",t,e.folderID?[e.folderID]:[],[])}).catch(function(t){e.notify.error(t)})}},{key:"editArtwork",value:function(t){this.dialogOverlay.open({childComponent:Ot,title:"Edit Image",data:{artwork:t,folderID:this.folderID},panelClass:""})}},{key:"showArtwork",value:function(t){var e=t.types.join(", ");this.dialogOverlay.open({title:e,childComponent:mt.$w,data:{name:e,url:this.jam.image.imageUrl({id:t.id})}})}},{key:"removeArtwork",value:function(t){var e=this;this.dialogs.confirm("Remove Artworks?",'Do you want to delete "'.concat(t.artwork.name,'"?'),function(){e.jam.artwork.remove({id:t.artwork.id}).then(function(n){e.nodes&&(e.nodes=e.nodes.filter(function(e){return e!==t})),e.folderService.waitForQueueResult("Removing Artwork",n,e.folderID?[e.folderID]:[])}).catch(function(t){e.notify.error(t)})})}},{key:"displayArtworks",value:function(){var t=this;this.nodes=[],this.artworks&&(this.nodes=this.artworks.map(function(e){return{name:At(e.name),type:Tt(e.name),artwork:e,thumbnail:t.jam.image.imageUrl({id:e.id,size:128,format:w.GU.webp})}}))}}]),t}();return t.\u0275fac=function(e){return new(e||t)(x.Y36(P.zi),x.Y36(w.K4),x.Y36(P.c),x.Y36(P.Cr),x.Y36(K.Hr),x.Y36(tt.SL))},t.\u0275cmp=x.Xpm({type:t,selectors:[["app-admin-artwork-list"]],inputs:{artworks:"artworks",folderID:"folderID"},features:[x.TTD],decls:2,vars:2,consts:[["appFocusKeyList",""],["class","artwork","appFocusKeyListItem","",3,"keydown.enter",4,"ngFor","ngForOf","ngForTrackBy"],["appFocusKeyListItem","",1,"artwork",3,"keydown.enter"],[1,"artwork-img"],["alt","Artwork",3,"src","clickenter"],[1,"mode"],[1,"format"],[1,"dims"],[1,"size"],[1,"artwork-types"],["type","text",3,"ngModel","ngModelChange","endEditRequest"],["title","Delete Image",1,"delete-button",3,"clickenter"],["aria-hidden","true",1,"icon-trash"]],template:function(t,e){1&t&&(x.TgZ(0,"div",0),x.YNc(1,Zt,16,9,"div",1),x.qZA()),2&t&&(x.xp6(1),x.Q6J("ngForOf",e.nodes)("ngForTrackBy",e.trackByFn))},directives:[Z.R,g.sg,A.j,T.X,Pt,h.JJ,h.On],pipes:[wt.c],styles:["[_nghost-%COMP%]   .artwork[_ngcontent-%COMP%]{display:inline-block;padding-top:15px;padding-right:15px;font-size:.8em;text-align:center;width:200px}[_nghost-%COMP%]   .artwork[_ngcontent-%COMP%]   .artwork-img[_ngcontent-%COMP%]{position:relative;overflow:hidden}[_nghost-%COMP%]   .artwork[_ngcontent-%COMP%]   .artwork-img[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:auto}[_nghost-%COMP%]   .artwork[_ngcontent-%COMP%]   .artwork-img[_ngcontent-%COMP%]   .dims[_ngcontent-%COMP%], [_nghost-%COMP%]   .artwork[_ngcontent-%COMP%]   .artwork-img[_ngcontent-%COMP%]   .size[_ngcontent-%COMP%], [_nghost-%COMP%]   .artwork[_ngcontent-%COMP%]   .artwork-img[_ngcontent-%COMP%]   .format[_ngcontent-%COMP%], [_nghost-%COMP%]   .artwork[_ngcontent-%COMP%]   .artwork-img[_ngcontent-%COMP%]   .mode[_ngcontent-%COMP%]{position:absolute;padding:5px;background-color:var(--background-transparent);color:var(--on-background-active)}[_nghost-%COMP%]   .artwork[_ngcontent-%COMP%]   .artwork-img[_ngcontent-%COMP%]   .mode[_ngcontent-%COMP%]{top:0;left:0}[_nghost-%COMP%]   .artwork[_ngcontent-%COMP%]   .artwork-img[_ngcontent-%COMP%]   .format[_ngcontent-%COMP%]{bottom:0;left:0}[_nghost-%COMP%]   .artwork[_ngcontent-%COMP%]   .artwork-img[_ngcontent-%COMP%]   .dims[_ngcontent-%COMP%]{top:0;right:0}[_nghost-%COMP%]   .artwork[_ngcontent-%COMP%]   .artwork-img[_ngcontent-%COMP%]   .size[_ngcontent-%COMP%]{bottom:0;right:0}[_nghost-%COMP%]   .artwork-types[_ngcontent-%COMP%]{display:flex;flex-direction:row;width:100%;overflow:hidden}[_nghost-%COMP%]   .artwork-types[_ngcontent-%COMP%]   app-inline-edit[_ngcontent-%COMP%]{flex:1}[_nghost-%COMP%]   .artwork-types[_ngcontent-%COMP%]   .delete-button[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none}"]}),t}();function qt(t,e){1&t&&x._UZ(0,"app-loading")}function St(t,e){1&t&&x._UZ(0,"i",18)}function Ut(t,e){if(1&t){var n=x.EpF();x.TgZ(0,"input",19),x.NdJ("ngModelChange",function(t){return x.CHM(n),x.oxw().$implicit.checked=t}),x.qZA()}if(2&t){var i=x.oxw().$implicit;x.Q6J("ngModel",i.checked)("checked",i.checked)}}function Rt(t,e){if(1&t){var n=x.EpF();x.TgZ(0,"div",11),x.NdJ("keydown.enter",function(){var t=x.CHM(n).$implicit;return t.checked=!t.checked}),x.TgZ(1,"div",12),x.NdJ("clickenter",function(){var t=x.CHM(n).$implicit;return t.checked=!t.checked}),x._UZ(2,"img",13),x.qZA(),x.TgZ(3,"div",14),x.TgZ(4,"div",15),x.TgZ(5,"label"),x.YNc(6,St,1,0,"i",16),x.YNc(7,Ut,1,2,"input",17),x._uU(8),x.qZA(),x.qZA(),x.qZA(),x.qZA()}if(2&t){var i=e.$implicit;x.xp6(2),x.s9C("alt",i.name),x.Q6J("src",i.thumbnail,x.LSH),x.xp6(4),x.Q6J("ngIf",i.storing),x.xp6(1),x.Q6J("ngIf",!i.storing),x.xp6(1),x.hij(" ",i.name," ")}}function Jt(t,e){if(1&t&&(x.TgZ(0,"div"),x._UZ(1,"app-background-text-list",8),x.TgZ(2,"div",9),x.YNc(3,Rt,9,5,"div",10),x.qZA(),x.qZA()),2&t){var n=x.oxw();x.xp6(1),x.Q6J("list",n.nodes),x.xp6(2),x.Q6J("ngForOf",n.nodes)("ngForTrackBy",n.trackByFn)}}function Qt(t,e){if(1&t&&x._UZ(0,"app-admin-artwork-list",22),2&t){var n=x.oxw(2);x.Q6J("folderID",n.data.folder.id)("artworks",n.artworks)}}function Nt(t,e){if(1&t&&(x.TgZ(0,"div",20),x.TgZ(1,"div",2),x._uU(2,"Current Images"),x.qZA(),x.YNc(3,Qt,1,2,"app-admin-artwork-list",21),x.qZA()),2&t){var n=x.oxw();x.xp6(3),x.Q6J("ngIf",!n.isArtRefreshing)}}function Ft(t,e){1&t&&(x.TgZ(0,"button",25),x._UZ(1,"i",18),x.qZA())}function Ht(t,e){if(1&t){var n=x.EpF();x.TgZ(0,"button",26),x.NdJ("click",function(){return x.CHM(n),x.oxw(2).use()}),x._uU(1,"Use Checked Artwork"),x.qZA()}}function zt(t,e){if(1&t&&(x.TgZ(0,"div"),x.YNc(1,Ft,2,0,"button",23),x.YNc(2,Ht,2,0,"button",24),x.qZA()),2&t){var n=x.oxw();x.xp6(1),x.Q6J("ngIf",n.isWorking),x.xp6(1),x.Q6J("ngIf",!n.isWorking)}}var Yt=function(){var t=function(){function t(e,n,i,o){c(this,t),this.jam=e,this.notify=n,this.folderService=i,this.http=o,this.isWorking=!1,this.isArtRefreshing=!1,this.searchSource={name:"",url:""},this.unsubscribe=new y.xQ}return d(t,[{key:"trackByFn",value:function(t,e){return e.image}},{key:"ngOnDestroy",value:function(){this.unsubscribe.next(),this.unsubscribe.complete()}},{key:"ngOnChanges",value:function(t){this.search(),this.data&&this.data.folder&&(this.data.folder.artworks?this.artworks=this.data.folder.artworks:this.refreshArtworks())}},{key:"refreshArtworks",value:function(){var t=this;!this.data||(this.isArtRefreshing=!0,this.jam.artwork.search({folderIDs:[this.data.folder.id]}).then(function(e){t.isArtRefreshing=!1,t.artworks=e.items}).catch(function(e){t.isArtRefreshing=!1,console.error(e)}))}},{key:"loadWikiDataID",value:function(t){var e,n;return(0,_.mG)(this,void 0,void 0,regeneratorRuntime.mark(function i(){var o,r;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this.jam.metadata.musicbrainzLookup({type:w.ej.artist,mbID:t});case 2:if(o=i.sent,!(null===(n=null===(e=null==o?void 0:o.data)||void 0===e?void 0:e.artist)||void 0===n?void 0:n.relations)){i.next=7;break}if(!(null==(r=o.data.artist.relations.find(function(t){return"wikidata"===t.type}))?void 0:r.url)){i.next=7;break}return i.abrupt("return",r.url.resource.split("/").pop());case 7:case"end":return i.stop()}},i,this)}))}},{key:"loadWikiCommonImage",value:function(t){var e,n;return(0,_.mG)(this,void 0,void 0,regeneratorRuntime.mark(function i(){var o,r,a,s,c,l,d,u,g,h,p,f;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this.loadWikiDataID(t);case 2:if(o=i.sent){i.next=5;break}return i.abrupt("return");case 5:return i.next=7,this.jam.metadata.wikidataLookup({wikiDataID:o});case 7:if(r=i.sent,a=null===(n=null===(e=null==r?void 0:r.data)||void 0===e?void 0:e.entity)||void 0===n?void 0:n.claims){i.next=11;break}return i.abrupt("return");case 11:s=Object.keys(a),c=0,l=s;case 13:if(!(c<l.length)){i.next=30;break}if(d=l[c],u=(u=a[d]).filter(function(t){return"string"==typeof t.mainsnak.datavalue.value&&(0,pt.U_)(t.mainsnak.datavalue.value.toLowerCase(),["jpg","jpeg","png"])}),!(g=u[0])){i.next=27;break}return h="https://en.wikipedia.org/w/api.php?format=json&action=query&origin=*&titles=File:".concat(g.mainsnak.datavalue.value,"&prop=imageinfo&iiprop=extmetadata|url&iiextmetadatafilter=LicenseShortName"),i.next=22,this.http.get(h).toPromise();case 22:if(!(p=i.sent)||!p.query.pages){i.next=27;break}if(!(f=p.query.pages[Object.keys(p.query.pages)[0]])||!f.imageinfo[0]){i.next=27;break}return i.abrupt("return",{name:w.iJ.artist,thumbnail:f.imageinfo[0].url,image:f.imageinfo[0].url,licence:f.imageinfo[0].extmetadata.LicenseShortName.value,checked:!0,storing:!1,types:[w.iJ.artist]});case 27:c++,i.next=13;break;case 30:case"end":return i.stop()}},i,this)}))}},{key:"loadWikiCommon",value:function(t){var e=this;this.loadWikiCommonImage(t).then(function(t){e.nodes=[],t&&(t.checked=!0,e.nodes.push(t))}).catch(function(t){e.nodes=[],e.notify.error(t)})}},{key:"use",value:function(){var t,e=this,n=(this.nodes||[]).find(function(t){return t.checked&&!t.storing}),i=null===(t=this.data)||void 0===t?void 0:t.folder;n&&i?(this.isWorking=!0,n.storing=!0,this.jam.artwork.createByUrl({folderID:i.id,url:n.image,types:n.types}).then(function(t){e.folderService.waitForQueueResult("Creating Artwork",t,[i.id]).pipe((0,b.R)(e.unsubscribe)).subscribe(function(){n.storing=!1,n.checked=!1}),e.use()}).catch(function(t){n.storing=!1,e.notify.error(t)})):this.isWorking=!1}},{key:"ngOnInit",value:function(){var t=this;this.folderService.foldersChange.pipe((0,b.R)(this.unsubscribe)).subscribe(function(e){var n;e.id===(null===(n=t.data)||void 0===n?void 0:n.folder.id)&&t.refreshArtworks()})}},{key:"loadReleaseGroupAndRelease",value:function(t,e){var n=this;this.jam.metadata.coverartarchiveLookup({type:w.xB.releaseGroup,mbID:e}).then(function(e){var i=n.coverArtResponseToNodes(e.data);n.jam.metadata.coverartarchiveLookup({type:w.xB.release,mbID:t}).then(function(t){i=i.concat(n.coverArtResponseToNodes(t.data)),n.display(i)}).catch(function(t){n.notify.error(t)})}).catch(function(t){n.notify.error(t)})}},{key:"loadReleaseGroup",value:function(t){var e=this;this.jam.metadata.coverartarchiveLookup({type:w.xB.releaseGroup,mbID:t}).then(function(t){var n=e.coverArtResponseToNodes(t.data);e.display(n)}).catch(function(t){e.notify.error(t)})}},{key:"loadRelease",value:function(t){var e=this;t&&this.jam.metadata.coverartarchiveLookup({type:w.xB.release,mbID:t}).then(function(t){var n=e.coverArtResponseToNodes(t.data);e.display(n),0===n.length&&e.data&&e.data.folder&&e.data.folder.tag&&e.data.folder.tag.mbReleaseGroupID&&(e.nodes=void 0,e.loadReleaseGroup(e.data.folder.tag.mbReleaseGroupID))}).catch(function(t){e.notify.error(t)})}},{key:"coverArtResponseToNodes",value:function(t){var e=this;return t.images?t.images.map(function(t){return 0===t.types.length&&t.types.push("Other"),{name:(t.types||[]).join("/").toLowerCase(),thumbnail:e.jam.metadata.coverartarchiveImageUrl({url:t.thumbnails.small}),licence:"",image:t.image,types:(t.types||[]).map(function(t){return t.toLowerCase()}),checked:!1,storing:!1,stored:!1}}):[]}},{key:"search",value:function(){this.data&&this.data.folder&&this.data.folder.tag&&(this.data.folder.type===w.Sr.artist?this.data.folder.tag.mbArtistID&&(this.searchSource={name:"Wiki Commons",url:"https://commons.wikimedia.org"},this.loadWikiCommon(this.data.folder.tag.mbArtistID)):this.data&&this.data.folder&&this.data.folder.tag&&(this.searchSource={name:"Coverart Archive",url:"https://coverartarchive.org"},this.data.folder.tag.mbReleaseID&&this.data.folder.tag.mbReleaseGroupID?this.loadReleaseGroupAndRelease(this.data.folder.tag.mbReleaseID,this.data.folder.tag.mbReleaseGroupID):this.data.folder.tag.mbReleaseID?this.loadRelease(this.data.folder.tag.mbReleaseID):this.data.folder.tag.mbReleaseGroupID&&this.loadReleaseGroup(this.data.folder.tag.mbReleaseGroupID)))}},{key:"display",value:function(t){this.nodes=t;var e=t.find(function(t){return 1===t.types.length&&t.types[0]===w.iJ.front});e||(e=t.find(function(t){return t.types.includes(w.iJ.front)})),e&&this.nodes.forEach(function(t){return t.checked=t===e})}}]),t}();return t.\u0275fac=function(e){return new(e||t)(x.Y36(w.K4),x.Y36(P.c),x.Y36(P.Cr),x.Y36(ft.eN))},t.\u0275cmp=x.Xpm({type:t,selectors:[["app-admin-folder-artwork-search"]],inputs:{data:"data"},features:[x.TTD],decls:11,vars:6,consts:[[1,"image-selector"],[1,"art-source"],[1,"section"],["rel","noopener","target","_blank",3,"href"],[4,"ngIf"],[1,"artwork"],["class","current",4,"ngIf"],[1,"buttons"],["name","Images",3,"list"],["appFocusKeyList","",1,"images"],["appFocusKeyListItem","",3,"keydown.enter",4,"ngFor","ngForOf","ngForTrackBy"],["appFocusKeyListItem","",3,"keydown.enter"],[1,"image",3,"clickenter"],[3,"alt","src"],[1,"footer"],[1,"footer-content"],["class","icon-spin icon-spinner",4,"ngIf"],["type","checkbox",3,"ngModel","checked","ngModelChange",4,"ngIf"],[1,"icon-spin","icon-spinner"],["type","checkbox",3,"ngModel","checked","ngModelChange"],[1,"current"],[3,"folderID","artworks",4,"ngIf"],[3,"folderID","artworks"],["class","button-on-control",4,"ngIf"],["class","button-on-control",3,"click",4,"ngIf"],[1,"button-on-control"],[1,"button-on-control",3,"click"]],template:function(t,e){1&t&&(x.TgZ(0,"div",0),x.TgZ(1,"div",1),x.TgZ(2,"div",2),x.TgZ(3,"a",3),x._uU(4),x.qZA(),x.qZA(),x.YNc(5,qt,1,0,"app-loading",4),x.YNc(6,Jt,4,3,"div",4),x.qZA(),x.TgZ(7,"div",5),x.YNc(8,Nt,4,1,"div",6),x.qZA(),x.qZA(),x.TgZ(9,"div",7),x.YNc(10,zt,3,2,"div",4),x.qZA()),2&t&&(x.xp6(3),x.Q6J("href",e.searchSource.url,x.LSH),x.xp6(1),x.Oqu(e.searchSource.name),x.xp6(1),x.Q6J("ngIf",!e.nodes),x.xp6(1),x.Q6J("ngIf",e.nodes),x.xp6(2),x.Q6J("ngIf",e.data&&e.artworks),x.xp6(2),x.Q6J("ngIf",e.nodes&&e.nodes.length>0))},directives:[g.O5,et.N,nt.$,Z.R,g.sg,A.j,T.X,h.Wl,h.JJ,h.On,It],styles:["[_nghost-%COMP%]   .image-selector[_ngcontent-%COMP%]{display:flex;flex-flow:column wrap;height:calc(100% - 40px)}[_nghost-%COMP%]   .image-buttons[_ngcontent-%COMP%]{height:40px}[_nghost-%COMP%]   .artwork[_ngcontent-%COMP%]{overflow-y:auto;width:50%;height:100%;padding-left:15px}[_nghost-%COMP%]   .art-source[_ngcontent-%COMP%]{padding-right:15px;overflow-y:auto;width:50%;height:100%;border-right:1px solid var(--background-border)}[_nghost-%COMP%]   .art-source[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block}[_nghost-%COMP%]   .art-source[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{display:inline-block;padding-top:15px;padding-right:15px;font-size:.8em}[_nghost-%COMP%]   .art-source[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:185px;min-width:185px;min-height:185px;height:auto}[_nghost-%COMP%]   .art-source[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]{font-size:.8em}[_nghost-%COMP%]   .section[_ngcontent-%COMP%]{border-bottom:1px solid var(--background-border);padding-bottom:5px}[_nghost-%COMP%]   .section[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--on-background-active)}[_nghost-%COMP%]   .section[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:var(--on-background)}"]}),t}(),Dt=function(){var t=function(){function t(){c(this,t)}return d(t,[{key:"dialogInit",value:function(t,e){this.data=e.data}}]),t}();return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=x.Xpm({type:t,selectors:[["app-dialog-folder-artwork-search"]],decls:1,vars:1,consts:[[3,"data"]],template:function(t,e){1&t&&x._UZ(0,"app-admin-folder-artwork-search",0),2&t&&x.Q6J("data",e.data)},directives:[Yt],styles:[""]}),t}();function Et(t,e){1&t&&(x.TgZ(0,"div",1),x.TgZ(1,"div",2),x._UZ(2,"i",3),x.qZA(),x.qZA())}function jt(t,e){1&t&&(x.TgZ(0,"div",2),x._uU(1,"No Hints"),x.qZA())}function Bt(t,e){if(1&t&&(x.TgZ(0,"div",10),x._uU(1),x.qZA()),2&t){var n=e.$implicit;x.xp6(1),x.Oqu(n)}}function Lt(t,e){if(1&t&&(x.TgZ(0,"div",2),x._UZ(1,"i",8),x._uU(2),x.YNc(3,Bt,2,1,"div",9),x.qZA()),2&t){var n=e.$implicit;x.xp6(2),x.hij(" ",n.hint.name," "),x.xp6(1),x.Q6J("ngForOf",n.details)}}function Wt(t,e){1&t&&x._UZ(0,"i",3)}function Gt(t,e){if(1&t&&(x.ynx(0),x._uU(1),x.BQk()),2&t){var n=x.oxw().$implicit;x.xp6(1),x.Oqu(n.name)}}function $t(t,e){if(1&t){var n=x.EpF();x.TgZ(0,"button",11),x.NdJ("click",function(){return x.CHM(n).$implicit.click()}),x.YNc(1,Wt,1,0,"i",12),x.YNc(2,Gt,2,1,"ng-container",13),x.qZA()}if(2&t){var i=e.$implicit;x.xp6(1),x.Q6J("ngIf",i.running),x.xp6(1),x.Q6J("ngIf",!i.running)}}function Vt(t,e){if(1&t&&(x.TgZ(0,"div",1),x.YNc(1,jt,2,0,"div",4),x.YNc(2,Lt,4,2,"div",5),x.TgZ(3,"div",6),x.YNc(4,$t,3,2,"button",7),x.qZA(),x.qZA()),2&t){var n=x.oxw();x.xp6(1),x.Q6J("ngIf",0===n.hints.length),x.xp6(1),x.Q6J("ngForOf",n.hints)("ngForTrackBy",n.trackByFn),x.xp6(2),x.Q6J("ngForOf",n.solutions)}}var Xt=function(){var t=function(){function t(e,n,i,o,r,a){c(this,t),this.app=e,this.router=n,this.jam=i,this.notify=o,this.dialogOverlay=r,this.folderService=a,this.solutions=[],this.unsubscribe=new y.xQ}return d(t,[{key:"ngOnDestroy",value:function(){this.unsubscribe.next(),this.unsubscribe.complete()}},{key:"trackByFn",value:function(t,e){return e.hint.id}},{key:"searchImages",value:function(t){this.dialogOverlay.open({title:"Search Artwork Images",childComponent:Dt,data:{folder:t},panelClass:"overlay-panel-large-buttons"})}},{key:"ngOnChanges",value:function(){this.display(this.folderHealth)}},{key:"describeImageQualityHint",value:function(t,e){if(this.addAlbumImageSearchSolution(e),!t.details||0===t.details.length)return[];var n=[t.details[0].reason];return n.push("Expected: ".concat(t.details[0].expected," Actual: ").concat(t.details[0].actual)),n}},{key:"addArtistImageSearchSolution",value:function(t){var e=this;t.tag&&t.tag.mbArtistID&&this.solutions.push({name:"Search",click:function(){return(0,_.mG)(e,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.searchImages(t);case 1:case"end":return e.stop()}},e,this)}))}})}},{key:"addAlbumImageSearchSolution",value:function(t){var e=this;t.tag&&(t.tag.mbReleaseID||t.tag.mbReleaseGroupID)&&this.solutions.push({name:"Search",click:function(){return(0,_.mG)(e,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.searchImages(t);case 1:case"end":return e.stop()}},e,this)}))}})}},{key:"addRenameSolution",value:function(t,e){var n=this;if(!this.solutions.find(function(t){return"Rename"===t.name})){var i={name:"Rename",click:function(){return(0,_.mG)(n,void 0,void 0,regeneratorRuntime.mark(function n(){var o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!i.running){n.next=2;break}return n.abrupt("return");case 2:return i.running=!0,n.next=5,this.jam.folder.rename({id:t.id,name:e});case 5:o=n.sent,this.folderService.waitForQueueResult("Renaming Folder",o,[t.id]).pipe((0,b.R)(this.unsubscribe)).subscribe(function(){i.running=!1});case 7:case"end":return n.stop()}},n,this)}))}};this.solutions.push(i)}}},{key:"addEditTagSolution",value:function(t){var e=this;this.solutions.find(function(t){return"Edit Tags"===t.name})||this.solutions.push({name:"Edit Tags",click:function(){return(0,_.mG)(e,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.router.navigate(["/admin/folder/".concat(t.id,"/tags")]).catch(function(t){console.error(t)});case 1:case"end":return e.stop()}},e,this)}))}})}},{key:"describeMBIDMissingHint",value:function(t,e){return this.addEditTagSolution(e),[]}},{key:"describeAlbumTagMissingHint",value:function(t,e){return this.addEditTagSolution(e),t.details?["Expected: ".concat(t.details.map(function(t){return t.expected}).join(","))]:[]}},{key:"describeNameNonConformHint",value:function(t,e){var n=t.details&&t.details.length>0?t.details[0].expected:"";return n?(this.addRenameSolution(e,n),["Current: ".concat(e.name),"Suggested Name: ".concat(n)]):[]}},{key:"describeArtistImageMissingHint",value:function(t,e){return this.addArtistImageSearchSolution(e),[]}},{key:"describeAlbumImageMissingHint",value:function(t,e){return this.addAlbumImageSearchSolution(e),[]}},{key:"describeHint",value:function(e,n){switch(e.id){case w.Mx.albumMBIDExists:return this.describeMBIDMissingHint(e,n);case w.Mx.albumTagsExists:return this.describeAlbumTagMissingHint(e,n);case w.Mx.albumNameConform:case w.Mx.artistNameConform:return this.describeNameNonConformHint(e,n);case w.Mx.albumImageExists:return this.describeAlbumImageMissingHint(e,n);case w.Mx.albumTracksComplete:return t.describeAlbumTracksMissingHint(e,n);case w.Mx.artistImageExists:return this.describeArtistImageMissingHint(e,n);case w.Mx.artistImageValid:case w.Mx.albumImageValid:return t.describeImageInvalidHint(e,n);case w.Mx.albumImageQuality:return this.describeImageQualityHint(e,n)}return[]}},{key:"display",value:function(t){var e=this;this.hints=[],this.solutions=[],(null==t?void 0:t.health)&&(this.hints=t.health.map(function(n){return{hint:n,details:e.describeHint(n,t.folder)}}))}}],[{key:"describeImageInvalidHint",value:function(t,e){if(!t.details||0===t.details.length)return[];var n=[t.details[0].reason];return t.details[0].expected&&n.push("Expected: ".concat(t.details[0].expected," Actual: ").concat(t.details[0].actual)),n}},{key:"describeAlbumTracksMissingHint",value:function(t,e){if(!t.details||0===t.details.length)return[];var n=[];return t.details[0].expected&&n.push("Expected: ".concat(t.details[0].expected," Actual: ").concat(t.details[0].actual)),n}}]),t}();return t.\u0275fac=function(e){return new(e||t)(x.Y36(P.zi),x.Y36(O.F0),x.Y36(w.K4),x.Y36(P.c),x.Y36(tt.SL),x.Y36(P.Cr))},t.\u0275cmp=x.Xpm({type:t,selectors:[["app-folder-health"]],inputs:{folderHealth:"folderHealth"},features:[x.TTD],decls:2,vars:2,consts:[["class","hints",4,"ngIf"],[1,"hints"],[1,"hint"],[1,"icon-spin","icon-spinner"],["class","hint",4,"ngIf"],["class","hint",4,"ngFor","ngForOf","ngForTrackBy"],[1,"solutions"],["class","button-on-background",3,"click",4,"ngFor","ngForOf"],[1,"icon-warning"],["class","details",4,"ngFor","ngForOf"],[1,"details"],[1,"button-on-background",3,"click"],["class","icon-spin icon-spinner",4,"ngIf"],[4,"ngIf"]],template:function(t,e){1&t&&(x.YNc(0,Et,3,0,"div",0),x.YNc(1,Vt,5,4,"div",0)),2&t&&(x.Q6J("ngIf",!e.hints),x.xp6(1),x.Q6J("ngIf",e.hints))},directives:[g.O5,g.sg],styles:["[_nghost-%COMP%]{height:100%;width:100%;overflow-y:auto;overflow-x:auto;display:block}[_nghost-%COMP%]   .icon-warning[_ngcontent-%COMP%]{color:var(--accent)}[_nghost-%COMP%]   .label[_ngcontent-%COMP%]{padding-left:28px;font-size:.8em;text-transform:uppercase;min-width:30%;display:inline-block}[_nghost-%COMP%]   .hints[_ngcontent-%COMP%]{padding-top:10px}[_nghost-%COMP%]   .hint[_ngcontent-%COMP%]{padding-bottom:10px}"]}),t}();function Kt(t,e){if(1&t&&(x.TgZ(0,"option",11),x._uU(1),x.qZA()),2&t){var n=e.$implicit;x.Q6J("value",n),x.xp6(1),x.Oqu(n)}}function te(t,e){if(1&t){var n=x.EpF();x.TgZ(0,"select",9),x.NdJ("ngModelChange",function(t){return x.CHM(n),x.oxw().filter=t})("ngModelChange",function(){return x.CHM(n),x.oxw().onFilterChange()}),x.YNc(1,Kt,2,2,"option",10),x.qZA()}if(2&t){var i=x.oxw();x.Q6J("ngModel",i.filter),x.xp6(1),x.Q6J("ngForOf",i.modes)}}function ee(t,e){1&t&&x._UZ(0,"app-loading")}function ne(t,e){if(1&t&&(x.ynx(0),x.TgZ(1,"div",20),x._uU(2,"Album"),x.qZA(),x.TgZ(3,"div",21),x._uU(4),x.qZA(),x.TgZ(5,"div",22),x._uU(6),x.qZA(),x.TgZ(7,"div",23),x._uU(8),x.qZA(),x.BQk()),2&t){var n=x.oxw().$implicit;x.xp6(4),x.Oqu(null==n.folder.tag?null:n.folder.tag.album),x.xp6(2),x.Oqu(null==n.folder.tag?null:n.folder.tag.artist),x.xp6(2),x.Oqu(null==n.folder.tag?null:n.folder.tag.year)}}function ie(t,e){if(1&t&&(x.ynx(0),x.TgZ(1,"div",20),x._uU(2,"Album"),x.qZA(),x.TgZ(3,"div",21),x._uU(4),x.qZA(),x.TgZ(5,"div",22),x._uU(6),x.qZA(),x.TgZ(7,"div",23),x._uU(8),x.qZA(),x.BQk()),2&t){var n=x.oxw().$implicit;x.xp6(4),x.Oqu(null==n.folder.tag?null:n.folder.tag.album),x.xp6(2),x.Oqu(null==n.folder.tag?null:n.folder.tag.artist),x.xp6(2),x.Oqu(null==n.folder.tag?null:n.folder.tag.year)}}function oe(t,e){if(1&t&&(x.ynx(0),x.TgZ(1,"div",20),x._uU(2,"Artist"),x.qZA(),x.TgZ(3,"div",21),x._uU(4),x.qZA(),x.BQk()),2&t){var n=x.oxw().$implicit;x.xp6(4),x.Oqu(null==n.folder.tag?null:n.folder.tag.artist)}}function re(t,e){if(1&t&&(x.ynx(0),x.TgZ(1,"div",20),x._uU(2,"Collection"),x.qZA(),x.TgZ(3,"div",21),x._uU(4),x.qZA(),x.BQk()),2&t){var n=x.oxw().$implicit;x.xp6(4),x.Oqu(n.folder.name)}}function ae(t,e){if(1&t&&(x.ynx(0),x.TgZ(1,"div",21),x._uU(2),x.qZA(),x.BQk()),2&t){var n=x.oxw().$implicit;x.xp6(2),x.Oqu(n.folder.name)}}var se=function(t){return["/admin/folder",t,"overview"]};function ce(t,e){if(1&t&&(x.TgZ(0,"div",12),x.TgZ(1,"div",13),x.TgZ(2,"a",14),x.ynx(3,15),x.YNc(4,ne,9,3,"ng-container",16),x.YNc(5,ie,9,3,"ng-container",16),x.YNc(6,oe,5,1,"ng-container",16),x.YNc(7,re,5,1,"ng-container",16),x.YNc(8,ae,3,1,"ng-container",17),x.BQk(),x.qZA(),x.qZA(),x.TgZ(9,"div",18),x._UZ(10,"app-folder-health",19),x.qZA(),x.qZA()),2&t){var n=e.$implicit;x.xp6(2),x.Q6J("routerLink",x.VKq(7,se,n.folder.id)),x.xp6(1),x.Q6J("ngSwitch",n.folder.type),x.xp6(1),x.Q6J("ngSwitchCase","multialbum"),x.xp6(1),x.Q6J("ngSwitchCase","album"),x.xp6(1),x.Q6J("ngSwitchCase","artist"),x.xp6(1),x.Q6J("ngSwitchCase","collection"),x.xp6(3),x.Q6J("folderHealth",n)}}var le=function(){var n=function(n){e(s,n);var o=i(s);function s(t,e,n,i,r){var a;return c(this,s),(a=o.call(this,t)).app=e,a.jam=n,a.notify=i,a.folderService=r,a.modes=[],a}return d(s,[{key:"onFilterChange",value:function(){this.reDisplay()}},{key:"ngOnInit",value:function(){var e=this;t(r(s.prototype),"ngOnInit",this).call(this),this.folderService.foldersChange.pipe((0,b.R)(this.unsubscribe)).subscribe(function(t){if(t.id===e.id)e.refresh();else if(e.all){var n=e.all.find(function(e){return e.folder.id===t.id});n&&e.jam.folder.health({ids:[t.id],folderIncTag:!0}).then(function(t){if(e.all){var i=t.find(function(t){return t.folder.id===n.folder.id});i?e.all[e.all.indexOf(n)]=i:e.all=e.all.filter(function(t){return t.folder.id!==n.folder.id})}e.reDisplay()}).catch(function(t){e.notify.error(t)})}})}},{key:"ngOnDestroy",value:function(){t(r(s.prototype),"ngOnDestroy",this).call(this)}},{key:"refresh",value:function(){var t=this;this.hints=void 0,this.jam.folder.health({childOfID:this.id,folderIncTag:!0}).then(function(e){t.display(e)}).catch(function(e){t.notify.error(e)})}},{key:"reDisplay",value:function(){var t=this;this.hints=this.filter&&this.all?this.all.filter(function(e){return e.health&&e.health.find(function(e){return e.name===t.filter})}):this.all}},{key:"display",value:function(t){this.all=t,this.modes=[];var e,n=a(t);try{for(n.s();!(e=n.n()).done;){var i=e.value;if(i.health){var o,r=a(i.health);try{for(r.s();!(o=r.n()).done;){var s=o.value;this.modes.includes(s.name)||this.modes.push(s.name)}}catch(c){r.e(c)}finally{r.f()}}}}catch(c){n.e(c)}finally{n.f()}this.reDisplay()}}]),s}(W);return n.\u0275fac=function(t){return new(t||n)(x.Y36(O.gz),x.Y36(P.zi),x.Y36(w.K4),x.Y36(P.c),x.Y36(P.Cr))},n.\u0275cmp=x.Xpm({type:n,selectors:[["app-admin-folder-health"]],features:[x.qOj],decls:9,vars:4,consts:[[1,"health"],[1,"actions"],["title","Refresh List",1,"button-on-control",3,"click"],[1,"icon-reload"],["placeholder","Type of Hints",3,"ngModel","ngModelChange",4,"ngIf"],[1,"health-content"],[4,"ngIf"],["name","Folder Health Issues",3,"list"],["class","folder",4,"ngFor","ngForOf"],["placeholder","Type of Hints",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"folder"],[1,"meta"],[3,"routerLink"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"folder-health"],[3,"folderHealth"],[1,"type"],[1,"name"],[1,"artist"],[1,"year"]],template:function(t,e){1&t&&(x.TgZ(0,"div",0),x.TgZ(1,"div",1),x.TgZ(2,"button",2),x.NdJ("click",function(){return e.refresh()}),x._UZ(3,"i",3),x.qZA(),x.YNc(4,te,2,2,"select",4),x.qZA(),x.TgZ(5,"div",5),x.YNc(6,ee,1,0,"app-loading",6),x._UZ(7,"app-background-text-list",7),x.YNc(8,ce,11,9,"div",8),x.qZA(),x.qZA()),2&t&&(x.xp6(4),x.Q6J("ngIf",e.modes.length>0),x.xp6(2),x.Q6J("ngIf",!e.hints),x.xp6(1),x.Q6J("list",e.hints),x.xp6(1),x.Q6J("ngForOf",e.hints))},directives:[g.O5,nt.$,g.sg,h.EJ,h.JJ,h.On,h.YN,h.Kr,et.N,O.yS,g.RF,g.n9,g.ED,Xt],styles:["[_nghost-%COMP%]{height:100%;width:100%}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]{height:100%;width:100%;display:flex;flex-direction:column}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{padding:10px 15px 0;border-bottom-color:var(--background-border);border-bottom-width:1px;border-bottom-style:solid}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{margin-right:5px;margin-bottom:10px}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%] > label[_ngcontent-%COMP%]{text-transform:uppercase;letter-spacing:1px;font-size:11px;margin-left:5px;margin-right:5px}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .health-content[_ngcontent-%COMP%]{padding:15px;overflow-y:auto;overflow-x:auto}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]{border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:var(--background-border);padding:15px;display:flex;flex-flow:row wrap;flex-flow:row nowrap}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]{width:30%;padding-right:15px;margin-left:15px;display:flex;flex-flow:column wrap;position:relative}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:100%;text-overflow:ellipsis;overflow:hidden}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]   .type[_ngcontent-%COMP%]{text-transform:uppercase}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]   .type[_ngcontent-%COMP%], [_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]   .year[_ngcontent-%COMP%], [_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]   .state[_ngcontent-%COMP%]{letter-spacing:1px;font-size:.8em}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-size:24px;font-weight:100;color:var(--on-background-active)}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--on-background-active)}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:var(--on-background)}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{font-size:14px;line-height:1.2em}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{margin-top:auto}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-bottom:5px;margin-right:5px;height:27px;font-weight:500;padding:1px 15px 0}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{transform:scale(1.3);transform-origin:center}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none;border:1px solid transparent;padding:4px 9px 7px;border-radius:50%;display:none;position:absolute;right:1px;bottom:0}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{background-color:var(--control-hover);color:var(--on-background-hover)}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]:hover   .actions[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], [_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]:hover   app-fav-icon[_ngcontent-%COMP%]{display:inline}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .folder-health[_ngcontent-%COMP%]{display:flex;width:70%}@media (max-width: 400px){[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]{padding-left:0;padding-right:0}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]{font-size:.8em}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-size:16px}}"]}),n}(),de=s(67111);function ue(t,e){if(1&t&&(x.TgZ(0,"div"),x.TgZ(1,"div"),x._uU(2),x.ALo(3,"stringToggle"),x.qZA(),x._UZ(4,"app-loading"),x.qZA()),2&t){var n=x.oxw();x.xp6(2),x.Oqu(x.Dn7(3,1,n.isUploading,"Uploading","Creating Artwork"))}}function ge(t,e){if(1&t){var n=x.EpF();x.TgZ(0,"div",2),x.NdJ("drop",function(t){return x.CHM(n),x.oxw().onDropFile(t)})("dragover",function(t){return x.CHM(n),x.oxw().onDragOverFile(t)}),x.TgZ(1,"form"),x.TgZ(2,"input",3),x.NdJ("change",function(t){return x.CHM(n),x.oxw().selectFile(t)}),x.qZA(),x.qZA(),x.qZA()}}var he=function(){var t=function(){function t(e,n,i){c(this,t),this.jam=e,this.notify=n,this.folderService=i,this.isIdle=!0,this.isUploading=!1,this.unsubscribe=new y.xQ}return d(t,[{key:"ngOnDestroy",value:function(){this.unsubscribe.next(),this.unsubscribe.complete()}},{key:"dialogInit",value:function(t,e){var n;this.reference=t,this.folder=null===(n=e.data)||void 0===n?void 0:n.folder}},{key:"waitForCreationEnd",value:function(t){var e=this;if(this.folder){var n=this.folder.id;this.folderService.waitForQueueResult("Creating Artwork",t,[]).pipe((0,b.R)(this.unsubscribe)).subscribe(function(i){e.isIdle=!0,e.folderService.notifyFolderChange(n,P.dw.fsnRefresh),t.error||(e.notify.success("Upload done"),e.reference&&e.reference.close())})}}},{key:"onDropFile",value:function(t){var e;t.preventDefault(),this.uploadFile(null===(e=t.dataTransfer)||void 0===e?void 0:e.files)}},{key:"onDragOverFile",value:function(t){t.stopPropagation(),t.preventDefault()}},{key:"selectFile",value:function(t){this.uploadFile(t.target.files)}},{key:"uploadFile",value:function(t){var e=this;if(t&&0!==t.length&&this.folder){var n=t[0];this.isIdle=!1,this.isUploading=!0,this.jam.artwork.createByUpload({folderID:this.folder.id,types:[]},n).pipe((0,b.R)(this.unsubscribe)).subscribe(function(t){if(t.type!==ft.dt.UploadProgress&&t instanceof ft.Zn){var n=t.body;n&&e.waitForCreationEnd(n)}},function(t){e.isUploading=!1,e.isIdle=!0,e.notify.error(t)},function(){e.isUploading=!1})}}}]),t}();return t.\u0275fac=function(e){return new(e||t)(x.Y36(w.K4),x.Y36(P.c),x.Y36(P.Cr))},t.\u0275cmp=x.Xpm({type:t,selectors:[["app-dialog-upload-image"]],decls:2,vars:2,consts:[[4,"ngIf"],["class","drop-zone",3,"drop","dragover",4,"ngIf"],[1,"drop-zone",3,"drop","dragover"],["type","file","placeholder","Upload image","accept",".png,.jpeg,.jpg",3,"change"]],template:function(t,e){1&t&&(x.YNc(0,ue,5,5,"div",0),x.YNc(1,ge,3,0,"div",1)),2&t&&(x.Q6J("ngIf",!e.isIdle),x.xp6(1),x.Q6J("ngIf",e.isIdle))},directives:[g.O5,et.N,h._Y,h.JL,h.F],pipes:[I.C],styles:["[_nghost-%COMP%]   .drop-zone[_ngcontent-%COMP%]{margin:10px 20px;border-width:2px;border-style:dotted;border-color:var(--secondary);height:80%}[_nghost-%COMP%]   input[type=text][_ngcontent-%COMP%]{width:100%}"]}),t}(),pe=s(99743);function fe(t,e){1&t&&x._UZ(0,"app-loading")}function me(t,e){if(1&t&&x._UZ(0,"app-info-note",21),2&t){var n=x.oxw(2);x.Q6J("info",n.folder.info)}}function ve(t,e){if(1&t&&(x.ynx(0),x._uU(1),x.BQk()),2&t){var n=x.oxw(2);x.xp6(1),x.hij(" / ",null==n.folder.tag?null:n.folder.tag.albumType,"")}}function Me(t,e){if(1&t&&(x.TgZ(0,"div"),x.TgZ(1,"div",13),x._uU(2,"Artist"),x.qZA(),x.TgZ(3,"div"),x._uU(4),x.qZA(),x.qZA()),2&t){var n=x.oxw(2);x.xp6(4),x.Oqu(null==n.folder.tag?null:n.folder.tag.artist)}}function xe(t,e){if(1&t&&(x.TgZ(0,"div"),x.TgZ(1,"div",13),x._uU(2,"Album"),x.qZA(),x.TgZ(3,"div"),x._uU(4),x.qZA(),x.qZA()),2&t){var n=x.oxw(2);x.xp6(4),x.Oqu(null==n.folder.tag?null:n.folder.tag.album)}}function Ce(t,e){if(1&t&&(x.TgZ(0,"div"),x.TgZ(1,"div",13),x._uU(2,"Year"),x.qZA(),x.TgZ(3,"div"),x._uU(4),x.qZA(),x.qZA()),2&t){var n=x.oxw(2);x.xp6(4),x.hij(" ",null==n.folder.tag?null:n.folder.tag.year,"")}}function _e(t,e){if(1&t&&(x.TgZ(0,"div"),x.TgZ(1,"div",13),x._uU(2,"Genres"),x.qZA(),x.TgZ(3,"div"),x._uU(4),x.qZA(),x.qZA()),2&t){var n=x.oxw(2);x.xp6(4),x.hij(" ",null==n.folder.tag?null:n.folder.tag.genres,"")}}function Oe(t,e){if(1&t&&(x.TgZ(0,"div"),x.TgZ(1,"div",13),x._uU(2,"MB Release Id"),x.qZA(),x.TgZ(3,"div"),x.TgZ(4,"a",22),x._uU(5),x.qZA(),x.qZA(),x.qZA()),2&t){var n=x.oxw(2);x.xp6(4),x.MGl("href","https://musicbrainz.org/release/",null==n.folder.tag?null:n.folder.tag.mbReleaseID,"",x.LSH),x.xp6(1),x.Oqu(null==n.folder.tag?null:n.folder.tag.mbReleaseID)}}function ye(t,e){if(1&t&&(x.TgZ(0,"div"),x.TgZ(1,"div",13),x._uU(2,"MB Artist Id"),x.qZA(),x.TgZ(3,"div"),x.TgZ(4,"a",22),x._uU(5),x.qZA(),x.qZA(),x.qZA()),2&t){var n=x.oxw(2);x.xp6(4),x.MGl("href","https://musicbrainz.org/artist/",null==n.folder.tag?null:n.folder.tag.mbArtistID,"",x.LSH),x.xp6(1),x.Oqu(null==n.folder.tag?null:n.folder.tag.mbArtistID)}}var be=function(t){return["/admin/folder",t]};function ke(t,e){if(1&t&&(x.TgZ(0,"div"),x.TgZ(1,"div",13),x._uU(2,"Parent Folder Id"),x.qZA(),x.TgZ(3,"div"),x.TgZ(4,"a",23),x._uU(5),x.qZA(),x.qZA(),x.qZA()),2&t){var n=x.oxw(2);x.xp6(4),x.Q6J("routerLink",x.VKq(2,be,n.folder.parentID)),x.xp6(1),x.Oqu(n.folder.parentID)}}function Pe(t,e){if(1&t){var n=x.EpF();x.TgZ(0,"button",24),x.NdJ("click",function(){return x.CHM(n),x.oxw(2).searchImages()}),x._UZ(1,"i",25),x._uU(2," Search Artwork "),x.qZA()}}function we(t,e){if(1&t){var n=x.EpF();x.TgZ(0,"button",26),x.NdJ("click",function(){return x.CHM(n),x.oxw(2).searchImages()}),x._UZ(1,"i",25),x._uU(2," Search Art"),x.qZA()}}function Ze(t,e){if(1&t&&(x.TgZ(0,"div",27),x._UZ(1,"app-admin-artwork-list",28),x.qZA()),2&t){var n=x.oxw(2);x.xp6(1),x.Q6J("folderID",n.folder.id)("artworks",n.folder.artworks)}}function Ae(t,e){if(1&t){var n=x.EpF();x.TgZ(0,"div",2),x.TgZ(1,"div",3),x.TgZ(2,"button",4),x.NdJ("click",function(){return x.CHM(n),x.oxw().refresh()}),x._UZ(3,"i",5),x.qZA(),x.TgZ(4,"button",6),x.NdJ("click",function(){return x.CHM(n),x.oxw().moveFolder()}),x._UZ(5,"i",7),x.qZA(),x.TgZ(6,"button",8),x.NdJ("click",function(){return x.CHM(n),x.oxw().removeFolder()}),x._UZ(7,"i",9),x.qZA(),x.qZA(),x.TgZ(8,"div",10),x.YNc(9,me,1,1,"app-info-note",11),x.TgZ(10,"div",12),x.TgZ(11,"div"),x.TgZ(12,"div"),x.TgZ(13,"div",13),x._uU(14,"Name"),x.qZA(),x.TgZ(15,"div"),x.TgZ(16,"app-inline-edit",14),x.NdJ("ngModelChange",function(t){return x.CHM(n),x.oxw().name=t})("endEditRequest",function(){return x.CHM(n),x.oxw().editFolderName()}),x.qZA(),x.qZA(),x.qZA(),x.TgZ(17,"div"),x.TgZ(18,"div",13),x._uU(19,"Type"),x.qZA(),x.TgZ(20,"div"),x._uU(21),x.YNc(22,ve,2,1,"ng-container",0),x.qZA(),x.qZA(),x.TgZ(23,"div"),x.TgZ(24,"div",13),x._uU(25,"Track Count"),x.qZA(),x.TgZ(26,"div"),x._uU(27),x.qZA(),x.qZA(),x.TgZ(28,"div"),x.TgZ(29,"div",13),x._uU(30,"Folder Count"),x.qZA(),x.TgZ(31,"div"),x._uU(32),x.qZA(),x.qZA(),x.YNc(33,Me,5,1,"div",0),x.YNc(34,xe,5,1,"div",0),x.qZA(),x.TgZ(35,"div"),x.YNc(36,Ce,5,1,"div",0),x.YNc(37,_e,5,1,"div",0),x.YNc(38,Oe,6,2,"div",0),x.YNc(39,ye,6,2,"div",0),x.YNc(40,ke,6,4,"div",0),x.qZA(),x.qZA(),x.TgZ(41,"div",15),x.TgZ(42,"div",3),x.TgZ(43,"button",16),x.NdJ("click",function(){return x.CHM(n),x.oxw().uploadImage()}),x._UZ(44,"i",17),x._uU(45," Upload Artwork"),x.qZA(),x.YNc(46,Pe,3,0,"button",18),x.YNc(47,we,3,0,"button",19),x.qZA(),x.YNc(48,Ze,2,2,"div",20),x.qZA(),x.qZA(),x.qZA()}if(2&t){var i=x.oxw();x.xp6(9),x.Q6J("ngIf",null==i.folder.info?null:i.folder.info.description),x.xp6(7),x.Q6J("ngModel",i.name),x.xp6(5),x.hij("",i.folder.type," "),x.xp6(1),x.Q6J("ngIf",i.isAlbum),x.xp6(5),x.Oqu(i.folder.trackCount),x.xp6(5),x.Oqu(i.folder.folderCount),x.xp6(1),x.Q6J("ngIf",null==i.folder.tag?null:i.folder.tag.artist),x.xp6(1),x.Q6J("ngIf",null==i.folder.tag?null:i.folder.tag.album),x.xp6(2),x.Q6J("ngIf",null==i.folder.tag?null:i.folder.tag.year),x.xp6(1),x.Q6J("ngIf",null==i.folder.tag||null==i.folder.tag.genres?null:i.folder.tag.genres.length),x.xp6(1),x.Q6J("ngIf",null==i.folder.tag?null:i.folder.tag.mbReleaseID),x.xp6(1),x.Q6J("ngIf",null==i.folder.tag?null:i.folder.tag.mbArtistID),x.xp6(1),x.Q6J("ngIf",i.folder.parentID),x.xp6(6),x.Q6J("ngIf",i.isAlbum&&i.folder.tag&&(i.folder.tag.mbReleaseID||i.folder.tag.mbReleaseGroupID)),x.xp6(1),x.Q6J("ngIf",i.isArtist&&i.folder.tag&&i.folder.tag.mbArtistID),x.xp6(1),x.Q6J("ngIf",i.folder.artworks&&i.folder.artworks.length>0)}}var Te=function(){var n=function(n){e(a,n);var o=i(a);function a(t,e,n,i,r,s,l,d){var u;return c(this,a),(u=o.call(this,t)).app=e,u.jam=n,u.notify=i,u.dialogsService=r,u.dialogOverlay=s,u.folderService=l,u.router=d,u.name="",u.isAlbum=!1,u.isArtist=!1,u}return d(a,[{key:"ngOnInit",value:function(){var e=this;t(r(a.prototype),"ngOnInit",this).call(this),this.folderService.foldersChange.pipe((0,b.R)(this.unsubscribe)).subscribe(function(t){t.id===e.id&&e.refresh()})}},{key:"ngOnDestroy",value:function(){t(r(a.prototype),"ngOnDestroy",this).call(this)}},{key:"editFolderName",value:function(){var t=this;if(this.folder){var e=(this.name||"").trim();if(0!==e.length&&e!==this.folder.name){var n=this.folder.id;this.jam.folder.rename({id:n,name:e}).then(function(e){t.folderService.waitForQueueResult("Renaming Folder",e,[n])}).catch(function(e){t.notify.error(e)})}else this.name=this.folder.name}}},{key:"refresh",value:function(){var t=this;this.id&&this.jam.folder.id({id:this.id,folderIncTag:!0,folderIncParents:!0,folderIncArtworks:!0,folderIncChildFolderCount:!0,folderIncTrackCount:!0}).then(function(e){t.display(e)}).catch(function(e){404===e.code?t.router.navigate(["/admin/folder/"]).catch(function(t){console.error(t)}):t.notify.error(e)})}},{key:"uploadImage",value:function(){this.dialogOverlay.open({title:"Upload Folder Images",childComponent:he,data:{folder:this.folder},panelClass:"overlay-panel-large-buttons"})}},{key:"searchImages",value:function(){this.dialogOverlay.open({title:"Search Artwork Images",childComponent:Dt,data:{folder:this.folder},panelClass:"overlay-panel-large-buttons"})}},{key:"removeFolder",value:function(){var t=this,e=this.folder;!e||this.dialogsService.confirm("Remove Folder?",'Sure to remove Folder "'.concat(e.name,'"?'),function(){t.jam.folder.remove({id:e.id}).then(function(n){e.parentID&&t.router.navigate(["/admin/folder/".concat(e.parentID,"/overview")]).catch(function(t){console.error(t)}),t.folderService.waitForQueueResult("Removing Folder",n,[e.id],e.parentID?[e.parentID]:[])}).catch(function(e){t.notify.error(e)})})}},{key:"moveFolder",value:function(){var t=this,e=this.folder;if(e){var n={selectID:e.id,disableIDs:[e.id]};this.dialogOverlay.open({title:"Move Folder to",childComponent:G,data:n,panelClass:"overlay-panel-large-buttons",onOkBtn:function(){return(0,_.mG)(t,void 0,void 0,regeneratorRuntime.mark(function t(){var i,o=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(i=n.folder)){t.next=9;break}t.prev=2,this.jam.folder.move({ids:[e.id],newParentID:i.id}).then(function(t){o.folderService.waitForQueueResult("Moving Folder",t,[e.id],(e.parentID?[e.parentID]:[]).concat([i.id]))}).catch(function(t){o.notify.error(t)}),t.next=9;break;case 6:return t.prev=6,t.t0=t.catch(2),t.abrupt("return",(this.notify.error(t.t0),Promise.reject(t.t0)));case 9:case"end":return t.stop()}},t,this,[[2,6]])}))},onCancelBtn:function(){return(0,_.mG)(t,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Promise.resolve());case 1:case"end":return t.stop()}},t)}))}})}}},{key:"display",value:function(t){this.name="",this.isAlbum=!1,this.isArtist=!1,this.folder=t,t&&(this.name=t.name,this.isAlbum=de.Dz.includes(t.type),this.isArtist=t.type===w.Sr.artist)}}]),a}(W);return n.\u0275fac=function(t){return new(t||n)(x.Y36(O.gz),x.Y36(P.zi),x.Y36(w.K4),x.Y36(P.c),x.Y36(K.Hr),x.Y36(tt.SL),x.Y36(P.Cr),x.Y36(O.F0))},n.\u0275cmp=x.Xpm({type:n,selectors:[["app-admin-folder"]],features:[x.qOj],decls:2,vars:2,consts:[[4,"ngIf"],["class","folder",4,"ngIf"],[1,"folder"],[1,"actions"],["title","Refresh",1,"button-on-control",3,"click"],[1,"icon-reload"],["title","Move Folder\u2026",1,"button-on-control",3,"click"],[1,"icon-right-bold"],["title","Remove Folder\u2026",1,"button-on-control",3,"click"],[1,"icon-trash"],[1,"content"],[3,"info",4,"ngIf"],[1,"properties"],[1,"label"],["type","text",3,"ngModel","ngModelChange","endEditRequest"],[1,"artworks"],[1,"button-on-control",3,"click"],[1,"icon-upload-cloud"],["class","button-on-control","title","Album Images",3,"click",4,"ngIf"],["class","button-on-control","title","Artist Images",3,"click",4,"ngIf"],["class","artworks-content",4,"ngIf"],[3,"info"],["target","_blank","rel","noopener",3,"href"],[3,"routerLink"],["title","Album Images",1,"button-on-control",3,"click"],[1,"icon-picture"],["title","Artist Images",1,"button-on-control",3,"click"],[1,"artworks-content"],[3,"folderID","artworks"]],template:function(t,e){1&t&&(x.YNc(0,fe,1,0,"app-loading",0),x.YNc(1,Ae,49,16,"div",1)),2&t&&(x.Q6J("ngIf",!e.folder),x.xp6(1),x.Q6J("ngIf",e.folder))},directives:[g.O5,et.N,Pt,h.JJ,h.On,pe.a,O.yS,It],styles:["[_nghost-%COMP%]{height:100%;width:100%;overflow:hidden;display:block}[_nghost-%COMP%]   .actions[_ngcontent-%COMP%]{padding:10px 15px 0;border-bottom-color:var(--background-border);border-bottom-width:1px;border-bottom-style:solid}[_nghost-%COMP%]   .actions[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{margin-right:5px;margin-bottom:10px}[_nghost-%COMP%]   .actions[_ngcontent-%COMP%] > label[_ngcontent-%COMP%]{text-transform:uppercase;letter-spacing:1px;font-size:11px;margin-left:5px;margin-right:5px}[_nghost-%COMP%]   .folder[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;width:100%}[_nghost-%COMP%]   .folder[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{overflow-y:auto;display:flex;flex-direction:column}[_nghost-%COMP%]   .folder[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .properties[_ngcontent-%COMP%]{width:100%;display:flex;flex-wrap:wrap;flex-direction:row;padding:15px}[_nghost-%COMP%]   .folder[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .properties[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{flex:0 0 50%}@media (max-width: 522px){[_nghost-%COMP%]   .folder[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .properties[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{flex:0 0 100%}}[_nghost-%COMP%]   .folder[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .properties[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{padding-top:5px;padding-bottom:5px}[_nghost-%COMP%]   .folder[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .properties[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{color:var(--on-background-active)}[_nghost-%COMP%]   .folder[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .properties[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--on-background-active)}[_nghost-%COMP%]   .folder[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .properties[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:var(--on-background)}[_nghost-%COMP%]   .folder[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .properties[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{color:var(--on-background);font-size:.7em;text-transform:uppercase;padding-bottom:2px}[_nghost-%COMP%]   .folder[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .artworks[_ngcontent-%COMP%]{border-top:1px solid var(--background-border)}[_nghost-%COMP%]   .folder[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .artworks[_ngcontent-%COMP%]   .artworks-content[_ngcontent-%COMP%]{padding:0 15px 15px}"]}),n}();function Ie(t,e){1&t&&(x.TgZ(0,"div",2),x.TgZ(1,"div",3),x._UZ(2,"i",4),x.qZA(),x.qZA())}function qe(t,e){1&t&&(x.TgZ(0,"div",3),x._uU(1,"No Hints"),x.qZA())}function Se(t,e){if(1&t&&(x.TgZ(0,"div",3),x._UZ(1,"i",9),x._uU(2),x.TgZ(3,"div",10),x._uU(4),x.qZA(),x.qZA()),2&t){var n=e.$implicit;x.xp6(2),x.hij(" ",n.hint.name," "),x.xp6(2),x.Oqu(n.description)}}function Ue(t,e){1&t&&x._UZ(0,"i",4)}function Re(t,e){if(1&t&&(x.ynx(0),x._uU(1),x.BQk()),2&t){var n=x.oxw().$implicit;x.xp6(1),x.Oqu(n.name)}}function Je(t,e){if(1&t){var n=x.EpF();x.TgZ(0,"button",11),x.NdJ("click",function(){return x.CHM(n).$implicit.click()}),x.YNc(1,Ue,1,0,"i",12),x.YNc(2,Re,2,1,"ng-container",0),x.qZA()}if(2&t){var i=e.$implicit;x.xp6(1),x.Q6J("ngIf",i.running),x.xp6(1),x.Q6J("ngIf",!i.running)}}function Qe(t,e){if(1&t&&(x.TgZ(0,"div",2),x.YNc(1,qe,2,0,"div",5),x.YNc(2,Se,5,2,"div",6),x.TgZ(3,"div",7),x.YNc(4,Je,3,2,"button",8),x.qZA(),x.qZA()),2&t){var n=x.oxw(2);x.xp6(1),x.Q6J("ngIf",0===n.hints.length),x.xp6(1),x.Q6J("ngForOf",n.hints)("ngForTrackBy",n.trackByFn),x.xp6(2),x.Q6J("ngForOf",n.solutions)}}function Ne(t,e){if(1&t&&(x.ynx(0),x.YNc(1,Ie,3,0,"div",1),x.YNc(2,Qe,5,4,"div",1),x.BQk()),2&t){var n=x.oxw();x.xp6(1),x.Q6J("ngIf",!(n.trackHealth.health&&n.hints)),x.xp6(1),x.Q6J("ngIf",n.trackHealth.health&&n.hints)}}var Fe=function(){var t=function(){function t(e,n,i,o,r){c(this,t),this.app=e,this.jam=n,this.notify=i,this.folderService=o,this.router=r,this.solutions=[],this.resolvedEvent=new x.vpe,this.unsubscribe=new y.xQ}return d(t,[{key:"trackByFn",value:function(t,e){return e.hint.id}},{key:"ngOnChanges",value:function(t){this.display(this.trackHealth)}},{key:"ngOnDestroy",value:function(){this.unsubscribe.next(),this.unsubscribe.complete()}},{key:"ngOnInit",value:function(){var t=this;this.folderService.tracksChange.pipe((0,b.R)(this.unsubscribe)).subscribe(function(e){var n=t.trackHealth;n&&n.track.id===e.id&&(n.health=[],t.jam.track.health({ids:[n.track.id],healthMedia:!0}).then(function(e){var i=e.find(function(t){return t.track.id===n.track.id});i&&i.health?(n.track=i.track,n.health=i.health):n.health=[],0===n.health.length&&t.resolvedEvent.emit(),t.display(n)}).catch(function(e){t.notify.error(e)}))})}},{key:"fixAll",value:function(){var t,e=a(this.solutions);try{for(e.s();!(t=e.n()).done;){var n=t.value;n.fixable&&!n.running&&n.click&&n.click()}}catch(i){e.e(i)}finally{e.f()}}},{key:"display",value:function(t){var e=this;this.hints=[],this.solutions=[],(null==t?void 0:t.health)&&(this.hints=t.health.map(function(n){return{hint:n,description:e.describeHint(n,t.track)}}))}},{key:"describeTagHint",value:function(t,e){var n=this,i="";return t.id===w.U.tagValuesExists?i=(t.details||[]).map(function(t){return t.reason.toUpperCase()}).join(", "):t.id===w.U.id3v2Garbage?i=(t.details||[]).map(function(t){return t.reason}).join(", "):t.id===w.U.id3v2Valid&&(i=(t.details||[]).map(function(t){return t.expected&&t.actual?"".concat(t.reason,"  (").concat(t.actual," instead of ").concat(t.expected,")"):t.reason}).join(", ")),this.solutions.find(function(t){return"Edit Tag"===t.name})||this.solutions.push({name:"Edit Tag",click:function(){n.router.navigate(["/admin/folder/".concat(e.parentID,"/tags")]).catch(function(t){console.error(t)})}}),i}},{key:"describeMp3GarbageHint",value:function(t,e){var n=this,i="";if(t.details&&t.details.length>0&&(i="".concat(t.details[0].reason," (").concat(t.details[0].actual," bytes)")),!this.solutions.find(function(t){return"Fix MP3"===t.name})){var o={name:"Fix MP3",fixable:!0,click:function(){o.running||(o.running=!0,n.jam.track.fix({id:e.id,fixID:t.id}).then(function(t){n.folderService.waitForQueueResult("Fixing Track MP3",t,[],[],[e.id])}).catch(function(t){n.notify.error(t)}))}};this.solutions.push(o)}return i}},{key:"describeMp3ErrorHint",value:function(t,e){var n=this,i="Stream Errors: ".concat((t.details||[]).length);if(!this.solutions.find(function(t){return"Fix Stream"===t.name})){var o={name:"Fix Stream",fixable:!0,click:function(){o.running||(o.running=!0,n.jam.track.fix({id:e.id,fixID:t.id}).then(function(t){n.folderService.waitForQueueResult("Fixing Track Stream",t,[],[],[e.id])}).catch(function(t){n.notify.error(t)}))}};this.solutions.push(o)}return i}},{key:"describeID3v1Hint",value:function(t,e){var n=this;if(!this.solutions.find(function(t){return"Remove ID3v1"===t.name})){var i={name:"Remove ID3v1",fixable:!0,click:function(){i.running||(i.running=!0,n.jam.track.fix({id:e.id,fixID:t.id}).then(function(t){n.folderService.waitForQueueResult("Remove ID3v1",t,[],[],[e.id])}).catch(function(t){n.notify.error(t)}))}};this.solutions.push(i)}return""}},{key:"describeMP3HeaderHint",value:function(t,e){var n=this,i="";if(t.id===w.U.mp3HeaderValid&&(i=(t.details||[]).map(function(t){return t.expected&&t.actual?"".concat(t.reason,"  (").concat(t.actual," instead of ").concat(t.expected,")"):t.reason}).join(", ")),!this.solutions.find(function(t){return"Fix Header"===t.name})){var o={name:"Fix Header",fixable:!0,click:function(){o.running||(o.running=!0,n.jam.track.fix({id:e.id,fixID:t.id}).then(function(t){n.folderService.waitForQueueResult("Fixing Track Header",t,[],[],[e.id])}).catch(function(t){n.notify.error(t)}))}};this.solutions.push(o)}return i}},{key:"describeHint",value:function(t,e){switch(t.id){case w.U.tagValuesExists:case w.U.id3v2Garbage:case w.U.id3v2Exists:case w.U.id3v2Valid:return this.describeTagHint(t,e);case w.U.mp3Garbage:return this.describeMp3GarbageHint(t,e);case w.U.mp3MediaValid:return this.describeMp3ErrorHint(t,e);case w.U.id3v2NoId3v1:return this.describeID3v1Hint(t,e);case w.U.mp3HeaderExists:case w.U.mp3HeaderValid:return this.describeMP3HeaderHint(t,e)}return""}}]),t}();return t.\u0275fac=function(e){return new(e||t)(x.Y36(P.zi),x.Y36(w.K4),x.Y36(P.c),x.Y36(P.Cr),x.Y36(O.F0))},t.\u0275cmp=x.Xpm({type:t,selectors:[["app-track-health"]],inputs:{trackHealth:"trackHealth"},outputs:{resolvedEvent:"resolvedEvent"},features:[x.TTD],decls:1,vars:1,consts:[[4,"ngIf"],["class","hints",4,"ngIf"],[1,"hints"],[1,"hint"],[1,"icon-spin","icon-spinner"],["class","hint",4,"ngIf"],["class","hint",4,"ngFor","ngForOf","ngForTrackBy"],[1,"solutions"],["class","button-on-background",3,"click",4,"ngFor","ngForOf"],[1,"icon-warning"],[1,"details"],[1,"button-on-background",3,"click"],["class","icon-spin icon-spinner",4,"ngIf"]],template:function(t,e){1&t&&x.YNc(0,Ne,3,2,"ng-container",0),2&t&&x.Q6J("ngIf",e.trackHealth)},directives:[g.O5,g.sg],styles:["[_nghost-%COMP%]{height:100%;width:100%;overflow-y:auto;overflow-x:auto;display:block}[_nghost-%COMP%]   .icon-warning[_ngcontent-%COMP%]{color:var(--accent)}[_nghost-%COMP%]   .details[_ngcontent-%COMP%]{padding-left:28px;font-size:.8em;display:block;padding-top:5px}[_nghost-%COMP%]   .hint[_ngcontent-%COMP%]{padding-bottom:15px}[_nghost-%COMP%]   .solutions[_ngcontent-%COMP%]{padding-bottom:15px}[_nghost-%COMP%]   .solutions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-right:5px}[_nghost-%COMP%]   .detail[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{text-transform:uppercase;letter-spacing:1.25px;font-size:11px;min-width:80px;margin-right:10px;display:inline-block}"]}),t}();function He(t,e){1&t&&x._UZ(0,"app-loading")}function ze(t,e){if(1&t){var n=x.EpF();x.TgZ(0,"div",9),x.TgZ(1,"div",10),x._uU(2),x.qZA(),x.TgZ(3,"div",11),x.TgZ(4,"app-track-health",12),x.NdJ("resolvedEvent",function(){var t=x.CHM(n).$implicit;return x.oxw().trackHealthResolved(t)}),x.qZA(),x.qZA(),x.qZA()}if(2&t){var i=e.$implicit;x.xp6(2),x.hij(" ",i.track.name," "),x.xp6(2),x.Q6J("trackHealth",i)}}var Ye=function(){var n=function(n){e(s,n);var o=i(s);function s(t,e,n,i,r){var a;return c(this,s),(a=o.call(this,t)).app=e,a.jam=n,a.notify=i,a.folderService=r,a.modes=[],a.mediaCheck=!1,a}return d(s,[{key:"onFilterChange",value:function(){this.reDisplay()}},{key:"ngOnInit",value:function(){var e=this;t(r(s.prototype),"ngOnInit",this).call(this),this.folderService.foldersChange.pipe((0,b.R)(this.unsubscribe)).subscribe(function(t){t.id===e.id&&e.refresh()})}},{key:"ngOnDestroy",value:function(){t(r(s.prototype),"ngOnDestroy",this).call(this)}},{key:"checkChange",value:function(){this.refresh()}},{key:"trackHealthResolved",value:function(t){this.all&&(this.all=this.all.filter(function(e){return e!==t}),this.reDisplay())}},{key:"refresh",value:function(){var t=this;this.hints=void 0,this.id&&this.jam.track.health({folderIDs:[this.id],healthMedia:this.mediaCheck}).then(function(e){t.display(e)}).catch(function(e){t.notify.error(e)})}},{key:"reDisplay",value:function(){var t=this;this.hints=this.filter&&this.all?this.all.filter(function(e){return e.health&&e.health.find(function(e){return e.name===t.filter})}):this.all}},{key:"display",value:function(t){this.all=t,this.modes=[];var e,n=a(t);try{for(n.s();!(e=n.n()).done;){var i=e.value;if(i.health){var o,r=a(i.health);try{for(r.s();!(o=r.n()).done;){var s=o.value;this.modes.includes(s.name)||this.modes.push(s.name)}}catch(c){r.e(c)}finally{r.f()}}}}catch(c){n.e(c)}finally{n.f()}this.reDisplay()}}]),s}(W);return n.\u0275fac=function(t){return new(t||n)(x.Y36(O.gz),x.Y36(P.zi),x.Y36(w.K4),x.Y36(P.c),x.Y36(P.Cr))},n.\u0275cmp=x.Xpm({type:n,selectors:[["app-admin-tracks-health"]],features:[x.qOj],decls:11,vars:5,consts:[[1,"health"],[1,"actions"],["title","Refresh List",1,"button-on-control",3,"click"],[1,"icon-reload"],["type","checkbox",3,"ngModel","checked","ngModelChange","change"],[1,"content"],[4,"ngIf"],["name","Track Health Issues",3,"list"],["class","track",4,"ngFor","ngForOf"],[1,"track"],[1,"meta"],[1,"track-health"],[3,"trackHealth","resolvedEvent"]],template:function(t,e){1&t&&(x.TgZ(0,"div",0),x.TgZ(1,"div",1),x.TgZ(2,"button",2),x.NdJ("click",function(){return e.refresh()}),x._UZ(3,"i",3),x.qZA(),x.TgZ(4,"label"),x.TgZ(5,"input",4),x.NdJ("ngModelChange",function(t){return e.mediaCheck=t})("change",function(){return e.checkChange()}),x.qZA(),x._uU(6," Check Media "),x.qZA(),x.qZA(),x.TgZ(7,"div",5),x.YNc(8,He,1,0,"app-loading",6),x._UZ(9,"app-background-text-list",7),x.YNc(10,ze,5,2,"div",8),x.qZA(),x.qZA()),2&t&&(x.xp6(5),x.Q6J("ngModel",e.mediaCheck)("checked",e.mediaCheck),x.xp6(3),x.Q6J("ngIf",!e.hints),x.xp6(1),x.Q6J("list",e.hints),x.xp6(1),x.Q6J("ngForOf",e.hints))},directives:[h.Wl,h.JJ,h.On,g.O5,nt.$,g.sg,et.N,Fe],styles:["[_nghost-%COMP%]{height:100%;width:100%}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]{height:100%;width:100%;display:flex;flex-direction:column}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{padding:10px 15px 0;border-bottom-color:var(--background-border);border-bottom-width:1px;border-bottom-style:solid}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{margin-right:5px;margin-bottom:10px}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%] > label[_ngcontent-%COMP%]{text-transform:uppercase;letter-spacing:1px;font-size:11px;margin-left:5px;margin-right:5px}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{padding:15px;overflow-y:auto;overflow-x:auto}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .track[_ngcontent-%COMP%]{flex-flow:row nowrap}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .track[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]{width:30%;overflow:hidden;padding-right:15px;text-overflow:ellipsis}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .track[_ngcontent-%COMP%]   .track-health[_ngcontent-%COMP%]{width:70%}"]}),n}(),De=s(6906);function Ee(t,e){if(1&t){var n=x.EpF();x.TgZ(0,"tr",13),x.NdJ("click",function(){var t=x.CHM(n).$implicit;return t.selected=!t.selected}),x.TgZ(1,"td",4),x._uU(2),x.qZA(),x.TgZ(3,"td",5),x._uU(4),x.qZA(),x.TgZ(5,"td",6),x._uU(6),x.qZA(),x.TgZ(7,"td",7),x._uU(8),x.qZA(),x.TgZ(9,"td",8),x._uU(10),x.qZA(),x.TgZ(11,"td",9),x._uU(12),x.qZA(),x.TgZ(13,"td",10),x._uU(14),x.qZA(),x.TgZ(15,"td",11),x._uU(16),x.ALo(17,"duration"),x.qZA(),x.qZA()}if(2&t){var i=e.$implicit;x.ekj("selected",i.selected),x.xp6(2),x.Oqu(null==i.track.tag?null:i.track.tag.trackNr),x.xp6(2),x.Oqu(null==i.track.tag?null:i.track.tag.title),x.xp6(2),x.Oqu(null==i.track.tag?null:i.track.tag.artist),x.xp6(2),x.Oqu(null==i.track.tag?null:i.track.tag.album),x.xp6(2),x.Oqu(null==i.track.media?null:i.track.media.format),x.xp6(2),x.Oqu(null==i.track.media?null:i.track.media.bitRate),x.xp6(2),x.Oqu(null==i.track.media?null:i.track.media.sampleRate),x.xp6(2),x.Oqu(x.lcZ(17,10,i.track.duration))}}function je(t,e){if(1&t&&(x.TgZ(0,"table",2),x.TgZ(1,"tr",3),x.TgZ(2,"td",4),x._uU(3,"Track Nr."),x.qZA(),x.TgZ(4,"td",5),x._uU(5,"Title"),x.qZA(),x.TgZ(6,"td",6),x._uU(7,"Artist"),x.qZA(),x.TgZ(8,"td",7),x._uU(9,"Album"),x.qZA(),x.TgZ(10,"td",8),x._uU(11,"Format"),x.qZA(),x.TgZ(12,"td",9),x._uU(13,"BitRate"),x.qZA(),x.TgZ(14,"td",10),x._uU(15,"SampleRate"),x.qZA(),x.TgZ(16,"td",11),x._uU(17,"Duration"),x.qZA(),x.qZA(),x.YNc(18,Ee,18,12,"tr",12),x.qZA()),2&t){var n=x.oxw();x.xp6(18),x.Q6J("ngForOf",n.trackItems)}}var Be=function(){var t=function(){function t(e){c(this,t),this.router=e,this.tracks=[]}return d(t,[{key:"getSortValue",value:function(t,e){var n,i,o;switch(t){case"number":return null===(n=e.track.tag)||void 0===n?void 0:n.trackNr;case"name":return e.track.name;case"artist":return null===(i=e.track.tag)||void 0===i?void 0:i.artist;case"album":return null===(o=e.track.tag)||void 0===o?void 0:o.album;case"duration":return e.track.duration;default:return}}},{key:"ngOnChanges",value:function(t){this.trackItems=(this.tracks||[]).map(function(t){return{track:t}})}},{key:"toTrackFolder",value:function(t){this.router.navigate(["/admin/folder/".concat(t.parentID,"/overview")]).catch(function(t){console.error(t)})}}]),t}();return t.\u0275fac=function(e){return new(e||t)(x.Y36(O.F0))},t.\u0275cmp=x.Xpm({type:t,selectors:[["app-admin-track-list"]],inputs:{tracks:"tracks"},features:[x.TTD],decls:2,vars:2,consts:[["name","Tracks",3,"list"],["class","tracks",4,"ngIf"],[1,"tracks"],[1,"track","heading"],[1,"number"],[1,"title"],[1,"artist"],[1,"album"],[1,"format"],[1,"bitrate"],[1,"samplerate"],[1,"duration"],["class","track",3,"selected","click",4,"ngFor","ngForOf"],[1,"track",3,"click"]],template:function(t,e){1&t&&(x._UZ(0,"app-background-text-list",0),x.YNc(1,je,19,1,"table",1)),2&t&&(x.Q6J("list",e.tracks),x.xp6(1),x.Q6J("ngIf",e.tracks&&e.tracks.length>0))},directives:[nt.$,g.O5,g.sg],pipes:[De.u],styles:["[_nghost-%COMP%]{width:100%;overflow:auto;display:block}[_nghost-%COMP%]   .tracks[_ngcontent-%COMP%]{padding:15px;font-size:.8em;width:100%}[_nghost-%COMP%]   .heading[_ngcontent-%COMP%]{font-size:.9em}[_nghost-%COMP%]   .track[_ngcontent-%COMP%]{border-bottom:1px solid var(--control-border)}[_nghost-%COMP%]   .track[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:5px 10px}[_nghost-%COMP%]   .track[_ngcontent-%COMP%]:hover{background-color:var(--background-hover)}[_nghost-%COMP%]   .track.selected[_ngcontent-%COMP%]{background-color:var(--background-active)}"]}),t}();function Le(t,e){1&t&&x._UZ(0,"app-loading")}function We(t,e){if(1&t){var n=x.EpF();x.TgZ(0,"div",3),x.TgZ(1,"div",4),x.TgZ(2,"button",5),x.NdJ("click",function(){return x.CHM(n),x.oxw().refresh()}),x._UZ(3,"i",6),x.qZA(),x.TgZ(4,"button",7),x.NdJ("click",function(){return x.CHM(n),x.oxw().moveTracks()}),x._UZ(5,"i",8),x.qZA(),x.TgZ(6,"button",9),x.NdJ("click",function(){return x.CHM(n),x.oxw().deleteTracks()}),x._UZ(7,"i",10),x.qZA(),x.qZA(),x._UZ(8,"app-admin-track-list",11),x.qZA()}if(2&t){var i=x.oxw();x.xp6(8),x.Q6J("tracks",i.folder.tracks)}}var Ge=function(){var n=function(n){e(s,n);var o=i(s);function s(t,e,n,i,r,a){var l;return c(this,s),(l=o.call(this,t)).jam=e,l.notify=n,l.folderService=i,l.dialogsService=r,l.dialogOverlay=a,l}return d(s,[{key:"ngOnInit",value:function(){var e=this;t(r(s.prototype),"ngOnInit",this).call(this),this.folderService.foldersChange.pipe((0,b.R)(this.unsubscribe)).subscribe(function(t){t.id===e.id&&e.refresh()})}},{key:"ngOnDestroy",value:function(){t(r(s.prototype),"ngOnDestroy",this).call(this)}},{key:"deleteTracks",value:function(){var t=this,e=this.getTrackIDs();0!==e.length&&this.dialogsService.confirm("Remove Tracks?","Sure to remove ".concat(e.length," Track").concat(e.length>1?"s":"","?"),function(){var n,i=a(e);try{var o=function(){var e=n.value;t.jam.track.remove({id:e}).then(function(n){t.folderService.waitForQueueResult("Removing Track",n,[],[],[e])}).catch(function(e){t.notify.error(e)})};for(i.s();!(n=i.n()).done;)o()}catch(r){i.e(r)}finally{i.f()}})}},{key:"getTrackIDs",value:function(){var t,e;if(!(null===(t=this.tracks)||void 0===t?void 0:t.trackItems)||!(null===(e=this.folder)||void 0===e?void 0:e.tracks))return[];var n=this.tracks.trackItems.filter(function(t){return t.selected}).map(function(t){return t.track.id});return n.length>0?n:this.folder.tracks.map(function(t){return t.id})}},{key:"moveTracks",value:function(){var t=this,e=this.getTrackIDs();if(0!==e.length){var n={selectID:this.id};this.dialogOverlay.open({title:"Move Tracks to",childComponent:G,data:n,panelClass:"overlay-panel-large-buttons",onOkBtn:function(){return(0,_.mG)(t,void 0,void 0,regeneratorRuntime.mark(function t(){var i,o=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(i=n.folder)){t.next=3;break}return t.abrupt("return",(this.jam.track.move({ids:e,folderID:i.id}).then(function(t){var n;o.folderService.waitForQueueResult("Moving Tracks",t,[],[i.id].concat((null===(n=o.folder)||void 0===n?void 0:n.parentID)?[o.folder.parentID]:[]),e)}).catch(function(t){o.notify.error(t)}),Promise.resolve()));case 3:case"end":return t.stop()}},t,this)}))},onCancelBtn:function(){return(0,_.mG)(t,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Promise.resolve());case 1:case"end":return t.stop()}},t)}))}})}}},{key:"refresh",value:function(){var t=this;this.folder=void 0,this.id&&this.jam.folder.id({id:this.id,folderIncTracks:!0,trackIncTag:!0,trackIncMedia:!0}).then(function(e){t.folder=e}).catch(function(e){t.notify.error(e)})}}]),s}(W);return n.\u0275fac=function(t){return new(t||n)(x.Y36(O.gz),x.Y36(w.K4),x.Y36(P.c),x.Y36(P.Cr),x.Y36(K.Hr),x.Y36(tt.SL))},n.\u0275cmp=x.Xpm({type:n,selectors:[["app-admin-folder-tracks"]],viewQuery:function(t,e){var n;(1&t&&x.Gf(Be,5),2&t)&&(x.iGM(n=x.CRH())&&(e.tracks=n.first))},features:[x.qOj],decls:3,vars:3,consts:[[4,"ngIf"],["name","Tracks",3,"list"],["class","tracks",4,"ngIf"],[1,"tracks"],[1,"actions"],["title","Refresh",1,"button-on-control",3,"click"],[1,"icon-reload"],["title","Move Tracks\u2026",1,"button-on-control",3,"click"],[1,"icon-right-bold"],["title","Delete Tracks\u2026",1,"button-on-control",3,"click"],[1,"icon-trash"],[1,"content",3,"tracks"]],template:function(t,e){1&t&&(x.YNc(0,Le,1,0,"app-loading",0),x._UZ(1,"app-background-text-list",1),x.YNc(2,We,9,1,"div",2)),2&t&&(x.Q6J("ngIf",!e.folder),x.xp6(1),x.Q6J("list",null==e.folder?null:e.folder.tracks),x.xp6(1),x.Q6J("ngIf",e.folder&&e.folder.tracks&&e.folder.tracks.length>0))},directives:[g.O5,nt.$,et.N,Be],styles:["[_nghost-%COMP%]{height:100%;width:100%;display:block;overflow:hidden}[_nghost-%COMP%]   .tracks[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;width:100%}[_nghost-%COMP%]   .tracks[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{padding:10px 15px 0;border-bottom-color:var(--background-border);border-bottom-width:1px;border-bottom-style:solid}[_nghost-%COMP%]   .tracks[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{margin-right:5px;margin-bottom:10px}[_nghost-%COMP%]   .tracks[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%] > label[_ngcontent-%COMP%]{text-transform:uppercase;letter-spacing:1px;font-size:11px;margin-left:5px;margin-right:5px}[_nghost-%COMP%]   .tracks[_ngcontent-%COMP%]   app-admin-track-list[_ngcontent-%COMP%]{overflow-y:auto}"]}),n}(),$e=s(95197);function Ve(t,e){if(1&t){var n=x.EpF();x.TgZ(0,"button",9),x.NdJ("click",function(){x.CHM(n);var t=x.oxw(3);return t.refresh(t.current.pos,!1)}),x._UZ(1,"i",10),x._uU(2," Refresh"),x.qZA()}}function Xe(t,e){if(1&t){var n=x.EpF();x.TgZ(0,"button",9),x.NdJ("click",function(){return x.CHM(n),x.oxw(3).fixAll()}),x._uU(1,"Fix all fixable"),x.qZA()}}function Ke(t,e){if(1&t){var n=x.EpF();x.TgZ(0,"div",5),x.TgZ(1,"button",6),x.NdJ("click",function(){return x.CHM(n),x.oxw(2).start()}),x._UZ(2,"i",7),x._uU(3," Next"),x.qZA(),x.YNc(4,Ve,3,0,"button",8),x.YNc(5,Xe,2,0,"button",8),x.qZA()}if(2&t){var i=x.oxw(2);x.xp6(4),x.Q6J("ngIf",i.current),x.xp6(1),x.Q6J("ngIf",i.current&&i.current.health&&i.current.health.length>0)}}function tn(t,e){if(1&t){var n=x.EpF();x.TgZ(0,"div",5),x.TgZ(1,"button",9),x.NdJ("click",function(){return x.CHM(n),x.oxw(2).stop()}),x._UZ(2,"i",11),x._uU(3," Stop"),x.qZA(),x.qZA()}}function en(t,e){if(1&t&&(x.ynx(0),x.YNc(1,Ke,6,2,"div",4),x.YNc(2,tn,4,0,"div",4),x.BQk()),2&t){var n=x.oxw();x.xp6(1),x.Q6J("ngIf",!n.searching),x.xp6(1),x.Q6J("ngIf",n.searching)}}function nn(t,e){1&t&&x._UZ(0,"app-loading")}function on(t,e){1&t&&x._UZ(0,"i",16)}function rn(t,e){if(1&t){var n=x.EpF();x.TgZ(0,"div",18),x.TgZ(1,"div",19),x._uU(2),x.qZA(),x.TgZ(3,"div",20),x.TgZ(4,"app-track-health",21),x.NdJ("resolvedEvent",function(){var t=x.CHM(n).$implicit;return x.oxw(3).trackHealthResolved(t)}),x.qZA(),x.qZA(),x.qZA()}if(2&t){var i=e.$implicit;x.xp6(2),x.hij(" ",i.track.name," "),x.xp6(2),x.Q6J("trackHealth",i)}}function an(t,e){if(1&t&&(x.ynx(0),x.YNc(1,rn,5,2,"div",17),x.BQk()),2&t){var n=x.oxw(2);x.xp6(1),x.Q6J("ngForOf",n.current.health)("ngForTrackBy",n.trackByFn)}}var sn=function(t){return["/admin/folder",t,"tags"]};function cn(t,e){if(1&t&&(x.TgZ(0,"div"),x.TgZ(1,"div",12),x.TgZ(2,"span"),x.YNc(3,on,1,0,"i",13),x.qZA(),x.TgZ(4,"span"),x._uU(5),x.qZA(),x.TgZ(6,"a",14),x._UZ(7,"i",15),x._uU(8),x.qZA(),x.qZA(),x.YNc(9,an,2,2,"ng-container",2),x.qZA()),2&t){var n=x.oxw();x.xp6(3),x.Q6J("ngIf",n.searching),x.xp6(2),x.AsE("",n.current.pos+1," / ",n.folders.length,""),x.xp6(1),x.Q6J("routerLink",x.VKq(6,sn,n.current.folder.id)),x.xp6(2),x.hij(" ",n.current.folder.name,""),x.xp6(1),x.Q6J("ngIf",n.current.health)}}var ln=function(){var t=function(){function t(e,n,i,o,r,a){var s=this;c(this,t),this.app=e,this.jam=n,this.notify=i,this.uiState=o,this.folderService=r,this.userStorage=a,this.searching=!1,this.unsubscribe=new y.xQ,a.userChange.pipe((0,b.R)(this.unsubscribe)).subscribe(function(t){s.loadFromStorage()})}return d(t,[{key:"trackHealthResolved",value:function(t){this.current&&this.current.health&&(this.current.health=this.current.health.filter(function(e){return e!==t}))}},{key:"trackByFn",value:function(t,e){return e.track.id}},{key:"stop",value:function(){this.searching=!1}},{key:"start",value:function(){this.searching||!this.folders||(this.searching=!0,this.request())}},{key:"request",value:function(){if(this.searching){var t=0;this.current&&(t=this.current.pos+1),this.refresh(t,!0)}}},{key:"fixAll",value:function(){this.searching||!this.current||!this.trackHealthComponents||this.trackHealthComponents.forEach(function(t){t.fixAll()})}},{key:"refresh",value:function(e,n){var i=this;this.current=void 0,this.searching=!0;var o=this.folders&&this.folders[e];if(o){var r={folder:o,pos:e};this.current=r,this.userStorage.set(t.localStorageName,{folderID:o.id}),this.jam.track.health({folderIDs:[o.id],healthMedia:!0}).then(function(t){t.length>0?(r.health=t,i.searching=!1):n?i.request():(r.health=[],i.searching=!1)}).catch(function(t){i.current=void 0,i.searching=!1,i.notify.error(t)})}else this.searching=!1}},{key:"ngOnInit",value:function(){var t=this.uiState.data["app-admin-radar"];t&&(this.folders=t.folders,this.current=t.current,this.folders)||this.loadFolders()}},{key:"ngOnDestroy",value:function(){this.uiState.data["app-admin-radar"]={folders:this.folders,current:this.current},this.current=void 0,this.searching=!1,this.folders=void 0,this.unsubscribe.next(),this.unsubscribe.complete()}},{key:"loadFromStorage",value:function(){var e=this.userStorage.get(t.localStorageName);if((null==e?void 0:e.folderID)&&this.folders){var n=this.folders.findIndex(function(t){return t.id===e.folderID});n>=0&&(this.current={folder:this.folders[n],pos:n},this.refresh(n,!1))}}},{key:"loadFolders",value:function(){var t=this;this.jam.folder.search({folderTypes:[w.Sr.album,w.Sr.multialbum]}).then(function(e){t.folders=e.items,t.loadFromStorage()}).catch(function(e){t.notify.error(e)})}}]),t}();return t.localStorageName="admin.radar",t.\u0275fac=function(e){return new(e||t)(x.Y36(P.zi),x.Y36(w.K4),x.Y36(P.c),x.Y36(P.JU),x.Y36(P.Cr),x.Y36(P.TZ))},t.\u0275cmp=x.Xpm({type:t,selectors:[["app-admin-radar"]],viewQuery:function(t,e){var n;(1&t&&x.Gf(Fe,5),2&t)&&(x.iGM(n=x.CRH())&&(e.trackHealthComponents=n))},decls:6,vars:3,consts:[[1,"radar"],["section","Health Radar"],[4,"ngIf"],[1,"content"],["class","buttons",4,"ngIf"],[1,"buttons"],[1,"button-primary",3,"click"],[1,"icon-play"],["class","button-on-control",3,"click",4,"ngIf"],[1,"button-on-control",3,"click"],[1,"icon-reload"],[1,"icon-stop"],[1,"current"],["class","icon-spin icon-spinner",4,"ngIf"],[3,"routerLink"],[1,"icon-folder"],[1,"icon-spin","icon-spinner"],["class","track",4,"ngFor","ngForOf","ngForTrackBy"],[1,"track"],[1,"meta"],[1,"track-health"],[3,"trackHealth","resolvedEvent"]],template:function(t,e){1&t&&(x.TgZ(0,"div",0),x.TgZ(1,"app-view-header-slim",1),x.YNc(2,en,3,2,"ng-container",2),x.qZA(),x.TgZ(3,"div",3),x.YNc(4,nn,1,0,"app-loading",2),x.YNc(5,cn,10,8,"div",2),x.qZA(),x.qZA()),2&t&&(x.xp6(2),x.Q6J("ngIf",e.folders),x.xp6(2),x.Q6J("ngIf",!e.folders),x.xp6(1),x.Q6J("ngIf",e.folders&&e.current))},directives:[$e.p,g.O5,et.N,O.yS,g.sg,Fe],styles:["[_nghost-%COMP%]{height:100%;width:100%;overflow-y:auto;overflow-x:auto;display:block}[_nghost-%COMP%]   .radar[_ngcontent-%COMP%]{display:flex;flex-direction:column}[_nghost-%COMP%]   .radar[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{padding:15px}[_nghost-%COMP%]   .radar[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]{min-width:130px;display:inline-block}[_nghost-%COMP%]   .radar[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{margin-right:5px}[_nghost-%COMP%]   .radar[_ngcontent-%COMP%]   .current[_ngcontent-%COMP%]{padding-top:15px;padding-bottom:15px;border-bottom:1px solid var(--background-border)}[_nghost-%COMP%]   .radar[_ngcontent-%COMP%]   .current[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{padding-right:15px}[_nghost-%COMP%]   .radar[_ngcontent-%COMP%]   .track[_ngcontent-%COMP%]{border-bottom:1px solid var(--background-border)}[_nghost-%COMP%]   .radar[_ngcontent-%COMP%]   .track[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]{padding-top:15px;padding-bottom:15px}[_nghost-%COMP%]   .radar[_ngcontent-%COMP%]   .track[_ngcontent-%COMP%]   .track-health[_ngcontent-%COMP%]{padding-left:15px}@media (max-width: 768px){[_nghost-%COMP%]   .radar[_ngcontent-%COMP%]   .current[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block}[_nghost-%COMP%]   .radar[_ngcontent-%COMP%]   .track[_ngcontent-%COMP%]   .track-health[_ngcontent-%COMP%]{padding-left:0}}"]}),t}(),dn=function(){return{standalone:!0}};function un(t,e){if(1&t){var n=x.EpF();x.TgZ(0,"form"),x.TgZ(1,"div",1),x.TgZ(2,"label",2),x._uU(3,"Root name"),x.qZA(),x.TgZ(4,"input",3),x.NdJ("ngModelChange",function(t){return x.CHM(n),x.oxw().edit.name=t}),x.qZA(),x.qZA(),x.TgZ(5,"div",1),x.TgZ(6,"label",4),x._uU(7,"Path"),x.qZA(),x.TgZ(8,"input",5),x.NdJ("ngModelChange",function(t){return x.CHM(n),x.oxw().edit.path=t}),x.qZA(),x.qZA(),x.TgZ(9,"div",1),x.TgZ(10,"label",6),x._uU(11,"Scan Strategy"),x.qZA(),x.TgZ(12,"fieldset",7),x.TgZ(13,"label",8),x.TgZ(14,"input",9),x.NdJ("ngModelChange",function(t){return x.CHM(n),x.oxw().edit.strategy=t}),x.qZA(),x._uU(15," Auto"),x.qZA(),x.TgZ(16,"label",8),x.TgZ(17,"input",9),x.NdJ("ngModelChange",function(t){return x.CHM(n),x.oxw().edit.strategy=t}),x.qZA(),x._uU(18," Artist/Album"),x.qZA(),x.TgZ(19,"label",8),x.TgZ(20,"input",9),x.NdJ("ngModelChange",function(t){return x.CHM(n),x.oxw().edit.strategy=t}),x.qZA(),x._uU(21," Compilations"),x.qZA(),x.TgZ(22,"label",8),x.TgZ(23,"input",9),x.NdJ("ngModelChange",function(t){return x.CHM(n),x.oxw().edit.strategy=t}),x.qZA(),x._uU(24," Audiobook"),x.qZA(),x.qZA(),x.qZA(),x.qZA()}if(2&t){var i=x.oxw();x.xp6(4),x.Q6J("ngModel",i.edit.name)("ngModelOptions",x.DdM(12,dn)),x.xp6(4),x.Q6J("ngModel",i.edit.path)("ngModelOptions",x.DdM(13,dn)),x.xp6(6),x.Q6J("ngModel",i.edit.strategy)("value",i.RootScanStrategy.auto),x.xp6(3),x.Q6J("ngModel",i.edit.strategy)("value",i.RootScanStrategy.artistalbum),x.xp6(3),x.Q6J("ngModel",i.edit.strategy)("value",i.RootScanStrategy.compilation),x.xp6(3),x.Q6J("ngModel",i.edit.strategy)("value",i.RootScanStrategy.audiobook)}}var gn=function(){var t=function(){function t(){c(this,t),this.RootScanStrategy=w.hy}return d(t,[{key:"dialogInit",value:function(t,e){this.edit=e.data}}]),t}();return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=x.Xpm({type:t,selectors:[["app-dialog-root"]],decls:1,vars:1,consts:[[4,"ngIf"],[1,"root-form-control"],["for","root-name"],["id","root-name","type","text",3,"ngModel","ngModelOptions","ngModelChange"],["for","root-path"],["id","root-path","type","text",3,"ngModel","ngModelOptions","ngModelChange"],["for","strategy"],["id","strategy"],[1,"select"],["type","radio","name","strategy",3,"ngModel","value","ngModelChange"]],template:function(t,e){1&t&&x.YNc(0,un,25,14,"form",0),2&t&&x.Q6J("ngIf",e.edit)},directives:[g.O5,h._Y,h.JL,h.F,h.Fj,h.JJ,h.On,h._],styles:["[_nghost-%COMP%]   input[type=text][_ngcontent-%COMP%]{width:100%;line-height:1.3em;padding:5px;min-width:300px}[_nghost-%COMP%]   input[type=radio][_ngcontent-%COMP%]{margin-right:5px}[_nghost-%COMP%]   .root-form-control[_ngcontent-%COMP%]{margin-bottom:8px;display:block}[_nghost-%COMP%]   .select[_ngcontent-%COMP%]{margin-right:15px;display:block;font-size:.8em;line-height:1.5em}"]}),t}(),hn=s(79178);function pn(t,e){1&t&&(x.TgZ(0,"span"),x._uU(1,"Not scanned"),x.qZA())}function fn(t,e){if(1&t&&(x.TgZ(0,"span",22),x._uU(1,"Error:"),x._UZ(2,"br"),x._uU(3),x.qZA()),2&t){var n=x.oxw().$implicit;x.xp6(3),x.Oqu(n.status.error)}}function mn(t,e){1&t&&(x.ynx(0),x._uU(1,"Working\u2026"),x.BQk())}function vn(t,e){if(1&t&&(x.ynx(0),x._uU(1,"Last Change:"),x._UZ(2,"br"),x._uU(3),x.ALo(4,"date"),x.BQk()),2&t){var n=x.oxw(2).$implicit;x.xp6(3),x.Oqu(x.xi3(4,1,n.status.lastScan,"medium"))}}function Mn(t,e){if(1&t&&(x.TgZ(0,"span"),x.YNc(1,mn,2,0,"ng-container",11),x.YNc(2,vn,5,4,"ng-container",11),x.qZA()),2&t){var n=x.oxw().$implicit;x.xp6(1),x.Q6J("ngIf",n.status.scanning),x.xp6(1),x.Q6J("ngIf",!n.status.scanning)}}function xn(t,e){if(1&t){var n=x.EpF();x.TgZ(0,"tr",10),x.NdJ("dblclick",function(){var t=x.CHM(n).$implicit;return x.oxw(2).editRoot(t)})("keydown.enter",function(){var t=x.CHM(n).$implicit;return x.oxw(2).editRoot(t)}),x.TgZ(1,"td",4),x._uU(2),x.qZA(),x.TgZ(3,"td",5),x._uU(4),x.qZA(),x.TgZ(5,"td",6),x._uU(6),x.qZA(),x.TgZ(7,"td",7),x.YNc(8,pn,2,0,"span",11),x.YNc(9,fn,4,1,"span",12),x.YNc(10,Mn,3,2,"span",11),x.qZA(),x.TgZ(11,"td",8),x.TgZ(12,"div",13),x.TgZ(13,"button",14),x.NdJ("click",function(){var t=x.CHM(n).$implicit;return x.oxw(2).refreshRoot(t)}),x._UZ(14,"i",15),x.qZA(),x.TgZ(15,"button",16),x.NdJ("click",function(){var t=x.CHM(n).$implicit;return x.oxw(2).refreshRootMeta(t)}),x._UZ(16,"i",17),x.qZA(),x.TgZ(17,"button",18),x.NdJ("click",function(){var t=x.CHM(n).$implicit;return x.oxw(2).editRoot(t)}),x._UZ(18,"i",19),x.qZA(),x.TgZ(19,"button",20),x.NdJ("click",function(){var t=x.CHM(n).$implicit;return x.oxw(2).deleteRoot(t)}),x._UZ(20,"i",21),x.qZA(),x.qZA(),x.qZA(),x.qZA()}if(2&t){var i=e.$implicit;x.xp6(2),x.Oqu(i.name),x.xp6(2),x.Oqu(i.path),x.xp6(2),x.Oqu(i.strategy),x.xp6(2),x.Q6J("ngIf",!i.status),x.xp6(1),x.Q6J("ngIf",i.status&&i.status.error),x.xp6(1),x.Q6J("ngIf",i.status&&!i.status.error)}}function Cn(t,e){if(1&t&&(x.TgZ(0,"table",2),x.TgZ(1,"tr",3),x.TgZ(2,"td",4),x._uU(3,"Name"),x.qZA(),x.TgZ(4,"td",5),x._uU(5,"Path"),x.qZA(),x.TgZ(6,"td",6),x._uU(7,"Strategy"),x.qZA(),x.TgZ(8,"td",7),x._uU(9,"Status"),x.qZA(),x.TgZ(10,"td",8),x._uU(11,"Actions"),x.qZA(),x.qZA(),x.YNc(12,xn,21,6,"tr",9),x.qZA()),2&t){var n=x.oxw();x.xp6(12),x.Q6J("ngForOf",n.roots)}}var _n=function(){var t=function(){function t(e,n,i,o,r,a,s){c(this,t),this.router=e,this.route=n,this.app=i,this.notify=o,this.dialogs=r,this.rootService=a,this.dialogOverlay=s,this.roots=[]}return d(t,[{key:"refreshRoot",value:function(t){this.rootService.rescanRoot(t)}},{key:"refreshRootMeta",value:function(t){this.rootService.refreshRootMeta(t)}},{key:"editRoot",value:function(t){var e=this,n={root:t,name:t.name,path:t.path,strategy:t.strategy};this.dialogOverlay.open({title:"Edit Root",childComponent:gn,data:n,onOkBtn:function(){return(0,_.mG)(e,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.rootService.applyDialogRoot(n);case 3:t.next=8;break;case 5:return t.prev=5,t.t0=t.catch(0),t.abrupt("return",(this.notify.error(t.t0),Promise.reject(t.t0)));case 8:case"end":return t.stop()}},t,this,[[0,5]])}))},onCancelBtn:function(){return(0,_.mG)(e,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Promise.resolve());case 1:case"end":return t.stop()}},t)}))}})}},{key:"deleteRoot",value:function(t){var e=this;this.dialogs.confirm("Delete Root","Do you want to the delete the root folder?",function(){e.rootService.removeRoot(t)})}}]),t}();return t.\u0275fac=function(e){return new(e||t)(x.Y36(O.F0),x.Y36(O.gz),x.Y36(P.zi),x.Y36(P.c),x.Y36(K.Hr),x.Y36(P.Nb),x.Y36(tt.SL))},t.\u0275cmp=x.Xpm({type:t,selectors:[["app-admin-root-list"]],inputs:{roots:"roots"},decls:2,vars:2,consts:[["name","Roots",3,"list"],["class","roots","appFocusKeyList","",4,"ngIf"],["appFocusKeyList","",1,"roots"],[1,"root","heading"],[1,"title"],[1,"path"],[1,"strategy"],[1,"status"],[1,"actions"],["class","root","appFocusKeyListItem","",3,"dblclick","keydown.enter",4,"ngFor","ngForOf"],["appFocusKeyListItem","",1,"root",3,"dblclick","keydown.enter"],[4,"ngIf"],["class","error",4,"ngIf"],[1,"action-buttons"],["title","Rescan Root","appClickStop","",3,"click"],["aria-hidden","true",1,"icon-rescan"],["title","Refresh Root Meta","appClickStop","",3,"click"],["aria-hidden","true",1,"icon-broom"],["title","Edit Root","appClickStop","",3,"click"],["aria-hidden","true",1,"icon-edit"],["title","Delete Root","appClickStop","",3,"click"],["aria-hidden","true",1,"icon-remove"],[1,"error"]],template:function(t,e){1&t&&(x._UZ(0,"app-background-text-list",0),x.YNc(1,Cn,13,1,"table",1)),2&t&&(x.Q6J("list",e.roots),x.xp6(1),x.Q6J("ngIf",e.roots&&e.roots.length>0))},directives:[nt.$,g.O5,Z.R,g.sg,A.j,hn.D],pipes:[g.uU],styles:["[_nghost-%COMP%]{width:100%;overflow:auto;display:block}[_nghost-%COMP%]   .roots[_ngcontent-%COMP%]{padding:15px;font-size:.9em;width:100%}[_nghost-%COMP%]   .root[_ngcontent-%COMP%]{height:60px;border-bottom:1px solid var(--control-border)}[_nghost-%COMP%]   .root[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:5px 10px}[_nghost-%COMP%]   .root[_ngcontent-%COMP%]:hover{background-color:var(--background-hover)}[_nghost-%COMP%]   .root.selected[_ngcontent-%COMP%]{background-color:var(--background-active)}[_nghost-%COMP%]   .error[_ngcontent-%COMP%]{color:var(--accent)}[_nghost-%COMP%]   .heading[_ngcontent-%COMP%]{height:40px;font-size:.9em}[_nghost-%COMP%]   .actions[_ngcontent-%COMP%]{width:100px}[_nghost-%COMP%]   .action-buttons[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}[_nghost-%COMP%]   .action-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:5px;flex:50%;margin:0;display:inline-block;color:var(--on-control);border:1px solid transparent}[_nghost-%COMP%]   .action-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{color:var(--on-control-active);border:1px solid var(--control-active)}"]}),t}(),On=function(){var t=function(){function t(e,n,i,o,r,a,s){c(this,t),this.router=e,this.route=n,this.app=i,this.notify=o,this.dialogs=r,this.rootService=a,this.dialogOverlay=s,this.unsubscribe=new y.xQ}return d(t,[{key:"ngOnInit",value:function(){var t=this;this.rootService.rootsChange.pipe((0,b.R)(this.unsubscribe)).subscribe(function(e){t.roots=(e||[]).sort(function(t,e){return t.name.localeCompare(e.name)})},function(e){t.notify.error(e)}),this.rootService.refreshRoots()}},{key:"ngOnDestroy",value:function(){this.unsubscribe.next(),this.unsubscribe.complete()}},{key:"refresh",value:function(){this.rootService.refreshRoots()}},{key:"newRoot",value:function(){var t=this,e={name:"",path:"",strategy:w.hy.auto};this.dialogOverlay.open({title:"New Root",childComponent:gn,data:e,onOkBtn:function(){return(0,_.mG)(t,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.rootService.applyDialogRoot(e);case 3:t.next=8;break;case 5:return t.prev=5,t.t0=t.catch(0),t.abrupt("return",(this.notify.error(t.t0),Promise.reject(t.t0)));case 8:case"end":return t.stop()}},t,this,[[0,5]])}))},onCancelBtn:function(){return(0,_.mG)(t,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Promise.resolve());case 1:case"end":return t.stop()}},t)}))}})}},{key:"refreshRoots",value:function(){this.rootService.rescanRoots()}}],[{key:"getSortValue",value:function(t,e){switch(t){case"name":return e.name;case"path":return e.path;default:return}}}]),t}();return t.\u0275fac=function(e){return new(e||t)(x.Y36(O.F0),x.Y36(O.gz),x.Y36(P.zi),x.Y36(P.c),x.Y36(K.Hr),x.Y36(P.Nb),x.Y36(tt.SL))},t.\u0275cmp=x.Xpm({type:t,selectors:[["app-admin-root"]],decls:11,vars:1,consts:[[1,"roots"],["section","Roots"],[1,"actions"],["title","Refresh",1,"button-on-control",3,"click"],[1,"icon-reload"],["title","New Root\u2026",1,"button-on-control",3,"click"],[1,"icon-plus"],["title","Rescan all Roots",1,"button-on-control",3,"click"],[1,"icon-rescan"],[1,"content"],[3,"roots"]],template:function(t,e){1&t&&(x.TgZ(0,"div",0),x.TgZ(1,"app-view-header-slim",1),x.TgZ(2,"div",2),x.TgZ(3,"button",3),x.NdJ("click",function(){return e.refresh()}),x._UZ(4,"i",4),x.qZA(),x.TgZ(5,"button",5),x.NdJ("click",function(){return e.newRoot()}),x._UZ(6,"i",6),x.qZA(),x.TgZ(7,"button",7),x.NdJ("click",function(){return e.refreshRoots()}),x._UZ(8,"i",8),x.qZA(),x.qZA(),x.qZA(),x.TgZ(9,"div",9),x._UZ(10,"app-admin-root-list",10),x.qZA(),x.qZA()),2&t&&(x.xp6(10),x.Q6J("roots",e.roots))},directives:[$e.p,_n],styles:["[_nghost-%COMP%]{height:100%;width:100%;overflow-y:auto;overflow-x:auto;display:block}[_nghost-%COMP%]   .roots[_ngcontent-%COMP%]{height:100%;overflow-y:auto;overflow-x:hidden}[_nghost-%COMP%]   .roots[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{margin-right:5px;margin-bottom:10px}"]}),t}();function yn(t,e){1&t&&x._UZ(0,"app-loading")}function bn(t,e){if(1&t){var n=x.EpF();x.ynx(0),x.TgZ(1,"div"),x.TgZ(2,"div",6),x._uU(3,"Server"),x.qZA(),x.TgZ(4,"div",7),x.TgZ(5,"label"),x.TgZ(6,"input",8),x.NdJ("ngModelChange",function(t){return x.CHM(n),x.oxw().settings.library.scanAtStart=t})("ngModelChange",function(){return x.CHM(n),x.oxw().onChange()}),x.qZA(),x._uU(7," Scan all Roots on Server Start "),x.qZA(),x.qZA(),x.qZA(),x.TgZ(8,"div"),x.TgZ(9,"div",6),x._uU(10,"External Services"),x.qZA(),x.TgZ(11,"div",7),x.TgZ(12,"label"),x.TgZ(13,"input",9),x.NdJ("ngModelChange",function(t){return x.CHM(n),x.oxw().settings.externalServices.enabled=t})("ngModelChange",function(){return x.CHM(n),x.oxw().onChange()}),x.qZA(),x._uU(14," Allow Request to External Services "),x.qZA(),x.qZA(),x.qZA(),x.TgZ(15,"div"),x.TgZ(16,"div",6),x._uU(17,"Chat"),x.qZA(),x.TgZ(18,"div",7),x.TgZ(19,"label",10),x._uU(20,"Maximum Number of Messages"),x.qZA(),x.TgZ(21,"input",11),x.NdJ("ngModelChange",function(t){return x.CHM(n),x.oxw().settings.chat.maxMessages=t})("ngModelChange",function(){return x.CHM(n),x.oxw().onChange()}),x.qZA(),x.qZA(),x.TgZ(22,"div",7),x.TgZ(23,"div",12),x.TgZ(24,"label",13),x._uU(25,"Maximum Age of Message"),x.qZA(),x.TgZ(26,"input",14),x.NdJ("ngModelChange",function(t){return x.CHM(n),x.oxw().settings.chat.maxAge.value=t})("ngModelChange",function(){return x.CHM(n),x.oxw().onChange()}),x.qZA(),x.qZA(),x.TgZ(27,"select",15),x.NdJ("ngModelChange",function(t){return x.CHM(n),x.oxw().settings.chat.maxAge.unit=t})("ngModelChange",function(){return x.CHM(n),x.oxw().onChange()}),x.TgZ(28,"option",16),x._uU(29,"year"),x.qZA(),x.TgZ(30,"option",16),x._uU(31,"years"),x.qZA(),x.TgZ(32,"option",16),x._uU(33,"month"),x.qZA(),x.TgZ(34,"option",16),x._uU(35,"months"),x.qZA(),x.TgZ(36,"option",16),x._uU(37,"day"),x.qZA(),x.TgZ(38,"option",16),x._uU(39,"days"),x.qZA(),x.TgZ(40,"option",16),x._uU(41,"minute"),x.qZA(),x.TgZ(42,"option",16),x._uU(43,"minutes"),x.qZA(),x.TgZ(44,"option",16),x._uU(45,"second"),x.qZA(),x.TgZ(46,"option",16),x._uU(47,"seconds"),x.qZA(),x.qZA(),x.qZA(),x.qZA(),x.TgZ(48,"div"),x.TgZ(49,"div",6),x._uU(50,"Artist Index"),x.qZA(),x.TgZ(51,"div",7),x.TgZ(52,"label",17),x._uU(53,"Ignored Articles in Artist Names"),x.qZA(),x.TgZ(54,"textarea",18),x.NdJ("ngModelChange",function(t){return x.CHM(n),x.oxw().ignoreArticles=t})("ngModelChange",function(){return x.CHM(n),x.oxw().onChange()}),x.qZA(),x.qZA(),x.qZA(),x.BQk()}if(2&t){var i=x.oxw();x.xp6(6),x.Q6J("ngModel",i.settings.library.scanAtStart),x.xp6(7),x.Q6J("ngModel",i.settings.externalServices.enabled),x.xp6(8),x.Q6J("ngModel",i.settings.chat.maxMessages),x.xp6(5),x.Q6J("ngModel",i.settings.chat.maxAge.value),x.xp6(1),x.Q6J("ngModel",i.settings.chat.maxAge.unit),x.xp6(1),x.Q6J("value","year"),x.xp6(2),x.Q6J("value","years"),x.xp6(2),x.Q6J("value","month"),x.xp6(2),x.Q6J("value","months"),x.xp6(2),x.Q6J("value","day"),x.xp6(2),x.Q6J("value","days"),x.xp6(2),x.Q6J("value","minute"),x.xp6(2),x.Q6J("value","minutes"),x.xp6(2),x.Q6J("value","second"),x.xp6(2),x.Q6J("value","seconds"),x.xp6(8),x.Q6J("ngModel",i.ignoreArticles)}}var kn=function(){var t=function(){function t(e,n,i){c(this,t),this.app=e,this.jam=n,this.notify=i,this.ignoreArticles=""}return d(t,[{key:"ngOnInit",value:function(){this.refresh()}},{key:"onChange",value:function(){}},{key:"refresh",value:function(){var t=this;this.jam.admin.settings().then(function(e){t.display(e)}).catch(function(e){t.notify.error(e)})}},{key:"save",value:function(){var t=this,e=this.settings;!e||(e.index.ignoreArticles=this.ignoreArticles.split("\n").map(function(t){return t.trim()}).filter(function(t){return t.length>0}),this.settings=void 0,this.jam.admin.settingsUpdate(e).then(function(){t.notify.success("Settings updated"),t.settings=e}).catch(function(n){t.notify.error(n),t.settings=e}))}},{key:"display",value:function(t){this.settings=t,this.ignoreArticles=t.index.ignoreArticles.join("\n")}}]),t}();return t.\u0275fac=function(e){return new(e||t)(x.Y36(P.zi),x.Y36(w.K4),x.Y36(P.c))},t.\u0275cmp=x.Xpm({type:t,selectors:[["app-admin-settings"]],decls:8,vars:2,consts:[[1,"settings"],["section","Admin Settings"],["title","Save",1,"button-on-control",3,"click"],[1,"icon-floppy"],[1,"content"],[4,"ngIf"],[1,"section-title"],[1,"section-entry"],["type","checkbox","title","Scan all Roots on Server Start",3,"ngModel","ngModelChange"],["type","checkbox","title","Allow Request to External Services",3,"ngModel","ngModelChange"],["for","max_messages"],["id","max_messages","type","number",3,"ngModel","ngModelChange"],[1,"chat-max-age"],["for","max_age"],["id","max_age","type","number",3,"ngModel","ngModelChange"],["placeholder","Unit of Age",3,"ngModel","ngModelChange"],[3,"value"],["for","ignore_articles"],["id","ignore_articles","rows","10","cols","20",3,"ngModel","ngModelChange"]],template:function(t,e){1&t&&(x.TgZ(0,"div",0),x.TgZ(1,"app-view-header-slim",1),x.TgZ(2,"button",2),x.NdJ("click",function(){return e.save()}),x._UZ(3,"i",3),x._uU(4," Save Settings"),x.qZA(),x.qZA(),x.TgZ(5,"div",4),x.YNc(6,yn,1,0,"app-loading",5),x.YNc(7,bn,55,16,"ng-container",5),x.qZA(),x.qZA()),2&t&&(x.xp6(6),x.Q6J("ngIf",!e.settings),x.xp6(1),x.Q6J("ngIf",e.settings))},directives:[$e.p,g.O5,et.N,h.Wl,h.JJ,h.On,h.wV,h.Fj,h.EJ,h.YN,h.Kr],styles:["[_nghost-%COMP%]   .settings[_ngcontent-%COMP%]{overflow-y:auto;overflow-x:hidden;height:100%}[_nghost-%COMP%]   .settings[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{padding:15px 15px 0}[_nghost-%COMP%]   .settings[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .chat-max-age[_ngcontent-%COMP%]{display:inline-block}[_nghost-%COMP%]   .settings[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .section-entry[_ngcontent-%COMP%]{padding-bottom:15px}[_nghost-%COMP%]   .settings[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-size:12px;padding-bottom:3px}[_nghost-%COMP%]   .settings[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{margin-top:-1px;display:inline-block;vertical-align:middle}"]}),t}(),Pn=function(){var t=function t(){c(this,t)};return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=x.Xpm({type:t,selectors:[["app-admin-start"]],decls:4,vars:0,consts:[[1,"start"],["section","Administration"],[1,"content"]],template:function(t,e){1&t&&(x.TgZ(0,"div",0),x._UZ(1,"app-view-header-slim",1),x.TgZ(2,"div",2),x._UZ(3,"app-admin-section-cards"),x.qZA(),x.qZA())},styles:["[_nghost-%COMP%]{height:100%;width:100%;overflow-y:auto;overflow-x:auto;display:block}[_nghost-%COMP%]   .start[_ngcontent-%COMP%]{height:100%;overflow-y:auto;overflow-x:hidden}"]}),t}(),wn=function(){return{standalone:!0}};function Zn(t,e){if(1&t){var n=x.EpF();x.TgZ(0,"div"),x.TgZ(1,"form"),x.TgZ(2,"div",1),x.TgZ(3,"label",2),x._uU(4,"Name"),x.qZA(),x.TgZ(5,"input",3),x.NdJ("ngModelChange",function(t){return x.CHM(n),x.oxw().edit.edit.name=t}),x.qZA(),x.qZA(),x.TgZ(6,"div",1),x.TgZ(7,"label",4),x._uU(8,"Email"),x.qZA(),x.TgZ(9,"input",5),x.NdJ("ngModelChange",function(t){return x.CHM(n),x.oxw().edit.edit.email=t}),x.qZA(),x.qZA(),x.TgZ(10,"div",6),x._uU(11,"Roles"),x.qZA(),x.TgZ(12,"div",7),x.TgZ(13,"label"),x.TgZ(14,"input",8),x.NdJ("ngModelChange",function(t){return x.CHM(n),x.oxw().edit.edit.roleAdmin=t}),x.qZA(),x._uU(15," Administrator "),x.qZA(),x._UZ(16,"br"),x.TgZ(17,"label"),x.TgZ(18,"input",9),x.NdJ("ngModelChange",function(t){return x.CHM(n),x.oxw().edit.edit.rolePodcast=t}),x.qZA(),x._uU(19," Manage Podcasts "),x.qZA(),x._UZ(20,"br"),x.TgZ(21,"label"),x.TgZ(22,"input",9),x.NdJ("ngModelChange",function(t){return x.CHM(n),x.oxw().edit.edit.roleStream=t}),x.qZA(),x._uU(23," Can Stream/Download "),x.qZA(),x._UZ(24,"br"),x.TgZ(25,"label"),x.TgZ(26,"input",10),x.NdJ("ngModelChange",function(t){return x.CHM(n),x.oxw().edit.edit.roleUpload=t}),x.qZA(),x._uU(27," Can Upload "),x.qZA(),x.qZA(),x._UZ(28,"hr"),x.TgZ(29,"div",1),x._UZ(30,"input",11,12),x.TgZ(32,"label",13),x._uU(33,"Your Admin Password"),x.qZA(),x.TgZ(34,"input",14),x.NdJ("ngModelChange",function(t){return x.CHM(n),x.oxw().edit.edit.password=t}),x.qZA(),x.qZA(),x.qZA(),x.qZA()}if(2&t){var i=x.oxw();x.xp6(5),x.Q6J("ngModel",i.edit.edit.name)("ngModelOptions",x.DdM(14,wn)),x.xp6(4),x.Q6J("ngModel",i.edit.edit.email)("ngModelOptions",x.DdM(15,wn)),x.xp6(5),x.Q6J("ngModel",i.edit.edit.roleAdmin)("ngModelOptions",x.DdM(16,wn)),x.xp6(4),x.Q6J("ngModel",i.edit.edit.rolePodcast)("ngModelOptions",x.DdM(17,wn)),x.xp6(4),x.Q6J("ngModel",i.edit.edit.roleStream)("ngModelOptions",x.DdM(18,wn)),x.xp6(4),x.Q6J("ngModel",i.edit.edit.roleUpload)("ngModelOptions",x.DdM(19,wn)),x.xp6(8),x.Q6J("ngModel",i.edit.edit.password)("ngModelOptions",x.DdM(20,wn))}}var An=function(){var t=function(){function t(){c(this,t)}return d(t,[{key:"dialogInit",value:function(t,e){this.edit=e.data}}]),t}();return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=x.Xpm({type:t,selectors:[["app-dialog-user"]],decls:1,vars:1,consts:[[4,"ngIf"],[1,"user-form-control"],["for","user-name"],["id","user-name","type","text","name","username",3,"ngModel","ngModelOptions","ngModelChange"],["for","user-mail"],["id","user-mail","type","email","name","mail",3,"ngModel","ngModelOptions","ngModelChange"],[1,"user-form-section"],[1,"user-form-roles"],["type","checkbox","title","Allow User to administrate",3,"ngModel","ngModelOptions","ngModelChange"],["type","checkbox","title","Allow User to manage podcasts",3,"ngModel","ngModelOptions","ngModelChange"],["type","checkbox","title","Allow User to upload files",3,"ngModel","ngModelOptions","ngModelChange"],["type","text","name","user","autocomplete","username",1,"dummy"],["name",""],["for","admin-pass",1,"label-pass"],["id","admin-pass","name","pass","type","password","autocomplete","password",3,"ngModel","ngModelOptions","ngModelChange"]],template:function(t,e){1&t&&x.YNc(0,Zn,35,21,"div",0),2&t&&x.Q6J("ngIf",e.edit)},directives:[g.O5,h._Y,h.JL,h.F,h.Fj,h.JJ,h.On,h.Wl],styles:["[_nghost-%COMP%] > div[_ngcontent-%COMP%]{margin-left:15px;margin-right:15px}[_nghost-%COMP%]   input[type=text][_ngcontent-%COMP%], [_nghost-%COMP%]   input[type=email][_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]   input[_ngcontent-%COMP%]{line-height:1.3em;padding:5px}[_nghost-%COMP%]   .label-pass[_ngcontent-%COMP%]{padding-right:15px;font-size:.8em}[_nghost-%COMP%]   .dummy[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .user-form-control[_ngcontent-%COMP%]{margin-bottom:8px;display:block}[_nghost-%COMP%]   .user-form-roles[_ngcontent-%COMP%]{margin-bottom:10px}[_nghost-%COMP%]   .user-form-roles[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{line-height:1.5em}"]}),t}(),Tn=s(69100),In=function(){var t=function(){function t(e,n){c(this,t),this.jam=e,this.notify=n,this.hasChanged=!1,this.unsubscribe=new y.xQ}return d(t,[{key:"ngOnDestroy",value:function(){this.unsubscribe.next(),this.unsubscribe.complete()}},{key:"dialogInit",value:function(t,e){this.user=e.data,this.setImageSource()}},{key:"dialogResult",value:function(){return this.hasChanged}},{key:"setImageSource",value:function(){this.userAvatar=this.user?"".concat(this.jam.image.imageUrl({id:this.user.id,size:60,format:w.GU.webp}),"?").concat((0,Tn.O)()):void 0}},{key:"onDropFile",value:function(t){var e;t.preventDefault(),this.uploadFile(null===(e=t.dataTransfer)||void 0===e?void 0:e.files)}},{key:"onDragOverFile",value:function(t){t.stopPropagation(),t.preventDefault()}},{key:"selectFile",value:function(t){this.uploadFile(t.target.files)}},{key:"uploadFile",value:function(t){var e=this;t&&0!==t.length&&this.user&&this.jam.user.uploadUserImage({id:this.user.id},t[0]).pipe((0,b.R)(this.unsubscribe)).subscribe(function(t){t.type===ft.dt.UploadProgress||t instanceof ft.Zn&&(e.setImageSource(),e.hasChanged=!0)},function(t){e.setImageSource(),e.notify.error(t)},function(){e.notify.success("Upload done")})}}]),t}();return t.\u0275fac=function(e){return new(e||t)(x.Y36(w.K4),x.Y36(P.c))},t.\u0275cmp=x.Xpm({type:t,selectors:[["app-dialog-avatar"]],decls:6,vars:1,consts:[[1,"drop-zone",3,"drop","dragover"],[1,"root-form-control"],["alt","User Avatar",3,"src"],["type","file","placeholder","Upload image","accept",".png,.jpeg,.jpg",3,"change"]],template:function(t,e){1&t&&(x.TgZ(0,"div",0),x.NdJ("drop",function(t){return e.onDropFile(t)})("dragover",function(t){return e.onDragOverFile(t)}),x.TgZ(1,"form"),x.TgZ(2,"div",1),x._UZ(3,"img",2),x.qZA(),x.qZA(),x.TgZ(4,"form"),x.TgZ(5,"input",3),x.NdJ("change",function(t){return e.selectFile(t)}),x.qZA(),x.qZA(),x.qZA()),2&t&&(x.xp6(3),x.Q6J("src",e.userAvatar,x.LSH))},directives:[h._Y,h.JL,h.F],styles:["[_nghost-%COMP%]   .drop-zone[_ngcontent-%COMP%]{margin:10px 20px;border-width:2px;border-style:dotted;border-color:var(--secondary)}[_nghost-%COMP%]   input[type=text][_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]   .root-form-control[_ngcontent-%COMP%]{margin-bottom:8px;display:block;text-align:center}"]}),t}(),qn=function(){return{standalone:!0}};function Sn(t,e){if(1&t){var n=x.EpF();x.TgZ(0,"div",1),x.TgZ(1,"form"),x._UZ(2,"input",2),x.TgZ(3,"label",3),x._uU(4,"Your Admin Password"),x.qZA(),x.TgZ(5,"input",4),x.NdJ("ngModelChange",function(t){return x.CHM(n),x.oxw().data.password=t}),x.qZA(),x.qZA(),x.TgZ(6,"form"),x._UZ(7,"input",5),x.TgZ(8,"label",6),x._uU(9,"New Password for User "),x.TgZ(10,"span"),x._uU(11),x.qZA(),x.qZA(),x.TgZ(12,"input",7),x.NdJ("ngModelChange",function(t){return x.CHM(n),x.oxw().data.newPassword=t}),x.qZA(),x.qZA(),x.qZA()}if(2&t){var i=x.oxw();x.xp6(5),x.Q6J("ngModel",i.data.password)("ngModelOptions",x.DdM(5,qn)),x.xp6(6),x.Oqu(i.data.user.name),x.xp6(1),x.Q6J("ngModel",i.data.newPassword)("ngModelOptions",x.DdM(6,qn))}}var Un=function(){var t=function(){function t(){c(this,t)}return d(t,[{key:"dialogInit",value:function(t,e){this.data=e.data}},{key:"dialogResult",value:function(){return!0}}]),t}();return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=x.Xpm({type:t,selectors:[["app-dialog-user-pass"]],decls:1,vars:1,consts:[["class","user-form-control",4,"ngIf"],[1,"user-form-control"],["type","text","name","user","autocomplete","username",1,"dummy"],["for","admin-pass"],["id","admin-pass","name","pass","type","password","autocomplete","current-password",3,"ngModel","ngModelOptions","ngModelChange"],["type","text","name","new_name",1,"dummy"],["for","new-pass"],["id","new-pass","name","new_password","autocomplete","off","type","password","autocomplete","new-password",3,"ngModel","ngModelOptions","ngModelChange"]],template:function(t,e){1&t&&x.YNc(0,Sn,13,7,"div",0),2&t&&x.Q6J("ngIf",e.data)},directives:[g.O5,h._Y,h.JL,h.F,h.Fj,h.JJ,h.On],styles:["[_nghost-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:10px}[_nghost-%COMP%]   label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:bold}[_nghost-%COMP%]   .dummy[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   input[_ngcontent-%COMP%]{line-height:1.3em;padding:5px;width:100%;margin-bottom:15px}"]}),t}(),Rn=s(97254);function Jn(t,e){1&t&&x._UZ(0,"i",22)}function Qn(t,e){1&t&&(x.TgZ(0,"span",23),x._uU(1,"Is Admin"),x.qZA())}function Nn(t,e){1&t&&x._UZ(0,"i",22)}function Fn(t,e){1&t&&(x.TgZ(0,"span",23),x._uU(1,"Can manage podcast"),x.qZA())}function Hn(t,e){1&t&&x._UZ(0,"i",22)}function zn(t,e){1&t&&(x.TgZ(0,"span",23),x._uU(1,"Can upload"),x.qZA())}function Yn(t,e){1&t&&x._UZ(0,"i",22)}function Dn(t,e){1&t&&(x.TgZ(0,"span",23),x._uU(1,"Can stream"),x.qZA())}function En(t,e){if(1&t){var n=x.EpF();x.TgZ(0,"tr",9),x.NdJ("dblclick",function(){var t=x.CHM(n).$implicit;return x.oxw(2).editUser(t)})("keydown.enter",function(){var t=x.CHM(n).$implicit;return x.oxw(2).editUser(t)}),x.TgZ(1,"td",3),x._UZ(2,"app-coverart-image",10),x.qZA(),x.TgZ(3,"td",4),x._uU(4),x.qZA(),x.TgZ(5,"td",5),x._uU(6),x.qZA(),x.TgZ(7,"td",6),x.YNc(8,Jn,1,0,"i",11),x.YNc(9,Qn,2,0,"span",12),x.qZA(),x.TgZ(10,"td",6),x.YNc(11,Nn,1,0,"i",11),x.YNc(12,Fn,2,0,"span",12),x.qZA(),x.TgZ(13,"td",6),x.YNc(14,Hn,1,0,"i",11),x.YNc(15,zn,2,0,"span",12),x.qZA(),x.TgZ(16,"td",6),x.YNc(17,Yn,1,0,"i",11),x.YNc(18,Dn,2,0,"span",12),x.qZA(),x.TgZ(19,"td",7),x.TgZ(20,"div",13),x.TgZ(21,"button",14),x.NdJ("click",function(){var t=x.CHM(n).$implicit;return x.oxw(2).editUserAvatar(t)}),x._UZ(22,"i",15),x.qZA(),x.TgZ(23,"button",16),x.NdJ("click",function(){var t=x.CHM(n).$implicit;return x.oxw(2).setUserPassword(t)}),x._UZ(24,"i",17),x.qZA(),x.TgZ(25,"button",18),x.NdJ("click",function(){var t=x.CHM(n).$implicit;return x.oxw(2).editUser(t)}),x._UZ(26,"i",19),x.qZA(),x.TgZ(27,"button",20),x.NdJ("click",function(){var t=x.CHM(n).$implicit;return x.oxw(2).deleteUser(t)}),x._UZ(28,"i",21),x.qZA(),x.qZA(),x.qZA(),x.qZA()}if(2&t){var i=e.$implicit;x.xp6(2),x.Q6J("coverArtObj",i)("alt",i.name)("size",28)("round",!0),x.xp6(2),x.Oqu(i.name),x.xp6(2),x.Oqu(i.email),x.xp6(2),x.Q6J("ngIf",i.roles.admin),x.xp6(1),x.Q6J("ngIf",i.roles.admin),x.xp6(2),x.Q6J("ngIf",i.roles.podcast),x.xp6(1),x.Q6J("ngIf",i.roles.admin),x.xp6(2),x.Q6J("ngIf",i.roles.upload),x.xp6(1),x.Q6J("ngIf",i.roles.admin),x.xp6(2),x.Q6J("ngIf",i.roles.stream),x.xp6(1),x.Q6J("ngIf",i.roles.stream)}}function jn(t,e){if(1&t&&(x.TgZ(0,"table",1),x.TgZ(1,"tr",2),x.TgZ(2,"td",3),x._uU(3,"Avatar"),x.qZA(),x.TgZ(4,"td",4),x._uU(5,"Name"),x.qZA(),x.TgZ(6,"td",5),x._uU(7,"Email"),x.qZA(),x.TgZ(8,"td",6),x._uU(9,"Administrator"),x.qZA(),x.TgZ(10,"td",6),x._uU(11,"Manage Podcasts"),x.qZA(),x.TgZ(12,"td",6),x._uU(13,"Can Upload"),x.qZA(),x.TgZ(14,"td",6),x._uU(15,"Can Stream"),x.qZA(),x.TgZ(16,"td",7),x._uU(17,"Actions"),x.qZA(),x.qZA(),x.YNc(18,En,29,14,"tr",8),x.qZA()),2&t){var n=x.oxw();x.xp6(18),x.Q6J("ngForOf",n.users)}}var Bn=function(){var t=function(){function t(e,n,i,o,r,a,s){c(this,t),this.router=e,this.route=n,this.app=i,this.notify=o,this.dialogs=r,this.userService=a,this.dialogOverlay=s,this.users=[],this.unsubscribe=new y.xQ}return d(t,[{key:"ngOnDestroy",value:function(){this.unsubscribe.next(),this.unsubscribe.complete()}},{key:"editUser",value:function(t){var e=this,n={user:t,edit:{password:"",name:t.name,email:t.email||"",roleAdmin:t.roles.admin,rolePodcast:t.roles.podcast,roleStream:t.roles.stream,roleUpload:t.roles.upload}};this.dialogOverlay.open({childComponent:An,title:"Edit User",data:n,onOkBtn:function(){return(0,_.mG)(e,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.userService.applyDialogUser(n);case 3:this.notify.success("User edited"),t.next=9;break;case 6:return t.prev=6,t.t0=t.catch(0),t.abrupt("return",(this.notify.error(t.t0),Promise.reject(t.t0)));case 9:case"end":return t.stop()}},t,this,[[0,6]])}))},onCancelBtn:function(){return(0,_.mG)(e,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Promise.resolve());case 1:case"end":return t.stop()}},t)}))}})}},{key:"editUserAvatar",value:function(t){var e=this;this.dialogOverlay.open({childComponent:In,title:"Edit User Avatar",data:t}).afterClosed().pipe((0,b.R)(this.unsubscribe)).subscribe(function(){e.userService.refreshUser(t.id)})}},{key:"setUserPassword",value:function(t){var e=this,n={user:t,password:"",newPassword:""};this.dialogOverlay.open({childComponent:Un,title:"Set User Password",data:n,onOkBtn:function(){return(0,_.mG)(e,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.userService.setPassword(t.id,n.password,n.newPassword);case 3:this.notify.success("Password changed"),e.next=9;break;case 6:return e.prev=6,e.t0=e.catch(0),e.abrupt("return",(this.notify.error(e.t0),Promise.reject(e.t0)));case 9:case"end":return e.stop()}},e,this,[[0,6]])}))},onCancelBtn:function(){return(0,_.mG)(e,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Promise.resolve());case 1:case"end":return t.stop()}},t)}))}})}},{key:"deleteUser",value:function(t){var e=this;this.dialogs.confirm("Delete User","Do you want to the delete the user?",function(){e.userService.removeUser(t).then(function(){e.notify.success("User deleted")}).catch(function(t){e.notify.error(t)})})}}]),t}();return t.\u0275fac=function(e){return new(e||t)(x.Y36(O.F0),x.Y36(O.gz),x.Y36(P.zi),x.Y36(P.c),x.Y36(K.Hr),x.Y36(P.NZ),x.Y36(tt.SL))},t.\u0275cmp=x.Xpm({type:t,selectors:[["app-admin-user-list"]],inputs:{users:"users"},decls:1,vars:1,consts:[["class","users","appFocusKeyList","",4,"ngIf"],["appFocusKeyList","",1,"users"],[1,"user","heading"],[1,"avatar"],[1,"title"],[1,"email"],[1,"role"],[1,"actions"],["class","user","appFocusKeyListItem","",3,"dblclick","keydown.enter",4,"ngFor","ngForOf"],["appFocusKeyListItem","",1,"user",3,"dblclick","keydown.enter"],[3,"coverArtObj","alt","size","round"],["class","icon-checkmark","aria-hidden","true",4,"ngIf"],["class","visually-hidden",4,"ngIf"],[1,"action-buttons"],["title","Change Avatar",3,"click"],["aria-hidden","true",1,"icon-picture"],["title","Set Password",3,"click"],["aria-hidden","true",1,"icon-key"],["title","Edit User",3,"click"],["aria-hidden","true",1,"icon-edit"],["title","Delete User",3,"click"],["aria-hidden","true",1,"icon-remove"],["aria-hidden","true",1,"icon-checkmark"],[1,"visually-hidden"]],template:function(t,e){1&t&&x.YNc(0,jn,19,1,"table",0),2&t&&x.Q6J("ngIf",e.users&&e.users.length>0)},directives:[g.O5,Z.R,g.sg,A.j,Rn.A],styles:["[_nghost-%COMP%]{width:100%;overflow:auto;display:block}[_nghost-%COMP%]   .users[_ngcontent-%COMP%]{padding:15px;font-size:.9em;width:100%}[_nghost-%COMP%]   .user[_ngcontent-%COMP%]{height:60px;border-bottom:1px solid var(--control-border)}[_nghost-%COMP%]   .user[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:5px 10px}[_nghost-%COMP%]   .user[_ngcontent-%COMP%]:hover{background-color:var(--background-hover)}[_nghost-%COMP%]   .user.selected[_ngcontent-%COMP%]{background-color:var(--background-active)}[_nghost-%COMP%]   .heading[_ngcontent-%COMP%]{font-size:.9em;height:40px}[_nghost-%COMP%]   .icon-checkmark[_ngcontent-%COMP%]{color:var(--primary)}[_nghost-%COMP%]   .actions[_ngcontent-%COMP%]{width:100px}[_nghost-%COMP%]   .action-buttons[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}[_nghost-%COMP%]   .action-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:5px;flex:50%;margin:0;display:inline-block;color:var(--on-control);border:1px solid transparent}[_nghost-%COMP%]   .action-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{color:var(--on-control-active);border:1px solid var(--control-active)}"]}),t}(),Ln=[{path:"",component:C,children:[{path:"",pathMatch:"full",component:Pn,data:{name:"Admin"}},{path:"settings",component:kn,data:{name:"Admin Settings"}},{path:"root",component:On,data:{name:"Roots",icon:"icon-root"}},{path:"user",component:function(){var t=function(){function t(e,n,i,o,r,a){c(this,t),this.app=e,this.dialogs=n,this.jam=i,this.notify=o,this.userService=r,this.dialogOverlay=a,this.unsubscribe=new y.xQ}return d(t,[{key:"getSortValue",value:function(t,e){switch(t){case"name":return e.name;case"email":return e.email;case"roleAdmin":return e.roles.admin?1:0;case"rolePodcast":return e.roles.podcast?1:0;case"roleUpload":return e.roles.upload?1:0;case"roleStream":return e.roles.stream?1:0;default:return}}},{key:"ngOnInit",value:function(){var t=this;this.userService.usersChange.pipe((0,b.R)(this.unsubscribe)).subscribe(function(e){t.users=(e||[]).sort(function(t,e){return t.name.localeCompare(e.name)})},function(e){t.notify.error(e)}),this.userService.refreshUsers()}},{key:"ngOnDestroy",value:function(){this.unsubscribe.next(),this.unsubscribe.complete()}},{key:"refresh",value:function(){this.userService.refreshUsers()}},{key:"newUser",value:function(){var t=this,e={edit:{password:"",name:"",email:"",roleAdmin:!1,rolePodcast:!1,roleStream:!0,roleUpload:!1}};this.dialogOverlay.open({title:"New User",childComponent:An,data:e,onOkBtn:function(){return(0,_.mG)(t,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.userService.applyDialogUser(e);case 3:this.notify.success("User created"),t.next=9;break;case 6:return t.prev=6,t.t0=t.catch(0),t.abrupt("return",(this.notify.error(t.t0),Promise.reject(t.t0)));case 9:case"end":return t.stop()}},t,this,[[0,6]])}))},onCancelBtn:function(){return(0,_.mG)(t,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Promise.resolve());case 1:case"end":return t.stop()}},t)}))}})}}]),t}();return t.\u0275fac=function(e){return new(e||t)(x.Y36(P.zi),x.Y36(K.Hr),x.Y36(w.K4),x.Y36(P.c),x.Y36(P.NZ),x.Y36(tt.SL))},t.\u0275cmp=x.Xpm({type:t,selectors:[["app-admin-users"]],decls:9,vars:1,consts:[[1,"users"],["section","Users"],[1,"actions"],["title","Refresh",1,"button-on-control",3,"click"],[1,"icon-reload"],["title","New User\u2026",1,"button-on-control",3,"click"],[1,"icon-plus"],[1,"content"],[3,"users"]],template:function(t,e){1&t&&(x.TgZ(0,"div",0),x.TgZ(1,"app-view-header-slim",1),x.TgZ(2,"div",2),x.TgZ(3,"button",3),x.NdJ("click",function(){return e.refresh()}),x._UZ(4,"i",4),x.qZA(),x.TgZ(5,"button",5),x.NdJ("click",function(){return e.newUser()}),x._UZ(6,"i",6),x.qZA(),x.qZA(),x.qZA(),x.TgZ(7,"div",7),x._UZ(8,"app-admin-user-list",8),x.qZA(),x.qZA()),2&t&&(x.xp6(8),x.Q6J("users",e.users))},directives:[$e.p,Bn],styles:["[_nghost-%COMP%]{height:100%;width:100%;overflow-y:auto;overflow-x:auto;display:block}[_nghost-%COMP%]   .users[_ngcontent-%COMP%]{height:100%;overflow-y:auto;overflow-x:hidden}[_nghost-%COMP%]   .users[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{margin-right:5px;margin-bottom:10px}[_nghost-%COMP%]   .users[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{padding:0 15px 15px}[_nghost-%COMP%]   .users[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{text-transform:uppercase;letter-spacing:1.25px;font-size:13.2px;margin-bottom:10px;color:var(--on-control-ambient)}@media (max-width: 522px){[_nghost-%COMP%]   .users[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{padding-left:10px;padding-right:10px}}"]}),t}(),data:{name:"Users",icon:"icon-user"}},{path:"folder",redirectTo:"folder/"},{path:"folder/:id",component:L,data:{id:"folder",name:"Folders",icon:"icon-folder",link:"folder"},children:[{path:"overview",component:Te},{path:"health",component:le},{path:"sub-folders",component:ht},{path:"tracks",component:Ge},{path:"tracks-health",component:Ye},{path:"tags",loadChildren:function(){return(0,_.mG)(void 0,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Promise.all([s.e(592),s.e(9)]).then(s.bind(s,46009)).then(function(t){return t.TagEditorModule}));case 1:case"end":return t.stop()}},t)}))}}]},{path:"radar",component:ln,data:{name:"Health Radar",icon:"icon-health"}}]}],Wn=O.Bz.forChild(Ln);function Gn(t,e){if(1&t&&(x.ynx(0),x._uU(1),x.BQk()),2&t){var n=x.oxw(2);x.xp6(1),x.hij("(",n.folderService.current.count,")")}}function $n(t,e){if(1&t&&(x.TgZ(0,"div",7),x.TgZ(1,"span",3),x._uU(2,"Other requests in queue:"),x.qZA(),x._uU(3),x.qZA()),2&t){var n=x.oxw(2);x.xp6(3),x.hij(" ",n.folderService.queue.length," ")}}function Vn(t,e){if(1&t&&(x.TgZ(0,"div",1),x.TgZ(1,"div",2),x.TgZ(2,"span",3),x._uU(3,"Current:"),x.qZA(),x._UZ(4,"i",4),x._uU(5),x.YNc(6,Gn,2,1,"ng-container",5),x.qZA(),x.YNc(7,$n,4,1,"div",6),x.qZA()),2&t){var n=x.oxw();x.xp6(5),x.hij(" ",n.folderService.current.title," "),x.xp6(1),x.Q6J("ngIf",n.folderService.current.count>1),x.xp6(1),x.Q6J("ngIf",n.folderService.queue.length>0)}}var Xn=function(){var t=function t(e){c(this,t),this.folderService=e};return t.\u0275fac=function(e){return new(e||t)(x.Y36(P.Cr))},t.\u0275cmp=x.Xpm({type:t,selectors:[["app-admin-queue-requests"]],decls:1,vars:1,consts:[["class","queue-overlay",4,"ngIf"],[1,"queue-overlay"],[1,"current"],[1,"label"],[1,"icon-spin","icon-spinner"],[4,"ngIf"],["class","other",4,"ngIf"],[1,"other"]],template:function(t,e){1&t&&x.YNc(0,Vn,8,3,"div",0),2&t&&x.Q6J("ngIf",e.folderService.current)},directives:[g.O5],styles:["[_nghost-%COMP%]   .queue-overlay[_ngcontent-%COMP%]{position:fixed;right:16px;bottom:16px;padding:15px;background-color:var(--control);color:var(--on-control);border:1px solid var(--control-border);z-index:1000}[_nghost-%COMP%]   .queue-overlay[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{text-transform:uppercase;font-size:.8em;letter-spacing:1px;color:var(--on-control-ambient)}[_nghost-%COMP%]   .queue-overlay[_ngcontent-%COMP%]   .other[_ngcontent-%COMP%]{border-top:1px solid var(--background-border)}"]}),t}(),Kn=s(40327),ti=function(){var t=function t(){c(this,t),this.sections=[];var e=(Ln[0].children||[]).filter(function(t){var e;return t.path&&t.path.length>0&&(null===(e=t.data)||void 0===e?void 0:e.name)}).map(function(t){return{link:"/admin/".concat(t.data&&t.data.link?t.data.link:t.path),name:t.data?t.data.name:"",icon:t.data&&t.data.icon?t.data.icon:"icon-admin"}});this.sections=[{name:"Administration",entries:e}]};return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=x.Xpm({type:t,selectors:[["app-admin-sidebar"]],decls:1,vars:1,consts:[[3,"sections"]],template:function(t,e){1&t&&x._UZ(0,"app-sidebar",0),2&t&&x.Q6J("sections",e.sections)},directives:[Kn.k],styles:["[_nghost-%COMP%]{width:100%;height:100%;display:block}"]}),t}(),ei=s(59766),ni=function(t){return["/admin",t]};function ii(t,e){if(1&t&&(x.TgZ(0,"div",1),x.TgZ(1,"div",2),x._UZ(2,"app-iconart-image",3),x.qZA(),x.TgZ(3,"div",4),x.TgZ(4,"a",5),x._uU(5),x.qZA(),x.qZA(),x.qZA()),2&t){var n=e.$implicit;x.Q6J("routerLink",x.VKq(3,ni,n.id)),x.xp6(2),x.Q6J("icon",n.icon),x.xp6(3),x.Oqu(n.text)}}var oi=function(){var t=function(){function t(){c(this,t),this.sections=[],this.sections=(Ln[0].children||[]).filter(function(t){var e;return t.path&&t.path.length>0&&(null===(e=t.data)||void 0===e?void 0:e.name)}).map(function(t){return{id:t.data&&t.data.link?t.data.link:t.path,text:t.data?t.data.name:"",icon:t.data&&t.data.icon?t.data.icon:"icon-admin"}})}return d(t,[{key:"trackByFn",value:function(t,e){return e.id}}]),t}();return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=x.Xpm({type:t,selectors:[["app-admin-section-cards"]],decls:1,vars:2,consts:[["class","section-card no-hover",3,"routerLink",4,"ngFor","ngForOf","ngForTrackBy"],[1,"section-card","no-hover",3,"routerLink"],[1,"image"],[3,"icon"],[1,"footer"],[1,"footer-content"]],template:function(t,e){1&t&&x.YNc(0,ii,6,5,"div",0),2&t&&x.Q6J("ngForOf",e.sections)("ngForTrackBy",e.trackByFn)},directives:[g.sg,O.rH,ei.B],styles:['[_nghost-%COMP%]{display:flex;flex-flow:row wrap}@media (max-width: 768px){[_nghost-%COMP%]{justify-content:space-around}}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]{margin:15px;width:calc((100% / 4) - 30px);position:relative;overflow:hidden;display:flex;cursor:pointer}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]:before{content:"";display:block;margin-top:100%}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .fav[_ngcontent-%COMP%], [_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]{position:absolute;top:1px;padding:5px;transform:translateY(-31px);transition:transform .3s}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .fav[_ngcontent-%COMP%]{right:1px;border-bottom-left-radius:3px;cursor:pointer;-webkit-user-select:none;user-select:none}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]{left:1px;font-size:.8em;border-bottom-right-radius:3px}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]{padding:5px;position:absolute;bottom:1px;left:1px;right:1px;overflow:hidden;height:auto}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]   .footer-buttons[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]:hover   .fav[_ngcontent-%COMP%], [_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]:hover   .date[_ngcontent-%COMP%]{transform:translateY(0)}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]:hover   .footer[_ngcontent-%COMP%]   .footer-buttons[_ngcontent-%COMP%]{display:block}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%], [_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%], [_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .fav[_ngcontent-%COMP%]{background-color:var(--background-transparent);color:var(--on-background-active)}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], [_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], [_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .fav[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--on-background-active)}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, [_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, [_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .fav[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:var(--on-background)}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .footer-subline[_ngcontent-%COMP%]{display:block;font-size:.8em}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .footer-buttons[_ngcontent-%COMP%]{height:40px;padding-top:10px;white-space:nowrap}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .footer-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-bottom:5px;margin-right:5px}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .footer-buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{float:right;margin-right:5px}@media (max-width: 1600px){[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]{width:calc((100% / 4) - 30px)}}@media (max-width: 1200px){[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]{width:calc((100% / 3) - 30px)}}@media (max-width: 522px){[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]{width:calc((100% / 2) - 30px)}}@media (max-width: 400px){[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]{margin:10px}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]{font-size:.8em}}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{min-height:135px;min-width:135px;display:flex;align-items:center;justify-content:center}']}),t}(),ri=function(){var t=function t(){c(this,t)};return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=x.oAB({type:t}),t.\u0275inj=x.cJS({providers:[],imports:[[g.ez,v.m,h.u5,p.t6,M.QG,m.vI,u.Cl,f.In,Wn]]}),t}();x.B6R(C,[ti,Q.H,O.lC,Xn],[]),x.B6R(Pn,[$e.p,oi],[])},81515:function(t,e,n){function i(t,e){if(void 0===t&&void 0===e)throw new Error("Trying to compare two undefined values");if(void 0===t||void 0===e)return 0;var n=String(t),i=String(e),o=function(t,e){for(var n,i=[],o=0,r=0;r<=e.length;r++)for(var a=0;a<=t.length;a++)n=r&&a?t.charAt(a-1)===e.charAt(r-1)?o:Math.min(i[a],i[a-1],o)+1:r+a,o=i[a],i[a]=n;return i.pop()||0}(n,i);return n.length>i.length?1-o/n.length:1-o/i.length}function o(t,e){var n={};return function(t,e){for(var n=e||2,i="-".concat(t.toLowerCase().replace(/[^\w, ]+/,""),"-"),o=[],r=0;r<i.length-n+1;r+=1)o.push(i.slice(r,r+n));return o}(t,e||2).forEach(function(t){t in n?n[t]+=1:n[t]=1}),n}function r(t){if("string"!=typeof t)throw new Error("Must use a string as argument to FuzzySet functions");return t.toLowerCase()}n.d(e,{VI:function(){return g},Cb:function(){return f},C6:function(){return m},U_:function(){return h},kQ:function(){return p},RQ:function(){return l},f_:function(){return u}});var s=function(){function t(e,n,i,o){var r=this;c(this,t),this.version="0.0.1",this.exactSet={},this.matchDict={},this.items={},this.arr=e||[],this.useLevenshtein=n||!0,this.gramSizeLower=i||2,this.gramSizeUpper=o||3;for(var a=this.gramSizeLower;a<this.gramSizeUpper+1;a+=1)this.items[a]=[];this.arr.forEach(function(t){r.add(t)})}return d(t,[{key:"get",value:function(t,e){var n=this.getVal(t);return!n&&e?e:n}},{key:"add",value:function(t){if(!(r(t)in this.exactSet))for(var e=this.gramSizeLower;e<this.gramSizeUpper+1;e+=1)this.addVal(t,e)}},{key:"length",value:function(){var t=0;for(var e in this.exactSet)Object.prototype.hasOwnProperty.call(this.exactSet,e)&&(t+=1);return t}},{key:"isEmpty",value:function(){for(var t in this.exactSet)if(Object.prototype.hasOwnProperty.call(this.exactSet,t))return!1;return!0}},{key:"values",value:function(){var t=[];for(var e in this.exactSet)Object.prototype.hasOwnProperty.call(this.exactSet,e)&&t.push(this.exactSet[e]);return t}},{key:"getVal",value:function(t){var e=r(t),n=this.exactSet[e];if(n)return[[1,n]];for(var i=this.gramSizeUpper;i>=this.gramSizeLower;i-=1){var o=this.getValGram(t,i);if(o)return o}}},{key:"getValGram",value:function(t,e){var n,s=r(t),c={},l=o(s,e),d=this.items[e],u=0;for(var g in l)if(Object.prototype.hasOwnProperty.call(l,g)){var h=l[g];if(u+=Math.pow(h,2),g in this.matchDict){var p,f=a(this.matchDict[g]);try{for(f.s();!(p=f.n()).done;){var m=p.value,v=m[0];n=m[1],v in c?c[v]+=h*n:c[v]=h*n}}catch(A){f.e(A)}finally{f.f()}}}if(!function(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}(c)){var M,x=Math.sqrt(u),C=[];Object.keys(c).forEach(function(t){M=c[t];var e=parseInt(t,10);C.push([M/(x*d[e][0]),d[e][1]])});var _=function(t,e){return t[0]<e[0]?1:t[0]>e[0]?-1:0};if(C.sort(_),this.useLevenshtein){for(var O=[],y=Math.min(50,C.length),b=0;b<y;b+=1)O.push([i(C[b][1],s),C[b][1]]);(C=O).sort(_)}for(var k=[],P=0,w=C;P<w.length;P++){var Z=w[P];Z[0]===C[0][0]&&k.push([Z[0],this.exactSet[Z[1]]])}return k}}},{key:"addVal",value:function(t,e){var n=r(t),i=this.items[e]||[],a=i.length;i.push(0);var s=o(n,e),c=0;for(var l in s)if(Object.prototype.hasOwnProperty.call(s,l)){var d=s[l];c+=Math.pow(d,2),l in this.matchDict?this.matchDict[l].push([a,d]):this.matchDict[l]=[[a,d]]}var u=Math.sqrt(c);i[a]=[u,n],this.items[e]=i,this.exactSet[n]=t}}]),t}();function l(t){return t.split(/[.,\\/ -]/).map(function(t){return t.trim()}).filter(function(t){return t.length>0})}function u(t){return t.replace(/\.[^/.]+$/,"")}function g(t){return t.substring(t.lastIndexOf(".")+1,t.length)||t}function h(t,e){return e.includes(g(t))}function p(t,e){return t.toString().replace(/:/g," - ").replace(/[?/!\\]/g,e)}function f(t){if(!t)return 0;var e=u(t).split(/[ \-_.:;?!~,`"&|()<>{}[\]\r\n/\\]+/).map(Number).filter(function(t){return!isNaN(t)});return e.length>0?e[0]:0}function m(t,e){var n=new s;n.add(t);var i=n.get(e);return i?i[0][0]:0}},22689:function(t,e,n){function i(t){for(var e="",n=new Uint8Array(t),i=n.byteLength,o=0;o<i;o++)e+=String.fromCharCode(n[o]);return window.btoa(e)}n.d(e,{q:function(){return i}})}}])}();