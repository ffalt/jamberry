import{Aa as h,Da as te,Ea as ie,Fa as re,I as l,J as p,Ka as A,La as q,Mb as ze,N as W,O as xe,T as fe,U as _e,V as F,Y as Ce,_ as Me,a as w,b as O,da as B,f as v,ha as ee,hb as S,i as de,o as T,oa as U,pa as C,q as J,qa as M,ra as I,sa as we,sb as be,ta as ye,v as ue,va as j,z as Z,za as x}from"./chunk-2CUFB47X.js";var Pe=["wrapper"],Ae=["sourceImage"];function He(o,e){if(o&1){let i=j();C(0,"img",5,0),x("load",function(){l(i);let r=h();return p(r.imageLoadedInView())})("mousedown",function(r){l(i);let n=h();return p(n.startMove(r,n.moveTypes.Drag))})("touchstart",function(r){l(i);let n=h();return p(n.startMove(r,n.moveTypes.Drag))})("error",function(r){l(i);let n=h();return p(n.loadImageError(r))}),M()}if(o&2){let i=e.ngIf,t=h();A("visibility",t.imageVisible?"visible":"hidden")("transform",t.safeTransformStyle()),q("ngx-ic-draggable",!t.disabled&&t.allowMoveImage),U("src",i,fe),ee("alt",t.imageAltText)}}function We(o,e){if(o&1){let i=j();we(0),C(1,"span",9),x("mousedown",function(r){l(i);let n=h(2);return p(n.startMove(r,n.moveTypes.Resize,"topleft"))})("touchstart",function(r){l(i);let n=h(2);return p(n.startMove(r,n.moveTypes.Resize,"topleft"))}),I(2,"span",10),M(),C(3,"span",11),x("mousedown",function(r){l(i);let n=h(2);return p(n.startMove(r,n.moveTypes.Resize,"topright"))})("touchstart",function(r){l(i);let n=h(2);return p(n.startMove(r,n.moveTypes.Resize,"topright"))}),I(4,"span",10),M(),C(5,"span",12),x("mousedown",function(r){l(i);let n=h(2);return p(n.startMove(r,n.moveTypes.Resize,"bottomright"))})("touchstart",function(r){l(i);let n=h(2);return p(n.startMove(r,n.moveTypes.Resize,"bottomright"))}),I(6,"span",10),M(),C(7,"span",13),x("mousedown",function(r){l(i);let n=h(2);return p(n.startMove(r,n.moveTypes.Resize,"bottomleft"))})("touchstart",function(r){l(i);let n=h(2);return p(n.startMove(r,n.moveTypes.Resize,"bottomleft"))}),I(8,"span",10),M(),C(9,"span",14),x("mousedown",function(r){l(i);let n=h(2);return p(n.startMove(r,n.moveTypes.Resize,"top"))})("touchstart",function(r){l(i);let n=h(2);return p(n.startMove(r,n.moveTypes.Resize,"top"))}),M(),C(10,"span",15),x("mousedown",function(r){l(i);let n=h(2);return p(n.startMove(r,n.moveTypes.Resize,"top"))})("touchstart",function(r){l(i);let n=h(2);return p(n.startMove(r,n.moveTypes.Resize,"top"))}),I(11,"span",10),M(),C(12,"span",16),x("mousedown",function(r){l(i);let n=h(2);return p(n.startMove(r,n.moveTypes.Resize,"right"))})("touchstart",function(r){l(i);let n=h(2);return p(n.startMove(r,n.moveTypes.Resize,"right"))}),M(),C(13,"span",17),x("mousedown",function(r){l(i);let n=h(2);return p(n.startMove(r,n.moveTypes.Resize,"right"))})("touchstart",function(r){l(i);let n=h(2);return p(n.startMove(r,n.moveTypes.Resize,"right"))}),I(14,"span",10),M(),C(15,"span",18),x("mousedown",function(r){l(i);let n=h(2);return p(n.startMove(r,n.moveTypes.Resize,"bottom"))})("touchstart",function(r){l(i);let n=h(2);return p(n.startMove(r,n.moveTypes.Resize,"bottom"))}),M(),C(16,"span",19),x("mousedown",function(r){l(i);let n=h(2);return p(n.startMove(r,n.moveTypes.Resize,"bottom"))})("touchstart",function(r){l(i);let n=h(2);return p(n.startMove(r,n.moveTypes.Resize,"bottom"))}),I(17,"span",10),M(),C(18,"span",20),x("mousedown",function(r){l(i);let n=h(2);return p(n.startMove(r,n.moveTypes.Resize,"left"))})("touchstart",function(r){l(i);let n=h(2);return p(n.startMove(r,n.moveTypes.Resize,"left"))}),M(),C(19,"span",21),x("mousedown",function(r){l(i);let n=h(2);return p(n.startMove(r,n.moveTypes.Resize,"left"))})("touchstart",function(r){l(i);let n=h(2);return p(n.startMove(r,n.moveTypes.Resize,"left"))}),I(20,"span",10),M(),ye()}}function Fe(o,e){if(o&1){let i=j();C(0,"div",6),x("keydown",function(r){l(i);let n=h();return p(n.keyboardAccess(r))}),C(1,"div",7),x("mousedown",function(r){l(i);let n=h();return p(n.startMove(r,n.moveTypes.Move))})("touchstart",function(r){l(i);let n=h();return p(n.startMove(r,n.moveTypes.Move))}),M(),B(2,We,21,0,"ng-container",8),M()}if(o&2){let i=h();A("top",i.state.cropper().y1,"px")("left",i.state.cropper().x1,"px")("width",i.state.cropper().x2-i.state.cropper().x1,"px")("height",i.state.cropper().y2-i.state.cropper().y1,"px")("margin-left",i.state.options.alignImage==="center"?i.marginLeft:null)("visibility",i.imageVisible?"visible":"hidden"),q("ngx-ic-round",i.state.options.roundCropper),ee("aria-label",i.state.options.cropperFrameAriaLabel),F(2),U("ngIf",!i.state.options.hideResizeSquares&&!(i.state.options.cropperStaticWidth&&i.state.options.cropperStaticHeight))}}function k(o,e,i){return o=Ue(o,e),X(o,e,i)}function Ue(o,e){let i=o.x2-o.x1,t=o.y2-o.y1,r=o.x1+i/2,n=o.y1+t/2;e.options.cropperStaticHeight&&e.options.cropperStaticWidth?(i=e.maxSize().width>e.options.cropperStaticWidth?e.options.cropperStaticWidth:e.maxSize().width,t=e.maxSize().height>e.options.cropperStaticHeight?e.options.cropperStaticHeight:e.maxSize().height):(i=Math.max(e.cropperScaledMinWidth,Math.min(i,e.cropperScaledMaxWidth,e.maxSize().width)),t=Math.max(e.cropperScaledMinHeight,Math.min(t,e.cropperScaledMaxHeight,e.maxSize().height)),e.options.maintainAspectRatio&&(e.maxSize().width/e.options.aspectRatio<e.maxSize().height?t=i/e.options.aspectRatio:i=t*e.options.aspectRatio));let s=r-i/2,a=s+i,c=n-t/2,m=c+t;return{x1:s,x2:a,y1:c,y2:m}}function X(o,e,i=!1){return o.x1<0&&(o=O(w({},o),{x1:0,x2:o.x2-(i?o.x1:0)})),o.y1<0&&(o=O(w({},o),{y2:o.y2-(i?o.y1:0),y1:0})),o.x2>e.maxSize().width&&(o=O(w({},o),{x1:o.x1-(i?o.x2-e.maxSize().width:0),x2:e.maxSize().width})),o.y2>e.maxSize().height&&(o=O(w({},o),{y1:o.y1-(i?o.y2-e.maxSize().height:0),y2:e.maxSize().height})),o}function ke(o,e){let i=Y(o)-e.clientX,t=Q(o)-e.clientY;return{x1:e.cropper.x1+i,y1:e.cropper.y1+t,x2:e.cropper.x2+i,y2:e.cropper.y2+t}}function ve(o,e,i){let t=w({},i.cropper()),r=Y(o)-e.clientX,n=Q(o)-e.clientY;switch(e.position){case"left":t.x1=Math.min(Math.max(e.cropper.x1+r,t.x2-i.cropperScaledMaxWidth),t.x2-i.cropperScaledMinWidth);break;case"topleft":t.x1=Math.min(Math.max(e.cropper.x1+r,t.x2-i.cropperScaledMaxWidth),t.x2-i.cropperScaledMinWidth),t.y1=Math.min(Math.max(e.cropper.y1+n,t.y2-i.cropperScaledMaxHeight),t.y2-i.cropperScaledMinHeight);break;case"top":t.y1=Math.min(Math.max(e.cropper.y1+n,t.y2-i.cropperScaledMaxHeight),t.y2-i.cropperScaledMinHeight);break;case"topright":t.x2=Math.max(Math.min(e.cropper.x2+r,t.x1+i.cropperScaledMaxWidth),t.x1+i.cropperScaledMinWidth),t.y1=Math.min(Math.max(e.cropper.y1+n,t.y2-i.cropperScaledMaxHeight),t.y2-i.cropperScaledMinHeight);break;case"right":t.x2=Math.max(Math.min(e.cropper.x2+r,t.x1+i.cropperScaledMaxWidth),t.x1+i.cropperScaledMinWidth);break;case"bottomright":t.x2=Math.max(Math.min(e.cropper.x2+r,t.x1+i.cropperScaledMaxWidth),t.x1+i.cropperScaledMinWidth),t.y2=Math.max(Math.min(e.cropper.y2+n,t.y1+i.cropperScaledMaxHeight),t.y1+i.cropperScaledMinHeight);break;case"bottom":t.y2=Math.max(Math.min(e.cropper.y2+n,t.y1+i.cropperScaledMaxHeight),t.y1+i.cropperScaledMinHeight);break;case"bottomleft":t.x1=Math.min(Math.max(e.cropper.x1+r,t.x2-i.cropperScaledMaxWidth),t.x2-i.cropperScaledMinWidth),t.y2=Math.max(Math.min(e.cropper.y2+n,t.y1+i.cropperScaledMaxHeight),t.y1+i.cropperScaledMinHeight);break;case"center":let s="scale"in o?o.scale:1,a=Math.min(Math.max(i.cropperScaledMinWidth,Math.abs(e.cropper.x2-e.cropper.x1)*s),i.cropperScaledMaxWidth),c=Math.min(Math.max(i.cropperScaledMinHeight,Math.abs(e.cropper.y2-e.cropper.y1)*s),i.cropperScaledMaxHeight);t.x1=e.clientX-a/2,t.x2=e.clientX+a/2,t.y1=e.clientY-c/2,t.y2=e.clientY+c/2,t.x1<0?(t.x2-=t.x1,t.x1=0):t.x2>i.maxSize().width&&(t.x1-=t.x2-i.maxSize().width,t.x2=i.maxSize().width),t.y1<0?(t.y2-=t.y1,t.y1=0):t.y2>i.maxSize().height&&(t.y1-=t.y2-i.maxSize().height,t.y2=i.maxSize().height);break}return i.options.maintainAspectRatio?Le(e.position,t,i):t}function Le(o,e,i){e=w({},e);let t=0,r=0;switch(o){case"top":e.x2=e.x1+(e.y2-e.y1)*i.options.aspectRatio,t=Math.max(e.x2-i.maxSize().width,0),r=Math.max(0-e.y1,0),(t>0||r>0)&&(e.x2-=r*i.options.aspectRatio>t?r*i.options.aspectRatio:t,e.y1+=r*i.options.aspectRatio>t?r:t/i.options.aspectRatio);break;case"bottom":e.x2=e.x1+(e.y2-e.y1)*i.options.aspectRatio,t=Math.max(e.x2-i.maxSize().width,0),r=Math.max(e.y2-i.maxSize().height,0),(t>0||r>0)&&(e.x2-=r*i.options.aspectRatio>t?r*i.options.aspectRatio:t,e.y2-=r*i.options.aspectRatio>t?r:t/i.options.aspectRatio);break;case"topleft":e.y1=e.y2-(e.x2-e.x1)/i.options.aspectRatio,t=Math.max(0-e.x1,0),r=Math.max(0-e.y1,0),(t>0||r>0)&&(e.x1+=r*i.options.aspectRatio>t?r*i.options.aspectRatio:t,e.y1+=r*i.options.aspectRatio>t?r:t/i.options.aspectRatio);break;case"topright":e.y1=e.y2-(e.x2-e.x1)/i.options.aspectRatio,t=Math.max(e.x2-i.maxSize().width,0),r=Math.max(0-e.y1,0),(t>0||r>0)&&(e.x2-=r*i.options.aspectRatio>t?r*i.options.aspectRatio:t,e.y1+=r*i.options.aspectRatio>t?r:t/i.options.aspectRatio);break;case"right":case"bottomright":e.y2=e.y1+(e.x2-e.x1)/i.options.aspectRatio,t=Math.max(e.x2-i.maxSize().width,0),r=Math.max(e.y2-i.maxSize().height,0),(t>0||r>0)&&(e.x2-=r*i.options.aspectRatio>t?r*i.options.aspectRatio:t,e.y2-=r*i.options.aspectRatio>t?r:t/i.options.aspectRatio);break;case"left":case"bottomleft":e.y2=e.y1+(e.x2-e.x1)/i.options.aspectRatio,t=Math.max(0-e.x1,0),r=Math.max(e.y2-i.maxSize().height,0),(t>0||r>0)&&(e.x1+=r*i.options.aspectRatio>t?r*i.options.aspectRatio:t,e.y2-=r*i.options.aspectRatio>t?r:t/i.options.aspectRatio);break;case"center":e.x2=e.x1+(e.y2-e.y1)*i.options.aspectRatio,e.y2=e.y1+(e.x2-e.x1)/i.options.aspectRatio;let n=Math.max(0-e.x1,0),s=Math.max(e.x2-i.maxSize().width,0),a=Math.max(e.y2-i.maxSize().height,0),c=Math.max(0-e.y1,0);(n>0||s>0||a>0||c>0)&&(e.x1+=a*i.options.aspectRatio>n?a*i.options.aspectRatio:n,e.x2-=c*i.options.aspectRatio>s?c*i.options.aspectRatio:s,e.y1+=c*i.options.aspectRatio>s?c:s/i.options.aspectRatio,e.y2-=a*i.options.aspectRatio>n?a:n/i.options.aspectRatio);break}return e}function Y(o){return"touches"in o&&o.touches[0]?o.touches[0].clientX:"clientX"in o?o.clientX:0}function Q(o){return"touches"in o&&o.touches[0]?o.touches[0].clientY:"clientX"in o?o.clientY:0}var ne=class{constructor(){this.cropper=W({x1:0,x2:0,y1:0,y2:0}),this.maxSize=W({width:0,height:0}),this.transform={},this.options={format:"png",output:"blob",autoCrop:!0,maintainAspectRatio:!0,aspectRatio:1,resetCropOnAspectRatioChange:!0,resizeToWidth:0,resizeToHeight:0,cropperMinWidth:0,cropperMinHeight:0,cropperMaxHeight:0,cropperMaxWidth:0,cropperStaticWidth:0,cropperStaticHeight:0,canvasRotation:0,roundCropper:!1,onlyScaleDown:!1,imageQuality:92,backgroundColor:void 0,containWithinAspectRatio:!1,hideResizeSquares:!1,alignImage:"center",cropperFrameAriaLabel:void 0,checkImageType:!0},this.cropperScaledMinWidth=20,this.cropperScaledMinHeight=20,this.cropperScaledMaxWidth=20,this.cropperScaledMaxHeight=20,this.stepSize=3}setOptionsFromChanges(e){e.options?.currentValue&&this.setOptions(e.options.currentValue);let i=Object.entries(e).filter(([t])=>t in this.options).reduce((t,[r,n])=>O(w({},t),{[r]:n.currentValue}),{});Object.keys(i).length>0&&this.setOptions(i)}setOptions(e){if(this.options=w(w({},this.options),e||{}),this.validateOptions(),!this.loadedImage?.transformed.image.complete||!this.maxSize)return;let i=!1;this.options.maintainAspectRatio&&e.aspectRatio||"maintainAspectRatio"in e?(this.setCropperScaledMinSize(),this.setCropperScaledMaxSize(),this.options.maintainAspectRatio&&(this.options.resetCropOnAspectRatioChange||!this.aspectRatioIsCorrect())&&(this.cropper.set(this.maxSizeCropperPosition()),i=!0)):((e.cropperMinWidth||e.cropperMinHeight)&&(this.setCropperScaledMinSize(),i=!0),(e.cropperMaxWidth||e.cropperMaxHeight)&&(this.setCropperScaledMaxSize(),i=!0),(e.cropperStaticWidth||e.cropperStaticHeight)&&(i=!0)),i&&this.cropper.update(t=>k(t,this,!1))}validateOptions(){if(this.options.maintainAspectRatio&&!this.options.aspectRatio)throw new Error("`aspectRatio` should > 0 when `maintainAspectRatio` is enabled")}setMaxSize(e,i){this.maxSize.set({width:e,height:i}),this.setCropperScaledMinSize(),this.setCropperScaledMaxSize()}setCropperScaledMinSize(){this.loadedImage?.transformed.size?(this.setCropperScaledMinWidth(),this.setCropperScaledMinHeight()):(this.cropperScaledMinWidth=20,this.cropperScaledMinHeight=20)}setCropperScaledMinWidth(){this.cropperScaledMinWidth=this.options.cropperMinWidth>0?Math.max(20,this.options.cropperMinWidth/this.loadedImage.transformed.size.width*this.maxSize().width):20}setCropperScaledMinHeight(){this.options.maintainAspectRatio?this.cropperScaledMinHeight=Math.max(20,this.cropperScaledMinWidth/this.options.aspectRatio):this.options.cropperMinHeight>0?this.cropperScaledMinHeight=Math.max(20,this.options.cropperMinHeight/this.loadedImage.transformed.size.height*this.maxSize().height):this.cropperScaledMinHeight=20}setCropperScaledMaxSize(){if(this.loadedImage?.transformed.size){let e=this.loadedImage.transformed.size.width/this.maxSize().width;this.cropperScaledMaxWidth=this.options.cropperMaxWidth>20?this.options.cropperMaxWidth/e:this.maxSize().width,this.cropperScaledMaxHeight=this.options.cropperMaxHeight>20?this.options.cropperMaxHeight/e:this.maxSize().height,this.options.maintainAspectRatio&&(this.cropperScaledMaxWidth>this.cropperScaledMaxHeight*this.options.aspectRatio?this.cropperScaledMaxWidth=this.cropperScaledMaxHeight*this.options.aspectRatio:this.cropperScaledMaxWidth<this.cropperScaledMaxHeight*this.options.aspectRatio&&(this.cropperScaledMaxHeight=this.cropperScaledMaxWidth/this.options.aspectRatio))}else this.cropperScaledMaxWidth=this.maxSize().width,this.cropperScaledMaxHeight=this.maxSize().height}equalsCropperPosition(e){let i=this.cropper();return i==null&&e==null||i!=null&&e!=null&&i.x1.toFixed(3)===e.x1.toFixed(3)&&i.y1.toFixed(3)===e.y1.toFixed(3)&&i.x2.toFixed(3)===e.x2.toFixed(3)&&i.y2.toFixed(3)===e.y2.toFixed(3)}equalsTransformTranslate(e){return(this.transform.translateH??0)===(e.translateH??0)&&(this.transform.translateV??0)===(e.translateV??0)}equalsTransform(e){return this.equalsTransformTranslate(e)&&(this.transform.scale??1)===(e.scale??1)&&(this.transform.rotate??0)===(e.rotate??0)&&(this.transform.flipH??!1)===(e.flipH??!1)&&(this.transform.flipV??!1)===(e.flipV??!1)}aspectRatioIsCorrect(){let e=this.cropper();return(e.x2-e.x1)/(e.y2-e.y1)===this.options.aspectRatio}resizeCropperPosition(e){(e.width!==this.maxSize().width||e.height!==this.maxSize().height)&&this.cropper.update(i=>({x1:i.x1*this.maxSize().width/e.width,x2:i.x2*this.maxSize().width/e.width,y1:i.y1*this.maxSize().height/e.height,y2:i.y2*this.maxSize().height/e.height}))}maxSizeCropperPosition(){return{x1:0,y1:0,x2:this.maxSize().width,y2:this.maxSize().height}}toCropInput(){return{cropper:this.cropper(),maxSize:this.maxSize(),transform:this.transform,loadedImage:this.loadedImage,options:w({},this.options)}}},b=function(o){return o.Drag="drag",o.Move="move",o.Resize="resize",o.Pinch="pinch",o}(b||{});function Ee(o,e,i){let t=o.width,r=o.height;e=Math.round(e),i=Math.round(i);let n=t/e,s=r/i,a=Math.ceil(n/2),c=Math.ceil(s/2),m=o.getContext("2d");if(m){let d=m.getImageData(0,0,t,r),y=m.createImageData(e,i),f=d.data,_=y.data;for(let g=0;g<i;g++)for(let u=0;u<e;u++){let z=(u+g*e)*4,H=g*s,R=0,L=0,ae=0,ce=0,he=0,le=0,pe=0,Se=Math.floor(u*n),Oe=Math.floor(g*s),N=Math.ceil((u+1)*n),K=Math.ceil((g+1)*s);N=Math.min(N,t),K=Math.min(K,r);for(let E=Oe;E<K;E++){let ge=Math.abs(H-E)/c,Te=u*n,Ve=ge*ge;for(let D=Se;D<N;D++){let me=Math.abs(Te-D)/a,V=Math.sqrt(Ve+me*me);if(V>=1)continue;R=2*V*V*V-3*V*V+1;let P=4*(D+E*t);pe+=R*f[P+3],ae+=R,f[P+3]<255&&(R=R*f[P+3]/250),ce+=R*f[P],he+=R*f[P+1],le+=R*f[P+2],L+=R}}_[z]=ce/L,_[z+1]=he/L,_[z+2]=le/L,_[z+3]=pe/ae}o.width=e,o.height=i,m.putImageData(y,0,0)}}function Ie(o,e){return o/100*e}var oe=class{crop(e,i){let t=this.getImagePosition(e),r=t.x2-t.x1,n=t.y2-t.y1,s=document.createElement("canvas");s.width=r,s.height=n;let a=s.getContext("2d");if(!a)return null;e.options?.backgroundColor!=null&&(a.fillStyle=e.options.backgroundColor,a.fillRect(0,0,r,n));let c=(e.transform?.scale||1)*(e.transform?.flipH?-1:1),m=(e.transform?.scale||1)*(e.transform?.flipV?-1:1),{translateH:d,translateV:y}=this.getCanvasTranslate(e),f=e.loadedImage.transformed;a.setTransform(c,0,0,m,f.size.width/2+d,f.size.height/2+y),a.translate(-t.x1/c,-t.y1/m),a.rotate((e.transform?.rotate||0)*Math.PI/180),a.drawImage(f.image,-f.size.width/2,-f.size.height/2);let _={width:r,height:n,imagePosition:t,cropperPosition:w({},e.cropper)};e.options?.containWithinAspectRatio&&(_.offsetImagePosition=this.getOffsetImagePosition(e));let g=this.getResizeRatio(r,n,e.options);return g!==1&&(_.width=Math.round(r*g),_.height=e.options?.maintainAspectRatio?Math.round(_.width/(e.options?.aspectRatio??1)):Math.round(n*g),Ee(s,_.width,_.height)),i==="blob"?this.cropToBlob(_,s,e):(_.base64=s.toDataURL("image/"+(e.options?.format??"png"),this.getQuality(e.options)),_)}cropToBlob(e,i,t){return v(this,null,function*(){return e.blob=yield new Promise(r=>i.toBlob(r,"image/"+(t.options?.format??"png"),this.getQuality(t.options))),e.blob&&(e.objectUrl=URL.createObjectURL(e.blob)),e})}getCanvasTranslate(e){if(e.transform?.translateUnit==="px"){let i=this.getRatio(e);return{translateH:(e.transform?.translateH||0)*i,translateV:(e.transform?.translateV||0)*i}}else return{translateH:e.transform?.translateH?Ie(e.transform.translateH,e.loadedImage.transformed.size.width):0,translateV:e.transform?.translateV?Ie(e.transform.translateV,e.loadedImage.transformed.size.height):0}}getRatio(e){return e.loadedImage.transformed.size.width/e.maxSize.width}getImagePosition(e){let i=this.getRatio(e),t={x1:Math.round(e.cropper.x1*i),y1:Math.round(e.cropper.y1*i),x2:Math.round(e.cropper.x2*i),y2:Math.round(e.cropper.y2*i)};return e.options?.containWithinAspectRatio||(t.x1=Math.max(t.x1,0),t.y1=Math.max(t.y1,0),t.x2=Math.min(t.x2,e.loadedImage.transformed.size.width),t.y2=Math.min(t.y2,e.loadedImage.transformed.size.height)),t}getOffsetImagePosition(e){let i=(e.options?.canvasRotation??0)+e.loadedImage.exifTransform.rotate,t=this.getRatio(e),r,n;i%2?(r=(e.loadedImage.transformed.size.width-e.loadedImage.original.size.height)/2,n=(e.loadedImage.transformed.size.height-e.loadedImage.original.size.width)/2):(r=(e.loadedImage.transformed.size.width-e.loadedImage.original.size.width)/2,n=(e.loadedImage.transformed.size.height-e.loadedImage.original.size.height)/2);let s=e.cropper,a={x1:Math.round(s.x1*t)-r,y1:Math.round(s.y1*t)-n,x2:Math.round(s.x2*t)-r,y2:Math.round(s.y2*t)-n};return e.options?.containWithinAspectRatio||(a.x1=Math.max(a.x1,0),a.y1=Math.max(a.y1,0),a.x2=Math.min(a.x2,e.loadedImage.transformed.size.width),a.y2=Math.min(a.y2,e.loadedImage.transformed.size.height)),a}getResizeRatio(e,i,t){let r=new Array;t?.resizeToWidth&&t.resizeToWidth>0&&r.push(t.resizeToWidth/e),t?.resizeToHeight&&t.resizeToHeight>0&&r.push(t.resizeToHeight/i);let n=r.length===0?1:Math.min(...r);return n>1&&!t?.onlyScaleDown?n:Math.min(n,1)}getQuality(e){return Math.min(1,Math.max(0,(e?.imageQuality??92)/100))}},De=[new Uint8Array([255,216,255,225,0,34,69,120,105,102,0,0,77,77,0,42,0,0,0,8,0,1,1,18,0,3,0,0,0,1,0,6,0,0,0,0,0,0,255,219,0,132,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,255,192,0,17,8,0,1,0,2,3,1,17,0,2,17,1,3,17,1,255,196,0,74,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,11,16,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,17,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,218,0,12,3,1,0,2,17,3,17,0,63,0,63,240,127,255,217])],Be=URL.createObjectURL(new Blob(De,{type:"image/jpeg"}));function je(){return new Promise(o=>{let e=new Image;e.onload=()=>{let i=e.width===1&&e.height===2;o(i)},e.src=Be})}function qe(o){switch(typeof o=="object"&&(o=Xe(o)),o){case 2:return{rotate:0,flip:!0};case 3:return{rotate:2,flip:!1};case 4:return{rotate:2,flip:!0};case 5:return{rotate:1,flip:!0};case 6:return{rotate:1,flip:!1};case 7:return{rotate:3,flip:!0};case 8:return{rotate:3,flip:!1};default:return{rotate:0,flip:!1}}}function Xe(o){let e=new DataView(o);if(e.getUint16(0,!1)!==65496)return-2;let i=e.byteLength,t=2;for(;t<i;){if(e.getUint16(t+2,!1)<=8)return-1;let r=e.getUint16(t,!1);if(t+=2,r==65505){if(e.getUint32(t+=2,!1)!==1165519206)return-1;let n=e.getUint16(t+=6,!1)==18761;t+=e.getUint32(t+4,n);let s=e.getUint16(t,n);t+=2;for(let a=0;a<s;a++)if(e.getUint16(t+a*12,n)==274)return e.getUint16(t+a*12+8,n)}else{if((r&65280)!==65280)break;t+=e.getUint16(t,!1)}}return-1}var se=class{constructor(){this.autoRotateSupported=je()}loadImageFile(e,i){return v(this,null,function*(){let t=yield e.arrayBuffer();return i.checkImageType?yield this.checkImageTypeAndLoadImageFromArrayBuffer(t,e.type,i):yield this.loadImageFromArrayBuffer(t,i)})}checkImageTypeAndLoadImageFromArrayBuffer(e,i,t){return this.isValidImageType(i)?this.loadImageFromArrayBuffer(e,t,i):Promise.reject(new Error("Invalid image type"))}isValidImageType(e){return/image\/(png|jpg|jpeg|heic|bmp|gif|tiff|svg|webp|x-icon|vnd.microsoft.icon)/.test(e)}loadImageFromURL(e,i){return v(this,null,function*(){let r=yield(yield fetch(e)).blob(),n=yield r.arrayBuffer();return yield this.loadImageFromArrayBuffer(n,i,r.type)})}loadBase64Image(e,i){let t=this.base64ToArrayBuffer(e);return this.loadImageFromArrayBuffer(t,i)}base64ToArrayBuffer(e){e=e.replace(/^data:([^;]+);base64,/gmi,"");let i=atob(e),t=i.length,r=new Uint8Array(t);for(let n=0;n<t;n++)r[n]=i.charCodeAt(n);return r.buffer}loadImageFromArrayBuffer(e,i,t){return v(this,null,function*(){let r=yield new Promise((n,s)=>v(this,null,function*(){try{let a=new Blob([e],t?{type:t}:void 0),c=URL.createObjectURL(a),m=new Image,y=t==="image/svg+xml"?yield this.getSvgImageSize(a):void 0;m.onload=()=>n({originalImage:m,originalImageSize:y,originalObjectUrl:c,originalArrayBuffer:e}),m.onerror=s,m.src=c}catch(a){s(a)}}));return yield this.transformImageFromArrayBuffer(r,i,r.originalImageSize!=null)})}getSvgImageSize(e){return v(this,null,function*(){let r=new DOMParser().parseFromString(yield e.text(),"image/svg+xml").querySelector("svg");if(!r)throw Error("Failed to parse SVG image");let n=r.getAttribute("width"),s=r.getAttribute("height");if(n&&s)return null;let a=r.getAttribute("viewBox")||r.getAttribute("viewbox");if(a){let c=a.split(" ");return{width:+c[2],height:+c[3]}}throw Error("Failed to load SVG image. SVG must have width + height or viewBox definition.")})}transformImageFromArrayBuffer(e,i,t=!1){return v(this,null,function*(){let r=yield this.autoRotateSupported,n=qe(r?-1:e.originalArrayBuffer);if(!e.originalImage||!e.originalImage.complete)return Promise.reject(new Error("No image loaded"));let s={original:{objectUrl:e.originalObjectUrl,image:e.originalImage,size:e.originalImageSize??{width:e.originalImage.naturalWidth,height:e.originalImage.naturalHeight}},exifTransform:n};return this.transformLoadedImage(s,i,t)})}transformLoadedImage(e,i,t=!1){return v(this,null,function*(){let r=(i.canvasRotation??0)+e.exifTransform.rotate,n=e.original.size;if(!t&&r===0&&!e.exifTransform.flip&&!i.containWithinAspectRatio)return{original:{objectUrl:e.original.objectUrl,image:e.original.image,size:w({},n)},transformed:{objectUrl:e.original.objectUrl,image:e.original.image,size:w({},n)},exifTransform:e.exifTransform};let s=this.getTransformedSize(n,e.exifTransform,i),a=document.createElement("canvas");a.width=s.width,a.height=s.height;let c=a.getContext("2d");c?.setTransform(e.exifTransform.flip?-1:1,0,0,1,a.width/2,a.height/2),c?.rotate(Math.PI*(r/2)),c?.drawImage(e.original.image,-n.width/2,-n.height/2);let m=yield new Promise(f=>a.toBlob(f,"image/"+(i.format??"png")));if(!m)throw new Error("Failed to get Blob for transformed image.");let d=URL.createObjectURL(m),y=yield this.loadImageFromObjectUrl(d);return{original:{objectUrl:e.original.objectUrl,image:e.original.image,size:w({},n)},transformed:{objectUrl:d,image:y,size:{width:y.width,height:y.height}},exifTransform:e.exifTransform}})}loadImageFromObjectUrl(e){return new Promise((i,t)=>{let r=new Image;r.onload=()=>i(r),r.onerror=t,r.src=e})}getTransformedSize(e,i,t){let r=(t.canvasRotation??0)+i.rotate;if(t.containWithinAspectRatio)if(r%2){let n=e.width*(t.aspectRatio??1),s=e.height/(t.aspectRatio??1);return{width:Math.max(e.height,n),height:Math.max(e.width,s)}}else{let n=e.height*(t.aspectRatio??1),s=e.width/(t.aspectRatio??1);return{width:Math.max(e.width,n),height:Math.max(e.height,s)}}return r%2?{height:e.width,width:e.height}:{width:e.width,height:e.height}}};function Ye(o){switch(o){case"ArrowUp":return"top";case"ArrowRight":return"right";case"ArrowDown":return"bottom";case"ArrowLeft":default:return"left"}}function Qe(o){switch(o){case"ArrowUp":return"bottom";case"ArrowRight":return"left";case"ArrowDown":return"top";case"ArrowLeft":default:return"right"}}function $e(o,e){switch(o){case"ArrowUp":return{clientX:0,clientY:e*-1};case"ArrowRight":return{clientX:e,clientY:0};case"ArrowDown":return{clientX:0,clientY:e};case"ArrowLeft":default:return{clientX:e*-1,clientY:0}}}var mt=(()=>{let e=class e{get alignImageStyle(){return this.state.options.alignImage}constructor(t){this.sanitizer=t,this.pinchStart$=new de,this.cropService=new oe,this.loadImageService=new se,this.setImageMaxSizeRetries=0,this.resizedWhileHidden=!1,this.moveTypes=b,this.state=new ne,this.safeImgDataUrl=W(void 0),this.safeTransformStyle=W(void 0),this.marginLeft="0px",this.imageVisible=!1,this.allowMoveImage=!1,this.checkImageType=!0,this.disabled=!1,this.hidden=!1,this.imageCropped=S(),this.startCropImage=S(),this.imageLoaded=S(),this.cropperReady=S(),this.loadImageFailed=S(),this.transformChange=S(),this.cropperChange=S(),this.reset()}ngOnInit(){this.state.stepSize=this.initialStepSize||this.state.stepSize}ngOnChanges(t){let r=this.state.cropper(),n=this.state.transform,s=this.state.options.backgroundColor;if(this.state.setOptionsFromChanges(t),this.onChangesInputImage(t),t.transform&&this.transform&&(this.state.transform=this.transform,this.setCssTransform()),!this.state.loadedImage?.transformed.image.complete||!this.state.maxSize)return;if(this.containWithinAspectRatio&&t.aspectRatio||t.containWithinAspectRatio||t.canvasRotation){this.loadImageService.transformLoadedImage(this.state.loadedImage,this.state.options).then(c=>this.setLoadedImage(c)).catch(c=>this.loadImageError(c));return}t.cropper&&this.cropper&&this.state.cropper.set(k(this.cropper,this.state,!0));let a=!this.state.equalsCropperPosition(r);a&&(!this.cropper||!this.state.equalsCropperPosition(this.cropper))&&this.cropperChange.emit(this.state.cropper()),(a||!this.state.equalsTransform(n)||this.state.options.backgroundColor!==s)&&this.doAutoCrop(),t.hidden&&this.resizedWhileHidden&&!this.hidden&&setTimeout(()=>{this.onResize(),this.resizedWhileHidden=!1})}onChangesInputImage(t){(t.imageChangedEvent||t.imageURL||t.imageBase64||t.imageFile)&&this.reset(),t.imageChangedEvent&&this.isValidImageChangedEvent()&&this.loadImageFile(this.imageChangedEvent.target.files[0]),t.imageURL&&this.imageURL&&this.loadImageFromURL(this.imageURL),t.imageBase64&&this.imageBase64&&this.loadBase64Image(this.imageBase64),t.imageFile&&this.imageFile&&this.loadImageFile(this.imageFile)}isValidImageChangedEvent(){let t=this.imageChangedEvent?.target?.files;return t instanceof FileList&&t.length>0}reset(){this.state.loadedImage=void 0,this.state.maxSize.set({width:0,height:0}),this.imageVisible=!1}loadImageFile(t){this.loadImageService.loadImageFile(t,this.state.options).then(r=>this.setLoadedImage(r)).catch(r=>this.loadImageError(r))}loadBase64Image(t){this.loadImageService.loadBase64Image(t,this.state.options).then(r=>this.setLoadedImage(r)).catch(r=>this.loadImageError(r))}loadImageFromURL(t){this.loadImageService.loadImageFromURL(t,this.state.options).then(r=>this.setLoadedImage(r)).catch(r=>this.loadImageError(r))}setLoadedImage(t){this.state.loadedImage=t,this.safeImgDataUrl.set(this.sanitizer.bypassSecurityTrustResourceUrl(t.transformed.objectUrl))}loadImageError(t){console.error(t),this.loadImageFailed.emit()}setCssTransform(){let t=this.state.transform?.translateUnit||"%";this.safeTransformStyle.set(this.sanitizer.bypassSecurityTrustStyle(`translate(${this.state.transform.translateH||0}${t}, ${this.state.transform.translateV||0}${t}) scaleX(`+(this.state.transform.scale||1)*(this.state.transform.flipH?-1:1)+") scaleY("+(this.state.transform.scale||1)*(this.state.transform.flipV?-1:1)+") rotate("+(this.state.transform.rotate||0)+"deg)"))}imageLoadedInView(){this.state.loadedImage!=null&&(this.imageLoaded.emit(this.state.loadedImage),this.setImageMaxSizeRetries=0,setTimeout(()=>this.checkImageMaxSizeRecursively()))}checkImageMaxSizeRecursively(){this.setImageMaxSizeRetries>40?this.loadImageFailed.emit():this.sourceImageLoaded()?(this.setMaxSize(),this.cropper&&(!this.maintainAspectRatio||this.state.aspectRatioIsCorrect())?(this.state.cropper.set(k(this.cropper,this.state,!0)),this.emitCropperPositionChange(this.cropper)):(this.state.cropper.set(k(this.state.maxSizeCropperPosition(),this.state,!0)),this.cropperChange.emit(this.state.cropper())),this.imageVisible=!0,this.cropperReady.emit(this.state.maxSize()),this.doAutoCrop()):(this.setImageMaxSizeRetries++,setTimeout(()=>this.checkImageMaxSizeRecursively(),50))}sourceImageLoaded(){return this.sourceImage?.nativeElement?.offsetWidth>1}onResize(){if(this.state.loadedImage)if(this.hidden)this.resizedWhileHidden=!0;else{let t=this.state.maxSize();this.setMaxSize(),this.state.resizeCropperPosition(t)}}keyboardAccess(t){this.changeKeyboardStepSize(t),this.keyboardMoveCropper(t)}changeKeyboardStepSize(t){let r=+t.key;r>=1&&r<=9&&(this.state.stepSize=r)}keyboardMoveCropper(t){if(!["ArrowUp","ArrowDown","ArrowRight","ArrowLeft"].includes(t.key))return;let n=t.shiftKey?b.Resize:b.Move,s=t.altKey?Qe(t.key):Ye(t.key),a=$e(t.key,this.state.stepSize);t.preventDefault(),t.stopPropagation(),this.moveStart={type:n,position:s,clientX:0,clientY:0,transform:this.state.transform,cropper:this.state.cropper()},this.handleMouseMove(a),this.handleMouseUp()}startMove(t,r,n=null){this.disabled||this.moveStart&&this.moveStart.type===b.Pinch||r===b.Drag&&!this.allowMoveImage||("preventDefault"in t&&t.preventDefault(),this.moveStart={type:r,position:n,clientX:Y(t),clientY:Q(t),transform:this.state.transform,cropper:this.state.cropper()},this.initMouseMove())}initMouseMove(){J(T(document,"mousemove"),T(document,"touchmove")).pipe(Z(J(T(document,"mouseup"),T(document,"touchend"),this.pinchStart$).pipe(ue()))).subscribe({next:t=>this.handleMouseMove(t),complete:()=>this.handleMouseUp()})}handleMouseMove(t){if(this.moveStart){if("stopPropagation"in t&&t.stopPropagation(),"preventDefault"in t&&t.preventDefault(),this.moveStart.type===b.Move)this.state.cropper.set(X(ke(t,this.moveStart),this.state,!0));else if(this.moveStart.type===b.Resize)!this.cropperStaticWidth&&!this.cropperStaticHeight&&this.state.cropper.set(X(ve(t,this.moveStart,this.state),this.state,!1));else if(this.moveStart.type===b.Drag){let r=Y(t)-this.moveStart.clientX,n=Q(t)-this.moveStart.clientY;this.state.transform=O(w({},this.state.transform),{translateH:(this.moveStart.transform?.translateH||0)+r,translateV:(this.moveStart.transform?.translateV||0)+n}),this.setCssTransform()}}}handleMouseUp(){!this.moveStart||this.moveStart.type===b.Pinch||((!this.state.equalsCropperPosition(this.moveStart.cropper)||this.moveStart.transform&&!this.state.equalsTransform(this.moveStart.transform))&&(this.moveStart.type===b.Drag?this.transformChange.emit(this.state.transform):this.cropperChange.emit(this.state.cropper()),this.doAutoCrop()),this.moveStart=void 0)}startPinch(t){if(this.disabled||!this.sourceImageLoaded()||t.touches.length<2)return;"preventDefault"in t&&t.preventDefault();let r=this.state.cropper();this.moveStart={type:b.Pinch,position:"center",clientX:r.x1+(r.x2-r.x1)/2,clientY:r.y1+(r.y2-r.y1)/2,cropper:r},this.initPinch()}initPinch(){this.pinchStart$.next(),T(document,"touchmove").pipe(Z(T(document,"touchend"))).subscribe({next:t=>this.handlePinchMove(t),complete:()=>this.handlePinchStop()})}handlePinchMove(t){this.moveStart&&(t.preventDefault&&t.preventDefault(),this.moveStart.type===b.Pinch&&!this.cropperStaticWidth&&!this.cropperStaticHeight&&this.state.cropper.set(X(ve(t,this.moveStart,this.state),this.state,!1)))}handlePinchStop(){this.moveStart&&(this.state.equalsCropperPosition(this.moveStart.cropper)||(this.emitCropperPositionChange(this.moveStart.cropper),this.doAutoCrop()),this.moveStart=void 0)}setMaxSize(){if(this.sourceImage){let t=getComputedStyle(this.sourceImage.nativeElement);this.state.setMaxSize(parseFloat(t.width),parseFloat(t.height)),this.marginLeft=this.sanitizer.bypassSecurityTrustStyle("calc(50% - "+this.state.maxSize().width/2+"px)")}}emitCropperPositionChange(t){this.state.equalsCropperPosition(t)||this.cropperChange.emit(this.state.cropper())}doAutoCrop(){this.state.options.autoCrop&&this.crop()}crop(t=this.state.options.output){if(this.state.loadedImage?.transformed?.image!=null){if(this.startCropImage.emit(),t==="blob")return this.cropToBlob();if(t==="base64")return this.cropToBase64()}return null}cropToBlob(){return new Promise((t,r)=>v(this,null,function*(){let n=yield this.cropService.crop(this.state.toCropInput(),"blob");n?(this.imageCropped.emit(n),t(n)):r("Crop image failed")}))}cropToBase64(){let t=this.cropService.crop(this.state.toCropInput(),"base64");return t?(this.imageCropped.emit(t),t):null}resetCropperPosition(){this.state.cropper.set(k(this.state.maxSizeCropperPosition(),this.state,!0)),this.cropperChange.emit(this.state.cropper())}ngOnDestroy(){this.pinchStart$.complete()}};e.\u0275fac=function(r){return new(r||e)(Ce(ze))},e.\u0275cmp=Me({type:e,selectors:[["image-cropper"]],viewQuery:function(r,n){if(r&1&&(te(Pe,7),te(Ae,5)),r&2){let s;ie(s=re())&&(n.wrapper=s.first),ie(s=re())&&(n.sourceImage=s.first)}},hostVars:6,hostBindings:function(r,n){r&1&&x("resize",function(){return n.onResize()},_e),r&2&&(A("text-align",n.alignImageStyle),q("disabled",n.disabled)("ngx-ic-hidden",n.hidden))},inputs:{imageChangedEvent:"imageChangedEvent",imageURL:"imageURL",imageBase64:"imageBase64",imageFile:"imageFile",imageAltText:"imageAltText",options:"options",cropperFrameAriaLabel:"cropperFrameAriaLabel",output:"output",format:"format",autoCrop:"autoCrop",cropper:"cropper",transform:"transform",maintainAspectRatio:"maintainAspectRatio",aspectRatio:"aspectRatio",resetCropOnAspectRatioChange:"resetCropOnAspectRatioChange",resizeToWidth:"resizeToWidth",resizeToHeight:"resizeToHeight",cropperMinWidth:"cropperMinWidth",cropperMinHeight:"cropperMinHeight",cropperMaxHeight:"cropperMaxHeight",cropperMaxWidth:"cropperMaxWidth",cropperStaticWidth:"cropperStaticWidth",cropperStaticHeight:"cropperStaticHeight",canvasRotation:"canvasRotation",initialStepSize:"initialStepSize",roundCropper:"roundCropper",onlyScaleDown:"onlyScaleDown",imageQuality:"imageQuality",backgroundColor:"backgroundColor",containWithinAspectRatio:"containWithinAspectRatio",hideResizeSquares:"hideResizeSquares",allowMoveImage:"allowMoveImage",checkImageType:"checkImageType",alignImage:"alignImage",disabled:"disabled",hidden:"hidden"},outputs:{imageCropped:"imageCropped",startCropImage:"startCropImage",imageLoaded:"imageLoaded",cropperReady:"cropperReady",loadImageFailed:"loadImageFailed",transformChange:"transformChange",cropperChange:"cropperChange"},features:[xe],decls:4,vars:10,consts:[["sourceImage",""],[3,"touchstart"],["class","ngx-ic-source-image","role","presentation",3,"src","visibility","transform","ngx-ic-draggable","load","mousedown","touchstart","error",4,"ngIf"],[1,"ngx-ic-overlay"],["class","ngx-ic-cropper","tabindex","0",3,"ngx-ic-round","top","left","width","height","margin-left","visibility","keydown",4,"ngIf"],["role","presentation",1,"ngx-ic-source-image",3,"load","mousedown","touchstart","error","src"],["tabindex","0",1,"ngx-ic-cropper",3,"keydown"],["role","presentation",1,"ngx-ic-move",3,"mousedown","touchstart"],[4,"ngIf"],["role","presentation",1,"ngx-ic-resize","ngx-ic-topleft",3,"mousedown","touchstart"],[1,"ngx-ic-square"],["role","presentation",1,"ngx-ic-resize","ngx-ic-topright",3,"mousedown","touchstart"],["role","presentation",1,"ngx-ic-resize","ngx-ic-bottomright",3,"mousedown","touchstart"],["role","presentation",1,"ngx-ic-resize","ngx-ic-bottomleft",3,"mousedown","touchstart"],["role","presentation",1,"ngx-ic-resize-bar","ngx-ic-top",3,"mousedown","touchstart"],[1,"ngx-ic-resize","ngx-ic-top",3,"mousedown","touchstart"],["role","presentation",1,"ngx-ic-resize-bar","ngx-ic-right",3,"mousedown","touchstart"],[1,"ngx-ic-resize","ngx-ic-right",3,"mousedown","touchstart"],["role","presentation",1,"ngx-ic-resize-bar","ngx-ic-bottom",3,"mousedown","touchstart"],[1,"ngx-ic-resize","ngx-ic-bottom",3,"mousedown","touchstart"],["role","presentation",1,"ngx-ic-resize-bar","ngx-ic-left",3,"mousedown","touchstart"],[1,"ngx-ic-resize","ngx-ic-left",3,"mousedown","touchstart"]],template:function(r,n){r&1&&(C(0,"div",1),x("touchstart",function(a){return n.startPinch(a)}),B(1,He,2,8,"img",2),I(2,"div",3),B(3,Fe,3,16,"div",4),M()),r&2&&(A("background",n.imageVisible&&n.state.options.backgroundColor),F(),U("ngIf",n.safeImgDataUrl()),F(),A("width",n.state.maxSize().width||0,"px")("height",n.state.maxSize().height||0,"px")("margin-left",n.state.options.alignImage==="center"?n.marginLeft:null),F(),U("ngIf",n.imageVisible))},dependencies:[be],styles:['[_nghost-%COMP%]{display:flex;position:relative;width:100%;max-width:100%;max-height:100%;overflow:hidden;padding:5px;text-align:center}[_nghost-%COMP%] > div[_ngcontent-%COMP%]{width:100%;position:relative}[_nghost-%COMP%] > div[_ngcontent-%COMP%]   img.ngx-ic-source-image[_ngcontent-%COMP%]{display:inline;max-width:100%;max-height:100%;transform-origin:center}[_nghost-%COMP%] > div[_ngcontent-%COMP%]   img.ngx-ic-source-image.ngx-ic-draggable[_ngcontent-%COMP%]{user-drag:none;-webkit-user-drag:none;user-select:none;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;cursor:grab}[_nghost-%COMP%]   .ngx-ic-overlay[_ngcontent-%COMP%]{position:absolute;pointer-events:none;touch-action:none;outline:var(--cropper-overlay-color, white) solid 100vw;top:0;left:0}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]{position:absolute;display:flex;color:var(--cropper-color, #53535C);background:transparent;outline:var(--cropper-outline-color, rgba(255, 255, 255, .3)) solid 100vw;touch-action:none}@media (orientation: portrait){[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]{outline-width:100vh}}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]:after{position:absolute;content:"";inset:0;pointer-events:none;border:dashed 1px;opacity:.75;color:inherit;z-index:1}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-move[_ngcontent-%COMP%]{width:100%;cursor:move;border:var(--cropper-border, 1px solid rgba(255, 255, 255, .5))}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]:hover   .ngx-ic-move[_ngcontent-%COMP%]{border:var(--cropper-hover-border, var(--cropper-border, 1px solid rgba(255, 255, 255, .5)))}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]:focus   .ngx-ic-move[_ngcontent-%COMP%]{border:var(--cropper-focus-border, 2px solid dodgerblue)}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]:focus   .ngx-ic-resize[_ngcontent-%COMP%]   .ngx-ic-square[_ngcontent-%COMP%]{background:var(--cropper-resize-square-focus-bg, var(--cropper-resize-square-bg, #53535C));border:var(--cropper-resize-square-focus-border, var(--cropper-resize-square-border, 1px solid rgba(255, 255, 255, .5)))}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize[_ngcontent-%COMP%]{position:absolute;display:inline-block;line-height:6px;padding:8px;opacity:.85;z-index:1}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize[_ngcontent-%COMP%]   .ngx-ic-square[_ngcontent-%COMP%]{display:inline-block;width:6px;height:6px;box-sizing:content-box;background:var(--cropper-resize-square-bg, #53535C);border:var(--cropper-resize-square-border, 1px solid rgba(255, 255, 255, .5))}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize[_ngcontent-%COMP%]:hover   .ngx-ic-square[_ngcontent-%COMP%]{background:var(--cropper-resize-square-hover-bg, var(--cropper-resize-square-bg, #53535C));border:var(--cropper-resize-square-hover-border, var(--cropper-resize-square-border, 1px solid rgba(255, 255, 255, .5)))}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-topleft[_ngcontent-%COMP%]{top:-12px;left:-12px;cursor:nwse-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-top[_ngcontent-%COMP%]{top:-12px;left:calc(50% - 12px);cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-topright[_ngcontent-%COMP%]{top:-12px;right:-12px;cursor:nesw-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-right[_ngcontent-%COMP%]{top:calc(50% - 12px);right:-12px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-bottomright[_ngcontent-%COMP%]{bottom:-12px;right:-12px;cursor:nwse-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-bottom[_ngcontent-%COMP%]{bottom:-12px;left:calc(50% - 12px);cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-bottomleft[_ngcontent-%COMP%]{bottom:-12px;left:-12px;cursor:nesw-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-left[_ngcontent-%COMP%]{top:calc(50% - 12px);left:-12px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar[_ngcontent-%COMP%]{position:absolute;z-index:1}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-top[_ngcontent-%COMP%]{top:-11px;left:11px;width:calc(100% - 22px);height:22px;cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-right[_ngcontent-%COMP%]{top:11px;right:-11px;height:calc(100% - 22px);width:22px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-bottom[_ngcontent-%COMP%]{bottom:-11px;left:11px;width:calc(100% - 22px);height:22px;cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-left[_ngcontent-%COMP%]{top:11px;left:-11px;height:calc(100% - 22px);width:22px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]{outline-color:transparent}[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]:after{border-radius:100%;box-shadow:0 0 0 100vw var(--cropper-outline-color, rgba(255, 255, 255, .3))}@media (orientation: portrait){[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]:after{box-shadow:0 0 0 100vh var(--cropper-outline-color, rgba(255, 255, 255, .3))}}[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]   .ngx-ic-move[_ngcontent-%COMP%]{border-radius:100%}.disabled[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize[_ngcontent-%COMP%], .disabled[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar[_ngcontent-%COMP%], .disabled[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-move[_ngcontent-%COMP%]{display:none}.ngx-ic-hidden[_nghost-%COMP%]{display:none}'],changeDetection:0});let o=e;return o})();function Ge(o,e){let i=[],t=0,r;for(let n=0;n<=e.length;n++)for(let s=0;s<=o.length;s++)n&&s?r=o.charAt(s-1)===e.charAt(n-1)?t:Math.min(i[s],i[s-1],t)+1:r=n+s,t=i[s],i[s]=r;return i.pop()||0}function Ne(o,e){if(o===void 0&&e===void 0)throw new Error("Trying to compare two undefined values");if(o===void 0||e===void 0)return 0;let i=String(o),t=String(e),r=Ge(i,t);return i.length>t.length?1-r/i.length:1-r/t.length}function Ke(o,e){let i=/[^\w, ]+/,t=e||2,r=`-${o.toLowerCase().replace(i,"")}-`,n=[];for(let s=0;s<r.length-t+1;s+=1)n.push(r.slice(s,s+t));return n}function Re(o,e){let i={};return Ke(o,e||2).forEach(r=>{r in i?i[r]+=1:i[r]=1}),i}function Je(o){for(let e in o)if(Object.prototype.hasOwnProperty.call(o,e))return!1;return!0}function $(o){if(typeof o!="string")throw new Error("Must use a string as argument to FuzzySet functions");return o.toLowerCase()}var G=class{version="0.0.1";arr;useLevenshtein;gramSizeLower;gramSizeUpper;exactSet={};matchDict={};items={};constructor(e,i,t,r){this.arr=e||[],this.useLevenshtein=i||!0,this.gramSizeLower=t||2,this.gramSizeUpper=r||3;for(let n=this.gramSizeLower;n<this.gramSizeUpper+1;n+=1)this.items[n]=[];this.arr.forEach(n=>{this.add(n)})}get(e,i){let t=this.getVal(e);return!t&&i?i:t}add(e){if(!($(e)in this.exactSet))for(let t=this.gramSizeLower;t<this.gramSizeUpper+1;t+=1)this.addVal(e,t)}length(){let e=0;for(let i in this.exactSet)Object.prototype.hasOwnProperty.call(this.exactSet,i)&&(e+=1);return e}isEmpty(){for(let e in this.exactSet)if(Object.prototype.hasOwnProperty.call(this.exactSet,e))return!1;return!0}values(){let e=[];for(let i in this.exactSet)Object.prototype.hasOwnProperty.call(this.exactSet,i)&&e.push(this.exactSet[i]);return e}getVal(e){let i=$(e),t=this.exactSet[i];if(t)return[[1,t]];for(let r=this.gramSizeUpper;r>=this.gramSizeLower;r-=1){let n=this.getValGram(e,r);if(n)return n}}getValGram(e,i){let t=$(e),r={},n=Re(t,i),s=this.items[i],a=0,c;for(let g in n)if(Object.prototype.hasOwnProperty.call(n,g)){let u=n[g];if(a+=Math.pow(u,2),g in this.matchDict)for(let z of this.matchDict[g]){let H=z[0];c=z[1],H in r?r[H]+=u*c:r[H]=u*c}}if(Je(r))return;let m=Math.sqrt(a),d=[],y;Object.keys(r).forEach(g=>{y=r[g];let u=parseInt(g,10);d.push([y/(m*s[u][0]),s[u][1]])});let f=(g,u)=>g[0]<u[0]?1:g[0]>u[0]?-1:0;if(d.sort(f),this.useLevenshtein){let g=[],u=Math.min(50,d.length);for(let z=0;z<u;z+=1)g.push([Ne(d[z][1],t),d[z][1]]);d=g,d.sort(f)}let _=[];for(let g of d)g[0]===d[0][0]&&_.push([g[0],this.exactSet[g[1]]]);return _}addVal(e,i){let t=$(e),r=this.items[i]||[],n=r.length;r.push(0);let s=Re(t,i),a=0;for(let m in s)if(Object.prototype.hasOwnProperty.call(s,m)){let d=s[m];a+=Math.pow(d,2),m in this.matchDict?this.matchDict[m].push([n,d]):this.matchDict[m]=[[n,d]]}let c=Math.sqrt(a);r[n]=[c,t],this.items[i]=r,this.exactSet[t]=e}};function _t(o){return o.split(/[.,\\/ -]/).map(e=>e.trim()).filter(e=>e.length>0)}function Ze(o){return o.replace(/\.[^/.]+$/,"")}function et(o){return o.substring(o.lastIndexOf(".")+1,o.length)||o}function Ct(o,e){return e.includes(et(o))}function Mt(o,e){return o.toString().replace(/:/g," - ").replace(/[?/!\\]/g,e)}function wt(o){if(!o)return 0;let i=Ze(o).split(/[ \-_.:;?!~,`"&|()<>{}[\]\r\n/\\]+/).map(Number).filter(t=>!isNaN(t));return i.length>0?i[0]:0}function yt(o,e){let i=new G;i.add(o);let t=i.get(e);return t?t[0][0]:0}function zt(o){let e="",i=new Uint8Array(o),t=i.byteLength;for(let r=0;r<t;r++)e+=String.fromCharCode(i[r]);return window.btoa(e)}export{mt as a,_t as b,Ze as c,et as d,Ct as e,Mt as f,wt as g,yt as h,zt as i};
