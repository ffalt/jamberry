import{k as S}from"./chunk-6SWJ3F4P.js";import{Db as l,Eb as d,Nb as c,Nd as x,Ob as g,Pb as O,Pc as n,Wa as m,Wb as f,Wd as M,Xb as p,_a as b,ac as u,bc as r,fa as v,ka as a,la as s,mc as w,nb as h,nc as y,ya as _}from"./chunk-XLNNDSL4.js";function j(o,C){o&1&&O(0,"i",0)}function D(o,C){if(o&1){let e=f();l(0,j,1,0,"i",0),c(1,"img",1),u("load",function(){a(e);let i=r();return s(i.onLoad())}),g()}if(o&2){let e=r();d(e.loading?0:-1),b(),p("src",e.data.url,m)("alt",e.data.name)}}var z=(()=>{class o{constructor(){this.loading=!0}dialogInit(e,t){this.data=t.data}onLoad(){this.loading=!1}static{this.\u0275fac=function(t){return new(t||o)}}static{this.\u0275cmp=h({type:o,selectors:[["app-image-overlay-content"]],decls:1,vars:1,consts:[[1,"icon-spinner","icon-spin"],[3,"load","src","alt"]],template:function(t,i){t&1&&l(0,D,2,3),t&2&&d(i.data?0:-1)},styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;align-items:center}[_nghost-%COMP%]   img[_ngcontent-%COMP%]{width:100%;max-width:500px;height:auto}"]})}}return o})();function E(o,C){if(o&1){let e=f();c(0,"img",1),u("click",function(i){a(e);let I=r();return s(I.showImageOverlay(i))})("load",function(){a(e);let i=r();return s(i.onImgLoad())}),g()}if(o&2){let e=r();p("src",e.imageSrc,m)("alt",e.altSrc)}}var B=(()=>{class o{constructor(){this.coverArtObj=n(),this.size=n(),this.alt=n(""),this.refreshRandom=n(""),this.allowEnlarge=n(!1),this.fill=n(!1),this.round=n(!1),this.border=n(!0),this.hoverBorder=n(!1),this.isLoaded=!1,this.imageSrc="",this.altSrc="",this.jam=v(M),this.dialogOverlay=v(S)}ngAfterContentInit(){this.updateSize(),this.buildUrl()}updateSize(){let e=this.size();this.fill()?(this.minSize=void 0,this.hostSize=void 0):e&&(this.minSize=e-(this.border()?2:0),this.hostSize=this.minSize)}ngOnChanges(e){e.coverArtObj?.currentValue&&(this.isLoaded?this.buildUrl():(this.imageSrc="",this.buildUrl())),this.isLoaded&&e.refreshRandom&&this.buildUrl(),!(this.imageSrc.length>0)&&(e.size||e.border||e.fill)&&this.updateSize()}onImgLoad(){this.isLoaded=!0,this.altSrc=this.alt()}showImageOverlay(e){let t=this.coverArtObj();this.allowEnlarge()&&t&&(e.stopPropagation(),this.dialogOverlay.open({childComponent:z,title:t.name,data:{name:t.name,url:this.jam.image.imageUrl({id:t.id})}}))}buildUrl(){let e=this.coverArtObj();if(e){let t=this.jam.image.imageUrl({id:e.id,size:this.size(),format:x.webp}),i=this.refreshRandom();i&&(t+=`${t.includes("?")?"&":"?"}refresh=${i}`),this.imageSrc=t}}static{this.\u0275fac=function(t){return new(t||o)}}static{this.\u0275cmp=h({type:o,selectors:[["app-coverart-image"]],hostVars:16,hostBindings:function(t,i){t&2&&(w("min-width",i.minSize,"px")("min-height",i.minSize,"px")("width",i.hostSize,"px")("height",i.hostSize,"px"),y("fill",i.fill())("round",i.round())("border",i.border())("border-hover",i.hoverBorder()))},inputs:{coverArtObj:[1,"coverArtObj"],size:[1,"size"],alt:[1,"alt"],refreshRandom:[1,"refreshRandom"],allowEnlarge:[1,"allowEnlarge"],fill:[1,"fill"],round:[1,"round"],border:[1,"border"],hoverBorder:[1,"hoverBorder"]},features:[_],decls:1,vars:1,consts:[[3,"src","alt"],[3,"click","load","src","alt"]],template:function(t,i){t&1&&l(0,E,1,2,"img",0),t&2&&d(i.imageSrc?0:-1)},styles:["[_nghost-%COMP%]{display:block;overflow:hidden}[_nghost-%COMP%]   img[_ngcontent-%COMP%]{border:0;display:inline;height:auto;width:100%;text-align:center;object-fit:contain}.round[_nghost-%COMP%]{border-radius:50%}.fill[_nghost-%COMP%]{display:block;width:100%;height:100%;max-width:100%;max-height:100%;min-width:inherit!important;min-height:inherit!important;text-align:center;overflow:hidden}.fill[_nghost-%COMP%]   img[_ngcontent-%COMP%]{display:block;width:100%;height:100%}.border[_nghost-%COMP%]{border:1px solid var(--control-border)}.border-hover[_nghost-%COMP%]:hover{border:1px solid var(--control-border-hover)}"]})}}return o})();export{B as a};
