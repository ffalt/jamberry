import{a as D}from"./chunk-6T4XJRB7.js";import{a as N}from"./chunk-RQOW2HPH.js";import{c as F}from"./chunk-XP5ERWDG.js";import{a as b,b as V}from"./chunk-DQG43WHL.js";import{a as w}from"./chunk-6VWQ7JC4.js";import{d as g}from"./chunk-D2CLWX7O.js";import"./chunk-AQDYGNZB.js";import{G as v}from"./chunk-ZVKVGF76.js";import"./chunk-T6GM3CFW.js";import{$d as h,Hb as p,Ib as m,Nb as P,Ob as a,Pb as _,Qb as l,Ub as R,Vb as T,Xd as E,Y as k,_d as M,a as I,ab as s,ac as r,ae as X,b as x,dc as O,fc as U,ia as S,k as L,nb as f,tc as B,uc as z,wd as A}from"./chunk-H2EXZDP6.js";function q(i,n){i&1&&l(0,"i",7)}function K(i,n){i&1&&(a(0,"span"),r(1,2),_())}var J=(()=>{let n=class n{constructor(){this.auth=S(M),this.app=S(F),this.refreshing=!1,this.unsubscribe=new L,this.jam=S(h),this.notify=S(v),this.refreshRandom=N()}ngOnDestroy(){this.unsubscribe.next(),this.unsubscribe.complete()}onDropFile(e){e.preventDefault(),this.uploadFile(e.dataTransfer?.files)}onDragOverFile(e){e.stopPropagation(),e.preventDefault()}selectFile(e){let t=e.target.files;this.uploadFile(t)}uploadFile(e){if(!e||e.length===0||!this.auth.user)return;let o=e[0];this.jam.user.uploadUserImage({id:this.auth.user.id},o).pipe(k(this.unsubscribe)).subscribe({next:()=>{},error:t=>{this.notify.error(t)},complete:()=>{this.refreshRandom=N(),this.notify.success("Upload done")}})}randomAvatar(){this.refreshing||!this.auth.user||(this.refreshing=!0,this.jam.user.generateUserImage({id:this.auth.user.id}).then(()=>{this.refreshing=!1,this.refreshRandom=N(),this.notify.success("Image randomized")}).catch(e=>{this.refreshing=!1,this.notify.error(e)}))}};n.\u0275fac=function(o){return new(o||n)},n.\u0275cmp=f({type:n,selectors:[["app-user-avatar"]],decls:11,vars:5,consts:()=>{let e;e=$localize`:␟d833321cc90a0b0a52714c6d5ec97fbe6c7cfa5c␟2501989539336327542:Upload image`;let o;o=$localize`:␟b2e9fc8efba33bcc232b6d16acf15ed22e9b066f␟3096061700616912177: Drag an Image File here `;let t;t=$localize`:␟3a2a9bb12d904f3dd84e42cfad37afef4a6b35f6␟3825771792569625715:Choose a file`;let d;return d=$localize`:␟c1ba8ac278d9bdb189e23866675d475089dce2ae␟4360279154190126867:Random Image`,[o,t,d,[1,"drop-zone",3,"dragover","drop"],[1,"placeholder"],[3,"coverArtObj","refreshRandom","round","size"],[1,"button-primary",3,"click"],[1,"icon-spin","icon-spinner"],["accept",".png,.jpeg,.jpg","id","file","placeholder",e,"type","file",1,"inputfile",3,"change"],["for","file",1,"button-primary"]]},template:function(o,t){o&1&&(a(0,"div",3),O("dragover",function(c){return t.onDragOverFile(c)})("drop",function(c){return t.onDropFile(c)}),a(1,"div",4),r(2,0),_(),l(3,"app-coverart-image",5),a(4,"button",6),O("click",function(){return t.randomAvatar()}),p(5,q,1,0,"i",7)(6,K,2,0,"span"),_(),a(7,"form")(8,"input",8),O("change",function(c){return t.selectFile(c)}),_(),a(9,"label",9),r(10,1),_()()()),o&2&&(s(3),P("coverArtObj",t.auth.user)("refreshRandom",t.refreshRandom)("round",!0)("size",100),s(2),m(t.refreshing?5:6))},dependencies:[A,w],styles:["[_nghost-%COMP%]   .drop-zone[_ngcontent-%COMP%]{vertical-align:bottom;display:inline-block;min-width:220px;min-height:140px;border-width:2px;margin-bottom:15px;margin-right:15px;border-style:dotted;border-color:var(--secondary);padding-left:15px;padding-right:15px;padding-bottom:15px;text-align:center}[_nghost-%COMP%]   .drop-zone[_ngcontent-%COMP%]   app-coverart-image[_ngcontent-%COMP%]{margin:0 auto 10px}[_nghost-%COMP%]   .drop-zone[_ngcontent-%COMP%]   .inputfile[_ngcontent-%COMP%]{width:.1px;height:.1px;opacity:0;overflow:hidden;position:absolute;z-index:-1}[_nghost-%COMP%]   .drop-zone[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-bottom:10px;min-width:80%;display:inline-block}[_nghost-%COMP%]   .drop-zone[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{display:inline-block;min-width:80%}[_nghost-%COMP%]   .drop-zone[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{width:100%;display:block}[_nghost-%COMP%]   .drop-zone[_ngcontent-%COMP%]   .placeholder[_ngcontent-%COMP%]{width:100%;padding-top:15px;padding-bottom:15px;text-align:center;color:var(--on-control-ambient);font-size:.8em;text-transform:uppercase}"]});let i=n;return i})();var H=(()=>{let n=class n{constructor(){this.base=[],this.favorites=[],this.played=[],this.jam=S(h),this.auth=S(M),this.notify=S(v)}ngOnInit(){this.auth.isLoggedIn()&&this.refresh()}refresh(){this.jam.stats.user().then(e=>{this.favorites=n.buildStats(e.favorite,"/favorites"),this.played=n.buildStats(e.played,"/recently-played"),this.base=b([{text:"Bookmarks",link:"/library/bookmarks",value:e.bookmark},{text:"Playlists",link:"/library/playlists",value:e.playlist}],!0)}).catch(e=>{this.notify.error(e)})}static buildStats(e,o=""){return b([{text:"Artists",link:"artists",value:e.artistTypes.album},...[{type:g(E.album),value:e.albumTypes.album},{type:g(E.compilation),value:e.albumTypes.compilation}].map(t=>({text:t.type?.text,link:`${t.type?.id}`,value:t.value})),{text:"Series",link:"series",value:e.series},...[{type:g(E.audiobook),value:e.albumTypes.audiobook},{type:g(E.soundtrack),value:e.albumTypes.soundtrack},{type:g(E.live),value:e.albumTypes.live},{type:g(E.bootleg),value:e.albumTypes.bootleg},{type:g(E.ep),value:e.albumTypes.ep},{type:g(E.single),value:e.albumTypes.single}].map(t=>({text:t.type?.text,link:t.type?.id,value:t.value})),{text:"Folders",link:"folders",value:e.folder},{text:"Tracks",link:"tracks",value:e.track}].map(t=>x(I({},t),{link:`/library/${t.link}${o}`})))}};n.\u0275fac=function(o){return new(o||n)},n.\u0275cmp=f({type:n,selectors:[["app-user-stats"]],decls:9,vars:3,consts:()=>{let e;e=$localize`:␟299f97b8ee9c62d45f2cc01961aa1e5101d6d05a␟4088311569349098646:Stats`;let o;o=$localize`:␟0add707baf7b167d0c0e9cdeb80f946aa1bd2223␟4085930761302974863:Favorites`;let t;return t=$localize`:␟73565b2d231303b7ff6f28663a72abb1b3bd1890␟7754730602038897709:Played`,[e,o,t,[1,"section-title"],[3,"stats"]]},template:function(o,t){o&1&&(a(0,"div",3),r(1,0),_(),l(2,"app-stats",4),a(3,"div",3),r(4,1),_(),l(5,"app-stats",4),a(6,"div",3),r(7,2),_(),l(8,"app-stats",4)),o&2&&(s(2),P("stats",t.base),s(3),P("stats",t.favorites),s(3),P("stats",t.played))},dependencies:[A,X,V],styles:["[_nghost-%COMP%]   .section-title[_ngcontent-%COMP%]{text-transform:uppercase;letter-spacing:1.25px;font-size:13.2px;margin-top:15px;margin-bottom:10px;color:var(--on-control-ambient)}"]});let i=n;return i})();function Q(i,n){i&1&&(a(0,"div"),l(1,"i",16),R(2),r(3,3),T(),_())}function W(i,n){i&1&&(a(0,"div"),l(1,"i",16),R(2),r(3,4),T(),_())}function Y(i,n){i&1&&(a(0,"div"),l(1,"i",16),R(2),r(3,5),T(),_())}function Z(i,n){i&1&&(a(0,"div"),l(1,"i",16),R(2),r(3,6),T(),_())}function ee(i,n){if(i&1&&(a(0,"div",14)(1,"div",12),r(2,2),_(),a(3,"div",15),p(4,Q,4,0,"div"),p(5,W,4,0,"div"),p(6,Y,4,0,"div"),p(7,Z,4,0,"div"),_()()),i&2){let u=U(2);s(4),m(u.auth.user.roles.stream?4:-1),s(),m(u.auth.user.roles.podcast?5:-1),s(),m(u.auth.user.roles.upload?6:-1),s(),m(u.auth.user.roles.admin?7:-1)}}function te(i,n){if(i&1&&(a(0,"div",9)(1,"div",10)(2,"div",11)(3,"div",12),r(4,0),_(),l(5,"app-user-avatar"),_(),a(6,"div",13)(7,"div",14)(8,"div",12),r(9,1),_(),a(10,"div"),B(11),_()(),p(12,ee,8,4,"div",14),_()(),a(13,"div",14),l(14,"app-user-stats"),_()()),i&2){let u=U();s(11),z(u.auth.user.name),s(),m(u.auth.user.roles?12:-1)}}var Ne=(()=>{let n=class n{constructor(){this.auth=S(M)}};n.\u0275fac=function(o){return new(o||n)},n.\u0275cmp=f({type:n,selectors:[["app-user-page"]],decls:3,vars:1,consts:()=>{let e;e=$localize`:␟e08a77594f3d89311cdf6da5090044270909c194␟2392488717875840729:User`;let o;o=$localize`:␟cebb7f27b5028c62b4426da3bb3e3bd3f4a3443b␟6525109356951792180:Avatar`;let t;t=$localize`:␟cff1428d10d59d14e45edec3c735a27b5482db59␟8953033926734869941:Name`;let d;d=$localize`:␟70f45880fce6ac5d8e468e25e82aefbba8098cfe␟7314814725704332646:Permissions`;let c;c=$localize`:␟0c1153af20b06ee1f31e7d07eebfada81b9a19b2␟7231504695490320052:Stream Audio`;let y;y=$localize`:␟f47ba1cd01c3dfd801fe7f66c3d28d698dcc0479␟1291164613191345064:Manage Podcasts`;let G;G=$localize`:␟7876f698ec2db992452b14bd66e0ed1261d890e8␟5793950743388475134:Upload Audio`;let $;return $=$localize`:␟76046fa6f13fb0524ca1d3777247ab13d73660c8␟2210415377969858551:Server Administration`,[o,t,d,c,y,G,$,[1,"user"],["section",e],[1,"content"],[1,"row"],[1,"column","first"],[1,"section-title"],[1,"column"],[1,"section"],[1,"roles"],[1,"icon-checkmark"]]},template:function(o,t){o&1&&(a(0,"div",7),l(1,"app-view-header-slim",8),p(2,te,15,2,"div",9),_()),o&2&&(s(2),m(t.auth.user?2:-1))},dependencies:[A,J,H,D],styles:["[_nghost-%COMP%]   .user[_ngcontent-%COMP%]{height:100%;overflow-y:auto;overflow-x:hidden}[_nghost-%COMP%]   .user[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{padding:0 5px 5px}[_nghost-%COMP%]   .user[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{text-transform:uppercase;letter-spacing:1.25px;font-size:13.2px;margin-bottom:10px;color:var(--on-control-ambient)}@media (max-width: 522px){[_nghost-%COMP%]   .user[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{padding-left:10px;padding-right:10px}}[_nghost-%COMP%]   .user[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{padding:15px 15px 60px}[_nghost-%COMP%]   .user[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]{padding-bottom:30px}[_nghost-%COMP%]   .user[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:5px}@media (max-width: 400px){[_nghost-%COMP%]   .user[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{flex-direction:column}}"]});let i=n;return i})();export{Ne as UserPageComponent};
