import{a as l}from"./chunk-VSMEHVNZ.js";import{a as O}from"./chunk-W2NMQGHF.js";import{a as N}from"./chunk-PZTZCA44.js";import{G as Q}from"./chunk-ZVKVGF76.js";import{Aa as c,Hb as u,Ib as h,Nb as b,Ob as y,Pb as M,Qb as p,Vc as a,Wc as w,ab as m,dc as j,e as r,fc as v,ia as g,nb as f,nc as C,oc as _}from"./chunk-H2EXZDP6.js";function q(s,i){s&1&&p(0,"app-loading")}function D(s,i){if(s&1&&p(0,"app-obj-groups-view",0),s&2){let d=v();b("objs",d.objs)("showParent",d.showParent())("typeName",i.typeName)("grouping",d.grouping())}}var S=(()=>{let i=class i{constructor(){this.grouping=a(!1),this.showParent=a(!1),this.loader=a(),this.listQuery=a(),this.searchQuery=a(),this.loadAll=a(!1),this.changeTrigger=a(),this.notify=g(Q),this.loadMore=w.required(l)}getObjs(t){let e=this.loadMore();e.loading.set(!0);let o=t().then(n=>{this.activeRequest===o&&(this.objs=[...this.objs??[],...n.items],e.hasMore.set((n.list.total??0)>this.objs.length),e.total.set(n.list.total),e.loading.set(!1))}).catch(n=>{this.activeRequest===o&&e.loading.set(!1),this.notify.error(n)});this.activeRequest=o}load(){let t=this.loader();if(!t){this.objs=[];return}let e=this.searchQuery();if(e){this.getObjs(()=>r(this,null,function*(){return t.search(e,this.loadMore().skip(),this.loadMore().take())}));return}let o=this.listQuery();if(o){this.getObjs(()=>r(this,null,function*(){return t.list(o,this.loadMore().skip(),this.loadMore().take())}));return}if(this.loadAll()){this.getObjs(()=>r(this,null,function*(){return t.all(this.loadMore().skip(),this.loadMore().take())}));return}this.objs=[]}ngOnChanges(){let t=this.loadMore();t.skip.set(0),t.total.set(0),t.hasMore.set(!1),this.objs=void 0,this.load()}};i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=f({type:i,selectors:[["app-obj-loader"]],viewQuery:function(e,o){e&1&&C(o.loadMore,l,5),e&2&&_()},inputs:{grouping:[1,"grouping"],showParent:[1,"showParent"],loader:[1,"loader"],listQuery:[1,"listQuery"],searchQuery:[1,"searchQuery"],loadAll:[1,"loadAll"],changeTrigger:[1,"changeTrigger"]},features:[c],decls:3,vars:2,consts:[[3,"objs","showParent","typeName","grouping"],[3,"requestLoad"]],template:function(e,o){if(e&1&&(u(0,q,1,0,"app-loading"),u(1,D,1,4,"app-obj-groups-view",0),y(2,"app-load-more-button",1),j("requestLoad",function(){return o.load()}),M()),e&2){let n;h(o.objs?-1:0),m(),h((n=o.loader())?1:-1,n)}},dependencies:[O,l,N],encapsulation:2});let s=i;return s})();export{S as a};
