import{a as he,b as de,c as ye,d as _e}from"./chunk-6UV7XVIR.js";import{b as V,c as Q,d as Y}from"./chunk-SDT7PSNL.js";import{b as ae}from"./chunk-4K2FA6DD.js";import{a as be}from"./chunk-AIQOHZWK.js";import{c as me}from"./chunk-ORVGIZVG.js";import{d as ge}from"./chunk-MHPFTM2Z.js";import{a as ue,g as pe}from"./chunk-D2CLWX7O.js";import{a as Te}from"./chunk-W76RWN3H.js";import{G as ce}from"./chunk-ZVKVGF76.js";import{$d as oe,Hb as se,Ib as ne,Kb as le,Lb as k,Ld as o,Mb as R,Nb as ie,Ob as D,Pb as B,Qb as p,Ub as f,Vb as C,Wc as G,Wd as J,Xd as j,_b as v,ab as T,ac as x,da as re,dc as b,e as n,fc as E,ia as _,na as h,nb as A,nc as $,oa as d,oc as L,sb as y,sc as F,tc as X,vc as U}from"./chunk-H2EXZDP6.js";var q=class{constructor(e){this.base=e,this.name=e.name,this.id=e.id}};var m=class extends q{constructor(e,a){super(e),this.base=e,this.library=a}download(){this.library.actions.download(this.base)}onContextMenu(e,a){this.library.openJamObjectMenu(this,e,{hideGoto:a})}},M=class extends m{constructor(e,a){super(e,a),this.album=e,this.type=o.album,this.childrenTypes=[o.track],this.year=e.seriesNr?`Episode ${e.seriesNr}`:`${e.year??""}`,this.parent=e.artistName,this.mediaType=e.albumType,this.group=e.albumType,e.albumType===j.series&&Number.isNaN(e.seriesNr??"")&&(this.group=`${e.albumType} Extras`),this.genre=e.genres?.length?e.genres.map(i=>i.name).join(" / "):void 0}navigTo(){this.library.navig.toAlbum(this.album)}play(){this.library.player.startAlbum(this.album)}navigToParent(){this.library.navig.toArtistID(this.album.artistID,this.album.artistName)}toggleFav(){return n(this,null,function*(){return this.library.actions.toggleAlbumFav(this.album)})}loadChildren(){return n(this,null,function*(){if(!this.tracks)try{let e=yield this.library.jam.album.tracks({ids:[this.base.id],trackIncTag:!0,trackIncState:!0});this.tracks=e.items}catch(e){this.tracks=[],this.library.notify.error(e)}})}groupType(){return this.group}addToPlaylist(){this.library.playlistDialogsService.addAlbum(this.album)}addToQueue(){this.library.player.addAlbum(this.album)}getInfos(){return this.album.albumType===j.series?[{label:"Artist",value:this.album.artistName,click:()=>{this.navigToParent()}},{label:"Series",value:this.album.seriesID?this.album.series:void 0,click:()=>{this.library.navig.toSeriesID(this.album.seriesID??"",this.album.series??"")}},{label:"Episode",value:this.album.seriesNr}].filter(e=>e.value!==void 0):[{label:"Artist",value:this.album.artistName,click:()=>{this.navigToParent()}},{label:"Year",value:this.album.year},{label:"Genre",value:this.genre}].filter(e=>e.value!==void 0)}},S=class extends m{constructor(e,a){switch(super(e,a),this.folder=e,this.type=o.folder,this.childrenTypes=[o.track,o.folder],this.name=e.name,this.mediaType=e.type,this.genre=e.tag?.genres?.length?e.tag.genres.join(" / "):void 0,e.type){case J.artist:{this.name=e.tag?.artist??"[Unknown Artist]";break}case J.album:case J.multialbum:{this.name=e.tag?.album??"[Unknown Album]",this.parent=e.tag?.artist,this.year=e.tag?.year?`${e.tag.year}`:void 0;break}default:}}navigTo(){this.library.navig.toFolder(this.folder)}play(){this.library.player.startFolder(this.folder)}navigToParent(){this.folder.parentID&&this.library.navig.toFolderID(this.folder.parentID,"")}toggleFav(){return n(this,null,function*(){return this.library.actions.toggleFolderFav(this.folder)})}loadChildren(){return n(this,null,function*(){if(!this.tracks)try{let e=yield this.library.jam.folder.tracks({ids:[this.base.id],trackIncTag:!0,trackIncState:!0});this.tracks=e.items}catch(e){this.tracks=[],this.library.notify.error(e)}})}groupType(){return this.folder.type}addToPlaylist(){this.library.playlistDialogsService.addFolder(this.folder)}addToQueue(){this.library.player.addFolder(this.folder)}getInfos(){return(pe.includes(this.folder.type)?[{label:"Artist",value:this.folder.tag?.artist},{label:"Year",value:this.folder.tag?.year},{label:"Genre",value:this.genre}]:[]).filter(e=>e.value!==void 0)}},I=class extends m{constructor(e,a){super(e,a),this.artist=e,this.type=o.artist,this.mediaType=o.artist,this.childrenTypes=[o.album,o.series],this.name=this.artist.name,this.genre=e.genres?.length?e.genres.map(i=>i.name).join(" / "):void 0}navigTo(){this.library.navig.toArtist(this.artist)}play(){this.library.player.startArtist(this.artist)}navigToParent(){}toggleFav(){return n(this,null,function*(){return this.library.actions.toggleArtistFav(this.artist)})}loadChildren(){return n(this,null,function*(){if(!this.albums)try{let e=yield this.library.jam.artist.albums({ids:[this.base.id],albumIncState:!0});this.albums=e.items}catch(e){this.library.notify.error(e)}})}groupType(){return this.artist.albumTypes.join("/")}addToPlaylist(){this.library.playlistDialogsService.addArtist(this.artist)}addToQueue(){this.library.player.addArtist(this.artist)}getInfos(){return[{label:"Albums",value:this.artist.albumCount},{label:"Tracks",value:this.artist.trackCount},{label:"Genre",value:this.genre}].filter(e=>e.value!==void 0)}},N=class extends m{constructor(e,a){super(e,a),this.playlist=e,this.type=o.playlist,this.childrenTypes=["media"],this.name=this.playlist.name}navigTo(){this.library.navig.toPlaylist(this.playlist)}play(){this.library.player.startPlaylist(this.playlist)}navigToParent(){}toggleFav(){return n(this,null,function*(){return this.library.actions.togglePlaylistFav(this.playlist)})}onContextMenu(e,a){let i=[];this.playlist.userID===this.library.jam.auth.user?.id&&(i=[{text:"Edit Playlist",icon:"icon-edit",click:()=>{this.library.playlistDialogsService.editPlaylist(this.playlist)}},{text:"Remove Playlist",icon:"icon-remove",click:()=>{this.library.playlistDialogsService.removePlaylist(this.playlist)}}]),this.library.openJamObjectMenu(this,e,{extras:i,hideGoto:a})}loadChildren(){return n(this,null,function*(){if(!this.tracks)try{let e=yield this.library.jam.playlist.entries({ids:[this.base.id],trackIncTag:!0,trackIncState:!0,episodeIncTag:!0,episodeIncState:!0});this.media=e.items}catch(e){this.library.notify.error(e)}})}groupType(){return this.playlist.isPublic?"Public":"Private"}addToPlaylist(){this.library.playlistDialogsService.addPlaylist(this.playlist)}addToQueue(){this.library.player.addPlaylist(this.playlist)}getInfos(){return[]}},fe=class extends m{constructor(e,a){super(e,a),this.track=e,this.type=o.track,this.mediaType=o.track,this.childrenTypes=[],this.name=e.tag?.title??e.name,this.genre=e.tag?.genres?e.tag.genres.join(" / "):void 0}navigTo(){this.library.navig.toTrack(this.track)}play(){this.library.player.startTrack(this.track)}navigToParent(){}toggleFav(){return n(this,null,function*(){return this.library.actions.toggleMediaBaseFav(this.track)})}loadChildren(){return n(this,null,function*(){if(!this.tracks)try{let e=yield this.library.jam.playlist.entries({ids:[this.base.id],trackIncTag:!0,trackIncState:!0,episodeIncState:!0,episodeIncTag:!0});this.media=e.items}catch(e){this.library.notify.error(e)}})}groupType(){return this.track.tag?.genres?this.track.tag.genres.join(" / "):""}addToPlaylist(){this.library.playlistDialogsService.addTrack(this.track)}addToQueue(){this.library.player.addTrack(this.track)}getInfos(){return[{label:"Artist",value:this.track.tag?.artist,click:()=>{this.library.navig.toArtistID(this.track.artistID??"",this.track.tag?.artist??"")}},{label:"Album",value:this.track.tag?.album,click:()=>{this.library.navig.toAlbumID(this.track.albumID??"",this.track.tag?.album??"")}},{label:"Genre",value:this.genre}].filter(e=>e.value!==void 0)}},O=class extends m{constructor(e,a){super(e,a),this.genreObj=e,this.type=o.genre,this.childrenTypes=[]}navigTo(){this.library.navig.toGenre(this.genreObj)}play(){}navigToParent(){}toggleFav(){return n(this,null,function*(){return this.library.actions.toggleGenreFav(this.genreObj)})}loadChildren(){return n(this,null,function*(){})}groupType(){return""}addToPlaylist(){}addToQueue(){}getInfos(){return[]}},w=class extends m{constructor(e,a){super(e,a),this.series=e,this.type=o.series,this.mediaType=o.series,this.childrenTypes=[o.album],this.name=this.series.name,this.parent=this.series.artist}navigTo(){this.library.navig.toSeries(this.series)}play(){this.library.player.startSeries(this.series)}navigToParent(){this.library.navig.toArtistID(this.series.artistID,this.series.artist)}toggleFav(){return n(this,null,function*(){return this.library.actions.toggleSeriesFav(this.series)})}loadChildren(){return n(this,null,function*(){if(!this.albums)try{let e=yield this.library.jam.series.albums({ids:[this.base.id],albumIncState:!0});this.albums=e.items}catch(e){this.library.notify.error(e)}})}groupType(){return this.series.albumTypes.join("/")}addToPlaylist(){this.library.playlistDialogsService.addSeries(this.series)}addToQueue(){this.library.player.addSeries(this.series)}getInfos(){return[{label:"Artist",value:this.series.artist,click:()=>{this.navigToParent()}},{label:"Albums",value:this.series.albumCount},{label:"Genre",value:this.genre}].filter(e=>e.value!==void 0)}},P=class extends m{constructor(e,a){super(e,a),this.podcast=e,this.type=o.podcast,this.mediaType=o.podcast,this.childrenTypes=[o.episode],this.name=this.podcast.name}navigTo(){this.library.navig.toPodcast(this.podcast)}play(){this.library.player.startPodcast(this.podcast)}navigToParent(){}toggleFav(){return n(this,null,function*(){return this.library.actions.togglePodcastFav(this.podcast)})}onContextMenu(e,a){let i=this.library.jam.auth.user?.roles.podcast?[{text:"Refresh Podcast Feed",icon:"icon-rescan",click:()=>{this.library.podcastService.checkPodcast(this.podcast)}},{text:"Remove Podcast",icon:"icon-remove",click:()=>{this.library.podcastService.removePodcast(this.podcast)}}]:[];this.library.openJamObjectMenu(this,e,{extras:i,hideGoto:a})}loadChildren(){return n(this,null,function*(){if(!this.episodes)try{let e=yield this.library.jam.episode.search({podcastIDs:[this.base.id],episodeIncTag:!0,episodeIncState:!0,take:10});this.episodes=e.items}catch(e){this.library.notify.error(e)}})}groupType(){return""}addToPlaylist(){this.library.playlistDialogsService.addPodcast(this.podcast)}addToQueue(){this.library.player.addPodcast(this.podcast)}getInfos(){return[]}},Ce=class extends m{constructor(e,a){super(e,a),this.episode=e,this.type=o.episode,this.mediaType=o.episode,this.childrenTypes=[],this.name=this.episode.name,this.parent=this.episode.podcastName}navigTo(){this.library.navig.toPodcastEpisode(this.episode)}play(){this.library.player.startEpisode(this.episode)}navigToParent(){this.library.navig.toPodcastID(this.episode.podcastID,this.episode.podcastName)}toggleFav(){return n(this,null,function*(){return this.library.actions.toggleMediaBaseFav(this.episode)})}loadChildren(){return n(this,null,function*(){})}groupType(){return this.episode.status}addToPlaylist(){this.library.playlistDialogsService.addEpisode(this.episode)}addToQueue(){this.library.player.addEpisode(this.episode)}getInfos(){return[{label:"Podcast",value:this.episode.podcastName,click:()=>{this.navigToParent()}},{label:"Played",value:this.episode.state?.played??0}]}};var Ne=["objMenu"];function Oe(r,e){r&1&&(p(0,"i",8),f(1),x(2,1),C())}function we(r,e){if(r&1){let a=v();y(0,Oe,3,0,"ng-template",7),b("execute",function(t){h(a);let s=E();return d(s.toLibraryObject(t.item).navigTo())})}}function Pe(r,e){r&1&&(p(0,"i",9),f(1),x(2,2),C())}function Ee(r,e){if(r&1&&p(0,"app-context-entry-fav",10),r&2){let a=e.item;ie("base",a.base)}}function je(r,e){if(r&1&&p(0,"app-context-entry-rate",11),r&2){let a=e.item;ie("baseType",a.type)("base",a.base)}}function Ae(r,e){r&1&&(p(0,"i",12),f(1),x(2,3),C())}function ke(r,e){r&1&&(p(0,"i",13),f(1),x(2,4),C())}function Re(r,e){r&1&&(p(0,"i",14),f(1),x(2,5),C())}function De(r,e){if(r&1&&(p(0,"i"),X(1)),r&2){let a=E().$implicit;F(a.icon),T(),U(" ",a.text)}}function Be(r,e){if(r&1){let a=v();y(0,De,2,3,"ng-template",7),b("execute",function(){let t=h(a).$implicit;return d(t.click())})}}var xe=(()=>{let e=class e{constructor(){this.contextMenu=G.required("objMenu"),this.extras=[],this.showGoto=!0}initOpts(i){this.showGoto=!i?.hideGoto,this.extras=i?i.extras:[]}toLibraryObject(i){return i}};e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=A({type:e,selectors:[["app-context-menu-obj"]],viewQuery:function(t,s){t&1&&$(s.contextMenu,Ne,5),t&2&&L()},decls:11,vars:1,consts:()=>{let i;i=$localize`:␟bb4671d1c6b230ec821cf7f9c72210f32e8a6e7b␟5229197663852117796:Navigate to`;let t;t=$localize`:␟9b00b4b718d67ef6351bba15acd4ad0f2bc47927␟8564202903947049539:Play`;let s;s=$localize`:␟13d6506e20a7c3de5afb84bcddae391ff2a114c5␟1031630537877741580:Add To Playlist`;let l;l=$localize`:␟1dbc0611006fca3293442eb71ddf1c018a4d3a00␟5372865088552952611:Add To Queue`;let c;return c=$localize`:␟dc75033a5238fdc4f462212c847a45ba8018a3fd␟3099741642167775297:Download`,[["objMenu",""],i,t,s,l,c,["contextMenuItem",""],["contextMenuItem","",3,"execute"],[1,"icon-view-details"],[1,"icon-play"],[3,"base"],[3,"baseType","base"],[1,"icon-playlist"],[1,"icon-list-add"],[1,"icon-download-cloud"]]},template:function(t,s){if(t&1){let l=v();D(0,"context-menu",null,0),se(2,we,1,0,null,6),y(3,Pe,3,0,"ng-template",7),b("execute",function(u){return h(l),d(s.toLibraryObject(u.item).play())}),y(4,Ee,1,1,"ng-template",7),b("execute",function(u){return h(l),d(s.toLibraryObject(u.item).toggleFav())}),y(5,je,1,2,"ng-template",6)(6,Ae,3,0,"ng-template",7),b("execute",function(u){return h(l),d(s.toLibraryObject(u.item).addToPlaylist())}),y(7,ke,3,0,"ng-template",7),b("execute",function(u){return h(l),d(s.toLibraryObject(u.item).addToQueue())}),y(8,Re,3,0,"ng-template",7),b("execute",function(u){return h(l),d(s.toLibraryObject(u.item).download())}),k(9,Be,1,0,null,6,le),B()}t&2&&(T(2),ne(s.showGoto?2:-1),T(7),R(s.extras))},dependencies:[Y,Q,V,he,de],encapsulation:2});let r=e;return r})();var $e=["entriesMenu"],Le=(r,e)=>e.text;function Fe(r,e){if(r&1&&(p(0,"i"),X(1)),r&2){let a=E().$implicit;F(a.icon),T(),U(" ",a.text)}}function Xe(r,e){if(r&1){let a=v();y(0,Fe,2,3,"ng-template",2),b("execute",function(){let t=h(a).$implicit;return d(t.click())})}}var Me=(()=>{let e=class e{constructor(){this.contextMenu=G.required("entriesMenu"),this.entries=[]}initOpts(i){this.entries=i.entries}};e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=A({type:e,selectors:[["app-context-menu-simple"]],viewQuery:function(t,s){t&1&&$(s.contextMenu,$e,5),t&2&&L()},decls:4,vars:0,consts:[["entriesMenu",""],["contextMenuItem",""],["contextMenuItem","",3,"execute"]],template:function(t,s){t&1&&(D(0,"context-menu",null,0),k(2,Xe,1,0,null,1,Le),B()),t&2&&(T(2),R(s.entries))},dependencies:[Y,Q,V],encapsulation:2});let r=e;return r})();var g=class{constructor(e){this.library=e}},z=class extends g{constructor(){super(...arguments),this.typeName="Albums"}search(e,a,i){return n(this,null,function*(){let t=yield this.library.jam.album.search({query:e.query,genres:e.genre?[e.genre]:void 0,genreIDs:e.genreID?[e.genreID]:void 0,skip:a,take:i,albumIncState:!0});return{list:t,items:t.items.map(s=>new M(s,this.library))}})}all(e,a){return n(this,null,function*(){let i=yield this.library.jam.album.search({skip:e,take:a,albumIncState:!0});return{list:i,items:i.items.map(t=>new M(t,this.library))}})}list(e,a,i){return n(this,null,function*(){let t=e.albumType===j.compilation?ue:void 0,s=yield this.library.jam.album.search({list:e.listType,skip:a,take:i,albumIncState:!0,albumTypes:e.albumType?[e.albumType]:void 0,mbArtistIDs:t?[t]:void 0});return{list:s,items:s.items.map(l=>new M(l,this.library))}})}},Z=class extends g{constructor(){super(...arguments),this.typeName="Artists"}search(e,a,i){return n(this,null,function*(){let t=yield this.library.jam.artist.search({query:e.query,genres:e.genre?[e.genre]:void 0,genreIDs:e.genreID?[e.genreID]:void 0,skip:a,take:i,artistIncState:!0});return{list:t,items:t.items.map(s=>new I(s,this.library))}})}all(e,a){return n(this,null,function*(){let i=yield this.library.jam.artist.search({skip:e,take:a,artistIncState:!0});return{list:i,items:i.items.map(t=>new I(t,this.library))}})}list(e,a,i){return n(this,null,function*(){let t=yield this.library.jam.artist.search({list:e.listType,skip:a,take:i,artistIncState:!0,albumTypes:e.albumType?[e.albumType]:void 0});return{list:t,items:t.items.map(s=>new I(s,this.library))}})}},H=class extends g{constructor(){super(...arguments),this.typeName="Folders"}search(e,a,i){return n(this,null,function*(){let t=yield this.library.jam.folder.search({query:e.query,genres:e.genre?[e.genre]:void 0,skip:a,take:i,folderIncTag:!0,folderIncState:!0});return{list:t,items:t.items.map(s=>new S(s,this.library))}})}all(e,a){return n(this,null,function*(){let i=yield this.library.jam.folder.search({skip:e,take:a,folderIncTag:!0,folderIncState:!0});return{list:i,items:i.items.map(t=>new S(t,this.library))}})}list(e,a,i){return n(this,null,function*(){let t=yield this.library.jam.folder.search({list:e.listType,skip:a,take:i,folderIncTag:!0,folderIncState:!0});return{list:t,items:t.items.map(s=>new S(s,this.library))}})}},K=class extends g{constructor(){super(...arguments),this.typeName="Playlists"}search(e,a,i){return n(this,null,function*(){let t=yield this.library.jam.playlist.search({query:e.query,skip:a,take:i,playlistIncState:!0});return{list:t,items:t.items.map(s=>new N(s,this.library))}})}all(e,a){return n(this,null,function*(){let i=yield this.library.jam.playlist.search({skip:e,take:a,playlistIncState:!0});return{list:i,items:i.items.map(t=>new N(t,this.library))}})}list(e,a,i){return n(this,null,function*(){let t=yield this.library.jam.playlist.search({list:e.listType,skip:a,take:i,playlistIncState:!0});return{list:t,items:t.items.map(s=>new N(s,this.library))}})}},W=class extends g{constructor(){super(...arguments),this.typeName="Genres"}search(e,a,i){return n(this,null,function*(){let t=yield this.library.jam.genre.search({query:e.query,skip:a,take:i,genreState:!0});return{list:t,items:t.items.map(s=>new O(s,this.library))}})}all(e,a){return n(this,null,function*(){let i=yield this.library.jam.genre.search({skip:e,take:a,genreState:!0});return{list:i,items:i.items.map(t=>new O(t,this.library))}})}list(e,a,i){return n(this,null,function*(){let t=yield this.library.jam.genre.search({list:e.listType,skip:a,take:i,genreState:!0});return{list:t,items:t.items.map(s=>new O(s,this.library))}})}},ee=class extends g{constructor(){super(...arguments),this.typeName="Podcasts"}search(e,a,i){return n(this,null,function*(){let t=yield this.library.jam.podcast.search({query:e.query,skip:a,take:i,podcastIncState:!0});return{list:t,items:t.items.map(s=>new P(s,this.library))}})}all(e,a){return n(this,null,function*(){let i=yield this.library.jam.podcast.search({skip:e,take:a,podcastIncState:!0});return{list:i,items:i.items.map(t=>new P(t,this.library))}})}list(e,a,i){return n(this,null,function*(){let t=yield this.library.jam.podcast.search({list:e.listType,skip:a,take:i,podcastIncState:!0});return{list:t,items:t.items.map(s=>new P(s,this.library))}})}},te=class extends g{constructor(){super(...arguments),this.typeName="Series"}search(e,a,i){return n(this,null,function*(){let t=yield this.library.jam.series.search({query:e.query,skip:a,take:i,seriesIncState:!0});return{list:t,items:t.items.map(s=>new w(s,this.library))}})}all(e,a){return n(this,null,function*(){let i=yield this.library.jam.series.search({skip:e,take:a,seriesIncState:!0});return{list:i,items:i.items.map(t=>new w(t,this.library))}})}list(e,a,i){return n(this,null,function*(){let t=yield this.library.jam.series.search({list:e.listType,skip:a,take:i,seriesIncState:!0});return{list:t,items:t.items.map(s=>new w(s,this.library))}})}};var xt=(()=>{let e=class e{constructor(){this.actions=_(me),this.player=_(ge),this.playlistDialogsService=_(ye),this.navig=_(Te),this.jam=_(oe),this.notify=_(ce),this.podcastService=_(be),this.folderLoader=new H(this),this.albumLoader=new z(this),this.artistLoader=new Z(this),this.genreLoader=new W(this),this.playlistLoader=new K(this),this.podcastLoader=new ee(this),this.seriesLoader=new te(this),this.menuService=_(_e)}buildTabs(i){let s=ae.find(l=>l.path==="library").children?.find(l=>l.path===i);return s?.children?s.children.filter(l=>!!l.data).map(l=>({label:l.data?.name??"",link:{route:`/library/${i}${l.path?"/":""}${l.path}`,exact:l.path?.length===0},click:()=>{}})):[]}buildIDTabs(i,t){let l=ae.find(c=>c.path==="library").children?.find(c=>c.path===`${i}/id/:id`);return l?.children?l.children.filter(c=>!!c.data).map(c=>({label:c.data?.name??"",link:{route:`/library/${i}/id/${t}${c.path?"/":""}${c.path}`,exact:c.path?.length===0},click:()=>{}})):[]}openJamObjectMenu(i,t,s){this.menuService.openMenuComponent(xe,i,t,s)}openSimpleMenu(i,t){this.menuService.openMenuComponent(Me,void 0,t,{entries:i})}};e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=re({token:e,factory:e.\u0275fac,providedIn:"root"});let r=e;return r})();export{M as a,S as b,I as c,N as d,fe as e,w as f,P as g,Ce as h,xt as i};
