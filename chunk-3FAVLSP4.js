import{a as re}from"./chunk-PJLKC3XD.js";import"./chunk-KD232HJS.js";import{a as ie}from"./chunk-GVMVJAFS.js";import{b as ne}from"./chunk-JNPRJ3MQ.js";import{a as F}from"./chunk-6WAGYCOA.js";import"./chunk-UPKF4LSO.js";import"./chunk-24DMSAFT.js";import{c as W,d as Q,e as Y,f as J,g as U,h as q,o as H}from"./chunk-Y5Z5ITNC.js";import"./chunk-K7RVMPTP.js";import"./chunk-BNP52TDG.js";import"./chunk-F6BYEP4R.js";import"./chunk-VP6KNDS4.js";import{k as Z}from"./chunk-AQDYGNZB.js";import{a as oe}from"./chunk-PZTZCA44.js";import"./chunk-4HNSRH53.js";import{G as te}from"./chunk-ZVKVGF76.js";import{i as ee,k as h}from"./chunk-T6GM3CFW.js";import{$d as K,Aa as b,Ac as B,Ba as x,Fc as X,Gc as V,Hb as c,Ib as f,Lb as v,Mb as $,Nb as u,Ob as d,Pb as l,Qb as m,Vc as z,Y as A,_b as E,ab as _,ac as M,dc as P,e as L,fc as s,ia as T,na as C,nb as N,oa as O,rb as y,rc as w,tc as S,uc as I,vc as D,wd as j,yc as k,zc as G}from"./chunk-H2EXZDP6.js";var se=()=>({standalone:!0});function ae(t,i){if(t&1){let n=E();d(0,"div")(1,"form")(2,"div",1)(3,"label",2),M(4,0),l(),d(5,"input",3),B("ngModelChange",function(e){C(n);let r=s();return G(r.edit.name,e)||(r.edit.name=e),O(e)}),l()()()()}if(t&2){let n=s();_(5),u("ngModelOptions",X(2,se)),k("ngModel",n.edit.name)}}var de=(()=>{let i=class i{dialogInit(o,e){this.edit=e.data}};i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=N({type:i,selectors:[["app-dialog-folder"]],decls:1,vars:1,consts:()=>{let o;return o=$localize`:␟cff1428d10d59d14e45edec3c735a27b5482db59␟8953033926734869941:Name`,[o,[1,"user-form-control"],["for","dialog-folder-edit"],["id","dialog-folder-edit","type","text","name","folder-name",3,"ngModelChange","ngModelOptions","ngModel"]]},template:function(e,r){e&1&&c(0,ae,6,3,"div"),e&2&&f(r.edit?0:-1)},dependencies:[H,q,W,Q,Y,U,J],styles:["[_nghost-%COMP%] > div[_ngcontent-%COMP%]{margin-left:20px;margin-right:20px}[_nghost-%COMP%]   input[type=text][_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]   input[_ngcontent-%COMP%]{font-size:1.3em;line-height:1.3em}[_nghost-%COMP%]   .user-form-control[_ngcontent-%COMP%]{margin-bottom:8px;display:block}"]});let t=i;return t})();var ce=t=>["/admin/folder",t,"overview"],fe=(t,i)=>i.folder.id;function me(t,i){if(t&1&&S(0),t&2){let n=s().$implicit;D(" / ",n.folder.tag==null?null:n.folder.tag.albumType," ")}}function pe(t,i){if(t&1){let n=E();d(0,"tr",14),P("click",function(){let e=C(n).$implicit;return O(e.selected=!e.selected)}),d(1,"td",8)(2,"a",15),S(3),l()(),d(4,"td",9),S(5),l(),d(6,"td",10),S(7),l(),d(8,"td",11),S(9),l(),d(10,"td",12),S(11),c(12,me,1,1),l()()}if(t&2){let n=i.$implicit;w("selected",n.selected),_(2),u("routerLink",V(9,ce,n.folder.id)),_(),I(n.folder.name),_(2),I(n.folder.tag==null?null:n.folder.tag.artist),_(2),I(n.folder.tag==null?null:n.folder.tag.album),_(2),I(n.folder.tag==null?null:n.folder.tag.year),_(2),D(" ",n.folder.type," "),_(),f(n.folder.tag!=null&&n.folder.tag.albumType?12:-1)}}function ge(t,i){if(t&1&&(d(0,"table",6)(1,"tr",7)(2,"td",8),M(3,0),l(),d(4,"td",9),M(5,1),l(),d(6,"td",10),M(7,2),l(),d(8,"td",11),M(9,3),l(),d(10,"td",12),M(11,4),l()(),v(12,pe,13,11,"tr",13,fe),l()),t&2){let n=s();_(12),$(n.folderItems)}}var R=class{constructor(i){this.folder=i}},_e=(()=>{let i=class i{constructor(){this.folders=z([]),this.folderItems=[]}ngOnChanges(){this.folderItems=this.folders().map(o=>new R(o))}};i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=N({type:i,selectors:[["app-admin-folder-list"]],inputs:{folders:[1,"folders"]},features:[b],decls:2,vars:2,consts:()=>{let o;o=$localize`:␟fdf7cbdc140d0aab0f0b6c06065a0fd448ed6a2e␟5701618810648052610:Title`;let e;e=$localize`:␟378660a509ecaa4d2dd3b4b0b8975760cfe3576d␟2492300395471245755:Artist`;let r;r=$localize`:␟842a4fcf548e0c52ebab1cb5362f47ab2ca83e12␟1393837337557373364:Album`;let p;p=$localize`:␟f6e04edea3bb3a59d5904725bfbc2c440e793001␟1464072562214937907:Year`;let a;return a=$localize`:␟f61c6867295f3b53d23557021f2f4e0aa1d0b8fc␟8650499415827640724:Type`,[o,e,r,p,a,["name","Folders",3,"list"],[1,"folders"],[1,"folder","heading"],[1,"title"],[1,"artist"],[1,"album"],[1,"year"],[1,"type"],[1,"folder",3,"selected"],[1,"folder",3,"click"],[3,"routerLink"]]},template:function(e,r){e&1&&(m(0,"app-background-text-list",5),c(1,ge,14,0,"table",6)),e&2&&(u("list",r.folderItems),_(),f(r.folderItems&&r.folderItems.length>0?1:-1))},dependencies:[h,ee,F],styles:["[_nghost-%COMP%]{width:100%;overflow:auto;display:block}[_nghost-%COMP%]   .folders[_ngcontent-%COMP%]{padding:15px;font-size:.8em;width:100%}[_nghost-%COMP%]   .heading[_ngcontent-%COMP%]{font-size:.9em}[_nghost-%COMP%]   .folder[_ngcontent-%COMP%]{border-bottom:1px solid var(--control-border)}[_nghost-%COMP%]   .folder[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:5px 10px}[_nghost-%COMP%]   .folder[_ngcontent-%COMP%]:hover{background-color:var(--background-hover)}[_nghost-%COMP%]   .folder.selected[_ngcontent-%COMP%]{background-color:var(--background-active)}"]});let t=i;return t})();function Ce(t,i){t&1&&m(0,"app-loading")}function Oe(t,i){if(t&1){let n=E();d(0,"button",9),P("click",function(){C(n);let e=s(2);return O(e.moveSubfolders())}),m(1,"i",10),l()}}function ue(t,i){if(t&1&&m(0,"app-admin-folder-list",8),t&2){let n=s(2);u("folders",n.folder.folders)}}function Me(t,i){if(t&1){let n=E();d(0,"div",0)(1,"div",1)(2,"button",2),P("click",function(){C(n);let e=s();return O(e.refresh())}),m(3,"i",3),l(),d(4,"button",4),P("click",function(){C(n);let e=s();return O(e.newFolder())}),m(5,"i",5),l(),c(6,Oe,2,0,"button",6),l(),m(7,"app-background-text-list",7),c(8,ue,1,1,"app-admin-folder-list",8),l()}if(t&2){let n=s();_(6),f(n.folder.folders&&n.folder.folders.length?6:-1),_(),u("list",n.folder.folders),_(),f(n.folder.folders&&n.folder.folders.length?8:-1)}}var je=(()=>{let i=class i extends ie{constructor(){super(...arguments),this.jam=T(K),this.notify=T(te),this.folderService=T(ne),this.dialogOverlay=T(Z)}ngOnInit(){super.ngOnInit(),this.folderService.foldersChange.pipe(A(this.unsubscribe)).subscribe(o=>{o.id===this.id&&this.refresh()})}ngOnDestroy(){super.ngOnDestroy()}refresh(){this.folder=void 0,this.id&&this.jam.folder.id({id:this.id,folderIncFolders:!0,folderIncTag:!0}).then(o=>{this.folder=o}).catch(o=>{this.notify.error(o)})}newFolder(){if(!this.folder)return;let o=this.folder,e={folder:o,name:""};this.dialogOverlay.open({childComponent:de,title:"New Folder",data:e,onOkBtn:()=>L(this,null,function*(){try{this.jam.folder.create({id:o.id,name:e.name}).then(r=>{this.folderService.waitForQueueResult("Creating Folder",r,[],[o.id])}).catch(r=>{this.notify.error(r)})}catch(r){return this.notify.error(r),Promise.reject(r)}}),onCancelBtn:()=>L(this,null,function*(){return Promise.resolve()})})}moveSubfolders(){if(!this.id||!this.folder?.folders)return;let o=this.id,e=this.folder.folders.map(a=>a.id),r=[o,...e],p={selectID:o,disableIDs:r};this.dialogOverlay.open({childComponent:re,title:"Move Subfolders to",data:p,panelClass:"overlay-panel-large-buttons",onOkBtn:()=>L(this,null,function*(){try{let a=p.folder;if(!a)return;r.push(a.id),this.jam.folder.move({ids:e,newParentID:a.id}).then(g=>{this.folderService.waitForQueueResult("Moving Folders",g,[],r)}).catch(g=>{this.notify.error(g)})}catch(a){return this.notify.error(a),Promise.reject(a)}}),onCancelBtn:()=>L(this,null,function*(){return Promise.resolve()})})}};i.\u0275fac=(()=>{let o;return function(r){return(o||(o=x(i)))(r||i)}})(),i.\u0275cmp=N({type:i,selectors:[["app-admin-folder-folders"]],features:[y],decls:2,vars:1,consts:()=>{let o;o=$localize`:␟c8d1785038d461ec66b5799db21864182b35900a␟1102717806459547726:Refresh`;let e;e=$localize`:␟65ab0e571a2c4b74cf959aa0fecf26f78fae4b9f␟5184355384536429227:New Folder…`;let r;return r=$localize`:␟defb5986728ca6ef16d61914a5b0642c36084245␟4062236829893650390:Move Subfolders…`,[[1,"folders"],[1,"actions"],["title",o,1,"button-on-control",3,"click"],[1,"icon-reload"],["title",e,1,"button-on-control",3,"click"],[1,"icon-plus"],["title",r,1,"button-on-control"],["name","Folders",3,"list"],[3,"folders"],["title",r,1,"button-on-control",3,"click"],[1,"icon-right-bold"]]},template:function(e,r){e&1&&c(0,Ce,1,0,"app-loading")(1,Me,9,3,"div",0),e&2&&f(r.folder?r.folder.folders?1:-1:0)},dependencies:[j,h,_e,F,oe],styles:["[_nghost-%COMP%]{height:100%;width:100%;display:block;overflow:hidden}[_nghost-%COMP%]   .folders[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;width:100%}[_nghost-%COMP%]   .folders[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{padding:10px 15px 0;border-bottom-color:var(--background-border);border-bottom-width:1px;border-bottom-style:solid}[_nghost-%COMP%]   .folders[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{margin-right:5px;margin-bottom:10px}[_nghost-%COMP%]   .folders[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%] > label[_ngcontent-%COMP%]{text-transform:uppercase;letter-spacing:1px;font-size:11px;margin-left:5px;margin-right:5px}[_nghost-%COMP%]   .folders[_ngcontent-%COMP%]   app-admin-folder-list[_ngcontent-%COMP%]{overflow-y:auto}"]});let t=i;return t})();export{je as AdminFolderFoldersComponent};
