import{a as xe,b as ye,c as _e}from"./chunk-MTB5HHEE.js";import{A as Me,B as be,q as he,v as ve,y as Ce,z as ge}from"./chunk-3LOKQP2Q.js";import{$b as S,Ba as H,Cb as te,Cc as U,Db as q,Eb as B,Gb as ne,Hb as oe,Ib as ie,Jb as _,Kb as I,Lb as w,Lc as ce,M as W,Oc as r,Pc as a,Qc as R,Rc as le,Tc as me,Uc as d,Wb as T,Ya as C,Za as Y,_a as x,a as f,aa as $,b as k,ba as z,bc as u,da as G,eb as J,f as b,fa as m,fc as se,gc as re,h as Q,hc as ue,ic as ae,j as V,jc as j,ka as h,kc as D,kd as de,la as v,md as pe,nb as y,nc as N,ob as Z,pb as ee,rd as fe,sb as P}from"./chunk-XLNNDSL4.js";var Se=["content"],Ie=o=>({item:o});function De(o,p){}function Ee(o,p){if(o&1){let e=T();I(0,"span",3,0),S("click",function(n){h(e);let i=u(2);return v(i.stopEvent(n))})("contextmenu",function(n){h(e);let i=u(2);return v(i.stopEvent(n))}),P(2,De,0,0,"ng-template",4),w()}if(o&2){let e=u(2);N("disabled",!e.menuItem().isEnabled),x(2),_("ngTemplateOutlet",e.menuItem().template)("ngTemplateOutletContext",U(4,Ie,e.item()))}}function Oe(o,p){}function ke(o,p){if(o&1){let e=T();I(0,"a",5,0),S("click",function(n){h(e);let i=u(2);return v(i.onMenuItemSelect(n))})("mouseenter",function(n){h(e);let i=u(2);return v(i.onOpenSubMenu(n))}),P(2,Oe,0,0,"ng-template",4),w()}if(o&2){let e=u(2);N("active",e.menuItem().isActive&&e.menuItem().isEnabled)("disabled",!e.menuItem().isEnabled)("hasSubMenu",!!e.menuItem().subMenu()),x(2),_("ngTemplateOutlet",e.menuItem().template)("ngTemplateOutletContext",U(8,Ie,e.item()))}}function Te(o,p){if(o&1&&q(0,Ee,3,6,"span",1)(1,ke,3,10,"a",2),o&2){let e=u();B(e.menuItem().passive()?0:1)}}var X=(()=>{class o{constructor(){this.menuItem=a.required(),this.item=a.required(),this.itemRef=R("content"),this.itemSelect=r(),this.openSubmenu=r()}stopEvent(e){e.stopPropagation()}focus(){this.itemRef()?.nativeElement.focus()}onMenuItemSelect(e){e.preventDefault(),e.stopPropagation(),this.itemSelect.emit({event:e,menuItem:this.menuItem()})}onOpenSubMenu(e){this.openSubmenu.emit({event:e,menuItem:this.menuItem()})}static{this.\u0275fac=function(t){return new(t||o)}}static{this.\u0275cmp=y({type:o,selectors:[["context-menu-content-item"]],viewQuery:function(t,n){t&1&&j(n.itemRef,Se,5),t&2&&D()},inputs:{menuItem:[1,"menuItem"],item:[1,"item"]},outputs:{itemSelect:"itemSelect",openSubmenu:"openSubmenu"},decls:1,vars:1,consts:[["content",""],["role","menuitem",1,"passive",3,"disabled"],["href","","role","menuitem","tabindex","-1",3,"active","disabled","hasSubMenu"],["role","menuitem",1,"passive",3,"click","contextmenu"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["href","","role","menuitem","tabindex","-1",3,"click","mouseenter"]],template:function(t,n){t&1&&q(0,Te,2,1),t&2&&B(n.menuItem().divider()?-1:0)},dependencies:[pe],encapsulation:2})}}return o})();var E=new G("CONTEXT_MENU_OPTIONS");var Ne=["menu"],Fe=["li"];function Ae(o,p){if(o&1){let e=T();I(0,"li",null,1)(2,"context-menu-content-item",5),S("itemSelect",function(n){h(e);let i=u();return v(i.onMenuItemSelect(n))})("openSubmenu",function(n){h(e);let i=u();return v(i.onOpenSubMenu(n))}),w()()}if(o&2){let e=p.$implicit,t=u();N("disabled",!e.isEnabled)("divider",e.divider())("dropdown-divider",e.divider())("active",e.isActive&&e.isEnabled),te("role",e.divider()?"separator":void 0),x(2),_("item",t.item())("menuItem",e)}}var we=(()=>{class o{constructor(){this.menuItems=d([]),this.item=d(),this.event=d(),this.parentContextMenu=d(),this.menuClass=d(),this.overlay=d(),this.isLeaf=d(!1),this.execute=r(),this.openSubMenu=r(),this.closeLeafMenu=r(),this.closeAllMenus=r(),this.menuElement=R.required("menu"),this.menuItemElements=le("li"),this.autoFocus=!1,this.options=m(E,{optional:!0}),this.subscription=new b,this.options&&(this.autoFocus=!!this.options.autoFocus)}ngOnInit(){let e=this.menuItems(),t=this.item();for(let n of e)n.currentItem=t,this.subscription.add(n.execute.subscribe(i=>{this.execute.emit(k(f({},i),{menuItem:n}))}))}registerKeys(){this.keyManager=new _e(this.menuItemFocusElements).withWrap()}ngAfterViewInit(){this.autoFocus&&setTimeout(()=>{this.focus()}),this.registerKeys(),this.menuItemFocusElements.changes.subscribe(()=>{this.registerKeys()}),this.overlay()?.updatePosition()}ngOnDestroy(){this.subscription.unsubscribe()}focus(){this.autoFocus&&this.menuElement().nativeElement.focus()}getKeyManagerMenuItem(){return this.menuItems()[this.keyManager.activeItemIndex??-1]}onKeyEvent(e){this.keyManager.onKeydown(e)}keyboardOpenSubMenu(e){if(!this.isLeaf())return;this.cancelEvent(e);let t=this.getKeyManagerMenuItem();t&&this.onOpenSubMenu({menuItem:t,event:e})}keyboardMenuItemSelect(e){if(!this.isLeaf())return;this.cancelEvent(e);let t=this.getKeyManagerMenuItem();t&&this.onMenuItemSelect({menuItem:t,event:e})}onCloseLeafMenu(e){this.isLeaf()&&(this.cancelEvent(e),this.closeLeafMenu.emit({exceptRootMenu:e.code==="ArrowLeft",event:e}))}closeMenu(e){e.type==="click"&&e.button===2||this.closeAllMenus.emit({event:e})}onOpenSubMenu(e){let n=(this.keyManager.activeItemIndex===null?void 0:this.menuItemElements().at(this.keyManager.activeItemIndex))?.nativeElement;this.openSubMenu.emit({anchorElement:n,contextMenu:e.menuItem.subMenu(),event:e.event,item:this.item(),parentContextMenu:this})}onMenuItemSelect(e){e.menuItem.subMenu()?this.onOpenSubMenu(e):e.menuItem.triggerExecute(this.item(),e.event)}cancelEvent(e){let t=e.target;["INPUT","TEXTAREA","SELECT"].includes(t.tagName)||t.isContentEditable||(e.preventDefault(),e.stopPropagation())}static{this.\u0275fac=function(t){return new(t||o)}}static{this.\u0275cmp=y({type:o,selectors:[["context-menu-content"]],viewQuery:function(t,n){if(t&1&&(j(n.menuElement,Ne,5)(n.menuItemElements,Fe,5),se(X,5)),t&2){D(2);let i;re(i=ue())&&(n.menuItemFocusElements=i)}},hostBindings:function(t,n){t&1&&S("keydown.ArrowDown",function(s){return n.onKeyEvent(s)},C)("keydown.ArrowUp",function(s){return n.onKeyEvent(s)},C)("keydown.ArrowRight",function(s){return n.keyboardOpenSubMenu(s)},C)("keydown.Space",function(s){return n.keyboardMenuItemSelect(s)},C)("keydown.Enter",function(s){return n.keyboardMenuItemSelect(s)},C)("keydown.ArrowLeft",function(s){return n.onCloseLeafMenu(s)},C)("keydown.Escape",function(s){return n.onCloseLeafMenu(s)},C)("contextmenu",function(s){return n.closeMenu(s)},Y)("click",function(s){return n.closeMenu(s)},Y)},inputs:{menuItems:[1,"menuItems"],item:[1,"item"],event:[1,"event"],parentContextMenu:[1,"parentContextMenu"],menuClass:[1,"menuClass"],overlay:[1,"overlay"],isLeaf:[1,"isLeaf"]},outputs:{menuItems:"menuItemsChange",item:"itemChange",event:"eventChange",parentContextMenu:"parentContextMenuChange",menuClass:"menuClassChange",overlay:"overlayChange",isLeaf:"isLeafChange",execute:"execute",openSubMenu:"openSubMenu",closeLeafMenu:"closeLeafMenu",closeAllMenus:"closeAllMenus"},decls:5,vars:1,consts:[["menu",""],["li",""],[1,"dropdown","open","show","ngx-contextmenu",3,"ngClass"],["cdkTrapFocus","","role","menu","tabindex","0",1,"dropdown-menu","show",2,"position","static","float","none"],[3,"disabled","divider","dropdown-divider","active"],[3,"itemSelect","openSubmenu","item","menuItem"]],template:function(t,n){t&1&&(I(0,"div",2)(1,"ul",3,0),oe(3,Ae,3,11,"li",4,ne),w()()),t&2&&(_("ngClass",n.menuClass()||""),x(3),ie(n.menuItems()))},dependencies:[de,xe,X],styles:['.passive[_ngcontent-%COMP%]{display:block;padding:3px 20px;clear:both;font-weight:400;white-space:nowrap}.hasSubMenu[_ngcontent-%COMP%]:before{content:"u25B6";float:right}']})}}return o})();function A(o){let p=ce(o);return new Q(e=>{let t=p?.onDestroy(()=>e.complete()),n=o.subscribe(i=>e.next(i));return()=>{n.unsubscribe(),t?.()}})}var L=(()=>{class o{constructor(){this.isDestroyingLeafMenu=!1,this.show=new V,this.close=new V,this.overlay=m(ge),this.scrollStrategy=m(ve),this.fakeElement={getBoundingClientRect:()=>({bottom:0,height:0,left:0,right:0,top:0,width:0})},this.overlays=[]}openContextMenu(e){let{anchorElement:t,event:n,parentContextMenu:i}=e;if(i){let s=this.overlay.position().flexibleConnectedTo(new H(n?n.target:t)).withPositions([{originX:"end",originY:"top",overlayX:"start",overlayY:"top"},{originX:"start",originY:"top",overlayX:"end",overlayY:"top"},{originX:"end",originY:"bottom",overlayX:"start",overlayY:"bottom"},{originX:"start",originY:"bottom",overlayX:"end",overlayY:"bottom"}]).withFlexibleDimensions(!1),g=this.overlay.create({positionStrategy:s,panelClass:"ngx-contextmenu",scrollStrategy:this.scrollStrategy.close()});this.destroySubMenus(i),this.overlays=[...this.overlays,g],this.attachContextMenu(g,e)}else{let s=n;this.fakeElement.getBoundingClientRect=()=>({left:s.clientX,top:s.clientY,right:s.clientX,bottom:s.clientY,height:0,width:0}),this.closeAllContextMenus({eventType:"cancel",event:n});let g=this.overlay.position().flexibleConnectedTo(new H(t??this.fakeElement)).withPositions([{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom"},{originX:"end",originY:"top",overlayX:"start",overlayY:"top"},{originX:"start",originY:"top",overlayX:"end",overlayY:"top"},{originX:"end",originY:"center",overlayX:"start",overlayY:"center"},{originX:"start",originY:"center",overlayX:"end",overlayY:"center"}]).withFlexibleDimensions(!1);this.overlays=[this.overlay.create({positionStrategy:g,panelClass:"ngx-contextmenu",scrollStrategy:this.scrollStrategy.close()})],this.attachContextMenu(this.overlays[0],e)}}attachContextMenu(e,t){let{event:n,item:i,menuItems:s,menuClass:g}=t,c=e.attach(new he(we)),M=c.instance;M.event.set(n),M.item.set(i),M.menuItems.set(s),M.overlay.set(e),M.isLeaf.set(!0),M.menuClass.set(g),e.contextMenu=c.instance;let O=new b;O.add(A(c.instance.execute).subscribe(l=>{this.closeAllContextMenus(f({eventType:"execute"},l))})),O.add(A(c.instance.closeAllMenus).subscribe(l=>{this.closeAllContextMenus(f({eventType:"cancel"},l))})),O.add(A(c.instance.closeLeafMenu).subscribe(l=>{this.destroyLeafMenu(l)})),O.add(A(c.instance.openSubMenu).subscribe(l=>{if(this.destroySubMenus(c.instance),!l.contextMenu){c.instance.isLeaf.set(!0);return}c.instance.isLeaf.set(!1),this.show.next(l)})),c.onDestroy(()=>{for(let l of s)l.isActive=!1;O.unsubscribe()}),c.changeDetectorRef.detectChanges()}closeAllContextMenus(e){this.close.next(e);for(let t of this.overlays)t.detach(),t.dispose();this.overlays=[]}getLastAttachedOverlay(){let e=this.overlays.at(-1);for(;this.overlays.length>1&&e&&!e.hasAttached();)e.detach(),e.dispose(),this.overlays=this.overlays.slice(0,-1),e=this.overlays.at(-1);return e}destroyLeafMenu({exceptRootMenu:e,event:t}={}){this.isDestroyingLeafMenu||(this.isDestroyingLeafMenu=!0,setTimeout(()=>{let n=this.getLastAttachedOverlay();this.overlays.length>1&&n&&(n.detach(),n.dispose()),!e&&this.overlays.length>0&&n&&(this.close.next({eventType:"cancel",event:t}),n.detach(),n.dispose());let i=this.getLastAttachedOverlay();i?.contextMenu&&i.contextMenu.isLeaf.set(!0),this.isDestroyingLeafMenu=!1}))}destroySubMenus(e){let t=e.overlay();if(t){let n=this.overlays.indexOf(t),i=this.overlays.slice(n+1);for(let s of i)s.detach(),s.dispose()}}static{this.\u0275fac=function(t){return new(t||o)}}static{this.\u0275prov=$({token:o,factory:o.\u0275fac})}}return o})();var K=(()=>{class o{constructor(){this.subMenu=a(),this.divider=a(!1),this.enabled=a(!0),this.passive=a(!1),this.visible=a(!0),this.execute=r(),this.template=m(J),this.isActive=!1}get isVisible(){return this.evaluateIfFunction(this.visible(),this)}get isEnabled(){return this.evaluateIfFunction(this.enabled(),this)}get disabled(){return this.passive()||this.divider()||!this.evaluateIfFunction(this.enabled(),this.currentItem)}evaluateIfFunction(e,t){return typeof e=="function"?e(t):e}setActiveStyles(){this.isActive=!0}setInactiveStyles(){this.isActive=!1}triggerExecute(e,t){this.isEnabled&&this.execute.emit({event:t,item:e})}static{this.\u0275fac=function(t){return new(t||o)}}static{this.\u0275dir=ee({type:o,selectors:[["","contextMenuItem",""]],inputs:{subMenu:[1,"subMenu"],divider:[1,"divider"],enabled:[1,"enabled"],passive:[1,"passive"],visible:[1,"visible"]},outputs:{execute:"execute"}})}}return o})();var Dt=(()=>{class o{constructor(){this.menuClass=a(""),this.disabled=a(!1),this.autoFocus=d(!1),this.closeEvent=r(),this.openEvent=r(),this.menuItems=me(K),this.visibleMenuItems=[],this.subscription=new b,this.contextMenuService=m(L),this.options=m(E,{optional:!0}),this.options&&this.autoFocus.set(this.options.autoFocus),this.subscription.add(this.contextMenuService.show.subscribe(e=>{this.onMenuEvent(e)}))}ngOnDestroy(){this.subscription.unsubscribe()}onMenuEvent(e){if(this.disabled())return;let{contextMenu:t,event:n,item:i}=e;t&&t!==this||(this.event=n,this.item=i,this.setVisibleMenuItems(),this.contextMenuService.openContextMenu(k(f({},e),{menuItems:this.visibleMenuItems,menuClass:this.menuClass()})),this.contextMenuService.close.asObservable().pipe(W()).subscribe(s=>{this.closeEvent.emit(s)}),this.openEvent.emit(e))}setVisibleMenuItems(){this.visibleMenuItems=this.menuItems().filter(e=>e.isVisible)}static{this.\u0275fac=function(t){return new(t||o)}}static{this.\u0275cmp=y({type:o,selectors:[["context-menu"]],contentQueries:function(t,n,i){t&1&&ae(i,n.menuItems,K,4),t&2&&D()},inputs:{menuClass:[1,"menuClass"],disabled:[1,"disabled"],autoFocus:[1,"autoFocus"]},outputs:{autoFocus:"autoFocusChange",closeEvent:"closeEvent",openEvent:"openEvent"},decls:0,vars:0,template:function(t,n){},styles:[`.cdk-overlay-container{position:fixed;z-index:1000;pointer-events:none;top:0;left:0;width:100%;height:100%}.ngx-contextmenu.cdk-overlay-pane{position:absolute;pointer-events:auto;box-sizing:border-box}
`],encapsulation:2})}}return o})();var Ut=(()=>{class o{static forRoot(e){return{ngModule:o,providers:[L,{provide:E,useValue:e},{provide:Ce,useClass:be}]}}static{this.\u0275fac=function(t){return new(t||o)}}static{this.\u0275mod=Z({type:o})}static{this.\u0275inj=z({imports:[fe,ye,Me]})}}return o})();export{L as a,K as b,Dt as c,Ut as d};
