import{a as ne}from"./chunk-RCCCWXAS.js";import"./chunk-CMNREOWD.js";import{a as oe}from"./chunk-VRIKBGWX.js";import{b as te}from"./chunk-MWWVWNOX.js";import{a as h}from"./chunk-UO5UMZSC.js";import"./chunk-JP4K5MFN.js";import"./chunk-24DMSAFT.js";import{c as z,d as j,e as W,f as Q,g as Y,h as J,o as U}from"./chunk-SCY3FOMN.js";import"./chunk-6WISUSLE.js";import"./chunk-RJHPSDKR.js";import"./chunk-MTB5HHEE.js";import"./chunk-TT7XXVKE.js";import{k as H}from"./chunk-6SWJ3F4P.js";import{a as ee}from"./chunk-ITVL4IJL.js";import"./chunk-JI2YWTPQ.js";import{G as Z}from"./chunk-3LOKQP2Q.js";import{i as K,k as I}from"./chunk-MFAW4R34.js";import{$b as N,Bc as B,Cc as X,Db as c,Eb as f,Hb as y,Ib as v,Jb as O,Kb as r,Lb as i,Mb as m,Pc as V,U as R,Wb as M,Wd as q,Yb as u,_a as l,bc as _,e as P,fa as L,ka as g,la as C,nb as S,nc as $,pc as E,qc as T,rb as x,rc as F,uc as w,vc as k,wc as G,ya as A,za as b}from"./chunk-XLNNDSL4.js";var de=()=>({standalone:!0});function _e(t,d){if(t&1){let e=M();r(0,"div")(1,"form")(2,"div",1)(3,"label",2),u(4,0),i(),r(5,"input",3),G("ngModelChange",function(o){g(e);let s=_();return k(s.edit.name,o)||(s.edit.name=o),C(o)}),i()()()()}if(t&2){let e=_();l(5),O("ngModelOptions",B(2,de)),w("ngModel",e.edit.name)}}var re=(()=>{class t{dialogInit(e,n){this.edit=n.data}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275cmp=S({type:t,selectors:[["app-dialog-folder"]],decls:1,vars:1,consts:()=>{let e;return e=$localize`:␟cff1428d10d59d14e45edec3c735a27b5482db59␟8953033926734869941:Name`,[e,[1,"user-form-control"],["for","dialog-folder-edit"],["id","dialog-folder-edit","type","text","name","folder-name",3,"ngModelChange","ngModelOptions","ngModel"]]},template:function(n,o){n&1&&c(0,_e,6,3,"div"),n&2&&f(o.edit?0:-1)},dependencies:[U,J,z,j,W,Y,Q],styles:["[_nghost-%COMP%] > div[_ngcontent-%COMP%]{margin-left:20px;margin-right:20px}[_nghost-%COMP%]   input[type=text][_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]   input[_ngcontent-%COMP%]{font-size:1.3em;line-height:1.3em}[_nghost-%COMP%]   .user-form-control[_ngcontent-%COMP%]{margin-bottom:8px;display:block}"]})}}return t})();var se=t=>["/admin/folder",t,"overview"],ae=(t,d)=>d.folder.id;function ce(t,d){if(t&1&&E(0),t&2){let e=_().$implicit;F(" / ",e.folder.tag==null?null:e.folder.tag.albumType," ")}}function fe(t,d){if(t&1){let e=M();r(0,"tr",14),N("click",function(){let o=g(e).$implicit;return C(o.selected=!o.selected)}),r(1,"td",8)(2,"a",15),E(3),i()(),r(4,"td",9),E(5),i(),r(6,"td",10),E(7),i(),r(8,"td",11),E(9),i(),r(10,"td",12),E(11),c(12,ce,1,1),i()()}if(t&2){let e=d.$implicit;$("selected",e.selected),l(2),O("routerLink",X(9,se,e.folder.id)),l(),T(e.folder.name),l(2),T(e.folder.tag==null?null:e.folder.tag.artist),l(2),T(e.folder.tag==null?null:e.folder.tag.album),l(2),T(e.folder.tag==null?null:e.folder.tag.year),l(2),F(" ",e.folder.type," "),l(),f(e.folder.tag!=null&&e.folder.tag.albumType?12:-1)}}function me(t,d){if(t&1&&(r(0,"table",6)(1,"tr",7)(2,"td",8),u(3,0),i(),r(4,"td",9),u(5,1),i(),r(6,"td",10),u(7,2),i(),r(8,"td",11),u(9,3),i(),r(10,"td",12),u(11,4),i()(),y(12,fe,13,11,"tr",13,ae),i()),t&2){let e=_();l(12),v(e.folderItems)}}var D=class{constructor(d){this.folder=d}},le=(()=>{class t{constructor(){this.folders=V([]),this.folderItems=[]}ngOnChanges(){this.folderItems=this.folders().map(e=>new D(e))}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275cmp=S({type:t,selectors:[["app-admin-folder-list"]],inputs:{folders:[1,"folders"]},features:[A],decls:2,vars:2,consts:()=>{let e;e=$localize`:␟fdf7cbdc140d0aab0f0b6c06065a0fd448ed6a2e␟5701618810648052610:Title`;let n;n=$localize`:␟378660a509ecaa4d2dd3b4b0b8975760cfe3576d␟2492300395471245755:Artist`;let o;o=$localize`:␟842a4fcf548e0c52ebab1cb5362f47ab2ca83e12␟1393837337557373364:Album`;let s;s=$localize`:␟f6e04edea3bb3a59d5904725bfbc2c440e793001␟1464072562214937907:Year`;let a;return a=$localize`:␟f61c6867295f3b53d23557021f2f4e0aa1d0b8fc␟8650499415827640724:Type`,[e,n,o,s,a,["name","Folders",3,"list"],[1,"folders"],[1,"folder","heading"],[1,"title"],[1,"artist"],[1,"album"],[1,"year"],[1,"type"],[1,"folder",3,"selected"],[1,"folder",3,"click"],[3,"routerLink"]]},template:function(n,o){n&1&&(m(0,"app-background-text-list",5),c(1,me,14,0,"table",6)),n&2&&(O("list",o.folderItems),l(),f(o.folderItems&&o.folderItems.length>0?1:-1))},dependencies:[I,K,h],styles:["[_nghost-%COMP%]{width:100%;overflow:auto;display:block}[_nghost-%COMP%]   .folders[_ngcontent-%COMP%]{padding:15px;font-size:.8em;width:100%}[_nghost-%COMP%]   .heading[_ngcontent-%COMP%]{font-size:.9em}[_nghost-%COMP%]   .folder[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:5px 10px}[_nghost-%COMP%]   .folder[_ngcontent-%COMP%]{border-bottom:1px solid var(--control-border)}[_nghost-%COMP%]   .folder[_ngcontent-%COMP%]:hover{background-color:var(--background-hover)}[_nghost-%COMP%]   .folder.selected[_ngcontent-%COMP%]{background-color:var(--background-active)}"]})}}return t})();function pe(t,d){t&1&&m(0,"app-loading")}function ge(t,d){if(t&1){let e=M();r(0,"button",9),N("click",function(){g(e);let o=_(2);return C(o.moveSubfolders())}),m(1,"i",10),i()}}function Ce(t,d){if(t&1&&m(0,"app-admin-folder-list",8),t&2){let e=_(2);O("folders",e.folder.folders)}}function Oe(t,d){if(t&1){let e=M();r(0,"div",0)(1,"div",1)(2,"button",2),N("click",function(){g(e);let o=_();return C(o.refresh())}),m(3,"i",3),i(),r(4,"button",4),N("click",function(){g(e);let o=_();return C(o.newFolder())}),m(5,"i",5),i(),c(6,ge,2,0,"button",6),i(),m(7,"app-background-text-list",7),c(8,Ce,1,1,"app-admin-folder-list",8),i()}if(t&2){let e=_();l(6),f(e.folder.folders&&e.folder.folders.length?6:-1),l(),O("list",e.folder.folders),l(),f(e.folder.folders&&e.folder.folders.length?8:-1)}}var Xe=(()=>{class t extends oe{constructor(){super(...arguments),this.jam=L(q),this.notify=L(Z),this.folderService=L(te),this.dialogOverlay=L(H)}ngOnInit(){super.ngOnInit(),this.folderService.foldersChange.pipe(R(this.unsubscribe)).subscribe(e=>{e.id===this.id&&this.refresh()})}ngOnDestroy(){super.ngOnDestroy()}refresh(){this.folder=void 0,this.id&&this.jam.folder.id({id:this.id,folderIncFolders:!0,folderIncTag:!0}).then(e=>{this.folder=e}).catch(e=>{this.notify.error(e)})}newFolder(){if(!this.folder)return;let e=this.folder,n={folder:e,name:""};this.dialogOverlay.open({childComponent:re,title:"New Folder",data:n,onOkBtn:()=>P(this,null,function*(){try{this.jam.folder.create({id:e.id,name:n.name}).then(o=>{this.folderService.waitForQueueResult("Creating Folder",o,[],[e.id])}).catch(o=>{this.notify.error(o)})}catch(o){return this.notify.error(o),Promise.reject(o)}}),onCancelBtn:()=>P(this,null,function*(){return Promise.resolve()})})}moveSubfolders(){if(!this.id||!this.folder?.folders)return;let e=this.id,n=this.folder.folders.map(a=>a.id),o=[e,...n],s={selectID:e,disableIDs:o};this.dialogOverlay.open({childComponent:ne,title:"Move Subfolders to",data:s,panelClass:"overlay-panel-large-buttons",onOkBtn:()=>P(this,null,function*(){try{let a=s.folder;if(!a)return;o.push(a.id),this.jam.folder.move({ids:n,newParentID:a.id}).then(p=>{this.folderService.waitForQueueResult("Moving Folders",p,[],o)}).catch(p=>{this.notify.error(p)})}catch(a){return this.notify.error(a),Promise.reject(a)}}),onCancelBtn:()=>P(this,null,function*(){return Promise.resolve()})})}static{this.\u0275fac=(()=>{let e;return function(o){return(e||(e=b(t)))(o||t)}})()}static{this.\u0275cmp=S({type:t,selectors:[["app-admin-folder-folders"]],features:[x],decls:2,vars:1,consts:()=>{let e;e=$localize`:␟c8d1785038d461ec66b5799db21864182b35900a␟1102717806459547726:Refresh`;let n;n=$localize`:␟65ab0e571a2c4b74cf959aa0fecf26f78fae4b9f␟5184355384536429227:New Folder…`;let o;return o=$localize`:␟defb5986728ca6ef16d61914a5b0642c36084245␟4062236829893650390:Move Subfolders…`,[[1,"folders"],[1,"actions"],["title",e,1,"button-on-control",3,"click"],[1,"icon-reload"],["title",n,1,"button-on-control",3,"click"],[1,"icon-plus"],["title",o,1,"button-on-control"],["name","Folders",3,"list"],[3,"folders"],["title",o,1,"button-on-control",3,"click"],[1,"icon-right-bold"]]},template:function(n,o){n&1&&c(0,pe,1,0,"app-loading")(1,Oe,9,3,"div",0),n&2&&f(o.folder?o.folder.folders?1:-1:0)},dependencies:[I,le,h,ee],styles:["[_nghost-%COMP%]{height:100%;width:100%;display:block;overflow:hidden}[_nghost-%COMP%]   .folders[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;width:100%}[_nghost-%COMP%]   .folders[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{padding:10px 15px 0;border-bottom-color:var(--background-border);border-bottom-width:1px;border-bottom-style:solid}[_nghost-%COMP%]   .folders[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{margin-right:5px;margin-bottom:10px}[_nghost-%COMP%]   .folders[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%] > label[_ngcontent-%COMP%]{text-transform:uppercase;letter-spacing:1px;font-size:11px;margin-left:5px;margin-right:5px}[_nghost-%COMP%]   .folders[_ngcontent-%COMP%]   app-admin-folder-list[_ngcontent-%COMP%]{overflow-y:auto}"]})}}return t})();export{Xe as AdminFolderFoldersComponent};
