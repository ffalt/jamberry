import{a as c}from"./chunk-3VLHYTEX.js";import{G as m}from"./chunk-3LOKQP2Q.js";import{Wd as u,a,aa as n,e as r,fa as h,ra as o}from"./chunk-XLNNDSL4.js";var w=(()=>{class t{constructor(){this.usersChange=new o,this.userChange=new c,this.jam=h(u),this.notify=h(m),this.users=[]}applyDialogUser(s){return r(this,null,function*(){if(s.user)yield this.jam.user.update(a({id:s.user.id},s.edit)),this.refreshUser(s.user.id);else{let e=yield this.jam.user.create(s.edit);this.users.push(e),this.usersChange.emit(this.users)}})}removeUser(s){return r(this,null,function*(){yield this.jam.user.remove({id:s.id}),this.users=this.users.filter(e=>e.id!==s.id),this.usersChange.emit(this.users),this.userChange.emit(s.id)})}refreshUser(s){this.jam.user.id({id:s}).then(e=>{let i=this.users.findIndex(f=>f.id===s);i===-1?this.users.push(e):this.users[i]=e,this.usersChange.emit(this.users),this.userChange.emit(s,e)}).catch(e=>{this.notify.error(e)})}refreshUsers(){this.jam.user.search({}).then(s=>{this.users=s.items,this.usersChange.emit(this.users)}).catch(s=>{this.notify.error(s)})}setPassword(s,e,i){return r(this,null,function*(){return this.jam.user.changePassword({id:s,password:e,newPassword:i})})}static{this.\u0275fac=function(e){return new(e||t)}}static{this.\u0275prov=n({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();export{w as a};
