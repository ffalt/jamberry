"use strict";(self.webpackChunkjamberry=self.webpackChunkjamberry||[]).push([[240],{4240:(bt,X,v)=>{v.r(X),v.d(X,{AdminModule:()=>ho});var r=v(1180),p=v(4720),O=v(4755),x=v(5030),tt=v(6550),K=v(3926),et=v(2486),dt=v(2364),rt=v(1208),t=v(2223);let H=(()=>{class o{}return(0,r.Z)(o,"\u0275fac",function(e){return new(e||o)}),(0,r.Z)(o,"\u0275cmp",t.Xpm({type:o,selectors:[["app-admin"]],decls:6,vars:0,consts:[[1,"left"],["role","main",1,"middle"]],template:function(e,n){1&e&&(t.TgZ(0,"aside",0),t._UZ(1,"app-admin-sidebar"),t.qZA(),t._UZ(2,"app-splitter"),t.TgZ(3,"main",1),t._UZ(4,"router-outlet"),t.qZA(),t._UZ(5,"app-admin-queue-requests"))},styles:["[_nghost-%COMP%]{width:100%;height:100%;flex:1;display:flex;flex-flow:row nowrap;overflow:hidden;align-items:flex-start;align-content:flex-start}[_nghost-%COMP%]   .left[_ngcontent-%COMP%]{width:15%;height:100%;min-width:140px}[_nghost-%COMP%]   .middle[_ngcontent-%COMP%]{width:85%;flex-grow:1;height:100%}@media (max-width: 1400px){[_nghost-%COMP%]   .left[_ngcontent-%COMP%]{width:20%}[_nghost-%COMP%]   .middle[_ngcontent-%COMP%]{width:80%}}@media (max-width: 768px){[_nghost-%COMP%]{min-height:100%;position:absolute;display:block;flex:none;flex-flow:inherit}[_nghost-%COMP%]   app-splitter[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .left[_ngcontent-%COMP%]{width:100%!important;height:auto}[_nghost-%COMP%]   .middle[_ngcontent-%COMP%]{width:100%;min-height:100%}}"]})),o})();var F=v(5861),k=v(8171),N=v(7579),U=v(2722);const st=["overview","tags","health","tracks","tracks-health"];var m=v(9291),_=v(3689),y=v(6491),Z=v(2205),A=v(7544),T=v(8986);function R(o,l){1&o&&t._UZ(0,"i",14)}function G(o,l){if(1&o&&(t.TgZ(0,"i"),t.ALo(1,"stringToggle"),t.qZA()),2&o){const e=t.oxw().$implicit;t.Tol(t.Dn7(1,2,e.expanded,"icon-minus","icon-plus"))}}function W(o,l){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",7),t.NdJ("click",function(){const a=t.CHM(e).$implicit,h=t.oxw();return t.KtG(h.selectNode(a))})("keydown.enter",function(){const a=t.CHM(e).$implicit,h=t.oxw();return t.KtG(h.selectNode(a))})("keydown.arrowRight",function(){const a=t.CHM(e).$implicit,h=t.oxw();return t.KtG(h.toggleNode(a))})("keydown.arrowLeft",function(){const a=t.CHM(e).$implicit,h=t.oxw();return t.KtG(h.toggleNode(a))}),t.TgZ(2,"span",8),t.NdJ("clickenter",function(){const a=t.CHM(e).$implicit,h=t.oxw();return t.KtG(h.toggleNode(a))}),t.YNc(3,R,1,0,"i",9),t.YNc(4,G,2,6,"i",10),t.qZA(),t.TgZ(5,"span",11),t.NdJ("clickenter",function(){const a=t.CHM(e).$implicit,h=t.oxw();return t.KtG(h.toggleNode(a))}),t.TgZ(6,"i"),t.ALo(7,"stringToggle"),t.qZA()(),t.TgZ(8,"span",12),t._uU(9),t.qZA(),t.TgZ(10,"span",13),t._uU(11),t.qZA()(),t.BQk()}if(2&o){const e=l.$implicit,n=t.oxw();t.xp6(1),t.Udp("padding-left",12*e.level,"px"),t.ekj("active",e===n.selected),t.xp6(1),t.MGl("title","Subfolders: ",e.folder.folderCount,""),t.xp6(1),t.Q6J("ngIf",e.isLoading),t.xp6(1),t.Q6J("ngIf",!e.isLoading&&e.hasChildren),t.xp6(1),t.Udp("color",e.color),t.Q6J("title",e.folder.type),t.xp6(1),t.Tol(t.Dn7(7,15,e.expanded,"icon-folder-open","icon-folder")),t.xp6(2),t.Q6J("title",e.folder.name),t.xp6(1),t.Oqu(e.folder.name),t.xp6(2),t.hij("| ",e.folder.type,"")}}function L(o,l){if(o.children)for(const e of o.children)l(e),L(e,l)}let J=(()=>{class o{constructor(e,n,i,a){(0,r.Z)(this,"app",void 0),(0,r.Z)(this,"jam",void 0),(0,r.Z)(this,"notify",void 0),(0,r.Z)(this,"folderService",void 0),(0,r.Z)(this,"selected",void 0),(0,r.Z)(this,"nodes",[]),(0,r.Z)(this,"expandIDs",[]),(0,r.Z)(this,"autoSelect",!1),(0,r.Z)(this,"selectionChange",new t.vpe),(0,r.Z)(this,"viewport",void 0),(0,r.Z)(this,"unsubscribe",new N.x),this.app=e,this.jam=n,this.notify=i,this.folderService=a}ngOnInit(){this.folderService.foldersChange.pipe((0,U.R)(this.unsubscribe)).subscribe(e=>{const n=this.nodes.find(i=>i.folder.id===e.id);n&&this.jam.folder.id({id:e.id,folderIncTrackCount:!0,folderIncChildFolderCount:!0}).then(i=>{n.folder=i,e.mode===m.dw.fsnRefreshChilds&&n.expanded&&(this.collapseNode(n),n.hasChildren=(i.folderCount||0)>0,n.children=void 0,n.isLoading=!1,n.hasChildren&&(n.expanded=!0,this.checkLoadExpanded(n)))}).catch(i=>{console.error(i)})})}ngOnDestroy(){this.unsubscribe.next(),this.unsubscribe.complete()}selectNode(e){this.selectionChange.emit(e.folder),this.autoSelect&&(this.selected=e)}toggleNode(e){e.expanded?this.collapseNode(e):this.expandNode(e)}refresh(){this.jam.auth.isLoggedIn()&&this.jam.folder.search({level:0,folderIncChildFolderCount:!0,folderIncTrackCount:!0}).then(e=>{this.nodes=e.items.map(n=>({folder:n,hasChildren:(n.folderCount||0)>0,level:0,color:this.typeToColor(n),expanded:this.expandIDs.includes(n.id),isLoading:!1}));for(const n of this.nodes)this.checkLoadExpanded(n)}).catch(e=>{this.notify.error(e)})}typeToColor(e){switch(e.type){case _.Sr.unknown:return"#ff9fAA";case _.Sr.artist:return"#6f806e";case _.Sr.collection:return"#adbced";case _.Sr.album:return"#bdbd9c";case _.Sr.multialbum:return"#bdaaae";case _.Sr.extras:return"#bdbdbd";default:return""}}onFolderUpdate(e){const n=this.nodes.find(i=>i.folder.id===e.id);n&&(n.folder=e)}selectFolderByID(e){const n=this.nodes.find(i=>i.folder.id===e);n?this.selected=n:this.jam.folder.id({id:e,folderIncParents:!0}).then(i=>{if(i.parents){for(const a of i.parents)this.expandIDs.includes(a.id)||this.expandIDs.push(a.id);for(const a of this.nodes)a.expanded=this.expandIDs.includes(a.folder.id),this.checkLoadExpanded(a,e)}}).catch(i=>{this.notify.error(i)})}checkLoadExpanded(e,n){e.expanded&&!e.isLoading&&this.loadChildren(e,i=>{for(const a of i)this.checkLoadExpanded(a,n)}),e.folder.id===n&&(this.selected=e,this.viewport&&this.viewport.scrollToIndex(this.nodes.indexOf(e)))}loadChildren(e,n){e.isLoading||(e.isLoading=!0,this.jam.folder.search({parentIDs:[e.folder.id],folderIncChildFolderCount:!0,folderIncTrackCount:!0}).then(i=>{const a=i.items.sort((b,D)=>b.name.localeCompare(D.name)).map(b=>({folder:b,hasChildren:(b.folderCount||0)>0,level:e.level+1,color:this.typeToColor(b),expanded:this.expandIDs.includes(b.id),isLoading:!1})),h=this.nodes.indexOf(e);h>=0&&(this.nodes=this.nodes.slice(0,h+1).concat(a).concat(this.nodes.slice(h+1))),e.children=a,e.isLoading=!1,n&&n(a)}).catch(i=>{this.notify.error(i)}))}collapseNode(e){if(e.expanded){const n=[];L(e,i=>n.push(i.folder.id)),this.nodes=this.nodes.filter(i=>!n.includes(i.folder.id)),e.expanded=!1,e.children=void 0,this.expandIDs=(this.expandIDs||[]).filter(i=>i!==e.folder.id)}}expandNode(e){if(!e.expanded){if(e.children){const n=this.nodes.indexOf(e);this.nodes=this.nodes.slice(0,n+1).concat(e.children).concat(this.nodes.slice(n+1))}else this.loadChildren(e);this.expandIDs.push(e.folder.id),e.expanded=!0}}}return(0,r.Z)(o,"\u0275fac",function(e){return new(e||o)(t.Y36(m.zi),t.Y36(_.K4),t.Y36(m.c),t.Y36(m.Cr))}),(0,r.Z)(o,"\u0275cmp",t.Xpm({type:o,selectors:[["app-admin-folder-tree"]],viewQuery:function(e,n){if(1&e&&t.Gf(p.N7,7),2&e){let i;t.iGM(i=t.CRH())&&(n.viewport=i.first)}},inputs:{autoSelect:"autoSelect"},outputs:{selectionChange:"selectionChange"},decls:8,vars:2,consts:[[1,"actions"],[1,"name"],["title","Refresh Folder Tree",1,"button-on-control",3,"click"],["aria-hidden","true",1,"icon-reload"],["appFocusKeyList","",1,"tree"],[1,"list-container","list-group",2,"height","100%",3,"itemSize"],[4,"cdkVirtualFor","cdkVirtualForOf"],["appFocusKeyListItem","",1,"node",3,"click","keydown.enter","keydown.arrowRight","keydown.arrowLeft"],[1,"node-toggle",3,"title","clickenter"],["class","icon-spin icon-spinner",4,"ngIf"],[3,"class",4,"ngIf"],[1,"node-icon",3,"title","clickenter"],[3,"title"],[1,"node-type"],[1,"icon-spin","icon-spinner"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"span",1),t._uU(2,"Folders"),t.qZA(),t.TgZ(3,"button",2),t.NdJ("click",function(){return n.refresh()}),t._UZ(4,"i",3),t.qZA()(),t.TgZ(5,"div",4)(6,"cdk-virtual-scroll-viewport",5),t.YNc(7,W,12,19,"ng-container",6),t.qZA()()),2&e&&(t.xp6(6),t.Q6J("itemSize",22),t.xp6(1),t.Q6J("cdkVirtualForOf",n.nodes))},dependencies:[O.O5,y.X,Z.j,A.R,p.xd,p.x0,p.N7,T.C],styles:["[_nghost-%COMP%]{width:100%;height:100%;display:flex;flex-direction:column}[_nghost-%COMP%]   .actions[_ngcontent-%COMP%]{padding:15px 15px 10px;background-color:var(--background-transparent);color:var(--on-control)}[_nghost-%COMP%]   .actions[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{padding-right:10px;vertical-align:middle;color:var(--on-control-active);font-size:20px;font-weight:100}[_nghost-%COMP%]   .tree[_ngcontent-%COMP%]{margin-top:10px;flex:1}[_nghost-%COMP%]   cdk-virtual-scroll-viewport[_ngcontent-%COMP%]{width:100%;height:100%;min-height:100%;overflow-x:hidden}[_nghost-%COMP%]   cdk-virtual-scroll-viewport[_ngcontent-%COMP%]     .cdk-virtual-scroll-content-wrapper{width:100%}[_nghost-%COMP%]   .node[_ngcontent-%COMP%]{width:100%;display:block;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;text-decoration:none;vertical-align:middle;height:22px;cursor:pointer;-webkit-user-select:none;user-select:none;font-size:.9em}[_nghost-%COMP%]   .node[_ngcontent-%COMP%]   .node-toggle[_ngcontent-%COMP%]{display:inline-block;min-width:20px}[_nghost-%COMP%]   .node[_ngcontent-%COMP%]   .node-type[_ngcontent-%COMP%]{padding-left:5px;font-size:.7em;text-transform:uppercase}[_nghost-%COMP%]   .node.active[_ngcontent-%COMP%]{color:var(--on-control-hover)}"]})),o})();var C=v(150);function M(o,l){1&o&&(t.TgZ(0,"a"),t._UZ(1,"i",8),t._uU(2," Show Folder Tools"),t.qZA())}function s(o,l){1&o&&(t.TgZ(0,"a"),t._UZ(1,"i",9),t._uU(2," Show Folder Tree"),t.qZA())}const c=function(o){return["/admin/folder",o,"overview"]},d=function(o){return["/admin/folder",o,"tracks"]},g=function(o){return["/admin/folder",o,"sub-folders"]},u=function(o){return["/admin/folder",o,"tags"]},f=function(o){return["/admin/folder",o,"health"]},w=function(o){return["/admin/folder",o,"tracks-health"]};function I(o,l){if(1&o&&(t.TgZ(0,"nav",10)(1,"ul",11)(2,"li",12)(3,"a"),t._uU(4,"Overview"),t.qZA()(),t.TgZ(5,"li",12)(6,"a"),t._uU(7,"Tracks"),t.qZA()(),t.TgZ(8,"li",12)(9,"a"),t._uU(10,"Folders"),t.qZA()(),t.TgZ(11,"li",12)(12,"a"),t._uU(13,"Tags"),t.qZA()(),t.TgZ(14,"li",12)(15,"a"),t._uU(16,"Health"),t.qZA()(),t.TgZ(17,"li",12)(18,"a"),t._uU(19,"Track Health"),t.qZA()()()()),2&o){const e=t.oxw();t.xp6(2),t.Q6J("routerLink",t.VKq(6,c,e.id)),t.xp6(3),t.Q6J("routerLink",t.VKq(8,d,e.id)),t.xp6(3),t.Q6J("routerLink",t.VKq(10,g,e.id)),t.xp6(3),t.Q6J("routerLink",t.VKq(12,u,e.id)),t.xp6(3),t.Q6J("routerLink",t.VKq(14,f,e.id)),t.xp6(3),t.Q6J("routerLink",t.VKq(16,w,e.id))}}let S=(()=>{class o{constructor(e,n,i){(0,r.Z)(this,"route",void 0),(0,r.Z)(this,"router",void 0),(0,r.Z)(this,"uiState",void 0),(0,r.Z)(this,"id",""),(0,r.Z)(this,"tree",void 0),(0,r.Z)(this,"rightActive",!1),(0,r.Z)(this,"unsubscribe",new N.x),(0,r.Z)(this,"mode","overview"),this.route=e,this.router=n,this.uiState=i}refresh(){this.tree&&this.tree.refresh()}selectionChange(e){this.router.navigate([`/admin/folder/${e.id}/${this.mode}`]).catch(n=>{console.error(n)})}onFolderUpdate(e){this.tree&&this.tree.onFolderUpdate(e)}ngOnInit(){this.router.events.pipe((0,U.R)(this.unsubscribe)).subscribe(e=>{if(e instanceof k.m2&&this.route.firstChild&&this.route.firstChild.snapshot.url[0]){const n=this.route.firstChild.snapshot.url[0].path;st.includes(n)&&(this.mode=n)}}),this.route&&this.route.params.pipe((0,U.R)(this.unsubscribe)).subscribe(e=>{const n=e.id;this.id=n,this.tree&&n&&setTimeout(()=>{this.tree&&this.tree.selectFolderByID(n)})}),this.tree&&(this.tree.expandIDs=this.uiState.data["app-admin-folders"]||[]),this.refresh()}ngOnDestroy(){this.tree&&(this.uiState.data["app-admin-folders"]=this.tree.expandIDs),this.unsubscribe.next(),this.unsubscribe.complete()}}return(0,r.Z)(o,"\u0275fac",function(e){return new(e||o)(t.Y36(k.gz),t.Y36(k.F0),t.Y36(m.JU))}),(0,r.Z)(o,"\u0275cmp",t.Xpm({type:o,selectors:[["app-admin-folder"]],viewQuery:function(e,n){if(1&e&&t.Gf(J,7),2&e){let i;t.iGM(i=t.CRH())&&(n.tree=i.first)}},hostVars:2,hostBindings:function(e,n){2&e&&t.ekj("right-active",n.rightActive)},decls:11,vars:3,consts:[[1,"toggle",3,"click"],[4,"ngIf"],[1,"content"],[1,"left-content"],[3,"selectionChange"],[1,"right-content"],["class","navigation",4,"ngIf"],[1,"router-content"],[1,"icon-right"],[1,"icon-left"],[1,"navigation"],[1,"tabs"],["routerLinkActive","active",3,"routerLink"]],template:function(e,n){1&e&&(t.TgZ(0,"button",0),t.NdJ("click",function(){return n.rightActive=!n.rightActive}),t.YNc(1,M,3,0,"a",1),t.YNc(2,s,3,0,"a",1),t.qZA(),t.TgZ(3,"div",2)(4,"div",3)(5,"app-admin-folder-tree",4),t.NdJ("selectionChange",function(a){return n.selectionChange(a)}),t.qZA()(),t._UZ(6,"app-splitter"),t.TgZ(7,"div",5),t.YNc(8,I,20,18,"nav",6),t.TgZ(9,"div",7),t._UZ(10,"router-outlet"),t.qZA()()()),2&e&&(t.xp6(1),t.Q6J("ngIf",!n.rightActive),t.xp6(1),t.Q6J("ngIf",n.rightActive),t.xp6(6),t.Q6J("ngIf",n.id))},dependencies:[O.O5,C.H,k.lC,k.rH,k.Od,J],styles:["[_nghost-%COMP%]{overflow-y:auto;overflow-x:hidden;height:100%;width:100%;min-height:100%;flex:1 1 auto;position:relative;display:flex;flex-direction:column;overflow:hidden}[_nghost-%COMP%]   .toggle[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]{width:100%;z-index:1;display:flex;flex-flow:row wrap;justify-content:space-between;align-items:center;background-color:var(--background-transparent);color:var(--on-control)}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%]{padding-left:0;margin-top:0;margin-bottom:0;list-style:none;border:none;display:flex;flex-flow:row wrap;width:100%}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{position:relative;display:block;margin-bottom:-1px;flex:1;align-self:stretch;border-top-width:4px;border-top-style:solid;border-top-color:transparent;border-bottom-width:4px;border-bottom-style:solid;border-bottom-color:transparent;padding:0}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]:hover{background-color:var(--control-hover);transition:all .4s ease;border-bottom-width:4px;border-bottom-style:solid;border-bottom-color:transparent}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{padding-bottom:15px}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{padding:10px 0;text-align:center;align-items:center;align-content:center;justify-content:center;margin-right:2px;line-height:1.42857143;border-radius:4px 4px 0 0;position:relative;display:flex;cursor:pointer;border:none;font-size:14px;text-transform:uppercase;letter-spacing:.5px;height:100%;color:var(--on-control);-webkit-user-select:none;user-select:none}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]:focus, [_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]:hover{background-color:unset;border:none;color:var(--on-control-hover)}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%] > li.active[_ngcontent-%COMP%]{cursor:default;border-bottom-color:var(--primary)!important}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%] > li.active[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:default;background-color:unset;color:var(--on-control-hover)}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%] > li.active[_ngcontent-%COMP%]:focus, [_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%] > li.active[_ngcontent-%COMP%]:hover{border-bottom-color:var(--primary)}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%] > li.disabled[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{color:var(--on-control-ambient-disabled)}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%] > li.disabled[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]:focus, [_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%] > li.disabled[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]:hover{color:var(--on-control-ambient-disabled);text-decoration:none;cursor:not-allowed;background-color:transparent}@media (max-width: 768px){[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%]{align-items:center;align-content:center;justify-content:center}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{padding:5px;min-width:33%}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{font-size:.8em}}@media (max-width: 400px){[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{padding:0 5px}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{font-size:.7em}}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs.mini[_ngcontent-%COMP%]{padding-left:15px;padding-right:15px}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs.mini[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{flex:0}@media (max-width: 768px){[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs.mini[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{min-width:20px}}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]{width:100%;height:100%;flex:1;display:flex;flex-flow:row nowrap;overflow:hidden;align-items:flex-start;align-content:flex-start;padding:0;min-height:100%}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .left-content[_ngcontent-%COMP%]{height:100%;width:20%;display:block;border-right:1px solid var(--background-border);min-width:240px}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .right-content[_ngcontent-%COMP%]{width:80%;flex-shrink:1;flex-grow:1;height:100%;display:flex;flex-flow:column nowrap;position:relative;overflow:hidden}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .right-content[_ngcontent-%COMP%]   .router-content[_ngcontent-%COMP%]{width:100%;height:100%;display:block;overflow:hidden}@media (max-width: 522px){[_nghost-%COMP%]{height:100%;width:100%;min-height:100%;overflow:hidden}[_nghost-%COMP%]   .toggle[_ngcontent-%COMP%]{display:block;position:relative;width:100%;height:33px;text-align:center;padding-top:5px;border-bottom:1px solid var(--background-border)}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]{width:100%;height:calc(100% - 33px);min-height:calc(100% - 33px);overflow:hidden;display:block;flex:none;position:relative}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   app-splitter[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .left-content[_ngcontent-%COMP%]{display:flex;height:100%;width:100%}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .right-content[_ngcontent-%COMP%]{display:none;height:100%;width:100%}.right-active[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .left-content[_ngcontent-%COMP%]{display:none}.right-active[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .right-content[_ngcontent-%COMP%]{display:flex}}"]})),o})(),P=(()=>{class o{constructor(e){(0,r.Z)(this,"route",void 0),(0,r.Z)(this,"id",void 0),(0,r.Z)(this,"unsubscribe",new N.x),this.route=e}ngOnInit(){this.route&&this.route.parent&&this.route.parent.params.pipe((0,U.R)(this.unsubscribe)).subscribe(e=>{this.resolve(e),this.refresh()})}idChanged(){}refresh(){}ngOnDestroy(){this.unsubscribe.next(),this.unsubscribe.complete()}resolve(e){this.id=e.id,this.idChanged()}}return(0,r.Z)(o,"\u0275fac",function(e){return new(e||o)(t.Y36(k.gz))}),(0,r.Z)(o,"\u0275cmp",t.Xpm({type:o,selectors:[["app-admin-base-parent-view-id"]],decls:0,vars:0,template:function(e,n){}})),o})(),B=(()=>{class o{constructor(){(0,r.Z)(this,"data",void 0),(0,r.Z)(this,"tree",void 0)}selectionChange(e){this.data&&(this.data.folder=e)}dialogInit(e,n){this.data=n.data,this.tree&&(this.tree.refresh(),this.data?.selectID&&this.tree.selectFolderByID(this.data.selectID))}}return(0,r.Z)(o,"\u0275fac",function(e){return new(e||o)}),(0,r.Z)(o,"\u0275cmp",t.Xpm({type:o,selectors:[["app-dialog-choose-folder"]],viewQuery:function(e,n){if(1&e&&t.Gf(J,7),2&e){let i;t.iGM(i=t.CRH())&&(n.tree=i.first)}},decls:1,vars:1,consts:[[3,"autoSelect","selectionChange"]],template:function(e,n){1&e&&(t.TgZ(0,"app-admin-folder-tree",0),t.NdJ("selectionChange",function(a){return n.selectionChange(a)}),t.qZA()),2&e&&t.Q6J("autoSelect",!0)},dependencies:[J],styles:["[_nghost-%COMP%]{flex:1}"]})),o})();const nt=function(){return{standalone:!0}};function j(o,l){if(1&o){const e=t.EpF();t.TgZ(0,"div")(1,"form")(2,"div",1)(3,"label",2),t._uU(4,"Name"),t.qZA(),t.TgZ(5,"input",3),t.NdJ("ngModelChange",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.edit.name=i)}),t.qZA()()()()}if(2&o){const e=t.oxw();t.xp6(5),t.Q6J("ngModelOptions",t.DdM(2,nt))("ngModel",e.edit.name)}}let E=(()=>{class o{constructor(){(0,r.Z)(this,"edit",void 0)}dialogInit(e,n){this.edit=n.data}}return(0,r.Z)(o,"\u0275fac",function(e){return new(e||o)}),(0,r.Z)(o,"\u0275cmp",t.Xpm({type:o,selectors:[["app-dialog-folder"]],decls:1,vars:1,consts:[[4,"ngIf"],[1,"user-form-control"],["for","dialog-folder-edit"],["id","dialog-folder-edit","type","text","name","folder-name",3,"ngModelOptions","ngModel","ngModelChange"]],template:function(e,n){1&e&&t.YNc(0,j,6,3,"div",0),2&e&&t.Q6J("ngIf",n.edit)},dependencies:[O.O5,x._Y,x.Fj,x.JJ,x.JL,x.On,x.F],styles:["[_nghost-%COMP%] > div[_ngcontent-%COMP%]{margin-left:20px;margin-right:20px}[_nghost-%COMP%]   input[type=text][_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]   input[_ngcontent-%COMP%]{font-size:1.3em;line-height:1.3em}[_nghost-%COMP%]   .user-form-control[_ngcontent-%COMP%]{margin-bottom:8px;display:block}"]})),o})();var q=v(2747),z=v(7841),Q=v(2569),Y=v(7480);function _t(o,l){if(1&o&&(t.ynx(0),t._uU(1),t.BQk()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.hij(" / ",null==e.folder.tag?null:e.folder.tag.albumType,"")}}const mt=function(o){return["/admin/folder",o,"overview"]};function ft(o,l){if(1&o){const e=t.EpF();t.TgZ(0,"tr",10),t.NdJ("click",function(){const a=t.CHM(e).$implicit;return t.KtG(a.selected=!a.selected)}),t.TgZ(1,"td",4)(2,"a",11),t._uU(3),t.qZA()(),t.TgZ(4,"td",5),t._uU(5),t.qZA(),t.TgZ(6,"td",6),t._uU(7),t.qZA(),t.TgZ(8,"td",7),t._uU(9),t.qZA(),t.TgZ(10,"td",8),t._uU(11),t.YNc(12,_t,2,1,"ng-container",12),t.qZA()()}if(2&o){const e=l.$implicit;t.ekj("selected",e.selected),t.xp6(2),t.Q6J("routerLink",t.VKq(9,mt,e.folder.id)),t.xp6(1),t.Oqu(e.folder.name),t.xp6(2),t.Oqu(null==e.folder.tag?null:e.folder.tag.artist),t.xp6(2),t.Oqu(null==e.folder.tag?null:e.folder.tag.album),t.xp6(2),t.Oqu(null==e.folder.tag?null:e.folder.tag.year),t.xp6(2),t.hij(" ",e.folder.type," "),t.xp6(1),t.Q6J("ngIf",null==e.folder.tag?null:e.folder.tag.albumType)}}function Ct(o,l){if(1&o&&(t.TgZ(0,"table",2)(1,"tr",3)(2,"td",4),t._uU(3,"Title"),t.qZA(),t.TgZ(4,"td",5),t._uU(5,"Artist"),t.qZA(),t.TgZ(6,"td",6),t._uU(7,"Album"),t.qZA(),t.TgZ(8,"td",7),t._uU(9,"Year"),t.qZA(),t.TgZ(10,"td",8),t._uU(11,"Type"),t.qZA()(),t.YNc(12,ft,13,11,"tr",9),t.qZA()),2&o){const e=t.oxw();t.xp6(12),t.Q6J("ngForOf",e.folderItems)("ngForTrackBy",e.trackByFn)}}class xt{constructor(l){(0,r.Z)(this,"folder",void 0),(0,r.Z)(this,"selected",void 0),this.folder=l}}let yt=(()=>{class o{constructor(){(0,r.Z)(this,"folders",[]),(0,r.Z)(this,"folderItems",[])}trackByFn(e,n){return n.folder.id}getSortValue(e,n){switch(e){case"name":return n.name;case"artist":return n.tag?.artist;case"album":return n.tag?.album;case"type":return n.type;default:return}}ngOnChanges(){this.folderItems=(this.folders||[]).map(e=>new xt(e))}}return(0,r.Z)(o,"\u0275fac",function(e){return new(e||o)}),(0,r.Z)(o,"\u0275cmp",t.Xpm({type:o,selectors:[["app-admin-folder-list"]],inputs:{folders:"folders"},features:[t.TTD],decls:2,vars:2,consts:[["name","Folders",3,"list"],["class","folders",4,"ngIf"],[1,"folders"],[1,"folder","heading"],[1,"title"],[1,"artist"],[1,"album"],[1,"year"],[1,"type"],["class","folder",3,"selected","click",4,"ngFor","ngForOf","ngForTrackBy"],[1,"folder",3,"click"],[3,"routerLink"],[4,"ngIf"]],template:function(e,n){1&e&&(t._UZ(0,"app-background-text-list",0),t.YNc(1,Ct,13,2,"table",1)),2&e&&(t.Q6J("list",n.folderItems),t.xp6(1),t.Q6J("ngIf",n.folderItems&&n.folderItems.length>0))},dependencies:[O.sg,O.O5,Q.$,k.rH],styles:["[_nghost-%COMP%]{width:100%;overflow:auto;display:block}[_nghost-%COMP%]   .folders[_ngcontent-%COMP%]{padding:15px;font-size:.8em;width:100%}[_nghost-%COMP%]   .heading[_ngcontent-%COMP%]{font-size:.9em}[_nghost-%COMP%]   .folder[_ngcontent-%COMP%]{border-bottom:1px solid var(--control-border)}[_nghost-%COMP%]   .folder[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:5px 10px}[_nghost-%COMP%]   .folder[_ngcontent-%COMP%]:hover{background-color:var(--background-hover)}[_nghost-%COMP%]   .folder.selected[_ngcontent-%COMP%]{background-color:var(--background-active)}"]})),o})();function wt(o,l){1&o&&t._UZ(0,"app-loading")}function gt(o,l){if(1&o){const e=t.EpF();t.TgZ(0,"button",11),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.moveSubfolders())}),t._UZ(1,"i",12),t.qZA()}}function pt(o,l){if(1&o&&t._UZ(0,"app-admin-folder-list",13),2&o){const e=t.oxw(2);t.Q6J("folders",e.folder.folders)}}function ct(o,l){if(1&o){const e=t.EpF();t.TgZ(0,"div",2)(1,"div",3)(2,"button",4),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.refresh())}),t._UZ(3,"i",5),t.qZA(),t.TgZ(4,"button",6),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.newFolder())}),t._UZ(5,"i",7),t.qZA(),t.YNc(6,gt,2,0,"button",8),t.qZA(),t._UZ(7,"app-background-text-list",9),t.YNc(8,pt,1,1,"app-admin-folder-list",10),t.qZA()}if(2&o){const e=t.oxw();t.xp6(6),t.Q6J("ngIf",null==e.folder||null==e.folder.folders?null:e.folder.folders.length),t.xp6(1),t.Q6J("list",e.folder.folders),t.xp6(1),t.Q6J("ngIf",null==e.folder.folders?null:e.folder.folders.length)}}let Mt=(()=>{class o extends P{constructor(e,n,i,a,h,b){super(e),(0,r.Z)(this,"jam",void 0),(0,r.Z)(this,"notify",void 0),(0,r.Z)(this,"folderService",void 0),(0,r.Z)(this,"dialogsService",void 0),(0,r.Z)(this,"dialogOverlay",void 0),(0,r.Z)(this,"folder",void 0),this.jam=n,this.notify=i,this.folderService=a,this.dialogsService=h,this.dialogOverlay=b}ngOnInit(){super.ngOnInit(),this.folderService.foldersChange.pipe((0,U.R)(this.unsubscribe)).subscribe(e=>{e.id===this.id&&this.refresh()})}ngOnDestroy(){super.ngOnDestroy()}refresh(){this.folder=void 0,this.id&&this.jam.folder.id({id:this.id,folderIncFolders:!0,folderIncTag:!0}).then(e=>{this.folder=e}).catch(e=>{this.notify.error(e)})}newFolder(){var e=this;if(!this.folder)return;const n=this.folder,i={folder:n,name:""};var a;this.dialogOverlay.open({childComponent:E,title:"New Folder",data:i,onOkBtn:(a=(0,F.Z)(function*(){try{e.jam.folder.create({id:n.id,name:i.name}).then(h=>{e.folderService.waitForQueueResult("Creating Folder",h,[],[n.id])}).catch(h=>{e.notify.error(h)})}catch(h){return e.notify.error(h),Promise.reject(h)}}),function(){return a.apply(this,arguments)}),onCancelBtn:function(){var a=(0,F.Z)(function*(){return Promise.resolve()});return function(){return a.apply(this,arguments)}}()})}moveSubfolders(){var e=this;if(!this.id||!this.folder?.folders)return;const n=this.id,i=this.folder.folders.map(b=>b.id),a=[n].concat(i),h={selectID:n,disableIDs:a};var b;this.dialogOverlay.open({title:"Move Subfolders to",childComponent:B,data:h,panelClass:"overlay-panel-large-buttons",onOkBtn:(b=(0,F.Z)(function*(){try{const D=h.folder;if(!D)return;a.push(D.id),e.jam.folder.move({ids:i,newParentID:D.id}).then(V=>{e.folderService.waitForQueueResult("Moving Folders",V,[],a)}).catch(V=>{e.notify.error(V)})}catch(D){return e.notify.error(D),Promise.reject(D)}}),function(){return b.apply(this,arguments)}),onCancelBtn:function(){var b=(0,F.Z)(function*(){return Promise.resolve()});return function(){return b.apply(this,arguments)}}()})}}return(0,r.Z)(o,"\u0275fac",function(e){return new(e||o)(t.Y36(k.gz),t.Y36(_.K4),t.Y36(m.c),t.Y36(m.Cr),t.Y36(q.Hr),t.Y36(z.SL))}),(0,r.Z)(o,"\u0275cmp",t.Xpm({type:o,selectors:[["app-admin-folder-folders"]],features:[t.qOj],decls:2,vars:2,consts:[[4,"ngIf"],["class","folders",4,"ngIf"],[1,"folders"],[1,"actions"],["title","Refresh",1,"button-on-control",3,"click"],[1,"icon-reload"],["title","New Folder\u2026",1,"button-on-control",3,"click"],[1,"icon-plus"],["class","button-on-control","title","Move Subfolders\u2026",3,"click",4,"ngIf"],["name","Folders",3,"list"],[3,"folders",4,"ngIf"],["title","Move Subfolders\u2026",1,"button-on-control",3,"click"],[1,"icon-right-bold"],[3,"folders"]],template:function(e,n){1&e&&(t.YNc(0,wt,1,0,"app-loading",0),t.YNc(1,ct,9,3,"div",1)),2&e&&(t.Q6J("ngIf",!n.folder),t.xp6(1),t.Q6J("ngIf",n.folder&&n.folder.folders))},dependencies:[O.O5,Q.$,Y.N,yt],styles:["[_nghost-%COMP%]{height:100%;width:100%;display:block;overflow:hidden}[_nghost-%COMP%]   .folders[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;width:100%}[_nghost-%COMP%]   .folders[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{padding:10px 15px 0;border-bottom-color:var(--background-border);border-bottom-width:1px;border-bottom-style:solid}[_nghost-%COMP%]   .folders[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{margin-right:5px;margin-bottom:10px}[_nghost-%COMP%]   .folders[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%] > label[_ngcontent-%COMP%]{text-transform:uppercase;letter-spacing:1px;font-size:11px;margin-left:5px;margin-right:5px}[_nghost-%COMP%]   .folders[_ngcontent-%COMP%]   app-admin-folder-list[_ngcontent-%COMP%]{overflow-y:auto}"]})),o})();var Zt=v(529),$=v(3144),lt=v(6229),vt=v(2689);function ot(o,l){if(1&o){const e=t.EpF();t.TgZ(0,"image-cropper",6),t.NdJ("imageCropped",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.imageCropped(i))})("imageLoaded",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.imageLoaded())})("cropperReady",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.cropperReady())})("loadImageFailed",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.loadImageFailed())}),t.qZA()}if(2&o){const e=t.oxw();t.Q6J("imageBase64",e.imageBase64)("format","jpeg")("maintainAspectRatio",e.maintainAspectRatio)}}function it(o,l){if(1&o&&(t.TgZ(0,"div",7),t._UZ(1,"img",8),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("src",e.croppedImage,t.LSH)}}let Qt=(()=>{class o{constructor(e,n,i,a){(0,r.Z)(this,"app",void 0),(0,r.Z)(this,"jam",void 0),(0,r.Z)(this,"folderService",void 0),(0,r.Z)(this,"notify",void 0),(0,r.Z)(this,"data",void 0),(0,r.Z)(this,"imageBase64",""),(0,r.Z)(this,"croppedImage",void 0),(0,r.Z)(this,"croppedImageFile",void 0),(0,r.Z)(this,"mimeType","image/jpeg"),(0,r.Z)(this,"maintainAspectRatio",!0),(0,r.Z)(this,"imageEdited",new t.vpe),(0,r.Z)(this,"unsubscribe",new N.x),this.app=e,this.jam=n,this.folderService=i,this.notify=a}ngOnDestroy(){this.unsubscribe.next(),this.unsubscribe.complete()}load(){this.data&&this.jam.image.imageBinary({id:this.data.artwork.id}).then(e=>{this.imageBase64=`data:${e.contentType||"image/jpeg"};base64,${(0,vt.q)(e.buffer)}`}).catch(e=>{this.notify.error(e)})}imageCropped(e){e.base64&&(this.croppedImage=e.base64,this.croppedImageFile=(0,rt.Ll)(e.base64))}imageLoaded(){}cropperReady(){}loadImageFailed(){}ngOnChanges(){this.load()}upload(){if(!this.croppedImageFile||!this.data)return;const e=this.data.folderID,n=new File([this.croppedImageFile],this.data.artwork.name,{type:this.croppedImageFile.type});this.jam.artwork.update({id:this.data.artwork.id},n).pipe((0,U.R)(this.unsubscribe)).subscribe(i=>{i.type===$.dt.Response&&(this.folderService.waitForQueueResult("Updating Folder Artwork",i.body,[e]),this.imageEdited.emit())},i=>{this.notify.error(i)},()=>{this.notify.success("Upload done")})}}return(0,r.Z)(o,"\u0275fac",function(e){return new(e||o)(t.Y36(m.zi),t.Y36(_.K4),t.Y36(m.Cr),t.Y36(m.c))}),(0,r.Z)(o,"\u0275cmp",t.Xpm({type:o,selectors:[["app-admin-artwork-edit"]],inputs:{data:"data"},outputs:{imageEdited:"imageEdited"},features:[t.TTD],decls:9,vars:4,consts:[[1,"image-crop"],["type","checkbox",3,"checked","ngModel","ngModelChange"],[3,"imageBase64","format","maintainAspectRatio","imageCropped","imageLoaded","cropperReady","loadImageFailed",4,"ngIf"],["class","image-preview",4,"ngIf"],[1,"buttons"],[1,"button-on-control",3,"click"],[3,"imageBase64","format","maintainAspectRatio","imageCropped","imageLoaded","cropperReady","loadImageFailed"],[1,"image-preview"],["alt","Cropped Image",3,"src"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"label")(2,"input",1),t.NdJ("ngModelChange",function(a){return n.maintainAspectRatio=a}),t.qZA(),t._uU(3," Maintain Aspect Ratio "),t.qZA(),t.YNc(4,ot,1,3,"image-cropper",2),t.qZA(),t.YNc(5,it,2,1,"div",3),t.TgZ(6,"div",4)(7,"button",5),t.NdJ("click",function(){return n.upload()}),t._uU(8,"Use Cropped Artwork"),t.qZA()()),2&e&&(t.xp6(2),t.Q6J("checked",n.maintainAspectRatio)("ngModel",n.maintainAspectRatio),t.xp6(2),t.Q6J("ngIf",n.imageBase64),t.xp6(1),t.Q6J("ngIf",n.croppedImage))},dependencies:[O.O5,x.Wl,x.JJ,x.On,rt.ap],styles:["[_nghost-%COMP%]{width:100%;display:block;text-align:center}[_nghost-%COMP%]   image-cropper[_ngcontent-%COMP%]{width:300px;display:block}[_nghost-%COMP%]   .image-crop[_ngcontent-%COMP%]{display:inline-block;text-align:center;margin-left:10px;margin-right:10px}[_nghost-%COMP%]   .image-preview[_ngcontent-%COMP%]{margin-left:10px;margin-right:10px;display:inline-block}[_nghost-%COMP%]   .image-preview[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:300px}"]})),o})();function Nt(o,l){if(1&o){const e=t.EpF();t.TgZ(0,"app-admin-artwork-edit",1),t.NdJ("imageEdited",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.onImageEdited())}),t.qZA()}if(2&o){const e=t.oxw();t.Q6J("data",e.data)}}let zt=(()=>{class o{constructor(){(0,r.Z)(this,"data",void 0),(0,r.Z)(this,"reference",void 0),(0,r.Z)(this,"loading",!0)}dialogInit(e,n){this.data=n.data,this.reference=e}onImageEdited(){this.reference&&this.reference.close()}}return(0,r.Z)(o,"\u0275fac",function(e){return new(e||o)}),(0,r.Z)(o,"\u0275cmp",t.Xpm({type:o,selectors:[["app-image-edit-overlay-content"]],decls:1,vars:1,consts:[[3,"data","imageEdited",4,"ngIf"],[3,"data","imageEdited"]],template:function(e,n){1&e&&t.YNc(0,Nt,1,1,"app-admin-artwork-edit",0),2&e&&t.Q6J("ngIf",n.data)},dependencies:[O.O5,Qt]})),o})();const Et=["inlineEditControl"];function Yt(o,l){if(1&o){const e=t.EpF();t.TgZ(0,"div",2)(1,"input",3,4),t.NdJ("ngModelChange",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.value=i)})("blur",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.onBlur())})("keydown.enter",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.apply())}),t.qZA()()}if(2&o){const e=t.oxw();t.xp6(1),t.Q6J("required",e.required)("name",e.value)("type",e.type)("placeholder",e.placeholder)("ngModel",e.value)}}function Bt(o,l){if(1&o){const e=t.EpF();t.TgZ(0,"div")(1,"div",5),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.edit(i.value))})("focus",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.edit(i.value))}),t._uU(2),t._UZ(3,"i",6),t.qZA()()}if(2&o){const e=t.oxw();t.xp6(2),t.hij("",e.value,"\xa0")}}let Tt=(()=>{class o{constructor(){(0,r.Z)(this,"inlineEditControl",void 0),(0,r.Z)(this,"placeholder",""),(0,r.Z)(this,"type","text"),(0,r.Z)(this,"required",!1),(0,r.Z)(this,"disabled",!1),(0,r.Z)(this,"endEditRequest",new t.vpe),(0,r.Z)(this,"editing",!1),(0,r.Z)(this,"editValue",""),(0,r.Z)(this,"preValue",""),(0,r.Z)(this,"onChange",Function.prototype),(0,r.Z)(this,"onTouched",Function.prototype)}get value(){return this.editValue}set value(e){e!==this.editValue&&(this.editValue=e,this.onChange(e))}writeValue(e){this.editValue=e}registerOnChange(e){this.onChange=e}registerOnTouched(e){this.onTouched=e}onBlur(){this.editing=!1,this.preValue!==this.editValue&&this.endEditRequest.emit()}apply(){this.editing=!1,this.endEditRequest.emit()}edit(e){this.disabled||(this.preValue=e,this.editing=!0,setTimeout(()=>{this.inlineEditControl?.nativeElement&&this.inlineEditControl.nativeElement.focus()}))}}return(0,r.Z)(o,"\u0275fac",function(e){return new(e||o)}),(0,r.Z)(o,"\u0275cmp",t.Xpm({type:o,selectors:[["app-inline-edit"]],viewQuery:function(e,n){if(1&e&&t.Gf(Et,5),2&e){let i;t.iGM(i=t.CRH())&&(n.inlineEditControl=i.first)}},inputs:{placeholder:"placeholder",type:"type",required:"required",disabled:"disabled"},outputs:{endEditRequest:"endEditRequest"},features:[t._Bn([{provide:x.JU,useExisting:o,multi:!0}])],decls:2,vars:2,consts:[["class","inline-edit-edit",4,"ngIf"],[4,"ngIf"],[1,"inline-edit-edit"],[3,"required","name","type","placeholder","ngModel","ngModelChange","blur","keydown.enter"],["inlineEditControl",""],["title","Click to edit","tabindex","0",1,"inline-edit",3,"click","focus"],[1,"icon-edit"]],template:function(e,n){1&e&&(t.YNc(0,Yt,3,5,"div",0),t.YNc(1,Bt,4,1,"div",1)),2&e&&(t.Q6J("ngIf",n.editing),t.xp6(1),t.Q6J("ngIf",!n.editing))},dependencies:[O.O5,x.Fj,x.JJ,x.Q7,x.On],styles:[".inline-edit{cursor:pointer}.inline-edit i{font-size:.7em}.inline-edit-edit{width:100%;display:block}.inline-edit-edit input{width:100%}\n"],encapsulation:2})),o})();var Lt=v(4627);function jt(o,l){if(1&o){const e=t.EpF();t.TgZ(0,"div",2),t.NdJ("keydown.enter",function(){const a=t.CHM(e).$implicit,h=t.oxw();return t.KtG(h.editArtwork(a.artwork))}),t.TgZ(1,"div",3)(2,"img",4),t.NdJ("clickenter",function(){const a=t.CHM(e).$implicit,h=t.oxw();return t.KtG(h.editArtwork(a.artwork))}),t.qZA(),t.TgZ(3,"div",5),t._uU(4),t.qZA(),t.TgZ(5,"div",6),t._uU(6),t.qZA(),t.TgZ(7,"div",7),t._uU(8),t.qZA(),t.TgZ(9,"div",8),t._uU(10),t.ALo(11,"filesize"),t.qZA()(),t.TgZ(12,"div",9)(13,"app-inline-edit",10),t.NdJ("ngModelChange",function(i){const h=t.CHM(e).$implicit;return t.KtG(h.name=i)})("endEditRequest",function(){const a=t.CHM(e).$implicit,h=t.oxw();return t.KtG(h.editArtworkName(a))}),t.qZA(),t.TgZ(14,"a",11),t.NdJ("clickenter",function(){const a=t.CHM(e).$implicit,h=t.oxw();return t.KtG(h.removeArtwork(a))}),t._UZ(15,"i",12),t.qZA()()()}if(2&o){const e=l.$implicit;t.xp6(2),t.Q6J("src",e.thumbnail,t.LSH),t.xp6(2),t.Oqu(e.artwork.types),t.xp6(2),t.Oqu(e.artwork.format),t.xp6(2),t.AsE("",e.artwork.width,"x",e.artwork.height,""),t.xp6(2),t.Oqu(t.lcZ(11,7,e.artwork.size)),t.xp6(3),t.Q6J("ngModel",e.name)}}function Kt(o){const l=o.split(".");return l.pop(),l.join(".")}function Gt(o){const l=o.split(".");return l[l.length-1]}let It=(()=>{class o{constructor(e,n,i,a,h,b){(0,r.Z)(this,"app",void 0),(0,r.Z)(this,"jam",void 0),(0,r.Z)(this,"notify",void 0),(0,r.Z)(this,"folderService",void 0),(0,r.Z)(this,"dialogs",void 0),(0,r.Z)(this,"dialogOverlay",void 0),(0,r.Z)(this,"artworks",void 0),(0,r.Z)(this,"folderID",void 0),(0,r.Z)(this,"nodes",void 0),this.app=e,this.jam=n,this.notify=i,this.folderService=a,this.dialogs=h,this.dialogOverlay=b}trackByFn(e,n){return n.artwork.id}ngOnChanges(){this.displayArtworks()}editArtworkName(e){this.jam.artwork.rename({id:e.artwork.id,newName:e.name}).then(n=>{this.folderService.waitForQueueResult("Renaming Artwork",n,this.folderID?[this.folderID]:[],[])}).catch(n=>{this.notify.error(n)})}editArtwork(e){this.dialogOverlay.open({childComponent:zt,title:"Edit Image",data:{artwork:e,folderID:this.folderID},panelClass:""})}showArtwork(e){const n=e.types.join(", ");this.dialogOverlay.open({title:n,childComponent:lt.$w,data:{name:n,url:this.jam.image.imageUrl({id:e.id})}})}removeArtwork(e){this.dialogs.confirm("Remove Artworks?",`Do you want to delete "${e.artwork.name}"?`,()=>{this.jam.artwork.remove({id:e.artwork.id}).then(n=>{this.nodes&&(this.nodes=this.nodes.filter(i=>i!==e)),this.folderService.waitForQueueResult("Removing Artwork",n,this.folderID?[this.folderID]:[])}).catch(n=>{this.notify.error(n)})})}displayArtworks(){this.nodes=[],this.artworks&&(this.nodes=this.artworks.map(e=>({name:Kt(e.name),type:Gt(e.name),artwork:e,thumbnail:this.jam.image.imageUrl({id:e.id,size:128,format:_.GU.webp})})))}}return(0,r.Z)(o,"\u0275fac",function(e){return new(e||o)(t.Y36(m.zi),t.Y36(_.K4),t.Y36(m.c),t.Y36(m.Cr),t.Y36(q.Hr),t.Y36(z.SL))}),(0,r.Z)(o,"\u0275cmp",t.Xpm({type:o,selectors:[["app-admin-artwork-list"]],inputs:{artworks:"artworks",folderID:"folderID"},features:[t.TTD],decls:2,vars:2,consts:[["appFocusKeyList",""],["class","artwork","appFocusKeyListItem","",3,"keydown.enter",4,"ngFor","ngForOf","ngForTrackBy"],["appFocusKeyListItem","",1,"artwork",3,"keydown.enter"],[1,"artwork-img"],["alt","Artwork",3,"src","clickenter"],[1,"mode"],[1,"format"],[1,"dims"],[1,"size"],[1,"artwork-types"],["type","text",3,"ngModel","ngModelChange","endEditRequest"],["title","Delete Image",1,"delete-button",3,"clickenter"],["aria-hidden","true",1,"icon-trash"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0),t.YNc(1,jt,16,9,"div",1),t.qZA()),2&e&&(t.xp6(1),t.Q6J("ngForOf",n.nodes)("ngForTrackBy",n.trackByFn))},dependencies:[O.sg,y.X,Z.j,A.R,x.JJ,x.On,Tt,Lt.c],styles:["[_nghost-%COMP%]   .artwork[_ngcontent-%COMP%]{display:inline-block;padding-top:15px;padding-right:15px;font-size:.8em;text-align:center;width:200px}[_nghost-%COMP%]   .artwork[_ngcontent-%COMP%]   .artwork-img[_ngcontent-%COMP%]{position:relative;overflow:hidden}[_nghost-%COMP%]   .artwork[_ngcontent-%COMP%]   .artwork-img[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:auto}[_nghost-%COMP%]   .artwork[_ngcontent-%COMP%]   .artwork-img[_ngcontent-%COMP%]   .dims[_ngcontent-%COMP%], [_nghost-%COMP%]   .artwork[_ngcontent-%COMP%]   .artwork-img[_ngcontent-%COMP%]   .size[_ngcontent-%COMP%], [_nghost-%COMP%]   .artwork[_ngcontent-%COMP%]   .artwork-img[_ngcontent-%COMP%]   .format[_ngcontent-%COMP%], [_nghost-%COMP%]   .artwork[_ngcontent-%COMP%]   .artwork-img[_ngcontent-%COMP%]   .mode[_ngcontent-%COMP%]{position:absolute;padding:5px;background-color:var(--background-transparent);color:var(--on-background-highlight)}[_nghost-%COMP%]   .artwork[_ngcontent-%COMP%]   .artwork-img[_ngcontent-%COMP%]   .mode[_ngcontent-%COMP%]{top:0;left:0}[_nghost-%COMP%]   .artwork[_ngcontent-%COMP%]   .artwork-img[_ngcontent-%COMP%]   .format[_ngcontent-%COMP%]{bottom:0;left:0}[_nghost-%COMP%]   .artwork[_ngcontent-%COMP%]   .artwork-img[_ngcontent-%COMP%]   .dims[_ngcontent-%COMP%]{top:0;right:0}[_nghost-%COMP%]   .artwork[_ngcontent-%COMP%]   .artwork-img[_ngcontent-%COMP%]   .size[_ngcontent-%COMP%]{bottom:0;right:0}[_nghost-%COMP%]   .artwork-types[_ngcontent-%COMP%]{display:flex;flex-direction:row;width:100%;overflow:hidden}[_nghost-%COMP%]   .artwork-types[_ngcontent-%COMP%]   app-inline-edit[_ngcontent-%COMP%]{flex:1}[_nghost-%COMP%]   .artwork-types[_ngcontent-%COMP%]   .delete-button[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none}"]})),o})();function Wt(o,l){1&o&&t._UZ(0,"app-loading")}function $t(o,l){1&o&&t._UZ(0,"i",18)}function Vt(o,l){if(1&o){const e=t.EpF();t.TgZ(0,"input",19),t.NdJ("ngModelChange",function(i){t.CHM(e);const a=t.oxw().$implicit;return t.KtG(a.checked=i)}),t.qZA()}if(2&o){const e=t.oxw().$implicit;t.Q6J("checked",e.checked)("ngModel",e.checked)}}function Xt(o,l){if(1&o){const e=t.EpF();t.TgZ(0,"div",11),t.NdJ("keydown.enter",function(){const a=t.CHM(e).$implicit;return t.KtG(a.checked=!a.checked)}),t.TgZ(1,"div",12),t.NdJ("clickenter",function(){const a=t.CHM(e).$implicit;return t.KtG(a.checked=!a.checked)}),t._UZ(2,"img",13),t.qZA(),t.TgZ(3,"div",14)(4,"div",15)(5,"form")(6,"label"),t.YNc(7,$t,1,0,"i",16),t.YNc(8,Vt,1,2,"input",17),t._uU(9),t.qZA()()()()()}if(2&o){const e=l.$implicit;t.xp6(2),t.s9C("alt",e.name),t.Q6J("src",e.thumbnail,t.LSH),t.xp6(5),t.Q6J("ngIf",e.storing),t.xp6(1),t.Q6J("ngIf",!e.storing),t.xp6(1),t.hij(" ",e.name," ")}}function te(o,l){if(1&o&&(t.TgZ(0,"div"),t._UZ(1,"app-background-text-list",8),t.TgZ(2,"div",9),t.YNc(3,Xt,10,5,"div",10),t.qZA()()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("list",e.nodes),t.xp6(2),t.Q6J("ngForOf",e.nodes)("ngForTrackBy",e.trackByFn)}}function ee(o,l){if(1&o&&t._UZ(0,"app-admin-artwork-list",22),2&o){const e=t.oxw(2);t.Q6J("folderID",e.data.folder.id)("artworks",e.artworks)}}function ne(o,l){if(1&o&&(t.TgZ(0,"div",20)(1,"div",2),t._uU(2,"Current Images"),t.qZA(),t.YNc(3,ee,1,2,"app-admin-artwork-list",21),t.qZA()),2&o){const e=t.oxw();t.xp6(3),t.Q6J("ngIf",!e.isArtRefreshing)}}function oe(o,l){1&o&&(t.TgZ(0,"button",25),t._UZ(1,"i",18),t.qZA())}function ie(o,l){if(1&o){const e=t.EpF();t.TgZ(0,"button",26),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.use())}),t._uU(1,"Use Checked Artwork"),t.qZA()}}function re(o,l){if(1&o&&(t.TgZ(0,"div"),t.YNc(1,oe,2,0,"button",23),t.YNc(2,ie,2,0,"button",24),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.isWorking),t.xp6(1),t.Q6J("ngIf",!e.isWorking)}}let ae=(()=>{class o{constructor(e,n,i,a){(0,r.Z)(this,"jam",void 0),(0,r.Z)(this,"notify",void 0),(0,r.Z)(this,"folderService",void 0),(0,r.Z)(this,"http",void 0),(0,r.Z)(this,"data",void 0),(0,r.Z)(this,"artworks",void 0),(0,r.Z)(this,"nodes",void 0),(0,r.Z)(this,"isWorking",!1),(0,r.Z)(this,"isArtRefreshing",!1),(0,r.Z)(this,"searchSource",{name:"",url:""}),(0,r.Z)(this,"unsubscribe",new N.x),this.jam=e,this.notify=n,this.folderService=i,this.http=a}trackByFn(e,n){return n.image}ngOnDestroy(){this.unsubscribe.next(),this.unsubscribe.complete()}ngOnChanges(){this.search(),this.data&&this.data.folder&&(this.data.folder.artworks?this.artworks=this.data.folder.artworks:this.refreshArtworks())}refreshArtworks(){this.data&&(this.isArtRefreshing=!0,this.jam.artwork.search({folderIDs:[this.data.folder.id]}).then(e=>{this.isArtRefreshing=!1,this.artworks=e.items}).catch(e=>{this.isArtRefreshing=!1,console.error(e)}))}loadWikiDataID(e){var n=this;return(0,F.Z)(function*(){const i=yield n.jam.metadata.musicbrainzLookup({type:_.ej.artist,mbID:e});if(i?.data?.artist?.relations){const a=i.data.artist.relations.find(h=>"wikidata"===h.type);if(a?.url)return a.url.resource.split("/").pop()}})()}loadWikiCommonImage(e){var n=this;return(0,F.Z)(function*(){const i=yield n.loadWikiDataID(e);if(!i)return;const h=(yield n.jam.metadata.wikidataLookup({wikiDataID:i}))?.data?.entity?.claims;if(!h)return;const b=Object.keys(h);for(const D of b){let V=h[D];V=V.filter(kt=>"string"==typeof kt.mainsnak.datavalue.value&&(0,Zt.U_)(kt.mainsnak.datavalue.value.toLowerCase(),["jpg","jpeg","png"]));const Dt=V[0];if(Dt){const uo=`https://en.wikipedia.org/w/api.php?format=json&action=query&origin=*&titles=File:${Dt.mainsnak.datavalue.value}&prop=imageinfo&iiprop=extmetadata|url&iiextmetadatafilter=LicenseShortName`,Ot=yield n.http.get(uo).toPromise();if(Ot&&Ot.query.pages){const ut=Ot.query.pages[Object.keys(Ot.query.pages)[0]];if(ut&&ut.imageinfo[0])return{name:_.iJ.artist,thumbnail:ut.imageinfo[0].url,image:ut.imageinfo[0].url,licence:ut.imageinfo[0].extmetadata.LicenseShortName.value,checked:!0,storing:!1,types:[_.iJ.artist]}}}}})()}loadWikiCommon(e){this.loadWikiCommonImage(e).then(n=>{this.nodes=[],n&&(n.checked=!0,this.nodes.push(n))}).catch(n=>{this.nodes=[],this.notify.error(n)})}use(){const e=(this.nodes||[]).find(i=>i.checked&&!i.storing),n=this.data?.folder;e&&n?(this.isWorking=!0,e.storing=!0,this.jam.artwork.createByUrl({folderID:n.id,url:e.image,types:e.types}).then(i=>{this.folderService.waitForQueueResult("Creating Artwork",i,[n.id]).pipe((0,U.R)(this.unsubscribe)).subscribe(()=>{e.storing=!1,e.checked=!1}),this.use()}).catch(i=>{e.storing=!1,this.notify.error(i)})):this.isWorking=!1}ngOnInit(){this.folderService.foldersChange.pipe((0,U.R)(this.unsubscribe)).subscribe(e=>{e.id===this.data?.folder.id&&this.refreshArtworks()})}loadReleaseGroupAndRelease(e,n){this.jam.metadata.coverartarchiveLookup({type:_.xB.releaseGroup,mbID:n}).then(i=>{let a=this.coverArtResponseToNodes(i.data);this.jam.metadata.coverartarchiveLookup({type:_.xB.release,mbID:e}).then(h=>{a=a.concat(this.coverArtResponseToNodes(h.data)),this.display(a)}).catch(h=>{this.notify.error(h)})}).catch(i=>{this.notify.error(i)})}loadReleaseGroup(e){this.jam.metadata.coverartarchiveLookup({type:_.xB.releaseGroup,mbID:e}).then(n=>{const i=this.coverArtResponseToNodes(n.data);this.display(i)}).catch(n=>{this.notify.error(n)})}loadRelease(e){e&&this.jam.metadata.coverartarchiveLookup({type:_.xB.release,mbID:e}).then(n=>{const i=this.coverArtResponseToNodes(n.data);this.display(i),0===i.length&&this.data&&this.data.folder&&this.data.folder.tag&&this.data.folder.tag.mbReleaseGroupID&&(this.nodes=void 0,this.loadReleaseGroup(this.data.folder.tag.mbReleaseGroupID))}).catch(n=>{this.notify.error(n)})}coverArtResponseToNodes(e){return e.images?e.images.map(n=>(0===n.types.length&&n.types.push("Other"),{name:(n.types||[]).join("/").toLowerCase(),thumbnail:this.jam.metadata.coverartarchiveImageUrl({url:n.thumbnails.small}),licence:"",image:n.image,types:(n.types||[]).map(i=>i.toLowerCase()),checked:!1,storing:!1,stored:!1})):[]}search(){this.data&&this.data.folder&&this.data.folder.tag&&(this.data.folder.type===_.Sr.artist?this.data.folder.tag.mbArtistID&&(this.searchSource={name:"Wiki Commons",url:"https://commons.wikimedia.org"},this.loadWikiCommon(this.data.folder.tag.mbArtistID)):this.data&&this.data.folder&&this.data.folder.tag&&(this.searchSource={name:"Coverart Archive",url:"https://coverartarchive.org"},this.data.folder.tag.mbReleaseID&&this.data.folder.tag.mbReleaseGroupID?this.loadReleaseGroupAndRelease(this.data.folder.tag.mbReleaseID,this.data.folder.tag.mbReleaseGroupID):this.data.folder.tag.mbReleaseID?this.loadRelease(this.data.folder.tag.mbReleaseID):this.data.folder.tag.mbReleaseGroupID&&this.loadReleaseGroup(this.data.folder.tag.mbReleaseGroupID)))}display(e){this.nodes=e;let n=e.find(i=>1===i.types.length&&i.types[0]===_.iJ.front);n||(n=e.find(i=>i.types.includes(_.iJ.front))),n&&this.nodes.forEach(i=>i.checked=i===n)}}return(0,r.Z)(o,"\u0275fac",function(e){return new(e||o)(t.Y36(_.K4),t.Y36(m.c),t.Y36(m.Cr),t.Y36($.eN))}),(0,r.Z)(o,"\u0275cmp",t.Xpm({type:o,selectors:[["app-admin-folder-artwork-search"]],inputs:{data:"data"},features:[t.TTD],decls:11,vars:6,consts:[[1,"image-selector"],[1,"art-source"],[1,"section"],["rel","noopener","target","_blank",3,"href"],[4,"ngIf"],[1,"artwork"],["class","current",4,"ngIf"],[1,"buttons"],["name","Images",3,"list"],["appFocusKeyList","",1,"images"],["appFocusKeyListItem","",3,"keydown.enter",4,"ngFor","ngForOf","ngForTrackBy"],["appFocusKeyListItem","",3,"keydown.enter"],[1,"image",3,"clickenter"],[3,"alt","src"],[1,"footer"],[1,"footer-content"],["class","icon-spin icon-spinner",4,"ngIf"],["type","checkbox",3,"checked","ngModel","ngModelChange",4,"ngIf"],[1,"icon-spin","icon-spinner"],["type","checkbox",3,"checked","ngModel","ngModelChange"],[1,"current"],[3,"folderID","artworks",4,"ngIf"],[3,"folderID","artworks"],["class","button-on-control",4,"ngIf"],["class","button-on-control",3,"click",4,"ngIf"],[1,"button-on-control"],[1,"button-on-control",3,"click"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"a",3),t._uU(4),t.qZA()(),t.YNc(5,Wt,1,0,"app-loading",4),t.YNc(6,te,4,3,"div",4),t.qZA(),t.TgZ(7,"div",5),t.YNc(8,ne,4,1,"div",6),t.qZA()(),t.TgZ(9,"div",7),t.YNc(10,re,3,2,"div",4),t.qZA()),2&e&&(t.xp6(3),t.Q6J("href",n.searchSource.url,t.LSH),t.xp6(1),t.Oqu(n.searchSource.name),t.xp6(1),t.Q6J("ngIf",!n.nodes),t.xp6(1),t.Q6J("ngIf",n.nodes),t.xp6(2),t.Q6J("ngIf",n.data&&n.artworks),t.xp6(2),t.Q6J("ngIf",n.nodes&&n.nodes.length>0))},dependencies:[O.sg,O.O5,Q.$,Y.N,y.X,Z.j,A.R,x._Y,x.Wl,x.JJ,x.JL,x.On,x.F,It],styles:["[_nghost-%COMP%]   .image-selector[_ngcontent-%COMP%]{display:flex;flex-flow:column wrap;height:calc(100% - 40px)}[_nghost-%COMP%]   .image-buttons[_ngcontent-%COMP%]{height:40px}[_nghost-%COMP%]   .artwork[_ngcontent-%COMP%]{overflow-y:auto;width:50%;height:100%;padding-left:15px}[_nghost-%COMP%]   .art-source[_ngcontent-%COMP%]{padding-right:15px;overflow-y:auto;width:50%;height:100%;border-right:1px solid var(--background-border)}[_nghost-%COMP%]   .art-source[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block}[_nghost-%COMP%]   .art-source[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{display:inline-block;padding-top:15px;padding-right:15px;font-size:.8em}[_nghost-%COMP%]   .art-source[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:185px;min-width:185px;min-height:185px;height:auto}[_nghost-%COMP%]   .art-source[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]{font-size:.8em}[_nghost-%COMP%]   .section[_ngcontent-%COMP%]{border-bottom:1px solid var(--background-border);padding-bottom:5px}[_nghost-%COMP%]   .section[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--on-background-highlight)}[_nghost-%COMP%]   .section[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:var(--on-background)}"]})),o})(),Ft=(()=>{class o{constructor(){(0,r.Z)(this,"data",void 0)}dialogInit(e,n){this.data=n.data}}return(0,r.Z)(o,"\u0275fac",function(e){return new(e||o)}),(0,r.Z)(o,"\u0275cmp",t.Xpm({type:o,selectors:[["app-dialog-folder-artwork-search"]],decls:1,vars:1,consts:[[3,"data"]],template:function(e,n){1&e&&t._UZ(0,"app-admin-folder-artwork-search",0),2&e&&t.Q6J("data",n.data)},dependencies:[ae]})),o})();function se(o,l){1&o&&(t.TgZ(0,"div",1)(1,"div",2),t._UZ(2,"i",3),t.qZA()())}function ce(o,l){1&o&&(t.TgZ(0,"div",2),t._uU(1,"No Hints"),t.qZA())}function le(o,l){if(1&o&&(t.TgZ(0,"div",10),t._uU(1),t.qZA()),2&o){const e=l.$implicit;t.xp6(1),t.Oqu(e)}}function de(o,l){if(1&o&&(t.TgZ(0,"div",2),t._UZ(1,"i",8),t._uU(2),t.YNc(3,le,2,1,"div",9),t.qZA()),2&o){const e=l.$implicit,n=t.oxw(2);t.xp6(2),t.hij(" ",e.hint.name," "),t.xp6(1),t.Q6J("ngForOf",e.details)("ngForTrackBy",n.trackByDetailFn)}}function ge(o,l){1&o&&t._UZ(0,"i",3)}function pe(o,l){if(1&o&&(t.ynx(0),t._uU(1),t.BQk()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.name)}}function he(o,l){if(1&o){const e=t.EpF();t.TgZ(0,"button",11),t.NdJ("click",function(){const a=t.CHM(e).$implicit;return t.KtG(a.click())}),t.YNc(1,ge,1,0,"i",12),t.YNc(2,pe,2,1,"ng-container",13),t.qZA()}if(2&o){const e=l.$implicit;t.xp6(1),t.Q6J("ngIf",e.running),t.xp6(1),t.Q6J("ngIf",!e.running)}}function ue(o,l){if(1&o&&(t.TgZ(0,"div",1),t.YNc(1,ce,2,0,"div",4),t.YNc(2,de,4,3,"div",5),t.TgZ(3,"div",6),t.YNc(4,he,3,2,"button",7),t.qZA()()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",0===e.hints.length),t.xp6(1),t.Q6J("ngForOf",e.hints)("ngForTrackBy",e.trackByFn),t.xp6(2),t.Q6J("ngForOf",e.solutions)("ngForTrackBy",e.trackBySolutionFn)}}let _e=(()=>{class o{constructor(e,n,i,a,h,b){(0,r.Z)(this,"app",void 0),(0,r.Z)(this,"router",void 0),(0,r.Z)(this,"jam",void 0),(0,r.Z)(this,"notify",void 0),(0,r.Z)(this,"dialogOverlay",void 0),(0,r.Z)(this,"folderService",void 0),(0,r.Z)(this,"hints",void 0),(0,r.Z)(this,"solutions",[]),(0,r.Z)(this,"folderHealth",void 0),(0,r.Z)(this,"unsubscribe",new N.x),this.app=e,this.router=n,this.jam=i,this.notify=a,this.dialogOverlay=h,this.folderService=b}ngOnDestroy(){this.unsubscribe.next(),this.unsubscribe.complete()}trackBySolutionFn(e,n){return n.name}trackByDetailFn(e,n){return n}trackByFn(e,n){return n.hint.id}searchImages(e){this.dialogOverlay.open({title:"Search Artwork Images",childComponent:Ft,data:{folder:e},panelClass:"overlay-panel-large-buttons"})}ngOnChanges(){this.display(this.folderHealth)}static describeImageInvalidHint(e){if(!e.details||0===e.details.length)return[];const n=[e.details[0].reason];return e.details[0].expected&&n.push(`Expected: ${e.details[0].expected} Actual: ${e.details[0].actual}`),n}static describeAlbumTracksMissingHint(e){if(!e.details||0===e.details.length)return[];const n=[];return e.details[0].expected&&n.push(`Expected: ${e.details[0].expected} Actual: ${e.details[0].actual}`),n}describeImageQualityHint(e,n){if(this.addAlbumImageSearchSolution(n),!e.details||0===e.details.length)return[];const i=[e.details[0].reason];return i.push(`Expected: ${e.details[0].expected} Actual: ${e.details[0].actual}`),i}addArtistImageSearchSolution(e){var a,n=this;if(e.tag&&e.tag.mbArtistID){const i={name:"Search",click:(a=(0,F.Z)(function*(){n.searchImages(e)}),function(){return a.apply(this,arguments)})};this.solutions.push(i)}}addAlbumImageSearchSolution(e){var a,n=this;if(e.tag&&(e.tag.mbReleaseID||e.tag.mbReleaseGroupID)){const i={name:"Search",click:(a=(0,F.Z)(function*(){n.searchImages(e)}),function(){return a.apply(this,arguments)})};this.solutions.push(i)}}addRenameSolution(e,n){var h,i=this;if(!this.solutions.find(a=>"Rename"===a.name)){const a={name:"Rename",click:(h=(0,F.Z)(function*(){if(a.running)return;a.running=!0;const b=yield i.jam.folder.rename({id:e.id,name:n});i.folderService.waitForQueueResult("Renaming Folder",b,[e.id]).pipe((0,U.R)(i.unsubscribe)).subscribe(()=>{a.running=!1})}),function(){return h.apply(this,arguments)})};this.solutions.push(a)}}addEditTagSolution(e){var a,n=this;if(!this.solutions.find(i=>"Edit Tags"===i.name)){const i={name:"Edit Tags",click:(a=(0,F.Z)(function*(){n.router.navigate([`/admin/folder/${e.id}/tags`]).catch(h=>{console.error(h)})}),function(){return a.apply(this,arguments)})};this.solutions.push(i)}}describeMBIDMissingHint(e,n){return this.addEditTagSolution(n),[]}describeAlbumTagMissingHint(e,n){return this.addEditTagSolution(n),e.details?[`Expected: ${e.details.map(i=>i.expected).join(",")}`]:[]}describeNameNonConformHint(e,n){const i=e.details&&e.details.length>0?e.details[0].expected:"";return i?(this.addRenameSolution(n,i),[`Current: ${n.name}`,`Suggested Name: ${i}`]):[]}describeArtistImageMissingHint(e,n){return this.addArtistImageSearchSolution(n),[]}describeAlbumImageMissingHint(e,n){return this.addAlbumImageSearchSolution(n),[]}describeHint(e,n){switch(e.id){case _.Mx.albumMBIDExists:return this.describeMBIDMissingHint(e,n);case _.Mx.albumTagsExists:return this.describeAlbumTagMissingHint(e,n);case _.Mx.albumNameConform:case _.Mx.artistNameConform:return this.describeNameNonConformHint(e,n);case _.Mx.albumImageExists:return this.describeAlbumImageMissingHint(e,n);case _.Mx.albumTracksComplete:return o.describeAlbumTracksMissingHint(e);case _.Mx.artistImageExists:return this.describeArtistImageMissingHint(e,n);case _.Mx.artistImageValid:case _.Mx.albumImageValid:return o.describeImageInvalidHint(e);case _.Mx.albumImageQuality:return this.describeImageQualityHint(e,n)}return[]}display(e){this.hints=[],this.solutions=[],e?.health&&(this.hints=e.health.map(n=>({hint:n,details:this.describeHint(n,e.folder)})))}}return(0,r.Z)(o,"\u0275fac",function(e){return new(e||o)(t.Y36(m.zi),t.Y36(k.F0),t.Y36(_.K4),t.Y36(m.c),t.Y36(z.SL),t.Y36(m.Cr))}),(0,r.Z)(o,"\u0275cmp",t.Xpm({type:o,selectors:[["app-folder-health"]],inputs:{folderHealth:"folderHealth"},features:[t.TTD],decls:2,vars:2,consts:[["class","hints",4,"ngIf"],[1,"hints"],[1,"hint"],[1,"icon-spin","icon-spinner"],["class","hint",4,"ngIf"],["class","hint",4,"ngFor","ngForOf","ngForTrackBy"],[1,"solutions"],["class","button-on-background",3,"click",4,"ngFor","ngForOf","ngForTrackBy"],[1,"icon-warning"],["class","details",4,"ngFor","ngForOf","ngForTrackBy"],[1,"details"],[1,"button-on-background",3,"click"],["class","icon-spin icon-spinner",4,"ngIf"],[4,"ngIf"]],template:function(e,n){1&e&&(t.YNc(0,se,3,0,"div",0),t.YNc(1,ue,5,5,"div",0)),2&e&&(t.Q6J("ngIf",!n.hints),t.xp6(1),t.Q6J("ngIf",n.hints))},dependencies:[O.sg,O.O5],styles:["[_nghost-%COMP%]{height:100%;width:100%;overflow-y:auto;overflow-x:auto;display:block}[_nghost-%COMP%]   .icon-warning[_ngcontent-%COMP%]{color:var(--accent)}[_nghost-%COMP%]   .label[_ngcontent-%COMP%]{padding-left:28px;font-size:.8em;text-transform:uppercase;min-width:30%;display:inline-block}[_nghost-%COMP%]   .hints[_ngcontent-%COMP%]{padding-top:10px}[_nghost-%COMP%]   .hint[_ngcontent-%COMP%]{padding-bottom:10px}"]})),o})();function me(o,l){if(1&o&&(t.TgZ(0,"option",11),t._uU(1),t.qZA()),2&o){const e=l.$implicit;t.Q6J("value",e),t.xp6(1),t.Oqu(e)}}function fe(o,l){if(1&o){const e=t.EpF();t.TgZ(0,"select",9),t.NdJ("ngModelChange",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.filter=i)})("ngModelChange",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.onFilterChange())}),t.YNc(1,me,2,2,"option",10),t.qZA()}if(2&o){const e=t.oxw();t.Q6J("ngModel",e.filter),t.xp6(1),t.Q6J("ngForOf",e.modes)("ngForTrackBy",e.trackByModeFn)}}function Ce(o,l){1&o&&t._UZ(0,"app-loading")}function xe(o,l){if(1&o&&(t.ynx(0),t.TgZ(1,"div",20),t._uU(2,"Album"),t.qZA(),t.TgZ(3,"div",21),t._uU(4),t.qZA(),t.TgZ(5,"div",22),t._uU(6),t.qZA(),t.TgZ(7,"div",23),t._uU(8),t.qZA(),t.BQk()),2&o){const e=t.oxw().$implicit;t.xp6(4),t.Oqu(null==e.folder.tag?null:e.folder.tag.album),t.xp6(2),t.Oqu(null==e.folder.tag?null:e.folder.tag.artist),t.xp6(2),t.Oqu(null==e.folder.tag?null:e.folder.tag.year)}}function Me(o,l){if(1&o&&(t.ynx(0),t.TgZ(1,"div",20),t._uU(2,"Album"),t.qZA(),t.TgZ(3,"div",21),t._uU(4),t.qZA(),t.TgZ(5,"div",22),t._uU(6),t.qZA(),t.TgZ(7,"div",23),t._uU(8),t.qZA(),t.BQk()),2&o){const e=t.oxw().$implicit;t.xp6(4),t.Oqu(null==e.folder.tag?null:e.folder.tag.album),t.xp6(2),t.Oqu(null==e.folder.tag?null:e.folder.tag.artist),t.xp6(2),t.Oqu(null==e.folder.tag?null:e.folder.tag.year)}}function ve(o,l){if(1&o&&(t.ynx(0),t.TgZ(1,"div",20),t._uU(2,"Artist"),t.qZA(),t.TgZ(3,"div",21),t._uU(4),t.qZA(),t.BQk()),2&o){const e=t.oxw().$implicit;t.xp6(4),t.Oqu(null==e.folder.tag?null:e.folder.tag.artist)}}function Oe(o,l){if(1&o&&(t.ynx(0),t.TgZ(1,"div",20),t._uU(2,"Collection"),t.qZA(),t.TgZ(3,"div",21),t._uU(4),t.qZA(),t.BQk()),2&o){const e=t.oxw().$implicit;t.xp6(4),t.Oqu(e.folder.name)}}function be(o,l){if(1&o&&(t.ynx(0),t.TgZ(1,"div",21),t._uU(2),t.qZA(),t.BQk()),2&o){const e=t.oxw().$implicit;t.xp6(2),t.Oqu(e.folder.name)}}const ye=function(o){return["/admin/folder",o,"overview"]};function we(o,l){if(1&o&&(t.TgZ(0,"div",12)(1,"div",13)(2,"a",14),t.ynx(3,15),t.YNc(4,xe,9,3,"ng-container",16),t.YNc(5,Me,9,3,"ng-container",16),t.YNc(6,ve,5,1,"ng-container",16),t.YNc(7,Oe,5,1,"ng-container",16),t.YNc(8,be,3,1,"ng-container",17),t.BQk(),t.qZA()(),t.TgZ(9,"div",18),t._UZ(10,"app-folder-health",19),t.qZA()()),2&o){const e=l.$implicit;t.xp6(2),t.Q6J("routerLink",t.VKq(7,ye,e.folder.id)),t.xp6(1),t.Q6J("ngSwitch",e.folder.type),t.xp6(1),t.Q6J("ngSwitchCase","multialbum"),t.xp6(1),t.Q6J("ngSwitchCase","album"),t.xp6(1),t.Q6J("ngSwitchCase","artist"),t.xp6(1),t.Q6J("ngSwitchCase","collection"),t.xp6(3),t.Q6J("folderHealth",e)}}let Ze=(()=>{class o extends P{constructor(e,n,i,a,h){super(e),(0,r.Z)(this,"app",void 0),(0,r.Z)(this,"jam",void 0),(0,r.Z)(this,"notify",void 0),(0,r.Z)(this,"folderService",void 0),(0,r.Z)(this,"all",void 0),(0,r.Z)(this,"hints",void 0),(0,r.Z)(this,"filter",void 0),(0,r.Z)(this,"modes",[]),(0,r.Z)(this,"public",void 0),this.app=n,this.jam=i,this.notify=a,this.folderService=h}trackByHealthFn(e,n){return n.folder.id}trackByModeFn(e,n){return n}onFilterChange(){this.reDisplay()}ngOnInit(){super.ngOnInit(),this.folderService.foldersChange.pipe((0,U.R)(this.unsubscribe)).subscribe(e=>{if(e.id===this.id)this.refresh();else if(this.all){const n=this.all.find(i=>i.folder.id===e.id);n&&this.jam.folder.health({ids:[e.id],folderIncTag:!0}).then(i=>{if(this.all){const a=i.find(h=>h.folder.id===n.folder.id);a?this.all[this.all.indexOf(n)]=a:this.all=this.all.filter(h=>h.folder.id!==n.folder.id)}this.reDisplay()}).catch(i=>{this.notify.error(i)})}})}ngOnDestroy(){super.ngOnDestroy()}refresh(){this.hints=void 0,this.jam.folder.health({childOfID:this.id,folderIncTag:!0}).then(e=>{this.display(e)}).catch(e=>{this.notify.error(e)})}reDisplay(){this.hints=this.filter&&this.all?this.all.filter(e=>e.health&&e.health.find(n=>n.name===this.filter)):this.all}display(e){this.all=e,this.modes=[];for(const n of e)if(n.health)for(const i of n.health)this.modes.includes(i.name)||this.modes.push(i.name);this.reDisplay()}}return(0,r.Z)(o,"\u0275fac",function(e){return new(e||o)(t.Y36(k.gz),t.Y36(m.zi),t.Y36(_.K4),t.Y36(m.c),t.Y36(m.Cr))}),(0,r.Z)(o,"\u0275cmp",t.Xpm({type:o,selectors:[["app-admin-folder-health"]],features:[t.qOj],decls:9,vars:5,consts:[[1,"health"],[1,"actions"],["title","Refresh List",1,"button-on-control",3,"click"],[1,"icon-reload"],["placeholder","Type of Hints",3,"ngModel","ngModelChange",4,"ngIf"],[1,"health-content"],[4,"ngIf"],["name","Folder Health Issues",3,"list"],["class","folder",4,"ngFor","ngForOf","ngForTrackBy"],["placeholder","Type of Hints",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf","ngForTrackBy"],[3,"value"],[1,"folder"],[1,"meta"],[3,"routerLink"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"folder-health"],[3,"folderHealth"],[1,"type"],[1,"name"],[1,"artist"],[1,"year"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"button",2),t.NdJ("click",function(){return n.refresh()}),t._UZ(3,"i",3),t.qZA(),t.YNc(4,fe,2,3,"select",4),t.qZA(),t.TgZ(5,"div",5),t.YNc(6,Ce,1,0,"app-loading",6),t._UZ(7,"app-background-text-list",7),t.YNc(8,we,11,9,"div",8),t.qZA()()),2&e&&(t.xp6(4),t.Q6J("ngIf",n.modes.length>0),t.xp6(2),t.Q6J("ngIf",!n.hints),t.xp6(1),t.Q6J("list",n.hints),t.xp6(1),t.Q6J("ngForOf",n.hints)("ngForTrackBy",n.trackByHealthFn))},dependencies:[O.sg,O.O5,O.RF,O.n9,O.ED,Q.$,Y.N,x.YN,x.Kr,x.EJ,x.JJ,x.On,k.rH,_e],styles:["[_nghost-%COMP%]{height:100%;width:100%}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]{height:100%;width:100%;display:flex;flex-direction:column}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{padding:10px 15px 0;border-bottom-color:var(--background-border);border-bottom-width:1px;border-bottom-style:solid}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{margin-right:5px;margin-bottom:10px}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%] > label[_ngcontent-%COMP%]{text-transform:uppercase;letter-spacing:1px;font-size:11px;margin-left:5px;margin-right:5px}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .health-content[_ngcontent-%COMP%]{padding:15px;overflow-y:auto;overflow-x:auto}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]{border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:var(--background-border);padding:15px;display:flex;flex-flow:row wrap;flex-flow:row nowrap}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]{width:30%;padding-right:15px;margin-left:15px;display:flex;flex-flow:column wrap;position:relative}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:100%;text-overflow:ellipsis;overflow:hidden}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]   .type[_ngcontent-%COMP%]{text-transform:uppercase}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]   .type[_ngcontent-%COMP%], [_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]   .year[_ngcontent-%COMP%], [_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]   .state[_ngcontent-%COMP%]{letter-spacing:1px;font-size:.8em}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-size:24px;font-weight:100;color:var(--on-background-highlight)}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--on-background-highlight)}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:var(--on-background)}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{font-size:14px;line-height:1.2em}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{margin-top:auto}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-bottom:5px;margin-right:5px;height:27px;font-weight:500;padding:1px 15px 0}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{transform:scale(1.3);transform-origin:center}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none;border:1px solid transparent;padding:4px 9px 7px;border-radius:50%;display:none;position:absolute;right:1px;bottom:0}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{background-color:var(--control-hover);color:var(--on-background-hover)}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]:hover   .actions[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], [_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]:hover   app-fav-icon[_ngcontent-%COMP%]{display:inline}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .folder-health[_ngcontent-%COMP%]{display:flex;width:70%}@media (max-width: 400px){[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]{padding-left:0;padding-right:0}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]{font-size:.8em}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-size:16px}}"]})),o})();var Ae=v(7111);function Pe(o,l){if(1&o&&(t.TgZ(0,"div")(1,"div"),t._uU(2),t.ALo(3,"stringToggle"),t.qZA(),t._UZ(4,"app-loading"),t.qZA()),2&o){const e=t.oxw();t.xp6(2),t.Oqu(t.Dn7(3,1,e.isUploading,"Uploading","Creating Artwork"))}}function ke(o,l){if(1&o){const e=t.EpF();t.TgZ(0,"div",2),t.NdJ("drop",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.onDropFile(i))})("dragover",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.onDragOverFile(i))}),t.TgZ(1,"form")(2,"input",3),t.NdJ("change",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.selectFile(i))}),t.qZA()()()}}let Te=(()=>{class o{constructor(e,n,i){(0,r.Z)(this,"jam",void 0),(0,r.Z)(this,"notify",void 0),(0,r.Z)(this,"folderService",void 0),(0,r.Z)(this,"folder",void 0),(0,r.Z)(this,"reference",void 0),(0,r.Z)(this,"isIdle",!0),(0,r.Z)(this,"isUploading",!1),(0,r.Z)(this,"unsubscribe",new N.x),this.jam=e,this.notify=n,this.folderService=i}ngOnDestroy(){this.unsubscribe.next(),this.unsubscribe.complete()}dialogInit(e,n){this.reference=e,this.folder=n.data?.folder}waitForCreationEnd(e){if(!this.folder)return;const n=this.folder.id;this.folderService.waitForQueueResult("Creating Artwork",e,[]).pipe((0,U.R)(this.unsubscribe)).subscribe(()=>{this.isIdle=!0,this.folderService.notifyFolderChange(n,m.dw.fsnRefresh),e.error||(this.notify.success("Upload done"),this.reference&&this.reference.close())})}onDropFile(e){e.preventDefault(),this.uploadFile(e.dataTransfer?.files)}onDragOverFile(e){e.stopPropagation(),e.preventDefault()}selectFile(e){this.uploadFile(e.target.files)}uploadFile(e){if(!e||0===e.length||!this.folder)return;const n=e[0];this.isIdle=!1,this.isUploading=!0,this.jam.artwork.createByUpload({folderID:this.folder.id,types:[]},n).pipe((0,U.R)(this.unsubscribe)).subscribe(i=>{if(i.type!==$.dt.UploadProgress&&i instanceof $.Zn){const a=i.body;a&&this.waitForCreationEnd(a)}},i=>{this.isUploading=!1,this.isIdle=!0,this.notify.error(i)},()=>{this.isUploading=!1})}}return(0,r.Z)(o,"\u0275fac",function(e){return new(e||o)(t.Y36(_.K4),t.Y36(m.c),t.Y36(m.Cr))}),(0,r.Z)(o,"\u0275cmp",t.Xpm({type:o,selectors:[["app-dialog-upload-image"]],decls:2,vars:2,consts:[[4,"ngIf"],["class","drop-zone",3,"drop","dragover",4,"ngIf"],[1,"drop-zone",3,"drop","dragover"],["type","file","placeholder","Upload image","accept",".png,.jpeg,.jpg",3,"change"]],template:function(e,n){1&e&&(t.YNc(0,Pe,5,5,"div",0),t.YNc(1,ke,3,0,"div",1)),2&e&&(t.Q6J("ngIf",!n.isIdle),t.xp6(1),t.Q6J("ngIf",n.isIdle))},dependencies:[O.O5,Y.N,x._Y,x.JL,x.F,T.C],styles:["[_nghost-%COMP%]   .drop-zone[_ngcontent-%COMP%]{margin:10px 20px;border-width:2px;border-style:dotted;border-color:var(--secondary);height:80%}[_nghost-%COMP%]   input[type=text][_ngcontent-%COMP%]{width:100%}"]})),o})();var Ie=v(9743);function Fe(o,l){1&o&&t._UZ(0,"app-loading")}function Se(o,l){if(1&o&&t._UZ(0,"app-info-note",21),2&o){const e=t.oxw(2);t.Q6J("info",e.folder.info)}}function Ue(o,l){if(1&o&&(t.ynx(0),t._uU(1),t.BQk()),2&o){const e=t.oxw(2);t.xp6(1),t.hij(" / ",null==e.folder.tag?null:e.folder.tag.albumType,"")}}function Re(o,l){if(1&o&&(t.TgZ(0,"div")(1,"div",13),t._uU(2,"Artist"),t.qZA(),t.TgZ(3,"div"),t._uU(4),t.qZA()()),2&o){const e=t.oxw(2);t.xp6(4),t.Oqu(null==e.folder.tag?null:e.folder.tag.artist)}}function He(o,l){if(1&o&&(t.TgZ(0,"div")(1,"div",13),t._uU(2,"Album"),t.qZA(),t.TgZ(3,"div"),t._uU(4),t.qZA()()),2&o){const e=t.oxw(2);t.xp6(4),t.Oqu(null==e.folder.tag?null:e.folder.tag.album)}}function qe(o,l){if(1&o&&(t.TgZ(0,"div")(1,"div",13),t._uU(2,"Year"),t.qZA(),t.TgZ(3,"div"),t._uU(4),t.qZA()()),2&o){const e=t.oxw(2);t.xp6(4),t.hij(" ",null==e.folder.tag?null:e.folder.tag.year,"")}}function Je(o,l){if(1&o&&(t.TgZ(0,"div")(1,"div",13),t._uU(2,"Genres"),t.qZA(),t.TgZ(3,"div"),t._uU(4),t.qZA()()),2&o){const e=t.oxw(2);t.xp6(4),t.hij(" ",null==e.folder.tag?null:e.folder.tag.genres,"")}}function De(o,l){if(1&o&&(t.TgZ(0,"div")(1,"div",13),t._uU(2,"MB Release Id"),t.qZA(),t.TgZ(3,"div")(4,"a",22),t._uU(5),t.qZA()()()),2&o){const e=t.oxw(2);t.xp6(4),t.MGl("href","https://musicbrainz.org/release/",null==e.folder.tag?null:e.folder.tag.mbReleaseID,"",t.LSH),t.xp6(1),t.Oqu(null==e.folder.tag?null:e.folder.tag.mbReleaseID)}}function Qe(o,l){if(1&o&&(t.TgZ(0,"div")(1,"div",13),t._uU(2,"MB Artist Id"),t.qZA(),t.TgZ(3,"div")(4,"a",22),t._uU(5),t.qZA()()()),2&o){const e=t.oxw(2);t.xp6(4),t.MGl("href","https://musicbrainz.org/artist/",null==e.folder.tag?null:e.folder.tag.mbArtistID,"",t.LSH),t.xp6(1),t.Oqu(null==e.folder.tag?null:e.folder.tag.mbArtistID)}}const Ne=function(o){return["/admin/folder",o]};function ze(o,l){if(1&o&&(t.TgZ(0,"div")(1,"div",13),t._uU(2,"Parent Folder Id"),t.qZA(),t.TgZ(3,"div")(4,"a",23),t._uU(5),t.qZA()()()),2&o){const e=t.oxw(2);t.xp6(4),t.Q6J("routerLink",t.VKq(2,Ne,e.folder.parentID)),t.xp6(1),t.Oqu(e.folder.parentID)}}function Ee(o,l){if(1&o){const e=t.EpF();t.TgZ(0,"button",24),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.searchImages())}),t._UZ(1,"i",25),t._uU(2," Search Artwork "),t.qZA()}}function Ye(o,l){if(1&o){const e=t.EpF();t.TgZ(0,"button",26),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.searchImages())}),t._UZ(1,"i",25),t._uU(2," Search Art"),t.qZA()}}function Be(o,l){if(1&o&&(t.TgZ(0,"div",27),t._UZ(1,"app-admin-artwork-list",28),t.qZA()),2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("folderID",e.folder.id)("artworks",e.folder.artworks)}}function Le(o,l){if(1&o){const e=t.EpF();t.TgZ(0,"div",2)(1,"div",3)(2,"button",4),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.refresh())}),t._UZ(3,"i",5),t.qZA(),t.TgZ(4,"button",6),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.moveFolder())}),t._UZ(5,"i",7),t.qZA(),t.TgZ(6,"button",8),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.removeFolder())}),t._UZ(7,"i",9),t.qZA()(),t.TgZ(8,"div",10),t.YNc(9,Se,1,1,"app-info-note",11),t.TgZ(10,"div",12)(11,"div")(12,"div")(13,"div",13),t._uU(14,"Name"),t.qZA(),t.TgZ(15,"div")(16,"app-inline-edit",14),t.NdJ("ngModelChange",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.name=i)})("endEditRequest",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.editFolderName())}),t.qZA()()(),t.TgZ(17,"div")(18,"div",13),t._uU(19,"Type"),t.qZA(),t.TgZ(20,"div"),t._uU(21),t.YNc(22,Ue,2,1,"ng-container",0),t.qZA()(),t.TgZ(23,"div")(24,"div",13),t._uU(25,"Track Count"),t.qZA(),t.TgZ(26,"div"),t._uU(27),t.qZA()(),t.TgZ(28,"div")(29,"div",13),t._uU(30,"Folder Count"),t.qZA(),t.TgZ(31,"div"),t._uU(32),t.qZA()(),t.YNc(33,Re,5,1,"div",0),t.YNc(34,He,5,1,"div",0),t.qZA(),t.TgZ(35,"div"),t.YNc(36,qe,5,1,"div",0),t.YNc(37,Je,5,1,"div",0),t.YNc(38,De,6,2,"div",0),t.YNc(39,Qe,6,2,"div",0),t.YNc(40,ze,6,4,"div",0),t.qZA()(),t.TgZ(41,"div",15)(42,"div",3)(43,"button",16),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.uploadImage())}),t._UZ(44,"i",17),t._uU(45," Upload Artwork"),t.qZA(),t.YNc(46,Ee,3,0,"button",18),t.YNc(47,Ye,3,0,"button",19),t.qZA(),t.YNc(48,Be,2,2,"div",20),t.qZA()()()}if(2&o){const e=t.oxw();t.xp6(9),t.Q6J("ngIf",null==e.folder.info?null:e.folder.info.description),t.xp6(7),t.Q6J("ngModel",e.name),t.xp6(5),t.hij("",e.folder.type," "),t.xp6(1),t.Q6J("ngIf",e.isAlbum),t.xp6(5),t.Oqu(e.folder.trackCount),t.xp6(5),t.Oqu(e.folder.folderCount),t.xp6(1),t.Q6J("ngIf",null==e.folder.tag?null:e.folder.tag.artist),t.xp6(1),t.Q6J("ngIf",null==e.folder.tag?null:e.folder.tag.album),t.xp6(2),t.Q6J("ngIf",null==e.folder.tag?null:e.folder.tag.year),t.xp6(1),t.Q6J("ngIf",null==e.folder.tag||null==e.folder.tag.genres?null:e.folder.tag.genres.length),t.xp6(1),t.Q6J("ngIf",null==e.folder.tag?null:e.folder.tag.mbReleaseID),t.xp6(1),t.Q6J("ngIf",null==e.folder.tag?null:e.folder.tag.mbArtistID),t.xp6(1),t.Q6J("ngIf",e.folder.parentID),t.xp6(6),t.Q6J("ngIf",e.isAlbum&&e.folder.tag&&(e.folder.tag.mbReleaseID||e.folder.tag.mbReleaseGroupID)),t.xp6(1),t.Q6J("ngIf",e.isArtist&&e.folder.tag&&e.folder.tag.mbArtistID),t.xp6(1),t.Q6J("ngIf",e.folder.artworks&&e.folder.artworks.length>0)}}let je=(()=>{class o extends P{constructor(e,n,i,a,h,b,D,V){super(e),(0,r.Z)(this,"app",void 0),(0,r.Z)(this,"jam",void 0),(0,r.Z)(this,"notify",void 0),(0,r.Z)(this,"dialogsService",void 0),(0,r.Z)(this,"dialogOverlay",void 0),(0,r.Z)(this,"folderService",void 0),(0,r.Z)(this,"router",void 0),(0,r.Z)(this,"name",""),(0,r.Z)(this,"folder",void 0),(0,r.Z)(this,"isAlbum",!1),(0,r.Z)(this,"isArtist",!1),this.app=n,this.jam=i,this.notify=a,this.dialogsService=h,this.dialogOverlay=b,this.folderService=D,this.router=V}ngOnInit(){super.ngOnInit(),this.folderService.foldersChange.pipe((0,U.R)(this.unsubscribe)).subscribe(e=>{e.id===this.id&&this.refresh()})}ngOnDestroy(){super.ngOnDestroy()}editFolderName(){if(!this.folder)return;const e=(this.name||"").trim();if(0===e.length||e===this.folder.name)return void(this.name=this.folder.name);const n=this.folder.id;this.jam.folder.rename({id:n,name:e}).then(i=>{this.folderService.waitForQueueResult("Renaming Folder",i,[n])}).catch(i=>{this.notify.error(i)})}refresh(){this.id&&this.jam.folder.id({id:this.id,folderIncTag:!0,folderIncParents:!0,folderIncArtworks:!0,folderIncChildFolderCount:!0,folderIncTrackCount:!0}).then(e=>{this.display(e)}).catch(e=>{404===e.code?this.router.navigate(["/admin/folder/"]).catch(n=>{console.error(n)}):this.notify.error(e)})}uploadImage(){this.dialogOverlay.open({title:"Upload Folder Images",childComponent:Te,data:{folder:this.folder},panelClass:"overlay-panel-large-buttons"})}searchImages(){this.dialogOverlay.open({title:"Search Artwork Images",childComponent:Ft,data:{folder:this.folder},panelClass:"overlay-panel-large-buttons"})}removeFolder(){const e=this.folder;e&&this.dialogsService.confirm("Remove Folder?",`Sure to remove Folder "${e.name}"?`,()=>{this.jam.folder.remove({id:e.id}).then(n=>{e.parentID&&this.router.navigate([`/admin/folder/${e.parentID}/overview`]).catch(i=>{console.error(i)}),this.folderService.waitForQueueResult("Removing Folder",n,[e.id],e.parentID?[e.parentID]:[])}).catch(n=>{this.notify.error(n)})})}moveFolder(){var e=this;const n=this.folder;if(!n)return;const i={selectID:n.id,disableIDs:[n.id]};var a;this.dialogOverlay.open({title:"Move Folder to",childComponent:B,data:i,panelClass:"overlay-panel-large-buttons",onOkBtn:(a=(0,F.Z)(function*(){const h=i.folder;if(h)try{e.jam.folder.move({ids:[n.id],newParentID:h.id}).then(b=>{e.folderService.waitForQueueResult("Moving Folder",b,[n.id],(n.parentID?[n.parentID]:[]).concat([h.id]))}).catch(b=>{e.notify.error(b)})}catch(b){return e.notify.error(b),Promise.reject(b)}}),function(){return a.apply(this,arguments)}),onCancelBtn:function(){var a=(0,F.Z)(function*(){return Promise.resolve()});return function(){return a.apply(this,arguments)}}()})}display(e){this.name="",this.isAlbum=!1,this.isArtist=!1,this.folder=e,e&&(this.name=e.name,this.isAlbum=Ae.Dz.includes(e.type),this.isArtist=e.type===_.Sr.artist)}}return(0,r.Z)(o,"\u0275fac",function(e){return new(e||o)(t.Y36(k.gz),t.Y36(m.zi),t.Y36(_.K4),t.Y36(m.c),t.Y36(q.Hr),t.Y36(z.SL),t.Y36(m.Cr),t.Y36(k.F0))}),(0,r.Z)(o,"\u0275cmp",t.Xpm({type:o,selectors:[["app-admin-folder"]],features:[t.qOj],decls:2,vars:2,consts:[[4,"ngIf"],["class","folder",4,"ngIf"],[1,"folder"],[1,"actions"],["title","Refresh",1,"button-on-control",3,"click"],[1,"icon-reload"],["title","Move Folder\u2026",1,"button-on-control",3,"click"],[1,"icon-right-bold"],["title","Remove Folder\u2026",1,"button-on-control",3,"click"],[1,"icon-trash"],[1,"content"],[3,"info",4,"ngIf"],[1,"properties"],[1,"label"],["type","text",3,"ngModel","ngModelChange","endEditRequest"],[1,"artworks"],[1,"button-on-control",3,"click"],[1,"icon-upload-cloud"],["class","button-on-control","title","Album Images",3,"click",4,"ngIf"],["class","button-on-control","title","Artist Images",3,"click",4,"ngIf"],["class","artworks-content",4,"ngIf"],[3,"info"],["target","_blank","rel","noopener",3,"href"],[3,"routerLink"],["title","Album Images",1,"button-on-control",3,"click"],[1,"icon-picture"],["title","Artist Images",1,"button-on-control",3,"click"],[1,"artworks-content"],[3,"folderID","artworks"]],template:function(e,n){1&e&&(t.YNc(0,Fe,1,0,"app-loading",0),t.YNc(1,Le,49,16,"div",1)),2&e&&(t.Q6J("ngIf",!n.folder),t.xp6(1),t.Q6J("ngIf",n.folder))},dependencies:[O.O5,Ie.a,Y.N,x.JJ,x.On,k.rH,It,Tt],styles:["[_nghost-%COMP%]{height:100%;width:100%;overflow:hidden;display:block}[_nghost-%COMP%]   .actions[_ngcontent-%COMP%]{padding:10px 15px 0;border-bottom-color:var(--background-border);border-bottom-width:1px;border-bottom-style:solid}[_nghost-%COMP%]   .actions[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{margin-right:5px;margin-bottom:10px}[_nghost-%COMP%]   .actions[_ngcontent-%COMP%] > label[_ngcontent-%COMP%]{text-transform:uppercase;letter-spacing:1px;font-size:11px;margin-left:5px;margin-right:5px}[_nghost-%COMP%]   .folder[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;width:100%}[_nghost-%COMP%]   .folder[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{overflow-y:auto;display:flex;flex-direction:column}[_nghost-%COMP%]   .folder[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .properties[_ngcontent-%COMP%]{width:100%;display:flex;flex-wrap:wrap;flex-direction:row;padding:15px}[_nghost-%COMP%]   .folder[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .properties[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{flex:0 0 50%}@media (max-width: 522px){[_nghost-%COMP%]   .folder[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .properties[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{flex:0 0 100%}}[_nghost-%COMP%]   .folder[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .properties[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{padding-top:5px;padding-bottom:5px}[_nghost-%COMP%]   .folder[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .properties[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{color:var(--on-background-highlight)}[_nghost-%COMP%]   .folder[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .properties[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--on-background-highlight)}[_nghost-%COMP%]   .folder[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .properties[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:var(--on-background)}[_nghost-%COMP%]   .folder[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .properties[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{color:var(--on-background);font-size:.7em;text-transform:uppercase;padding-bottom:2px}[_nghost-%COMP%]   .folder[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .artworks[_ngcontent-%COMP%]{border-top:1px solid var(--background-border)}[_nghost-%COMP%]   .folder[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .artworks[_ngcontent-%COMP%]   .artworks-content[_ngcontent-%COMP%]{padding:0 15px 15px}"]})),o})();function Ke(o,l){1&o&&(t.TgZ(0,"div",2)(1,"div",3),t._UZ(2,"i",4),t.qZA()())}function Ge(o,l){1&o&&(t.TgZ(0,"div",3),t._uU(1,"No Hints"),t.qZA())}function We(o,l){if(1&o&&(t.TgZ(0,"div",3),t._UZ(1,"i",9),t._uU(2),t.TgZ(3,"div",10),t._uU(4),t.qZA()()),2&o){const e=l.$implicit;t.xp6(2),t.hij(" ",e.hint.name," "),t.xp6(2),t.Oqu(e.description)}}function $e(o,l){1&o&&t._UZ(0,"i",4)}function Ve(o,l){if(1&o&&(t.ynx(0),t._uU(1),t.BQk()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.name)}}function Xe(o,l){if(1&o){const e=t.EpF();t.TgZ(0,"button",11),t.NdJ("click",function(){const a=t.CHM(e).$implicit;return t.KtG(a.click())}),t.YNc(1,$e,1,0,"i",12),t.YNc(2,Ve,2,1,"ng-container",0),t.qZA()}if(2&o){const e=l.$implicit;t.xp6(1),t.Q6J("ngIf",e.running),t.xp6(1),t.Q6J("ngIf",!e.running)}}function tn(o,l){if(1&o&&(t.TgZ(0,"div",2),t.YNc(1,Ge,2,0,"div",5),t.YNc(2,We,5,2,"div",6),t.TgZ(3,"div",7),t.YNc(4,Xe,3,2,"button",8),t.qZA()()),2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",0===e.hints.length),t.xp6(1),t.Q6J("ngForOf",e.hints)("ngForTrackBy",e.trackByHintFn),t.xp6(2),t.Q6J("ngForOf",e.solutions)("ngForTrackBy",e.trackBySolutionFn)}}function en(o,l){if(1&o&&(t.ynx(0),t.YNc(1,Ke,3,0,"div",1),t.YNc(2,tn,5,5,"div",1),t.BQk()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",!(e.trackHealth.health&&e.hints)),t.xp6(1),t.Q6J("ngIf",e.trackHealth.health&&e.hints)}}let At=(()=>{class o{constructor(e,n,i,a,h){(0,r.Z)(this,"app",void 0),(0,r.Z)(this,"jam",void 0),(0,r.Z)(this,"notify",void 0),(0,r.Z)(this,"folderService",void 0),(0,r.Z)(this,"router",void 0),(0,r.Z)(this,"hints",void 0),(0,r.Z)(this,"solutions",[]),(0,r.Z)(this,"trackHealth",void 0),(0,r.Z)(this,"resolvedEvent",new t.vpe),(0,r.Z)(this,"unsubscribe",new N.x),this.app=e,this.jam=n,this.notify=i,this.folderService=a,this.router=h}trackByHintFn(e,n){return n.hint.id}trackBySolutionFn(e,n){return n.name}ngOnChanges(){this.display(this.trackHealth)}ngOnDestroy(){this.unsubscribe.next(),this.unsubscribe.complete()}ngOnInit(){this.folderService.tracksChange.pipe((0,U.R)(this.unsubscribe)).subscribe(e=>{const n=this.trackHealth;n&&n.track.id===e.id&&(n.health=[],this.jam.track.health({ids:[n.track.id],healthMedia:!0}).then(i=>{const a=i.find(h=>h.track.id===n.track.id);a&&a.health?(n.track=a.track,n.health=a.health):n.health=[],0===n.health.length&&this.resolvedEvent.emit(),this.display(n)}).catch(i=>{this.notify.error(i)}))})}fixAll(){for(const e of this.solutions)e.fixable&&!e.running&&e.click&&e.click()}display(e){this.hints=[],this.solutions=[],e?.health&&(this.hints=e.health.map(n=>({hint:n,description:this.describeHint(n,e.track)})))}describeTagHint(e,n){let i="";return e.id===_.U.tagValuesExists?i=(e.details||[]).map(a=>a.reason.toUpperCase()).join(", "):e.id===_.U.id3v2Garbage?i=(e.details||[]).map(a=>a.reason).join(", "):e.id===_.U.id3v2Valid&&(i=(e.details||[]).map(a=>a.expected&&a.actual?`${a.reason}  (${a.actual} instead of ${a.expected})`:a.reason).join(", ")),this.solutions.find(a=>"Edit Tag"===a.name)||this.solutions.push({name:"Edit Tag",click:()=>{this.router.navigate([`/admin/folder/${n.parentID}/tags`]).catch(h=>{console.error(h)})}}),i}describeMp3GarbageHint(e,n){let i="";if(e.details&&e.details.length>0&&(i=`${e.details[0].reason} (${e.details[0].actual} bytes)`),!this.solutions.find(a=>"Fix MP3"===a.name)){const a={name:"Fix MP3",fixable:!0,click:()=>{a.running||(a.running=!0,this.jam.track.fix({id:n.id,fixID:e.id}).then(h=>{this.folderService.waitForQueueResult("Fixing Track MP3",h,[],[],[n.id])}).catch(h=>{this.notify.error(h)}))}};this.solutions.push(a)}return i}describeMp3ErrorHint(e,n){const i=`Stream Errors: ${(e.details||[]).length}`;if(!this.solutions.find(a=>"Fix Stream"===a.name)){const a={name:"Fix Stream",fixable:!0,click:()=>{a.running||(a.running=!0,this.jam.track.fix({id:n.id,fixID:e.id}).then(h=>{this.folderService.waitForQueueResult("Fixing Track Stream",h,[],[],[n.id])}).catch(h=>{this.notify.error(h)}))}};this.solutions.push(a)}return i}describeID3v1Hint(e,n){if(!this.solutions.find(i=>"Remove ID3v1"===i.name)){const i={name:"Remove ID3v1",fixable:!0,click:()=>{i.running||(i.running=!0,this.jam.track.fix({id:n.id,fixID:e.id}).then(a=>{this.folderService.waitForQueueResult("Remove ID3v1",a,[],[],[n.id])}).catch(a=>{this.notify.error(a)}))}};this.solutions.push(i)}return""}describeMP3HeaderHint(e,n){let i="";if(e.id===_.U.mp3HeaderValid&&(i=(e.details||[]).map(a=>a.expected&&a.actual?`${a.reason}  (${a.actual} instead of ${a.expected})`:a.reason).join(", ")),!this.solutions.find(a=>"Fix Header"===a.name)){const a={name:"Fix Header",fixable:!0,click:()=>{a.running||(a.running=!0,this.jam.track.fix({id:n.id,fixID:e.id}).then(h=>{this.folderService.waitForQueueResult("Fixing Track Header",h,[],[],[n.id])}).catch(h=>{this.notify.error(h)}))}};this.solutions.push(a)}return i}describeHint(e,n){switch(e.id){case _.U.tagValuesExists:case _.U.id3v2Garbage:case _.U.id3v2Exists:case _.U.id3v2Valid:return this.describeTagHint(e,n);case _.U.mp3Garbage:return this.describeMp3GarbageHint(e,n);case _.U.mp3MediaValid:return this.describeMp3ErrorHint(e,n);case _.U.id3v2NoId3v1:return this.describeID3v1Hint(e,n);case _.U.mp3HeaderExists:case _.U.mp3HeaderValid:return this.describeMP3HeaderHint(e,n)}return""}}return(0,r.Z)(o,"\u0275fac",function(e){return new(e||o)(t.Y36(m.zi),t.Y36(_.K4),t.Y36(m.c),t.Y36(m.Cr),t.Y36(k.F0))}),(0,r.Z)(o,"\u0275cmp",t.Xpm({type:o,selectors:[["app-track-health"]],inputs:{trackHealth:"trackHealth"},outputs:{resolvedEvent:"resolvedEvent"},features:[t.TTD],decls:1,vars:1,consts:[[4,"ngIf"],["class","hints",4,"ngIf"],[1,"hints"],[1,"hint"],[1,"icon-spin","icon-spinner"],["class","hint",4,"ngIf"],["class","hint",4,"ngFor","ngForOf","ngForTrackBy"],[1,"solutions"],["class","button-on-background",3,"click",4,"ngFor","ngForOf","ngForTrackBy"],[1,"icon-warning"],[1,"details"],[1,"button-on-background",3,"click"],["class","icon-spin icon-spinner",4,"ngIf"]],template:function(e,n){1&e&&t.YNc(0,en,3,2,"ng-container",0),2&e&&t.Q6J("ngIf",n.trackHealth)},dependencies:[O.sg,O.O5],styles:["[_nghost-%COMP%]{height:100%;width:100%;overflow-y:auto;overflow-x:auto;display:block}[_nghost-%COMP%]   .icon-warning[_ngcontent-%COMP%]{color:var(--accent)}[_nghost-%COMP%]   .details[_ngcontent-%COMP%]{padding-left:28px;font-size:.8em;display:block;padding-top:5px}[_nghost-%COMP%]   .hint[_ngcontent-%COMP%]{padding-bottom:15px}[_nghost-%COMP%]   .solutions[_ngcontent-%COMP%]{padding-bottom:15px}[_nghost-%COMP%]   .solutions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-right:5px}[_nghost-%COMP%]   .detail[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{text-transform:uppercase;letter-spacing:1.25px;font-size:11px;min-width:80px;margin-right:10px;display:inline-block}"]})),o})();function nn(o,l){1&o&&t._UZ(0,"app-loading")}function on(o,l){if(1&o){const e=t.EpF();t.TgZ(0,"div",9)(1,"div",10),t._uU(2),t.qZA(),t.TgZ(3,"div",11)(4,"app-track-health",12),t.NdJ("resolvedEvent",function(){const a=t.CHM(e).$implicit,h=t.oxw();return t.KtG(h.trackHealthResolved(a))}),t.qZA()()()}if(2&o){const e=l.$implicit;t.xp6(2),t.hij(" ",e.track.name," "),t.xp6(2),t.Q6J("trackHealth",e)}}let rn=(()=>{class o extends P{constructor(e,n,i,a,h){super(e),(0,r.Z)(this,"app",void 0),(0,r.Z)(this,"jam",void 0),(0,r.Z)(this,"notify",void 0),(0,r.Z)(this,"folderService",void 0),(0,r.Z)(this,"all",void 0),(0,r.Z)(this,"hints",void 0),(0,r.Z)(this,"filter",void 0),(0,r.Z)(this,"modes",[]),(0,r.Z)(this,"mediaCheck",!1),this.app=n,this.jam=i,this.notify=a,this.folderService=h}trackByFn(e,n){return n.track.id}onFilterChange(){this.reDisplay()}ngOnInit(){super.ngOnInit(),this.folderService.foldersChange.pipe((0,U.R)(this.unsubscribe)).subscribe(e=>{e.id===this.id&&this.refresh()})}ngOnDestroy(){super.ngOnDestroy()}checkChange(){this.refresh()}trackHealthResolved(e){this.all&&(this.all=this.all.filter(n=>n!==e),this.reDisplay())}refresh(){this.hints=void 0,this.id&&this.jam.track.health({folderIDs:[this.id],healthMedia:this.mediaCheck}).then(e=>{this.display(e)}).catch(e=>{this.notify.error(e)})}reDisplay(){this.hints=this.filter&&this.all?this.all.filter(e=>e.health&&e.health.find(n=>n.name===this.filter)):this.all}display(e){this.all=e,this.modes=[];for(const n of e)if(n.health)for(const i of n.health)this.modes.includes(i.name)||this.modes.push(i.name);this.reDisplay()}}return(0,r.Z)(o,"\u0275fac",function(e){return new(e||o)(t.Y36(k.gz),t.Y36(m.zi),t.Y36(_.K4),t.Y36(m.c),t.Y36(m.Cr))}),(0,r.Z)(o,"\u0275cmp",t.Xpm({type:o,selectors:[["app-admin-tracks-health"]],features:[t.qOj],decls:11,vars:6,consts:[[1,"health"],[1,"actions"],["title","Refresh List",1,"button-on-control",3,"click"],[1,"icon-reload"],["type","checkbox",3,"checked","ngModel","ngModelChange","change"],[1,"content"],[4,"ngIf"],["name","Track Health Issues",3,"list"],["class","track",4,"ngFor","ngForOf","ngForTrackBy"],[1,"track"],[1,"meta"],[1,"track-health"],[3,"trackHealth","resolvedEvent"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"button",2),t.NdJ("click",function(){return n.refresh()}),t._UZ(3,"i",3),t.qZA(),t.TgZ(4,"label")(5,"input",4),t.NdJ("ngModelChange",function(a){return n.mediaCheck=a})("change",function(){return n.checkChange()}),t.qZA(),t._uU(6," Check Media "),t.qZA()(),t.TgZ(7,"div",5),t.YNc(8,nn,1,0,"app-loading",6),t._UZ(9,"app-background-text-list",7),t.YNc(10,on,5,2,"div",8),t.qZA()()),2&e&&(t.xp6(5),t.Q6J("checked",n.mediaCheck)("ngModel",n.mediaCheck),t.xp6(3),t.Q6J("ngIf",!n.hints),t.xp6(1),t.Q6J("list",n.hints),t.xp6(1),t.Q6J("ngForOf",n.hints)("ngForTrackBy",n.trackByFn))},dependencies:[O.sg,O.O5,Q.$,Y.N,x.Wl,x.JJ,x.On,At],styles:["[_nghost-%COMP%]{height:100%;width:100%}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]{height:100%;width:100%;display:flex;flex-direction:column}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{padding:10px 15px 0;border-bottom-color:var(--background-border);border-bottom-width:1px;border-bottom-style:solid}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{margin-right:5px;margin-bottom:10px}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%] > label[_ngcontent-%COMP%]{text-transform:uppercase;letter-spacing:1px;font-size:11px;margin-left:5px;margin-right:5px}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{padding:15px;overflow-y:auto;overflow-x:auto}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .track[_ngcontent-%COMP%]{flex-flow:row nowrap}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .track[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]{width:30%;overflow:hidden;padding-right:15px;text-overflow:ellipsis}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .track[_ngcontent-%COMP%]   .track-health[_ngcontent-%COMP%]{width:70%}"]})),o})();var an=v(6906);function sn(o,l){if(1&o){const e=t.EpF();t.TgZ(0,"tr",13),t.NdJ("click",function(){const a=t.CHM(e).$implicit;return t.KtG(a.selected=!a.selected)}),t.TgZ(1,"td",4),t._uU(2),t.qZA(),t.TgZ(3,"td",5),t._uU(4),t.qZA(),t.TgZ(5,"td",6),t._uU(6),t.qZA(),t.TgZ(7,"td",7),t._uU(8),t.qZA(),t.TgZ(9,"td",8),t._uU(10),t.qZA(),t.TgZ(11,"td",9),t._uU(12),t.qZA(),t.TgZ(13,"td",10),t._uU(14),t.qZA(),t.TgZ(15,"td",11),t._uU(16),t.ALo(17,"duration"),t.qZA()()}if(2&o){const e=l.$implicit;t.ekj("selected",e.selected),t.xp6(2),t.Oqu(null==e.track.tag?null:e.track.tag.trackNr),t.xp6(2),t.Oqu(null==e.track.tag?null:e.track.tag.title),t.xp6(2),t.Oqu(null==e.track.tag?null:e.track.tag.artist),t.xp6(2),t.Oqu(null==e.track.tag?null:e.track.tag.album),t.xp6(2),t.Oqu(null==e.track.media?null:e.track.media.format),t.xp6(2),t.Oqu(null==e.track.media?null:e.track.media.bitRate),t.xp6(2),t.Oqu(null==e.track.media?null:e.track.media.sampleRate),t.xp6(2),t.Oqu(t.lcZ(17,10,e.track.duration))}}function cn(o,l){if(1&o&&(t.TgZ(0,"table",2)(1,"tr",3)(2,"td",4),t._uU(3,"Track Nr."),t.qZA(),t.TgZ(4,"td",5),t._uU(5,"Title"),t.qZA(),t.TgZ(6,"td",6),t._uU(7,"Artist"),t.qZA(),t.TgZ(8,"td",7),t._uU(9,"Album"),t.qZA(),t.TgZ(10,"td",8),t._uU(11,"Format"),t.qZA(),t.TgZ(12,"td",9),t._uU(13,"BitRate"),t.qZA(),t.TgZ(14,"td",10),t._uU(15,"SampleRate"),t.qZA(),t.TgZ(16,"td",11),t._uU(17,"Duration"),t.qZA()(),t.YNc(18,sn,18,12,"tr",12),t.qZA()),2&o){const e=t.oxw();t.xp6(18),t.Q6J("ngForOf",e.trackItems)("ngForTrackBy",e.trackByFn)}}let St=(()=>{class o{constructor(e){(0,r.Z)(this,"router",void 0),(0,r.Z)(this,"trackItems",void 0),(0,r.Z)(this,"tracks",[]),this.router=e}trackByFn(e,n){return n.track.id}getSortValue(e,n){switch(e){case"number":return n.track.tag?.trackNr;case"name":return n.track.name;case"artist":return n.track.tag?.artist;case"album":return n.track.tag?.album;case"duration":return n.track.duration;default:return}}ngOnChanges(){this.trackItems=(this.tracks||[]).map(e=>({track:e}))}toTrackFolder(e){this.router.navigate([`/admin/folder/${e.parentID}/overview`]).catch(n=>{console.error(n)})}}return(0,r.Z)(o,"\u0275fac",function(e){return new(e||o)(t.Y36(k.F0))}),(0,r.Z)(o,"\u0275cmp",t.Xpm({type:o,selectors:[["app-admin-track-list"]],inputs:{tracks:"tracks"},features:[t.TTD],decls:2,vars:2,consts:[["name","Tracks",3,"list"],["class","tracks",4,"ngIf"],[1,"tracks"],[1,"track","heading"],[1,"number"],[1,"title"],[1,"artist"],[1,"album"],[1,"format"],[1,"bitrate"],[1,"samplerate"],[1,"duration"],["class","track",3,"selected","click",4,"ngFor","ngForOf","ngForTrackBy"],[1,"track",3,"click"]],template:function(e,n){1&e&&(t._UZ(0,"app-background-text-list",0),t.YNc(1,cn,19,2,"table",1)),2&e&&(t.Q6J("list",n.tracks),t.xp6(1),t.Q6J("ngIf",n.tracks&&n.tracks.length>0))},dependencies:[O.sg,O.O5,Q.$,an.u],styles:["[_nghost-%COMP%]{width:100%;overflow:auto;display:block}[_nghost-%COMP%]   .tracks[_ngcontent-%COMP%]{padding:15px;font-size:.8em;width:100%}[_nghost-%COMP%]   .heading[_ngcontent-%COMP%]{font-size:.9em}[_nghost-%COMP%]   .track[_ngcontent-%COMP%]{border-bottom:1px solid var(--control-border)}[_nghost-%COMP%]   .track[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:5px 10px}[_nghost-%COMP%]   .track[_ngcontent-%COMP%]:hover{background-color:var(--background-hover)}[_nghost-%COMP%]   .track.selected[_ngcontent-%COMP%]{background-color:var(--background-active)}"]})),o})();function ln(o,l){1&o&&t._UZ(0,"app-loading")}function dn(o,l){if(1&o){const e=t.EpF();t.TgZ(0,"div",3)(1,"div",4)(2,"button",5),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.refresh())}),t._UZ(3,"i",6),t.qZA(),t.TgZ(4,"button",7),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.moveTracks())}),t._UZ(5,"i",8),t.qZA(),t.TgZ(6,"button",9),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.deleteTracks())}),t._UZ(7,"i",10),t.qZA()(),t._UZ(8,"app-admin-track-list",11),t.qZA()}if(2&o){const e=t.oxw();t.xp6(8),t.Q6J("tracks",e.folder.tracks)}}let gn=(()=>{class o extends P{constructor(e,n,i,a,h,b){super(e),(0,r.Z)(this,"jam",void 0),(0,r.Z)(this,"notify",void 0),(0,r.Z)(this,"folderService",void 0),(0,r.Z)(this,"dialogsService",void 0),(0,r.Z)(this,"dialogOverlay",void 0),(0,r.Z)(this,"folder",void 0),(0,r.Z)(this,"tracks",void 0),this.jam=n,this.notify=i,this.folderService=a,this.dialogsService=h,this.dialogOverlay=b}ngOnInit(){super.ngOnInit(),this.folderService.foldersChange.pipe((0,U.R)(this.unsubscribe)).subscribe(e=>{e.id===this.id&&this.refresh()})}ngOnDestroy(){super.ngOnDestroy()}deleteTracks(){const e=this.getTrackIDs();0!==e.length&&this.dialogsService.confirm("Remove Tracks?",`Sure to remove ${e.length} Track${e.length>1?"s":""}?`,()=>{for(const n of e)this.jam.track.remove({id:n}).then(i=>{this.folderService.waitForQueueResult("Removing Track",i,[],[],[n])}).catch(i=>{this.notify.error(i)})})}getTrackIDs(){if(!this.tracks?.trackItems||!this.folder?.tracks)return[];const e=this.tracks.trackItems.filter(n=>n.selected).map(n=>n.track.id);return e.length>0?e:this.folder.tracks.map(n=>n.id)}moveTracks(){var e=this;const n=this.getTrackIDs();if(0===n.length)return;const i={selectID:this.id};var a;this.dialogOverlay.open({title:"Move Tracks to",childComponent:B,data:i,panelClass:"overlay-panel-large-buttons",onOkBtn:(a=(0,F.Z)(function*(){const h=i.folder;if(h)return e.jam.track.move({ids:n,folderID:h.id}).then(b=>{e.folderService.waitForQueueResult("Moving Tracks",b,[],[h.id].concat(e.folder?.parentID?[e.folder.parentID]:[]),n)}).catch(b=>{e.notify.error(b)}),Promise.resolve()}),function(){return a.apply(this,arguments)}),onCancelBtn:function(){var a=(0,F.Z)(function*(){return Promise.resolve()});return function(){return a.apply(this,arguments)}}()})}refresh(){this.folder=void 0,this.id&&this.jam.folder.id({id:this.id,folderIncTracks:!0,trackIncTag:!0,trackIncMedia:!0}).then(e=>{this.folder=e}).catch(e=>{this.notify.error(e)})}}return(0,r.Z)(o,"\u0275fac",function(e){return new(e||o)(t.Y36(k.gz),t.Y36(_.K4),t.Y36(m.c),t.Y36(m.Cr),t.Y36(q.Hr),t.Y36(z.SL))}),(0,r.Z)(o,"\u0275cmp",t.Xpm({type:o,selectors:[["app-admin-folder-tracks"]],viewQuery:function(e,n){if(1&e&&t.Gf(St,5),2&e){let i;t.iGM(i=t.CRH())&&(n.tracks=i.first)}},features:[t.qOj],decls:3,vars:3,consts:[[4,"ngIf"],["name","Tracks",3,"list"],["class","tracks",4,"ngIf"],[1,"tracks"],[1,"actions"],["title","Refresh",1,"button-on-control",3,"click"],[1,"icon-reload"],["title","Move Tracks\u2026",1,"button-on-control",3,"click"],[1,"icon-right-bold"],["title","Delete Tracks\u2026",1,"button-on-control",3,"click"],[1,"icon-trash"],[1,"content",3,"tracks"]],template:function(e,n){1&e&&(t.YNc(0,ln,1,0,"app-loading",0),t._UZ(1,"app-background-text-list",1),t.YNc(2,dn,9,1,"div",2)),2&e&&(t.Q6J("ngIf",!n.folder),t.xp6(1),t.Q6J("list",null==n.folder?null:n.folder.tracks),t.xp6(1),t.Q6J("ngIf",n.folder&&n.folder.tracks&&n.folder.tracks.length>0))},dependencies:[O.O5,Q.$,Y.N,St],styles:["[_nghost-%COMP%]{height:100%;width:100%;display:block;overflow:hidden}[_nghost-%COMP%]   .tracks[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;width:100%}[_nghost-%COMP%]   .tracks[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{padding:10px 15px 0;border-bottom-color:var(--background-border);border-bottom-width:1px;border-bottom-style:solid}[_nghost-%COMP%]   .tracks[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{margin-right:5px;margin-bottom:10px}[_nghost-%COMP%]   .tracks[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%] > label[_ngcontent-%COMP%]{text-transform:uppercase;letter-spacing:1px;font-size:11px;margin-left:5px;margin-right:5px}[_nghost-%COMP%]   .tracks[_ngcontent-%COMP%]   app-admin-track-list[_ngcontent-%COMP%]{overflow-y:auto}"]})),o})();var ht=v(5197);function pn(o,l){if(1&o){const e=t.EpF();t.TgZ(0,"button",9),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(3);return t.KtG(i.refresh(i.current.pos,!1))}),t._UZ(1,"i",10),t._uU(2," Refresh"),t.qZA()}}function hn(o,l){if(1&o){const e=t.EpF();t.TgZ(0,"button",9),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(3);return t.KtG(i.fixAll())}),t._uU(1,"Fix all fixable"),t.qZA()}}function un(o,l){if(1&o){const e=t.EpF();t.TgZ(0,"div",5)(1,"button",6),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.start())}),t._UZ(2,"i",7),t._uU(3," Next"),t.qZA(),t.YNc(4,pn,3,0,"button",8),t.YNc(5,hn,2,0,"button",8),t.qZA()}if(2&o){const e=t.oxw(2);t.xp6(4),t.Q6J("ngIf",e.current),t.xp6(1),t.Q6J("ngIf",e.current&&e.current.health&&e.current.health.length>0)}}function _n(o,l){if(1&o){const e=t.EpF();t.TgZ(0,"div",5)(1,"button",9),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.stop())}),t._UZ(2,"i",11),t._uU(3," Stop"),t.qZA()()}}function mn(o,l){if(1&o&&(t.ynx(0),t.YNc(1,un,6,2,"div",4),t.YNc(2,_n,4,0,"div",4),t.BQk()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",!e.searching),t.xp6(1),t.Q6J("ngIf",e.searching)}}function fn(o,l){1&o&&t._UZ(0,"app-loading")}function Cn(o,l){1&o&&t._UZ(0,"i",16)}function xn(o,l){if(1&o){const e=t.EpF();t.TgZ(0,"div",18)(1,"div",19),t._uU(2),t.qZA(),t.TgZ(3,"div",20)(4,"app-track-health",21),t.NdJ("resolvedEvent",function(){const a=t.CHM(e).$implicit,h=t.oxw(3);return t.KtG(h.trackHealthResolved(a))}),t.qZA()()()}if(2&o){const e=l.$implicit;t.xp6(2),t.hij(" ",e.track.name," "),t.xp6(2),t.Q6J("trackHealth",e)}}function Mn(o,l){if(1&o&&(t.ynx(0),t.YNc(1,xn,5,2,"div",17),t.BQk()),2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",e.current.health)("ngForTrackBy",e.trackByFn)}}const vn=function(o){return["/admin/folder",o,"tags"]};function On(o,l){if(1&o&&(t.TgZ(0,"div")(1,"div",12)(2,"span"),t.YNc(3,Cn,1,0,"i",13),t.qZA(),t.TgZ(4,"span"),t._uU(5),t.qZA(),t.TgZ(6,"a",14),t._UZ(7,"i",15),t._uU(8),t.qZA()(),t.YNc(9,Mn,2,2,"ng-container",2),t.qZA()),2&o){const e=t.oxw();t.xp6(3),t.Q6J("ngIf",e.searching),t.xp6(2),t.AsE("",e.current.pos+1," / ",e.folders.length,""),t.xp6(1),t.Q6J("routerLink",t.VKq(6,vn,e.current.folder.id)),t.xp6(2),t.hij(" ",e.current.folder.name,""),t.xp6(1),t.Q6J("ngIf",e.current.health)}}let bn=(()=>{class o{constructor(e,n,i,a,h,b){(0,r.Z)(this,"app",void 0),(0,r.Z)(this,"jam",void 0),(0,r.Z)(this,"notify",void 0),(0,r.Z)(this,"uiState",void 0),(0,r.Z)(this,"folderService",void 0),(0,r.Z)(this,"userStorage",void 0),(0,r.Z)(this,"folders",void 0),(0,r.Z)(this,"current",void 0),(0,r.Z)(this,"searching",!1),(0,r.Z)(this,"trackHealthComponents",void 0),(0,r.Z)(this,"unsubscribe",new N.x),this.app=e,this.jam=n,this.notify=i,this.uiState=a,this.folderService=h,this.userStorage=b,b.userChange.pipe((0,U.R)(this.unsubscribe)).subscribe(()=>this.loadFromStorage())}trackHealthResolved(e){this.current&&this.current.health&&(this.current.health=this.current.health.filter(n=>n!==e))}trackByFn(e,n){return n.track.id}stop(){this.searching=!1}start(){this.searching||!this.folders||(this.searching=!0,this.request())}request(){if(!this.searching)return;let e=0;this.current&&(e=this.current.pos+1),this.refresh(e,!0)}fixAll(){this.searching||!this.current||!this.trackHealthComponents||this.trackHealthComponents.forEach(e=>{e.fixAll()})}refresh(e,n){this.current=void 0,this.searching=!0;const i=this.folders&&this.folders[e];if(!i)return void(this.searching=!1);const a={folder:i,pos:e};this.current=a,this.userStorage.set(o.localStorageName,{folderID:i.id}),this.jam.track.health({folderIDs:[i.id],healthMedia:!0}).then(h=>{h.length>0?(a.health=h,this.searching=!1):n?this.request():(a.health=[],this.searching=!1)}).catch(h=>{this.current=void 0,this.searching=!1,this.notify.error(h)})}ngOnInit(){const e=this.uiState.data["app-admin-radar"];e&&(this.folders=e.folders,this.current=e.current,this.folders)||this.loadFolders()}ngOnDestroy(){this.uiState.data["app-admin-radar"]={folders:this.folders,current:this.current},this.current=void 0,this.searching=!1,this.folders=void 0,this.unsubscribe.next(),this.unsubscribe.complete()}loadFromStorage(){const e=this.userStorage.get(o.localStorageName);if(e?.folderID&&this.folders){const n=this.folders.findIndex(i=>i.id===e.folderID);n>=0&&(this.current={folder:this.folders[n],pos:n},this.refresh(n,!1))}}loadFolders(){this.jam.folder.search({folderTypes:[_.Sr.album,_.Sr.multialbum]}).then(e=>{this.folders=e.items,this.loadFromStorage()}).catch(e=>{this.notify.error(e)})}}return(0,r.Z)(o,"localStorageName","admin.radar"),(0,r.Z)(o,"\u0275fac",function(e){return new(e||o)(t.Y36(m.zi),t.Y36(_.K4),t.Y36(m.c),t.Y36(m.JU),t.Y36(m.Cr),t.Y36(m.TZ))}),(0,r.Z)(o,"\u0275cmp",t.Xpm({type:o,selectors:[["app-admin-radar"]],viewQuery:function(e,n){if(1&e&&t.Gf(At,5),2&e){let i;t.iGM(i=t.CRH())&&(n.trackHealthComponents=i)}},decls:6,vars:3,consts:[[1,"radar"],["section","Health Radar"],[4,"ngIf"],[1,"content"],["class","buttons",4,"ngIf"],[1,"buttons"],[1,"button-primary",3,"click"],[1,"icon-play"],["class","button-on-control",3,"click",4,"ngIf"],[1,"button-on-control",3,"click"],[1,"icon-reload"],[1,"icon-stop"],[1,"current"],["class","icon-spin icon-spinner",4,"ngIf"],[3,"routerLink"],[1,"icon-folder"],[1,"icon-spin","icon-spinner"],["class","track",4,"ngFor","ngForOf","ngForTrackBy"],[1,"track"],[1,"meta"],[1,"track-health"],[3,"trackHealth","resolvedEvent"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"app-view-header-slim",1),t.YNc(2,mn,3,2,"ng-container",2),t.qZA(),t.TgZ(3,"div",3),t.YNc(4,fn,1,0,"app-loading",2),t.YNc(5,On,10,8,"div",2),t.qZA()()),2&e&&(t.xp6(2),t.Q6J("ngIf",n.folders),t.xp6(2),t.Q6J("ngIf",!n.folders),t.xp6(1),t.Q6J("ngIf",n.folders&&n.current))},dependencies:[O.sg,O.O5,ht.p,Y.N,k.rH,At],styles:["[_nghost-%COMP%]{height:100%;width:100%;overflow-y:auto;overflow-x:auto;display:block}[_nghost-%COMP%]   .radar[_ngcontent-%COMP%]{display:flex;flex-direction:column}[_nghost-%COMP%]   .radar[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{padding:15px}[_nghost-%COMP%]   .radar[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]{min-width:130px;display:inline-block}[_nghost-%COMP%]   .radar[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{margin-right:5px}[_nghost-%COMP%]   .radar[_ngcontent-%COMP%]   .current[_ngcontent-%COMP%]{padding-top:15px;padding-bottom:15px;border-bottom:1px solid var(--background-border)}[_nghost-%COMP%]   .radar[_ngcontent-%COMP%]   .current[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{padding-right:15px}[_nghost-%COMP%]   .radar[_ngcontent-%COMP%]   .track[_ngcontent-%COMP%]{border-bottom:1px solid var(--background-border)}[_nghost-%COMP%]   .radar[_ngcontent-%COMP%]   .track[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]{padding-top:15px;padding-bottom:15px}[_nghost-%COMP%]   .radar[_ngcontent-%COMP%]   .track[_ngcontent-%COMP%]   .track-health[_ngcontent-%COMP%]{padding-left:15px}@media (max-width: 768px){[_nghost-%COMP%]   .radar[_ngcontent-%COMP%]   .current[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block}[_nghost-%COMP%]   .radar[_ngcontent-%COMP%]   .track[_ngcontent-%COMP%]   .track-health[_ngcontent-%COMP%]{padding-left:0}}"]})),o})();const Ut=function(){return{standalone:!0}};function yn(o,l){if(1&o){const e=t.EpF();t.TgZ(0,"form")(1,"div",1)(2,"label",2),t._uU(3,"Root name"),t.qZA(),t.TgZ(4,"input",3),t.NdJ("ngModelChange",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.edit.name=i)}),t.qZA()(),t.TgZ(5,"div",1)(6,"label",4),t._uU(7,"Path"),t.qZA(),t.TgZ(8,"input",5),t.NdJ("ngModelChange",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.edit.path=i)}),t.qZA()(),t.TgZ(9,"div",1)(10,"label",6),t._uU(11,"Scan Strategy"),t.qZA(),t.TgZ(12,"fieldset",7)(13,"label",8)(14,"input",9),t.NdJ("ngModelChange",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.edit.strategy=i)}),t.qZA(),t._uU(15," Auto"),t.qZA(),t.TgZ(16,"label",8)(17,"input",9),t.NdJ("ngModelChange",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.edit.strategy=i)}),t.qZA(),t._uU(18," Artist/Album"),t.qZA(),t.TgZ(19,"label",8)(20,"input",9),t.NdJ("ngModelChange",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.edit.strategy=i)}),t.qZA(),t._uU(21," Compilations"),t.qZA(),t.TgZ(22,"label",8)(23,"input",9),t.NdJ("ngModelChange",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.edit.strategy=i)}),t.qZA(),t._uU(24," Audiobook"),t.qZA()()()()}if(2&o){const e=t.oxw();t.xp6(4),t.Q6J("ngModelOptions",t.DdM(12,Ut))("ngModel",e.edit.name),t.xp6(4),t.Q6J("ngModelOptions",t.DdM(13,Ut))("ngModel",e.edit.path),t.xp6(6),t.Q6J("value",e.RootScanStrategy.auto)("ngModel",e.edit.strategy),t.xp6(3),t.Q6J("value",e.RootScanStrategy.artistalbum)("ngModel",e.edit.strategy),t.xp6(3),t.Q6J("value",e.RootScanStrategy.compilation)("ngModel",e.edit.strategy),t.xp6(3),t.Q6J("value",e.RootScanStrategy.audiobook)("ngModel",e.edit.strategy)}}let Rt=(()=>{class o{constructor(){(0,r.Z)(this,"edit",void 0),(0,r.Z)(this,"RootScanStrategy",_.hy)}dialogInit(e,n){this.edit=n.data}}return(0,r.Z)(o,"\u0275fac",function(e){return new(e||o)}),(0,r.Z)(o,"\u0275cmp",t.Xpm({type:o,selectors:[["app-dialog-root"]],decls:1,vars:1,consts:[[4,"ngIf"],[1,"root-form-control"],["for","root-name"],["id","root-name","type","text",3,"ngModelOptions","ngModel","ngModelChange"],["for","root-path"],["id","root-path","type","text",3,"ngModelOptions","ngModel","ngModelChange"],["for","strategy"],["id","strategy"],[1,"select"],["type","radio","name","strategy",3,"value","ngModel","ngModelChange"]],template:function(e,n){1&e&&t.YNc(0,yn,25,14,"form",0),2&e&&t.Q6J("ngIf",n.edit)},dependencies:[O.O5,x._Y,x.Fj,x._,x.JJ,x.JL,x.On,x.F],styles:["[_nghost-%COMP%]   input[type=text][_ngcontent-%COMP%]{width:100%;line-height:1.3em;padding:5px;min-width:300px}[_nghost-%COMP%]   input[type=radio][_ngcontent-%COMP%]{margin-right:5px}[_nghost-%COMP%]   .root-form-control[_ngcontent-%COMP%]{margin-bottom:8px;display:block}[_nghost-%COMP%]   .select[_ngcontent-%COMP%]{margin-right:15px;display:block;font-size:.8em;line-height:1.5em}"]})),o})();var wn=v(9178);function Zn(o,l){1&o&&(t.TgZ(0,"span"),t._uU(1,"Not scanned"),t.qZA())}function An(o,l){if(1&o&&(t.TgZ(0,"span",22),t._uU(1,"Error:"),t._UZ(2,"br"),t._uU(3),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(3),t.Oqu(e.status.error)}}function Pn(o,l){1&o&&(t.ynx(0),t._uU(1,"Working\u2026"),t.BQk())}function kn(o,l){if(1&o&&(t.ynx(0),t._uU(1,"Last Change:"),t._UZ(2,"br"),t._uU(3),t.ALo(4,"date"),t.BQk()),2&o){const e=t.oxw(2).$implicit;t.xp6(3),t.Oqu(t.xi3(4,1,e.status.lastScan,"medium"))}}function Tn(o,l){if(1&o&&(t.TgZ(0,"span"),t.YNc(1,Pn,2,0,"ng-container",11),t.YNc(2,kn,5,4,"ng-container",11),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",e.status.scanning),t.xp6(1),t.Q6J("ngIf",!e.status.scanning)}}function In(o,l){if(1&o){const e=t.EpF();t.TgZ(0,"tr",10),t.NdJ("dblclick",function(){const a=t.CHM(e).$implicit,h=t.oxw(2);return t.KtG(h.editRoot(a))})("keydown.enter",function(){const a=t.CHM(e).$implicit,h=t.oxw(2);return t.KtG(h.editRoot(a))}),t.TgZ(1,"td",4),t._uU(2),t.qZA(),t.TgZ(3,"td",5),t._uU(4),t.qZA(),t.TgZ(5,"td",6),t._uU(6),t.qZA(),t.TgZ(7,"td",7),t.YNc(8,Zn,2,0,"span",11),t.YNc(9,An,4,1,"span",12),t.YNc(10,Tn,3,2,"span",11),t.qZA(),t.TgZ(11,"td",8)(12,"div",13)(13,"button",14),t.NdJ("click",function(){const a=t.CHM(e).$implicit,h=t.oxw(2);return t.KtG(h.refreshRoot(a))}),t._UZ(14,"i",15),t.qZA(),t.TgZ(15,"button",16),t.NdJ("click",function(){const a=t.CHM(e).$implicit,h=t.oxw(2);return t.KtG(h.refreshRootMeta(a))}),t._UZ(16,"i",17),t.qZA(),t.TgZ(17,"button",18),t.NdJ("click",function(){const a=t.CHM(e).$implicit,h=t.oxw(2);return t.KtG(h.editRoot(a))}),t._UZ(18,"i",19),t.qZA(),t.TgZ(19,"button",20),t.NdJ("click",function(){const a=t.CHM(e).$implicit,h=t.oxw(2);return t.KtG(h.deleteRoot(a))}),t._UZ(20,"i",21),t.qZA()()()()}if(2&o){const e=l.$implicit;t.xp6(2),t.Oqu(e.name),t.xp6(2),t.Oqu(e.path),t.xp6(2),t.Oqu(e.strategy),t.xp6(2),t.Q6J("ngIf",!e.status),t.xp6(1),t.Q6J("ngIf",e.status&&e.status.error),t.xp6(1),t.Q6J("ngIf",e.status&&!e.status.error)}}function Fn(o,l){if(1&o&&(t.TgZ(0,"table",2)(1,"tr",3)(2,"td",4),t._uU(3,"Name"),t.qZA(),t.TgZ(4,"td",5),t._uU(5,"Path"),t.qZA(),t.TgZ(6,"td",6),t._uU(7,"Strategy"),t.qZA(),t.TgZ(8,"td",7),t._uU(9,"Status"),t.qZA(),t.TgZ(10,"td",8),t._uU(11,"Actions"),t.qZA()(),t.YNc(12,In,21,6,"tr",9),t.qZA()),2&o){const e=t.oxw();t.xp6(12),t.Q6J("ngForOf",e.roots)("ngForTrackBy",e.trackByFn)}}let Sn=(()=>{class o{constructor(e,n,i,a,h,b,D){(0,r.Z)(this,"router",void 0),(0,r.Z)(this,"route",void 0),(0,r.Z)(this,"app",void 0),(0,r.Z)(this,"notify",void 0),(0,r.Z)(this,"dialogs",void 0),(0,r.Z)(this,"rootService",void 0),(0,r.Z)(this,"dialogOverlay",void 0),(0,r.Z)(this,"roots",[]),this.router=e,this.route=n,this.app=i,this.notify=a,this.dialogs=h,this.rootService=b,this.dialogOverlay=D}trackByFn(e,n){return n.id}refreshRoot(e){this.rootService.rescanRoot(e)}refreshRootMeta(e){this.rootService.refreshRootMeta(e)}editRoot(e){var n=this;const i={root:e,name:e.name,path:e.path,strategy:e.strategy};var a;this.dialogOverlay.open({title:"Edit Root",childComponent:Rt,data:i,onOkBtn:(a=(0,F.Z)(function*(){try{yield n.rootService.applyDialogRoot(i)}catch(h){return n.notify.error(h),Promise.reject(h)}}),function(){return a.apply(this,arguments)}),onCancelBtn:function(){var a=(0,F.Z)(function*(){return Promise.resolve()});return function(){return a.apply(this,arguments)}}()})}deleteRoot(e){this.dialogs.confirm("Delete Root","Do you want to the delete the root folder?",()=>{this.rootService.removeRoot(e)})}}return(0,r.Z)(o,"\u0275fac",function(e){return new(e||o)(t.Y36(k.F0),t.Y36(k.gz),t.Y36(m.zi),t.Y36(m.c),t.Y36(q.Hr),t.Y36(m.Nb),t.Y36(z.SL))}),(0,r.Z)(o,"\u0275cmp",t.Xpm({type:o,selectors:[["app-admin-root-list"]],inputs:{roots:"roots"},decls:2,vars:2,consts:[["name","Roots",3,"list"],["class","roots","appFocusKeyList","",4,"ngIf"],["appFocusKeyList","",1,"roots"],[1,"root","heading"],[1,"title"],[1,"path"],[1,"strategy"],[1,"status"],[1,"actions"],["class","root","appFocusKeyListItem","",3,"dblclick","keydown.enter",4,"ngFor","ngForOf","ngForTrackBy"],["appFocusKeyListItem","",1,"root",3,"dblclick","keydown.enter"],[4,"ngIf"],["class","error",4,"ngIf"],[1,"action-buttons"],["title","Rescan Root","appClickStop","",3,"click"],["aria-hidden","true",1,"icon-rescan"],["title","Refresh Root Meta","appClickStop","",3,"click"],["aria-hidden","true",1,"icon-broom"],["title","Edit Root","appClickStop","",3,"click"],["aria-hidden","true",1,"icon-edit"],["title","Delete Root","appClickStop","",3,"click"],["aria-hidden","true",1,"icon-remove"],[1,"error"]],template:function(e,n){1&e&&(t._UZ(0,"app-background-text-list",0),t.YNc(1,Fn,13,2,"table",1)),2&e&&(t.Q6J("list",n.roots),t.xp6(1),t.Q6J("ngIf",n.roots&&n.roots.length>0))},dependencies:[O.sg,O.O5,Q.$,wn.D,Z.j,A.R,O.uU],styles:["[_nghost-%COMP%]{width:100%;overflow:auto;display:block}[_nghost-%COMP%]   .roots[_ngcontent-%COMP%]{padding:15px;font-size:.9em;width:100%}[_nghost-%COMP%]   .root[_ngcontent-%COMP%]{height:60px;border-bottom:1px solid var(--control-border)}[_nghost-%COMP%]   .root[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:5px 10px}[_nghost-%COMP%]   .root[_ngcontent-%COMP%]:hover{background-color:var(--background-hover)}[_nghost-%COMP%]   .root.selected[_ngcontent-%COMP%]{background-color:var(--background-active)}[_nghost-%COMP%]   .error[_ngcontent-%COMP%]{color:var(--accent)}[_nghost-%COMP%]   .heading[_ngcontent-%COMP%]{height:40px;font-size:.9em}[_nghost-%COMP%]   .actions[_ngcontent-%COMP%]{width:100px}[_nghost-%COMP%]   .action-buttons[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}[_nghost-%COMP%]   .action-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:5px;flex:50%;margin:0;display:inline-block;color:var(--on-control);border:1px solid transparent}[_nghost-%COMP%]   .action-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{color:var(--on-control-active);border:1px solid var(--control-active)}"]})),o})(),Un=(()=>{class o{constructor(e,n,i,a,h,b,D){(0,r.Z)(this,"router",void 0),(0,r.Z)(this,"route",void 0),(0,r.Z)(this,"app",void 0),(0,r.Z)(this,"notify",void 0),(0,r.Z)(this,"dialogs",void 0),(0,r.Z)(this,"rootService",void 0),(0,r.Z)(this,"dialogOverlay",void 0),(0,r.Z)(this,"roots",void 0),(0,r.Z)(this,"unsubscribe",new N.x),this.router=e,this.route=n,this.app=i,this.notify=a,this.dialogs=h,this.rootService=b,this.dialogOverlay=D}static getSortValue(e,n){switch(e){case"name":return n.name;case"path":return n.path;default:return}}ngOnInit(){this.rootService.rootsChange.pipe((0,U.R)(this.unsubscribe)).subscribe(e=>{this.roots=(e||[]).sort((n,i)=>n.name.localeCompare(i.name))},e=>{this.notify.error(e)}),this.rootService.refreshRoots()}ngOnDestroy(){this.unsubscribe.next(),this.unsubscribe.complete()}refresh(){this.rootService.refreshRoots()}newRoot(){var e=this;const n={name:"",path:"",strategy:_.hy.auto};var i;this.dialogOverlay.open({title:"New Root",childComponent:Rt,data:n,onOkBtn:(i=(0,F.Z)(function*(){try{yield e.rootService.applyDialogRoot(n)}catch(a){return e.notify.error(a),Promise.reject(a)}}),function(){return i.apply(this,arguments)}),onCancelBtn:function(){var i=(0,F.Z)(function*(){return Promise.resolve()});return function(){return i.apply(this,arguments)}}()})}refreshRoots(){this.rootService.rescanRoots()}}return(0,r.Z)(o,"\u0275fac",function(e){return new(e||o)(t.Y36(k.F0),t.Y36(k.gz),t.Y36(m.zi),t.Y36(m.c),t.Y36(q.Hr),t.Y36(m.Nb),t.Y36(z.SL))}),(0,r.Z)(o,"\u0275cmp",t.Xpm({type:o,selectors:[["app-admin-root"]],decls:11,vars:1,consts:[[1,"roots"],["section","Roots"],[1,"actions"],["title","Refresh",1,"button-on-control",3,"click"],[1,"icon-reload"],["title","New Root\u2026",1,"button-on-control",3,"click"],[1,"icon-plus"],["title","Rescan all Roots",1,"button-on-control",3,"click"],[1,"icon-rescan"],[1,"content"],[3,"roots"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"app-view-header-slim",1)(2,"div",2)(3,"button",3),t.NdJ("click",function(){return n.refresh()}),t._UZ(4,"i",4),t.qZA(),t.TgZ(5,"button",5),t.NdJ("click",function(){return n.newRoot()}),t._UZ(6,"i",6),t.qZA(),t.TgZ(7,"button",7),t.NdJ("click",function(){return n.refreshRoots()}),t._UZ(8,"i",8),t.qZA()()(),t.TgZ(9,"div",9),t._UZ(10,"app-admin-root-list",10),t.qZA()()),2&e&&(t.xp6(10),t.Q6J("roots",n.roots))},dependencies:[ht.p,Sn],styles:["[_nghost-%COMP%]{height:100%;width:100%;overflow-y:auto;overflow-x:auto;display:block}[_nghost-%COMP%]   .roots[_ngcontent-%COMP%]{height:100%;overflow-y:auto;overflow-x:hidden}[_nghost-%COMP%]   .roots[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{margin-right:5px;margin-bottom:10px}"]})),o})();function Rn(o,l){1&o&&t._UZ(0,"app-loading")}function Hn(o,l){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"div")(2,"div",6),t._uU(3,"Server"),t.qZA(),t.TgZ(4,"div",7)(5,"label")(6,"input",8),t.NdJ("ngModelChange",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.settings.library.scanAtStart=i)})("ngModelChange",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.onChange())}),t.qZA(),t._uU(7," Scan all Roots on Server Start "),t.qZA()()(),t.TgZ(8,"div")(9,"div",6),t._uU(10,"External Services"),t.qZA(),t.TgZ(11,"div",7)(12,"label")(13,"input",9),t.NdJ("ngModelChange",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.settings.externalServices.enabled=i)})("ngModelChange",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.onChange())}),t.qZA(),t._uU(14," Allow Request to External Services "),t.qZA()()(),t.TgZ(15,"div")(16,"div",6),t._uU(17,"Chat"),t.qZA(),t.TgZ(18,"div",7)(19,"label",10),t._uU(20,"Maximum Number of Messages"),t.qZA(),t.TgZ(21,"input",11),t.NdJ("ngModelChange",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.settings.chat.maxMessages=i)})("ngModelChange",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.onChange())}),t.qZA()(),t.TgZ(22,"div",7)(23,"div",12)(24,"label",13),t._uU(25,"Maximum Age of Message"),t.qZA(),t.TgZ(26,"input",14),t.NdJ("ngModelChange",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.settings.chat.maxAge.value=i)})("ngModelChange",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.onChange())}),t.qZA()(),t.TgZ(27,"select",15),t.NdJ("ngModelChange",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.settings.chat.maxAge.unit=i)})("ngModelChange",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.onChange())}),t.TgZ(28,"option",16),t._uU(29,"year"),t.qZA(),t.TgZ(30,"option",16),t._uU(31,"years"),t.qZA(),t.TgZ(32,"option",16),t._uU(33,"month"),t.qZA(),t.TgZ(34,"option",16),t._uU(35,"months"),t.qZA(),t.TgZ(36,"option",16),t._uU(37,"day"),t.qZA(),t.TgZ(38,"option",16),t._uU(39,"days"),t.qZA(),t.TgZ(40,"option",16),t._uU(41,"minute"),t.qZA(),t.TgZ(42,"option",16),t._uU(43,"minutes"),t.qZA(),t.TgZ(44,"option",16),t._uU(45,"second"),t.qZA(),t.TgZ(46,"option",16),t._uU(47,"seconds"),t.qZA()()()(),t.TgZ(48,"div")(49,"div",6),t._uU(50,"Artist Index"),t.qZA(),t.TgZ(51,"div",7)(52,"label",17),t._uU(53,"Ignored Articles in Artist Names"),t.qZA(),t.TgZ(54,"textarea",18),t.NdJ("ngModelChange",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.ignoreArticles=i)})("ngModelChange",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.onChange())}),t.qZA()()(),t.BQk()}if(2&o){const e=t.oxw();t.xp6(6),t.Q6J("ngModel",e.settings.library.scanAtStart),t.xp6(7),t.Q6J("ngModel",e.settings.externalServices.enabled),t.xp6(8),t.Q6J("ngModel",e.settings.chat.maxMessages),t.xp6(5),t.Q6J("ngModel",e.settings.chat.maxAge.value),t.xp6(1),t.Q6J("ngModel",e.settings.chat.maxAge.unit),t.xp6(1),t.Q6J("value","year"),t.xp6(2),t.Q6J("value","years"),t.xp6(2),t.Q6J("value","month"),t.xp6(2),t.Q6J("value","months"),t.xp6(2),t.Q6J("value","day"),t.xp6(2),t.Q6J("value","days"),t.xp6(2),t.Q6J("value","minute"),t.xp6(2),t.Q6J("value","minutes"),t.xp6(2),t.Q6J("value","second"),t.xp6(2),t.Q6J("value","seconds"),t.xp6(8),t.Q6J("ngModel",e.ignoreArticles)}}let qn=(()=>{class o{constructor(e,n,i){(0,r.Z)(this,"app",void 0),(0,r.Z)(this,"jam",void 0),(0,r.Z)(this,"notify",void 0),(0,r.Z)(this,"settings",void 0),(0,r.Z)(this,"ignoreArticles",""),this.app=e,this.jam=n,this.notify=i}ngOnInit(){this.refresh()}onChange(){}refresh(){this.jam.admin.settings().then(e=>{this.display(e)}).catch(e=>{this.notify.error(e)})}save(){const e=this.settings;e&&(e.index.ignoreArticles=this.ignoreArticles.split("\n").map(n=>n.trim()).filter(n=>n.length>0),this.settings=void 0,this.jam.admin.settingsUpdate(e).then(()=>{this.notify.success("Settings updated"),this.settings=e}).catch(n=>{this.notify.error(n),this.settings=e}))}display(e){this.settings=e,this.ignoreArticles=e.index.ignoreArticles.join("\n")}}return(0,r.Z)(o,"\u0275fac",function(e){return new(e||o)(t.Y36(m.zi),t.Y36(_.K4),t.Y36(m.c))}),(0,r.Z)(o,"\u0275cmp",t.Xpm({type:o,selectors:[["app-admin-settings"]],decls:8,vars:2,consts:[[1,"settings"],["section","Admin Settings"],["title","Save",1,"button-on-control",3,"click"],[1,"icon-floppy"],[1,"content"],[4,"ngIf"],[1,"section-title"],[1,"section-entry"],["type","checkbox","title","Scan all Roots on Server Start",3,"ngModel","ngModelChange"],["type","checkbox","title","Allow Request to External Services",3,"ngModel","ngModelChange"],["for","max_messages"],["id","max_messages","type","number",3,"ngModel","ngModelChange"],[1,"chat-max-age"],["for","max_age"],["id","max_age","type","number",3,"ngModel","ngModelChange"],["placeholder","Unit of Age",3,"ngModel","ngModelChange"],[3,"value"],["for","ignore_articles"],["id","ignore_articles","rows","10","cols","20",3,"ngModel","ngModelChange"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"app-view-header-slim",1)(2,"button",2),t.NdJ("click",function(){return n.save()}),t._UZ(3,"i",3),t._uU(4," Save Settings"),t.qZA()(),t.TgZ(5,"div",4),t.YNc(6,Rn,1,0,"app-loading",5),t.YNc(7,Hn,55,16,"ng-container",5),t.qZA()()),2&e&&(t.xp6(6),t.Q6J("ngIf",!n.settings),t.xp6(1),t.Q6J("ngIf",n.settings))},dependencies:[O.O5,ht.p,Y.N,x.YN,x.Kr,x.Fj,x.wV,x.Wl,x.EJ,x.JJ,x.On],styles:["[_nghost-%COMP%]   .settings[_ngcontent-%COMP%]{overflow-y:auto;overflow-x:hidden;height:100%}[_nghost-%COMP%]   .settings[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{padding:15px 15px 0}[_nghost-%COMP%]   .settings[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .chat-max-age[_ngcontent-%COMP%]{display:inline-block}[_nghost-%COMP%]   .settings[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .section-entry[_ngcontent-%COMP%]{padding-bottom:15px}[_nghost-%COMP%]   .settings[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-size:12px;padding-bottom:3px}[_nghost-%COMP%]   .settings[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{margin-top:-1px;display:inline-block;vertical-align:middle}"]})),o})(),Ht=(()=>{class o{}return(0,r.Z)(o,"\u0275fac",function(e){return new(e||o)}),(0,r.Z)(o,"\u0275cmp",t.Xpm({type:o,selectors:[["app-admin-start"]],decls:4,vars:0,consts:[[1,"start"],["section","Administration"],[1,"content"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0),t._UZ(1,"app-view-header-slim",1),t.TgZ(2,"div",2),t._UZ(3,"app-admin-section-cards"),t.qZA()())},styles:["[_nghost-%COMP%]{height:100%;width:100%;overflow-y:auto;overflow-x:auto;display:block}[_nghost-%COMP%]   .start[_ngcontent-%COMP%]{height:100%;overflow-y:auto;overflow-x:hidden}"]})),o})();const at=function(){return{standalone:!0}};function Jn(o,l){if(1&o){const e=t.EpF();t.TgZ(0,"div")(1,"form")(2,"div",1)(3,"label",2),t._uU(4,"Name"),t.qZA(),t.TgZ(5,"input",3),t.NdJ("ngModelChange",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.edit.edit.name=i)}),t.qZA()(),t.TgZ(6,"div",1)(7,"label",4),t._uU(8,"Email"),t.qZA(),t.TgZ(9,"input",5),t.NdJ("ngModelChange",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.edit.edit.email=i)}),t.qZA()(),t.TgZ(10,"div",6),t._uU(11,"Roles"),t.qZA(),t.TgZ(12,"div",7)(13,"label")(14,"input",8),t.NdJ("ngModelChange",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.edit.edit.roleAdmin=i)}),t.qZA(),t._uU(15," Administrator "),t.qZA(),t._UZ(16,"br"),t.TgZ(17,"label")(18,"input",9),t.NdJ("ngModelChange",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.edit.edit.rolePodcast=i)}),t.qZA(),t._uU(19," Manage Podcasts "),t.qZA(),t._UZ(20,"br"),t.TgZ(21,"label")(22,"input",9),t.NdJ("ngModelChange",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.edit.edit.roleStream=i)}),t.qZA(),t._uU(23," Can Stream/Download "),t.qZA(),t._UZ(24,"br"),t.TgZ(25,"label")(26,"input",10),t.NdJ("ngModelChange",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.edit.edit.roleUpload=i)}),t.qZA(),t._uU(27," Can Upload "),t.qZA()(),t._UZ(28,"hr"),t.TgZ(29,"div",1),t._UZ(30,"input",11,12),t.TgZ(32,"label",13),t._uU(33,"Your Admin Password"),t.qZA(),t.TgZ(34,"input",14),t.NdJ("ngModelChange",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.edit.edit.password=i)}),t.qZA()()()()}if(2&o){const e=t.oxw();t.xp6(5),t.Q6J("ngModelOptions",t.DdM(14,at))("ngModel",e.edit.edit.name),t.xp6(4),t.Q6J("ngModelOptions",t.DdM(15,at))("ngModel",e.edit.edit.email),t.xp6(5),t.Q6J("ngModelOptions",t.DdM(16,at))("ngModel",e.edit.edit.roleAdmin),t.xp6(4),t.Q6J("ngModelOptions",t.DdM(17,at))("ngModel",e.edit.edit.rolePodcast),t.xp6(4),t.Q6J("ngModelOptions",t.DdM(18,at))("ngModel",e.edit.edit.roleStream),t.xp6(4),t.Q6J("ngModelOptions",t.DdM(19,at))("ngModel",e.edit.edit.roleUpload),t.xp6(8),t.Q6J("ngModelOptions",t.DdM(20,at))("ngModel",e.edit.edit.password)}}let qt=(()=>{class o{constructor(){(0,r.Z)(this,"edit",void 0)}dialogInit(e,n){this.edit=n.data}}return(0,r.Z)(o,"\u0275fac",function(e){return new(e||o)}),(0,r.Z)(o,"\u0275cmp",t.Xpm({type:o,selectors:[["app-dialog-user"]],decls:1,vars:1,consts:[[4,"ngIf"],[1,"user-form-control"],["for","user-name"],["id","user-name","type","text","name","username",3,"ngModelOptions","ngModel","ngModelChange"],["for","user-mail"],["id","user-mail","type","email","name","mail",3,"ngModelOptions","ngModel","ngModelChange"],[1,"user-form-section"],[1,"user-form-roles"],["type","checkbox","title","Allow User to administrate",3,"ngModelOptions","ngModel","ngModelChange"],["type","checkbox","title","Allow User to manage podcasts",3,"ngModelOptions","ngModel","ngModelChange"],["type","checkbox","title","Allow User to upload files",3,"ngModelOptions","ngModel","ngModelChange"],["type","text","name","user","autocomplete","username",1,"dummy"],["name",""],["for","admin-pass",1,"label-pass"],["id","admin-pass","name","pass","type","password","autocomplete","password",3,"ngModelOptions","ngModel","ngModelChange"]],template:function(e,n){1&e&&t.YNc(0,Jn,35,21,"div",0),2&e&&t.Q6J("ngIf",n.edit)},dependencies:[O.O5,x._Y,x.Fj,x.Wl,x.JJ,x.JL,x.On,x.F],styles:["[_nghost-%COMP%] > div[_ngcontent-%COMP%]{margin-left:15px;margin-right:15px}[_nghost-%COMP%]   input[type=text][_ngcontent-%COMP%], [_nghost-%COMP%]   input[type=email][_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]   input[_ngcontent-%COMP%]{line-height:1.3em;padding:5px}[_nghost-%COMP%]   .label-pass[_ngcontent-%COMP%]{padding-right:15px;font-size:.8em}[_nghost-%COMP%]   .dummy[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .user-form-control[_ngcontent-%COMP%]{margin-bottom:8px;display:block}[_nghost-%COMP%]   .user-form-roles[_ngcontent-%COMP%]{margin-bottom:10px}[_nghost-%COMP%]   .user-form-roles[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{line-height:1.5em}"]})),o})();var Dn=v(9100);let Qn=(()=>{class o{constructor(e,n){(0,r.Z)(this,"jam",void 0),(0,r.Z)(this,"notify",void 0),(0,r.Z)(this,"user",void 0),(0,r.Z)(this,"userAvatar",void 0),(0,r.Z)(this,"hasChanged",!1),(0,r.Z)(this,"unsubscribe",new N.x),this.jam=e,this.notify=n}ngOnDestroy(){this.unsubscribe.next(),this.unsubscribe.complete()}dialogInit(e,n){this.user=n.data,this.setImageSource()}dialogResult(){return this.hasChanged}setImageSource(){this.userAvatar=this.user?`${this.jam.image.imageUrl({id:this.user.id,size:60,format:_.GU.webp})}?${(0,Dn.O)()}`:void 0}onDropFile(e){e.preventDefault(),this.uploadFile(e.dataTransfer?.files)}onDragOverFile(e){e.stopPropagation(),e.preventDefault()}selectFile(e){this.uploadFile(e.target.files)}uploadFile(e){e&&0!==e.length&&this.user&&this.jam.user.uploadUserImage({id:this.user.id},e[0]).pipe((0,U.R)(this.unsubscribe)).subscribe(i=>{i.type===$.dt.UploadProgress||i instanceof $.Zn&&(this.setImageSource(),this.hasChanged=!0)},i=>{this.setImageSource(),this.notify.error(i)},()=>{this.notify.success("Upload done")})}}return(0,r.Z)(o,"\u0275fac",function(e){return new(e||o)(t.Y36(_.K4),t.Y36(m.c))}),(0,r.Z)(o,"\u0275cmp",t.Xpm({type:o,selectors:[["app-dialog-avatar"]],decls:6,vars:1,consts:[[1,"drop-zone",3,"drop","dragover"],[1,"root-form-control"],["alt","User Avatar",3,"src"],["type","file","placeholder","Upload image","accept",".png,.jpeg,.jpg",3,"change"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0),t.NdJ("drop",function(a){return n.onDropFile(a)})("dragover",function(a){return n.onDragOverFile(a)}),t.TgZ(1,"form")(2,"div",1),t._UZ(3,"img",2),t.qZA()(),t.TgZ(4,"form")(5,"input",3),t.NdJ("change",function(a){return n.selectFile(a)}),t.qZA()()()),2&e&&(t.xp6(3),t.Q6J("src",n.userAvatar,t.LSH))},dependencies:[x._Y,x.JL,x.F],styles:["[_nghost-%COMP%]   .drop-zone[_ngcontent-%COMP%]{margin:10px 20px;border-width:2px;border-style:dotted;border-color:var(--secondary)}[_nghost-%COMP%]   input[type=text][_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]   .root-form-control[_ngcontent-%COMP%]{margin-bottom:8px;display:block;text-align:center}"]})),o})();const Jt=function(){return{standalone:!0}};function Nn(o,l){if(1&o){const e=t.EpF();t.TgZ(0,"div",1)(1,"form"),t._UZ(2,"input",2),t.TgZ(3,"label",3),t._uU(4,"Your Admin Password"),t.qZA(),t.TgZ(5,"input",4),t.NdJ("ngModelChange",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.data.password=i)}),t.qZA()(),t.TgZ(6,"form"),t._UZ(7,"input",5),t.TgZ(8,"label",6),t._uU(9,"New Password for User "),t.TgZ(10,"span"),t._uU(11),t.qZA()(),t.TgZ(12,"input",7),t.NdJ("ngModelChange",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.data.newPassword=i)}),t.qZA()()()}if(2&o){const e=t.oxw();t.xp6(5),t.Q6J("ngModelOptions",t.DdM(5,Jt))("ngModel",e.data.password),t.xp6(6),t.Oqu(e.data.user.name),t.xp6(1),t.Q6J("ngModelOptions",t.DdM(6,Jt))("ngModel",e.data.newPassword)}}let zn=(()=>{class o{constructor(){(0,r.Z)(this,"data",void 0)}dialogInit(e,n){this.data=n.data}dialogResult(){return!0}}return(0,r.Z)(o,"\u0275fac",function(e){return new(e||o)}),(0,r.Z)(o,"\u0275cmp",t.Xpm({type:o,selectors:[["app-dialog-user-pass"]],decls:1,vars:1,consts:[["class","user-form-control",4,"ngIf"],[1,"user-form-control"],["type","text","name","user","autocomplete","username",1,"dummy"],["for","admin-pass"],["id","admin-pass","name","pass","type","password","autocomplete","current-password",3,"ngModelOptions","ngModel","ngModelChange"],["type","text","name","new_name",1,"dummy"],["for","new-pass"],["id","new-pass","name","new_password","type","password","autocomplete","new-password",3,"ngModelOptions","ngModel","ngModelChange"]],template:function(e,n){1&e&&t.YNc(0,Nn,13,7,"div",0),2&e&&t.Q6J("ngIf",n.data)},dependencies:[O.O5,x._Y,x.Fj,x.JJ,x.JL,x.On,x.F],styles:["[_nghost-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:10px}[_nghost-%COMP%]   label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:700}[_nghost-%COMP%]   .dummy[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   input[_ngcontent-%COMP%]{line-height:1.3em;padding:5px;width:100%;margin-bottom:15px}"]})),o})();var En=v(7254);function Yn(o,l){1&o&&t._UZ(0,"i",22)}function Bn(o,l){1&o&&(t.TgZ(0,"span",23),t._uU(1,"Is Admin"),t.qZA())}function Ln(o,l){1&o&&t._UZ(0,"i",22)}function jn(o,l){1&o&&(t.TgZ(0,"span",23),t._uU(1,"Can manage podcast"),t.qZA())}function Kn(o,l){1&o&&t._UZ(0,"i",22)}function Gn(o,l){1&o&&(t.TgZ(0,"span",23),t._uU(1,"Can upload"),t.qZA())}function Wn(o,l){1&o&&t._UZ(0,"i",22)}function $n(o,l){1&o&&(t.TgZ(0,"span",23),t._uU(1,"Can stream"),t.qZA())}function Vn(o,l){if(1&o){const e=t.EpF();t.TgZ(0,"tr",9),t.NdJ("dblclick",function(){const a=t.CHM(e).$implicit,h=t.oxw(2);return t.KtG(h.editUser(a))})("keydown.enter",function(){const a=t.CHM(e).$implicit,h=t.oxw(2);return t.KtG(h.editUser(a))}),t.TgZ(1,"td",3),t._UZ(2,"app-coverart-image",10),t.qZA(),t.TgZ(3,"td",4),t._uU(4),t.qZA(),t.TgZ(5,"td",5),t._uU(6),t.qZA(),t.TgZ(7,"td",6),t.YNc(8,Yn,1,0,"i",11),t.YNc(9,Bn,2,0,"span",12),t.qZA(),t.TgZ(10,"td",6),t.YNc(11,Ln,1,0,"i",11),t.YNc(12,jn,2,0,"span",12),t.qZA(),t.TgZ(13,"td",6),t.YNc(14,Kn,1,0,"i",11),t.YNc(15,Gn,2,0,"span",12),t.qZA(),t.TgZ(16,"td",6),t.YNc(17,Wn,1,0,"i",11),t.YNc(18,$n,2,0,"span",12),t.qZA(),t.TgZ(19,"td",7)(20,"div",13)(21,"button",14),t.NdJ("click",function(){const a=t.CHM(e).$implicit,h=t.oxw(2);return t.KtG(h.editUserAvatar(a))}),t._UZ(22,"i",15),t.qZA(),t.TgZ(23,"button",16),t.NdJ("click",function(){const a=t.CHM(e).$implicit,h=t.oxw(2);return t.KtG(h.setUserPassword(a))}),t._UZ(24,"i",17),t.qZA(),t.TgZ(25,"button",18),t.NdJ("click",function(){const a=t.CHM(e).$implicit,h=t.oxw(2);return t.KtG(h.editUser(a))}),t._UZ(26,"i",19),t.qZA(),t.TgZ(27,"button",20),t.NdJ("click",function(){const a=t.CHM(e).$implicit,h=t.oxw(2);return t.KtG(h.deleteUser(a))}),t._UZ(28,"i",21),t.qZA()()()()}if(2&o){const e=l.$implicit;t.xp6(2),t.Q6J("coverArtObj",e)("alt",e.name)("size",28)("round",!0),t.xp6(2),t.Oqu(e.name),t.xp6(2),t.Oqu(e.email),t.xp6(2),t.Q6J("ngIf",e.roles.admin),t.xp6(1),t.Q6J("ngIf",e.roles.admin),t.xp6(2),t.Q6J("ngIf",e.roles.podcast),t.xp6(1),t.Q6J("ngIf",e.roles.admin),t.xp6(2),t.Q6J("ngIf",e.roles.upload),t.xp6(1),t.Q6J("ngIf",e.roles.admin),t.xp6(2),t.Q6J("ngIf",e.roles.stream),t.xp6(1),t.Q6J("ngIf",e.roles.stream)}}function Xn(o,l){if(1&o&&(t.TgZ(0,"table",1)(1,"tr",2)(2,"td",3),t._uU(3,"Avatar"),t.qZA(),t.TgZ(4,"td",4),t._uU(5,"Name"),t.qZA(),t.TgZ(6,"td",5),t._uU(7,"Email"),t.qZA(),t.TgZ(8,"td",6),t._uU(9,"Administrator"),t.qZA(),t.TgZ(10,"td",6),t._uU(11,"Manage Podcasts"),t.qZA(),t.TgZ(12,"td",6),t._uU(13,"Can Upload"),t.qZA(),t.TgZ(14,"td",6),t._uU(15,"Can Stream"),t.qZA(),t.TgZ(16,"td",7),t._uU(17,"Actions"),t.qZA()(),t.YNc(18,Vn,29,14,"tr",8),t.qZA()),2&o){const e=t.oxw();t.xp6(18),t.Q6J("ngForOf",e.users)("ngForTrackBy",e.trackByFn)}}let to=(()=>{class o{constructor(e,n,i,a,h,b,D){(0,r.Z)(this,"router",void 0),(0,r.Z)(this,"route",void 0),(0,r.Z)(this,"app",void 0),(0,r.Z)(this,"notify",void 0),(0,r.Z)(this,"dialogs",void 0),(0,r.Z)(this,"userService",void 0),(0,r.Z)(this,"dialogOverlay",void 0),(0,r.Z)(this,"users",[]),(0,r.Z)(this,"unsubscribe",new N.x),this.router=e,this.route=n,this.app=i,this.notify=a,this.dialogs=h,this.userService=b,this.dialogOverlay=D}trackByFn(e,n){return n.id}ngOnDestroy(){this.unsubscribe.next(),this.unsubscribe.complete()}editUser(e){var n=this;const i={user:e,edit:{password:"",name:e.name,email:e.email||"",roleAdmin:e.roles.admin,rolePodcast:e.roles.podcast,roleStream:e.roles.stream,roleUpload:e.roles.upload}};var a;this.dialogOverlay.open({childComponent:qt,title:"Edit User",data:i,onOkBtn:(a=(0,F.Z)(function*(){try{yield n.userService.applyDialogUser(i),n.notify.success("User edited")}catch(h){return n.notify.error(h),Promise.reject(h)}}),function(){return a.apply(this,arguments)}),onCancelBtn:function(){var a=(0,F.Z)(function*(){return Promise.resolve()});return function(){return a.apply(this,arguments)}}()})}editUserAvatar(e){this.dialogOverlay.open({childComponent:Qn,title:"Edit User Avatar",data:e}).afterClosed().pipe((0,U.R)(this.unsubscribe)).subscribe(()=>{this.userService.refreshUser(e.id)})}setUserPassword(e){var n=this;const i={user:e,password:"",newPassword:""};var a;this.dialogOverlay.open({childComponent:zn,title:"Set User Password",data:i,onOkBtn:(a=(0,F.Z)(function*(){try{yield n.userService.setPassword(e.id,i.password,i.newPassword),n.notify.success("Password changed")}catch(h){return n.notify.error(h),Promise.reject(h)}}),function(){return a.apply(this,arguments)}),onCancelBtn:function(){var a=(0,F.Z)(function*(){return Promise.resolve()});return function(){return a.apply(this,arguments)}}()})}deleteUser(e){this.dialogs.confirm("Delete User","Do you want to the delete the user?",()=>{this.userService.removeUser(e).then(()=>{this.notify.success("User deleted")}).catch(n=>{this.notify.error(n)})})}}return(0,r.Z)(o,"\u0275fac",function(e){return new(e||o)(t.Y36(k.F0),t.Y36(k.gz),t.Y36(m.zi),t.Y36(m.c),t.Y36(q.Hr),t.Y36(m.NZ),t.Y36(z.SL))}),(0,r.Z)(o,"\u0275cmp",t.Xpm({type:o,selectors:[["app-admin-user-list"]],inputs:{users:"users"},decls:1,vars:1,consts:[["class","users","appFocusKeyList","",4,"ngIf"],["appFocusKeyList","",1,"users"],[1,"user","heading"],[1,"avatar"],[1,"title"],[1,"email"],[1,"role"],[1,"actions"],["class","user","appFocusKeyListItem","",3,"dblclick","keydown.enter",4,"ngFor","ngForOf","ngForTrackBy"],["appFocusKeyListItem","",1,"user",3,"dblclick","keydown.enter"],[3,"coverArtObj","alt","size","round"],["class","icon-checkmark","aria-hidden","true",4,"ngIf"],["class","visually-hidden",4,"ngIf"],[1,"action-buttons"],["title","Change Avatar",3,"click"],["aria-hidden","true",1,"icon-picture"],["title","Set Password",3,"click"],["aria-hidden","true",1,"icon-key"],["title","Edit User",3,"click"],["aria-hidden","true",1,"icon-edit"],["title","Delete User",3,"click"],["aria-hidden","true",1,"icon-remove"],["aria-hidden","true",1,"icon-checkmark"],[1,"visually-hidden"]],template:function(e,n){1&e&&t.YNc(0,Xn,19,2,"table",0),2&e&&t.Q6J("ngIf",n.users&&n.users.length>0)},dependencies:[O.sg,O.O5,En.A,Z.j,A.R],styles:["[_nghost-%COMP%]{width:100%;overflow:auto;display:block}[_nghost-%COMP%]   .users[_ngcontent-%COMP%]{padding:15px;font-size:.9em;width:100%}[_nghost-%COMP%]   .user[_ngcontent-%COMP%]{height:60px;border-bottom:1px solid var(--control-border)}[_nghost-%COMP%]   .user[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:5px 10px}[_nghost-%COMP%]   .user[_ngcontent-%COMP%]:hover{background-color:var(--background-hover)}[_nghost-%COMP%]   .user.selected[_ngcontent-%COMP%]{background-color:var(--background-active)}[_nghost-%COMP%]   .heading[_ngcontent-%COMP%]{font-size:.9em;height:40px}[_nghost-%COMP%]   .icon-checkmark[_ngcontent-%COMP%]{color:var(--primary)}[_nghost-%COMP%]   .actions[_ngcontent-%COMP%]{width:100px}[_nghost-%COMP%]   .action-buttons[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}[_nghost-%COMP%]   .action-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:5px;flex:50%;margin:0;display:inline-block;color:var(--on-control);border:1px solid transparent}[_nghost-%COMP%]   .action-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{color:var(--on-control-active);border:1px solid var(--control-active)}"]})),o})();const Pt=[{path:"",component:H,children:[{path:"",pathMatch:"full",component:Ht,data:{name:"Admin"}},{path:"settings",component:qn,data:{name:"Admin Settings"}},{path:"root",component:Un,data:{name:"Roots",icon:"icon-root"}},{path:"user",component:(()=>{class o{constructor(e,n,i,a,h,b){(0,r.Z)(this,"app",void 0),(0,r.Z)(this,"dialogs",void 0),(0,r.Z)(this,"jam",void 0),(0,r.Z)(this,"notify",void 0),(0,r.Z)(this,"userService",void 0),(0,r.Z)(this,"dialogOverlay",void 0),(0,r.Z)(this,"users",void 0),(0,r.Z)(this,"unsubscribe",new N.x),this.app=e,this.dialogs=n,this.jam=i,this.notify=a,this.userService=h,this.dialogOverlay=b}getSortValue(e,n){switch(e){case"name":return n.name;case"email":return n.email;case"roleAdmin":return n.roles.admin?1:0;case"rolePodcast":return n.roles.podcast?1:0;case"roleUpload":return n.roles.upload?1:0;case"roleStream":return n.roles.stream?1:0;default:return}}ngOnInit(){this.userService.usersChange.pipe((0,U.R)(this.unsubscribe)).subscribe(e=>{this.users=(e||[]).sort((n,i)=>n.name.localeCompare(i.name))},e=>{this.notify.error(e)}),this.userService.refreshUsers()}ngOnDestroy(){this.unsubscribe.next(),this.unsubscribe.complete()}refresh(){this.userService.refreshUsers()}newUser(){var e=this;const n={edit:{password:"",name:"",email:"",roleAdmin:!1,rolePodcast:!1,roleStream:!0,roleUpload:!1}};var i;this.dialogOverlay.open({title:"New User",childComponent:qt,data:n,onOkBtn:(i=(0,F.Z)(function*(){try{yield e.userService.applyDialogUser(n),e.notify.success("User created")}catch(a){return e.notify.error(a),Promise.reject(a)}}),function(){return i.apply(this,arguments)}),onCancelBtn:function(){var i=(0,F.Z)(function*(){return Promise.resolve()});return function(){return i.apply(this,arguments)}}()})}}return(0,r.Z)(o,"\u0275fac",function(e){return new(e||o)(t.Y36(m.zi),t.Y36(q.Hr),t.Y36(_.K4),t.Y36(m.c),t.Y36(m.NZ),t.Y36(z.SL))}),(0,r.Z)(o,"\u0275cmp",t.Xpm({type:o,selectors:[["app-admin-users"]],decls:9,vars:1,consts:[[1,"users"],["section","Users"],[1,"actions"],["title","Refresh",1,"button-on-control",3,"click"],[1,"icon-reload"],["title","New User\u2026",1,"button-on-control",3,"click"],[1,"icon-plus"],[1,"content"],[3,"users"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"app-view-header-slim",1)(2,"div",2)(3,"button",3),t.NdJ("click",function(){return n.refresh()}),t._UZ(4,"i",4),t.qZA(),t.TgZ(5,"button",5),t.NdJ("click",function(){return n.newUser()}),t._UZ(6,"i",6),t.qZA()()(),t.TgZ(7,"div",7),t._UZ(8,"app-admin-user-list",8),t.qZA()()),2&e&&(t.xp6(8),t.Q6J("users",n.users))},dependencies:[ht.p,to],styles:["[_nghost-%COMP%]{height:100%;width:100%;overflow-y:auto;overflow-x:auto;display:block}[_nghost-%COMP%]   .users[_ngcontent-%COMP%]{height:100%;overflow-y:auto;overflow-x:hidden}[_nghost-%COMP%]   .users[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{margin-right:5px;margin-bottom:10px}[_nghost-%COMP%]   .users[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{padding:0 5px 5px}[_nghost-%COMP%]   .users[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{text-transform:uppercase;letter-spacing:1.25px;font-size:13.2px;margin-bottom:10px;color:var(--on-control-ambient)}@media (max-width: 522px){[_nghost-%COMP%]   .users[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{padding-left:10px;padding-right:10px}}"]})),o})(),data:{name:"Users",icon:"icon-user"}},{path:"folder",redirectTo:"folder/"},{path:"folder/:id",component:S,data:{id:"folder",name:"Folders",icon:"icon-folder",link:"folder"},children:[{path:"overview",component:je},{path:"health",component:Ze},{path:"sub-folders",component:Mt},{path:"tracks",component:gn},{path:"tracks-health",component:rn},{path:"tags",loadChildren:(o=(0,F.Z)(function*(){return Promise.all([v.e(592),v.e(795)]).then(v.bind(v,9795)).then(l=>l.TagEditorModule)}),function(){return o.apply(this,arguments)})}]},{path:"radar",component:bn,data:{name:"Health Radar",icon:"icon-health"}}]}],eo=k.Bz.forChild(Pt);var o;function no(o,l){if(1&o&&(t.ynx(0),t._uU(1),t.BQk()),2&o){const e=t.oxw(2);t.xp6(1),t.hij("(",e.folderService.current.count,")")}}function oo(o,l){if(1&o&&(t.TgZ(0,"div",7)(1,"span",3),t._uU(2,"Other requests in queue:"),t.qZA(),t._uU(3),t.qZA()),2&o){const e=t.oxw(2);t.xp6(3),t.hij(" ",e.folderService.queue.length," ")}}function io(o,l){if(1&o&&(t.TgZ(0,"div",1)(1,"div",2)(2,"span",3),t._uU(3,"Current:"),t.qZA(),t._UZ(4,"i",4),t._uU(5),t.YNc(6,no,2,1,"ng-container",5),t.qZA(),t.YNc(7,oo,4,1,"div",6),t.qZA()),2&o){const e=t.oxw();t.xp6(5),t.hij(" ",e.folderService.current.title," "),t.xp6(1),t.Q6J("ngIf",e.folderService.current.count>1),t.xp6(1),t.Q6J("ngIf",e.folderService.queue.length>0)}}let ro=(()=>{class o{constructor(e){(0,r.Z)(this,"folderService",void 0),this.folderService=e}}return(0,r.Z)(o,"\u0275fac",function(e){return new(e||o)(t.Y36(m.Cr))}),(0,r.Z)(o,"\u0275cmp",t.Xpm({type:o,selectors:[["app-admin-queue-requests"]],decls:1,vars:1,consts:[["class","queue-overlay",4,"ngIf"],[1,"queue-overlay"],[1,"current"],[1,"label"],[1,"icon-spin","icon-spinner"],[4,"ngIf"],["class","other",4,"ngIf"],[1,"other"]],template:function(e,n){1&e&&t.YNc(0,io,8,3,"div",0),2&e&&t.Q6J("ngIf",n.folderService.current)},dependencies:[O.O5],styles:["[_nghost-%COMP%]   .queue-overlay[_ngcontent-%COMP%]{position:fixed;right:16px;bottom:16px;padding:15px;background-color:var(--control);color:var(--on-control);border:1px solid var(--control-border);z-index:1000}[_nghost-%COMP%]   .queue-overlay[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{text-transform:uppercase;font-size:.8em;letter-spacing:1px;color:var(--on-control-ambient)}[_nghost-%COMP%]   .queue-overlay[_ngcontent-%COMP%]   .other[_ngcontent-%COMP%]{border-top:1px solid var(--background-border)}"]})),o})();var ao=v(327);let so=(()=>{class o{constructor(){(0,r.Z)(this,"sections",[]);const n=(Pt[0].children||[]).filter(i=>i.path&&i.path.length>0&&i.data?.name).map(i=>({link:`/admin/${i.data&&i.data.link?i.data.link:i.path}`,name:i.data?i.data.name:"",icon:i.data&&i.data.icon?i.data.icon:"icon-admin"}));this.sections=[{name:"Administration",entries:n}]}}return(0,r.Z)(o,"\u0275fac",function(e){return new(e||o)}),(0,r.Z)(o,"\u0275cmp",t.Xpm({type:o,selectors:[["app-admin-sidebar"]],decls:1,vars:1,consts:[[3,"sections"]],template:function(e,n){1&e&&t._UZ(0,"app-sidebar",0),2&e&&t.Q6J("sections",n.sections)},dependencies:[ao.k],styles:["[_nghost-%COMP%]{width:100%;height:100%;display:block}"]})),o})();var co=v(9766);const lo=function(o){return["/admin",o]};function go(o,l){if(1&o&&(t.TgZ(0,"div",1)(1,"div",2),t._UZ(2,"app-iconart-image",3),t.qZA(),t.TgZ(3,"div",4)(4,"a",5),t._uU(5),t.qZA()()()),2&o){const e=l.$implicit;t.Q6J("routerLink",t.VKq(3,lo,e.id)),t.xp6(2),t.Q6J("icon",e.icon),t.xp6(3),t.Oqu(e.text)}}let po=(()=>{class o{constructor(){(0,r.Z)(this,"sections",[]),this.sections=(Pt[0].children||[]).filter(n=>n.path&&n.path.length>0&&n.data?.name).map(n=>({id:n.data&&n.data.link?n.data.link:n.path,text:n.data?n.data.name:"",icon:n.data&&n.data.icon?n.data.icon:"icon-admin"}))}trackByFn(e,n){return n.id}}return(0,r.Z)(o,"\u0275fac",function(e){return new(e||o)}),(0,r.Z)(o,"\u0275cmp",t.Xpm({type:o,selectors:[["app-admin-section-cards"]],decls:1,vars:2,consts:[["class","section-card no-hover",3,"routerLink",4,"ngFor","ngForOf","ngForTrackBy"],[1,"section-card","no-hover",3,"routerLink"],[1,"image"],[3,"icon"],[1,"footer"],[1,"footer-content"]],template:function(e,n){1&e&&t.YNc(0,go,6,5,"div",0),2&e&&t.Q6J("ngForOf",n.sections)("ngForTrackBy",n.trackByFn)},dependencies:[O.sg,co.B,k.rH],styles:['[_nghost-%COMP%]{display:flex;flex-flow:row wrap}@media (max-width: 768px){[_nghost-%COMP%]{justify-content:space-around}}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]{margin:15px;width:calc(25% - 30px);position:relative;overflow:hidden;display:flex;cursor:pointer}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]:before{content:"";display:block;margin-top:100%}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .fav[_ngcontent-%COMP%], [_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]{position:absolute;top:1px;padding:5px;transform:translateY(-31px);transition:transform .3s}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .fav[_ngcontent-%COMP%]{right:1px;border-bottom-left-radius:3px;cursor:pointer;-webkit-user-select:none;user-select:none}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]{left:1px;font-size:.8em;border-bottom-right-radius:3px}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]{padding:5px;position:absolute;bottom:1px;left:1px;right:1px;overflow:hidden;height:auto}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]   .footer-buttons[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]:hover   .fav[_ngcontent-%COMP%], [_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]:hover   .date[_ngcontent-%COMP%]{transform:translateY(0)}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]:hover   .footer[_ngcontent-%COMP%]   .footer-buttons[_ngcontent-%COMP%]{display:block}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%], [_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%], [_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .fav[_ngcontent-%COMP%]{background-color:var(--background-transparent);color:var(--on-background-highlight)}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], [_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], [_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .fav[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--on-background-highlight)}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, [_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, [_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .fav[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:var(--on-background)}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .footer-subline[_ngcontent-%COMP%]{display:block;font-size:.8em}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .footer-buttons[_ngcontent-%COMP%]{height:40px;padding-top:10px;white-space:nowrap}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .footer-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-bottom:5px;margin-right:5px}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .footer-buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{float:right;margin-right:5px}@media (max-width: 1600px){[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]{width:calc(25% - 30px)}}@media (max-width: 1200px){[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]{width:calc(33.3333333333% - 30px)}}@media (max-width: 522px){[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]{width:calc(50% - 30px)}}@media (max-width: 400px){[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]{margin:10px}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]{font-size:.8em}}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{min-height:135px;min-width:135px;display:flex;align-items:center;justify-content:center}']})),o})(),ho=(()=>{class o{}return(0,r.Z)(o,"\u0275fac",function(e){return new(e||o)}),(0,r.Z)(o,"\u0275mod",t.oAB({type:o})),(0,r.Z)(o,"\u0275inj",t.cJS({imports:[O.ez,dt.m,x.u5,tt.t6,rt.QG,et.vI,p.Cl,K.In,eo]})),o})();t.B6R(H,function(){return[C.H,k.lC,ro,so]},[]),t.B6R(Ht,function(){return[ht.p,po]},[])},529:(bt,X,v)=>{v.d(X,{VI:()=>H,Cb:()=>U,C6:()=>st,U_:()=>F,kQ:()=>k,RQ:()=>rt,f_:()=>t});var r=v(1180);function O(m,_){if(void 0===m&&void 0===_)throw new Error("Trying to compare two undefined values");if(void 0===m||void 0===_)return 0;const y=String(m),Z=String(_),A=function p(m,_){const y=[];let A,Z=0;for(let T=0;T<=_.length;T++)for(let R=0;R<=m.length;R++)A=T&&R?m.charAt(R-1)===_.charAt(T-1)?Z:Math.min(y[R],y[R-1],Z)+1:T+R,Z=y[R],y[R]=A;return y.pop()||0}(y,Z);return y.length>Z.length?1-A/y.length:1-A/Z.length}function tt(m,_){const y={};return function x(m,_){const Z=_||2,A=`-${m.toLowerCase().replace(/[^\w, ]+/,"")}-`,T=[];for(let R=0;R<A.length-Z+1;R+=1)T.push(A.slice(R,R+Z));return T}(m,_||2).forEach(A=>{A in y?y[A]+=1:y[A]=1}),y}function et(m){if("string"!=typeof m)throw new Error("Must use a string as argument to FuzzySet functions");return m.toLowerCase()}class dt{constructor(_,y,Z,A){(0,r.Z)(this,"version","0.0.1"),(0,r.Z)(this,"arr",void 0),(0,r.Z)(this,"useLevenshtein",void 0),(0,r.Z)(this,"gramSizeLower",void 0),(0,r.Z)(this,"gramSizeUpper",void 0),(0,r.Z)(this,"exactSet",{}),(0,r.Z)(this,"matchDict",{}),(0,r.Z)(this,"items",{}),this.arr=_||[],this.useLevenshtein=y||!0,this.gramSizeLower=Z||2,this.gramSizeUpper=A||3;for(let T=this.gramSizeLower;T<this.gramSizeUpper+1;T+=1)this.items[T]=[];this.arr.forEach(T=>{this.add(T)})}get(_,y){const Z=this.getVal(_);return!Z&&y?y:Z}add(_){if(!(et(_)in this.exactSet))for(let Z=this.gramSizeLower;Z<this.gramSizeUpper+1;Z+=1)this.addVal(_,Z)}length(){let _=0;for(const y in this.exactSet)Object.prototype.hasOwnProperty.call(this.exactSet,y)&&(_+=1);return _}isEmpty(){for(const _ in this.exactSet)if(Object.prototype.hasOwnProperty.call(this.exactSet,_))return!1;return!0}values(){const _=[];for(const y in this.exactSet)Object.prototype.hasOwnProperty.call(this.exactSet,y)&&_.push(this.exactSet[y]);return _}getVal(_){const y=et(_),Z=this.exactSet[y];if(Z)return[[1,Z]];for(let A=this.gramSizeUpper;A>=this.gramSizeLower;A-=1){const T=this.getValGram(_,A);if(T)return T}}getValGram(_,y){const Z=et(_),A={},T=tt(Z,y),R=this.items[y];let W,G=0;for(const c in T)if(Object.prototype.hasOwnProperty.call(T,c)){const d=T[c];if(G+=Math.pow(d,2),c in this.matchDict)for(const g of this.matchDict[c]){const u=g[0];W=g[1],u in A?A[u]+=d*W:A[u]=d*W}}if(function K(m){for(const _ in m)if(Object.prototype.hasOwnProperty.call(m,_))return!1;return!0}(A))return;const L=Math.sqrt(G);let C,J=[];Object.keys(A).forEach(c=>{C=A[c];const d=parseInt(c,10);J.push([C/(L*R[d][0]),R[d][1]])});const M=(c,d)=>c[0]<d[0]?1:c[0]>d[0]?-1:0;if(J.sort(M),this.useLevenshtein){const c=[],d=Math.min(50,J.length);for(let g=0;g<d;g+=1)c.push([O(J[g][1],Z),J[g][1]]);J=c,J.sort(M)}const s=[];for(const c of J)c[0]===J[0][0]&&s.push([c[0],this.exactSet[c[1]]]);return s}addVal(_,y){const Z=et(_),A=this.items[y]||[],T=A.length;A.push(0);const R=tt(Z,y);let G=0;for(const L in R)if(Object.prototype.hasOwnProperty.call(R,L)){const J=R[L];G+=Math.pow(J,2),L in this.matchDict?this.matchDict[L].push([T,J]):this.matchDict[L]=[[T,J]]}const W=Math.sqrt(G);A[T]=[W,Z],this.items[y]=A,this.exactSet[Z]=_}}function rt(m){return m.split(/[.,\\/ -]/).map(_=>_.trim()).filter(_=>_.length>0)}function t(m){return m.replace(/\.[^/.]+$/,"")}function H(m){return m.substring(m.lastIndexOf(".")+1,m.length)||m}function F(m,_){return _.includes(H(m))}function k(m,_){return m.toString().replace(/:/g," - ").replace(/[?/!\\]/g,_)}function U(m){if(!m)return 0;const y=t(m).split(/[ \-_.:;?!~,`"&|()<>{}[\]\r\n/\\]+/).map(Number).filter(Z=>!isNaN(Z));return y.length>0?y[0]:0}function st(m,_){const y=new dt;y.add(m);const Z=y.get(_);return Z?Z[0][0]:0}},2689:(bt,X,v)=>{function r(p){let O="";const x=new Uint8Array(p),tt=x.byteLength;for(let K=0;K<tt;K++)O+=String.fromCharCode(x[K]);return window.btoa(O)}v.d(X,{q:()=>r})},1208:(bt,X,v)=>{v.d(X,{Ll:()=>J,QG:()=>L,ap:()=>W});var r=v(5861),p=v(2223),O=v(6550),x=v(4755);const tt=["wrapper"],K=["sourceImage"];function et(C,M){if(1&C){const s=p.EpF();p.TgZ(0,"img",4,5),p.NdJ("load",function(){p.CHM(s);const d=p.oxw();return p.KtG(d.imageLoadedInView())})("mousedown",function(d){p.CHM(s);const g=p.oxw();return p.KtG(g.startMove(d,g.moveTypes.Drag))})("touchstart",function(d){p.CHM(s);const g=p.oxw();return p.KtG(g.startMove(d,g.moveTypes.Drag))}),p.qZA()}if(2&C){const s=p.oxw();p.Udp("visibility",s.imageVisible?"visible":"hidden")("transform",s.safeTransformStyle),p.ekj("ngx-ic-draggable",!s.disabled&&s.allowMoveImage),p.Q6J("src",s.safeImgDataUrl,p.LSH),p.uIk("alt",s.imageAltText)}}function dt(C,M){if(1&C){const s=p.EpF();p.ynx(0),p.TgZ(1,"span",9),p.NdJ("mousedown",function(d){p.CHM(s);const g=p.oxw(2);return p.KtG(g.startMove(d,g.moveTypes.Resize,"topleft"))})("touchstart",function(d){p.CHM(s);const g=p.oxw(2);return p.KtG(g.startMove(d,g.moveTypes.Resize,"topleft"))}),p._UZ(2,"span",10),p.qZA(),p.TgZ(3,"span",11),p._UZ(4,"span",10),p.qZA(),p.TgZ(5,"span",12),p.NdJ("mousedown",function(d){p.CHM(s);const g=p.oxw(2);return p.KtG(g.startMove(d,g.moveTypes.Resize,"topright"))})("touchstart",function(d){p.CHM(s);const g=p.oxw(2);return p.KtG(g.startMove(d,g.moveTypes.Resize,"topright"))}),p._UZ(6,"span",10),p.qZA(),p.TgZ(7,"span",13),p._UZ(8,"span",10),p.qZA(),p.TgZ(9,"span",14),p.NdJ("mousedown",function(d){p.CHM(s);const g=p.oxw(2);return p.KtG(g.startMove(d,g.moveTypes.Resize,"bottomright"))})("touchstart",function(d){p.CHM(s);const g=p.oxw(2);return p.KtG(g.startMove(d,g.moveTypes.Resize,"bottomright"))}),p._UZ(10,"span",10),p.qZA(),p.TgZ(11,"span",15),p._UZ(12,"span",10),p.qZA(),p.TgZ(13,"span",16),p.NdJ("mousedown",function(d){p.CHM(s);const g=p.oxw(2);return p.KtG(g.startMove(d,g.moveTypes.Resize,"bottomleft"))})("touchstart",function(d){p.CHM(s);const g=p.oxw(2);return p.KtG(g.startMove(d,g.moveTypes.Resize,"bottomleft"))}),p._UZ(14,"span",10),p.qZA(),p.TgZ(15,"span",17),p._UZ(16,"span",10),p.qZA(),p.TgZ(17,"span",18),p.NdJ("mousedown",function(d){p.CHM(s);const g=p.oxw(2);return p.KtG(g.startMove(d,g.moveTypes.Resize,"top"))})("touchstart",function(d){p.CHM(s);const g=p.oxw(2);return p.KtG(g.startMove(d,g.moveTypes.Resize,"top"))}),p.qZA(),p.TgZ(18,"span",19),p.NdJ("mousedown",function(d){p.CHM(s);const g=p.oxw(2);return p.KtG(g.startMove(d,g.moveTypes.Resize,"right"))})("touchstart",function(d){p.CHM(s);const g=p.oxw(2);return p.KtG(g.startMove(d,g.moveTypes.Resize,"right"))}),p.qZA(),p.TgZ(19,"span",20),p.NdJ("mousedown",function(d){p.CHM(s);const g=p.oxw(2);return p.KtG(g.startMove(d,g.moveTypes.Resize,"bottom"))})("touchstart",function(d){p.CHM(s);const g=p.oxw(2);return p.KtG(g.startMove(d,g.moveTypes.Resize,"bottom"))}),p.qZA(),p.TgZ(20,"span",21),p.NdJ("mousedown",function(d){p.CHM(s);const g=p.oxw(2);return p.KtG(g.startMove(d,g.moveTypes.Resize,"left"))})("touchstart",function(d){p.CHM(s);const g=p.oxw(2);return p.KtG(g.startMove(d,g.moveTypes.Resize,"left"))}),p.qZA(),p.BQk()}}function rt(C,M){if(1&C){const s=p.EpF();p.TgZ(0,"div",6),p.NdJ("keydown",function(d){p.CHM(s);const g=p.oxw();return p.KtG(g.keyboardAccess(d))}),p.TgZ(1,"div",7),p.NdJ("mousedown",function(d){p.CHM(s);const g=p.oxw();return p.KtG(g.startMove(d,g.moveTypes.Move))})("touchstart",function(d){p.CHM(s);const g=p.oxw();return p.KtG(g.startMove(d,g.moveTypes.Move))}),p.qZA(),p.YNc(2,dt,21,0,"ng-container",8),p.qZA()}if(2&C){const s=p.oxw();p.Udp("top",s.cropper.y1,"px")("left",s.cropper.x1,"px")("width",s.cropper.x2-s.cropper.x1,"px")("height",s.cropper.y2-s.cropper.y1,"px")("margin-left","center"===s.alignImage?s.marginLeft:null)("visibility",s.imageVisible?"visible":"hidden"),p.ekj("ngx-ic-round",s.roundCropper),p.xp6(2),p.Q6J("ngIf",!s.hideResizeSquares)}}class t{constructor(){this.format="png",this.maintainAspectRatio=!0,this.transform={},this.aspectRatio=1,this.resetCropOnAspectRatioChange=!0,this.resizeToWidth=0,this.resizeToHeight=0,this.cropperMinWidth=0,this.cropperMinHeight=0,this.cropperMaxHeight=0,this.cropperMaxWidth=0,this.cropperStaticWidth=0,this.cropperStaticHeight=0,this.canvasRotation=0,this.initialStepSize=3,this.roundCropper=!1,this.onlyScaleDown=!1,this.imageQuality=92,this.autoCrop=!0,this.backgroundColor=null,this.containWithinAspectRatio=!1,this.hideResizeSquares=!1,this.alignImage="center",this.cropperScaledMinWidth=20,this.cropperScaledMinHeight=20,this.cropperScaledMaxWidth=20,this.cropperScaledMaxHeight=20,this.stepSize=this.initialStepSize}setOptions(M){Object.keys(M).filter(s=>s in this).forEach(s=>this[s]=M[s]),this.validateOptions()}setOptionsFromChanges(M){Object.keys(M).filter(s=>s in this).forEach(s=>this[s]=M[s].currentValue),this.validateOptions()}validateOptions(){if(this.maintainAspectRatio&&!this.aspectRatio)throw new Error("`aspectRatio` should > 0 when `maintainAspectRatio` is enabled")}}var H=(()=>((H=H||{}).Drag="drag",H.Move="move",H.Resize="resize",H.Pinch="pinch",H))();function st(C,M){return C/100*M}let m=(()=>{class C{crop(s,c,d,g){const u=this.getImagePosition(s,c,d,g),f=u.x2-u.x1,w=u.y2-u.y1,I=document.createElement("canvas");I.width=f,I.height=w;const S=I.getContext("2d");if(!S)return null;null!=g.backgroundColor&&(S.fillStyle=g.backgroundColor,S.fillRect(0,0,f,w));const P=(g.transform.scale||1)*(g.transform.flipH?-1:1),B=(g.transform.scale||1)*(g.transform.flipV?-1:1),{translateH:nt,translateV:j}=this.getCanvasTranslate(s,c,g),E=c.transformed;S.setTransform(P,0,0,B,E.size.width/2+nt,E.size.height/2+j),S.translate(-u.x1/P,-u.y1/B),S.rotate((g.transform.rotate||0)*Math.PI/180),S.drawImage(E.image,-E.size.width/2,-E.size.height/2);const q={width:f,height:w,imagePosition:u,cropperPosition:{...d}};g.containWithinAspectRatio&&(q.offsetImagePosition=this.getOffsetImagePosition(s,c,d,g));const z=this.getResizeRatio(f,w,g);return 1!==z&&(q.width=Math.round(f*z),q.height=g.maintainAspectRatio?Math.round(q.width/g.aspectRatio):Math.round(w*z),function U(C,M,s){const c=C.width,d=C.height,g=c/(M=Math.round(M)),u=d/(s=Math.round(s)),f=Math.ceil(g/2),w=Math.ceil(u/2),I=C.getContext("2d");if(I){const S=I.getImageData(0,0,c,d),P=I.createImageData(M,s),B=S.data,nt=P.data;for(let j=0;j<s;j++)for(let E=0;E<M;E++){const q=4*(E+j*M),z=j*u;let Q=0,Y=0,_t=0,mt=0,ft=0,Ct=0,xt=0;const yt=Math.floor(E*g),wt=Math.floor(j*u);let gt=Math.ceil((E+1)*g),pt=Math.ceil((j+1)*u);gt=Math.min(gt,c),pt=Math.min(pt,d);for(let ct=wt;ct<pt;ct++){const Mt=Math.abs(z-ct)/w,Zt=E*g,$=Mt*Mt;for(let lt=yt;lt<gt;lt++){const vt=Math.abs(Zt-lt)/f,ot=Math.sqrt($+vt*vt);if(ot>=1)continue;Q=2*ot*ot*ot-3*ot*ot+1;const it=4*(lt+ct*c);xt+=Q*B[it+3],_t+=Q,B[it+3]<255&&(Q=Q*B[it+3]/250),mt+=Q*B[it],ft+=Q*B[it+1],Ct+=Q*B[it+2],Y+=Q}}nt[q]=mt/Y,nt[q+1]=ft/Y,nt[q+2]=Ct/Y,nt[q+3]=xt/_t}C.width=M,C.height=s,I.putImageData(P,0,0)}}(I,q.width,q.height)),q.base64=I.toDataURL("image/"+g.format,this.getQuality(g)),q}getCanvasTranslate(s,c,d){if("px"===d.transform.translateUnit){const g=this.getRatio(s,c);return{translateH:(d.transform.translateH||0)*g,translateV:(d.transform.translateV||0)*g}}return{translateH:d.transform.translateH?st(d.transform.translateH,c.transformed.size.width):0,translateV:d.transform.translateV?st(d.transform.translateV,c.transformed.size.height):0}}getRatio(s,c){return c.transformed.size.width/s.nativeElement.offsetWidth}getImagePosition(s,c,d,g){const u=this.getRatio(s,c),f={x1:Math.round(d.x1*u),y1:Math.round(d.y1*u),x2:Math.round(d.x2*u),y2:Math.round(d.y2*u)};return g.containWithinAspectRatio||(f.x1=Math.max(f.x1,0),f.y1=Math.max(f.y1,0),f.x2=Math.min(f.x2,c.transformed.size.width),f.y2=Math.min(f.y2,c.transformed.size.height)),f}getOffsetImagePosition(s,c,d,g){const w=c.transformed.size.width/s.nativeElement.offsetWidth;let I,S;(g.canvasRotation+c.exifTransform.rotate)%2?(I=(c.transformed.size.width-c.original.size.height)/2,S=(c.transformed.size.height-c.original.size.width)/2):(I=(c.transformed.size.width-c.original.size.width)/2,S=(c.transformed.size.height-c.original.size.height)/2);const P={x1:Math.round(d.x1*w)-I,y1:Math.round(d.y1*w)-S,x2:Math.round(d.x2*w)-I,y2:Math.round(d.y2*w)-S};return g.containWithinAspectRatio||(P.x1=Math.max(P.x1,0),P.y1=Math.max(P.y1,0),P.x2=Math.min(P.x2,c.transformed.size.width),P.y2=Math.min(P.y2,c.transformed.size.height)),P}getResizeRatio(s,c,d){const g=d.resizeToWidth/s,u=d.resizeToHeight/c,f=new Array;d.resizeToWidth>0&&f.push(g),d.resizeToHeight>0&&f.push(u);const w=0===f.length?1:Math.min(...f);return w>1&&!d.onlyScaleDown?w:Math.min(w,1)}getQuality(s){return Math.min(1,Math.max(0,s.imageQuality/100))}}return C.\u0275fac=function(s){return new(s||C)},C.\u0275prov=p.Yz7({token:C,factory:C.\u0275fac,providedIn:"root"}),C})(),_=(()=>{class C{resetCropperPosition(s,c,d){if(!s?.nativeElement)return;const g=s.nativeElement;if(d.cropperStaticHeight&&d.cropperStaticWidth)c.x1=0,c.x2=g.offsetWidth>d.cropperStaticWidth?d.cropperStaticWidth:g.offsetWidth,c.y1=0,c.y2=g.offsetHeight>d.cropperStaticHeight?d.cropperStaticHeight:g.offsetHeight;else{const u=Math.min(d.cropperScaledMaxWidth,g.offsetWidth),f=Math.min(d.cropperScaledMaxHeight,g.offsetHeight);if(d.maintainAspectRatio)if(g.offsetWidth/d.aspectRatio<g.offsetHeight){c.x1=0,c.x2=u;const w=u/d.aspectRatio;c.y1=(g.offsetHeight-w)/2,c.y2=c.y1+w}else{c.y1=0,c.y2=f;const w=f*d.aspectRatio;c.x1=(g.offsetWidth-w)/2,c.x2=c.x1+w}else c.x1=0,c.x2=u,c.y1=0,c.y2=f}}move(s,c,d){const g=this.getClientX(s)-c.clientX,u=this.getClientY(s)-c.clientY;d.x1=c.x1+g,d.y1=c.y1+u,d.x2=c.x2+g,d.y2=c.y2+u}resize(s,c,d,g,u){const f=this.getClientX(s)-c.clientX,w=this.getClientY(s)-c.clientY;switch(c.position){case"left":d.x1=Math.min(Math.max(c.x1+f,d.x2-u.cropperScaledMaxWidth),d.x2-u.cropperScaledMinWidth);break;case"topleft":d.x1=Math.min(Math.max(c.x1+f,d.x2-u.cropperScaledMaxWidth),d.x2-u.cropperScaledMinWidth),d.y1=Math.min(Math.max(c.y1+w,d.y2-u.cropperScaledMaxHeight),d.y2-u.cropperScaledMinHeight);break;case"top":d.y1=Math.min(Math.max(c.y1+w,d.y2-u.cropperScaledMaxHeight),d.y2-u.cropperScaledMinHeight);break;case"topright":d.x2=Math.max(Math.min(c.x2+f,d.x1+u.cropperScaledMaxWidth),d.x1+u.cropperScaledMinWidth),d.y1=Math.min(Math.max(c.y1+w,d.y2-u.cropperScaledMaxHeight),d.y2-u.cropperScaledMinHeight);break;case"right":d.x2=Math.max(Math.min(c.x2+f,d.x1+u.cropperScaledMaxWidth),d.x1+u.cropperScaledMinWidth);break;case"bottomright":d.x2=Math.max(Math.min(c.x2+f,d.x1+u.cropperScaledMaxWidth),d.x1+u.cropperScaledMinWidth),d.y2=Math.max(Math.min(c.y2+w,d.y1+u.cropperScaledMaxHeight),d.y1+u.cropperScaledMinHeight);break;case"bottom":d.y2=Math.max(Math.min(c.y2+w,d.y1+u.cropperScaledMaxHeight),d.y1+u.cropperScaledMinHeight);break;case"bottomleft":d.x1=Math.min(Math.max(c.x1+f,d.x2-u.cropperScaledMaxWidth),d.x2-u.cropperScaledMinWidth),d.y2=Math.max(Math.min(c.y2+w,d.y1+u.cropperScaledMaxHeight),d.y1+u.cropperScaledMinHeight);break;case"center":const I=s.scale,S=Math.min(Math.max(u.cropperScaledMinWidth,Math.abs(c.x2-c.x1)*I),u.cropperScaledMaxWidth),P=Math.min(Math.max(u.cropperScaledMinHeight,Math.abs(c.y2-c.y1)*I),u.cropperScaledMaxHeight);d.x1=c.clientX-S/2,d.x2=c.clientX+S/2,d.y1=c.clientY-P/2,d.y2=c.clientY+P/2,d.x1<0?(d.x2-=d.x1,d.x1=0):d.x2>g.width&&(d.x1-=d.x2-g.width,d.x2=g.width),d.y1<0?(d.y2-=d.y1,d.y1=0):d.y2>g.height&&(d.y1-=d.y2-g.height,d.y2=g.height)}u.maintainAspectRatio&&this.checkAspectRatio(c.position,d,g,u)}checkAspectRatio(s,c,d,g){let u=0,f=0;switch(s){case"top":c.x2=c.x1+(c.y2-c.y1)*g.aspectRatio,u=Math.max(c.x2-d.width,0),f=Math.max(0-c.y1,0),(u>0||f>0)&&(c.x2-=f*g.aspectRatio>u?f*g.aspectRatio:u,c.y1+=f*g.aspectRatio>u?f:u/g.aspectRatio);break;case"bottom":c.x2=c.x1+(c.y2-c.y1)*g.aspectRatio,u=Math.max(c.x2-d.width,0),f=Math.max(c.y2-d.height,0),(u>0||f>0)&&(c.x2-=f*g.aspectRatio>u?f*g.aspectRatio:u,c.y2-=f*g.aspectRatio>u?f:u/g.aspectRatio);break;case"topleft":c.y1=c.y2-(c.x2-c.x1)/g.aspectRatio,u=Math.max(0-c.x1,0),f=Math.max(0-c.y1,0),(u>0||f>0)&&(c.x1+=f*g.aspectRatio>u?f*g.aspectRatio:u,c.y1+=f*g.aspectRatio>u?f:u/g.aspectRatio);break;case"topright":c.y1=c.y2-(c.x2-c.x1)/g.aspectRatio,u=Math.max(c.x2-d.width,0),f=Math.max(0-c.y1,0),(u>0||f>0)&&(c.x2-=f*g.aspectRatio>u?f*g.aspectRatio:u,c.y1+=f*g.aspectRatio>u?f:u/g.aspectRatio);break;case"right":case"bottomright":c.y2=c.y1+(c.x2-c.x1)/g.aspectRatio,u=Math.max(c.x2-d.width,0),f=Math.max(c.y2-d.height,0),(u>0||f>0)&&(c.x2-=f*g.aspectRatio>u?f*g.aspectRatio:u,c.y2-=f*g.aspectRatio>u?f:u/g.aspectRatio);break;case"left":case"bottomleft":c.y2=c.y1+(c.x2-c.x1)/g.aspectRatio,u=Math.max(0-c.x1,0),f=Math.max(c.y2-d.height,0),(u>0||f>0)&&(c.x1+=f*g.aspectRatio>u?f*g.aspectRatio:u,c.y2-=f*g.aspectRatio>u?f:u/g.aspectRatio);break;case"center":c.x2=c.x1+(c.y2-c.y1)*g.aspectRatio,c.y2=c.y1+(c.x2-c.x1)/g.aspectRatio;const w=Math.max(0-c.x1,0),I=Math.max(c.x2-d.width,0),S=Math.max(c.y2-d.height,0),P=Math.max(0-c.y1,0);(w>0||I>0||S>0||P>0)&&(c.x1+=S*g.aspectRatio>w?S*g.aspectRatio:w,c.x2-=P*g.aspectRatio>I?P*g.aspectRatio:I,c.y1+=P*g.aspectRatio>I?P:I/g.aspectRatio,c.y2-=S*g.aspectRatio>w?S:w/g.aspectRatio)}}getClientX(s){return s.touches?.[0].clientX||s.clientX||0}getClientY(s){return s.touches?.[0].clientY||s.clientY||0}}return C.\u0275fac=function(s){return new(s||C)},C.\u0275prov=p.Yz7({token:C,factory:C.\u0275fac,providedIn:"root"}),C})();let G=(()=>{class C{constructor(){this.autoRotateSupported=function Z(){return new Promise(C=>{const M=new Image;M.onload=()=>{C(1===M.width&&2===M.height)},M.src="data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAEAAgMBEQACEQEDEQH/xABKAAEAAAAAAAAAAAAAAAAAAAALEAEAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAAAAAAAAAAAAAAAEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwA/8H//2Q=="})}()}loadImageFile(s,c){return new Promise((d,g)=>{const u=new FileReader;u.onload=f=>{this.loadImage(f.target.result,s.type,c).then(d).catch(g)},u.readAsDataURL(s)})}loadImage(s,c,d){return this.isValidImageType(c)?this.loadBase64Image(s,d):Promise.reject(new Error("Invalid image type"))}isValidImageType(s){return/image\/(png|jpg|jpeg|bmp|gif|tiff|webp|x-icon|vnd.microsoft.icon)/.test(s)}loadImageFromURL(s,c){return new Promise((d,g)=>{const u=new Image;u.onerror=()=>g,u.onload=()=>{const f=document.createElement("canvas"),w=f.getContext("2d");f.width=u.width,f.height=u.height,w?.drawImage(u,0,0),this.loadBase64Image(f.toDataURL(),c).then(d)},u.crossOrigin="anonymous",u.src=s})}loadBase64Image(s,c){return new Promise((d,g)=>{const u=new Image;u.onload=()=>d({originalImage:u,originalBase64:s}),u.onerror=g,u.src=s}).then(d=>this.transformImageBase64(d,c))}transformImageBase64(s,c){var d=this;return(0,r.Z)(function*(){const g=yield d.autoRotateSupported,u=yield function A(C){switch("string"==typeof C&&(C=function T(C){const M=new DataView(function R(C){C=C.replace(/^data\:([^\;]+)\;base64,/gim,"");const M=atob(C),s=M.length,c=new Uint8Array(s);for(let d=0;d<s;d++)c[d]=M.charCodeAt(d);return c.buffer}(C));if(65496!==M.getUint16(0,!1))return-2;const s=M.byteLength;let c=2;for(;c<s;){if(M.getUint16(c+2,!1)<=8)return-1;const d=M.getUint16(c,!1);if(c+=2,65505==d){if(1165519206!==M.getUint32(c+=2,!1))return-1;const g=18761==M.getUint16(c+=6,!1);c+=M.getUint32(c+4,g);const u=M.getUint16(c,g);c+=2;for(let f=0;f<u;f++)if(274==M.getUint16(c+12*f,g))return M.getUint16(c+12*f+8,g)}else{if(65280!=(65280&d))break;c+=M.getUint16(c,!1)}}return-1}(C)),C){case 2:return{rotate:0,flip:!0};case 3:return{rotate:2,flip:!1};case 4:return{rotate:2,flip:!0};case 5:return{rotate:1,flip:!0};case 6:return{rotate:1,flip:!1};case 7:return{rotate:3,flip:!0};case 8:return{rotate:3,flip:!1};default:return{rotate:0,flip:!1}}}(g?-1:s.originalBase64);return s.originalImage&&s.originalImage.complete?d.transformLoadedImage({original:{base64:s.originalBase64,image:s.originalImage,size:{width:s.originalImage.naturalWidth,height:s.originalImage.naturalHeight}},exifTransform:u},c):Promise.reject(new Error("No image loaded"))})()}transformLoadedImage(s,c){var d=this;return(0,r.Z)(function*(){const g=c.canvasRotation+s.exifTransform.rotate,u={width:s.original.image.naturalWidth,height:s.original.image.naturalHeight};if(0===g&&!s.exifTransform.flip&&!c.containWithinAspectRatio)return{original:{base64:s.original.base64,image:s.original.image,size:{...u}},transformed:{base64:s.original.base64,image:s.original.image,size:{...u}},exifTransform:s.exifTransform};const f=d.getTransformedSize(u,s.exifTransform,c),w=document.createElement("canvas");w.width=f.width,w.height=f.height;const I=w.getContext("2d");I?.setTransform(s.exifTransform.flip?-1:1,0,0,1,w.width/2,w.height/2),I?.rotate(Math.PI*(g/2)),I?.drawImage(s.original.image,-u.width/2,-u.height/2);const S=w.toDataURL(),P=yield d.loadImageFromBase64(S);return{original:{base64:s.original.base64,image:s.original.image,size:{...u}},transformed:{base64:S,image:P,size:{width:P.width,height:P.height}},exifTransform:s.exifTransform}})()}loadImageFromBase64(s){return new Promise((c,d)=>{const g=new Image;g.onload=()=>c(g),g.onerror=d,g.src=s})}getTransformedSize(s,c,d){const g=d.canvasRotation+c.rotate;if(d.containWithinAspectRatio){if(g%2){const f=s.height/d.aspectRatio;return{width:Math.max(s.height,s.width*d.aspectRatio),height:Math.max(s.width,f)}}{const f=s.width/d.aspectRatio;return{width:Math.max(s.width,s.height*d.aspectRatio),height:Math.max(s.height,f)}}}return g%2?{height:s.width,width:s.height}:{width:s.width,height:s.height}}}return C.\u0275fac=function(s){return new(s||C)},C.\u0275prov=p.Yz7({token:C,factory:C.\u0275fac,providedIn:"root"}),C})(),W=(()=>{class C{constructor(s,c,d,g,u){this.cropService=s,this.cropperPositionService=c,this.loadImageService=d,this.sanitizer=g,this.cd=u,this.Hammer=window?.Hammer||null,this.settings=new t,this.setImageMaxSizeRetries=0,this.resizedWhileHidden=!1,this.marginLeft="0px",this.maxSize={width:0,height:0},this.moveTypes=H,this.imageVisible=!1,this.format=this.settings.format,this.transform={},this.maintainAspectRatio=this.settings.maintainAspectRatio,this.aspectRatio=this.settings.aspectRatio,this.resetCropOnAspectRatioChange=this.settings.resetCropOnAspectRatioChange,this.resizeToWidth=this.settings.resizeToWidth,this.resizeToHeight=this.settings.resizeToHeight,this.cropperMinWidth=this.settings.cropperMinWidth,this.cropperMinHeight=this.settings.cropperMinHeight,this.cropperMaxHeight=this.settings.cropperMaxHeight,this.cropperMaxWidth=this.settings.cropperMaxWidth,this.cropperStaticWidth=this.settings.cropperStaticWidth,this.cropperStaticHeight=this.settings.cropperStaticHeight,this.canvasRotation=this.settings.canvasRotation,this.initialStepSize=this.settings.initialStepSize,this.roundCropper=this.settings.roundCropper,this.onlyScaleDown=this.settings.onlyScaleDown,this.imageQuality=this.settings.imageQuality,this.autoCrop=this.settings.autoCrop,this.backgroundColor=this.settings.backgroundColor,this.containWithinAspectRatio=this.settings.containWithinAspectRatio,this.hideResizeSquares=this.settings.hideResizeSquares,this.allowMoveImage=!1,this.cropper={x1:-100,y1:-100,x2:1e4,y2:1e4},this.alignImage=this.settings.alignImage,this.disabled=!1,this.hidden=!1,this.imageCropped=new p.vpe,this.startCropImage=new p.vpe,this.imageLoaded=new p.vpe,this.cropperReady=new p.vpe,this.loadImageFailed=new p.vpe,this.transformChange=new p.vpe,this.reset()}ngOnChanges(s){this.onChangesUpdateSettings(s),this.onChangesInputImage(s),this.loadedImage?.original.image.complete&&(s.containWithinAspectRatio||s.canvasRotation)&&this.loadImageService.transformLoadedImage(this.loadedImage,this.settings).then(c=>this.setLoadedImage(c)).catch(c=>this.loadImageError(c)),(s.cropper||s.maintainAspectRatio||s.aspectRatio)&&(this.setMaxSize(),this.setCropperScaledMinSize(),this.setCropperScaledMaxSize(),!this.maintainAspectRatio||!this.resetCropOnAspectRatioChange&&this.aspectRatioIsCorrect()||!s.maintainAspectRatio&&!s.aspectRatio?s.cropper&&(this.checkCropperPosition(!1),this.doAutoCrop()):this.resetCropperPosition(),this.cd.markForCheck()),s.transform&&(this.transform=this.transform||{},this.setCssTransform(),this.doAutoCrop(),this.cd.markForCheck()),s.hidden&&this.resizedWhileHidden&&!this.hidden&&setTimeout(()=>{this.onResize(),this.resizedWhileHidden=!1})}onChangesUpdateSettings(s){this.settings.setOptionsFromChanges(s),this.settings.cropperStaticHeight&&this.settings.cropperStaticWidth&&this.settings.setOptions({hideResizeSquares:!0,cropperMinWidth:this.settings.cropperStaticWidth,cropperMinHeight:this.settings.cropperStaticHeight,cropperMaxHeight:this.settings.cropperStaticHeight,cropperMaxWidth:this.settings.cropperStaticWidth,maintainAspectRatio:!1})}onChangesInputImage(s){(s.imageChangedEvent||s.imageURL||s.imageBase64||s.imageFile)&&this.reset(),s.imageChangedEvent&&this.isValidImageChangedEvent()&&this.loadImageFile(this.imageChangedEvent.target.files[0]),s.imageURL&&this.imageURL&&this.loadImageFromURL(this.imageURL),s.imageBase64&&this.imageBase64&&this.loadBase64Image(this.imageBase64),s.imageFile&&this.imageFile&&this.loadImageFile(this.imageFile)}isValidImageChangedEvent(){return this.imageChangedEvent?.target?.files?.length>0}setCssTransform(){const s=this.transform?.translateUnit||"%";this.safeTransformStyle=this.sanitizer.bypassSecurityTrustStyle(`translate(${this.transform.translateH||0}${s}, ${this.transform.translateV||0}${s}) scaleX(`+(this.transform.scale||1)*(this.transform.flipH?-1:1)+") scaleY("+(this.transform.scale||1)*(this.transform.flipV?-1:1)+") rotate("+(this.transform.rotate||0)+"deg)")}ngOnInit(){this.settings.stepSize=this.initialStepSize,this.activatePinchGesture()}reset(){this.imageVisible=!1,this.loadedImage=void 0,this.safeImgDataUrl="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=",this.moveStart={active:!1,type:null,position:null,x1:0,y1:0,x2:0,y2:0,clientX:0,clientY:0},this.maxSize={width:0,height:0},this.cropper.x1=-100,this.cropper.y1=-100,this.cropper.x2=1e4,this.cropper.y2=1e4}loadImageFile(s){this.loadImageService.loadImageFile(s,this.settings).then(c=>this.setLoadedImage(c)).catch(c=>this.loadImageError(c))}loadBase64Image(s){this.loadImageService.loadBase64Image(s,this.settings).then(c=>this.setLoadedImage(c)).catch(c=>this.loadImageError(c))}loadImageFromURL(s){this.loadImageService.loadImageFromURL(s,this.settings).then(c=>this.setLoadedImage(c)).catch(c=>this.loadImageError(c))}setLoadedImage(s){this.loadedImage=s,this.safeImgDataUrl=this.sanitizer.bypassSecurityTrustResourceUrl(s.transformed.base64),this.cd.markForCheck()}loadImageError(s){console.error(s),this.loadImageFailed.emit()}imageLoadedInView(){null!=this.loadedImage&&(this.imageLoaded.emit(this.loadedImage),this.setImageMaxSizeRetries=0,setTimeout(()=>this.checkImageMaxSizeRecursively()))}checkImageMaxSizeRecursively(){this.setImageMaxSizeRetries>40?this.loadImageFailed.emit():this.sourceImageLoaded()?(this.setMaxSize(),this.setCropperScaledMinSize(),this.setCropperScaledMaxSize(),this.resetCropperPosition(),this.cropperReady.emit({...this.maxSize}),this.cd.markForCheck()):(this.setImageMaxSizeRetries++,setTimeout(()=>this.checkImageMaxSizeRecursively(),50))}sourceImageLoaded(){return this.sourceImage?.nativeElement?.offsetWidth>0}onResize(){this.loadedImage&&(this.hidden?this.resizedWhileHidden=!0:(this.resizeCropperPosition(),this.setMaxSize(),this.setCropperScaledMinSize(),this.setCropperScaledMaxSize()))}activatePinchGesture(){if(this.Hammer){const s=new this.Hammer(this.wrapper.nativeElement);s.get("pinch").set({enable:!0}),s.on("pinchmove",this.onPinch.bind(this)),s.on("pinchend",this.pinchStop.bind(this)),s.on("pinchstart",this.startPinch.bind(this))}else(0,p.X6Q)()&&console.warn("[NgxImageCropper] Could not find HammerJS - Pinch Gesture won't work")}resizeCropperPosition(){const s=this.sourceImage.nativeElement;(this.maxSize.width!==s.offsetWidth||this.maxSize.height!==s.offsetHeight)&&(this.cropper.x1=this.cropper.x1*s.offsetWidth/this.maxSize.width,this.cropper.x2=this.cropper.x2*s.offsetWidth/this.maxSize.width,this.cropper.y1=this.cropper.y1*s.offsetHeight/this.maxSize.height,this.cropper.y2=this.cropper.y2*s.offsetHeight/this.maxSize.height)}resetCropperPosition(){this.cropperPositionService.resetCropperPosition(this.sourceImage,this.cropper,this.settings),this.doAutoCrop(),this.imageVisible=!0}keyboardAccess(s){this.changeKeyboardStepSize(s),this.keyboardMoveCropper(s)}changeKeyboardStepSize(s){const c=+s.key;c>=1&&c<=9&&(this.settings.stepSize=c)}keyboardMoveCropper(s){if(!["ArrowUp","ArrowDown","ArrowRight","ArrowLeft"].includes(s.key))return;const d=s.shiftKey?H.Resize:H.Move,g=s.altKey?function k(C){switch(C){case"ArrowUp":return"bottom";case"ArrowRight":return"left";case"ArrowDown":return"top";default:return"right"}}(s.key):function F(C){switch(C){case"ArrowUp":return"top";case"ArrowRight":return"right";case"ArrowDown":return"bottom";default:return"left"}}(s.key),u=function N(C,M){switch(C){case"ArrowUp":return{clientX:0,clientY:-1*M};case"ArrowRight":return{clientX:M,clientY:0};case"ArrowDown":return{clientX:0,clientY:M};default:return{clientX:-1*M,clientY:0}}}(s.key,this.settings.stepSize);s.preventDefault(),s.stopPropagation(),this.startMove({clientX:0,clientY:0},d,g),this.moveImg(u),this.moveStop()}startMove(s,c,d=null){this.disabled||this.moveStart?.active&&this.moveStart?.type===H.Pinch||c===H.Drag&&!this.allowMoveImage||(s.preventDefault&&s.preventDefault(),this.moveStart={active:!0,type:c,position:d,transform:{...this.transform},clientX:this.cropperPositionService.getClientX(s),clientY:this.cropperPositionService.getClientY(s),...this.cropper})}startPinch(s){this.safeImgDataUrl&&(s.preventDefault&&s.preventDefault(),this.moveStart={active:!0,type:H.Pinch,position:"center",clientX:this.cropper.x1+(this.cropper.x2-this.cropper.x1)/2,clientY:this.cropper.y1+(this.cropper.y2-this.cropper.y1)/2,...this.cropper})}moveImg(s){if(this.moveStart.active){if(s.stopPropagation&&s.stopPropagation(),s.preventDefault&&s.preventDefault(),this.moveStart.type===H.Move)this.cropperPositionService.move(s,this.moveStart,this.cropper),this.checkCropperPosition(!0);else if(this.moveStart.type===H.Resize)!this.cropperStaticWidth&&!this.cropperStaticHeight&&this.cropperPositionService.resize(s,this.moveStart,this.cropper,this.maxSize,this.settings),this.checkCropperPosition(!1);else if(this.moveStart.type===H.Drag){const c=this.cropperPositionService.getClientX(s)-this.moveStart.clientX,d=this.cropperPositionService.getClientY(s)-this.moveStart.clientY;this.transform={...this.transform,translateH:(this.moveStart.transform?.translateH||0)+c,translateV:(this.moveStart.transform?.translateV||0)+d},this.setCssTransform()}this.cd.detectChanges()}}onPinch(s){this.moveStart.active&&(s.stopPropagation&&s.stopPropagation(),s.preventDefault&&s.preventDefault(),this.moveStart.type===H.Pinch&&(this.cropperPositionService.resize(s,this.moveStart,this.cropper,this.maxSize,this.settings),this.checkCropperPosition(!1)),this.cd.detectChanges())}setMaxSize(){if(this.sourceImage){const s=this.sourceImage.nativeElement;this.maxSize.width=s.offsetWidth,this.maxSize.height=s.offsetHeight,this.marginLeft=this.sanitizer.bypassSecurityTrustStyle("calc(50% - "+this.maxSize.width/2+"px)")}}setCropperScaledMinSize(){this.loadedImage?.transformed?.image?(this.setCropperScaledMinWidth(),this.setCropperScaledMinHeight()):(this.settings.cropperScaledMinWidth=20,this.settings.cropperScaledMinHeight=20)}setCropperScaledMinWidth(){this.settings.cropperScaledMinWidth=this.cropperMinWidth>0?Math.max(20,this.cropperMinWidth/this.loadedImage.transformed.image.width*this.maxSize.width):20}setCropperScaledMinHeight(){this.settings.cropperScaledMinHeight=this.maintainAspectRatio?Math.max(20,this.settings.cropperScaledMinWidth/this.aspectRatio):this.cropperMinHeight>0?Math.max(20,this.cropperMinHeight/this.loadedImage.transformed.image.height*this.maxSize.height):20}setCropperScaledMaxSize(){if(this.loadedImage?.transformed?.image){const s=this.loadedImage.transformed.size.width/this.maxSize.width;this.settings.cropperScaledMaxWidth=this.cropperMaxWidth>20?this.cropperMaxWidth/s:this.maxSize.width,this.settings.cropperScaledMaxHeight=this.cropperMaxHeight>20?this.cropperMaxHeight/s:this.maxSize.height,this.maintainAspectRatio&&(this.settings.cropperScaledMaxWidth>this.settings.cropperScaledMaxHeight*this.aspectRatio?this.settings.cropperScaledMaxWidth=this.settings.cropperScaledMaxHeight*this.aspectRatio:this.settings.cropperScaledMaxWidth<this.settings.cropperScaledMaxHeight*this.aspectRatio&&(this.settings.cropperScaledMaxHeight=this.settings.cropperScaledMaxWidth/this.aspectRatio))}else this.settings.cropperScaledMaxWidth=this.maxSize.width,this.settings.cropperScaledMaxHeight=this.maxSize.height}checkCropperPosition(s=!1){this.cropper.x1<0&&(this.cropper.x2-=s?this.cropper.x1:0,this.cropper.x1=0),this.cropper.y1<0&&(this.cropper.y2-=s?this.cropper.y1:0,this.cropper.y1=0),this.cropper.x2>this.maxSize.width&&(this.cropper.x1-=s?this.cropper.x2-this.maxSize.width:0,this.cropper.x2=this.maxSize.width),this.cropper.y2>this.maxSize.height&&(this.cropper.y1-=s?this.cropper.y2-this.maxSize.height:0,this.cropper.y2=this.maxSize.height)}moveStop(){this.moveStart.active&&(this.moveStart.active=!1,this.moveStart?.type===H.Drag?this.transformChange.emit(this.transform):this.doAutoCrop())}pinchStop(){this.moveStart.active&&(this.moveStart.active=!1,this.doAutoCrop())}doAutoCrop(){this.autoCrop&&this.crop()}crop(){if(null!=this.loadedImage?.transformed?.image){this.startCropImage.emit();const s=this.cropService.crop(this.sourceImage,this.loadedImage,this.cropper,this.settings);return null!=s&&this.imageCropped.emit(s),s}return null}aspectRatioIsCorrect(){return(this.cropper.x2-this.cropper.x1)/(this.cropper.y2-this.cropper.y1)===this.aspectRatio}}return C.\u0275fac=function(s){return new(s||C)(p.Y36(m),p.Y36(_),p.Y36(G),p.Y36(O.H7),p.Y36(p.sBO))},C.\u0275cmp=p.Xpm({type:C,selectors:[["image-cropper"]],viewQuery:function(s,c){if(1&s&&(p.Gf(tt,7),p.Gf(K,5)),2&s){let d;p.iGM(d=p.CRH())&&(c.wrapper=d.first),p.iGM(d=p.CRH())&&(c.sourceImage=d.first)}},hostVars:6,hostBindings:function(s,c){1&s&&p.NdJ("resize",function(){return c.onResize()},!1,p.Jf7)("mousemove",function(g){return c.moveImg(g)},!1,p.evT)("touchmove",function(g){return c.moveImg(g)},!1,p.evT)("mouseup",function(){return c.moveStop()},!1,p.evT)("touchend",function(){return c.moveStop()},!1,p.evT),2&s&&(p.Udp("text-align",c.alignImage),p.ekj("disabled",c.disabled)("ngx-ix-hidden",c.hidden))},inputs:{imageChangedEvent:"imageChangedEvent",imageURL:"imageURL",imageBase64:"imageBase64",imageFile:"imageFile",imageAltText:"imageAltText",format:"format",transform:"transform",maintainAspectRatio:"maintainAspectRatio",aspectRatio:"aspectRatio",resetCropOnAspectRatioChange:"resetCropOnAspectRatioChange",resizeToWidth:"resizeToWidth",resizeToHeight:"resizeToHeight",cropperMinWidth:"cropperMinWidth",cropperMinHeight:"cropperMinHeight",cropperMaxHeight:"cropperMaxHeight",cropperMaxWidth:"cropperMaxWidth",cropperStaticWidth:"cropperStaticWidth",cropperStaticHeight:"cropperStaticHeight",canvasRotation:"canvasRotation",initialStepSize:"initialStepSize",roundCropper:"roundCropper",onlyScaleDown:"onlyScaleDown",imageQuality:"imageQuality",autoCrop:"autoCrop",backgroundColor:"backgroundColor",containWithinAspectRatio:"containWithinAspectRatio",hideResizeSquares:"hideResizeSquares",allowMoveImage:"allowMoveImage",cropper:"cropper",alignImage:"alignImage",disabled:"disabled",hidden:"hidden"},outputs:{imageCropped:"imageCropped",startCropImage:"startCropImage",imageLoaded:"imageLoaded",cropperReady:"cropperReady",loadImageFailed:"loadImageFailed",transformChange:"transformChange"},features:[p.TTD],decls:5,vars:10,consts:[["wrapper",""],["class","ngx-ic-source-image",3,"src","visibility","transform","ngx-ic-draggable","load","mousedown","touchstart",4,"ngIf"],[1,"ngx-ic-overlay"],["class","ngx-ic-cropper","tabindex","0",3,"ngx-ic-round","top","left","width","height","margin-left","visibility","keydown",4,"ngIf"],[1,"ngx-ic-source-image",3,"src","load","mousedown","touchstart"],["sourceImage",""],["tabindex","0",1,"ngx-ic-cropper",3,"keydown"],[1,"ngx-ic-move",3,"mousedown","touchstart"],[4,"ngIf"],[1,"ngx-ic-resize","ngx-ic-topleft",3,"mousedown","touchstart"],[1,"ngx-ic-square"],[1,"ngx-ic-resize","ngx-ic-top"],[1,"ngx-ic-resize","ngx-ic-topright",3,"mousedown","touchstart"],[1,"ngx-ic-resize","ngx-ic-right"],[1,"ngx-ic-resize","ngx-ic-bottomright",3,"mousedown","touchstart"],[1,"ngx-ic-resize","ngx-ic-bottom"],[1,"ngx-ic-resize","ngx-ic-bottomleft",3,"mousedown","touchstart"],[1,"ngx-ic-resize","ngx-ic-left"],[1,"ngx-ic-resize-bar","ngx-ic-top",3,"mousedown","touchstart"],[1,"ngx-ic-resize-bar","ngx-ic-right",3,"mousedown","touchstart"],[1,"ngx-ic-resize-bar","ngx-ic-bottom",3,"mousedown","touchstart"],[1,"ngx-ic-resize-bar","ngx-ic-left",3,"mousedown","touchstart"]],template:function(s,c){1&s&&(p.TgZ(0,"div",null,0),p.YNc(2,et,2,8,"img",1),p._UZ(3,"div",2),p.YNc(4,rt,3,15,"div",3),p.qZA()),2&s&&(p.Udp("background",c.imageVisible&&c.backgroundColor),p.xp6(2),p.Q6J("ngIf",c.safeImgDataUrl),p.xp6(1),p.Udp("width",c.maxSize.width,"px")("height",c.maxSize.height,"px")("margin-left","center"===c.alignImage?c.marginLeft:null),p.xp6(1),p.Q6J("ngIf",c.imageVisible))},dependencies:[x.O5],styles:['[_nghost-%COMP%]{display:flex;position:relative;width:100%;max-width:100%;max-height:100%;overflow:hidden;padding:5px;text-align:center}[_nghost-%COMP%] > div[_ngcontent-%COMP%]{width:100%;position:relative}[_nghost-%COMP%] > div[_ngcontent-%COMP%]   img.ngx-ic-source-image[_ngcontent-%COMP%]{max-width:100%;max-height:100%;transform-origin:center}[_nghost-%COMP%] > div[_ngcontent-%COMP%]   img.ngx-ic-source-image.ngx-ic-draggable[_ngcontent-%COMP%]{user-drag:none;-webkit-user-drag:none;user-select:none;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;cursor:grab}[_nghost-%COMP%]   .ngx-ic-overlay[_ngcontent-%COMP%]{position:absolute;pointer-events:none;touch-action:none;outline:var(--cropper-overlay-color, white) solid 100vw;top:0;left:0}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]{position:absolute;display:flex;color:#53535c;background:transparent;outline:rgba(255,255,255,.3) solid 100vw;outline:var(--cropper-outline-color, rgba(255, 255, 255, .3)) solid 100vw;touch-action:none}@media (orientation: portrait){[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]{outline-width:100vh}}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]:after{position:absolute;content:"";inset:0;pointer-events:none;border:dashed 1px;opacity:.75;color:inherit;z-index:1}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-move[_ngcontent-%COMP%]{width:100%;cursor:move;border:1px solid rgba(255,255,255,.5)}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]:focus   .ngx-ic-move[_ngcontent-%COMP%]{border-color:#1e90ff;border-width:2px}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize[_ngcontent-%COMP%]{position:absolute;display:inline-block;line-height:6px;padding:8px;opacity:.85;z-index:1}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize[_ngcontent-%COMP%]   .ngx-ic-square[_ngcontent-%COMP%]{display:inline-block;background:#53535C;width:6px;height:6px;border:1px solid rgba(255,255,255,.5);box-sizing:content-box}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-topleft[_ngcontent-%COMP%]{top:-12px;left:-12px;cursor:nwse-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-top[_ngcontent-%COMP%]{top:-12px;left:calc(50% - 12px);cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-topright[_ngcontent-%COMP%]{top:-12px;right:-12px;cursor:nesw-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-right[_ngcontent-%COMP%]{top:calc(50% - 12px);right:-12px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-bottomright[_ngcontent-%COMP%]{bottom:-12px;right:-12px;cursor:nwse-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-bottom[_ngcontent-%COMP%]{bottom:-12px;left:calc(50% - 12px);cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-bottomleft[_ngcontent-%COMP%]{bottom:-12px;left:-12px;cursor:nesw-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-left[_ngcontent-%COMP%]{top:calc(50% - 12px);left:-12px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar[_ngcontent-%COMP%]{position:absolute;z-index:1}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-top[_ngcontent-%COMP%]{top:-11px;left:11px;width:calc(100% - 22px);height:22px;cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-right[_ngcontent-%COMP%]{top:11px;right:-11px;height:calc(100% - 22px);width:22px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-bottom[_ngcontent-%COMP%]{bottom:-11px;left:11px;width:calc(100% - 22px);height:22px;cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-left[_ngcontent-%COMP%]{top:11px;left:-11px;height:calc(100% - 22px);width:22px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]{outline-color:transparent}[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]:after{border-radius:100%;box-shadow:0 0 0 100vw #ffffff4d;box-shadow:0 0 0 100vw var(--cropper-outline-color, rgba(255, 255, 255, .3))}@media (orientation: portrait){[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]:after{box-shadow:0 0 0 100vh #ffffff4d;box-shadow:0 0 0 100vh var(--cropper-outline-color, rgba(255, 255, 255, .3))}}[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]   .ngx-ic-move[_ngcontent-%COMP%]{border-radius:100%}.disabled[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize[_ngcontent-%COMP%], .disabled[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar[_ngcontent-%COMP%], .disabled[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-move[_ngcontent-%COMP%]{display:none}.ngx-ix-hidden[_nghost-%COMP%]{display:none}'],changeDetection:0}),C})(),L=(()=>{class C{}return C.\u0275fac=function(s){return new(s||C)},C.\u0275mod=p.oAB({type:C}),C.\u0275inj=p.cJS({imports:[[x.ez]]}),C})();function J(C){const M=C.split(","),s=M[0].replace("data:","").replace(";base64",""),c=atob(M[1]),d=new ArrayBuffer(c.length),g=new Uint8Array(d);for(let u=0;u<c.length;u+=1)g[u]=c.charCodeAt(u);return new Blob([d],{type:s})}}}]);