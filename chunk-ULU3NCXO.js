import{a as ne}from"./chunk-PJLKC3XD.js";import"./chunk-KD232HJS.js";import{a as te}from"./chunk-GVMVJAFS.js";import{b as ee}from"./chunk-JNPRJ3MQ.js";import{a as P}from"./chunk-6WAGYCOA.js";import"./chunk-UPKF4LSO.js";import{a as Y}from"./chunk-N2K5OS3Y.js";import"./chunk-24DMSAFT.js";import"./chunk-K7RVMPTP.js";import{a as W}from"./chunk-CXISAAQ7.js";import"./chunk-BNP52TDG.js";import"./chunk-F6BYEP4R.js";import"./chunk-VP6KNDS4.js";import{k as q}from"./chunk-AQDYGNZB.js";import"./chunk-FQC6PRY2.js";import{a as Z}from"./chunk-PZTZCA44.js";import"./chunk-4HNSRH53.js";import{G as H}from"./chunk-ZVKVGF76.js";import{h as J,k as U}from"./chunk-T6GM3CFW.js";import{$d as Q,Aa as D,Ba as $,Hb as p,Ib as N,Ic as w,Jc as X,Lb as y,Mb as K,Nb as O,Ob as r,Pb as o,Qb as s,Vc as z,Wc as V,Y as v,_b as I,ab as l,ac as d,dc as f,e as E,fc as u,ia as m,na as M,nb as A,nc as F,oa as S,oc as B,rb as x,rc as G,tc as T,uc as C,wd as j}from"./chunk-H2EXZDP6.js";var oe=(_,a)=>a.track.id;function re(_,a){if(_&1){let i=I();r(0,"tr",20),f("click",function(){let e=M(i).$implicit;return S(e.selected=!e.selected)}),r(1,"td",11),T(2),o(),r(3,"td",12),T(4),o(),r(5,"td",13),T(6),o(),r(7,"td",14),T(8),o(),r(9,"td",15),T(10),o(),r(11,"td",16),T(12),o(),r(13,"td",17),T(14),o(),r(15,"td",18),T(16),w(17,"duration"),o()()}if(_&2){let i=a.$implicit;G("selected",i.selected),l(2),C(i.track.tag==null?null:i.track.tag.trackNr),l(2),C(i.track.tag==null?null:i.track.tag.title),l(2),C(i.track.tag==null?null:i.track.tag.artist),l(2),C(i.track.tag==null?null:i.track.tag.album),l(2),C(i.track.media==null?null:i.track.media.format),l(2),C(i.track.media==null?null:i.track.media.bitRate),l(2),C(i.track.media==null?null:i.track.media.sampleRate),l(2),C(X(17,10,i.track.duration))}}function ae(_,a){if(_&1&&(r(0,"table",9)(1,"tr",10)(2,"td",11),d(3,0),o(),r(4,"td",12),d(5,1),o(),r(6,"td",13),d(7,2),o(),r(8,"td",14),d(9,3),o(),r(10,"td",15),d(11,4),o(),r(12,"td",16),d(13,5),o(),r(14,"td",17),d(15,6),o(),r(16,"td",18),d(17,7),o()(),y(18,re,18,12,"tr",19,oe),o()),_&2){let i=u();l(18),K(i.trackItems)}}var k=(()=>{let a=class a{constructor(){this.tracks=z([]),this.router=m(J)}getSortValue(t,e){switch(t){case"number":return e.track.tag?.trackNr;case"name":return e.track.name;case"artist":return e.track.tag?.artist;case"album":return e.track.tag?.album;case"duration":return e.track.duration;default:return}}ngOnChanges(){this.trackItems=this.tracks().map(t=>({track:t}))}toTrackFolder(t){this.router.navigate([`/admin/folder/${t.parentID}/overview`]).catch(e=>{console.error(e)})}};a.\u0275fac=function(e){return new(e||a)},a.\u0275cmp=A({type:a,selectors:[["app-admin-track-list"]],inputs:{tracks:[1,"tracks"]},features:[D],decls:2,vars:2,consts:()=>{let t;t=$localize`:␟be498c96e976cb06e12d105d3174b0d47460886f␟8381503740832172353:Track Nr.`;let e;e=$localize`:␟fdf7cbdc140d0aab0f0b6c06065a0fd448ed6a2e␟5701618810648052610:Title`;let n;n=$localize`:␟378660a509ecaa4d2dd3b4b0b8975760cfe3576d␟2492300395471245755:Artist`;let c;c=$localize`:␟842a4fcf548e0c52ebab1cb5362f47ab2ca83e12␟1393837337557373364:Album`;let R;R=$localize`:␟7722a92a1fc887570b4f4d8a7bb916f067f32028␟7513076467032912668:Format`;let h;h=$localize`:␟1e4b5c71ea539e7ba3415dbf4b15a6b684cf892a␟3813020320794017449:BitRate`;let L;L=$localize`:␟d256d70c89c6d6a1d085e7bac659374528239056␟3186270570067508524:SampleRate`;let b;return b=$localize`:␟a02ea1d4e7424ca989929da5e598f379940fdbf2␟7410432243549869948:Duration`,[t,e,n,c,R,h,L,b,["name","Tracks",3,"list"],[1,"tracks"],[1,"track","heading"],[1,"number"],[1,"title"],[1,"artist"],[1,"album"],[1,"format"],[1,"bitrate"],[1,"samplerate"],[1,"duration"],[1,"track",3,"selected"],[1,"track",3,"click"]]},template:function(e,n){e&1&&(s(0,"app-background-text-list",8),p(1,ae,20,0,"table",9)),e&2&&(O("list",n.tracks()),l(),N(n.tracks()&&n.tracks().length>0?1:-1))},dependencies:[P,W],styles:["[_nghost-%COMP%]{width:100%;overflow:auto;display:block}[_nghost-%COMP%]   .tracks[_ngcontent-%COMP%]{padding:15px;font-size:.8em;width:100%}[_nghost-%COMP%]   .heading[_ngcontent-%COMP%]{font-size:.9em}[_nghost-%COMP%]   .track[_ngcontent-%COMP%]{border-bottom:1px solid var(--control-border)}[_nghost-%COMP%]   .track[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:5px 10px}[_nghost-%COMP%]   .track[_ngcontent-%COMP%]:hover{background-color:var(--background-hover)}[_nghost-%COMP%]   .track.selected[_ngcontent-%COMP%]{background-color:var(--background-active)}"]});let _=a;return _})();function _e(_,a){_&1&&s(0,"app-loading")}function le(_,a){if(_&1){let i=I();r(0,"div",1)(1,"div",2)(2,"button",3),f("click",function(){M(i);let e=u();return S(e.refresh())}),s(3,"i",4),o(),r(4,"button",5),f("click",function(){M(i);let e=u();return S(e.moveTracks())}),s(5,"i",6),o(),r(6,"button",7),f("click",function(){M(i);let e=u();return S(e.deleteTracks())}),s(7,"i",8),o()(),s(8,"app-admin-track-list",9),o()}if(_&2){let i=u();l(8),O("tracks",i.folder.tracks)}}var Le=(()=>{let a=class a extends te{constructor(){super(...arguments),this.tracks=V(k),this.jam=m(Q),this.notify=m(H),this.folderService=m(ee),this.dialogsService=m(Y),this.dialogOverlay=m(q)}ngOnInit(){super.ngOnInit(),this.folderService.foldersChange.pipe(v(this.unsubscribe)).subscribe(t=>{t.id===this.id&&this.refresh()})}ngOnDestroy(){super.ngOnDestroy()}deleteTracks(){let t=this.getTrackIDs();t.length!==0&&this.dialogsService.confirm("Remove Tracks?",`Sure to remove ${t.length} Track${t.length>1?"s":""}?`,()=>{for(let e of t)this.jam.track.remove({id:e}).then(n=>{this.folderService.waitForQueueResult("Removing Track",n,[],[],[e])}).catch(n=>{this.notify.error(n)})})}getTrackIDs(){let t=this.tracks();if(!t?.trackItems||!this.folder?.tracks)return[];let e=t.trackItems.filter(n=>n.selected).map(n=>n.track.id);return e.length>0?e:this.folder.tracks.map(n=>n.id)}moveTracks(){let t=this.getTrackIDs();if(t.length===0)return;let e={selectID:this.id};this.dialogOverlay.open({childComponent:ne,title:"Move Tracks to",data:e,panelClass:"overlay-panel-large-buttons",onOkBtn:()=>E(this,null,function*(){let n=e.folder;if(n)return this.jam.track.move({ids:t,folderID:n.id}).then(c=>{this.folderService.waitForQueueResult("Moving Tracks",c,[],[n.id,...this.folder?.parentID?[this.folder.parentID]:[]],t)}).catch(c=>{this.notify.error(c)}),Promise.resolve()}),onCancelBtn:()=>E(this,null,function*(){return Promise.resolve()})})}refresh(){this.folder=void 0,this.id&&this.jam.folder.id({id:this.id,folderIncTracks:!0,trackIncTag:!0,trackIncMedia:!0}).then(t=>{this.folder=t}).catch(t=>{this.notify.error(t)})}};a.\u0275fac=(()=>{let t;return function(n){return(t||(t=$(a)))(n||a)}})(),a.\u0275cmp=A({type:a,selectors:[["app-admin-folder-tracks"]],viewQuery:function(e,n){e&1&&F(n.tracks,k,5),e&2&&B()},features:[x],decls:3,vars:3,consts:()=>{let t;t=$localize`:␟c8d1785038d461ec66b5799db21864182b35900a␟1102717806459547726:Refresh`;let e;e=$localize`:␟5599dad966c719b3feae9735c1c2555c63945d62␟5954283971273891723:Move Tracks…`;let n;return n=$localize`:␟d01e8b8bbe3093f1bfe3f7849f8856d20862aa60␟3929773193703989963:Delete Tracks…`,[["name","Tracks",3,"list"],[1,"tracks"],[1,"actions"],["title",t,1,"button-on-control",3,"click"],[1,"icon-reload"],["title",e,1,"button-on-control",3,"click"],[1,"icon-right-bold"],["title",n,1,"button-on-control",3,"click"],[1,"icon-trash"],[1,"content",3,"tracks"]]},template:function(e,n){e&1&&(p(0,_e,1,0,"app-loading"),s(1,"app-background-text-list",0),p(2,le,9,1,"div",1)),e&2&&(N(n.folder?-1:0),l(),O("list",n.folder==null?null:n.folder.tracks),l(),N(n.folder&&n.folder.tracks&&n.folder.tracks.length>0?2:-1))},dependencies:[j,U,k,P,Z],styles:["[_nghost-%COMP%]{height:100%;width:100%;display:block;overflow:hidden}[_nghost-%COMP%]   .tracks[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;width:100%}[_nghost-%COMP%]   .tracks[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{padding:10px 15px 0;border-bottom-color:var(--background-border);border-bottom-width:1px;border-bottom-style:solid}[_nghost-%COMP%]   .tracks[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{margin-right:5px;margin-bottom:10px}[_nghost-%COMP%]   .tracks[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%] > label[_ngcontent-%COMP%]{text-transform:uppercase;letter-spacing:1px;font-size:11px;margin-left:5px;margin-right:5px}[_nghost-%COMP%]   .tracks[_ngcontent-%COMP%]   app-admin-track-list[_ngcontent-%COMP%]{overflow-y:auto}"]});let _=a;return _})();export{Le as AdminFolderTracksComponent};
