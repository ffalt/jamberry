!function(){function e(t,n){return(e=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(t,n)}function t(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var r,a=i(e);if(t){var o=i(this).constructor;r=Reflect.construct(a,arguments,o)}else r=a.apply(this,arguments);return n(this,r)}}function n(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function a(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}function o(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(self.webpackChunkjamberry=self.webpackChunkjamberry||[]).push([[187],{4187:function(n,i,r){"use strict";r.r(i),r.d(i,{TagEditorModule:function(){return An}});var c=r(31664),l=r(38583),u=r(90665),d=r(42976),g=r(67396),h=r(72271),f=r(17469),p=r(76277),m=r(79765),v=r(46782),C=r(64762),M=function e(){s(this,e)},k=r(31837),T=r(75723),x=r(67111),b=["2 Tone","2-Step Garage","4-Beat","A Cappella","Abstract","Acid","Acid Breaks","Acid House","Acid Jazz","Acid Punk","Acid Rock","Acid Techno","Acid Trance","Acousmatic Music","Acoustic","Adult Contemporary","African","African Blues","African Heavy Metal","African Hip Hop","Afro / Cosmic Disco","Afro-Cuban Jazz","Afrobeat","Aggrotech","Alternative","Alternative Country","Alternative Dance","Alternative Hip Hop","Alternative Metal","Alternative Rock","Ambient","Ambient Dub","Ambient House","American Folk Revival","Americana","Anarcho Punk","Anime","Anti-folk","Apala","Arab Pop","Art Punk","Art Rock","Asian","Asian American Jazz","Asian Underground","Atlanta Hip Hop","Audio Theatre","Audiobook","Australian Country Music","Australian Hip Hop","AustroPop","Avant-garde","Avant-garde Jazz","Avant-garde Metal","Avantgarde","Ax\xe9","Bachata","Background Music","Baila","Baithak Gana","Bakersfield sound","Balearic Beat","Balearic Trance","Ballad","Baltimore Club","Banda","Baroque","Baroque Pop","Bass","Bassline","Baul","Beat","Beat Music","Beautiful Music","Bebop","Benga","Berlin School","Bhangra","Big Band","Big Beat","Big Room","Bikutsi","BitPop","Black Metal","Blue-Eyed Soul","Bluegrass","Blues","Blues Country","Blues Rock","Blues Shouter","Bolero","Bongo Flava","Boogie","Boogie-Woogie","Booty Bass","Bossa Nova","Bounce Music","Bouncy House","Bouncy Techno","Bouyon","Brazilian","Brazilian Rock","Breakbeat","Breakbeat Hardcore","Breakcore","Breakstep","Brega","Brick City club","Brill Building","British Blues","British Dance Band","British Folk revival","British Hip Hop","BritPop","Broken Beat","Brostep","Bubblegum Dance","Bubblegum Pop","Bullerengue","C-Pop","Cabaret","Cadence-lypso","Cajun","Cajun fiddle tunes","Calypso","Canadian Blues","Canci\xf3n","Canterbury scene","Canzone","Cape Jazz","Caribbean","Celtic","Celtic Metal","Celtic Music","Celtic Punk","Cha Cha Cha","Chalga","Chamber Jazz","Chamber Music","Chanson","Chap Hop","Chicago Blues","Chicago Hip Hop","Chicago House","Chicano Rap","Chicha","Chill-out","Chillout","Chillstep","Chillwave","Chimurenga","Chinese Rock","Chiptune","Chopped & Screwed","Choro","Chorus","Christian Country Music","Christian Gangsta Rap","Christian Hip Hop","Christian Metal","Christian Pop","Christian Punk","Christian Rap","Christian Rock","Chutney","Chutney soca","Classic Country","Classic female Blues","Classic Rock","Classical","Classical crossover","Close harmony","Club","Club-House","Coldwave","Comedy","Compas","Complextro","Congolese rumba","Conscious Hip Hop","Contemporary Christian","Contemporary Folk","Contemporary R&B","Continental Jazz","Cool Jazz","Country","Country Blues","Country Pop","Country Rap","Country Rock","Country-Rap","Coup\xe9-D\xe9cal\xe9","Western Music","CowPunk","Criolla","Crossover","Crossover Jazz","Crossover Thrash","Crunk","Crunkcore","Crust Punk","Crustgrind","Cult","Cumbia","Cumbia Rap","Cybergrind","D-beat","Dance","Dance Hall","Dance-Pop","Dance-Punk","Dance-Rock","Dancehall","Dancehall Music","Dangdut","Dansband Music","Dark Ambient","Dark Cabaret","Dark Electro","Dark Wave","Darkcore","Darkcore jungle","Darkstep","Darkwave","Death 'n' roll","Death industrial","Death Metal","Death-Doom","Deathcore","DeathRock","Deep Funk","Deep House","Delta Blues","Desert Rock","Detroit Blues","Detroit Hip Hop","Detroit Techno","Digital hardcore","Disco","Disco polo","Diva House","Dixieland","Djent","Doom Metal","Doomcore","Downtempo","Dream","Dream Pop","Dream Trance","Drill","Drill & Bass","Drone Metal","Drone Music","Drum & Bass","Drum Solo","Drumstep","Dub","Dub Techno","Dubstep","Dubstyle","Dubtronica","Duet","Dunedin Sound","Dutch House","East Coast Hip Hop","Easy Listening","EBM","Eclectic","Electric Blues","Electro","Electro House","Electro Music","Electro Swing","Electro-Industrial","Electroacoustic","Electroacoustic Music","Electroclash","Electronic","Electronic Body Music","Electronic Rock","Electronica","Electronicore","ElectroPop","ElectroPunk","Elevator Music","Emo","Ethereal Wave","Ethnic","Ethnic electronica","Ethno Jazz","Euro Disco","Euro-House","Euro-Techno","Eurobeat","Eurodance","European free Jazz","EuroPop","Experimental","Experimental Hip Hop","Experimental Music","Experimental Rock","Fado","Fann at-Tanbura","Fast Fusion","Fidget House","Fijiri","Filk Music","Filmi","Flamenco","Florida Breaks","Folk","Folk Metal","Folk Pop","Folk Punk","Folk Rock","Folk-Rock","Folklore","Folktronica","Forr\xf3","Franco-Country","Freak Folk","Freakbeat","Free Funk","Free Improvisation","Free Jazz","Free Tekno","Freestyle","Freestyle Music","Freestyle Rap","French House","French Pop","Frevo","Fuji Music","Full On","Funk","Funk Carioca","Funk Metal","Funkstep","Funktronica","Funky House","Furniture Music","Fusion","Future Garage","Future House","FuturePop","G-Funk","Gabba","Game","Game Boy Music","Gamelan","Gangsta Rap","Garage","Garage House","Garage Punk","Garage Rock","Genge","Ghetto House","Ghettotech","Glam Metal","Glam Rock","Glitch","Glitch Hop","Global","Go-go","Goa","Goa Trance","Golden Age Hip Hop","Goregrind","Gospel","Gospel Blues","Gothic","Gothic Metal","Gothic Rock","Grime","Grindcore","Grindie","Groove Metal","Grunge","Grupera","Guajira","Gypsy Jazz","Gypsy Punk","Happy Hardcore","Hard Bop","Hard House","Hard NRG","Hard Rock","Hard Trance","Hardbag","Hardcore","Hardcore Rap","Hardcore Hip Hop","Hardcore Punk","Hardstep","Hardstyle","Heavy Metal","Hellbilly Music","Hi-NRG","Highlife","Hill Country Blues","Hip Hop","Hip Hop Soul","Hip House","Hip Pop","Hip Hop","Hiplife","Hokum","Hokum Blues","Honky Tonk","Horror Punk","Horrorcore","House","House Music","Houston Hip Hop","Huayno","Humour","Hyphy","IDM","Igbo highlife","Igbo Rap","Illbient","Indian Pop","Indie","Indie Folk","Indie Pop","Indie Rock","Indietronica","Industrial","Industrial Folk","Industrial Hip Hop","Industrial Metal","Industrial Music","Industrial Rock","Industro-Goth","Instrumental","Instrumental Country","Instrumental Hip Hop","Instrumental Pop","Instrumental Rock","Iranian Pop","Isicathamiya","Isolationism","Italo Dance","Italo Disco","Italo House","J-Pop","Jam Band","Jangle Pop","Japanoise","Jazz","Jazz Blues","Jazz Fusion","Jazz House","Jazz Rap","Jazz Rock","Jazz-Funk","Jazz+Funk","Jerkin'","Jersey Club","Jit","JPop","J\xf9j\xfa","Jump Blues","Jump-up","Jumpstyle","Jungle","K-Pop","Kadongo Kamu","Kansas City Blues","Kansas City Jazz","Kapuka","Keroncong","Khaliji","Kizomba","Krautrock","Kuduro","Kwaito","Kwassa Kwassa","Kwela","La\xefk\xf3","Lambada","Laptronica","Latin","Latin alternative","Latin ballad","Latin Christian","Latin House","Latin Jazz","Latin Metal","Latin Pop","Latin Rock","Latin Swing","Lavani","Leftfield","Lento Violento","Liquid Dubstep","Liquid Funk","Livetronica","Liwa","Lo-fi","Lo-Fi","Louisiana Blues","Louisiana Swamp Pop","Lounge","Lounge Music","Lovers Rock","Low Bap","Lowercase","Luk Krung","Luk Thung","Lyrical Hip Hop","M-Base","Mafioso Rap","Mainstream Jazz","M\xe1kina","Makossa","Maloya","Mambo","MandoPop","Manila Sound","Maracatu","Mariachi","Marrabenta","Math Rock","Mathcore","Mbalax","Mbaqanga","Mbube","Medieval Metal","Meditative","Melbourne Bounce","Melodic Death Metal","Melodic Metalcore","Memphis Blues","Merengue","MerenRap","M\xe9ringue","Metal","Metalcore","Mexican Pop","Mexican Son","Miami Bass","Microhouse","Middle of the road","Midwest Hip Hop","Minimal Techno","Minimal Wave","Modal Jazz","Moombahcore","Moombahton","Morlam","Morna","Mosambique","Motswako","M\xfasica Criolla","M\xfasica Popular Brasileira","M\xfasica Sertaneja","Musical","Musique Concr\xe8te","Nagoya Kei","Nashville Sound","National Folk","Native American","NDW","Ndombolo","NederPop","Neo Soul","Neo-Bop Jazz","Neo-Psychedelia","Neo-Swing","Neoclassical","Neoclassical Metal","Neofolk","Neotraditional Country","Nerdcore","Neue Deutsche Welle","NeuroFunk","Neurohop","New Age","New Beat","New jack swing","New Jersey Hip Hop","New Prog","New Rave","New Romantic","New Romanticism","New School Hip Hop","New Wave","New-age Music","Nintendocore","Nitzhonot","No wave","Noise","Noise Rock","Noisegrind","Nortec","Norte\xf1o","Northern Soul","Novelty Ragtime","Nu Jazz","Nu Metal","Nu Skool Breaks","Nu-Breakz","Nu-Disco","Nu-Funk","Nu-Gaze","Nu-NRG","Nueva canci\xf3n","Old School Hip Hop","Oldies","Opera","Operatic Pop","Orchestral Jazz","Original Pilipino Music","Other","Outlaw Country","Outsider House","P-Funk","Pagan Metal","Pagode","Paisley Underground","Palm-wine","Piedmont Blues","Pinoy Pop","Podcast","Political Hip Hop","Polka","Polsk Punk","Pop","Pop Punk","Pop Rap","Pop Rock","Pop Soul","Pop Sunda","Pop-Folk","Pop-Funk","Porn Groove","Porro","Post-Bop","Post-Disco","Post-Grunge","Post-Hardcore","Post-Metal","Post-Punk","Post-Punk Revival","Post-Rock","Power Ballad","Power Electronics","Power Metal","Power Noise","Power Pop","Powerviolence","Pranks","Primus","Progressive Bluegrass","Progressive Country","Progressive Folk","Progressive House","Progressive Metal","Progressive Pop","Progressive Rock","Progressive Trance","Protest Song","Psybient","Psychedelic","Psychedelic Folk","Psychedelic Pop","Psychedelic Rock","Psychedelic Trance","Psychobilly","Punkabilly","Psytrance","Punk","Punk Blues","Punk Jazz","Punk Rock","Punta","Punta Rock","R&B","Raga Rock","Ragga","Ragga Jungle","Raggacore","Ragini","Ragtime","Ra\xef","Ranchera","Rap","Rap Metal","Rap Music","Rap Opera","Rap Rock","Rapcore","Rara tech","Rasin","Rave","Reactionary Bluegrass","Rebetiko","Red Dirt","Reggae","Reggae Espa\xf1ol","Spanish Reggae","Reggae Fusion","Reggaestep","Reggaeton","Regional Mexican","Retro","Revival","Rhythm & Blues","Rhythmic Soul","Riot grrrl","Rock","Rock & Roll","Rock en Espa\xf1ol","Rock in Opposition","Rockabilly","Rocksteady","Rumba","Russian Pop","Sadcore","Sakara","Salsa","Salsa rom\xe1ntica","Samba","Samba Rock","Sambass","Satire","Sawt","Schlager","Screamo","Sega","Seggae","Semba","Sertanejo","Shangaan electro","Shibuya-kei","Shoegaze","Showtunes","Singer-songwriter","Ska","Ska Jazz","Ska Punk","Skate Punk","Skiffle","Skweee","Slow Jam","Slow Rock","Slowcore","Sludge Metal","Smooth Jazz","Snap Music","Soca","Soft Rock","Son","Son Cubano","Sonata","Songo","Songo-Salsa","Sophisti-Pop","Soukous","Soul","Soul Blues","Soul Jazz","Sound Clip","Soundtrack","Southern Hip Hop","Southern Rock","Southern Soul","Space","Space Age Pop","Space Disco","Space Music","Space Rock","Speech","Speed garage","Speed Metal","Speedcore","St.Louis Blues","St.Louis Hip Hop","Stoner Rock","Straight-ahead Jazz","Street Punk","Stride Jazz","Sufi Rock","SungPoetry","Sunshine Pop","Suomisaundi","Surf Pop","Surf Rock","Swamp Blues","Swing","Symphonic black Metal","Symphonic Metal","Symphonic Rock","Symphony","Synthpop","SynthPop","Synthwave","Taarab","Tango","Tech House","Tech Trance","Techdombe","Technical death Metal","Techno","Techno-Industrial","Techstep","Tecno Brega","Tecnobrega","Teen Pop","Tejano","Terror","Texas Blues","Texas Country","Thai Pop","Third stream","Thrash Metal","Thrashcore","Timba","Top 40","Trad Jazz","Traditional Country Music","Traditional Pop Music","Trailer","Trance","Trance Music","TRap","TRapstep","Tribal","Tribal House","Trip hop","Trip-Hop","Trival","Trop Rock","Tropical","Tropical House","Tropicalia","TropiPop","Truck-driving Country","Turkish Pop","Turntablism","Twin Cities Hip Hop","Twoubadou","UK Funky","UK Garage","UK Hardcore","Unblack Metal","Underground Hip Hop","Uplifting Trance","Urban Pasifika","V-Pop","Vallenato","Vaporwave","Video game Music","Viking Metal","VisPop","Visual Kei","Vocal","Vocal Jazz","Vocal Trance","War Metal","Weltmusik","West Coast Blues","West Coast Hip Hop","West Coast Jazz","Western swing","Witch House","Wonky","Wonky Pop","World Fusion","World Music","Worldbeat","Zouglou","Zouk","Zouk-Lambada","Zydeco"],O=(function(e){e[e.Filename=1]="Filename",e[e.IdText=2]="IdText",e[e.IdBin=3]="IdBin",e[e.Text=4]="Text",e[e.TextList=5]="TextList",e[e.LangDescText=6]="LangDescText",e[e.PlayCounter=7]="PlayCounter",e[e.Popularimeter=8]="Popularimeter",e[e.MusicCDId=9]="MusicCDId",e[e.EventTimingCodes=10]="EventTimingCodes",e[e.SYLT=11]="SYLT",e[e.GEOB=12]="GEOB",e[e.ETCO=13]="ETCO",e[e.PCST=14]="PCST",e[e.LINK=15]="LINK",e[e.AENC=16]="AENC",e[e.Pic=17]="Pic",e[e.RVAD=18]="RVAD",e[e.RGAD=19]="RGAD",e[e.RVAD2=20]="RVAD2",e[e.CTOC=21]="CTOC",e[e.CHAP=22]="CHAP",e[e.Bool=23]="Bool",e[e.Unknown=24]="Unknown"}(O||(O={})),O),y={internal_file:{title:"Filename",versions:[2,3,4],impl:O.Filename},UFI:{title:"Unique file identifier",versions:[2],impl:O.IdText,upgrade:"UFID"},TOT:{title:"Original album/Movie/Show title",versions:[2],impl:O.Text,upgrade:"TOAL"},CDM:{title:"Compressed Data Metaframe",versions:[2],impl:O.Unknown},CRM:{title:"Encrypted meta",versions:[2],impl:O.Unknown},TT1:{title:"Content group",versions:[2],impl:O.Text,upgrade:"TIT1"},TT2:{title:"Title",versions:[2],impl:O.Text,upgrade:"TIT2"},TT3:{title:"Subtitle",versions:[2],impl:O.Text,upgrade:"TIT3"},TP1:{title:"Artist",versions:[2],impl:O.Text,upgrade:"TPE1"},TP2:{title:"Album Artist",versions:[2],impl:O.Text,upgrade:"TPE2"},TP3:{title:"Conductor",versions:[2],impl:O.Text,upgrade:"TPE3"},TP4:{title:"Remixer",versions:[2],impl:O.Text,upgrade:"TPE4"},TCM:{title:"Composer",versions:[2],impl:O.Text,upgrade:"TCOM"},TXT:{title:"Lyricist",versions:[2],impl:O.Text,upgrade:"TEXT"},TLA:{title:"Languages",versions:[2],impl:O.Text,upgrade:"TLAN"},TCO:{title:"Genre",versions:[2],impl:O.Text,upgrade:"TCON"},TAL:{title:"Album",versions:[2],impl:O.Text,upgrade:"TALB"},TPA:{title:"Part of a set",versions:[2],impl:O.Text,upgrade:"TPOS"},TRK:{title:"Track number",versions:[2],impl:O.Text,upgrade:"TRCK"},TRC:{title:"ISRC (international standard recording code)",versions:[2],impl:O.Text,upgrade:"TSRC"},TYE:{title:"Year",versions:[2],impl:O.Text,upgrade:"TYER"},TDA:{title:"Date",versions:[2],impl:O.Text,upgrade:"TDAT"},TIM:{title:"Time",versions:[2],impl:O.Text,upgrade:"TIME"},TRD:{title:"Recording dates",versions:[2],impl:O.Text,upgrade:"TRDA"},TMT:{title:"Media type",versions:[2],impl:O.Text,upgrade:"TMED"},TBP:{title:"BPM",versions:[2],impl:O.Text,upgrade:"TBPM"},TCR:{title:"Copyright message",versions:[2],impl:O.Text,upgrade:"TCOP"},TPB:{title:"Publisher",versions:[2],impl:O.Text,upgrade:"TPUB"},TEN:{title:"Encoded by",versions:[2],impl:O.Text,upgrade:"TENC"},TSS:{title:"Encoding Software/Hardware",versions:[2],impl:O.Text,upgrade:"TSSE"},TOF:{title:"Original filename",versions:[2],impl:O.Text,upgrade:"TOFN"},TLE:{title:"Length",versions:[2],impl:O.Text,upgrade:"TLEN"},TSI:{title:"Size",versions:[2],impl:O.Text,upgrade:"TSIZ"},TDY:{title:"Playlist delay",versions:[2],impl:O.Text,upgrade:"TDLY"},TKE:{title:"Initial key",versions:[2],impl:O.Text,upgrade:"TKEY"},TOL:{title:"Original lyricist",versions:[2],impl:O.Text,upgrade:"TOLY"},TOA:{title:"Original artist",versions:[2],impl:O.Text,upgrade:"TOPE"},TOR:{title:"Original release year",versions:[2],impl:O.Text,upgrade:"TORY"},TXX:{title:"User defined text",versions:[2],impl:O.IdText,upgrade:"TXXX"},WAF:{title:"Official audio file webpage",versions:[2],impl:O.Text,upgrade:"WOAF"},WAR:{title:"Official artist/performer webpage",versions:[2],impl:O.Text,upgrade:"WOAR"},WAS:{title:"Official audio source webpage",versions:[2],impl:O.Text,upgrade:"WOAS"},WCM:{title:"Commercial information",versions:[2],impl:O.Text,upgrade:"WCOM"},WCP:{title:"Copyright/Legal information",versions:[2],impl:O.Text,upgrade:"WCOP"},WPB:{title:"Publishers official webpage",versions:[2],impl:O.Text,upgrade:"WPUB"},WXX:{title:"User defined URL link frame",versions:[2],impl:O.IdText,upgrade:"WXXX"},IPL:{title:"Involved people list",versions:[2],impl:O.TextList,upgrade:"IPLS"},ETC:{title:"Event timing codes",versions:[2],impl:O.EventTimingCodes,upgrade:"ETCO"},MLL:{title:"MPEG location lookup table",versions:[2],impl:O.Unknown,upgrade:"MLLT"},STC:{title:"Synchronised tempo codes",versions:[2],impl:O.Unknown,upgrade:"SYTC"},ULT:{title:"Lyrics",versions:[2],impl:O.LangDescText,upgrade:"USLT"},SLT:{title:"Synchronised Lyrics",versions:[2],impl:O.SYLT,upgrade:"SYLT"},COM:{title:"Comments",versions:[2],impl:O.LangDescText,upgrade:"COMM"},RVA:{title:"Relative volume adjustment",versions:[2],impl:O.RVAD,upgrade:"RVAD"},EQU:{title:"Equalisation",versions:[2],impl:O.Unknown,upgrade:"EQUA"},REV:{title:"Reverb",versions:[2],impl:O.Unknown,upgrade:"RVRB"},PIC:{title:"Attached picture",versions:[2],impl:O.Pic,upgrade:"APIC"},GEO:{title:"General encapsulated object",versions:[2],impl:O.GEOB,upgrade:"GEOB"},CNT:{title:"Play counter",versions:[2],impl:O.PlayCounter,upgrade:"PCNT"},POP:{title:"Popularimeter",versions:[2],impl:O.Popularimeter,upgrade:"POPM"},BUF:{title:"Recommended buffer size",versions:[2],impl:O.Unknown,upgrade:"RBUF"},CRA:{title:"Audio encryption",versions:[2],impl:O.AENC,upgrade:"AENC"},LNK:{title:"Linked information",versions:[2],impl:O.LINK,upgrade:"LINK"},NCO:{title:"MusicMatch Binary",versions:[2],impl:O.Unknown,upgrade:"NCON"},PRI:{title:"Private frame",versions:[2],impl:O.IdBin,upgrade:"PRIV"},TCP:{title:"iTunes Compilation Flag",versions:[2],impl:O.Bool,upgrade:"TCMP"},TST:{title:"Title sort order",versions:[2],impl:O.Text,upgrade:"XSOT"},TSP:{title:"Artist sort order",versions:[2],impl:O.Text,upgrade:"XSOP"},TSA:{title:"Album sort order",versions:[2],impl:O.Text,upgrade:"XSOA"},TS2:{title:"Album Artist sort order",versions:[2],impl:O.Text,upgrade:"TSO2"},TSC:{title:"Composer sort order",versions:[2],impl:O.Text,upgrade:"TSOC"},TDR:{title:"Release time",versions:[2],impl:O.Text,upgrade:"TDRL"},TDS:{title:"iTunes podcast description",versions:[2],impl:O.Text,upgrade:"TDES"},TID:{title:"Podcast URL",versions:[2],impl:O.Text,upgrade:"TGID"},WFD:{title:"Podcast feed URL",versions:[2],impl:O.Text,upgrade:"WFED"},PCS:{title:"iTunes podcast marker",versions:[2],impl:O.PCST,upgrade:"PCST"},XSOA:{title:"Album sort order",versions:[3],impl:O.Text,upgrade:"TSOA"},XSOP:{title:"Performer sort order",versions:[3],impl:O.Text,upgrade:"TSOP"},XSOT:{title:"Title sort order",versions:[3],impl:O.Text,upgrade:"TSOT"},XDOR:{title:"Original release time",versions:[3],impl:O.Text,upgrade:"TDOR"},TIT1:{title:"Group",versions:[3,4],impl:O.Text},TIT2:{title:"Title",versions:[3,4],impl:O.Text},TIT3:{title:"Subtitle",versions:[3,4],impl:O.Text},TALB:{title:"Album",versions:[3,4],impl:O.Text},TOAL:{title:"Original album",versions:[3,4],impl:O.Text},TRCK:{title:"Track number",versions:[3,4],impl:O.Text},TPOS:{title:"Part of a set",versions:[3,4],impl:O.Text},TSRC:{title:"ISRC (international standard recording code)",versions:[3,4],impl:O.Text},TPE1:{title:"Artist",versions:[3,4],impl:O.Text},TPE2:{title:"Album Artist",versions:[3,4],impl:O.Text},TPE3:{title:"Conductor",versions:[3,4],impl:O.Text},TPE4:{title:"Remixer",versions:[3,4],impl:O.Text},TOPE:{title:"Original artist",versions:[3,4],impl:O.Text},TEXT:{title:"Lyricist",versions:[3,4],impl:O.Text},TOLY:{title:"Original lyricist",versions:[3,4],impl:O.Text},TCOM:{title:"Composer",versions:[3,4],impl:O.Text},TENC:{title:"Encoded by",versions:[3,4],impl:O.Text},TBPM:{title:"BPM",versions:[3,4],impl:O.Text},TLEN:{title:"Length",versions:[3,4],impl:O.Text},TKEY:{title:"Initial key",versions:[3,4],impl:O.Text},TLAN:{title:"Languages",versions:[3,4],impl:O.Text},TCON:{title:"Genre",versions:[3,4],impl:O.Text},TFLT:{title:"File type",versions:[3,4],impl:O.Text},TMED:{title:"Media type",versions:[3,4],impl:O.Text},TCOP:{title:"Copyright message",versions:[3,4],impl:O.Text},TPUB:{title:"Publisher",versions:[3,4],impl:O.Text},TOWN:{title:"File owner",versions:[3,4],impl:O.Text},TRSN:{title:"Internet radio station name",versions:[3,4],impl:O.Text},TRSO:{title:"Internet radio station owner",versions:[3,4],impl:O.Text},TOFN:{title:"Original filename",versions:[3,4],impl:O.Text},TDLY:{title:"Playlist delay",versions:[3,4],impl:O.Text},TSSE:{versions:[3,4],title:"Encoding Software/Hardware",impl:O.Text},TSST:{versions:[3,4],title:"Set subtitle",impl:O.Text},TDAT:{title:"Date",versions:[3],impl:O.Text},TIME:{title:"Time",versions:[3],impl:O.Text},TORY:{title:"Original release year",versions:[3],impl:O.Text},TRDA:{title:"Recording dates",versions:[3],impl:O.Text},TSIZ:{title:"Size",versions:[3],impl:O.Text},TYER:{title:"Year",versions:[3],impl:O.Text},TMCL:{versions:[4],title:"Musician credits list",impl:O.TextList},TIPL:{versions:[4],title:"Involved people list",impl:O.TextList},TMOO:{title:"Mood",versions:[4],impl:O.Text},TPRO:{title:"Produced notice",versions:[4],impl:O.Text},TDOR:{title:"Original release time",versions:[4],impl:O.Text},TDRC:{versions:[4],title:"Recording time",impl:O.Text},TDRL:{versions:[3,4],title:"Release time",impl:O.Text},TDTG:{versions:[4],title:"Tagging time",impl:O.Text},TSOA:{versions:[4],title:"Album sort order",impl:O.Text},TSOP:{versions:[4],title:"Artist sort order",impl:O.Text},TSOT:{versions:[4],title:"Title sort order",impl:O.Text},WCOM:{title:"Commercial information",versions:[3,4],impl:O.Text},WCOP:{title:"Copyright/Legal information",versions:[3,4],impl:O.Text},WOAF:{title:"Official audio file webpage",versions:[3,4],impl:O.Text},WOAR:{title:"Official artist/performer webpage",versions:[3,4],impl:O.Text},WOAS:{title:"Official audio source webpage",versions:[3,4],impl:O.Text},WORS:{title:"Official internet radio station homepage",versions:[3,4],impl:O.Text},WPAY:{title:"Payment",versions:[3,4],impl:O.Text},WPUB:{title:"Publishers official webpage",versions:[3,4],impl:O.Text},TXXX:{title:"User defined text",versions:[3,4],impl:O.IdText},WXXX:{title:"User defined URL link frame",versions:[3,4],impl:O.IdText},UFID:{title:"Unique file identifier",versions:[3,4],impl:O.IdText},MCDI:{title:"Music CD identifier",versions:[3,4],impl:O.MusicCDId},ETCO:{title:"Event timing codes",versions:[3,4],impl:O.ETCO},MLLT:{title:"MPEG location lookup table",versions:[3,4],impl:O.Unknown},SYTC:{title:"Synchronised tempo codes",versions:[3,4],impl:O.Unknown},USLT:{title:"Lyrics",versions:[3,4],impl:O.LangDescText},SYLT:{title:"Synchronised Lyrics",versions:[3,4],impl:O.SYLT},COMM:{title:"Comments",versions:[3,4],impl:O.LangDescText},RVAD:{title:"Relative volume adjustment",versions:[3,4],impl:O.RVAD},RVA2:{title:"Relative volume adjustment 2",versions:[4],impl:O.RVAD2},EQUA:{title:"Equalisation",versions:[3,4],impl:O.Unknown},RVRB:{title:"Reverb",versions:[3,4],impl:O.Unknown},APIC:{title:"Attached picture",versions:[3,4],impl:O.Pic},GEOB:{title:"General encapsulated object",versions:[3,4],impl:O.GEOB},PCNT:{title:"Play counter",versions:[3,4],impl:O.PlayCounter},POPM:{title:"Popularimeter",versions:[3,4],impl:O.Popularimeter},RBUF:{title:"Recommended buffer size",versions:[3,4],impl:O.Unknown},AENC:{title:"Audio encryption",versions:[3,4],impl:O.AENC},LINK:{title:"Linked information",versions:[3,4],impl:O.LINK},POSS:{title:"Position synchronisation",versions:[3,4],impl:O.Unknown},USER:{title:"Terms of use",versions:[3,4],impl:O.Unknown},OWNE:{title:"Ownership",versions:[3,4],impl:O.Unknown},COMR:{title:"Commercial",versions:[3,4],impl:O.Unknown},ENCR:{title:"Encryption method registration",versions:[3,4],impl:O.Unknown},GRID:{title:"Group ID registration",versions:[3,4],impl:O.Unknown},PRIV:{title:"Private frame",versions:[3,4],impl:O.IdBin},IPLS:{title:"Involved people list",versions:[3],impl:O.TextList},SIGN:{title:"Signature",versions:[4],impl:O.Unknown},SEEK:{title:"Seek",versions:[4],impl:O.Unknown},ASPI:{title:"Audio seek point index",versions:[4],impl:O.Unknown},RGAD:{title:"Replay Gain Adjustment",versions:[3,4],impl:O.RGAD},TCMP:{title:"iTunes Compilation Flag",versions:[3,4],impl:O.Bool},TSO2:{title:"Album Artist sort order",versions:[3,4],impl:O.Text},TSOC:{title:"Composer sort order",versions:[3,4],impl:O.Text},PCST:{title:"iTunes podcast marker",versions:[3,4],impl:O.PCST},TDES:{title:"iTunes podcast description",versions:[3,4],impl:O.Text},TKWD:{title:"iTunes podcast keywords",versions:[3,4],impl:O.Unknown},TGID:{title:"Podcast URL",versions:[3,4],impl:O.Text},TDEN:{title:"Encoding time",versions:[3,4],impl:O.Text},WFED:{title:"Podcast feed URL",versions:[3,4],impl:O.Text},GRP1:{title:"Group Number",versions:[3,4],impl:O.Text},NCON:{title:"MusicMatch Binary",versions:[3,4],impl:O.Unknown},CTOC:{title:"Chapter TOC",versions:[4],impl:O.CTOC},CHAP:{title:"Chapter",versions:[4],impl:O.CHAP},XHD3:{title:"mp3hd",versions:[3,4],impl:O.Unknown},CM1:{title:"User defined text",versions:[2],impl:O.Text,upgrade:"TXXX"}},P={ASIN:"ASIN Id",CATALOGNUMBER:"Catalog Nr",SCRIPT:"Script",BARCODE:"Barcode",originalyear:"Original Year",replaygain_track_gain:"Replaygain track gain",replaygain_album_gain:"Replaygain album gain",replaygain_track_peak:"Replaygain track peak",replaygain_album_peak:"Replaygain album peak",Artists:"Artists",Supplier:"Supplier","Release type":"Release type","Acoustid Id":"Acoustid Id","MusicBrainz Track Disambiguation":"MusicBrainz Track Disambiguation","MusicBrainz Album Type":"MusicBrainz Album Type","MusicBrainz Album Artist Id":"MusicBrainz Album Artist Id","MusicBrainz Artist Id":"MusicBrainz Artist Id","MusicBrainz Album Id":"MusicBrainz Album Id","MusicBrainz Release Track Id":"MusicBrainz Release Track Id","MusicBrainz Release Group Id":"MusicBrainz Release Group Id","MusicBrainz Recording Id":"MusicBrainz Recording Id","MusicBrainz Album Status":"MusicBrainz Album Status","MusicBrainz Album Release Country":"MusicBrainz Album Release Country","MusicBrainz TRM Id":"MusicBrainz TRM Id","Discogs Artist ID":"Discogs Artist Id","Discogs Label ID":"Discogs Label Id","Discogs Master Release ID":"Discogs Master Release Id","Discogs Release ID":"Discogs Master Release Id","Discogs Votes":"Discogs Votes","Discogs Rating":"Discogs Rating"},_={"http://musicbrainz.org":"MusicBrainz Track Id"},w={"http://musicbrainz.org":"MusicBrainz Track Id","":"Default Comment"},A=[{id:"internal_file",width:200,force:!0},{id:"TRCK",width:60,force:!0},{id:"TIT2",width:200,force:!0},{id:"TALB",width:200,force:!0},{id:"TPE1",width:140,force:!0},{id:"TPE2",width:140,force:!0},{id:"TOPE",width:140},{id:"TCON",width:100,force:!0},{id:"TPOS",width:60,force:!0},{id:"TIT1",width:200,force:!0},{id:"GRP1",width:60,force:!0},{id:"TMOO",width:100},{id:"APIC",width:100,force:!0},{id:"USLT",width:200,force:!0},{id:"TSOP",width:140},{id:"TSO2",width:140},{id:"TXXX",subid:"Artists",width:140},{id:"IPLS",width:140},{id:"TIPL",width:140},{id:"TMCL",width:140},{id:"TYER",width:100},{id:"TDOR",width:100,force:!0},{id:"TDRC",width:100,force:!0},{id:"TDRL",width:80},{id:"TDAT",width:60},{id:"TORY",width:60},{id:"TXXX",subid:"originalyear",width:60},{id:"TXXX",subid:"MusicBrainz Album Type",width:100,force:!0},{id:"TXXX",subid:"MusicBrainz Album Status",width:60,force:!0},{id:"TXXX",subid:"MusicBrainz Album Release Country",width:60},{id:"TXXX",subid:"MusicBrainz Track Disambiguation",width:100},{id:"TXXX",subid:"Release type",width:100},{id:"TXXX",subid:"SCRIPT",width:60},{id:"TLAN",width:60},{id:"TMED",width:40},{id:"TLEN",width:60},{id:"TIME",width:60},{id:"TKEY",width:60},{id:"TBPM",width:60},{id:"APIC",width:80},{id:"TPUB",width:140},{id:"WPUB",width:140},{id:"WCOP",width:140},{id:"TCOP",width:140},{id:"TCOM",width:140},{id:"TSOC",width:140},{id:"MCDI",width:40},{id:"TXXX",subid:"Acoustid Id",width:40},{id:"TXXX",subid:"ASIN",width:100},{id:"UFID",subid:"http://musicbrainz.org",width:80},{id:"TXXX",subid:"MusicBrainz Release Track Id",width:80},{id:"TXXX",subid:"MusicBrainz Album Id",width:80},{id:"TXXX",subid:"MusicBrainz Album Artist Id",width:80},{id:"TXXX",subid:"MusicBrainz Artist Id",width:80},{id:"TXXX",subid:"MusicBrainz Release Group Id",width:80},{id:"TSSE",width:80},{id:"TFLT",width:80},{id:"TSST",width:80},{id:"TXXX",subid:"Ripping tool",width:80},{id:"TXXX",subid:"Ripping date",width:80},{id:"TDEN",width:80},{id:"TXXX",subid:"Rip date",width:80},{id:"TXXX",subid:"Source",width:80},{id:"TXXX",subid:"Supplier",width:80},{id:"TENC",width:80},{id:"TXXX",subid:"ASIN",width:110},{id:"TSRC",width:110},{id:"TXXX",subid:"BARCODE",width:110},{id:"PRIV",subid:"http://www.cdtag.com",width:100},{id:"TXXX",subid:"CATALOGNUMBER",width:110},{id:"TCMP",width:40},{id:"COMM",width:140},{id:"WXXX",width:140},{id:"GEOB",width:140}],R={0:"Other",1:"32x32 pixels 'file icon' (PNG only)",2:"Other file icon",3:"Cover (front)",4:"Cover (back)",5:"Leaflet page",6:"Media (e.g. lable side of CD)",7:"Lead artist/lead performer/soloist",8:"Artist/performer",9:"Conductor",10:"Band/Orchestra",11:"Composer",12:"Lyricist/text writer",13:"Recording Location",14:"During recording",15:"During performance",16:"Movie/video screen capture",17:"A bright coloured fish",18:"Illustration",19:"Band/artist logotype",20:"Publisher/Studio logotype"},I=r(81515);function S(e){var t,n={},i=o(e.cells);try{for(i.s();!(t=i.n()).done;){var r=t.value;if("internal_file"!==r.column.def.id){var a,c=o(r.frames);try{for(c.s();!(a=c.n()).done;){var s=a.value,l=n[r.column.def.id]||[];l.push(s),n[r.column.def.id]=l}}catch(u){c.e(u)}finally{c.f()}}}}catch(u){i.e(u)}finally{i.f()}return{version:4,frames:n}}function Z(e){var t=(0,I.RQ)(e);if((t=t.filter(function(e){return!isNaN(Number(e))})).length>0)return t[0]}function D(e){var t=e.cells.find(function(e){return"TPOS"===e.column.def.id});return"".concat(e.track.parentID,"|").concat(t&&t.frames.length>0?t.frames[0].value.text:"")}function B(e,t){var n=[],i="";if(t.frames.TPOS&&t.frames.TPOS.length>0){var r=t.frames.TPOS[0],a=(r.value.text||"").split("/")[0],o=(r.value.text||"").split("/")[1]||"99";if(Number(o)>1){for(;a.length<o.length;)a="0".concat(a);i+="".concat(a,"-")}}if(t.frames.TRCK&&t.frames.TRCK.length>0){for(var c=t.frames.TRCK[0],s=(c.value.text||"").split("/")[0],l=(c.value.text||"").split("/")[1]||"99";s.length<l.length;)s="0".concat(s);i+=s}n.push(i),t.frames.TIT2&&t.frames.TIT2.length>0&&n.push(t.frames.TIT2[0].value.text),t.frames.TPE1&&t.frames.TPE1.length>0&&n.push(t.frames.TPE1[0].value.text);var u=".".concat((0,I.VI)(e.name));return"".concat((0,I.kQ)(n.join(" - "),"")).concat(u)}var N=function(){function e(t){s(this,e),this.jam=t,this.columns=[],this.edits=[]}return a(e,[{key:"removeColumnText",value:function(e,t){var n,i=this.columns.indexOf(e),r=o(this.edits);try{for(r.s();!(n=r.n()).done;){var a=n.value,c=a.cells[i],s=c.frames.length>0?c.frames[0].value.text:void 0;s&&this.updateEditTextCell(a,e,s.replace(t,""))}}catch(l){r.e(l)}finally{r.f()}}},{key:"updateEditTextCell",value:function(e,t,n){var i=this.columns.indexOf(t),r=e.cells[i],a=n||"",o=[];a.length>0&&(o=[{id:r.column.def.id,value:O.LangDescText===t.def.impl?{id:"",language:"",text:a}:{id:r.column.def.subid,text:a}}]),0!==r.frames.length&&r.frames[0].value.text===a||(e.cells[i]={parent:e,track:r.track,column:t,frames:o,changed:!0},e.changed=!0)}},{key:"setColumnTrackNrFromFile",value:function(e){var t,n={},i=o(this.edits);try{for(i.s();!(t=i.n()).done;){var r=D(t.value);n[r]=(n[r]||0)+1}}catch(d){i.e(d)}finally{i.f()}var a,c=o(this.edits);try{for(c.s();!(a=c.n()).done;){var s=a.value,l=Z(s.track.name);if(l){var u="".concat(l,"/").concat((n[D(s)]||0).toString());this.updateEditTextCell(s,e,u)}}}catch(d){c.e(d)}finally{c.f()}}},{key:"setColumnFilenames",value:function(e){var t,n=this.columns.indexOf(e),i=o(this.edits);try{for(i.s();!(t=i.n()).done;){var r=t.value,a=B(r.cells[n].track,S(r));this.updateEditTextCell(r,e,a)}}catch(c){i.e(c)}finally{i.f()}}},{key:"setColumnTrackNrByIndex",value:function(e){var t,n={},i={},r=o(this.edits);try{for(r.s();!(t=r.n()).done;){var a=D(t.value);n[a]=(n[a]||0)+1}}catch(g){r.e(g)}finally{r.f()}var c,s=o(this.edits);try{for(s.s();!(c=s.n()).done;){var l=c.value,u=D(l);i[u]=(i[u]||0)+1;var d="".concat((i[u]||0).toString(),"/").concat((n[u]||0).toString());this.updateEditTextCell(l,e,d)}}catch(g){s.e(g)}finally{s.f()}}},{key:"addIndexToTitleCol",value:function(e){var t=this,n=this.columns.indexOf(e);this.edits.forEach(function(i,r){var a=i.cells[n],o=a.frames.length>0?a.frames[0].value.text:"";o="".concat(o," ").concat((r+1).toString()).trim(),t.updateEditTextCell(i,e,o)})}},{key:"setColumnPartOfSet",value:function(e){var t,n=this.columns.indexOf(e),i=[],r=o(this.edits);try{for(r.s();!(t=r.n()).done;){var a=t.value;i.includes(a.track.parentID)||i.push(a.track.parentID)}}catch(d){r.e(d)}finally{r.f()}var c,s=o(this.edits);try{for(s.s();!(c=s.n()).done;){var l=c.value,u="".concat((i.indexOf(l.cells[n].track.parentID)+1).toString(),"/").concat(i.length.toString());this.updateEditTextCell(l,e,u)}}catch(d){s.e(d)}finally{s.f()}}},{key:"setColumnTotalTrack",value:function(e){var t,n=this,i={},r=o(this.edits);try{for(r.s();!(t=r.n()).done;){var a=t.value;i[a.track.parentID]=(i[a.track.parentID]||0)+1}}catch(s){r.e(s)}finally{r.f()}var c=this.columns.indexOf(e);this.edits.forEach(function(t,r){var a,o=t.cells[c];o.frames.length>0?(a=o.frames[0].value.text.split("/")[0],isNaN(Number(a))||(a=Number(a).toString())):a=Z(t.track.name),a||(a=(r+1).toString());var s="".concat(a||"","/").concat((i[t.track.parentID]||0).toString());n.updateEditTextCell(t,e,s)})}},{key:"setAlbumArtistFrames",value:function(e){var t=this.columns.findIndex(function(e){return"TPE1"===e.def.id});if(t>=0){var n,i=o(this.edits);try{for(i.s();!(n=i.n()).done;){var r=n.value,a=r.cells[t],c=a.frames.length>0?a.frames[0].value.text:void 0;c&&this.updateEditTextCell(r,e,c)}}catch(s){i.e(s)}finally{i.f()}}}},{key:"setReleaseDateFromYearFrames",value:function(e){this.copyColumn(this.columns.findIndex(function(e){return"TYER"===e.def.id}),e)}},{key:"getCellText",value:function(e){return e.frames.length>0?e.frames[0].value.text:void 0}},{key:"findMissingLyrics",value:function(e){var t;return(0,C.mG)(this,void 0,void 0,regeneratorRuntime.mark(function n(){var i,r,a,c,s,l,u,d,g,h;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:i=this.columns.findIndex(function(e){return"USLT"===e.def.id}),r=e||this.columns[i],a=this.columns.findIndex(function(e){return"TPE1"===e.def.id}),c=this.columns.findIndex(function(e){return"TIT2"===e.def.id}),s=o(this.edits),n.prev=2,s.s();case 4:if((l=s.n()).done){n.next=15;break}if(u=l.value,this.getCellText(u.cells[i])){n.next=13;break}if(d=this.getCellText(u.cells[a]),!(g=this.getCellText(u.cells[c]))||!d){n.next=13;break}return n.next=11,this.jam.metadata.lyricsovhSearch({title:g,artist:d});case 11:h=n.sent,(null===(t=null==h?void 0:h.data)||void 0===t?void 0:t.lyrics)&&this.updateEditTextCell(u,r,h.data.lyrics);case 13:n.next=4;break;case 15:n.next=20;break;case 17:n.prev=17,n.t0=n.catch(2),s.e(n.t0);case 20:return n.prev=20,s.f(),n.finish(20);case 23:case"end":return n.stop()}},n,this,[[2,17,20,23]])}))}},{key:"insertFromColumn",value:function(e,t,n){var i=this.columns.indexOf(n);if(e>=0){var r,a=o(this.edits);try{for(a.s();!(r=a.n()).done;){var c=r.value,s=this.getCellText(c.cells[e]),l=this.getCellText(c.cells[i])||"";if(s){var u=l.slice(0,t)+s+l.slice(t);this.updateEditTextCell(c,n,u)}}}catch(d){a.e(d)}finally{a.f()}}}},{key:"copyColumn",value:function(e,t){if(e>=0){var n,i=o(this.edits);try{for(i.s();!(n=i.n()).done;){var r=n.value,a=r.cells[e],c=a.frames.length>0?a.frames[0].value.text:void 0;c&&this.updateEditTextCell(r,t,c)}}catch(s){i.e(s)}finally{i.f()}}}},{key:"appendFromColumn",value:function(e,t){var n=this.columns.indexOf(t);if(e>=0){var i,r=o(this.edits);try{for(r.s();!(i=r.n()).done;){var a=i.value,c=this.getCellText(a.cells[e]);if(c){var s=this.getCellText(a.cells[n])||"";this.updateEditTextCell(a,t,s+c)}}}catch(l){r.e(l)}finally{r.f()}}}},{key:"setColumnText",value:function(e,t){var n,i=o(this.edits);try{for(i.s();!(n=i.n()).done;){var r=n.value;this.updateEditTextCell(r,e,t)}}catch(a){i.e(a)}finally{i.f()}}},{key:"appendColumnText",value:function(e,t){var n,i=this.columns.indexOf(e),r=o(this.edits);try{for(r.s();!(n=r.n()).done;){var a=n.value,c=this.getCellText(a.cells[i])||"";this.updateEditTextCell(a,e,c+t)}}catch(s){r.e(s)}finally{r.f()}}},{key:"setColumnFromTitleFrames",value:function(e){this.copyColumn(this.columns.findIndex(function(e){return"TIT2"===e.def.id}),e)}},{key:"clearColumn",value:function(e){var t,n=this.columns.indexOf(e),i=o(this.edits);try{for(i.s();!(t=i.n()).done;){var r=t.value;r.cells[n].frames.length>0&&(r.cells[n]={parent:r,track:r.cells[n].track,column:r.cells[n].column,frames:[],changed:!0},r.changed=!0)}}catch(a){i.e(a)}finally{i.f()}}},{key:"setAudiobookFrames",value:function(){var e,t=this.columns.find(function(e){return"TCON"===e.def.id}),n=this.columns.find(function(e){return"TXXX"===e.def.id&&"MusicBrainz Album Type"===e.def.subid}),i=o(this.edits);try{for(i.s();!(e=i.n()).done;){var r=e.value;t&&this.updateEditTextCell(r,t,"Audiobook"),n&&this.updateEditTextCell(r,n,"album/audiobook")}}catch(a){i.e(a)}finally{i.f()}}},{key:"setAudioSeriesFrames",value:function(){var e,t=this.columns.find(function(e){return"TCON"===e.def.id}),n=this.columns.find(function(e){return"TXXX"===e.def.id&&"MusicBrainz Album Type"===e.def.subid}),i=o(this.edits);try{for(i.s();!(e=i.n()).done;){var r=e.value;t&&this.updateEditTextCell(r,t,"Audio Series"),n&&this.updateEditTextCell(r,n,"album/audiodrama")}}catch(a){i.e(a)}finally{i.f()}}},{key:"setSoundtrackFrames",value:function(){var e,t=this.columns.find(function(e){return"TCON"===e.def.id}),n=this.columns.find(function(e){return"TXXX"===e.def.id&&"MusicBrainz Album Type"===e.def.subid}),i=o(this.edits);try{for(i.s();!(e=i.n()).done;){var r=e.value;t&&this.updateEditTextCell(r,t,"Soundtrack"),n&&this.updateEditTextCell(r,n,"album/soundtrack")}}catch(a){i.e(a)}finally{i.f()}}},{key:"setBootlegFrames",value:function(){var e,t=this.columns.find(function(e){return"TXXX"===e.def.id&&"MusicBrainz Album Status"===e.def.subid}),n=this.columns.find(function(e){return"TXXX"===e.def.id&&"MusicBrainz Album Type"===e.def.subid}),i=o(this.edits);try{for(i.s();!(e=i.n()).done;){var r=e.value;t&&this.updateEditTextCell(r,t,"bootleg"),n&&this.updateEditTextCell(r,n,"album/live")}}catch(a){i.e(a)}finally{i.f()}}},{key:"build",value:function(e){this.edits=[],this.upgradeTrackTags(e),this.buildColumns(e),this.buildEdits(e)}},{key:"upgradeTrackTags",value:function(e){var t,n=o(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;this.upgradeTrackTag(i)}}catch(r){n.e(r)}finally{n.f()}}},{key:"upgradeTrackTag",value:function(t){var n=t.tagRaw;if(n&&void 0!==n.version&&n.version<4){var i=e.getRawTagFrames(n),r={version:4,frames:{}},a=this.upgradeDateFramesTov24Date(i);a&&(i=i.filter(function(e){return!a.dateFrames.includes(e)})).push(a.newFrame);var c,s=o(i);try{for(s.s();!(c=s.n()).done;){var l=c.value,u=this.ensureID3v2FrameVersionDef(l.id,4);u?(l.id=u,r.frames[u]=r.frames[u]||[],r.frames[u].push(l)):console.error("upgradeTrackTag","missing id3v2 update",l.id,"=>",u)}}catch(d){s.e(d)}finally{s.f()}t.tagRaw=r}}},{key:"ensureID3v2FrameVersionDef",value:function(e,t){var n=y[e];if(n){if(n.versions.indexOf(t)>=0)return e;if(n.versions[0]>t){var i=Object.keys(y).find(function(t){return y[t].upgrade===e});if(!i)return void console.error("ensureID3v2FrameVersionDef: Missing v2.".concat(n.versions," -> v2.").concat(t," mapping ").concat(e));var r=y[i];return r.versions.indexOf(t)<0?r.versions[0]>t?this.ensureID3v2FrameVersionDef(i,t):void 0:i}if(n.upgrade){var a=n.upgrade,o=y[a];return o.versions.indexOf(t)<0?o.versions[0]<t?this.ensureID3v2FrameVersionDef(a,t):void 0:a}console.error("ensureID3v2FrameVersionDef: Missing v2.".concat(n.versions," -> v2.").concat(t," mapping ").concat(e))}}},{key:"upgradeDateFramesTov24Date",value:function(e){var t=e.find(function(e){return["TYER","TYE"].indexOf(e.id)>=0}),n=e.find(function(e){return["TDAT","TDA"].indexOf(e.id)>=0}),i=e.find(function(e){return["TIME","TIM"].indexOf(e.id)>=0});if(t||n||i){var r=[],a=[];return t&&t.value&&Object.prototype.hasOwnProperty.call(t.value,"text")&&(r.push(t),a.push(t.value.text)),n&&n.value&&Object.prototype.hasOwnProperty.call(n.value,"text")&&(r.push(n),a.push(n.value.text)),i&&i.value&&Object.prototype.hasOwnProperty.call(i.value,"text")&&(r.push(i),a.push(i.value.text)),{newFrame:{id:"TDRC",value:{text:a.join("-")}},dateFrames:r}}}},{key:"updateColumns",value:function(e,t){var n,i=this,r=[],a=[],c=o(this.columns);try{var s=function(){var e=n.value;t.find(function(t){return t.id===e.def.id&&t.subid===e.def.subid})||r.push(e)};for(c.s();!(n=c.n()).done;)s()}catch(g){c.e(g)}finally{c.f()}var l,u=o(t);try{var d=function(){var e=l.value;if(!i.columns.find(function(t){return t.def.id===e.id&&t.def.subid===e.subid})){var t=i.frameDef2Column(e.id,e.subid,e.frameDef,0);a.push(t)}};for(u.s();!(l=u.n()).done;)d()}catch(g){u.e(g)}finally{u.f()}this.columns=this.columns.filter(function(e){return!r.includes(e)}).concat(a),this.buildEdits(e)}},{key:"getAutoCompleteList",value:function(e,t){if("TCON"===e.def.id)return b;if("TXXX"===e.def.id&&"MusicBrainz Album Type"===e.def.subid)return["album","album/compilation","album/soundtrack","album/spokenword","album/interview","album/audiobook","album/audiodrama","album/live","album/remix","album/dj-mix","album/mixtape/street","single","ep","broadcast","other","other/spokenword","other/audiodrama","other/interview"];if("TXXX"===e.def.id&&"MusicBrainz Album Status"===e.def.subid)return["official","promotional","bootleg","pseudo-release"];if("TPOS"===e.def.id)return["1/1","1/2","2/2","1/3","2/3","3/3","1/4","2/4","3/4","4/4"];var n,i=this.columns.indexOf(e),r=[],a=o(this.edits);try{for(a.s();!(n=a.n()).done;){var c=n.value.cells[i];if(c!==t&&c.frames.length>0&&c.frames[0].value&&c.frames[0].value.text){var s=c.frames[0].value.text;r.includes(s)||r.push(s)}}}catch(l){a.e(l)}finally{a.f()}return"TPE2"!==e.def.id||r.includes(x.HF)||r.push(x.HF),r}},{key:"setColumnActions",value:function(e,t,n,i){var r=this,a=[];[O.IdText,O.Text,O.LangDescText].includes(i)&&(e.multi=!0,"TRCK"===t?(a.push({icon:"icon-down-thin",title:"Set Track Nr by Index",click:function(){r.setColumnTrackNrByIndex(e)}}),a.push({icon:"icon-down-thin",title:"Set Track Nr by Filename",click:function(){r.setColumnTrackNrFromFile(e)}}),a.push({icon:"icon-down-thin",title:"Set Total Tracks",click:function(){r.setColumnTotalTrack(e)}})):"TPOS"===t?a.push({icon:"icon-down-thin",title:"Try find Part of Set",click:function(){r.setColumnPartOfSet(e)}}):"TIT2"===t?a.push({icon:"icon-down-thin",title:"Add Index Nr to Title",click:function(){r.addIndexToTitleCol(e)}}):"TPE2"===t?a.push({icon:"icon-down-thin",title:"Copy from Artist Column",click:function(){r.setAlbumArtistFrames(e)}}):"TALB"===t?a.push({icon:"icon-down-thin",title:"Copy from Title Column",click:function(){r.setColumnFromTitleFrames(e)}}):"TDOR"===t?a.push({icon:"icon-down-thin",title:"Copy from Year Column",click:function(){r.setReleaseDateFromYearFrames(e)}}):"USLT"===t&&a.push({icon:"icon-down-thin",title:"Search for missing Lyrics",click:function(){r.findMissingLyrics(e).catch(function(e){console.error(e)})}})),i!==O.Filename?a.push({icon:"icon-remove",title:"Clear all Cells in this Column",click:function(){r.clearColumn(e)}}):i===O.Filename&&a.push({icon:"icon-down-thin",title:"Set Filenames by Meta Data",click:function(){r.setColumnFilenames(e)}}),e.actions=a}},{key:"frameDef2Column",value:function(t,n,i,r){var a=this,o=e.getFrameDefName(t,n,i),c=i.impl;"UFID"===t&&_[n||""]&&(c=O.IdText);var s={def:{id:t,subid:n,name:o,width:r>=0?A[r].width:100,impl:c},sort:r>=0?r+1:-1,actions:[]};return this.setColumnActions(s,t,n,c),s.getAutoCompleteList=function(e){return a.getAutoCompleteList(s,e)},s}},{key:"frame2Column",value:function(e,t){var n=this,i={def:{id:e.id,name:e.id+(e.value&&e.value.id?" - ".concat(e.value.id):""),subid:e.value&&e.value.id?e.value.id:void 0,width:t>=0?A[t].width:100,impl:O.Unknown},sort:t,actions:[],getAutoCompleteList:function(e){return n.getAutoCompleteList(i,e)}};return i}},{key:"buildColumns",value:function(t){var n=this;this.columns=[],t&&0!==t.length&&(A.forEach(function(e,t){if(e.force){var i=n.frameDef2Column(e.id,e.subid,y[e.id],t);n.columns.push(i)}}),t.forEach(function(t){if(t.tagRaw&&t.tagRaw.frames){var i=e.getRawTagFrames(t.tagRaw);i.unshift({id:"internal_file",value:{text:t.name}});var r,a=o(i);try{var c=function(){var t=r.value;if(!n.columns.find(function(n){return e.matchColumn(t,n.def)})){var i,a=y[t.id],o=A.findIndex(function(n){return e.matchColumn(t,n)});if(a)t.value&&void 0!==t.value.id&&(i=t.value.id),n.columns.push(n.frameDef2Column(t.id,i,y[t.id],o));else n.columns.push(n.frame2Column(t,o))}};for(a.s();!(r=a.n()).done;)c()}catch(s){a.e(s)}finally{a.f()}}}))}},{key:"buildEdits",value:function(t){var n=this;this.columns.sort(function(e,t){return e.sort<0?1:t.sort<0?-1:e.sort-t.sort});var i=this.edits||[];this.edits=t.map(function(t){var r=[];r.push({id:"internal_file",value:{text:t.name}}),t.tagRaw&&Object.keys(t.tagRaw.frames).forEach(function(e){var n;r=r.concat((null===(n=t.tagRaw)||void 0===n?void 0:n.frames[e])||[])});var a=i.find(function(e){return e.track===t}),o={track:t,tag:t.tagRaw,cells:[],editing:!1,changed:!!a&&a.changed,saving:!1};return o.cells=function(t,i,r,a,o){return n.columns.map(function(n){var c=o?o.cells.find(function(e){return e.column.def.id===n.def.id&&e.column.def.subid===n.def.subid}):void 0;return{parent:a,track:t,tag:i,column:n,frames:c?c.frames:r.filter(function(t){return e.matchColumn(t,n.def)}),changed:!!c&&c.changed}})}(t,t.tagRaw,r,o,a),o})}}],[{key:"getRawTagFrames",value:function(e){var t=[];return Object.keys(e.frames).forEach(function(n){t=t.concat(e.frames[n])}),t}},{key:"getFrameDefName",value:function(e,t,n){var i=n.title,r=t||"";return n.impl===O.IdText?"TXXX"===e&&P[r]?i=P[r]:"UFID"===e&&_[r]?i=_[r]:t&&(i+=" (".concat(t,")")):n.impl===O.LangDescText?"COMM"===e&&w[r]?i=w[r]:t&&(i+=" (".concat(t,")")):n.impl===O.IdBin&&t&&(i+=" (".concat(t,")")),i}},{key:"matchColumn",value:function(e,t){return!!(!t.subid||e.value&&e.value.id&&e.value.id===t.subid)&&e.id===t.id}}]),e}(),F=r(37716),E=r(56377),J=r(75712),L=r(7940),q=r(59010),U=r(70279);function G(e,t){if(1&e&&(F.TgZ(0,"app-autocomplete-option-header"),F._uU(1),F.qZA()),2&e){var n=F.oxw().$implicit;F.xp6(1),F.Oqu(n.header)}}function X(e,t){if(1&e&&(F.ynx(0),F.YNc(1,G,2,1,"app-autocomplete-option-header",5),F.TgZ(2,"app-autocomplete-option",6),F._uU(3),F.qZA(),F.BQk()),2&e){var n=t.$implicit,i=F.oxw().$implicit;F.xp6(1),F.Q6J("ngIf",n.header),F.xp6(1),F.Q6J("option",n)("control",i),F.xp6(1),F.Oqu(n.data.text)}}function z(e,t){1&e&&F.YNc(0,X,4,4,"ng-container",4),2&e&&F.Q6J("ngForOf",t.$implicit.options)}var H=function(){return{allowEmpty:!0}},Q=function(){var e=function(){function e(){s(this,e),this.list=[],this.focused=!1,this.edit="",this.standalone=!1,this.field="text",this.value="",this.valueChange=new F.vpe}return a(e,[{key:"ngOnChanges",value:function(e){e.value&&e.value.currentValue&&e.value.currentValue!==this.edit&&(this.edit=e.value.currentValue)}},{key:"autocompleteGetData",value:function(e){return(0,C.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",0===e.length?this.list.map(function(e){return{data:e}}):this.list.filter(function(t){return t.text.includes(e)}).map(function(e){return{data:e}}));case 1:case"end":return t.stop()}},t,this)}))}},{key:"autocompleteSelectResult",value:function(e){return this.edit=e.data.text,this.edit}},{key:"autocompleteEnter",value:function(e){this.edit=e}},{key:"onValueChange",value:function(){this.value!==this.edit&&this.valueChange.emit(this.edit)}},{key:"onFocus",value:function(){this.focused=!0,void 0===this.edit&&(this.edit=""),this.getList&&(this.list=this.getList(this.data).map(function(e){return{text:e}}))}},{key:"onBlur",value:function(){this.focused=!1,this.list=[]}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=F.Xpm({type:e,selectors:[["app-tag-editor-autocomplete"]],inputs:{standalone:"standalone",field:"field",value:"value",data:"data",getList:"getList",onAutoComplete:"onAutoComplete"},outputs:{valueChange:"valueChange"},features:[F.TTD],decls:5,vars:10,consts:[["autocomplete","appAutocomplete"],["appAutocompleteContent",""],[1,"input-group"],["type","text","name","auto","autocomplete","off",3,"ngModel","value","appAutocomplete","appAutocompleteControl","appAutocompleteSettings","ngModelChange","change","focus","blur"],[4,"ngFor","ngForOf"],[4,"ngIf"],[3,"option","control"]],template:function(e,t){if(1&e&&(F.TgZ(0,"app-autocomplete",null,0),F.YNc(2,z,1,1,"ng-template",1),F.qZA(),F.TgZ(3,"div",2),F.TgZ(4,"input",3),F.NdJ("ngModelChange",function(e){return t.edit=e})("change",function(){return t.onValueChange()})("focus",function(){return t.onFocus()})("blur",function(){return t.onBlur()}),F.qZA(),F.qZA()),2&e){var n=F.MAs(1);F.xp6(3),F.ekj("focused",t.focused)("cell",!t.standalone),F.xp6(1),F.Q6J("ngModel",t.edit)("value",t.edit)("appAutocomplete",n)("appAutocompleteControl",t)("appAutocompleteSettings",F.DdM(9,H))}},directives:[E.Y,J.G,u.Fj,u.JJ,u.On,L.oK,l.sg,l.O5,q.x,U.B],styles:["[_nghost-%COMP%]{width:100%}[_nghost-%COMP%]   .input-group[_ngcontent-%COMP%]{height:100%;width:100%}[_nghost-%COMP%]   .input-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{height:100%;width:100%;background-color:var(--input);color:var(--on-input);border-radius:3px;padding-left:3px;padding-right:3px}[_nghost-%COMP%]   .input-group.cell[_ngcontent-%COMP%]{display:block;border:none}[_nghost-%COMP%]   .input-group.cell[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding-left:0;padding-right:0;border-radius:0;border:none;color:inherit;background-color:inherit}"],changeDetection:0}),e}(),Y=function(){return{standalone:!0}};function j(e,t){if(1&e){var n=F.EpF();F.TgZ(0,"div",1),F.TgZ(1,"input",2),F.NdJ("ngModelChange",function(e){return F.CHM(n).$implicit.enabled=e}),F.qZA(),F.TgZ(2,"label"),F._uU(3),F.qZA(),F.TgZ(4,"app-tag-editor-autocomplete",3),F.NdJ("valueChange",function(e){return F.CHM(n).$implicit.value=e}),F.qZA(),F.qZA()}if(2&e){var i=t.$implicit;F.xp6(1),F.Q6J("ngModel",i.enabled)("ngModelOptions",F.DdM(6,Y)),F.xp6(2),F.Oqu(i.title),F.xp6(1),F.Q6J("value",i.value)("getList",i.getList)("standalone",!0)}}var V=function(){var e=function(){function e(){var t=this;s(this,e),this.edit={title:{title:"Album Title",value:"",enabled:!0,autocomplete:[]},artist:{title:"Artist",value:"",enabled:!1,autocomplete:[]},albumArtist:{title:"Album Artist",value:"",enabled:!0,autocomplete:[]},originalReleaseTime:{title:"Original Release Time",value:"",enabled:!0,autocomplete:[]},recordingTime:{title:"Recording Time",value:"",enabled:!0,autocomplete:[]},genre:{title:"Genre",value:"",enabled:!0,autocomplete:[]},part:{title:"Part of Set",value:"",enabled:!0,autocomplete:[]},status:{title:"Album Status",value:"",enabled:!0,autocomplete:[]},type:{title:"Album Type",value:"",enabled:!0,autocomplete:[]}},this.edits=Object.keys(this.edit).map(function(e){var n=t.edit[e];return n.getList=function(){return t.getAutoCompleteList(n)},n})}return a(e,[{key:"getAutoCompleteList",value:function(e){return e.autocomplete}},{key:"dialogInit",value:function(e,t){this.data=t.data}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=F.Xpm({type:e,selectors:[["app-dialog-album"]],decls:3,vars:1,consts:[["class","user-form-control",4,"ngFor","ngForOf"],[1,"user-form-control"],["type","checkbox",3,"ngModel","ngModelOptions","ngModelChange"],[3,"value","getList","standalone","valueChange"]],template:function(e,t){1&e&&(F.TgZ(0,"div"),F.TgZ(1,"form"),F.YNc(2,j,5,7,"div",0),F.qZA(),F.qZA()),2&e&&(F.xp6(2),F.Q6J("ngForOf",t.edits))},directives:[u._Y,u.JL,u.F,l.sg,u.Wl,u.JJ,u.On,Q],styles:["[_nghost-%COMP%]   .user-form-control[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]{width:100%}"]}),e}();function W(e,t){if(1&e){var n=F.EpF();F.TgZ(0,"div",7),F.TgZ(1,"div",8),F.TgZ(2,"label"),F.TgZ(3,"input",9),F.NdJ("ngModelChange",function(e){return F.CHM(n).$implicit.checked=e})("change",function(){var e=F.CHM(n).$implicit;return F.oxw().checkChange(e)}),F.qZA(),F._uU(4),F.qZA(),F.qZA(),F.TgZ(5,"div",10),F._uU(6),F.qZA(),F.qZA()}if(2&e){var i=t.$implicit;F.xp6(3),F.Q6J("ngModel",i.checked)("checked",i.checked),F.xp6(1),F.hij(" ",i.name||i.frameDef.title," "),F.xp6(2),F.hij(" ",i.id," ")}}var K,$=function(){var e=function(){function e(){s(this,e),this.filteredColumns=[],this.allColumns=[],this.version=4,this.urls={2:"http://id3.org/id3v2-00",3:"http://id3.org/id3v2.3.0",4:"http://id3.org/id3v2.4.0-frames"}}return a(e,[{key:"checkChange",value:function(e){this.setResult()}},{key:"setResult",value:function(){this.data&&(this.data.resultColumns=this.filteredColumns.filter(function(e){return e.checked}))}},{key:"refresh",value:function(){var e=this;this.filteredColumns=this.allColumns.filter(function(t){return t.frameDef.versions.includes(e.version)}),this.setResult()}},{key:"setVersion",value:function(e){this.version=e,this.refresh()}},{key:"dialogInit",value:function(e,t){var n,i=this;this.data=t.data,this.allColumns=[];var r=(null===(n=this.data)||void 0===n?void 0:n.columns)||[];Object.keys(y).forEach(function(e){var t,n="TXXX"===(t=e)?Object.keys(P).map(function(e){return{subid:e,name:P[e]}}):"UFID"===t?Object.keys(_).map(function(e){return{subid:e,name:_[e]}}):"COMM"===t?Object.keys(w).map(function(e){return{subid:e,name:w[e]}}):[];if(0===n.length){var a=r.find(function(t){return t.def.id===e});i.allColumns.push({id:e,frameDef:y[e],column:a,checked:!!a})}else{var c,s=o(n);try{var l=function(){var t=c.value,n=r.find(function(n){return n.def.id===e&&n.def.subid===t.subid});i.allColumns.push({id:e,subid:t.subid,name:t.name,frameDef:y[e],column:n,checked:!!n})};for(s.s();!(c=s.n()).done;)l()}catch(u){s.e(u)}finally{s.f()}}}),this.allColumns=this.allColumns.sort(function(e,t){return(e.name||e.frameDef.title).localeCompare(t.name||t.frameDef.title)}),this.refresh()}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=F.Xpm({type:e,selectors:[["app-dialog-choose-columns"]],decls:19,vars:6,consts:[[1,"choose-version"],[1,"select"],["type","radio","name","release",3,"checked","click"],["target","_blank","rel","noopener",3,"href"],[1,"icon-info"],[1,"columns"],["class","column",4,"ngFor","ngForOf"],[1,"column"],[1,"title"],["type","checkbox",3,"ngModel","checked","ngModelChange","change"],[1,"id"]],template:function(e,t){1&e&&(F.TgZ(0,"form",0),F.TgZ(1,"fieldset"),F.TgZ(2,"span"),F._uU(3,"ID3v2 Tag Version"),F.qZA(),F.TgZ(4,"label",1),F.TgZ(5,"input",2),F.NdJ("click",function(){return t.setVersion(4)}),F.qZA(),F._uU(6," 2.4"),F.qZA(),F.TgZ(7,"label",1),F.TgZ(8,"input",2),F.NdJ("click",function(){return t.setVersion(3)}),F.qZA(),F._uU(9," 2.3"),F.qZA(),F.TgZ(10,"label",1),F.TgZ(11,"input",2),F.NdJ("click",function(){return t.setVersion(2)}),F.qZA(),F._uU(12," 2.2"),F.qZA(),F._UZ(13,"br"),F.TgZ(14,"a",3),F._UZ(15,"i",4),F._uU(16),F.qZA(),F.qZA(),F.qZA(),F.TgZ(17,"div",5),F.YNc(18,W,7,4,"div",6),F.qZA()),2&e&&(F.xp6(5),F.Q6J("checked",4==t.version),F.xp6(3),F.Q6J("checked",3==t.version),F.xp6(3),F.Q6J("checked",2==t.version),F.xp6(3),F.Q6J("href",t.urls[t.version],F.LSH),F.xp6(2),F.hij(" ",t.urls[t.version],""),F.xp6(2),F.Q6J("ngForOf",t.filteredColumns))},directives:[u._Y,u.JL,u.F,l.sg,u.Wl,u.JJ,u.On],styles:["[_nghost-%COMP%]   .choose-version[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{margin-left:15px}[_nghost-%COMP%]   .choose-version[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{font-size:.8em}[_nghost-%COMP%]   .columns[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap}[_nghost-%COMP%]   .column[_ngcontent-%COMP%]{width:33%;border-left-color:var(--control-border);border-bottom:0 solid var(--control-border);border-right-color:var(--control-border);border-top:1px solid var(--control-border);padding-top:5px;padding-bottom:5px;padding-right:15px;display:flex;flex-flow:row nowrap;align-items:center;font-size:.8em}[_nghost-%COMP%]   .column[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{color:var(--on-control-hover)}[_nghost-%COMP%]   .column[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.8em;color:var(--on-control)}[_nghost-%COMP%]   .column[_ngcontent-%COMP%]   .id[_ngcontent-%COMP%]{margin-left:auto;width:80px;padding-right:15px;text-align:right;font-size:.8em}[_nghost-%COMP%]   .column[_ngcontent-%COMP%]:last-child{border-bottom-width:1px}@media (max-width:1400px){[_nghost-%COMP%]   .column[_ngcontent-%COMP%]{width:50%}}@media (max-width:768px){[_nghost-%COMP%]   .column[_ngcontent-%COMP%]{width:100%}}"]}),e}();function ee(e,t){var n=[];if(e){var i,r=o(e);try{for(r.s();!(i=r.n()).done;){var a=i.value;if(a.recordings){var c,s=o(a.recordings);try{for(s.s();!(c=s.n()).done;){var l=c.value;if(l.releasegroups&&l.id){var u,d=o(l.releasegroups);try{for(d.s();!(u=d.n()).done;){var g=u.value;if(g.id&&g.releases){var h,f=o(g.releases);try{for(f.s();!(h=f.n()).done;){var p=h.value;if(p.id&&p.mediums){var m,v=o(p.mediums);try{for(v.s();!(m=v.n()).done;){var C=m.value;n.push({releaseGroupID:g.id,releaseGroupName:g.title,releaseID:p.id,releaseName:p.title,mediaNr:C.position,mediaTrackCount:C.track_count,recordingID:l.id,recordingName:l.title,recordingDuration:l.duration,trackID:t.id,trackName:t.name,trackDuration:t.duration,score:a.score,acoustID:a.id})}}catch(M){v.e(M)}finally{v.f()}}}}catch(M){f.e(M)}finally{f.f()}}}}catch(M){d.e(M)}finally{d.f()}}}}catch(M){s.e(M)}finally{s.f()}}}}catch(M){r.e(M)}finally{r.f()}}return n}var te=function(){function e(){s(this,e),this.releasegroups=[]}return a(e,[{key:"add",value:function(e){var t=this.releasegroups.find(function(t){return t.id===e.releaseGroupID});t||(t={id:e.releaseGroupID,name:e.releaseGroupName,releases:[],score:0},this.releasegroups.push(t));var n=t.releases.find(function(t){return t.id===e.releaseID});n||(n={id:e.releaseID,name:e.releaseName,mediums:[],score:0},t.releases.push(n));var i=n.mediums.find(function(t){return t.nr===e.mediaNr});i||(i={nr:e.mediaNr,recordings:[],trackCount:e.mediaTrackCount,score:0},n.mediums.push(i));var r=i.recordings.find(function(t){return t.id===e.recordingID});r||(r={id:e.recordingID,name:e.recordingName,duration:e.recordingDuration,matches:[]},i.recordings.push(r));var a=r.matches.find(function(t){return t.trackID===e.trackID});a?a.score<e.score&&(a.score=e.score):r.matches.push({trackID:e.trackID,trackName:e.trackName,trackDuration:e.trackDuration,score:e.score,acoustID:e.acoustID})}}]),e}();function ne(e){return e.replace(/[& \-.]/g,"").toLowerCase()}function ie(e){var t=ne(e);return K||(K={},b.forEach(function(e){K[ne(e)]=e})),K[t]}function re(e,t){var n,i=e.slice(0),r=o(t);try{var a=function(){var e=n.value,t=i.find(function(t){return t.name===e.name});t?t.count+=e.count:i.push(e)};for(r.s();!(n=r.n()).done;)a()}catch(c){r.e(c)}finally{r.f()}return i}function ae(e){if(!e)return[];var t,n=[],i=o(e);try{var r=function(){var e=ie(t.value.name);if(e){var i=n.find(function(t){return t.name===e});i?i.count+=1:n.push({name:e,count:1})}};for(i.s();!(t=i.n()).done;)r()}catch(a){i.e(a)}finally{i.f()}return n}function oe(e){return e.replace(/[ .\-()[\]]/g,"").toLowerCase()}var ce=function(){function e(t,n,i){s(this,e),this.mbTrack=t,this.index=i,this.matchings=[],this.matchings=this.createMatchingScores(n),this.currentMatch=this.matchings[0]}return a(e,[{key:"createMatchingScores",value:function(e){var t=this,n=[];return e.forEach(function(e,i){var r={match:e,score:0,scores:t.createScores(e,i)};r.score=function(e){var t=e.map(function(e){return[e.score*e.weight,e.weight]}).reduce(function(e,t){return[e[0]+t[0],e[1]+t[1]]},[0,0]);return t[0]/t[1]}(r.scores),n.push(r)}),n=n.filter(function(e){return e.score>0}).sort(function(e,t){return t.score-e.score})}},{key:"createScores",value:function(e,t){var n=[];return this.scoreTitle(e,n),this.scoreTrackNr(e,n),this.scoreDuration(e,n),this.scoreAcoustid(e,n),n.push({name:"index",score:t===this.index?1:0,weight:.1}),n}},{key:"scoreAcoustid",value:function(e,t){var n;if(e.acoustidEntries&&(null===(n=this.mbTrack.recording)||void 0===n?void 0:n.id)){var i=this.mbTrack.recording.id,r=e.acoustidEntries.find(function(e){return e.recordingID===i});r&&t.push({name:"acoustid",score:r.score,weight:1})}}},{key:"scoreDuration",value:function(e,t){if(void 0!==this.mbTrack.length){var n=Math.abs(1e3*Math.round(e.track.duration||0)-(this.mbTrack.length||0)),i=0;0===n?i=1:n<1e3?i=.8:n<1e4&&(i=.2),t.push({name:"duration",score:i,weight:.2})}}},{key:"scoreTrackNr",value:function(e,t){var n,i=(null===(n=e.track.tag)||void 0===n?void 0:n.trackNr)||(0,I.Cb)(e.track.name);i>0&&t.push({name:"trackNr",score:i===this.mbTrack.position?1:0,weight:.2})}},{key:"scoreTitle",value:function(e,t){var n,i,r,a=(null===(n=e.track.tag)||void 0===n?void 0:n.title)||(0,I.f_)(e.track.name);if(a&&a.trim().length>0){var c,s=[oe(this.mbTrack.title||(null===(i=this.mbTrack.recording)||void 0===i?void 0:i.title)||"Unknown")],l=o((null===(r=this.mbTrack.recording)||void 0===r?void 0:r.aliases)||[]);try{for(l.s();!(c=l.n()).done;){var u=oe(c.value.name);s.push(u)}}catch(g){l.e(g)}finally{l.f()}var d=s.map(function(e){return{title:e,score:(0,I.C6)(a,e)}}).sort(function(e,t){return t.score-e.score});d.length>0&&t.push({name:"title",score:d[0].score,weight:1})}}}]),e}(),se=function(){function e(t,n,i){s(this,e),this.mbMedia=t,this.tracks=[],this.score=0,this.complete=!1,this.tracks=(t.tracks||[]).map(function(e,t){return new ce(e,n,i+t)})}return a(e,[{key:"updateScore",value:function(){this.score=0,this.complete=this.tracks.length>0;var e,t=o(this.tracks);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.currentMatch?this.score+=n.currentMatch.score:this.complete=!1}}catch(i){t.e(i)}finally{t.f()}this.tracks.length>0?this.score=this.score/this.tracks.length:this.complete=!1}}]),e}(),le=function(){function e(t){var n,i;s(this,e),this.mbRelease=t,this.media=[],this.score=0,this.loaded=!1,this.isLoading=!1,this.sortDate=0,this.totalTrack=0,this.sortDate=(n=t.date,i=(n||"").split("-"),new Date(i[0]?Number(i[0]):9999,i[1]?Number(i[1]):12,i[2]?Number(i[2]):31).valueOf()),this.totalTrack=this.mbRelease.media.reduce(function(e,t){return e+t.trackCount},0)}return a(e,[{key:"updateScore",value:function(){this.score=0,this.complete=this.media.length>0;var e,t=o(this.media);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.updateScore(),this.score=Math.max(n.score,this.score),n.complete||(this.complete=!1)}}catch(i){t.e(i)}finally{t.f()}}},{key:"setLookupRelease",value:function(e,t){this.mbRelease=e,this.totalTrack=this.mbRelease.media.reduce(function(e,t){return e+t.trackCount},0);var n=0;this.media=e.media.map(function(e){var i=new se(e,t,n);return n+=e.trackCount,i}),this.cleanDuplicateMatchings(),this.updateScore()}},{key:"cleanDuplicateMatchings",value:function(){var e,t={},n=o(this.media);try{for(n.s();!(e=n.n()).done;){var i,r=o(e.value.tracks);try{for(r.s();!(i=r.n()).done;){var a=i.value;a.currentMatch&&(t[a.currentMatch.match.track.id]=t[a.currentMatch.match.track.id]||[],t[a.currentMatch.match.track.id].push(a))}}catch(g){r.e(g)}finally{r.f()}}}catch(g){n.e(g)}finally{n.f()}for(var c=0,s=Object.keys(t);c<s.length;c++){var l=t[s[c]];if(l.length>1){(l=l.sort(function(e,t){var n,i;return((null===(n=t.currentMatch)||void 0===n?void 0:n.score)||0)-((null===(i=e.currentMatch)||void 0===i?void 0:i.score)||0)})).shift();var u,d=o(l);try{for(d.s();!(u=d.n()).done;){u.value.currentMatch=void 0}}catch(g){d.e(g)}finally{d.f()}}}}}]),e}(),ue=function(){function e(t){s(this,e),this.mbGroup=t,this.releases=[],this.score=0;var n,i=o(t.releases||[]);try{for(i.s();!(n=i.n()).done;){var r=n.value;this.releases.push(new le(r))}}catch(a){i.e(a)}finally{i.f()}this.releases=this.releases.sort(function(e,t){return e.sortDate-t.sortDate})}return a(e,[{key:"findRelease",value:function(e){return this.releases.find(function(t){return t.mbRelease.id===e})}},{key:"updateScore",value:function(){var e,t=o(this.releases);try{for(t.s();!(e=t.n()).done;){e.value.updateScore()}}catch(n){t.e(n)}finally{t.f()}this.score=this.currentRelease?this.currentRelease.score:0}},{key:"enough",value:function(e){return!(!this.currentRelease||this.currentRelease.totalTrack!==e||!this.currentRelease.complete)}}]),e}(),de=function(){function e(){s(this,e),this.groups=[]}return a(e,[{key:"enough",value:function(e){return!!this.groups.find(function(t){return t.enough(e)})}},{key:"addReleaseGroup",value:function(e){var t=new ue(e);return this.groups.push(t),t}},{key:"findReleaseGroup",value:function(e){return this.groups.find(function(t){return t.mbGroup.id===e})}},{key:"sort",value:function(){var e,t=o(this.groups);try{for(t.s();!(e=t.n()).done;){e.value.updateScore()}}catch(n){t.e(n)}finally{t.f()}this.groups=this.groups.sort(function(e,t){return t.score-e.score})}}]),e}(),ge=function(){function e(){s(this,e),this.frameValues={}}return a(e,[{key:"build",value:function(){return this.frameValues}},{key:"text",value:function(e,t){return t&&(this.frameValues[e]=[{id:e,value:{text:t}}]),this}},{key:"idText",value:function(e,t,n){if(n){var i={id:e,value:{id:t,text:n}},r=(this.frameValues[e]||[]).filter(function(e){return e.value.id!==t});this.frameValues[e]=r.concat([i])}return this}},{key:"nrAndTotal",value:function(e,t,n){if(t){var i=t.toString()+(n?"/".concat(n.toString()):"");this.frameValues[e]=[{id:e,value:{text:i}}]}return this}},{key:"keyTextList",value:function(e,t,n){if(n){var i=this.frameValues[e]||[],r=i.length>0?i[0]:{id:e,value:{list:[]}};r.value.list.push(t),r.value.list.push(n),this.frameValues[e]=[r]}return this}},{key:"bool",value:function(e,t){return void 0!==t&&(this.frameValues[e]=[{id:e,value:{bool:t}}]),this}},{key:"idLangText",value:function(e,t,n,i){if(t){var r=i||"",a=(this.frameValues[e]||[]).filter(function(e){return e.value.id!==r});this.frameValues[e]=a.concat([{id:e,value:{id:r,language:n||"",text:t}}])}return this}},{key:"addPicture",value:function(e,t,n,i,r){return this.frameValues[e]=(this.frameValues[e]||[]).concat([{id:e,value:{description:n||"",pictureType:t,bin:r,mimeType:i}}]),this}},{key:"addChapter",value:function(e,t,n,i,r,a,o){return this.frameValues[e]=(this.frameValues[e]||[]).concat([{id:e,value:{id:t,start:n,end:i,offset:r,offsetEnd:a},subframes:o}]),this}}]),e}(),he=function(){function e(){s(this,e),this.rawBuilder=new ge}return a(e,[{key:"buildFrames",value:function(){return this.rawBuilder.build()}},{key:"artist",value:function(e){return this.rawBuilder.text("TPE1",e),this}},{key:"artistSort",value:function(e){return this.rawBuilder.text("TSOP",e),this}},{key:"albumArtist",value:function(e){return this.rawBuilder.text("TPE2",e),this}},{key:"albumArtistSort",value:function(e){return this.rawBuilder.text("TSO2",e),this}},{key:"album",value:function(e){return this.rawBuilder.text("TALB",e),this}},{key:"albumSort",value:function(e){return this.rawBuilder.text("TSOA",e),this}},{key:"originalAlbum",value:function(e){return this.rawBuilder.text("TOAL",e),this}},{key:"originalArtist",value:function(e){return this.rawBuilder.text("TOPE",e),this}},{key:"originalDate",value:function(e){return this.rawBuilder.text("TDOR",e),this}},{key:"title",value:function(e){return this.rawBuilder.text("TIT2",e),this}},{key:"work",value:function(e){return this.rawBuilder.text("TIT1",e),this}},{key:"titleSort",value:function(e){return this.rawBuilder.text("TSOT",e),this}},{key:"genre",value:function(e){return this.rawBuilder.text("TCON",e),this}},{key:"bmp",value:function(e){return this.rawBuilder.text("TBPM",e?e.toString():void 0),this}},{key:"mood",value:function(e){return this.rawBuilder.text("TMOO",e),this}},{key:"media",value:function(e){return this.rawBuilder.text("TMED",e),this}},{key:"language",value:function(e){return this.rawBuilder.text("TLAN",e),this}},{key:"grouping",value:function(e){return this.rawBuilder.text("GRP1",e),this}},{key:"date",value:function(e){return this.rawBuilder.text("TDRC",e),this}},{key:"track",value:function(e,t){return this.rawBuilder.nrAndTotal("TRCK",e,t),this}},{key:"disc",value:function(e,t){return this.rawBuilder.nrAndTotal("TPOS",e,t),this}},{key:"year",value:function(e){return this.rawBuilder.text("TORY",e?e.toString():void 0),this}},{key:"artists",value:function(e){return this.rawBuilder.idText("TXXX","Artists",e),this}},{key:"isCompilation",value:function(e){return void 0!==e&&this.rawBuilder.bool("TCMP",1===e||"true"===e||!0===e),this}},{key:"originalYear",value:function(e){return this.rawBuilder.text("TYER",e),this}},{key:"composer",value:function(e){return this.rawBuilder.text("TCOM",e),this}},{key:"composerSort",value:function(e){return this.rawBuilder.text("TSOC",e),this}},{key:"remixer",value:function(e){return this.rawBuilder.text("TPE4",e),this}},{key:"label",value:function(e){return this.rawBuilder.text("TPUB",e),this}},{key:"subtitle",value:function(e){return this.rawBuilder.text("TIT3",e),this}},{key:"discSubtitle",value:function(e){return this.rawBuilder.text("TSST",e),this}},{key:"lyricist",value:function(e){return this.rawBuilder.text("TEXT",e),this}},{key:"lyrics",value:function(e,t,n){return this.rawBuilder.idLangText("USLT",e,t,n),this}},{key:"encoder",value:function(e){return this.rawBuilder.text("TENC",e),this}},{key:"encoderSettings",value:function(e){return this.rawBuilder.text("TSSE",e),this}},{key:"key",value:function(e){return this.rawBuilder.text("TKEY",e),this}},{key:"copyright",value:function(e){return this.rawBuilder.text("TCOP",e),this}},{key:"isrc",value:function(e){return this.rawBuilder.text("TSRC",e),this}},{key:"barcode",value:function(e){return this.rawBuilder.idText("TXXX","BARCODE",e),this}},{key:"asin",value:function(e){return this.rawBuilder.idText("TXXX","ASIN",e),this}},{key:"catalogNumber",value:function(e){return this.rawBuilder.idText("TXXX","CATALOGNUMBER",e),this}},{key:"script",value:function(e){return this.rawBuilder.idText("TXXX","SCRIPT",e),this}},{key:"license",value:function(e){return this.rawBuilder.idText("TXXX","LICENSE",e),this}},{key:"website",value:function(e){return this.rawBuilder.text("WOAR",e),this}},{key:"movement",value:function(e){return this.rawBuilder.text("MVNM",e),this}},{key:"movementNr",value:function(e,t){return this.rawBuilder.nrAndTotal("MVIN",e,t),this}},{key:"writer",value:function(e){return this.rawBuilder.idText("TXXX","Writer",e),this}},{key:"custom",value:function(e,t){return this.rawBuilder.idText("TXXX","VERSION",t),this}},{key:"musicianCredit",value:function(e,t){return this.rawBuilder.keyTextList("TMCL",e,t),this}},{key:"involved",value:function(e,t){return this.rawBuilder.keyTextList("TIPL",e,t),this}},{key:"discogsArtistID",value:function(e){return this.rawBuilder.idText("TXXX","Discogs Artist ID",e),this}},{key:"discogsAlbumArtistID",value:function(e){return this.rawBuilder.idText("TXXX","Discogs Album Artist ID",e),this}},{key:"discogsLabelID",value:function(e){return this.rawBuilder.idText("TXXX","Discogs Label ID",e),this}},{key:"discogsMasterReleaseID",value:function(e){return this.rawBuilder.idText("TXXX","Discogs Master Release ID",e),this}},{key:"discogsReleaseID",value:function(e){return this.rawBuilder.idText("TXXX","Discogs Release ID",e),this}},{key:"discogsVotes",value:function(e){return this.rawBuilder.idText("TXXX","Discogs Votes",e),this}},{key:"discogsRating",value:function(e){return this.rawBuilder.idText("TXXX","Discogs Rating",e),this}},{key:"mbAlbumStatus",value:function(e){return this.rawBuilder.idText("TXXX","MusicBrainz Album Status",e),this}},{key:"mbAlbumType",value:function(e){return this.rawBuilder.idText("TXXX","MusicBrainz Album Type",e),this}},{key:"mbAlbumReleaseCountry",value:function(e){return this.rawBuilder.idText("TXXX","MusicBrainz Album Release Country",e),this}},{key:"mbTrackID",value:function(e){return this.rawBuilder.idText("UFID","http://musicbrainz.org",e),this}},{key:"mbReleaseTrackID",value:function(e){return this.rawBuilder.idText("TXXX","MusicBrainz Release Track Id",e),this}},{key:"mbAlbumID",value:function(e){return this.rawBuilder.idText("TXXX","MusicBrainz Album Id",e),this}},{key:"mbOriginalAlbumID",value:function(e){return this.rawBuilder.idText("TXXX","MusicBrainz Original Album Id",e),this}},{key:"mbArtistID",value:function(e){return this.rawBuilder.idText("TXXX","MusicBrainz Artist Id",e),this}},{key:"mbOriginalArtistID",value:function(e){return this.rawBuilder.idText("TXXX","MusicBrainz Original Artist Id",e),this}},{key:"mbAlbumArtistID",value:function(e){return this.rawBuilder.idText("TXXX","MusicBrainz Album Artist Id",e),this}},{key:"mbReleaseGroupID",value:function(e){return this.rawBuilder.idText("TXXX","MusicBrainz Release Group Id",e),this}},{key:"mbWorkID",value:function(e){return this.rawBuilder.idText("TXXX","MusicBrainz Work Id",e),this}},{key:"mbTRMID",value:function(e){return this.rawBuilder.idText("TXXX","MusicBrainz TRM Id",e),this}},{key:"mbDiscID",value:function(e){return this.rawBuilder.idText("TXXX","MusicBrainz Disc Id",e),this}},{key:"acoustidID",value:function(e){return this.rawBuilder.idText("TXXX","Acoustid Id",e),this}},{key:"acoustidFingerprint",value:function(e){return this.rawBuilder.idText("TXXX","Acoustid Fingerprint",e),this}},{key:"musicIPPUID",value:function(e){return this.rawBuilder.idText("TXXX","MusicIP PUID",e),this}},{key:"comment",value:function(e,t){return this.rawBuilder.idText("COMM",e,t),this}},{key:"trackLength",value:function(e){return this.rawBuilder.text("TLEN",e?e.toString():void 0),this}},{key:"mbTrackDisambiguation",value:function(e){return this.rawBuilder.idText("TXXX","MusicBrainz Track Disambiguation",e),this}},{key:"addPicture",value:function(e,t,n,i){return this.rawBuilder.addPicture("APIC",e,t,n,i),this}},{key:"chapter",value:function(e,t,n,i,r,a){return this.rawBuilder.addChapter("CHAP",e,t,n,i,r,a),this}}]),e}();var fe=r(22689),pe=r(60918),me=r(62569);function ve(e,t){if(1&e&&F._UZ(0,"img",1),2&e){var n=F.oxw();F.Q6J("src",n.src,F.LSH)}}var Ce=function(){var e=function(){function e(){s(this,e)}return a(e,[{key:"ngOnChanges",value:function(e){this.src=void 0,this.image&&(this.src="data:".concat(this.image.mimeType||"image/jpeg",";base64,").concat(this.image.base64))}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=F.Xpm({type:e,selectors:[["app-image-base64"]],inputs:{image:"image"},features:[F.TTD],decls:1,vars:1,consts:[[3,"src",4,"ngIf"],[3,"src"]],template:function(e,t){1&e&&F.YNc(0,ve,1,1,"img",0),2&e&&F.Q6J("ngIf",t.src)},directives:[l.O5],styles:["[_nghost-%COMP%]{display:block}[_nghost-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:auto}"]}),e}();function Me(e,t){1&e&&F._UZ(0,"i",7)}function ke(e,t){if(1&e&&(F.ynx(0),F.TgZ(1,"div",14),F._UZ(2,"app-image-base64",15),F.qZA(),F.TgZ(3,"div",16),F.TgZ(4,"div",17),F.TgZ(5,"label"),F._UZ(6,"input",18),F._uU(7),F.qZA(),F.qZA(),F.qZA(),F.BQk()),2&e){var n=F.oxw().$implicit;F.xp6(2),F.Q6J("image",n.base64),F.xp6(4),F.Q6J("checked",n.checked),F.xp6(1),F.hij(" ",n.image.types,"")}}function Te(e,t){if(1&e&&(F.TgZ(0,"div",12),F.YNc(1,ke,8,3,"ng-container",13),F.qZA()),2&e){var n=t.$implicit;F.xp6(1),F.Q6J("ngIf",n.base64)}}function xe(e,t){if(1&e&&(F.TgZ(0,"div",8),F._UZ(1,"app-background-text-list",9),F.TgZ(2,"div",10),F.YNc(3,Te,2,1,"div",11),F.qZA(),F.qZA()),2&e){var n=F.oxw();F.xp6(1),F.Q6J("list",n.images),F.xp6(2),F.Q6J("ngForOf",n.images)}}var be=function(){var e=function(){function e(t,n,i){s(this,e),this.app=t,this.jam=n,this.notify=i,this.isImageSearchRunning=!1,this.showFrontImagesOnly=!0}return a(e,[{key:"ngOnChanges",value:function(e){var t=this;this.data?this.loadCoverartImages(this.data).catch(function(e){t.notify.error(e)}):(this.images=void 0,this.coverArtArchive=void 0)}},{key:"onToggleShowFrontImagesOnly",value:function(){var e=this;if(!this.showFrontImagesOnly&&this.coverArtArchive){var t,n=o(this.coverArtArchive);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.base64||i.requested||this.getBase64Image(i).catch(function(e){console.error(e)})}}catch(r){n.e(r)}finally{n.f()}}this.coverArtArchive&&(this.images=this.coverArtArchive.filter(function(t){return t.image.front||!e.showFrontImagesOnly}))}},{key:"getChecked",value:function(){return this.coverArtArchive?this.coverArtArchive.filter(function(e){return e.checked&&e.base64}):[]}},{key:"loadImages",value:function(e){return(0,C.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,i,r=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.images?(this.coverArtArchive=e.images.map(function(e){if(0===e.types.length&&e.types.push("Other"),e.image&&(e.image=e.image.replace("http:","https:")),e.thumbnails){var t=e.thumbnails;Object.keys(t).forEach(function(e){t[e]=t[e].replace("http:","https:")})}return{image:e,checked:!1}}),n=this.coverArtArchive.filter(function(e){return e.image.front||e.image.types.includes("Front")}).sort(function(e,t){return e.image.types.length-t.image.types.length}),this.images=this.showFrontImagesOnly?n:this.coverArtArchive,this.images.forEach(function(e){r.getBase64Image(e).catch(function(e){console.error(e)})}),(i=n.find(function(e){return 1===e.image.types.length}))||(i=n[0]),i&&(i.checked=!0)):(this.images=void 0,this.coverArtArchive=[]);case 1:case"end":return t.stop()}},t,this)}))}},{key:"loadCoverartImages",value:function(e){return(0,C.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.mbReleaseID){t.next=19;break}return this.isImageSearchRunning=!0,t.next=4,this.jam.metadata.coverartarchiveLookup({type:T.xB.release,mbID:e.mbReleaseID});case 4:return n=t.sent,t.next=7,this.loadImages(n.data);case 7:if(!this.coverArtArchive||0!==this.coverArtArchive.length||!e.mbReleaseGroupID){t.next=18;break}return this.images=void 0,this.coverArtArchive=void 0,t.next=12,this.jam.metadata.coverartarchiveLookup({type:T.xB.releaseGroup,mbID:e.mbReleaseGroupID});case 12:return n=t.sent,t.next=15,this.loadImages(n.data);case 15:this.isImageSearchRunning=!1,t.next=19;break;case 18:this.isImageSearchRunning=!1;case 19:case"end":return t.stop()}},t,this)}))}},{key:"getBase64Image",value:function(e){return(0,C.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.requested){t.next=2;break}return t.abrupt("return");case 2:return n=e.image.thumbnails[500]||e.image.thumbnails.small,e.requested=!0,t.prev=4,t.next=7,this.jam.metadata.coverartarchiveImageBinary({url:n});case 7:i=t.sent,t.next=13;break;case 10:t.prev=10,t.t0=t.catch(4),console.error(t.t0);case 13:e.requested=!1,i?e.base64={mimeType:i.contentType,base64:(0,fe.q)(i.buffer)}:this.notify.error({error:"Invalid result from https://coverartarchive.org"});case 14:case"end":return t.stop()}},t,this,[[4,10]])}))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(F.Y36(pe.zi),F.Y36(T.K4),F.Y36(pe.c))},e.\u0275cmp=F.Xpm({type:e,selectors:[["app-match-coverart"]],inputs:{data:"data"},features:[F.TTD],decls:9,vars:4,consts:[[1,"match-album-images"],[1,"front-only-choice"],["type","checkbox",3,"ngModel","checked","ngModelChange","change"],[1,"section"],["href","https://coverartarchive.org/","rel","noopener","target","_blank"],["class","icon-spin icon-spinner",4,"ngIf"],["class","match-images",4,"ngIf"],[1,"icon-spin","icon-spinner"],[1,"match-images"],["name","Images",3,"list"],[1,"media-cards"],["class","media-card no-hover",4,"ngFor","ngForOf"],[1,"media-card","no-hover"],[4,"ngIf"],[1,"image"],[3,"image"],[1,"footer"],[1,"footer-content"],["type","checkbox",3,"checked"]],template:function(e,t){1&e&&(F.TgZ(0,"div",0),F.TgZ(1,"label",1),F.TgZ(2,"input",2),F.NdJ("ngModelChange",function(e){return t.showFrontImagesOnly=e})("change",function(){return t.onToggleShowFrontImagesOnly()}),F.qZA(),F._uU(3," Front only "),F.qZA(),F.TgZ(4,"div",3),F.TgZ(5,"a",4),F._uU(6,"Coverart"),F.qZA(),F.qZA(),F.YNc(7,Me,1,0,"i",5),F.YNc(8,xe,4,2,"div",6),F.qZA()),2&e&&(F.xp6(2),F.Q6J("ngModel",t.showFrontImagesOnly)("checked",t.showFrontImagesOnly),F.xp6(5),F.Q6J("ngIf",t.isImageSearchRunning),F.xp6(1),F.Q6J("ngIf",t.images&&!t.isImageSearchRunning))},directives:[u.Wl,u.JJ,u.On,l.O5,me.$,l.sg,Ce],styles:["[_nghost-%COMP%]{padding-top:15px}[_nghost-%COMP%]   .section[_ngcontent-%COMP%]{color:var(--on-background-active);text-transform:uppercase;padding-bottom:10px;white-space:nowrap}[_nghost-%COMP%]   .section[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--on-background-active)}[_nghost-%COMP%]   .section[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:var(--on-background)}[_nghost-%COMP%]   .front-only-choice[_ngcontent-%COMP%]{float:right;font-size:.8em}[_nghost-%COMP%]   .match-images[_ngcontent-%COMP%]{min-height:200px;display:flex;flex-flow:row wrap}@media (max-width:768px){[_nghost-%COMP%]   .match-images[_ngcontent-%COMP%]{justify-content:space-around}}[_nghost-%COMP%]   .match-images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{max-width:200px;max-height:200px}"]}),e}(),Oe=r(91841);function ye(e,t){if(1&e&&(F.TgZ(0,"span",1),F.ALo(1,"number"),F.O4$(),F.TgZ(2,"svg",2),F._UZ(3,"rect",3),F.qZA(),F.qZA()),2&e){var n=F.oxw();F.MGl("title","Score: ",F.lcZ(1,3,n.score),""),F.xp6(3),F.uIk("y",12-10*n.score)("fill",n.color)}}var Pe=function(){var e=function(){function e(){s(this,e)}return a(e,[{key:"getMatchColor",value:function(e){return e>.7?"green":e>.3?"yellow":"red"}},{key:"ngOnChanges",value:function(e){this.color=void 0===this.score?void 0:this.getMatchColor(this.score)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=F.Xpm({type:e,selectors:[["app-score-box"]],inputs:{score:"score"},features:[F.TTD],decls:1,vars:1,consts:[[3,"title",4,"ngIf"],[3,"title"],["xmlns","http://www.w3.org/2000/svg","width","10","height","12"],["height","12","width","10"]],template:function(e,t){1&e&&F.YNc(0,ye,4,5,"span",0),2&e&&F.Q6J("ngIf",t.score)},directives:[l.O5],pipes:[l.JJ],styles:["[_nghost-%COMP%]{width:100%;height:100%}[_nghost-%COMP%]   svg[_ngcontent-%COMP%]{overflow:hidden;vertical-align:middle;background-color:var(--background-hover);border:1px solid var(--background-border)}"]}),e}(),_e=r(30689),we=r(8986),Ae=function(){var e=function(){function e(){s(this,e)}return a(e,[{key:"transform",value:function(e){return JSON.stringify(e,void 0," ")}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=F.Yjl({name:"json",type:e,pure:!0}),e}(),Re=["actionMenu"];function Ie(e,t){1&e&&(F.TgZ(0,"a",12),F._UZ(1,"i",13),F._uU(2," Show Tracks"),F.qZA())}function Se(e,t){1&e&&(F.TgZ(0,"a",12),F._UZ(1,"i",14),F._uU(2," Show Matchings"),F.qZA())}function Ze(e,t){if(1&e&&(F.TgZ(0,"div"),F.TgZ(1,"span",20),F._uU(2,"Moods:"),F.qZA(),F._uU(3,"\xa0"),F.TgZ(4,"span",22),F._uU(5),F.qZA(),F.qZA()),2&e){var n=F.oxw(2).$implicit;F.xp6(5),F.Oqu(n.abdata.moods)}}function De(e,t){1&e&&(F.TgZ(0,"div"),F.TgZ(1,"span",20),F._uU(2,"Lyrics:"),F.qZA(),F._uU(3,"\xa0"),F.TgZ(4,"span",22),F._uU(5,"yes"),F.qZA(),F.qZA())}function Be(e,t){if(1&e&&(F.TgZ(0,"div"),F.TgZ(1,"span",20),F._uU(2,"TrackNr:"),F.qZA(),F._uU(3,"\xa0"),F.TgZ(4,"span",21),F._uU(5),F.qZA(),F._uU(6,"\xa0 "),F.TgZ(7,"span",20),F._uU(8,"Title:"),F.qZA(),F._uU(9,"\xa0"),F.TgZ(10,"span",22),F._uU(11),F.qZA(),F._uU(12,"\xa0 "),F.TgZ(13,"span",20),F._uU(14,"Artist:"),F.qZA(),F._uU(15,"\xa0"),F.TgZ(16,"span",22),F._uU(17),F.ALo(18,"mbArtistCredits"),F.qZA(),F._uU(19,"\xa0 "),F.TgZ(20,"span",20),F._uU(21,"Album:"),F.qZA(),F._uU(22,"\xa0"),F.TgZ(23,"span",22),F._uU(24),F.qZA(),F._uU(25,"\xa0 "),F.YNc(26,Ze,6,1,"div",19),F.YNc(27,De,6,0,"div",19),F.qZA()),2&e){var n=F.oxw().$implicit;F.xp6(5),F.Oqu(n.mbTrack.position),F.xp6(6),F.Oqu(n.mbTrack.title||"?"),F.xp6(6),F.Oqu(F.lcZ(18,6,n.mbTrack.artistCredit)),F.xp6(7),F.Oqu((null==n.mbRelease?null:n.mbRelease.title)||"?"),F.xp6(2),F.Q6J("ngIf",n.abdata),F.xp6(1),F.Q6J("ngIf",n.lyrics)}}function Ne(e,t){if(1&e){var n=F.EpF();F.TgZ(0,"div",15),F.NdJ("dragstart",function(e){var t=F.CHM(n).$implicit;return F.oxw().drag(e,t)}),F.TgZ(1,"div",16),F._UZ(2,"span",17),F.qZA(),F.TgZ(3,"div",18),F._uU(4),F.YNc(5,Be,28,8,"div",19),F.qZA(),F.qZA()}if(2&e){var i=t.$implicit;F.xp6(4),F.hij(" ",i.track.name," "),F.xp6(1),F.Q6J("ngIf",i.mbTrack)}}function Fe(e,t){1&e&&F._UZ(0,"i",30)}function Ee(e,t){if(1&e){var n=F.EpF();F.TgZ(0,"label",35),F.TgZ(1,"input",33),F.NdJ("ngModelChange",function(e){return F.CHM(n).$implicit.checked=e}),F.qZA(),F._uU(2),F.qZA()}if(2&e){var i=t.$implicit;F.MGl("title","Usage Count: ",i.tag.count,""),F.xp6(1),F.Q6J("ngModel",i.checked),F.xp6(1),F.AsE(" ",i.tag.name," [",i.tag.count,"] ")}}function Je(e,t){if(1&e){var n=F.EpF();F.ynx(0),F.YNc(1,Ee,3,4,"label",31),F.TgZ(2,"label",32),F.TgZ(3,"input",33),F.NdJ("ngModelChange",function(e){return F.CHM(n),F.oxw(2).customGenre.checked=e}),F.qZA(),F.TgZ(4,"input",34),F.NdJ("ngModelChange",function(e){return F.CHM(n),F.oxw(2).customGenre.text=e}),F.qZA(),F.qZA(),F.BQk()}if(2&e){var i=F.oxw(2);F.xp6(1),F.Q6J("ngForOf",i.genres),F.xp6(2),F.Q6J("ngModel",i.customGenre.checked),F.xp6(1),F.Q6J("ngModel",i.customGenre.text)}}function Le(e,t){if(1&e){var n=F.EpF();F.TgZ(0,"div",23),F.TgZ(1,"div",24),F.TgZ(2,"div"),F.TgZ(3,"div",25),F._uU(4,"Genres"),F.qZA(),F.YNc(5,Fe,1,0,"i",26),F.YNc(6,Je,5,3,"ng-container",19),F.qZA(),F._UZ(7,"app-match-coverart",27),F.TgZ(8,"div",28),F.TgZ(9,"div",25),F._uU(10,"More"),F.qZA(),F.TgZ(11,"button",29),F.NdJ("click",function(){F.CHM(n);var e=F.oxw();return e.loadLyrics(e.current.group.currentRelease)}),F._uU(12,"Load Lyrics"),F.qZA(),F.TgZ(13,"button",29),F.NdJ("click",function(){F.CHM(n);var e=F.oxw();return e.loadMoods(e.current.group.currentRelease)}),F._uU(14,"Load AcousticBrainz Moods"),F.qZA(),F.qZA(),F.qZA(),F.qZA()}if(2&e){var i=F.oxw();F.xp6(5),F.Q6J("ngIf",i.isGenreSearchRunning),F.xp6(1),F.Q6J("ngIf",i.genres&&!i.isGenreSearchRunning),F.xp6(1),F.Q6J("data",i.coverArtSearch),F.xp6(4),F.ekj("disabled",!i.isRunning),F.xp6(2),F.ekj("disabled",!i.isRunning)}}function qe(e,t){if(1&e&&(F.TgZ(0,"span",22),F._uU(1),F.qZA()),2&e){var n=F.oxw(2).$implicit;F.xp6(1),F.Oqu(n.mbGroup.artistCredit[0].name)}}function Ue(e,t){if(1&e&&(F.ynx(0),F._uU(1),F.BQk()),2&e){var n=t.$implicit;F.xp6(1),F.hij("/",n,"")}}function Ge(e,t){if(1&e&&(F.ynx(0),F.YNc(1,Ue,2,1,"ng-container",48),F.BQk()),2&e){var n=F.oxw(2).$implicit;F.xp6(1),F.Q6J("ngForOf",n.mbGroup.secondaryTypes)}}function Xe(e,t){1&e&&F._UZ(0,"i",51)}function ze(e,t){1&e&&F._UZ(0,"i",52)}function He(e,t){if(1&e&&(F.ynx(0),F.TgZ(1,"span",22),F._uU(2),F.YNc(3,Xe,1,0,"i",49),F.YNc(4,ze,1,0,"i",50),F.qZA(),F.BQk()),2&e){var n=t.$implicit;F.xp6(2),F.hij("",n.tracks.length," "),F.xp6(1),F.Q6J("ngIf",n.complete),F.xp6(1),F.Q6J("ngIf",!n.complete)}}function Qe(e,t){if(1&e&&(F.ynx(0),F.TgZ(1,"span",20),F._uU(2,"Total Tracks:"),F.qZA(),F.TgZ(3,"span",22),F._uU(4),F.qZA(),F.BQk()),2&e){var n=F.oxw(2).$implicit;F.xp6(4),F.Oqu(n.currentRelease.totalTrack)}}function Ye(e,t){if(1&e&&(F.TgZ(0,"div",45),F.TgZ(1,"span",20),F._uU(2,"Score:"),F.qZA(),F.TgZ(3,"span",22),F._UZ(4,"app-score-box",46),F.qZA(),F.TgZ(5,"span",20),F._uU(6,"Artist: "),F.qZA(),F.YNc(7,qe,2,1,"span",47),F.TgZ(8,"span",20),F._uU(9,"Type: "),F.qZA(),F.TgZ(10,"span",22),F._uU(11),F.YNc(12,Ge,2,1,"ng-container",19),F.qZA(),F._UZ(13,"br"),F.TgZ(14,"span",20),F._uU(15,"Date:"),F.qZA(),F.TgZ(16,"span",22),F._uU(17),F.qZA(),F.TgZ(18,"span",20),F._uU(19,"Country:"),F.qZA(),F.TgZ(20,"span",22),F._uU(21),F.qZA(),F._UZ(22,"br"),F.TgZ(23,"span",20),F._uU(24,"Tracks:"),F.qZA(),F.YNc(25,He,5,3,"ng-container",48),F.YNc(26,Qe,5,1,"ng-container",19),F.qZA()),2&e){var n=F.oxw().$implicit;F.xp6(4),F.Q6J("score",n.currentRelease.score),F.xp6(3),F.Q6J("ngIf",n.mbGroup.artistCredit),F.xp6(4),F.hij("",n.mbGroup.primaryType," "),F.xp6(1),F.Q6J("ngIf",n.mbGroup.secondaryTypes),F.xp6(5),F.Oqu(n.currentRelease.mbRelease.date||"?"),F.xp6(4),F.Oqu(n.currentRelease.mbRelease.country||"?"),F.xp6(4),F.Q6J("ngForOf",n.currentRelease.media),F.xp6(1),F.Q6J("ngIf",n.currentRelease.media.length>1)}}function je(e,t){if(1&e){var n=F.EpF();F.TgZ(0,"button",29),F.NdJ("click",function(){F.CHM(n);var e=F.oxw().$implicit;return e.expanded=!e.expanded}),F._uU(1,"Tracks"),F.qZA()}}function Ve(e,t){if(1&e){var n=F.EpF();F.TgZ(0,"button",29),F.NdJ("click",function(){F.CHM(n);var e=F.oxw().$implicit;return e.selecting=!e.selecting}),F._uU(1,"Releases"),F.qZA()}}var We=function(e,t){return{"button-primary":e,"button-on-background":t}};function Ke(e,t){if(1&e){var n=F.EpF();F.TgZ(0,"button",53),F.NdJ("click",function(){F.CHM(n);var e=F.oxw().$implicit;return F.oxw(2).chooseRelease(e,e.currentRelease)}),F._uU(1,"Choose"),F.qZA()}if(2&e){var i=F.oxw().$implicit;F.Q6J("ngClass",F.WLB(1,We,i.currentRelease.complete,!i.currentRelease.complete))}}function $e(e,t){1&e&&(F.ynx(0),F._uU(1,"/"),F.BQk())}function et(e,t){if(1&e&&(F.ynx(0),F.YNc(1,$e,2,0,"ng-container",19),F._uU(2),F.BQk()),2&e){var n=t.$implicit,i=t.index;F.xp6(1),F.Q6J("ngIf",i>0),F.xp6(1),F.hij(" ",n.trackCount,"")}}function tt(e,t){if(1&e&&(F.ynx(0),F.YNc(1,et,3,2,"ng-container",48),F.BQk()),2&e){var n=F.oxw().$implicit;F.xp6(1),F.Q6J("ngForOf",n.mbRelease.media)}}function nt(e,t){1&e&&(F.ynx(0),F._uU(1,"?"),F.BQk())}function it(e,t){if(1&e){var n=F.EpF();F.TgZ(0,"label",55),F.NdJ("click",function(){var e=F.CHM(n).$implicit,t=F.oxw(2).$implicit;return F.oxw(2).setRelease(t,e)}),F._UZ(1,"input",56),F.TgZ(2,"span",20),F._uU(3,"Score:"),F.qZA(),F.TgZ(4,"span",22),F._UZ(5,"app-score-box",46),F.qZA(),F.TgZ(6,"span",20),F._uU(7,"Date:"),F.qZA(),F.TgZ(8,"span",22),F._uU(9),F.qZA(),F.TgZ(10,"span",20),F._uU(11,"Country:"),F.qZA(),F.TgZ(12,"span",22),F._uU(13),F.qZA(),F.TgZ(14,"span",20),F._uU(15,"Tracks:"),F.qZA(),F.TgZ(16,"span",22),F.YNc(17,tt,2,1,"ng-container",19),F.YNc(18,nt,2,0,"ng-container",19),F.qZA(),F.qZA()}if(2&e){var i=t.$implicit,r=F.oxw(2).$implicit;F.xp6(1),F.Q6J("checked",i===r.currentRelease),F.xp6(4),F.Q6J("score",i.score),F.xp6(4),F.Oqu(i.mbRelease.date||"?"),F.xp6(4),F.Oqu(i.mbRelease.country||"?"),F.xp6(4),F.Q6J("ngIf",i.mbRelease.media),F.xp6(1),F.Q6J("ngIf",!i.mbRelease.media)}}function rt(e,t){if(1&e&&(F.TgZ(0,"div"),F.TgZ(1,"form"),F.TgZ(2,"fieldset"),F.YNc(3,it,19,6,"label",54),F.qZA(),F.qZA(),F.qZA()),2&e){var n=F.oxw().$implicit;F.xp6(3),F.Q6J("ngForOf",n.releases)}}function at(e,t){1&e&&F._UZ(0,"i",51)}function ot(e,t){1&e&&F._UZ(0,"i",52)}function ct(e,t){if(1&e){var n=F.EpF();F.TgZ(0,"div",59),F.NdJ("click",function(){F.CHM(n);var e=F.oxw().$implicit;return e.expanded=!e.expanded}),F.TgZ(1,"i"),F.ALo(2,"stringToggle"),F.qZA(),F._uU(3),F.YNc(4,at,1,0,"i",49),F.YNc(5,ot,1,0,"i",50),F.qZA()}if(2&e){var i=F.oxw().$implicit;F.xp6(1),F.Tol(F.Dn7(2,5,i.expanded,"icon-minus","icon-plus")),F.xp6(2),F.hij(" Media ",i.mbMedia.position," "),F.xp6(1),F.Q6J("ngIf",i.complete),F.xp6(1),F.Q6J("ngIf",!i.complete)}}function st(e,t){if(1&e){var n=F.EpF();F.TgZ(0,"div",63),F.ALo(1,"number"),F.ALo(2,"json"),F._UZ(3,"app-score-box",46),F.TgZ(4,"a",64),F.NdJ("click",function(){F.CHM(n);var e=F.oxw().$implicit,t=F.oxw(4).$implicit;return F.oxw(2).removeMatching(t,t.currentRelease,e)}),F._UZ(5,"i",65),F.qZA(),F._uU(6),F.qZA()}if(2&e){var i=F.oxw().$implicit;F.hYB("title","Score: ",F.lcZ(1,4,i.currentMatch.score)," ",F.lcZ(2,6,i.currentMatch.scores),""),F.xp6(3),F.Q6J("score",i.currentMatch.score),F.xp6(3),F.hij(" ",i.currentMatch.match.track.name," ")}}var lt=function(e){return{missing:e}};function ut(e,t){if(1&e){var n=F.EpF();F.TgZ(0,"div",61),F.NdJ("drop",function(e){var t=F.CHM(n).$implicit,i=F.oxw(4).$implicit;return F.oxw(2).drop(e,i,i.currentRelease,t)})("dragover",function(e){return F.CHM(n),F.oxw(6).allowDrop(e)}),F._uU(1),F.ALo(2,"mbArtistCredits"),F.YNc(3,st,7,8,"div",62),F.qZA()}if(2&e){var i=t.$implicit;F.Q6J("ngClass",F.VKq(7,lt,!i.currentMatch)),F.xp6(1),F.lnq(" ",i.mbTrack.position," - ",i.mbTrack.title," - ",F.lcZ(2,5,i.mbTrack.artistCredit)," "),F.xp6(2),F.Q6J("ngIf",i.currentMatch)}}function dt(e,t){if(1&e&&(F.TgZ(0,"div"),F.YNc(1,ut,4,9,"div",60),F.qZA()),2&e){var n=F.oxw().$implicit;F.xp6(1),F.Q6J("ngForOf",n.tracks)}}function gt(e,t){if(1&e&&(F.TgZ(0,"div"),F.YNc(1,ct,6,9,"div",58),F.YNc(2,dt,2,1,"div",19),F.qZA()),2&e){var n=t.$implicit,i=F.oxw(2).$implicit;F.xp6(1),F.Q6J("ngIf",i.currentRelease.media.length>1),F.xp6(1),F.Q6J("ngIf",n.expanded||i.currentRelease.media.length<2)}}function ht(e,t){if(1&e&&(F.TgZ(0,"div",57),F.YNc(1,gt,3,2,"div",48),F.qZA()),2&e){var n=F.oxw().$implicit;F.xp6(1),F.Q6J("ngForOf",n.currentRelease.media)}}function ft(e,t){if(1&e&&(F.TgZ(0,"div",38),F.TgZ(1,"div",39),F.TgZ(2,"span",22),F._uU(3),F.qZA(),F.qZA(),F.YNc(4,Ye,27,8,"div",40),F.TgZ(5,"div",41),F.YNc(6,je,2,0,"button",42),F.YNc(7,Ve,2,0,"button",42),F.YNc(8,Ke,2,4,"button",43),F.YNc(9,rt,4,1,"div",19),F.qZA(),F.YNc(10,ht,2,1,"div",44),F.qZA()),2&e){var n=t.$implicit,i=F.oxw(2);F.xp6(3),F.Oqu(n.mbGroup.title),F.xp6(1),F.Q6J("ngIf",n.currentRelease),F.xp6(2),F.Q6J("ngIf",!i.isRunning),F.xp6(1),F.Q6J("ngIf",!i.isRunning&&n.releases.length>1),F.xp6(1),F.Q6J("ngIf",!i.isRunning&&n.currentRelease),F.xp6(1),F.Q6J("ngIf",n.selecting),F.xp6(1),F.Q6J("ngIf",n.expanded&&n.currentRelease)}}function pt(e,t){if(1&e&&(F.TgZ(0,"div",23),F.TgZ(1,"div",36),F.YNc(2,ft,11,7,"div",37),F.qZA(),F.qZA()),2&e){var n=F.oxw();F.xp6(2),F.Q6J("ngForOf",n.matchTree.groups)}}function mt(e,t){if(1&e&&(F.TgZ(0,"div",66),F._UZ(1,"i",30),F._uU(2),F.qZA()),2&e){var n=F.oxw();F.xp6(2),F.hij(" ",n.currentAction,"")}}function vt(e,t){1&e&&(F.TgZ(0,"button",72),F._UZ(1,"i",30),F.qZA())}function Ct(e,t){if(1&e){var n=F.EpF();F.TgZ(0,"button",73),F.NdJ("click",function(){return F.CHM(n),F.oxw(2).apply()}),F._uU(1,"Apply"),F.qZA()}}function Mt(e,t){if(1&e){var n=F.EpF();F.TgZ(0,"div",67),F.TgZ(1,"div",68),F.YNc(2,vt,2,0,"button",69),F.YNc(3,Ct,2,0,"button",70),F.TgZ(4,"button",71),F.NdJ("click",function(){return F.CHM(n),F.oxw().stopApply()}),F._uU(5,"Cancel"),F.qZA(),F.qZA(),F.qZA()}if(2&e){var i=F.oxw();F.xp6(2),F.Q6J("ngIf",i.isRunning),F.xp6(1),F.Q6J("ngIf",!i.isRunning)}}function kt(e,t){1&e&&F._uU(0,"Manual Search with MusicBrainz")}function Tt(e,t){1&e&&F._uU(0,"Match with AcoustID")}function xt(e,t){1&e&&F._uU(0,"Match with MusicBrainz (Text)")}function bt(e,t){1&e&&F._uU(0,"Match with MusicBrainz (Musicbrainz IDs)")}function Ot(e,t){if(1&e){var n=F.EpF();F.TgZ(0,"div"),F.TgZ(1,"button",75),F.NdJ("click",function(){F.CHM(n);var e=F.oxw(3);return e.start(e.RunType.auto)}),F._uU(2,"Auto Match"),F.qZA(),F.TgZ(3,"button",76),F.NdJ("click",function(e){return F.CHM(n),F.oxw(3).onContextMenu(e)}),F._uU(4,"\xa0\u2026\xa0"),F.qZA(),F.qZA()}}function yt(e,t){if(1&e){var n=F.EpF();F.TgZ(0,"div"),F.TgZ(1,"button",71),F.NdJ("click",function(){return F.CHM(n),F.oxw(3).stop()}),F._uU(2,"Stop"),F.qZA(),F.qZA()}}function Pt(e,t){if(1&e&&(F.TgZ(0,"div",68),F.YNc(1,Ot,5,0,"div",19),F.YNc(2,yt,3,0,"div",19),F.qZA()),2&e){var n=F.oxw(2);F.xp6(1),F.Q6J("ngIf",!n.isRunning),F.xp6(1),F.Q6J("ngIf",n.isRunning)}}function _t(e,t){if(1&e){var n=F.EpF();F.TgZ(0,"div"),F.TgZ(1,"button",73),F.NdJ("click",function(){return F.CHM(n),F.oxw(3).manualSearch()}),F._uU(2,"Search"),F.qZA(),F.TgZ(3,"button",71),F.NdJ("click",function(){return F.CHM(n),F.oxw(3).clear()}),F._uU(4,"Clear"),F.qZA(),F.TgZ(5,"button",71),F.NdJ("click",function(){return F.CHM(n),F.oxw(3).manual=!1}),F._uU(6,"Close"),F.qZA(),F.qZA()}}function wt(e,t){if(1&e){var n=F.EpF();F.TgZ(0,"div"),F.TgZ(1,"button",71),F.NdJ("click",function(){return F.CHM(n),F.oxw(3).stop()}),F._uU(2,"Stop"),F.qZA(),F.qZA()}}function At(e,t){if(1&e){var n=F.EpF();F.TgZ(0,"div",68),F.TgZ(1,"div",77),F.TgZ(2,"div"),F.TgZ(3,"div"),F._uU(4,"Album Name"),F.qZA(),F.TgZ(5,"app-tag-editor-autocomplete",78),F.NdJ("valueChange",function(e){return F.CHM(n),F.oxw(2).manualSearchData.releaseGroup=e}),F.qZA(),F.qZA(),F.TgZ(6,"div"),F.TgZ(7,"div"),F._uU(8,"Artist"),F.qZA(),F.TgZ(9,"app-tag-editor-autocomplete",78),F.NdJ("valueChange",function(e){return F.CHM(n),F.oxw(2).manualSearchData.artist=e}),F.qZA(),F.qZA(),F.qZA(),F.YNc(10,_t,7,0,"div",19),F.YNc(11,wt,3,0,"div",19),F.qZA()}if(2&e){var i=F.oxw(2);F.xp6(5),F.Q6J("value",i.manualSearchData.releaseGroup)("getList",i.manualSearchData.getAutoCompleteAlbumList)("standalone",!0),F.xp6(4),F.Q6J("value",i.manualSearchData.artist)("getList",i.manualSearchData.getAutoCompleteArtistList)("standalone",!0),F.xp6(1),F.Q6J("ngIf",!i.isRunning),F.xp6(1),F.Q6J("ngIf",i.isRunning)}}function Rt(e,t){if(1&e&&(F.TgZ(0,"div",67),F.YNc(1,Pt,3,2,"div",74),F.YNc(2,At,12,8,"div",74),F.qZA()),2&e){var n=F.oxw();F.xp6(1),F.Q6J("ngIf",!n.manual),F.xp6(1),F.Q6J("ngIf",n.manual)}}function It(e){var t=e.indexOf("("),n=e;return t>1&&(n=n.slice(0,t)),(t=n.indexOf("["))>1&&(n=n.slice(0,t)),0===(n=n.trim()).length?e:n}var St=function e(t){s(this,e),this.q=t,this.matchings=[],this.id="musicbrainz-".concat(JSON.stringify(t)),this.name="MusicBrainz Search for ".concat(Object.keys(t).filter(function(e){return"type"!==e}).map(function(e){return"".concat(e,': "').concat(t[e],'"')}).join(", "))},Zt=(function(e){e[e.acoustID=0]="acoustID",e[e.musicbrainzRefresh=1]="musicbrainzRefresh",e[e.musicbrainzByTags=2]="musicbrainzByTags",e[e.auto=3]="auto"}(Zt||(Zt={})),Zt),Dt=function(){var e=function(){function e(t,n,i,r,a,c){var l=this;s(this,e),this.app=t,this.jam=n,this.notify=i,this.contextMenuService=r,this.client=a,this.cd=c,this.isRunning=!1,this.isGenreSearchRunning=!1,this.isAborted=!1,this.customGenre={text:"",checked:!0},this.rightActive=!0,this.matchings=[],this.matchTree=new de,this.manual=!1,this.manualSearchData={artists:[],albums:[],artist:"",releaseGroup:"",getAutoCompleteAlbumList:function(){var e,t;if(0===l.manualSearchData.albums.length){var n,i=o(l.matchings);try{for(i.s();!(n=i.n()).done;){var r=((null===(t=null===(e=n.value.track)||void 0===e?void 0:e.tag)||void 0===t?void 0:t.album)||"").trim();r.length>0&&!l.manualSearchData.albums.includes(r)&&l.manualSearchData.albums.push(r)}}catch(a){i.e(a)}finally{i.f()}}return l.manualSearchData.albums},getAutoCompleteArtistList:function(){var e,t;if(0===l.manualSearchData.artists.length){var n,i=o(l.matchings);try{for(i.s();!(n=i.n()).done;){var r=((null===(t=null===(e=n.value.track)||void 0===e?void 0:e.tag)||void 0===t?void 0:t.artist)||"").trim();r.length>0&&!l.manualSearchData.artists.includes(r)&&l.manualSearchData.artists.push(r)}}catch(a){i.e(a)}finally{i.f()}}return l.manualSearchData.artists}},this.RunType=Zt}return a(e,[{key:"ngOnChanges",value:function(e){this.data?(this.matchings=this.data.matchings.map(function(e){return{track:e.track}}),this.isRunning||(this.isAborted=!1)):(this.matchings=[],this.isAborted=!0)}},{key:"ngOnDestroy",value:function(){this.isAborted=!0}},{key:"allowDrop",value:function(e){e.preventDefault()}},{key:"drag",value:function(e,t){this.cd.markForCheck(),e.dataTransfer&&e.dataTransfer.setData("text",t.track.id)}},{key:"drop",value:function(e,t,n,i){if(e.preventDefault(),e.dataTransfer){var r=e.dataTransfer.getData("text"),a=this.matchings.find(function(e){return e.track.id===r});if(a){var c=i.matchings.find(function(e){return e.match.track.id===r});c||(c={match:a,score:1,scores:[]},i.matchings.push(c)),c.score=1,c.scores.find(function(e){return"Manual Match"===e.name})||c.scores.push({name:"Manual Match",score:1,weight:1});var s,l=o(n.media);try{for(l.s();!(s=l.n()).done;){var u,d=o(s.value.tracks);try{for(d.s();!(u=d.n()).done;){var g=u.value;g.currentMatch&&g.currentMatch.match.track.id===a.track.id&&(g.currentMatch=void 0)}}catch(h){d.e(h)}finally{d.f()}}}catch(h){l.e(h)}finally{l.f()}i.currentMatch=c,t.updateScore()}}}},{key:"start",value:function(e){var t=this;this.isRunning||(this.isAborted=!1,this.isRunning=!0,this.run(e).then(function(){t.matchTree.sort(),t.isRunning=!1,t.isAborted=!1,t.currentAction=""}).catch(function(e){t.notify.error(e),t.isRunning=!1,t.isAborted=!1,t.currentAction=""}))}},{key:"setManualSearch",value:function(){var e;if(this.manual=!0,0===this.manualSearchData.artist.length){var t=this.manualSearchData.getAutoCompleteArtistList();t.length>0&&(this.manualSearchData.artist=t[0])}if(0===this.manualSearchData.releaseGroup.length){var n=this.manualSearchData.getAutoCompleteAlbumList();n.length>0?this.manualSearchData.releaseGroup=n[0]:(null===(e=this.data)||void 0===e?void 0:e.folder)&&(this.manualSearchData.releaseGroup=this.data.folder.name)}}},{key:"clear",value:function(){this.isRunning||(this.matchTree=new de)}},{key:"manualSearch",value:function(){var e=this;this.isRunning||(this.isAborted=!1,this.isRunning=!0,this.searchManual().then(function(){e.isRunning=!1,e.isAborted=!1,e.currentAction=""}).catch(function(t){e.notify.error(t),e.isRunning=!1,e.isAborted=!1,e.currentAction=""}))}},{key:"stop",value:function(){this.isRunning&&(this.isAborted=!0)}},{key:"apply",value:function(){var e=this,t=(this.genres||[]).filter(function(e){return e.checked}).map(function(e){return e.tag.name});this.customGenre.checked&&this.customGenre.text.trim().length>0&&t.push(this.customGenre.text.trim());var n,i=o(this.matchings);try{for(i.s();!(n=i.n()).done;){n.value.genres=t}}catch(l){i.e(l)}finally{i.f()}if(this.data){var r,a=this.coverArt?this.coverArt.getChecked():[],c=o(this.data.matchings);try{var s=function(){var n=r.value,i=e.matchings.find(function(e){return e.track.id===n.track.id});n.rawTag=i?function(e,t,n){if(e.mbTrack){var i=e.mbTrack,r=e.mbRelease,a=e.mbGroup,c=e.mbMedia,s=new he;return function(e,t,n,i,r,a){var o,c,s,l;e.mbTrackID(null===(o=n.recording)||void 0===o?void 0:o.id).date(null==i?void 0:i.date).originalDate(null==r?void 0:r.firstReleaseDate).album(null==i?void 0:i.title).albumSort(null==i?void 0:i.sortName).title(n.title).media(null==a?void 0:a.format).track(n.position,null==a?void 0:a.trackCount).disc(null==a?void 0:a.position,null==i?void 0:i.media.length).trackLength(n.length).language(null==i?void 0:i.textRepresentation.language).script(null==i?void 0:i.textRepresentation.script).barcode(null==i?void 0:i.barcode).isrc((null===(c=n.recording)||void 0===c?void 0:c.isrcs)&&n.recording.isrcs.length>0?n.recording.isrcs[0]:void 0).mbAlbumStatus((null==i?void 0:i.status)?i.status.toLowerCase():void 0).mbAlbumReleaseCountry(null==i?void 0:i.country).mbAlbumID(null==i?void 0:i.id).mbReleaseTrackID(n.id).mbReleaseGroupID(null==i?void 0:i.releaseGroup.id).mbTrackDisambiguation(null===(s=n.recording)||void 0===s?void 0:s.disambiguation).asin(null==i?void 0:i.asin).discSubtitle(null==a?void 0:a.title),(null===(l=n.recording)||void 0===l?void 0:l.aliases)&&n.recording.aliases.length>0&&n.recording.aliases[0].sortName&&n.recording.aliases[0].sortName!==n.title&&e.titleSort(n.recording.aliases[0].sortName);var u=null==i?void 0:i.artistCredit[0];if(u&&e.albumArtist(u.name).albumArtistSort(u.artist.sortName).mbAlbumArtistID(u.artist.id),n.artistCredit&&n.artistCredit.length>0){var d=n.artistCredit.map(function(e){return"".concat(e.artist.name," ").concat(e.joinphrase)}).join(" ").replace(/ {2}/g," ").trim(),g=n.artistCredit.map(function(e){return(e.artist.sortName?e.artist.sortName:"").trim()}).filter(function(e){return e.length>0}).join(" & ").replace(/ {2}/g," ").trim();e.artist(d).artistSort(g).mbArtistID(n.artistCredit[0].artist.id)}else u&&e.artist(u.name).artistSort(u.artist.sortName).mbArtistID(u.artist.id);var h=null==i?void 0:i.labelInfo[0];h&&(h.label&&e.label(h.label.name),e.catalogNumber(h.catalogNumber))}(s,0,i,r,a,c),function(e,t,n,i){var r=[];(null==i?void 0:i.releaseGroup.primaryType)&&r.push(i.releaseGroup.primaryType),(null==i?void 0:i.releaseGroup.secondaryTypes)&&(r=r.concat(i.releaseGroup.secondaryTypes)),r.length>0&&e.mbAlbumType(r.map(function(e){return e.toLowerCase()}).join("/")),r.includes("compilation")&&e.isCompilation(!0)}(s,0,0,r),function(e,t,n){if(n&&n.length>0)e.genre(n.slice(0,2).join("/"));else if(t.track.tagRaw){var i=t.track.tagRaw.frames.TCON;if(i){var r=i.map(function(e){return e.value.text});e.genre(r.slice(0,2).join("/"))}}}(s,e,t),function(e,t,n){if(n&&n.length>0){var i,r=o(n);try{for(r.s();!(i=r.n()).done;){var a=i.value,c=0;a.image.types.includes("Medium")?c=6:a.image.types.includes("Booklet")?c=5:a.image.types.includes("Front")?c=3:a.image.types.includes("Back")&&(c=4),a.base64&&e.addPicture(c,"",a.base64.mimeType,a.base64.base64)}}catch(l){r.e(l)}finally{r.f()}}else if(t.track.tagRaw){var s=t.track.tagRaw.frames.APIC;if(s){var u,d=o(s);try{for(d.s();!(u=d.n()).done;){var g=u.value;e.addPicture(g.value.pictureType,g.value.description,g.value.mimeType,g.value.bin)}}catch(l){d.e(l)}finally{d.f()}}}}(s,e,n),function(e,t){var n;(null===(n=t.abdata)||void 0===n?void 0:n.moods)&&t.abdata.moods.length>0&&e.mood(t.abdata.moods.join("/"))}(s,e),function(e,t,n){var i;if(t.acoustidEntries&&(null===(i=n.recording)||void 0===i?void 0:i.id)){var r=t.acoustidEntries.find(function(e){var t;return e.recordingID===(null===(t=n.recording)||void 0===t?void 0:t.id)});r&&e.acoustidID(r.acoustID)}}(s,e,i),e.lyrics&&s.lyrics(e.lyrics.lyrics),{version:4,frames:s.buildFrames()}}}(i,t,a):void 0};for(c.s();!(r=c.n()).done;)s()}catch(l){c.e(l)}finally{c.f()}this.data.apply&&this.data.apply(),this.data.close&&this.data.close()}}},{key:"setRelease",value:function(e,t){var n=this;e.currentRelease=t,t.loaded||this.loadRelease(t).catch(function(e){n.notify.error(e)})}},{key:"chooseRelease",value:function(e,t){var n=this;this.stopApply(),this.current={group:e,release:t},this.coverArtSearch={mbReleaseID:t.mbRelease.id,mbReleaseGroupID:e.mbGroup.id};var i,r=o(t.media);try{for(r.s();!(i=r.n()).done;){var a,c=i.value,s=o(c.tracks);try{for(s.s();!(a=s.n()).done;){var l=a.value;l.currentMatch&&(l.currentMatch.match.mbTrack=l.mbTrack,l.currentMatch.match.mbMedia=c.mbMedia,l.currentMatch.match.mbRelease=t.mbRelease,l.currentMatch.match.mbGroup=e.mbGroup)}}catch(u){s.e(u)}finally{s.f()}}}catch(u){r.e(u)}finally{r.f()}this.loadGenres(e,t).catch(function(e){n.notify.error(e)})}},{key:"stopApply",value:function(){this.current=void 0,this.genres=void 0;var e,t=o(this.matchings);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.mbTrack=void 0,n.mbMedia=void 0,n.mbRelease=void 0,n.mbGroup=void 0,n.genres=void 0}}catch(i){t.e(i)}finally{t.f()}}},{key:"setRunning",value:function(e){this.currentAction=e,this.isRunning=!0}},{key:"stopRunning",value:function(){this.isRunning=!1,this.currentAction=""}},{key:"loadMoods",value:function(e){var t=this;!this.isRunning&&e&&(this.setRunning("Searching Moods"),this.loadAcousticBrainz(e).then(function(){t.stopRunning()}).catch(function(e){t.stopRunning(),t.notify.error(e)}))}},{key:"loadLyrics",value:function(e){var t=this;!this.isRunning&&e&&(this.setRunning("Searching Lyrics"),this.loadLyricsOVH(e).then(function(){t.stopRunning()}).catch(function(e){t.stopRunning(),t.notify.error(e)}))}},{key:"removeMatching",value:function(e,t,n){n.currentMatch=void 0,e.updateScore()}},{key:"onContextMenu",value:function(e){this.contextMenuService.show.next({contextMenu:this.actionMenu,event:e,item:void 0}),e.preventDefault(),e.stopPropagation()}},{key:"shouldStop",value:function(){return this.matchTree.enough(this.matchings.length)||this.isAborted}},{key:"searchManual",value:function(){return(0,C.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t={type:T.xI.releaseGroup},this.manualSearchData.artist&&this.manualSearchData.artist.trim().length>0&&(t.artist=this.manualSearchData.artist),this.manualSearchData.releaseGroup&&this.manualSearchData.releaseGroup.trim().length>0&&(t.releasegroup=this.manualSearchData.releaseGroup),!(Object.keys(t).length>1)){e.next=5;break}return n=new St(t),e.next=5,this.runQuery(n,[]);case 5:case"end":return e.stop()}},e,this)}))}},{key:"run",value:function(e){return(0,C.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=e,t.next=t.t0===Zt.acoustID?3:t.t0===Zt.musicbrainzByTags?6:t.t0===Zt.musicbrainzRefresh?13:t.t0===Zt.auto?16:30;break;case 3:return t.next=5,this.acoustId();case 5:return t.abrupt("break",30);case 6:return t.next=8,this.musicBrainzByQuickTags();case 8:if(!this.shouldStop()){t.next=10;break}return t.abrupt("return");case 10:return t.next=12,this.musicBrainzByTags();case 12:return t.abrupt("break",30);case 13:return t.next=15,this.musicBrainzRefresh();case 15:return t.abrupt("break",30);case 16:return t.next=18,this.musicBrainzRefresh();case 18:if(!this.shouldStop()){t.next=20;break}return t.abrupt("return");case 20:return t.next=22,this.musicBrainzByQuickTags();case 22:if(!this.shouldStop()){t.next=24;break}return t.abrupt("return");case 24:return t.next=26,this.acoustId();case 26:if(!this.shouldStop()){t.next=28;break}return t.abrupt("return");case 28:return t.next=30,this.musicBrainzByTags();case 30:case"end":return t.stop()}},t,this)}))}},{key:"loadGenres",value:function(e,t){var n;return(0,C.mG)(this,void 0,void 0,regeneratorRuntime.mark(function i(){var r,a,c,s,l,u,d,g,h,f;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(this.data){i.next=2;break}return i.abrupt("return");case 2:this.isGenreSearchRunning=!0,r=[],e.mbGroup.secondaryTypes&&e.mbGroup.secondaryTypes.find(function(e){return["audiobook","audio drama","spokenword"].includes(e)})&&r.push({count:1,name:"Audiobook"}),a=o(this.data.matchings);try{for(a.s();!(c=a.n()).done;)s=c.value,(null===(n=s.track.tag)||void 0===n?void 0:n.genres)&&s.track.tag.genres.length>0&&function(){var e=s.track.tag.genres[0],t=r.find(function(t){return t.name===e});t?t.count++:r.push({count:1,name:e})}()}catch(p){a.e(p)}finally{a.f()}return l=function(e){if(!e||!e.length)return[];var t,n=[],i=o(e);try{for(i.s();!(t=i.n()).done;){var r,a=t.value,c=o(a.name.split("/").map(function(e){return e.trim()}).filter(function(e){return e.length>0}));try{var s=function(){var e=ie(r.value);if(e){var t=n.find(function(t){return t.name===e});t?t.count+=a.count:n.push({name:e,count:a.count})}};for(c.s();!(r=c.n()).done;)s()}catch(p){c.e(p)}finally{c.f()}}}catch(p){i.e(p)}finally{i.f()}return n.sort(function(e,t){return t.count-e.count})}(r),u=[],t.mbRelease.tags&&(u=u.concat(t.mbRelease.tags)),e.mbGroup.tags&&(u=u.concat(e.mbGroup.tags)),l=re(l,function(e){if(!e||!e.length)return[];var t,n=[],i=o(e);try{for(i.s();!(t=i.n()).done;){var r,a=t.value,c=o(a.name.split(";").map(function(e){return e.trim()}).filter(function(e){return e.length>0}));try{var s=function(){var e=ie(r.value);if(e){var t=n.find(function(t){return t.name===e});t?t.count+=a.count:n.push({name:e,count:a.count})}};for(c.s();!(r=c.n()).done;)s()}catch(p){c.e(p)}finally{c.f()}}}catch(p){i.e(p)}finally{i.f()}return n.sort(function(e,t){return t.count-e.count})}(u)),i.next=11,this.jam.metadata.lastfmLookup({type:T.WQ.album,mbID:t.mbRelease.id});case 11:if((d=i.sent.data).album&&(l=re(l,(g=d.album).tags?ae(g.tags):[])),!(0===l.length&&t.mbRelease.artistCredit.length>0)){i.next=17;break}return i.next=15,this.jam.metadata.lastfmLookup({type:T.WQ.artist,mbID:t.mbRelease.artistCredit[0].artist.id});case 15:(f=i.sent.data)&&f.artist&&(l=re(l,(h=f.artist)?ae(h.tags):[]));case 17:this.genres=l.sort(function(e,t){return t.count-e.count}).map(function(e,t){return{tag:e,checked:0===t}}),this.isGenreSearchRunning=!1;case 18:case"end":return i.stop()}},i,this)}))}},{key:"loadAcousticBrainz",value:function(e){var t,n,i,r;return(0,C.mG)(this,void 0,void 0,regeneratorRuntime.mark(function a(){var c,s,l,u,d,g,h,f,p,m,v,C,M,k,T,x,b;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:c=o(e.media),a.prev=1,c.s();case 3:if((s=c.n()).done){a.next=27;break}l=s.value,u=o(l.tracks),a.prev=6,u.s();case 8:if((d=u.n()).done){a.next=17;break}if((g=d.value).abData||!(null===(r=null===(i=null===(n=null===(t=g.currentMatch)||void 0===t?void 0:t.match)||void 0===n?void 0:n.mbTrack)||void 0===i?void 0:i.recording)||void 0===r?void 0:r.id)){a.next=15;break}return a.next=13,this.jam.metadata.acousticbrainzLookup({mbID:g.currentMatch.match.mbTrack.recording.id});case 13:if((h=a.sent.data).highlevel){for(f=[],p=[],m=[],v=[],C=Object.keys(h.highlevel),M=0,k=C;M<k.length;M++)T=k[M],x=h.highlevel[T].value,h.highlevel[T].probability>.8&&!x.includes("not_")&&(T.startsWith("mood_")||"timbre"===T||"danceability"===T?p.includes(x)||p.push(x):T.startsWith("genre_")?f.includes(x)||f.push(x):T.startsWith("tonal_")||"voice_instrumental"===T?m.includes(x)||m.push(x):v.includes(x)||v.push(x));b={genres:f,moods:p,tonal:m,other:v},g.abData=b,g.currentMatch.match.abdata=b}case 15:a.next=8;break;case 17:a.next=22;break;case 19:a.prev=19,a.t0=a.catch(6),u.e(a.t0);case 22:return a.prev=22,u.f(),a.finish(22);case 25:a.next=3;break;case 27:a.next=32;break;case 29:a.prev=29,a.t1=a.catch(1),c.e(a.t1);case 32:return a.prev=32,c.f(),a.finish(32);case 35:case"end":return a.stop()}},a,this,[[1,29,32,35],[6,19,22,25]])}))}},{key:"loadLyricsOVH",value:function(e){return(0,C.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,i,r,a,c,s,l,u;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=o(e.media),t.prev=1,n.s();case 3:if((i=n.n()).done){t.next=27;break}r=i.value,a=o(r.tracks),t.prev=6,a.s();case 8:if((c=a.n()).done){t.next=17;break}if(!((s=c.value).currentMatch&&!s.currentMatch.match.lyrics&&s.mbTrack.artistCredit&&s.mbTrack.artistCredit.length>0)){t.next=15;break}return l=s.mbTrack.artistCredit[0].name,u=s.mbTrack.title,t.next=14,this.jam.metadata.lyricsovhSearch({title:u,artist:l});case 14:s.currentMatch.match.lyrics=t.sent.data;case 15:t.next=8;break;case 17:t.next=22;break;case 19:t.prev=19,t.t0=t.catch(6),a.e(t.t0);case 22:return t.prev=22,a.f(),t.finish(22);case 25:t.next=3;break;case 27:t.next=32;break;case 29:t.prev=29,t.t1=t.catch(1),n.e(t.t1);case 32:return t.prev=32,n.f(),t.finish(32);case 35:case"end":return t.stop()}},t,this,[[1,29,32,35],[6,19,22,25]])}))}},{key:"loadRelease",value:function(e){var t;return(0,C.mG)(this,void 0,void 0,regeneratorRuntime.mark(function n(){var i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!e||e.loaded||e.isLoading){n.next=15;break}return e.isLoading=!0,n.prev=2,this.currentAction="Loading MusicBrainz Release: ".concat(e.mbRelease.id),n.next=6,this.jam.metadata.musicbrainzLookup({type:T.ej.release,mbID:e.mbRelease.id});case 6:if(i=n.sent,null===(t=i.data)||void 0===t?void 0:t.release){n.next=9;break}return n.abrupt("return",Promise.reject(Error("Got empty data")));case 9:e.setLookupRelease(i.data.release,this.matchings),e.loaded=!0,e.isLoading=!1,n.next=15;break;case 12:return n.prev=12,n.t0=n.catch(2),n.abrupt("return",(e.isLoading=!1,Promise.reject(n.t0)));case 15:case"end":return n.stop()}},n,this,[[2,12]])}))}},{key:"addReleaseGroupByReleaseID",value:function(e){return(0,C.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.currentAction="Loading MusicBrainz Release: ".concat(e),t.next=3,this.jam.metadata.musicbrainzLookup({type:T.ej.release,mbID:e});case 3:return n=t.sent,t.abrupt("return",n.data.release?this.addReleaseGroupByID(n.data.release.releaseGroup.id):Promise.reject(Error("Got empty data")));case 5:case"end":return t.stop()}},t,this)}))}},{key:"addReleaseGroupByID",value:function(e){return(0,C.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=this.matchTree.findReleaseGroup(e)){t.next=7;break}return this.currentAction="Loading MusicBrainz Release Group: ".concat(e),t.next=5,this.jam.metadata.musicbrainzLookup({type:T.ej.releaseGroup,mbID:e});case 5:i=t.sent,n=this.matchTree.addReleaseGroup(i.data.releaseGroup);case 7:return t.abrupt("return",n);case 8:case"end":return t.stop()}},t,this)}))}},{key:"acoustId",value:function(){return(0,C.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n,i,r,a,c,s,l,u,d,g,h,f;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.currentAction="Checking files with AcoustID",t=[],n=o(this.matchings),e.prev=3,n.s();case 5:if((i=n.n()).done){e.next=24;break}if((r=i.value).acoustidEntries){e.next=21;break}return this.currentAction="Checking files with AcoustID: ".concat(r.track.name),e.prev=9,e.next=12,this.jam.metadata.acoustidLookup({trackID:r.track.id});case 12:a=e.sent,r.acoustidEntries=ee(a.data,r.track),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(9),console.error(e.t0);case 19:if(!this.isAborted){e.next=21;break}return e.abrupt("return");case 21:r.acoustidEntries&&(t=t.concat(r.acoustidEntries));case 22:e.next=5;break;case 24:e.next=29;break;case 26:e.prev=26,e.t1=e.catch(3),n.e(e.t1);case 29:return e.prev=29,n.f(),e.finish(29);case 32:c=new te,s=o(t);try{for(s.s();!(l=s.n()).done;)u=l.value,c.add(u)}catch(p){s.e(p)}finally{s.f()}d=o(c.releasegroups),e.prev=36,d.s();case 38:if((g=d.n()).done){e.next=58;break}if(h=g.value,!this.shouldStop()){e.next=42;break}return e.abrupt("return");case 42:if(f=this.matchTree.findReleaseGroup(h.id),e.t2=f,e.t2){e.next=48;break}return e.next=47,this.addReleaseGroupByID(h.id);case 47:f=e.sent;case 48:if(e.t3=f&&!f.currentRelease,!e.t3){e.next=53;break}return e.next=52,this.loadBestMatchingCurrentRelease(f);case 52:e.t3=this.shouldStop();case 53:if(!e.t3){e.next=55;break}return e.abrupt("return");case 55:this.matchTree.sort();case 56:e.next=38;break;case 58:e.next=63;break;case 60:e.prev=60,e.t4=e.catch(36),d.e(e.t4);case 63:return e.prev=63,d.f(),e.finish(63);case 66:case"end":return e.stop()}},e,this,[[3,26,29,32],[9,16],[36,60,63,66]])}))}},{key:"buildQuickQueries",value:function(){var e,t,n,i=[],r=[],a=[],c=o(this.matchings);try{for(c.s();!(n=c.n()).done;){var s=n.value;if(s.track.tag&&s.track.tag.album){var l=It(s.track.tag.album);s.track.tag.album&&!r.includes(l)&&r.push(l),s.track.tag.artist&&!a.includes(s.track.tag.artist)&&a.push(s.track.tag.artist)}}}catch(u){c.e(u)}finally{c.f()}return 1===r.length&&i.push(new St({type:T.xI.releaseGroup,releasegroup:r[0],artist:a.length>0?a[0]:void 0})),(null===(t=null===(e=this.data)||void 0===e?void 0:e.folder)||void 0===t?void 0:t.tag)&&i.push(new St({type:T.xI.releaseGroup,releasegroup:this.data.folder.name,artist:this.data.folder.tag.artist})),i}},{key:"buildQueries",value:function(){var e,t,n,i,r,a,c,s,l,u,d,g,h,f,p,m,v,C=this,M=[],k=function(e,t,n){for(var i={type:e.type},r=0,a=Object.keys(e);r<a.length;r++){var o=a[r],c=e[o];if(void 0===c||""===c||""===c.toString().trim())return;var s=c.toString().split("(");s.length>0&&(i[o]=s[0])}n&&(i.tracks=C.matchings.length),function(e,t){var n=M.find(function(t){return t.id===e.id});n?n.matchings.push(t):(e.matchings.push(t),M.push(e))}(new St(i),t)},x=o(this.matchings);try{for(x.s();!(v=x.n()).done;){var b=v.value;k({type:T.xI.releaseGroup,releasegroup:null===(e=b.track.tag)||void 0===e?void 0:e.album,artist:null===(t=b.track.tag)||void 0===t?void 0:t.artist},b)}}catch(H){x.e(H)}finally{x.f()}var O,y=o(this.matchings);try{for(y.s();!(O=y.n()).done;){var P=O.value;k({type:T.xI.release,release:null===(n=P.track.tag)||void 0===n?void 0:n.album,artist:null===(i=P.track.tag)||void 0===i?void 0:i.artist},P,!0)}}catch(H){y.e(H)}finally{y.f()}var _,w=o(this.matchings);try{for(w.s();!(_=w.n()).done;){var A=_.value;k({type:T.xI.release,release:null===(r=A.track.tag)||void 0===r?void 0:r.album,artist:null===(a=A.track.tag)||void 0===a?void 0:a.artist},A)}}catch(H){w.e(H)}finally{w.f()}var R,S=o(this.matchings);try{for(S.s();!(R=S.n()).done;){var Z=R.value;if(null===(c=Z.track.tag)||void 0===c?void 0:c.title)k({type:T.xI.recording,recording:Z.track.tag.title,release:Z.track.tag.album,artist:Z.track.tag.artist},Z);else{var D=(0,I.f_)(Z.track.name);k({type:T.xI.recording,recording:D,release:null===(s=Z.track.tag)||void 0===s?void 0:s.album,artist:null===(l=Z.track.tag)||void 0===l?void 0:l.artist},Z)}}}catch(H){S.e(H)}finally{S.f()}var B,N=o(this.matchings);try{for(N.s();!(B=N.n()).done;){var F=B.value;if(null===(u=F.track.tag)||void 0===u?void 0:u.title)k({type:T.xI.recording,recording:F.track.tag.title,release:F.track.tag.album},F),k({type:T.xI.recording,recording:F.track.tag.title,artist:F.track.tag.artist},F);else{var E=(0,I.f_)(F.track.name);k({type:T.xI.recording,recording:E,release:null===(d=F.track.tag)||void 0===d?void 0:d.album},F),k({type:T.xI.recording,recording:E,artist:null===(g=F.track.tag)||void 0===g?void 0:g.artist},F)}}}catch(H){N.e(H)}finally{N.f()}var J,L=o(this.matchings);try{for(L.s();!(J=L.n()).done;){var q=J.value;k({type:T.xI.releaseGroup,releasegroup:null===(h=q.track.tag)||void 0===h?void 0:h.album},q),k({type:T.xI.release,release:null===(f=q.track.tag)||void 0===f?void 0:f.album},q,!0),k({type:T.xI.release,release:null===(p=q.track.tag)||void 0===p?void 0:p.album},q)}}catch(H){L.e(H)}finally{L.f()}var U,G=o(this.matchings);try{for(G.s();!(U=G.n()).done;){var X=U.value;if(null===(m=X.track.tag)||void 0===m?void 0:m.title)k({type:T.xI.recording,recording:X.track.tag.title},X);else{var z=(0,I.f_)(X.track.name);k({type:T.xI.recording,recording:z},X)}}}catch(H){G.e(H)}finally{G.f()}return M}},{key:"loadBestMatchingCurrentRelease",value:function(e){return(0,C.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,i,r,a,c=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=e.releases.sort(function(e,t){var n=Math.abs((e.totalTrack||0)-c.matchings.length),i=Math.abs((t.totalTrack||0)-c.matchings.length);return n===i?e.sortDate-t.sortDate:n-i}),i=o(n),t.prev=2,i.s();case 4:if((r=i.n()).done){t.next=14;break}if(a=r.value,!this.shouldStop()){t.next=8;break}return t.abrupt("return");case 8:return t.next=10,this.loadRelease(a);case 10:if(!a.complete){t.next=12;break}return t.abrupt("return",void(e.currentRelease=a));case 12:t.next=4;break;case 14:t.next=19;break;case 16:t.prev=16,t.t0=t.catch(2),i.e(t.t0);case 19:return t.prev=19,i.f(),t.finish(19);case 22:if(t.t1=e.releases.length>0,!t.t1){t.next=27;break}return t.next=26,this.loadRelease(e.releases[0]);case 26:e.currentRelease=e.releases[0];case 27:case"end":return t.stop()}},t,this,[[2,16,19,22]])}))}},{key:"loadByReleaseGroups",value:function(e){return(0,C.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,i,r,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=o(e),t.prev=1,n.s();case 3:if((i=n.n()).done){t.next=19;break}if(r=i.value,!this.shouldStop()){t.next=7;break}return t.abrupt("return");case 7:if(a=this.matchTree.findReleaseGroup(r.id),t.t0=a,t.t0){t.next=13;break}return t.next=12,this.addReleaseGroupByID(r.id);case 12:a=t.sent;case 13:if(t.t1=a&&!a.currentRelease,!t.t1){t.next=17;break}return t.next=17,this.loadBestMatchingCurrentRelease(a);case 17:t.next=3;break;case 19:t.next=24;break;case 21:t.prev=21,t.t2=t.catch(1),n.e(t.t2);case 24:return t.prev=24,n.f(),t.finish(24);case 27:case"end":return t.stop()}},t,this,[[1,21,24,27]])}))}},{key:"loadByReleases",value:function(e){return(0,C.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,i,r,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=o(e),t.prev=1,n.s();case 3:if((i=n.n()).done){t.next=19;break}if(r=i.value,!this.shouldStop()){t.next=7;break}return t.abrupt("return");case 7:if(a=this.matchTree.findReleaseGroup(r.releaseGroup.id),t.t0=a,t.t0){t.next=13;break}return t.next=12,this.addReleaseGroupByID(r.releaseGroup.id);case 12:a=t.sent;case 13:if(t.t1=a&&!a.currentRelease,!t.t1){t.next=17;break}return t.next=17,this.loadBestMatchingCurrentRelease(a);case 17:t.next=3;break;case 19:t.next=24;break;case 21:t.prev=21,t.t2=t.catch(1),n.e(t.t2);case 24:return t.prev=24,n.f(),t.finish(24);case 27:case"end":return t.stop()}},t,this,[[1,21,24,27]])}))}},{key:"loadByRecordings",value:function(e){return(0,C.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,i,r,a,c,s,l;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=o(e),t.prev=1,n.s();case 3:if((i=n.n()).done){t.next=37;break}if(r=i.value,!this.shouldStop()){t.next=7;break}return t.abrupt("return");case 7:if(!r.releases){t.next=35;break}a=o(r.releases),t.prev=9,a.s();case 11:if((c=a.n()).done){t.next=27;break}if(s=c.value,!this.shouldStop()){t.next=15;break}return t.abrupt("return");case 15:if(l=this.matchTree.findReleaseGroup(s.releaseGroup.id),t.t0=l,t.t0){t.next=21;break}return t.next=20,this.addReleaseGroupByID(s.releaseGroup.id);case 20:l=t.sent;case 21:if(t.t1=l&&!l.currentRelease,!t.t1){t.next=25;break}return t.next=25,this.loadBestMatchingCurrentRelease(l);case 25:t.next=11;break;case 27:t.next=32;break;case 29:t.prev=29,t.t2=t.catch(9),a.e(t.t2);case 32:return t.prev=32,a.f(),t.finish(32);case 35:t.next=3;break;case 37:t.next=42;break;case 39:t.prev=39,t.t3=t.catch(1),n.e(t.t3);case 42:return t.prev=42,n.f(),t.finish(42);case 45:case"end":return t.stop()}},t,this,[[1,39,42,45],[9,29,32,35]])}))}},{key:"runQuery",value:function(e,t){return(0,C.mG)(this,void 0,void 0,regeneratorRuntime.mark(function n(){var i,r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!this.shouldStop()){n.next=2;break}return n.abrupt("return");case 2:return this.currentAction=e.name,n.next=5,this.jam.metadata.musicbrainzSearch(e.q);case 5:if(!(i=n.sent.data).releaseGroups){n.next=11;break}return n.next=9,this.loadByReleaseGroups(i.releaseGroups);case 9:n.next=22;break;case 11:if(!i.releases){n.next=16;break}return n.next=14,this.loadByReleases(i.releases);case 14:n.next=22;break;case 16:if(!i.recordings){n.next=21;break}return n.next=19,this.loadByRecordings(i.recordings);case 19:n.next=22;break;case 21:console.error("TODO",i);case 22:if(this.matchTree.sort(),!this.shouldStop()){n.next=25;break}return n.abrupt("return");case 25:if(r=t.shift(),n.t0=r,!n.t0){n.next=30;break}return n.next=30,this.runQuery(r,t);case 30:case"end":return n.stop()}},n,this)}))}},{key:"musicBrainzByQuickTags",value:function(){return(0,C.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.buildQuickQueries(),n=t.shift(),e.t0=n,!e.t0){e.next=5;break}return e.next=5,this.runQuery(n,t);case 5:case"end":return e.stop()}},e,this)}))}},{key:"musicBrainzByTags",value:function(){return(0,C.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.buildQueries(),n=t.shift(),e.t0=n,!e.t0){e.next=5;break}return e.next=5,this.runQuery(n,t);case 5:case"end":return e.stop()}},e,this)}))}},{key:"musicBrainzRefresh",value:function(){return(0,C.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n,i,r,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=o(this.matchings),e.prev=1,t.s();case 3:if((n=t.n()).done){e.next=36;break}if(i=n.value,!this.shouldStop()){e.next=7;break}return e.abrupt("return");case 7:if(!i.track.tag){e.next=34;break}if(r=void 0,e.t0=i.track.tag.mbReleaseGroupID,!e.t0){e.next=14;break}return e.next=13,this.addReleaseGroupByID(i.track.tag.mbReleaseGroupID);case 13:r=e.sent;case 14:if(e.t1=!r&&i.track.tag.mbReleaseID,!e.t1){e.next=19;break}return e.next=18,this.addReleaseGroupByReleaseID(i.track.tag.mbReleaseID);case 18:r=e.sent;case 19:if(!r){e.next=34;break}if(!i.track.tag.mbReleaseID){e.next=30;break}if(!(a=r.findRelease(i.track.tag.mbReleaseID))){e.next=27;break}return e.next=25,this.loadRelease(a);case 25:e.next=28;break;case 27:console.error("Could not find the release with id",i.track.tag.mbReleaseID);case 28:r.currentRelease=a,r.enough(this.matchings.length)||(r.currentRelease=void 0);case 30:if(e.t2=r.currentRelease,e.t2){e.next=34;break}return e.next=34,this.loadBestMatchingCurrentRelease(r);case 34:e.next=3;break;case 36:e.next=41;break;case 38:e.prev=38,e.t3=e.catch(1),t.e(e.t3);case 41:return e.prev=41,t.f(),e.finish(41);case 44:case"end":return e.stop()}},e,this,[[1,38,41,44]])}))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(F.Y36(pe.zi),F.Y36(T.K4),F.Y36(pe.c),F.Y36(g.Lk),F.Y36(Oe.eN),F.Y36(F.sBO))},e.\u0275cmp=F.Xpm({type:e,selectors:[["app-match-release"]],viewQuery:function(e,t){var n;(1&e&&(F.Gf(be,5),F.Gf(Re,5)),2&e)&&(F.iGM(n=F.CRH())&&(t.coverArt=n.first),F.iGM(n=F.CRH())&&(t.actionMenu=n.first))},hostVars:2,hostBindings:function(e,t){2&e&&F.ekj("right-active",t.rightActive)},inputs:{data:"data"},features:[F.TTD],decls:20,vars:9,consts:[[1,"toggle",3,"click"],["class","button-on-control",4,"ngIf"],[1,"content"],[1,"match-files"],[1,"match-file-list"],[1,"match-file-list-header"],["class","match-file","draggable","true",3,"dragstart",4,"ngFor","ngForOf"],["class","match-releases",4,"ngIf"],["class","current-log",4,"ngIf"],["class","buttons",4,"ngIf"],["actionMenu",""],["contextMenuItem","",3,"execute"],[1,"button-on-control"],[1,"icon-left"],[1,"icon-right"],["draggable","true",1,"match-file",3,"dragstart"],[1,"handle"],[1,"grippy"],[1,"title"],[4,"ngIf"],[1,"label"],[1,"currentRelease"],[1,"value"],[1,"match-releases"],[1,"match-apply"],[1,"section"],["class","icon-spin icon-spinner",4,"ngIf"],[3,"data"],[1,"match-track-moods"],[1,"button-on-background",3,"click"],[1,"icon-spin","icon-spinner"],["class","select",3,"title",4,"ngFor","ngForOf"],[1,"select"],["type","checkbox",3,"ngModel","ngModelChange"],["type","text",3,"ngModel","ngModelChange"],[1,"select",3,"title"],[1,"match-results"],["class","match-releasegroup",4,"ngFor","ngForOf"],[1,"match-releasegroup"],[1,"match-releasegroup-title"],["class","match-release-info",4,"ngIf"],[1,"match-select-releases"],["class","button-on-background",3,"click",4,"ngIf"],["class","button-primary",3,"ngClass","click",4,"ngIf"],["class","match-tracks-info",4,"ngIf"],[1,"match-release-info"],[3,"score"],["class","value",4,"ngIf"],[4,"ngFor","ngForOf"],["class","icon-checkmark","title","All tracks matched",4,"ngIf"],["title","Unmatched tracks!","class","icon-warning",4,"ngIf"],["title","All tracks matched",1,"icon-checkmark"],["title","Unmatched tracks!",1,"icon-warning"],[1,"button-primary",3,"ngClass","click"],["class","select",3,"click",4,"ngFor","ngForOf"],[1,"select",3,"click"],["type","radio","name","release",3,"checked"],[1,"match-tracks-info"],[3,"click",4,"ngIf"],[3,"click"],["class","match-track-info",3,"ngClass","drop","dragover",4,"ngFor","ngForOf"],[1,"match-track-info",3,"ngClass","drop","dragover"],[3,"title",4,"ngIf"],[3,"title"],["title","Remove Matching",3,"click"],[1,"icon-trash"],[1,"current-log"],[1,"buttons"],[1,"match-actions"],["class","button-primary",4,"ngIf"],["class","button-primary",3,"click",4,"ngIf"],[1,"button-accent",3,"click"],[1,"button-primary"],[1,"button-primary",3,"click"],["class","match-actions",4,"ngIf"],[1,"button-on-control","button-with-add-on",3,"click"],[1,"button-on-control","button-add-on",3,"click"],[1,"match-search"],[3,"value","getList","standalone","valueChange"]],template:function(e,t){1&e&&(F.TgZ(0,"div",0),F.NdJ("click",function(){return t.rightActive=!t.rightActive}),F.YNc(1,Ie,3,0,"a",1),F.YNc(2,Se,3,0,"a",1),F.qZA(),F.TgZ(3,"div",2),F.TgZ(4,"div",3),F.TgZ(5,"div",4),F.TgZ(6,"div",5),F._uU(7),F.qZA(),F.YNc(8,Ne,6,2,"div",6),F.qZA(),F.qZA(),F.YNc(9,Le,15,7,"div",7),F.YNc(10,pt,3,1,"div",7),F.qZA(),F.YNc(11,mt,3,1,"div",8),F.YNc(12,Mt,6,2,"div",9),F.TgZ(13,"context-menu",null,10),F.YNc(15,kt,1,0,"ng-template",11),F.NdJ("execute",function(){return t.setManualSearch()}),F.YNc(16,Tt,1,0,"ng-template",11),F.NdJ("execute",function(){return t.start(t.RunType.acoustID)}),F.YNc(17,xt,1,0,"ng-template",11),F.NdJ("execute",function(){return t.start(t.RunType.musicbrainzByTags)}),F.YNc(18,bt,1,0,"ng-template",11),F.NdJ("execute",function(){return t.start(t.RunType.musicbrainzRefresh)}),F.qZA(),F.YNc(19,Rt,3,2,"div",9)),2&e&&(F.xp6(1),F.Q6J("ngIf",t.rightActive),F.xp6(1),F.Q6J("ngIf",!t.rightActive),F.xp6(5),F.hij("",t.matchings.length," Tracks"),F.xp6(1),F.Q6J("ngForOf",t.matchings),F.xp6(1),F.Q6J("ngIf",t.current),F.xp6(1),F.Q6J("ngIf",!t.current),F.xp6(1),F.Q6J("ngIf",t.isRunning),F.xp6(1),F.Q6J("ngIf",t.current),F.xp6(7),F.Q6J("ngIf",!t.current))},directives:[l.O5,l.sg,g.GI,g.n5,be,u.Wl,u.JJ,u.On,u.Fj,Pe,l.mk,u._Y,u.JL,u.F,Q],pipes:[_e.N,we.C,l.JJ,Ae],styles:['[_nghost-%COMP%]{display:flex;flex-direction:column;width:100%;height:100%;overflow:hidden}[_nghost-%COMP%]   .toggle[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex:1 1 auto;overflow-y:auto}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{padding-right:4px;font-size:.9em;text-transform:uppercase}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .select[_ngcontent-%COMP%]{padding-top:2px;padding-bottom:2px;display:block;font-size:.9em}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .select[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{margin-right:4px}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .select[_ngcontent-%COMP%]:hover{background-color:var(--background-hover)}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]{overflow-y:auto;overflow-x:auto;display:block;height:100%;width:50%;font-size:.8em;padding-right:15px}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]{display:flex;flex-flow:column wrap;-webkit-user-select:none;-moz-user-select:none;user-select:none;width:100%;padding-top:5px;background-color:var(--background);color:var(--on-background);margin-bottom:15px}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file-list-header[_ngcontent-%COMP%]{text-align:center;padding-bottom:5px}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]{min-height:48px;display:flex;flex-flow:row nowrap;align-items:center;align-content:space-evenly;width:100%;line-height:1.25em;border-bottom:0 solid var(--background-border);border-top:1px solid var(--background-border);padding:10px 10px 10px 0}@media (max-width:1000px){[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]{height:auto}}@media (max-width:522px){[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]{font-size:.9em}}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .number[_ngcontent-%COMP%]{min-width:32px;text-align:right}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .play-count[_ngcontent-%COMP%]{min-width:20px;text-align:right}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .rating[_ngcontent-%COMP%]{min-width:30px;text-align:center}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .play-date[_ngcontent-%COMP%]{min-width:100px}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .fav[_ngcontent-%COMP%]{min-width:30px;text-align:center}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{flex-grow:1}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .length[_ngcontent-%COMP%]{min-width:80px;text-align:right}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{margin-left:15px}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:last-of-type{margin-right:15px}@media (max-width:400px){[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{margin-left:0}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:last-of-type{margin-right:0}}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]:hover{background-color:var(--background-hover)}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]:last-child{border-bottom-width:1px}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .small-screen-icon[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{color:var(--on-background-active)}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--on-background);font-size:.8em}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{padding:0;display:inline-block;margin:0 10px 0 0}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{font-size:.8em;vertical-align:middle}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   a.title-link[_ngcontent-%COMP%]{font-size:inherit;margin-right:10px;color:var(--on-background-active)}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--on-background)}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:var(--on-background-hover)}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]{width:0;margin-left:0;cursor:move}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]   span.grippy[_ngcontent-%COMP%]{display:inline-block;width:26px;height:8px;transform:rotate(90deg);margin-left:-8px}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]   span.grippy[_ngcontent-%COMP%], [_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]   span.grippy[_ngcontent-%COMP%]:before{background-image:radial-gradient(#7b7b7b 40%,transparent 0);background-size:4px 4px;background-position:0 100%;background-repeat:repeat-x}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]   span.grippy[_ngcontent-%COMP%]:before{content:"";display:block;width:100%;height:33%}@media (max-width:1000px){[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]{height:auto;min-height:48px}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{display:block}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:inline-block;margin-left:0}}@media (max-width:400px){[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]{flex-flow:row wrap;align-items:inherit;width:100%;font-size:.9em}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .small-screen-icon[_ngcontent-%COMP%]{display:inline-block}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]{order:2;width:25%;text-align:center}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]   span.grippy[_ngcontent-%COMP%]{transform:rotate(0deg)}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{order:6;margin-left:0;margin-right:0;padding-right:0;padding-left:0;width:100%}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{margin-left:0;margin-right:0;padding-right:0;padding-left:0;overflow:hidden;text-overflow:ellipsis}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{width:100%;margin-left:0;margin-right:0;overflow:hidden;text-overflow:ellipsis}}@media (max-width:1200px){[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .fav[_ngcontent-%COMP%]{display:none}}@media (max-width:400px){[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .length[_ngcontent-%COMP%], [_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .number[_ngcontent-%COMP%], [_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .play-count[_ngcontent-%COMP%], [_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .play-date[_ngcontent-%COMP%], [_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .rating[_ngcontent-%COMP%]{margin-left:0;margin-right:0;padding-right:0;padding-left:0;font-size:.8em;width:30%;flex-grow:1;text-align:center}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .number[_ngcontent-%COMP%]{order:1;width:25%;text-align:left}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .play-count[_ngcontent-%COMP%]{order:2}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .rating[_ngcontent-%COMP%]{order:3}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .play-date[_ngcontent-%COMP%]{order:4}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .length[_ngcontent-%COMP%]{order:5;width:25%;text-align:right}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{order:6}}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:11px}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   span.value[_ngcontent-%COMP%]{color:var(--on-background-active);padding-right:5px}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-releases[_ngcontent-%COMP%]{border-left:1px solid var(--background-border);display:flex;flex-direction:column;flex:1 1 auto;width:50%;font-size:.9em}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-releases[_ngcontent-%COMP%]   .icon-checkmark[_ngcontent-%COMP%]{color:var(--primary)}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-releases[_ngcontent-%COMP%]   .icon-warning[_ngcontent-%COMP%]{color:var(--accent)}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-releases[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:var(--on-background-active);padding-right:5px}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-releases[_ngcontent-%COMP%]   .match-results[_ngcontent-%COMP%]{flex:1 1 auto;overflow-y:auto;overflow-x:auto}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-releases[_ngcontent-%COMP%]   .match-results[_ngcontent-%COMP%]   .match-releasegroup[_ngcontent-%COMP%]{padding:5px 5px 5px 15px}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-releases[_ngcontent-%COMP%]   .match-results[_ngcontent-%COMP%]   .match-releasegroup[_ngcontent-%COMP%]   .match-release-info[_ngcontent-%COMP%], [_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-releases[_ngcontent-%COMP%]   .match-results[_ngcontent-%COMP%]   .match-releasegroup[_ngcontent-%COMP%]   .match-tracks-info[_ngcontent-%COMP%]{font-size:.8em}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-releases[_ngcontent-%COMP%]   .match-results[_ngcontent-%COMP%]   .match-releasegroup[_ngcontent-%COMP%]   .match-release-info[_ngcontent-%COMP%], [_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-releases[_ngcontent-%COMP%]   .match-results[_ngcontent-%COMP%]   .match-releasegroup[_ngcontent-%COMP%]   .match-select-releases[_ngcontent-%COMP%], [_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-releases[_ngcontent-%COMP%]   .match-results[_ngcontent-%COMP%]   .match-releasegroup[_ngcontent-%COMP%]   .match-tracks-info[_ngcontent-%COMP%]{padding-top:4px}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-releases[_ngcontent-%COMP%]   .match-results[_ngcontent-%COMP%]   .match-releasegroup[_ngcontent-%COMP%]   .match-select-releases[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:.7em;line-height:.7em;vertical-align:top}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-releases[_ngcontent-%COMP%]   .match-results[_ngcontent-%COMP%]   .match-releasegroup[_ngcontent-%COMP%]   app-image-base64[_ngcontent-%COMP%]{height:32px;width:32px}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-releases[_ngcontent-%COMP%]   .match-results[_ngcontent-%COMP%]   .match-releasegroup[_ngcontent-%COMP%]   .match-track-info[_ngcontent-%COMP%]{padding-top:2px;padding-bottom:2px;border-top:1px solid var(--background-border)}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-releases[_ngcontent-%COMP%]   .match-results[_ngcontent-%COMP%]   .match-releasegroup[_ngcontent-%COMP%]   .match-track-info.missing[_ngcontent-%COMP%]{color:var(--accent)}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-releases[_ngcontent-%COMP%]   .match-results[_ngcontent-%COMP%]   .match-releasegroup[_ngcontent-%COMP%]   .match-release[_ngcontent-%COMP%]{white-space:nowrap;padding:5px 5px 5px 42px}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-releases[_ngcontent-%COMP%]   .match-apply[_ngcontent-%COMP%]{flex:1 1 auto;overflow-y:auto;overflow-x:auto;padding:15px}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-releases[_ngcontent-%COMP%]   .match-apply[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{padding-bottom:10px}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-releases[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]{color:var(--on-background-active);text-transform:uppercase;padding-bottom:10px;white-space:nowrap}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-releases[_ngcontent-%COMP%]   app-match-coverart[_ngcontent-%COMP%]{border-top:1px solid var(--background-border)}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-releases[_ngcontent-%COMP%]   .match-album-images[_ngcontent-%COMP%]{border-top:1px solid var(--background-border);padding-top:15px}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-releases[_ngcontent-%COMP%]   .match-album-images[_ngcontent-%COMP%]   .front-only-choice[_ngcontent-%COMP%]{float:right;font-size:.8em}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-releases[_ngcontent-%COMP%]   .match-album-images[_ngcontent-%COMP%]   .match-images[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap}@media (max-width:768px){[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-releases[_ngcontent-%COMP%]   .match-album-images[_ngcontent-%COMP%]   .match-images[_ngcontent-%COMP%]{justify-content:space-around}}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-releases[_ngcontent-%COMP%]   .match-track-moods[_ngcontent-%COMP%]{border-top:1px solid var(--background-border);padding-top:15px}[_nghost-%COMP%]   .buttons[_ngcontent-%COMP%]{flex:0 0 auto;padding:5px;display:flex;align-items:center;justify-content:center;border-top:1px solid var(--background-border)}[_nghost-%COMP%]   .buttons[_ngcontent-%COMP%]   .match-actions[_ngcontent-%COMP%]{text-align:center;vertical-align:middle;margin-top:10px;margin-bottom:30px}[_nghost-%COMP%]   .buttons[_ngcontent-%COMP%]   .match-actions[_ngcontent-%COMP%]   app-tag-editor-autocomplete[_ngcontent-%COMP%]{height:28px;display:block}[_nghost-%COMP%]   .buttons[_ngcontent-%COMP%]   .match-actions[_ngcontent-%COMP%]   .match-search[_ngcontent-%COMP%]{display:flex;flex-direction:row;text-align:left;margin-bottom:10px}@media (max-width:768px){[_nghost-%COMP%]   .buttons[_ngcontent-%COMP%]   .match-actions[_ngcontent-%COMP%]   .match-search[_ngcontent-%COMP%]{flex-direction:column}}[_nghost-%COMP%]   .buttons[_ngcontent-%COMP%]   .match-actions[_ngcontent-%COMP%]   .match-search[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{flex:1;padding-left:10px;padding-right:10px}[_nghost-%COMP%]   .buttons[_ngcontent-%COMP%]   .match-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:10px;margin-right:10px}[_nghost-%COMP%]   .buttons[_ngcontent-%COMP%]   .match-actions[_ngcontent-%COMP%]   .match-progress[_ngcontent-%COMP%]{display:block;font-size:.9em}[_nghost-%COMP%]   .current-log[_ngcontent-%COMP%]{font-size:.8em;padding:5px}@media (max-width:768px){[_nghost-%COMP%]   .toggle[_ngcontent-%COMP%]{display:block;position:relative;width:100%;height:auto;text-align:center;padding-top:5px;padding-bottom:5px}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]{overflow-y:auto}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]{height:auto;width:100%;overflow-y:inherit;display:block;padding-right:0}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-releases[_ngcontent-%COMP%]{height:auto;width:100%;display:none;border-left:none}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-releasegroup[_ngcontent-%COMP%]{padding-left:0}.right-active[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-releases[_ngcontent-%COMP%]{display:block}.right-active[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]{display:none}}']}),e}(),Bt=function(){var e=function(){function e(){s(this,e),this.unsubscribe=new m.xQ}return a(e,[{key:"dialogInit",value:function(e,t){var n=this;this.data=t.data,this.data&&(this.data.close=function(){e.close()}),e.beforeClose().pipe((0,v.R)(this.unsubscribe)).subscribe(function(){n.data=void 0})}},{key:"ngOnDestroy",value:function(){this.unsubscribe.next(),this.unsubscribe.complete()}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=F.Xpm({type:e,selectors:[["app-dialog-match-release"]],decls:1,vars:1,consts:[[3,"data"]],template:function(e,t){1&e&&F._UZ(0,"app-match-release",0),2&e&&F.Q6J("data",t.data)},directives:[Dt],styles:[""]}),e}(),Nt=r(87639),Ft=r(7480);function Et(e,t){if(1&e){var n=F.EpF();F.TgZ(0,"div",7),F._uU(1," Column Text "),F.TgZ(2,"div",8),F.TgZ(3,"app-tag-editor-autocomplete",14),F.NdJ("valueChange",function(e){return F.CHM(n),F.oxw(2).multiStr=e}),F.qZA(),F.qZA(),F.TgZ(4,"button",11),F.NdJ("click",function(){F.CHM(n);var e=F.oxw(2);return e.editor.setColumnText(e.activeCol,e.multiStr)}),F._uU(5,"Set"),F.qZA(),F.TgZ(6,"button",11),F.NdJ("click",function(){F.CHM(n);var e=F.oxw(2);return e.editor.appendColumnText(e.activeCol,e.multiStr)}),F._uU(7,"Append"),F.qZA(),F.TgZ(8,"button",11),F.NdJ("click",function(){F.CHM(n);var e=F.oxw(2);return e.editor.removeColumnText(e.activeCol,e.multiStr)}),F._uU(9,"Remove"),F.qZA(),F.qZA()}if(2&e){var i=F.oxw(2);F.xp6(3),F.Q6J("value",i.multiStr)("getList",i.activeCol.getAutoCompleteList)}}function Jt(e,t){if(1&e&&(F.TgZ(0,"option",15),F._uU(1),F.qZA()),2&e){var n=t.$implicit;F.Q6J("value",t.index),F.xp6(1),F.Oqu(n.def.name)}}function Lt(e,t){if(1&e){var n=F.EpF();F.TgZ(0,"div",7),F._uU(1),F._UZ(2,"br"),F.TgZ(3,"button",11),F.NdJ("click",function(){return F.CHM(n).$implicit.click()}),F._UZ(4,"i",16),F.qZA(),F.qZA()}if(2&e){var i=t.$implicit;F.xp6(1),F.hij(" ",i.title,"")}}function qt(e,t){if(1&e){var n=F.EpF();F.TgZ(0,"div",1),F.TgZ(1,"div",2),F.TgZ(2,"div",3),F.TgZ(3,"a",4),F.NdJ("click",function(){return F.CHM(n),F.oxw().close()}),F.qZA(),F.qZA(),F._uU(4," Current Column: "),F.TgZ(5,"span"),F._uU(6),F.qZA(),F.qZA(),F.TgZ(7,"div",5),F.YNc(8,Et,10,2,"div",6),F.TgZ(9,"div",7),F._uU(10," Column Source "),F.TgZ(11,"div",8),F.TgZ(12,"select",9),F.NdJ("ngModelChange",function(e){return F.CHM(n),F.oxw().sourceColumnIndex=e}),F.YNc(13,Jt,2,2,"option",10),F.qZA(),F.qZA(),F.TgZ(14,"button",11),F.NdJ("click",function(){F.CHM(n);var e=F.oxw();return e.editor.copyColumn(e.sourceColumnIndex,e.activeCol)}),F._uU(15,"Copy"),F.qZA(),F.TgZ(16,"button",11),F.NdJ("click",function(){F.CHM(n);var e=F.oxw();return e.editor.appendFromColumn(e.sourceColumnIndex,e.activeCol)}),F._uU(17,"Append"),F.qZA(),F.TgZ(18,"button",11),F.NdJ("click",function(){F.CHM(n);var e=F.oxw();return e.editor.insertFromColumn(e.sourceColumnIndex,0,e.activeCol)}),F._uU(19,"Insert at "),F._UZ(20,"input",12),F.qZA(),F.qZA(),F.YNc(21,Lt,5,1,"div",13),F.qZA(),F.qZA()}if(2&e){var i=F.oxw();F.xp6(6),F.Oqu(i.activeCol.def.name),F.xp6(2),F.Q6J("ngIf",i.activeCol.multi),F.xp6(4),F.Q6J("ngModel",i.sourceColumnIndex),F.xp6(1),F.Q6J("ngForOf",i.editor.columns),F.xp6(8),F.Q6J("ngForOf",i.activeCol.actions)}}var Ut=function(){var e=function(){function e(){s(this,e),this.requestClose=new F.vpe,this.sourceColumnIndex=0,this.multiStr=""}return a(e,[{key:"close",value:function(){this.requestClose.emit()}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=F.Xpm({type:e,selectors:[["app-admin-tag-editor-column-tool"]],inputs:{editor:"editor",activeCol:"activeCol"},outputs:{requestClose:"requestClose"},decls:1,vars:1,consts:[["class","column-tools",4,"ngIf"],[1,"column-tools"],[1,"column-tools-title"],[1,"close-panel"],[1,"close",3,"click"],[1,"column-tool-content"],["class","column-tool",4,"ngIf"],[1,"column-tool"],[1,"input-box"],[3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[1,"button-on-background",3,"click"],["type","number"],["class","column-tool",4,"ngFor","ngForOf"],[3,"value","getList","valueChange"],[3,"value"],[1,"icon-down-thin"]],template:function(e,t){1&e&&F.YNc(0,qt,22,5,"div",0),2&e&&F.Q6J("ngIf",t.activeCol&&t.editor)},directives:[l.O5,u.EJ,u.JJ,u.On,l.sg,Q,u.YN,u.Kr],styles:['[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]{border:1px solid var(--control-border);padding-bottom:15px}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .close-panel[_ngcontent-%COMP%]{float:right;display:inline-block;overflow:hidden;width:2.5rem;height:2.5rem;max-width:2.5rem;max-height:2.5rem;margin-top:-15px}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .close-panel[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:2.5rem;height:2.5rem;border:none;background-color:transparent;font-size:1.5rem;transition:.25s linear}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .close-panel[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]:after, [_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .close-panel[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]:before{position:absolute;content:"";width:.75rem;height:.125rem;background-color:var(--on-control-hover);overflow:hidden}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .close-panel[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]:before{transform:rotate(-45deg)}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .close-panel[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]:after{transform:rotate(45deg)}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .close-panel[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]:hover{transform:rotate(1turn)}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .close-panel[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]:hover:after, [_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .close-panel[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]:hover:before{background-color:var(--accent)}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .column-tools-title[_ngcontent-%COMP%]{padding-top:15px;padding-left:15px;padding-right:15px}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .column-tools-title[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--on-control-active)}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .input-box[_ngcontent-%COMP%]{border-radius:3px;padding-left:3px;padding-right:3px;align-items:center;background-color:var(--input);border:1px solid var(--input-border)}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .input-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{flex:1;border:none;outline:none;min-height:20px;background-color:var(--input);color:var(--on-input)}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .input-box[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:var(--on-input);font-size:14px;cursor:pointer}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .input-box[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]:hover{color:var(--on-input-hover)}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .input-box[_ngcontent-%COMP%]{display:flex}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   app-tag-editor-autocomplete[_ngcontent-%COMP%]{flex:1;border:none;outline:none;min-height:24px;height:24px;background-color:var(--input);color:var(--on-input)}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{flex:1;border:none;outline:none;height:24px;background-color:var(--input);color:var(--on-input);width:100%}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .column-tool-content[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .column-tool[_ngcontent-%COMP%]{padding:15px 15px 0;font-size:.8em;align-self:center}']}),e}(),Gt=r(37199),Xt=["inputEl"],zt=function(){var e=function(){function e(){s(this,e),this.original="",this.val="",this.navigKeyDownRequest=new F.vpe,this.navigBlur=new F.vpe,this.navigChange=new F.vpe}return a(e,[{key:"ngOnChanges",value:function(e){this.changeCell(this.cell)}},{key:"onNavigKeyDown",value:function(e){this.cell&&this.navigKeyDownRequest.emit({cell:this.cell,event:e})}},{key:"changeCell",value:function(e){e&&(this.original=0!==e.frames.length&&e.frames[0].value&&e.frames[0].value.text?this.original=e.frames[0].value.text:"",this.val=this.original)}},{key:"ngAfterViewInit",value:function(){var e=this;setTimeout(function(){var t;(null===(t=e.input)||void 0===t?void 0:t.nativeElement)&&e.input.nativeElement.focus()},0)}},{key:"onEnter",value:function(){this.onChange(),this.navigBlur.emit()}},{key:"onChange",value:function(){this.cell&&this.val!==this.original&&(0===this.cell.frames.length&&this.cell.frames.push({id:this.cell.column.def.id,value:{id:this.cell.column.def.subid,text:this.val}}),this.cell.frames[0].value.text=this.val,this.navigChange.emit())}},{key:"onBlur",value:function(){this.onChange(),this.navigBlur.emit()}},{key:"autocompleteEnter",value:function(e){this.val=e}},{key:"autocompleteGetData",value:function(e){return(0,C.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",[]);case 1:case"end":return e.stop()}},e)}))}},{key:"autocompleteSelectResult",value:function(e){return this.val=e.data,this.val}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=F.Xpm({type:e,selectors:[["app-cell-editor-txt"]],viewQuery:function(e,t){var n;(1&e&&F.Gf(Xt,7),2&e)&&(F.iGM(n=F.CRH())&&(t.input=n.first))},inputs:{cell:"cell"},outputs:{navigKeyDownRequest:"navigKeyDownRequest",navigBlur:"navigBlur",navigChange:"navigChange"},features:[F.TTD],decls:2,vars:1,consts:[["type","text","autocomplete","off",3,"ngModel","ngModelChange","blur","keydown.enter"],["inputEl",""]],template:function(e,t){1&e&&(F.TgZ(0,"input",0,1),F.NdJ("ngModelChange",function(e){return t.val=e})("blur",function(){return t.onBlur()})("keydown.enter",function(){return t.onEnter()}),F.qZA()),2&e&&F.Q6J("ngModel",t.val)},directives:[u.Fj,u.JJ,u.On],styles:["[_nghost-%COMP%]{width:100%;height:100%}[_nghost-%COMP%]   input[_ngcontent-%COMP%]{width:100%;height:100%;text-align:left}"]}),e}();function Ht(e,t){if(1&e){var n=F.EpF();F.TgZ(0,"image-cropper",4),F.NdJ("cropperReady",function(){return F.CHM(n),F.oxw().cropperReady()})("loadImageFailed",function(){return F.CHM(n),F.oxw().loadImageFailed()})("imageLoaded",function(){return F.CHM(n),F.oxw().imageLoaded()})("imageCropped",function(e){return F.CHM(n),F.oxw().imageCropped(e)}),F.qZA()}if(2&e){var i=F.oxw();F.Q6J("maintainAspectRatio",i.maintainAspectRatio)("format","jpeg")("imageBase64",i.current.source)}}var Qt=function(){var e=function(){function e(){s(this,e),this.maintainAspectRatio=!0,this.current={}}return a(e,[{key:"dialogInit",value:function(e,t){this.edit=t.data,this.edit&&(this.edit.result=this.edit.frames.map(function(e){return{id:e.id,value:Object.assign({},e.value)}}),this.edit.result.length>0&&this.displayFrame(this.edit.result[0]))}},{key:"displayFrame",value:function(e){var t="data:".concat(e.value.mimeType||"image/jpeg",";base64,").concat(e.value.bin);this.current.frame=e,this.current.source=t}},{key:"onDropFile",value:function(e){var t;e.preventDefault(),this.uploadFile(null===(t=e.dataTransfer)||void 0===t?void 0:t.files)}},{key:"selectFile",value:function(e){this.uploadFile(e.target.files)}},{key:"onDragOverFile",value:function(e){e.stopPropagation(),e.preventDefault()}},{key:"splitBase64",value:function(e){return{mimeType:e.slice(5,e.indexOf(";")),base64:e.slice(e.indexOf("base64,")+7)}}},{key:"buildFrame",value:function(e){var t=this.splitBase64(e);return{id:"APIC",value:{mimeType:t.mimeType,description:"",bin:t.base64,pictureType:3}}}},{key:"uploadFile",value:function(e){var t=this;if(e&&0!==e.length){var n=e[0],i=new FileReader;i.readAsDataURL(n),i.onload=function(e){var n,i=e.target.result;t.current.frame||(t.current.frame=t.buildFrame(i),(null===(n=t.edit)||void 0===n?void 0:n.result)&&t.edit.result.push(t.current.frame)),t.current.source=i;var r=t.splitBase64(i),a=r.mimeType,o=r.base64;t.current.frame.value.mimeType=a,t.current.frame.value.bin=o},i.onerror=function(e){console.error(e)}}}},{key:"loadImageFailed",value:function(){}},{key:"cropperReady",value:function(){}},{key:"imageLoaded",value:function(){}},{key:"imageCropped",value:function(e){var t;if((null===(t=this.current)||void 0===t?void 0:t.frame)&&e.base64){var n=this.splitBase64(e.base64),i=n.mimeType,r=n.base64;this.current.frame.value.mimeType=i,this.current.frame.value.bin=r}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=F.Xpm({type:e,selectors:[["app-dialog-tag-image"]],decls:7,vars:3,consts:[["type","checkbox",3,"ngModel","checked","ngModelChange"],[1,"drop-zone",3,"drop","dragover"],[3,"maintainAspectRatio","format","imageBase64","cropperReady","loadImageFailed","imageLoaded","imageCropped",4,"ngIf"],["type","file","placeholder","Upload image","accept",".png,.jpeg,.jpg",3,"change"],[3,"maintainAspectRatio","format","imageBase64","cropperReady","loadImageFailed","imageLoaded","imageCropped"]],template:function(e,t){1&e&&(F.TgZ(0,"label"),F.TgZ(1,"input",0),F.NdJ("ngModelChange",function(e){return t.maintainAspectRatio=e}),F.qZA(),F._uU(2," Maintain Aspect Ratio\n"),F.qZA(),F.TgZ(3,"div",1),F.NdJ("drop",function(e){return t.onDropFile(e)})("dragover",function(e){return t.onDragOverFile(e)}),F.YNc(4,Ht,1,3,"image-cropper",2),F.TgZ(5,"form"),F.TgZ(6,"input",3),F.NdJ("change",function(e){return t.selectFile(e)}),F.qZA(),F.qZA(),F.qZA()),2&e&&(F.xp6(1),F.Q6J("ngModel",t.maintainAspectRatio)("checked",t.maintainAspectRatio),F.xp6(3),F.Q6J("ngIf",t.current.source))},directives:[u.Wl,u.JJ,u.On,l.O5,u._Y,u.JL,u.F,f.ap],styles:["[_nghost-%COMP%]   .drop-zone[_ngcontent-%COMP%]{padding:10px 20px;border:2px dotted var(--secondary)}"]}),e}();function Yt(e,t){if(1&e){var n=F.EpF();F.TgZ(0,"textarea",1),F.NdJ("ngModelChange",function(e){return F.CHM(n),F.oxw().currentLyrics.value.text=e}),F.qZA()}if(2&e){var i=F.oxw();F.Q6J("ngModel",i.currentLyrics.value.text)}}var jt=function(){var e=function(){function e(){s(this,e)}return a(e,[{key:"dialogInit",value:function(e,t){this.edit=t.data,this.edit&&(this.edit.result=this.edit.frames.map(function(e){return{id:e.id,value:Object.assign({},e.value)}}),0===this.edit.result.length&&this.edit.result.push({id:"USLT",value:{id:"",language:"",text:""}}),this.currentLyrics=this.edit.result[0])}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=F.Xpm({type:e,selectors:[["app-dialog-tag-lyrics"]],decls:1,vars:1,consts:[["autocomplete","off","autocorrect","off","autocapitalize","off","spellcheck","false",3,"ngModel","ngModelChange",4,"ngIf"],["autocomplete","off","autocorrect","off","autocapitalize","off","spellcheck","false",3,"ngModel","ngModelChange"]],template:function(e,t){1&e&&F.YNc(0,Yt,1,1,"textarea",0),2&e&&F.Q6J("ngIf",t.currentLyrics)},directives:[l.O5,u.Fj,u.JJ,u.On],styles:["[_nghost-%COMP%]   textarea[_ngcontent-%COMP%]{width:100%;height:100%}"]}),e}();function Vt(e,t){if(1&e&&(F.TgZ(0,"div",1),F._uU(1),F.qZA()),2&e){var n=t.$implicit;F.Q6J("title",n),F.xp6(1),F.Oqu(n)}}var Wt=function(){var e=function e(){s(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=F.Xpm({type:e,selectors:[["app-cell-editor-display"]],inputs:{lines:"lines"},decls:1,vars:1,consts:[[3,"title",4,"ngFor","ngForOf"],[3,"title"]],template:function(e,t){1&e&&F.YNc(0,Vt,2,2,"div",0),2&e&&F.Q6J("ngForOf",t.lines)},directives:[l.sg],styles:["[_nghost-%COMP%]   div[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;text-align:left;padding-left:6px;padding-right:6px}"],changeDetection:0}),e}(),Kt=["cellContainer"];function $t(e,t){if(1&e&&F._UZ(0,"app-cell-editor-display",2),2&e){var n=F.oxw();F.Q6J("lines",n.lines)}}function en(e,t){1&e&&F.GkF(0,null,3)}var tn=function(){var n=function(n){!function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&e(t,n)}(r,n);var i=t(r);function r(e,t){var n;return s(this,r),(n=i.call(this)).dialogOverlay=e,n.resolver=t,n.navigKeyDownRequest=new F.vpe,n.lines=[],n.inactive=!0,n.unsubscribe=new m.xQ,n}return a(r,[{key:"ngOnDestroy",value:function(){this.clearEdit(),this.unsubscribe.next(),this.unsubscribe.complete()}},{key:"clickEvent",value:function(e){this.edit()}},{key:"onCellEditorNavigationKeyDown",value:function(e){this.navigKeyDownRequest.emit(e)}},{key:"ngOnChanges",value:function(e){e.cell&&this.display()}},{key:"navigTo",value:function(){}},{key:"edit",value:function(){var e;switch(null===(e=this.cell)||void 0===e?void 0:e.column.def.impl){case O.Filename:case O.IdText:case O.LangDescText:case O.Text:"USLT"===this.cell.column.def.id?this.editLyrics():this.startEdit(zt);break;case O.Bool:this.editBool();break;case O.Pic:this.editPictures()}}},{key:"startEdit",value:function(e){var t=this;this.inactive&&(this.inactive=!1,setTimeout(function(){t.createComponent(e),t.componentRef&&(t.componentRef.instance.cell=t.cell,t.componentRef.instance.ngOnChanges&&t.componentRef.instance.ngOnChanges({cell:{current:t.cell}}),t.componentRef.instance.navigBlur&&t.componentRef.instance.navigBlur.pipe((0,v.R)(t.unsubscribe)).subscribe(function(){t.clearEdit(),t.inactive=!0}),t.componentRef.instance.navigChange&&t.componentRef.instance.navigChange.pipe((0,v.R)(t.unsubscribe)).subscribe(function(){t.setChanged()}))}))}},{key:"clearEdit",value:function(){this.componentRef&&this.componentRef.destroy(),this.container&&this.container.clear()}},{key:"createComponent",value:function(e){if(this.clearEdit(),this.container){var t=this.resolver.resolveComponentFactory(e);this.componentRef=this.container.createComponent(t)}}},{key:"editBool",value:function(){this.cell&&(0===this.cell.frames.length&&this.cell.frames.push({id:this.cell.column.def.id,value:{bool:!1}}),this.cell.frames[0].value.bool=!this.cell.frames[0].value.bool,this.setChanged())}},{key:"setChanged",value:function(){this.cell&&(this.cell.changed=!0,this.cell.parent.changed=!0,this.display())}},{key:"editPictures",value:function(){var e=this,t=this.cell;if(t){var n={frames:t.frames};this.dialogOverlay.open({title:"Tag Pictures",childComponent:Qt,data:n,onOkBtn:function(){return(0,C.mG)(e,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(t.frames=n.result||[],this.setChanged(),Promise.resolve()));case 1:case"end":return e.stop()}},e,this)}))},onCancelBtn:function(){return(0,C.mG)(e,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.resolve());case 1:case"end":return e.stop()}},e)}))}})}}},{key:"editLyrics",value:function(){var e=this,t=this.cell;if(t){var n={frames:t.frames};this.dialogOverlay.open({title:"Tag Lyrics",childComponent:jt,data:n,panelClass:"overlay-panel-large-buttons",onOkBtn:function(){return(0,C.mG)(e,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(t.frames=n.result?n.result.filter(function(e){return e.value.text.length>0}):[],this.setChanged(),Promise.resolve()));case 1:case"end":return e.stop()}},e,this)}))},onCancelBtn:function(){return(0,C.mG)(e,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.resolve());case 1:case"end":return e.stop()}},e)}))}})}}},{key:"display",value:function(){var e=this;this.lines=this.cell?this.cell.frames.map(function(t){return e.frameToString(t)}):[]}},{key:"frameToString",value:function(e){var t,n;switch(null===(t=this.cell)||void 0===t?void 0:t.column.def.impl){case O.Filename:case O.Text:return r.textFrameToString(e);case O.LangDescText:return r.langDescFrameToString(e);case O.IdText:return r.idTextFrameToString(e);case O.Pic:return r.picFrameToString(e);case O.TextList:return r.textListFrameToString(e);case O.IdBin:return r.idBinFrameToString(e);case O.GEOB:return r.geobFrameToString(e);case O.Bool:return r.boolFrameToString(e);case O.Popularimeter:return r.popularimeterFrameToString(e);case O.PlayCounter:return r.playCounterFrameToString(e);case O.MusicCDId:case O.EventTimingCodes:case O.SYLT:case O.ETCO:case O.PCST:case O.LINK:case O.AENC:case O.RVAD:case O.RGAD:case O.RVAD2:case O.CTOC:case O.CHAP:case O.Unknown:default:return"TODO CELLEDITOR: ".concat(null===(n=this.cell)||void 0===n?void 0:n.column.def.name)}}}],[{key:"picFrameToString",value:function(e){return R[e.value.pictureType]||"image"}},{key:"popularimeterFrameToString",value:function(e){return"".concat(e.value.rating," - ").concat(e.value.email," - ").concat(e.value.count)}},{key:"boolFrameToString",value:function(e){return"".concat(e.value.bool)}},{key:"textListFrameToString",value:function(e){return e.value.list.join("\n")}},{key:"textFrameToString",value:function(e){return e.value.text}},{key:"idTextFrameToString",value:function(e){return e.value.text}},{key:"playCounterFrameToString",value:function(e){return"".concat(e.value.num)}},{key:"geobFrameToString",value:function(e){return"Binary ".concat(e.value&&e.value.bin?e.value.bin.length:0," bytes")}},{key:"idBinFrameToString",value:function(e){return"Binary ".concat(e.value&&e.value.bin?e.value.bin.length:0," bytes")}},{key:"langDescFrameToString",value:function(e){return e.value.text}}]),r}(M);return n.\u0275fac=function(e){return new(e||n)(F.Y36(Nt.SL),F.Y36(F._Vd))},n.\u0275cmp=F.Xpm({type:n,selectors:[["app-cell-editor"]],viewQuery:function(e,t){var n;(1&e&&F.Gf(Kt,5,F.s_b),2&e)&&(F.iGM(n=F.CRH())&&(t.container=n.first))},hostBindings:function(e,t){1&e&&F.NdJ("click",function(e){return t.clickEvent(e)})},inputs:{cell:"cell"},outputs:{navigKeyDownRequest:"navigKeyDownRequest"},features:[F._Bn([{provide:M,useExisting:(0,F.Gpc)(function(){return n})}]),F.qOj,F.TTD],decls:2,vars:2,consts:[[3,"lines",4,"ngIf"],[4,"ngIf"],[3,"lines"],["cellContainer",""]],template:function(e,t){1&e&&(F.YNc(0,$t,1,1,"app-cell-editor-display",0),F.YNc(1,en,2,0,"ng-container",1)),2&e&&(F.Q6J("ngIf",t.inactive),F.xp6(1),F.Q6J("ngIf",!t.inactive))},directives:[l.O5,Wt],styles:[""]}),n}(),nn=["actionMenu"];function rn(e,t){1&e&&F._UZ(0,"app-loading")}function an(e,t){1&e&&(F._UZ(0,"i",3),F._uU(1," Choose Columns"))}function on(e,t){1&e&&(F._UZ(0,"i",4),F._uU(1," Set Fixed Audiobook Frames"))}function cn(e,t){1&e&&(F._UZ(0,"i",4),F._uU(1," Set Fixed Audio Series Frames"))}function sn(e,t){1&e&&(F._UZ(0,"i",4),F._uU(1," Set Fixed Soundtrack Frames"))}function ln(e,t){1&e&&(F._UZ(0,"i",4),F._uU(1," Set Fixed Bootleg Frames"))}function un(e,t){1&e&&(F._UZ(0,"i",4),F._uU(1," Search Missing Lyrics"))}function dn(e,t){if(1&e){var n=F.EpF();F.TgZ(0,"div",9),F._uU(1," This folder does not contain any tracks with tags."),F._UZ(2,"br"),F._uU(3,"Do you want to load all tracks from subfolders?"),F._UZ(4,"br"),F.TgZ(5,"button",10),F.NdJ("click",function(){return F.CHM(n),F.oxw(2).loadRecursive()}),F._UZ(6,"i",11),F._uU(7," Load recursive"),F.qZA(),F.qZA()}}function gn(e,t){if(1&e){var n=F.EpF();F.TgZ(0,"button",19),F.NdJ("click",function(){return F.CHM(n),F.oxw(3).save()}),F._UZ(1,"i",20),F.qZA()}}function hn(e,t){1&e&&(F.TgZ(0,"button",21),F._UZ(1,"i",22),F.qZA())}function fn(e,t){if(1&e){var n=F.EpF();F.TgZ(0,"div",12),F.TgZ(1,"button",13),F.NdJ("click",function(){return F.CHM(n),F.oxw(2).refresh()}),F._UZ(2,"i",11),F.qZA(),F.TgZ(3,"button",14),F.NdJ("click",function(){return F.CHM(n),F.oxw(2).brainz()}),F._UZ(4,"app-mb-icon",15),F.qZA(),F.YNc(5,gn,2,0,"button",16),F.YNc(6,hn,2,0,"button",17),F.TgZ(7,"button",18),F.NdJ("click",function(e){return F.CHM(n),F.oxw(2).onContextMenu(e)}),F._uU(8,"\u2026"),F.qZA(),F.qZA()}if(2&e){var i=F.oxw(2);F.xp6(4),F.Q6J("size",12),F.xp6(1),F.Q6J("ngIf",!i.isSaving),F.xp6(1),F.Q6J("ngIf",i.isSaving)}}function pn(e,t){1&e&&F._UZ(0,"app-loading")}function mn(e,t){if(1&e){var n=F.EpF();F.TgZ(0,"th",28),F.NdJ("click",function(){var e=F.CHM(n).$implicit;return F.oxw(3).activeCol=e}),F.TgZ(1,"div"),F.TgZ(2,"span",29),F._uU(3),F.qZA(),F.qZA(),F.qZA()}if(2&e){var i=t.$implicit;F.xp6(2),F.Q6J("title",i.def.id),F.xp6(1),F.Oqu(i.def.name)}}function vn(e,t){1&e&&F._UZ(0,"col"),2&e&&F.Udp("min-width",t.$implicit.def.width||60,"px")}function Cn(e,t){if(1&e){var n=F.EpF();F.TgZ(0,"i",34),F.NdJ("click",function(){F.CHM(n);var e=F.oxw(2).$implicit;return F.oxw(3).saveEdit(e)}),F.qZA()}}function Mn(e,t){1&e&&F._UZ(0,"i",35)}function kn(e,t){if(1&e&&(F.ynx(0),F.YNc(1,Cn,1,0,"i",32),F.YNc(2,Mn,1,0,"i",33),F.BQk()),2&e){var n=F.oxw().$implicit;F.xp6(1),F.Q6J("ngIf",!n.saving),F.xp6(1),F.Q6J("ngIf",n.saving)}}function Tn(e,t){if(1&e){var n=F.EpF();F.TgZ(0,"td"),F.TgZ(1,"app-cell-editor",36),F.NdJ("navigKeyDownRequest",function(e){return F.CHM(n),F.oxw(4).onCellEditorNavigationKeyDown(e)}),F.qZA(),F.qZA()}if(2&e){var i=t.$implicit;F.xp6(1),F.ekj("changed",i.changed),F.Q6J("cell",i)}}function xn(e,t){if(1&e&&(F.TgZ(0,"tr"),F.TgZ(1,"td",30),F.TgZ(2,"div",31),F.YNc(3,kn,3,2,"ng-container",0),F.qZA(),F.qZA(),F.YNc(4,Tn,2,3,"td",27),F.qZA()),2&e){var n=t.$implicit,i=F.oxw(3);F.xp6(3),F.Q6J("ngIf",n.changed),F.xp6(1),F.Q6J("ngForOf",n.cells)("ngForTrackBy",i.trackByCellFn)}}function bn(e,t){if(1&e&&(F.TgZ(0,"div",23),F.TgZ(1,"table"),F.TgZ(2,"thead"),F.TgZ(3,"tr",24),F._UZ(4,"th"),F.YNc(5,mn,4,2,"th",25),F.qZA(),F.qZA(),F.TgZ(6,"colgroup"),F._UZ(7,"col"),F.YNc(8,vn,1,2,"col",26),F.qZA(),F.TgZ(9,"tbody"),F.YNc(10,xn,5,3,"tr",27),F.qZA(),F.qZA(),F.qZA()),2&e){var n=F.oxw(2);F.xp6(5),F.Q6J("ngForOf",n.editor.columns)("ngForTrackBy",n.trackByColumnFn),F.xp6(2),F.Udp("min-width",60,"px"),F.xp6(1),F.Q6J("ngForOf",n.editor.columns)("ngForTrackBy",n.trackByColumnFn),F.xp6(2),F.Q6J("ngForOf",n.editor.edits)("ngForTrackBy",n.trackByEditFn)}}function On(e,t){if(1&e){var n=F.EpF();F.ynx(0),F.YNc(1,dn,8,0,"div",5),F.YNc(2,fn,9,3,"div",6),F.TgZ(3,"app-admin-tag-editor-column-tool",7),F.NdJ("requestClose",function(){return F.CHM(n),F.oxw().activeCol=void 0}),F.qZA(),F.YNc(4,pn,1,0,"app-loading",0),F.YNc(5,bn,11,8,"div",8),F.BQk()}if(2&e){var i=F.oxw();F.xp6(1),F.Q6J("ngIf",i.canLoadRecursive),F.xp6(1),F.Q6J("ngIf",i.tracks&&i.tracks.length>0&&i.editor.edits),F.xp6(1),F.Q6J("editor",i.editor)("activeCol",i.activeCol),F.xp6(1),F.Q6J("ngIf",!i.tracks),F.xp6(1),F.Q6J("ngIf",i.tracks&&i.tracks.length>0&&i.editor.edits)}}var yn,Pn,_n=function(){var e=function(){function e(t,n,i,r,a,o){s(this,e),this.app=t,this.folderService=n,this.contextMenuService=i,this.jam=r,this.notify=a,this.dialogOverlay=o,this.canLoadRecursive=!1,this.isSaving=!1,this.editor=new N(r)}return a(e,[{key:"onScroll",value:function(){}},{key:"canDeactivate",value:function(){return!this.isSaving}},{key:"ngOnChanges",value:function(e){this.refresh()}},{key:"refresh",value:function(){var e=this;this.folder=void 0,this.tracks=void 0,this.activeCol=void 0,this.id&&this.jam.folder.id({id:this.id,folderIncFolders:!0,folderIncTracks:!0,folderIncParents:!0,folderIncTag:!0,trackIncTag:!0,trackIncRawTag:!0,folderChildIncTag:!0}).then(function(t){e.display(t)}).catch(function(t){e.notify.error(t)})}},{key:"trackByEditFn",value:function(e,t){return t.track.id}},{key:"trackByColumnFn",value:function(e,t){return"".concat(t.def.id).concat(t.def.subid)}},{key:"trackByCellFn",value:function(e,t){return"".concat(t.column.def.id).concat(t.column.def.subid)}},{key:"loadRecursive",value:function(){var e=this;this.folder&&(this.canLoadRecursive=!1,this.tracks=void 0,this.jam.track.search({childOfID:this.folder.id,trackIncTag:!0,trackIncRawTag:!0,orderBy:T.zj.filename}).then(function(t){e.tracks=t.items,e.editor.build(e.tracks)}).catch(function(t){e.notify.error(t)}))}},{key:"onCellEditorNavigationKeyDown",value:function(e){if((0,k.o)(e.event)){var t=this.editor.edits.findIndex(function(t){return t===e.cell.parent}),n=this.editor.edits[t+((0,k.up)(e.event)?1:-1)];if(n){var i=n.cells[e.cell.parent.cells.indexOf(e.cell)];if(i){var r=this.cellEditors.find(function(e){return e.cell===i});r&&setTimeout(function(){r.navigTo()})}}}else if((0,k.ME)(e.event)){var a=e.cell.parent.cells[e.cell.parent.cells.indexOf(e.cell)+((0,k.V8)(e.event)?1:-1)];if(a){var o=this.cellEditors.find(function(e){return e.cell===a});o&&setTimeout(function(){o.navigTo()})}}}},{key:"save",value:function(){var e=this;if(!this.isSaving){var t=this.editor.edits.filter(function(e){return e.changed});if(0!==t.length){var n,i=[],r=o(t);try{for(r.s();!(n=r.n()).done;){var a=n.value;a.saving=!0,i.push(this.prepareEditSave(a))}}catch(s){r.e(s)}finally{r.f()}var c=i.shift();c&&(this.isSaving=!0,this.runSave(c,i).then(function(){e.isSaving=!1}).catch(function(n){e.isSaving=!1;var i,r=o(t);try{for(r.s();!(i=r.n()).done;){i.value.saving=!1}}catch(s){r.e(s)}finally{r.f()}e.notify.error(n)}))}}}},{key:"prepareEditSave",value:function(e){var t={edit:e,track:e.track},n=e.cells.filter(function(e){return e.changed}),i=n.find(function(e){return"internal_file"===e.column.def.id});if(i){n=n.filter(function(e){return"internal_file"!==e.column.def.id});var r=i.frames[0].value.text;r&&e.track.name!==r&&(t.filename=r)}return n.length>0&&(t.rawTag=S(e)),t}},{key:"saveEdit",value:function(e){var t=this;if(e.changed&&!this.isSaving){this.isSaving=!0;var n=this.prepareEditSave(e);this.runSave(n,[]).then(function(){t.isSaving=!1}).catch(function(e){t.isSaving=!1,t.notify.error(e)})}}},{key:"chooseColumns",value:function(){var e=this;this.isSaving&&this.notify.error(Error("Saving is in progress"));var t={columns:this.editor.columns,resultColumns:[]};this.dialogOverlay.open({title:"Choose Columns",childComponent:$,panelClass:"overlay-panel-large-buttons",data:t,onOkBtn:function(){return(0,C.mG)(e,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,this.tracks&&this.editor.updateColumns(this.tracks,t.resultColumns),e.next=7;break;case 4:return e.prev=4,e.t0=e.catch(0),e.abrupt("return",(this.notify.error(e.t0),Promise.reject(e.t0)));case 7:case"end":return e.stop()}},e,this,[[0,4]])}))},onCancelBtn:function(){return(0,C.mG)(e,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.resolve());case 1:case"end":return e.stop()}},e)}))}})}},{key:"brainz",value:function(){var e=this;if(this.folder&&this.tracks){this.canDeactivate()||this.notify.error(Error("Saving is in progress"));var t={folder:this.folder,matchings:this.tracks.map(function(e){return{track:e}}),apply:function(){var n,i=o(t.matchings);try{for(i.s();!(n=i.n()).done;){var r=n.value;r.track&&r.rawTag&&(r.track.tagRaw=r.rawTag)}}catch(l){i.e(l)}finally{i.f()}if(e.tracks){e.editor.build(e.tracks);var a,c=o(t.matchings);try{var s=function(){var t=a.value;if(t.track&&t.rawTag){var n=e.editor.edits.find(function(e){return e.track===t.track});if(n){n.changed=!0;var i,r=o(n.cells);try{for(r.s();!(i=r.n()).done;){var c=i.value;"internal_file"!==c.column.def.id&&(c.changed=!0)}}catch(l){r.e(l)}finally{r.f()}}}};for(c.s();!(a=c.n()).done;)s()}catch(l){c.e(l)}finally{c.f()}}}};this.dialogOverlay.open({title:"Release Matching",childComponent:Bt,data:t,panelClass:"overlay-panel-large"})}}},{key:"editAlbumValues",value:function(){var e=this;this.canDeactivate()||this.notify.error(Error("Saving is in progress")),this.tracks&&this.dialogOverlay.open({title:"Edit Album Values",childComponent:V,data:{tracks:this.tracks},onOkBtn:function(){return(0,C.mG)(e,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.resolve());case 1:case"end":return e.stop()}},e)}))},onCancelBtn:function(){return(0,C.mG)(e,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.resolve());case 1:case"end":return e.stop()}},e)}))}})}},{key:"onContextMenu",value:function(e){this.contextMenuService.show.next({contextMenu:this.actionMenu,event:e,item:void 0}),e.preventDefault(),e.stopPropagation()}},{key:"runSave",value:function(e,t){return(0,C.mG)(this,void 0,void 0,regeneratorRuntime.mark(function n(){var i,r,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,!e.filename){n.next=6;break}return n.next=4,this.jam.track.rename({id:e.track.id,name:e.filename});case 4:i=n.sent,this.folderService.waitForQueueResult("Renaming Track",i,[e.track.parentID],[],[e.track.id]);case 6:if(!e.rawTag){n.next=11;break}return n.next=9,this.jam.track.rawTagSet({id:e.track.id,tag:e.rawTag});case 9:r=n.sent,this.folderService.waitForQueueResult("Writing Track Tag",r,[e.track.parentID],[],[e.track.id]);case 11:e.edit.saving=!1,e.rawTag&&(e.edit.tag=e.rawTag),e.edit.changed=!1,n.next=17;break;case 14:return n.prev=14,n.t0=n.catch(0),n.abrupt("return",Promise.reject(n.t0));case 17:if(a=t.shift(),n.t1=a,!n.t1){n.next=22;break}return n.next=22,this.runSave(a,t);case 22:case"end":return n.stop()}},n,this,[[0,14]])}))}},{key:"display",value:function(e){this.folder=e,this.tracks=e.tracks||[],this.editor.build(this.tracks),this.canLoadRecursive=0===this.tracks.length&&(e.folders||[]).length>0,this.canLoadRecursive&&e.type===T.Sr.multialbum&&this.loadRecursive()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(F.Y36(pe.zi),F.Y36(pe.Cr),F.Y36(g.Lk),F.Y36(T.K4),F.Y36(pe.c),F.Y36(Nt.SL))},e.\u0275cmp=F.Xpm({type:e,selectors:[["app-admin-tag-editor"]],viewQuery:function(e,t){var n;(1&e&&(F.Gf(nn,5),F.Gf(M,5)),2&e)&&(F.iGM(n=F.CRH())&&(t.actionMenu=n.first),F.iGM(n=F.CRH())&&(t.cellEditors=n))},hostBindings:function(e,t){1&e&&F.NdJ("beforeunload",function(){return t.canDeactivate()},!1,F.Jf7)},inputs:{id:"id"},features:[F.TTD],decls:10,vars:2,consts:[[4,"ngIf"],["actionMenu",""],["contextMenuItem","",3,"execute"],[1,"icon-list-add"],[1,"icon-edit"],["class","load-recursive",4,"ngIf"],["class","actions",4,"ngIf"],[3,"editor","activeCol","requestClose"],["class","editor",4,"ngIf"],[1,"load-recursive"],["title","Load all Tracks",1,"button-on-control",3,"click"],[1,"icon-reload"],[1,"actions"],["title","Refresh",1,"button-on-control",3,"click"],["title","Match with MusicBrainz",1,"button-on-control",3,"click"],[3,"size"],["class","button-on-control","title","Save",3,"click",4,"ngIf"],["class","button-on-control","title","Save",4,"ngIf"],["title","More",1,"button-on-control",3,"click"],["title","Save",1,"button-on-control",3,"click"],[1,"icon-floppy"],["title","Save",1,"button-on-control"],[1,"icon-spin","icon-spnner"],[1,"editor"],[1,"header-row"],["class","header-row-title",3,"click",4,"ngFor","ngForOf","ngForTrackBy"],[3,"min-width",4,"ngFor","ngForOf","ngForTrackBy"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"header-row-title",3,"click"],[3,"title"],[1,"col-state"],[1,"cell-editor"],["class","icon-floppy",3,"click",4,"ngIf"],["class","icon-spin icon-spinner",4,"ngIf"],[1,"icon-floppy",3,"click"],[1,"icon-spin","icon-spinner"],[1,"cell-editor",3,"cell","navigKeyDownRequest"]],template:function(e,t){1&e&&(F.YNc(0,rn,1,0,"app-loading",0),F.TgZ(1,"context-menu",null,1),F.YNc(3,an,2,0,"ng-template",2),F.NdJ("execute",function(){return t.chooseColumns()}),F.YNc(4,on,2,0,"ng-template",2),F.NdJ("execute",function(){return t.editor.setAudiobookFrames()}),F.YNc(5,cn,2,0,"ng-template",2),F.NdJ("execute",function(){return t.editor.setAudioSeriesFrames()}),F.YNc(6,sn,2,0,"ng-template",2),F.NdJ("execute",function(){return t.editor.setSoundtrackFrames()}),F.YNc(7,ln,2,0,"ng-template",2),F.NdJ("execute",function(){return t.editor.setBootlegFrames()}),F.YNc(8,un,2,0,"ng-template",2),F.NdJ("execute",function(){return t.editor.findMissingLyrics()}),F.qZA(),F.YNc(9,On,6,6,"ng-container",0)),2&e&&(F.Q6J("ngIf",!t.folder),F.xp6(9),F.Q6J("ngIf",t.folder))},directives:[l.O5,g.GI,g.n5,Ft.N,Ut,Gt.J,l.sg,tn],styles:["[_nghost-%COMP%]{height:100%;width:100%;overflow:hidden;display:flex;flex-direction:column}[_nghost-%COMP%]   .actions[_ngcontent-%COMP%]{padding:10px 15px 0;border-bottom:1px solid var(--background-border)}[_nghost-%COMP%]   .actions[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{margin-right:5px;margin-bottom:10px}[_nghost-%COMP%]   .actions[_ngcontent-%COMP%] > label[_ngcontent-%COMP%]{text-transform:uppercase;letter-spacing:1px;font-size:11px;margin-left:5px;margin-right:5px}[_nghost-%COMP%]   .load-recursive[_ngcontent-%COMP%]{text-align:center;margin-top:30px;margin-left:30px;margin-right:30px}[_nghost-%COMP%]   .load-recursive[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-top:10px}[_nghost-%COMP%]   .editor[_ngcontent-%COMP%]{width:100%;height:100%;display:block;position:relative;overflow:auto}[_nghost-%COMP%]   .editor[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{table-layout:fixed;border-width:0;width:auto}[_nghost-%COMP%]   .editor[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .cell-editor[_ngcontent-%COMP%]{width:100%;height:34px;text-align:left;padding-bottom:1px;padding-top:1px;font-size:11px;color:var(--on-background);border-left:1px solid var(--background-border);border-bottom-color:var(--background-border);border-right-color:var(--background-border);border-top:1px solid var(--background-border);overflow:hidden;display:flex;align-items:center}[_nghost-%COMP%]   .editor[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .cell-editor.changed[_ngcontent-%COMP%]{padding-bottom:0;padding-top:0;border-left-width:1px;border-top-width:1px;border-left:2px solid var(--background-box);border-bottom:1px solid var(--background-box);border-right:1px solid var(--background-box);border-top:2px solid var(--background-box)}[_nghost-%COMP%]   .editor[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .cell-editor[_ngcontent-%COMP%]:focus-within{padding-bottom:0;padding-top:0;border-style:solid;border-width:2px 1px 1px 2px;color:var(--on-background-active)}[_nghost-%COMP%]   .editor[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{border-right:1px solid var(--background-border)}[_nghost-%COMP%]   .editor[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr.header-row[_ngcontent-%COMP%]{border-top:1px solid var(--background-border)}[_nghost-%COMP%]   .editor[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr.header-row[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;font-size:.8em;padding-left:4px;padding-right:4px;border-top:none;border-bottom:none;color:var(--on-background-active);background-color:var(--background);position:sticky}[_nghost-%COMP%]   .editor[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr.header-row[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{padding:0;visibility:hidden}[_nghost-%COMP%]   .editor[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr.header-row[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:hover   .actions[_ngcontent-%COMP%]{visibility:inherit}[_nghost-%COMP%]   .editor[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th.header-row-title[_ngcontent-%COMP%]{cursor:pointer;-webkit-user-select:none;-moz-user-select:none;user-select:none}[_nghost-%COMP%]   .editor[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border:none;max-width:200px}[_nghost-%COMP%]   .editor[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td.col-state[_ngcontent-%COMP%]{text-align:center}[_nghost-%COMP%]   .editor[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td.col-state[_ngcontent-%COMP%]   .cell-editor[_ngcontent-%COMP%]{padding-top:6px;font-size:18px}[_nghost-%COMP%]   .editor[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:last-of-type   .cell-editor[_ngcontent-%COMP%]{border-bottom:1px solid var(--background-border)}"]}),e}(),wn=p.Bz.forChild([{path:"",component:(yn=function(){function e(t){s(this,e),this.route=t,this.unsubscribe=new m.xQ}return a(e,[{key:"ngOnInit",value:function(){var e,t,n=this;(null===(t=null===(e=this.route.parent)||void 0===e?void 0:e.parent)||void 0===t?void 0:t.params)&&this.route.parent.parent.params.pipe((0,v.R)(this.unsubscribe)).subscribe(function(e){n.id=e.id})}},{key:"ngOnDestroy",value:function(){this.unsubscribe.next(),this.unsubscribe.complete()}},{key:"canDeactivate",value:function(){return!(!this.child||!this.child.canDeactivate())}}]),e}(),yn.\u0275fac=function(e){return new(e||yn)(F.Y36(p.gz))},yn.\u0275cmp=F.Xpm({type:yn,selectors:[["app-admin-folder-tag-editor"]],viewQuery:function(e,t){var n;1&e&&F.Gf(_n,7),2&e&&F.iGM(n=F.CRH())&&(t.child=n.first)},decls:1,vars:1,consts:[[3,"id"]],template:function(e,t){1&e&&F._UZ(0,"app-admin-tag-editor",0),2&e&&F.Q6J("id",t.id)},directives:[_n],styles:["[_nghost-%COMP%]{height:100%;width:100%;overflow:hidden;display:block}"]}),yn)}]),An=((Pn=function e(){s(this,e)}).\u0275fac=function(e){return new(e||Pn)},Pn.\u0275mod=F.oAB({type:Pn}),Pn.\u0275inj=F.cJS({providers:[],imports:[[l.ez,h.m,u.u5,f.QG,g.vI,c.Cl,d.In,wn]]}),Pn)}}])}();