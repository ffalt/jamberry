import{a as F}from"./chunk-BAOGHNZ3.js";import{a as h}from"./chunk-RQOW2HPH.js";import{c as X}from"./chunk-4RUMNACR.js";import{a as N,b as w}from"./chunk-IGI7JTSR.js";import{a as z}from"./chunk-HURYLTUC.js";import{d as m}from"./chunk-LV2G3RH6.js";import"./chunk-5NZQP5GA.js";import{G as O}from"./chunk-ZMFSGBQT.js";import"./chunk-B4HPT77T.js";import{Cb as S,Db as p,Ib as P,Jb as _,Kb as o,Lb as s,Pb as A,Qb as M,Td as E,U as x,Wd as f,Xb as a,Xd as T,Yd as B,Za as r,_b as R,a as G,ac as v,b as $,fa as c,j as I,mb as C,oc as L,pc as k}from"./chunk-S3YUDFSI.js";function J(n,g){n&1&&s(0,"i",7)}function H(n,g){n&1&&(_(0,"span"),a(1,2),o())}var D=(()=>{class n{constructor(){this.auth=c(f),this.app=c(X),this.refreshing=!1,this.unsubscribe=new I,this.jam=c(T),this.notify=c(O),this.refreshRandom=h()}ngOnDestroy(){this.unsubscribe.next(),this.unsubscribe.complete()}onDropFile(e){e.preventDefault(),this.uploadFile(e.dataTransfer?.files)}onDragOverFile(e){e.stopPropagation(),e.preventDefault()}selectFile(e){let t=e.target.files;this.uploadFile(t)}uploadFile(e){if(!e||e.length===0||!this.auth.user)return;let i=e[0];this.jam.user.uploadUserImage({id:this.auth.user.id},i).pipe(x(this.unsubscribe)).subscribe({next:()=>{},error:t=>{this.notify.error(t)},complete:()=>{this.refreshRandom=h(),this.notify.success("Upload done")}})}randomAvatar(){this.refreshing||!this.auth.user||(this.refreshing=!0,this.jam.user.generateUserImage({id:this.auth.user.id}).then(()=>{this.refreshing=!1,this.refreshRandom=h(),this.notify.success("Image randomized")}).catch(e=>{this.refreshing=!1,this.notify.error(e)}))}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=C({type:n,selectors:[["app-user-avatar"]],decls:11,vars:5,consts:()=>{let e;e=$localize`:␟d833321cc90a0b0a52714c6d5ec97fbe6c7cfa5c␟2501989539336327542:Upload image`;let i;i=$localize`:␟b2e9fc8efba33bcc232b6d16acf15ed22e9b066f␟3096061700616912177: Drag an Image File here `;let t;t=$localize`:␟3a2a9bb12d904f3dd84e42cfad37afef4a6b35f6␟3825771792569625715:Choose a file`;let l;return l=$localize`:␟c1ba8ac278d9bdb189e23866675d475089dce2ae␟4360279154190126867:Random Image`,[i,t,l,[1,"drop-zone",3,"dragover","drop"],[1,"placeholder"],[3,"coverArtObj","refreshRandom","round","size"],[1,"button-primary",3,"click"],[1,"icon-spin","icon-spinner"],["accept",".png,.jpeg,.jpg","id","file","placeholder",e,"type","file",1,"inputfile",3,"change"],["for","file",1,"button-primary"]]},template:function(i,t){i&1&&(_(0,"div",3),R("dragover",function(d){return t.onDragOverFile(d)})("drop",function(d){return t.onDropFile(d)}),_(1,"div",4),a(2,0),o(),s(3,"app-coverart-image",5),_(4,"button",6),R("click",function(){return t.randomAvatar()}),S(5,J,1,0,"i",7)(6,H,2,0,"span"),o(),_(7,"form")(8,"input",8),R("change",function(d){return t.selectFile(d)}),o(),_(9,"label",9),a(10,1),o()()()),i&2&&(r(3),P("coverArtObj",t.auth.user)("refreshRandom",t.refreshRandom)("round",!0)("size",100),r(2),p(t.refreshing?5:6))},dependencies:[z],styles:["[_nghost-%COMP%]   .drop-zone[_ngcontent-%COMP%]{vertical-align:bottom;display:inline-block;min-width:220px;min-height:140px;border-width:2px;margin-bottom:15px;margin-right:15px;border-style:dotted;border-color:var(--secondary);padding-left:15px;padding-right:15px;padding-bottom:15px;text-align:center}[_nghost-%COMP%]   .drop-zone[_ngcontent-%COMP%]   app-coverart-image[_ngcontent-%COMP%]{margin:0 auto 10px}[_nghost-%COMP%]   .drop-zone[_ngcontent-%COMP%]   .inputfile[_ngcontent-%COMP%]{width:.1px;height:.1px;opacity:0;overflow:hidden;position:absolute;z-index:-1}[_nghost-%COMP%]   .drop-zone[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-bottom:10px;min-width:80%;display:inline-block}[_nghost-%COMP%]   .drop-zone[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{display:inline-block;min-width:80%}[_nghost-%COMP%]   .drop-zone[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{width:100%;display:block}[_nghost-%COMP%]   .drop-zone[_ngcontent-%COMP%]   .placeholder[_ngcontent-%COMP%]{width:100%;padding-top:15px;padding-bottom:15px;text-align:center;color:var(--on-control-ambient);font-size:.8em;text-transform:uppercase}"]})}}return n})();var j=(()=>{class n{constructor(){this.base=[],this.favorites=[],this.played=[],this.jam=c(T),this.auth=c(f),this.notify=c(O)}ngOnInit(){this.auth.isLoggedIn()&&this.refresh()}refresh(){this.jam.stats.user().then(e=>{this.favorites=n.buildStats(e.favorite,"/favorites"),this.played=n.buildStats(e.played,"/recently-played"),this.base=N([{text:"Bookmarks",link:"/library/bookmarks",value:e.bookmark},{text:"Playlists",link:"/library/playlists",value:e.playlist}],!0)}).catch(e=>{this.notify.error(e)})}static buildStats(e,i=""){return N([{text:"Artists",link:"artists",value:e.artistTypes.album},...[{type:m(E.album),value:e.albumTypes.album},{type:m(E.compilation),value:e.albumTypes.compilation}].map(t=>({text:t.type?.text,link:`${t.type?.id}`,value:t.value})),{text:"Series",link:"series",value:e.series},...[{type:m(E.audiobook),value:e.albumTypes.audiobook},{type:m(E.soundtrack),value:e.albumTypes.soundtrack},{type:m(E.live),value:e.albumTypes.live},{type:m(E.bootleg),value:e.albumTypes.bootleg},{type:m(E.ep),value:e.albumTypes.ep},{type:m(E.single),value:e.albumTypes.single}].map(t=>({text:t.type?.text,link:t.type?.id,value:t.value})),{text:"Folders",link:"folders",value:e.folder},{text:"Tracks",link:"tracks",value:e.track}].map(t=>$(G({},t),{link:`/library/${t.link}${i}`})))}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=C({type:n,selectors:[["app-user-stats"]],decls:9,vars:3,consts:()=>{let e;e=$localize`:␟299f97b8ee9c62d45f2cc01961aa1e5101d6d05a␟4088311569349098646:Stats`;let i;i=$localize`:␟0add707baf7b167d0c0e9cdeb80f946aa1bd2223␟4085930761302974863:Favorites`;let t;return t=$localize`:␟73565b2d231303b7ff6f28663a72abb1b3bd1890␟7754730602038897709:Played`,[e,i,t,[1,"section-title"],[3,"stats"]]},template:function(i,t){i&1&&(_(0,"div",3),a(1,0),o(),s(2,"app-stats",4),_(3,"div",3),a(4,1),o(),s(5,"app-stats",4),_(6,"div",3),a(7,2),o(),s(8,"app-stats",4)),i&2&&(r(2),P("stats",t.base),r(3),P("stats",t.favorites),r(3),P("stats",t.played))},dependencies:[B,w],styles:["[_nghost-%COMP%]   .section-title[_ngcontent-%COMP%]{text-transform:uppercase;letter-spacing:1.25px;font-size:13.2px;margin-top:15px;margin-bottom:10px;color:var(--on-control-ambient)}"]})}}return n})();function q(n,g){n&1&&(_(0,"div"),s(1,"i",16),A(2),a(3,3),M(),o())}function K(n,g){n&1&&(_(0,"div"),s(1,"i",16),A(2),a(3,4),M(),o())}function Q(n,g){n&1&&(_(0,"div"),s(1,"i",16),A(2),a(3,5),M(),o())}function W(n,g){n&1&&(_(0,"div"),s(1,"i",16),A(2),a(3,6),M(),o())}function Y(n,g){if(n&1&&(_(0,"div",14)(1,"div",12),a(2,2),o(),_(3,"div",15),S(4,q,4,0,"div"),S(5,K,4,0,"div"),S(6,Q,4,0,"div"),S(7,W,4,0,"div"),o()()),n&2){let e=v(2);r(4),p(e.auth.user.roles.stream?4:-1),r(),p(e.auth.user.roles.podcast?5:-1),r(),p(e.auth.user.roles.upload?6:-1),r(),p(e.auth.user.roles.admin?7:-1)}}function Z(n,g){if(n&1&&(_(0,"div",9)(1,"div",10)(2,"div",11)(3,"div",12),a(4,0),o(),s(5,"app-user-avatar"),o(),_(6,"div",13)(7,"div",14)(8,"div",12),a(9,1),o(),_(10,"div"),L(11),o()(),S(12,Y,8,4,"div",14),o()(),_(13,"div",14),s(14,"app-user-stats"),o()()),n&2){let e=v();r(11),k(e.auth.user.name),r(),p(e.auth.user.roles?12:-1)}}var Re=(()=>{class n{constructor(){this.auth=c(f)}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=C({type:n,selectors:[["app-user-page"]],decls:3,vars:1,consts:()=>{let e;e=$localize`:␟e08a77594f3d89311cdf6da5090044270909c194␟2392488717875840729:User`;let i;i=$localize`:␟cebb7f27b5028c62b4426da3bb3e3bd3f4a3443b␟6525109356951792180:Avatar`;let t;t=$localize`:␟cff1428d10d59d14e45edec3c735a27b5482db59␟8953033926734869941:Name`;let l;l=$localize`:␟70f45880fce6ac5d8e468e25e82aefbba8098cfe␟7314814725704332646:Permissions`;let d;d=$localize`:␟0c1153af20b06ee1f31e7d07eebfada81b9a19b2␟7231504695490320052:Stream Audio`;let U;U=$localize`:␟f47ba1cd01c3dfd801fe7f66c3d28d698dcc0479␟1291164613191345064:Manage Podcasts`;let b;b=$localize`:␟7876f698ec2db992452b14bd66e0ed1261d890e8␟5793950743388475134:Upload Audio`;let y;return y=$localize`:␟76046fa6f13fb0524ca1d3777247ab13d73660c8␟2210415377969858551:Server Administration`,[i,t,l,d,U,b,y,[1,"user"],["section",e],[1,"content"],[1,"row"],[1,"column","first"],[1,"section-title"],[1,"column"],[1,"section"],[1,"roles"],[1,"icon-checkmark"]]},template:function(i,t){i&1&&(_(0,"div",7),s(1,"app-view-header-slim",8),S(2,Z,15,2,"div",9),o()),i&2&&(r(2),p(t.auth.user?2:-1))},dependencies:[D,j,F],styles:["[_nghost-%COMP%]   .user[_ngcontent-%COMP%]{height:100%;overflow-y:auto;overflow-x:hidden}[_nghost-%COMP%]   .user[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{padding:0 5px 5px}[_nghost-%COMP%]   .user[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{text-transform:uppercase;letter-spacing:1.25px;font-size:13.2px;margin-bottom:10px;color:var(--on-control-ambient)}@media(max-width:522px){[_nghost-%COMP%]   .user[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{padding-left:10px;padding-right:10px}}[_nghost-%COMP%]   .user[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{padding:15px 15px 60px}[_nghost-%COMP%]   .user[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]{padding-bottom:30px}[_nghost-%COMP%]   .user[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:5px}@media(max-width:400px){[_nghost-%COMP%]   .user[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{flex-direction:column}}"]})}}return n})();export{Re as UserPageComponent};
