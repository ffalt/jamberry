import{c as V}from"./chunk-7O7M2ADH.js";import{a as D}from"./chunk-EQ4NQAOR.js";import{c as y,d as b,e as G,f as A,g as R,h as $,o as B}from"./chunk-SCY3FOMN.js";import{F as W,G as F}from"./chunk-3LOKQP2Q.js";import{f as X,h as U}from"./chunk-MFAW4R34.js";import{$b as E,Db as h,Eb as u,Kb as i,Lb as l,Mb as p,Qb as c,Rb as d,Vd as z,Wb as I,Yb as C,_a as g,bc as M,fa as s,ka as L,la as w,nb as v,pc as f,qc as x,rc as T,uc as m,vc as O,wc as P}from"./chunk-XLNNDSL4.js";function j(r,k){if(r&1){let n=I();i(0,"label"),c(1),C(2,3),d(),i(3,"input",11),P("ngModelChange",function(e){L(n);let a=M();return O(a.credentials.server,e)||(a.credentials.server=e),w(e)}),l()()}if(r&2){let n=M();g(3),m("ngModel",n.credentials.server)}}function q(r,k){if(r&1&&(i(0,"div",10),f(1),l()),r&2){let n=M();g(),x(n.error)}}var re=(()=>{class r{constructor(){this.app=s(V),this.credentials={server:"",username:"",password:""},this.showServer=!1,this.route=s(X),this.router=s(U),this.auth=s(z),this.notify=s(F),this.init()}init(){let n=this.getFixed();this.credentials.server=n.server??"",this.credentials.username=n.user??"",this.credentials.password=n.pass??"",this.showServer=this.credentials.server==="",this.auth.clear().catch(t=>{console.error(t)})}getFixed(){return document.jamberry_config?.fixed??{}}ngOnInit(){this.returnUrl=decodeURIComponent(this.returnUrlFromRoute()??"/library")}returnUrlFromRoute(){return this.route.snapshot.queryParams.returnUrl}login(n){n.preventDefault(),this.auth.login(this.credentials.server,this.credentials.username,this.credentials.password).then(()=>{this.router.navigateByUrl(this.returnUrl??"/library").catch(t=>{console.error(t)})}).catch(t=>{this.notify.error(t),this.error=W(t)})}static{this.\u0275fac=function(t){return new(t||r)}}static{this.\u0275cmp=v({type:r,selectors:[["app-login"]],decls:21,vars:5,consts:()=>{let n;n=$localize`:␟08c74dc9762957593b91f6eb5d65efdfc975bf48␟5248717555542428023:Username`;let t;t=$localize`:␟c32ef07f8803a223a83ed17024b38e8d82292407␟1431416938026210429:Password`;let e;e=$localize`:␟6765b4c916060f6bc42d9bb69e80377dbcb5e4e9␟2454050363478003966:Login`;let a;a=$localize`:␟e08a77594f3d89311cdf6da5090044270909c194␟2392488717875840729:User`;let o;o=$localize`:␟c32ef07f8803a223a83ed17024b38e8d82292407␟1431416938026210429:Password`;let N;N=$localize`:␟905882c0fe09eee755ee6730ecf10e3b85cb6d9c␟2188854519574316630:Server`;let S;return S=$localize`:␟905882c0fe09eee755ee6730ecf10e3b85cb6d9c␟2188854519574316630:Server`,[e,a,o,S,[1,"view-login"],[1,"container-login",3,"submit"],[1,"login-card"],["autocomplete","username","name","user","placeholder",n,"type","text",3,"ngModelChange","ngModel"],["autocomplete","password","name","pass","placeholder",t,"type","password",3,"ngModelChange","ngModel"],["name","login","type","submit","value","login",1,"login-submit"],[1,"error"],["type","text","name","server","placeholder",N,3,"ngModelChange","ngModel"]]},template:function(t,e){t&1&&(i(0,"div",4)(1,"div",5),E("submit",function(o){return e.login(o)}),i(2,"div",6)(3,"h1"),p(4,"app-logo-icon"),f(5),c(6),C(7,0),d(),l(),p(8,"br"),i(9,"form"),h(10,j,4,1,"label"),i(11,"label"),c(12),C(13,1),d(),i(14,"input",7),P("ngModelChange",function(o){return O(e.credentials.username,o)||(e.credentials.username=o),o}),l()(),i(15,"label"),c(16),C(17,2),d(),i(18,"input",8),P("ngModelChange",function(o){return O(e.credentials.password,o)||(e.credentials.password=o),o}),l()(),p(19,"input",9),l()(),h(20,q,2,1,"div",10),l()()),t&2&&(g(5),T("\xA0",e.app.name," "),g(5),u(e.showServer?10:-1),g(4),m("ngModel",e.credentials.username),g(4),m("ngModel",e.credentials.password),g(2),u(e.error?20:-1))},dependencies:[B,$,y,b,G,R,A,D],styles:["[_nghost-%COMP%]   .view-login[_ngcontent-%COMP%]{position:fixed;height:100%;width:100%;overflow-y:auto}[_nghost-%COMP%]   .view-login[_ngcontent-%COMP%]   .container-login[_ngcontent-%COMP%]{max-width:400px;width:80%;z-index:15;margin-left:auto;margin-right:auto;margin-top:100px}[_nghost-%COMP%]   .view-login[_ngcontent-%COMP%]   .error[_ngcontent-%COMP%]{text-align:center;color:var(--accent)}[_nghost-%COMP%]   .view-login[_ngcontent-%COMP%]   .login-card[_ngcontent-%COMP%]{overflow:hidden;padding:30px;min-width:274px;max-width:400px;margin:0 auto 10px;border-radius:2px;border-style:solid;border-width:1px}[_nghost-%COMP%]   .view-login[_ngcontent-%COMP%]   .login-card[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-weight:100;text-align:center;font-size:2.3em}[_nghost-%COMP%]   .view-login[_ngcontent-%COMP%]   .login-card[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]   app-logo-icon[_ngcontent-%COMP%]{height:42px;width:42px;vertical-align:baseline}[_nghost-%COMP%]   .view-login[_ngcontent-%COMP%]   .login-card[_ngcontent-%COMP%]   input[type=submit][_ngcontent-%COMP%]{width:100%;display:block;margin-bottom:10px;position:relative}[_nghost-%COMP%]   .view-login[_ngcontent-%COMP%]   .login-card[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%], [_nghost-%COMP%]   .view-login[_ngcontent-%COMP%]   .login-card[_ngcontent-%COMP%]   input[type=password][_ngcontent-%COMP%]{height:44px;font-size:16px;width:100%;margin-top:4px;margin-bottom:10px;padding:0 8px;box-sizing:border-box}[_nghost-%COMP%]   .view-login[_ngcontent-%COMP%]   .login-card[_ngcontent-%COMP%]   .login-submit[_ngcontent-%COMP%]{text-align:center;font-size:14px;font-weight:700;height:36px;padding:0 8px;border:0;cursor:pointer;background-color:var(--primary);color:var(--on-primary)}[_nghost-%COMP%]   .view-login[_ngcontent-%COMP%]   .login-card[_ngcontent-%COMP%]   .login-submit[_ngcontent-%COMP%]:hover{border:0}[_nghost-%COMP%]   .view-login[_ngcontent-%COMP%]   .login-card[_ngcontent-%COMP%]   .login-help[_ngcontent-%COMP%]{width:100%;text-align:center;font-size:12px}[_nghost-%COMP%]   .view-login[_ngcontent-%COMP%]   .login-card[_ngcontent-%COMP%]   .login-help[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none;font-weight:400;text-align:center;display:inline-block;opacity:.6;transition:opacity ease .5s}[_nghost-%COMP%]   .view-login[_ngcontent-%COMP%]   .login-card[_ngcontent-%COMP%]   .login-help[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:1}@media(max-width:522px){[_nghost-%COMP%]   .view-login[_ngcontent-%COMP%]{margin-top:-20px}[_nghost-%COMP%]   .view-login[_ngcontent-%COMP%]   .container-login[_ngcontent-%COMP%]{margin-top:0}[_nghost-%COMP%]   .view-login[_ngcontent-%COMP%]   .container-login[_ngcontent-%COMP%]   .login-card[_ngcontent-%COMP%]{min-width:inherit}[_nghost-%COMP%]   .view-login[_ngcontent-%COMP%]   .container-login[_ngcontent-%COMP%]   .login-card[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin-top:0;margin-bottom:0;font-size:1.5em}}"]})}}return r})();export{re as LoginComponent};
