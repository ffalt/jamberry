import{a as Ke,b as Di,c as Se,d as Li,f as wi,g as ki,h as Gi,i as Bi}from"./chunk-UTJWMV3P.js";import{a as lt,b as ct,c as dt,d as _t,f as ut,g as Ii}from"./chunk-AXFH7JSP.js";import{$ as v,$a as Fe,$b as mi,$c as Ee,Aa as Jt,Ba as Yt,C as $t,Ca as f,Cc as Ue,Cd as Oi,Ce as Ni,Da as u,Dc as He,De as qe,E as Ft,Ec as ze,Fc as gi,Fd as Ei,Gc as Ci,Ha as Y,I as m,Ia as Q,J as p,Ja as Z,K as Xt,Ka as Qt,Kc as W,La as at,Lc as Ve,Ma as oe,Mc as rt,Md as Si,Me as yi,Na as Zt,Nc as st,O as q,Oa as O,Ob as ee,Od as Pi,Pa as B,Pb as _e,Pd as Ai,Qa as X,Qb as z,Ra as ei,Rb as ue,Rd as Ri,Sa as ti,Sb as me,Sc as hi,T as Ge,Ta as w,Tb as V,U as Ut,Ua as k,Ub as pe,Ud as We,V as _,Va as G,X as Ht,Xa as Be,Xb as di,Xc as ge,Ya as ii,Yb as _i,Yd as vi,Z as L,Za as ni,Zb as ui,_ as zt,_a as $e,a as ve,aa as Vt,ab as oi,bb as ai,bd as fi,cb as ae,da as Wt,db as de,ea as K,f as R,fa as j,fb as ri,fd as Ce,i as Oe,ja as jt,jd as Ti,ka as g,kb as si,la as C,ma as qt,me as bi,na as J,oa as y,ob as li,od as Mi,pa as I,qa as E,ra as d,sa as l,ta as M,tb as Xe,ua as $,va as F,vb as ci,wa as Kt,xa as P,xe as xi,yc as pi,ye as je,z as he,za as h}from"./chunk-RPULQAHC.js";var on=()=>({allowEmpty:!0});function an(o,t){if(o&1&&(d(0,"app-autocomplete-option-header"),O(1),l()),o&2){let e=u().$implicit;_(),B(e.header)}}function rn(o,t){if(o&1&&(g(0,an,2,1,"app-autocomplete-option-header"),d(1,"app-autocomplete-option",4),O(2),l()),o&2){let e=t.$implicit,n=u().control;C(e.header?0:-1),_(),E("option",e)("control",n),_(),B(e.data.text)}}function sn(o,t){if(o&1&&y(0,rn,3,4,null,null,J),o&2){let e=t.control;I(e.options)}}var fe=(()=>{class o{list=[];focused=!1;edit="";standalone=!1;field="text";value="";data;getList;onAutoComplete;valueChange=new j;ngOnChanges(e){e.value&&e.value.currentValue&&e.value.currentValue!==this.edit&&(this.edit=e.value.currentValue)}autocompleteGetData(e){return R(this,null,function*(){return e.length===0?this.list.map(n=>({data:n})):this.list.filter(n=>n.text.includes(e)).map(n=>({data:n}))})}autocompleteSelectResult(e){return this.edit=e.data.text,this.edit}autocompleteEnter(e){this.edit=e}onValueChange(){this.value!==this.edit&&this.valueChange.emit(this.edit)}onFocus(){this.focused=!0,this.edit===void 0&&(this.edit=""),this.getList&&(this.list=this.getList(this.data).map(e=>({text:e})))}onBlur(){this.focused=!1,this.list=[]}static \u0275fac=function(n){return new(n||o)};static \u0275cmp=v({type:o,selectors:[["app-tag-editor-autocomplete"]],inputs:{standalone:"standalone",field:"field",value:"value",data:"data",getList:"getList",onAutoComplete:"onAutoComplete"},outputs:{valueChange:"valueChange"},standalone:!1,features:[q],decls:5,vars:10,consts:[["autocomplete","appAutocomplete"],["appAutocompleteContent",""],[1,"input-group"],["type","text","name","auto","autocomplete","off",3,"ngModelChange","change","focus","blur","value","appAutocomplete","appAutocompleteControl","appAutocompleteSettings","ngModel"],[3,"option","control"]],template:function(n,i){if(n&1){let a=P();d(0,"app-autocomplete",null,0),K(2,sn,2,0,"ng-template",1),l(),d(3,"div",2)(4,"input",3),G("ngModelChange",function(c){return m(a),k(i.edit,c)||(i.edit=c),p(c)}),f("change",function(){return m(a),p(i.onValueChange())})("focus",function(){return m(a),p(i.onFocus())})("blur",function(){return m(a),p(i.onBlur())}),l()()}if(n&2){let a=Qt(1);_(3),oe("focused",i.focused)("cell",!i.standalone),_(),E("value",i.edit)("appAutocomplete",a)("appAutocompleteControl",i)("appAutocompleteSettings",Fe(9,on)),w("ngModel",i.edit)}},dependencies:[_e,z,V,ct,dt,lt,ut,_t],styles:["[_nghost-%COMP%]{width:100%}[_nghost-%COMP%]   .input-group[_ngcontent-%COMP%]{height:100%;width:100%}[_nghost-%COMP%]   .input-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{height:100%;width:100%;background-color:var(--input);color:var(--on-input);border-radius:3px;padding-left:3px;padding-right:3px}[_nghost-%COMP%]   .input-group.cell[_ngcontent-%COMP%]{display:block;border:none}[_nghost-%COMP%]   .input-group.cell[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding-left:0;padding-right:0;border-radius:0;border:none;color:inherit;background-color:inherit}"],changeDetection:0})}return o})();function ln(o,t){if(o&1&&(d(0,"div",0),O(1),l()),o&2){let e=t.$implicit;E("title",e),_(),B(e)}}var pt=(()=>{class o{lines;static \u0275fac=function(n){return new(n||o)};static \u0275cmp=v({type:o,selectors:[["app-cell-editor-display"]],inputs:{lines:"lines"},standalone:!1,decls:2,vars:0,consts:[[3,"title"]],template:function(n,i){n&1&&y(0,ln,2,2,"div",0,qt),n&2&&I(i.lines)},styles:["[_nghost-%COMP%]   div[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;text-align:left;padding-left:6px;padding-right:6px}"],changeDetection:0})}return o})();var dn=["inputEl"],gt=(()=>{class o{original="";val="";cell;navigKeyDownRequest=new j;navigBlur=new j;navigChange=new j;input;ngOnChanges(){this.changeCell(this.cell)}onNavigKeyDown(e){this.cell&&this.navigKeyDownRequest.emit({cell:this.cell,event:e})}changeCell(e){e&&(this.original=e.frames.length===0||!e.frames[0].value||!e.frames[0].value.text?"":this.original=e.frames[0].value.text,this.val=this.original)}ngAfterViewInit(){setTimeout(()=>{this.input?.nativeElement&&this.input.nativeElement.focus()},0)}onEnter(){this.onChange(),this.navigBlur.emit()}onChange(){this.cell&&this.val!==this.original&&(this.cell.frames.length===0&&this.cell.frames.push({id:this.cell.column.def.id,value:{id:this.cell.column.def.subid,text:this.val}}),this.cell.frames[0].value.text=this.val,this.navigChange.emit())}onBlur(){this.onChange(),this.navigBlur.emit()}autocompleteEnter(e){this.val=e}autocompleteGetData(e){return R(this,null,function*(){return[]})}autocompleteSelectResult(e){return this.val=e.data,this.val}static \u0275fac=function(n){return new(n||o)};static \u0275cmp=v({type:o,selectors:[["app-cell-editor-txt"]],viewQuery:function(n,i){if(n&1&&Y(dn,7),n&2){let a;Q(a=Z())&&(i.input=a.first)}},inputs:{cell:"cell"},outputs:{navigKeyDownRequest:"navigKeyDownRequest",navigBlur:"navigBlur",navigChange:"navigChange"},standalone:!1,features:[q],decls:2,vars:1,consts:[["inputEl",""],["type","text","autocomplete","off",3,"ngModelChange","blur","keydown.enter","ngModel"]],template:function(n,i){if(n&1){let a=P();d(0,"input",1,0),G("ngModelChange",function(c){return m(a),k(i.val,c)||(i.val=c),p(c)}),f("blur",function(){return m(a),p(i.onBlur())})("keydown.enter",function(){return m(a),p(i.onEnter())}),l()}n&2&&w("ngModel",i.val)},dependencies:[_e,z,V],styles:["[_nghost-%COMP%]{width:100%;height:100%}[_nghost-%COMP%]   input[_ngcontent-%COMP%]{width:100%;height:100%;text-align:left}"]})}return o})();var Te=class{cell};var s=function(o){return o[o.Filename=1]="Filename",o[o.IdText=2]="IdText",o[o.IdBin=3]="IdBin",o[o.Text=4]="Text",o[o.TextList=5]="TextList",o[o.LangDescText=6]="LangDescText",o[o.PlayCounter=7]="PlayCounter",o[o.Popularimeter=8]="Popularimeter",o[o.MusicCDId=9]="MusicCDId",o[o.EventTimingCodes=10]="EventTimingCodes",o[o.SYLT=11]="SYLT",o[o.GEOB=12]="GEOB",o[o.ETCO=13]="ETCO",o[o.PCST=14]="PCST",o[o.LINK=15]="LINK",o[o.AENC=16]="AENC",o[o.Pic=17]="Pic",o[o.RVAD=18]="RVAD",o[o.RGAD=19]="RGAD",o[o.RVAD2=20]="RVAD2",o[o.CTOC=21]="CTOC",o[o.CHAP=22]="CHAP",o[o.Bool=23]="Bool",o[o.Unknown=24]="Unknown",o}(s||{}),D={internal_file:{title:"Filename",versions:[2,3,4],impl:s.Filename},UFI:{title:"Unique file identifier",versions:[2],impl:s.IdText,upgrade:"UFID"},TOT:{title:"Original album/Movie/Show title",versions:[2],impl:s.Text,upgrade:"TOAL"},CDM:{title:"Compressed Data Metaframe",versions:[2],impl:s.Unknown},CRM:{title:"Encrypted meta",versions:[2],impl:s.Unknown},TT1:{title:"Content group",versions:[2],impl:s.Text,upgrade:"TIT1"},TT2:{title:"Title",versions:[2],impl:s.Text,upgrade:"TIT2"},TT3:{title:"Subtitle",versions:[2],impl:s.Text,upgrade:"TIT3"},TP1:{title:"Artist",versions:[2],impl:s.Text,upgrade:"TPE1"},TP2:{title:"Album Artist",versions:[2],impl:s.Text,upgrade:"TPE2"},TP3:{title:"Conductor",versions:[2],impl:s.Text,upgrade:"TPE3"},TP4:{title:"Remixer",versions:[2],impl:s.Text,upgrade:"TPE4"},TCM:{title:"Composer",versions:[2],impl:s.Text,upgrade:"TCOM"},TXT:{title:"Lyricist",versions:[2],impl:s.Text,upgrade:"TEXT"},TLA:{title:"Languages",versions:[2],impl:s.Text,upgrade:"TLAN"},TCO:{title:"Genre",versions:[2],impl:s.Text,upgrade:"TCON"},TAL:{title:"Album",versions:[2],impl:s.Text,upgrade:"TALB"},TPA:{title:"Part of a set",versions:[2],impl:s.Text,upgrade:"TPOS"},TRK:{title:"Track number",versions:[2],impl:s.Text,upgrade:"TRCK"},TRC:{title:"ISRC (international standard recording code)",versions:[2],impl:s.Text,upgrade:"TSRC"},TYE:{title:"Year",versions:[2],impl:s.Text,upgrade:"TYER"},TDA:{title:"Date",versions:[2],impl:s.Text,upgrade:"TDAT"},TIM:{title:"Time",versions:[2],impl:s.Text,upgrade:"TIME"},TRD:{title:"Recording dates",versions:[2],impl:s.Text,upgrade:"TRDA"},TMT:{title:"Media type",versions:[2],impl:s.Text,upgrade:"TMED"},TBP:{title:"BPM",versions:[2],impl:s.Text,upgrade:"TBPM"},TCR:{title:"Copyright message",versions:[2],impl:s.Text,upgrade:"TCOP"},TPB:{title:"Publisher",versions:[2],impl:s.Text,upgrade:"TPUB"},TEN:{title:"Encoded by",versions:[2],impl:s.Text,upgrade:"TENC"},TSS:{title:"Encoding Software/Hardware",versions:[2],impl:s.Text,upgrade:"TSSE"},TOF:{title:"Original filename",versions:[2],impl:s.Text,upgrade:"TOFN"},TLE:{title:"Length",versions:[2],impl:s.Text,upgrade:"TLEN"},TSI:{title:"Size",versions:[2],impl:s.Text,upgrade:"TSIZ"},TDY:{title:"Playlist delay",versions:[2],impl:s.Text,upgrade:"TDLY"},TKE:{title:"Initial key",versions:[2],impl:s.Text,upgrade:"TKEY"},TOL:{title:"Original lyricist",versions:[2],impl:s.Text,upgrade:"TOLY"},TOA:{title:"Original artist",versions:[2],impl:s.Text,upgrade:"TOPE"},TOR:{title:"Original release year",versions:[2],impl:s.Text,upgrade:"TORY"},TXX:{title:"User defined text",versions:[2],impl:s.IdText,upgrade:"TXXX"},WAF:{title:"Official audio file webpage",versions:[2],impl:s.Text,upgrade:"WOAF"},WAR:{title:"Official artist/performer webpage",versions:[2],impl:s.Text,upgrade:"WOAR"},WAS:{title:"Official audio source webpage",versions:[2],impl:s.Text,upgrade:"WOAS"},WCM:{title:"Commercial information",versions:[2],impl:s.Text,upgrade:"WCOM"},WCP:{title:"Copyright/Legal information",versions:[2],impl:s.Text,upgrade:"WCOP"},WPB:{title:"Publishers official webpage",versions:[2],impl:s.Text,upgrade:"WPUB"},WXX:{title:"User defined URL link frame",versions:[2],impl:s.IdText,upgrade:"WXXX"},IPL:{title:"Involved people list",versions:[2],impl:s.TextList,upgrade:"IPLS"},ETC:{title:"Event timing codes",versions:[2],impl:s.EventTimingCodes,upgrade:"ETCO"},MLL:{title:"MPEG location lookup table",versions:[2],impl:s.Unknown,upgrade:"MLLT"},STC:{title:"Synchronised tempo codes",versions:[2],impl:s.Unknown,upgrade:"SYTC"},ULT:{title:"Lyrics",versions:[2],impl:s.LangDescText,upgrade:"USLT"},SLT:{title:"Synchronised Lyrics",versions:[2],impl:s.SYLT,upgrade:"SYLT"},COM:{title:"Comments",versions:[2],impl:s.LangDescText,upgrade:"COMM"},RVA:{title:"Relative volume adjustment",versions:[2],impl:s.RVAD,upgrade:"RVAD"},EQU:{title:"Equalisation",versions:[2],impl:s.Unknown,upgrade:"EQUA"},REV:{title:"Reverb",versions:[2],impl:s.Unknown,upgrade:"RVRB"},PIC:{title:"Attached picture",versions:[2],impl:s.Pic,upgrade:"APIC"},GEO:{title:"General encapsulated object",versions:[2],impl:s.GEOB,upgrade:"GEOB"},CNT:{title:"Play counter",versions:[2],impl:s.PlayCounter,upgrade:"PCNT"},POP:{title:"Popularimeter",versions:[2],impl:s.Popularimeter,upgrade:"POPM"},BUF:{title:"Recommended buffer size",versions:[2],impl:s.Unknown,upgrade:"RBUF"},CRA:{title:"Audio encryption",versions:[2],impl:s.AENC,upgrade:"AENC"},LNK:{title:"Linked information",versions:[2],impl:s.LINK,upgrade:"LINK"},NCO:{title:"MusicMatch Binary",versions:[2],impl:s.Unknown,upgrade:"NCON"},PRI:{title:"Private frame",versions:[2],impl:s.IdBin,upgrade:"PRIV"},TCP:{title:"iTunes Compilation Flag",versions:[2],impl:s.Bool,upgrade:"TCMP"},TST:{title:"Title sort order",versions:[2],impl:s.Text,upgrade:"XSOT"},TSP:{title:"Artist sort order",versions:[2],impl:s.Text,upgrade:"XSOP"},TSA:{title:"Album sort order",versions:[2],impl:s.Text,upgrade:"XSOA"},TS2:{title:"Album Artist sort order",versions:[2],impl:s.Text,upgrade:"TSO2"},TSC:{title:"Composer sort order",versions:[2],impl:s.Text,upgrade:"TSOC"},TDR:{title:"Release time",versions:[2],impl:s.Text,upgrade:"TDRL"},TDS:{title:"iTunes podcast description",versions:[2],impl:s.Text,upgrade:"TDES"},TID:{title:"Podcast URL",versions:[2],impl:s.Text,upgrade:"TGID"},WFD:{title:"Podcast feed URL",versions:[2],impl:s.Text,upgrade:"WFED"},PCS:{title:"iTunes podcast marker",versions:[2],impl:s.PCST,upgrade:"PCST"},XSOA:{title:"Album sort order",versions:[3],impl:s.Text,upgrade:"TSOA"},XSOP:{title:"Performer sort order",versions:[3],impl:s.Text,upgrade:"TSOP"},XSOT:{title:"Title sort order",versions:[3],impl:s.Text,upgrade:"TSOT"},XDOR:{title:"Original release time",versions:[3],impl:s.Text,upgrade:"TDOR"},TIT1:{title:"Group",versions:[3,4],impl:s.Text},TIT2:{title:"Title",versions:[3,4],impl:s.Text},TIT3:{title:"Subtitle",versions:[3,4],impl:s.Text},TALB:{title:"Album",versions:[3,4],impl:s.Text},TOAL:{title:"Original album",versions:[3,4],impl:s.Text},TRCK:{title:"Track number",versions:[3,4],impl:s.Text},TPOS:{title:"Part of a set",versions:[3,4],impl:s.Text},TSRC:{title:"ISRC (international standard recording code)",versions:[3,4],impl:s.Text},TPE1:{title:"Artist",versions:[3,4],impl:s.Text},TPE2:{title:"Album Artist",versions:[3,4],impl:s.Text},TPE3:{title:"Conductor",versions:[3,4],impl:s.Text},TPE4:{title:"Remixer",versions:[3,4],impl:s.Text},TOPE:{title:"Original artist",versions:[3,4],impl:s.Text},TEXT:{title:"Lyricist",versions:[3,4],impl:s.Text},TOLY:{title:"Original lyricist",versions:[3,4],impl:s.Text},TCOM:{title:"Composer",versions:[3,4],impl:s.Text},TENC:{title:"Encoded by",versions:[3,4],impl:s.Text},TBPM:{title:"BPM",versions:[3,4],impl:s.Text},TLEN:{title:"Length",versions:[3,4],impl:s.Text},TKEY:{title:"Initial key",versions:[3,4],impl:s.Text},TLAN:{title:"Languages",versions:[3,4],impl:s.Text},TCON:{title:"Genre",versions:[3,4],impl:s.Text},TFLT:{title:"File type",versions:[3,4],impl:s.Text},TMED:{title:"Media type",versions:[3,4],impl:s.Text},TCOP:{title:"Copyright message",versions:[3,4],impl:s.Text},TPUB:{title:"Publisher",versions:[3,4],impl:s.Text},TOWN:{title:"File owner",versions:[3,4],impl:s.Text},TRSN:{title:"Internet radio station name",versions:[3,4],impl:s.Text},TRSO:{title:"Internet radio station owner",versions:[3,4],impl:s.Text},TOFN:{title:"Original filename",versions:[3,4],impl:s.Text},TDLY:{title:"Playlist delay",versions:[3,4],impl:s.Text},TSSE:{versions:[3,4],title:"Encoding Software/Hardware",impl:s.Text},TSST:{versions:[3,4],title:"Set subtitle",impl:s.Text},TDAT:{title:"Date",versions:[3],impl:s.Text},TIME:{title:"Time",versions:[3],impl:s.Text},TORY:{title:"Original release year",versions:[3],impl:s.Text},TRDA:{title:"Recording dates",versions:[3],impl:s.Text},TSIZ:{title:"Size",versions:[3],impl:s.Text},TYER:{title:"Year",versions:[3],impl:s.Text},TMCL:{versions:[4],title:"Musician credits list",impl:s.TextList},TIPL:{versions:[4],title:"Involved people list",impl:s.TextList},TMOO:{title:"Mood",versions:[4],impl:s.Text},TPRO:{title:"Produced notice",versions:[4],impl:s.Text},TDOR:{title:"Original release time",versions:[4],impl:s.Text},TDRC:{versions:[4],title:"Recording time",impl:s.Text},TDRL:{versions:[3,4],title:"Release time",impl:s.Text},TDTG:{versions:[4],title:"Tagging time",impl:s.Text},TSOA:{versions:[4],title:"Album sort order",impl:s.Text},TSOP:{versions:[4],title:"Artist sort order",impl:s.Text},TSOT:{versions:[4],title:"Title sort order",impl:s.Text},WCOM:{title:"Commercial information",versions:[3,4],impl:s.Text},WCOP:{title:"Copyright/Legal information",versions:[3,4],impl:s.Text},WOAF:{title:"Official audio file webpage",versions:[3,4],impl:s.Text},WOAR:{title:"Official artist/performer webpage",versions:[3,4],impl:s.Text},WOAS:{title:"Official audio source webpage",versions:[3,4],impl:s.Text},WORS:{title:"Official internet radio station homepage",versions:[3,4],impl:s.Text},WPAY:{title:"Payment",versions:[3,4],impl:s.Text},WPUB:{title:"Publishers official webpage",versions:[3,4],impl:s.Text},TXXX:{title:"User defined text",versions:[3,4],impl:s.IdText},WXXX:{title:"User defined URL link frame",versions:[3,4],impl:s.IdText},UFID:{title:"Unique file identifier",versions:[3,4],impl:s.IdText},MCDI:{title:"Music CD identifier",versions:[3,4],impl:s.MusicCDId},ETCO:{title:"Event timing codes",versions:[3,4],impl:s.ETCO},MLLT:{title:"MPEG location lookup table",versions:[3,4],impl:s.Unknown},SYTC:{title:"Synchronised tempo codes",versions:[3,4],impl:s.Unknown},USLT:{title:"Lyrics",versions:[3,4],impl:s.LangDescText},SYLT:{title:"Synchronised Lyrics",versions:[3,4],impl:s.SYLT},COMM:{title:"Comments",versions:[3,4],impl:s.LangDescText},RVAD:{title:"Relative volume adjustment",versions:[3,4],impl:s.RVAD},RVA2:{title:"Relative volume adjustment 2",versions:[4],impl:s.RVAD2},EQUA:{title:"Equalisation",versions:[3,4],impl:s.Unknown},RVRB:{title:"Reverb",versions:[3,4],impl:s.Unknown},APIC:{title:"Attached picture",versions:[3,4],impl:s.Pic},GEOB:{title:"General encapsulated object",versions:[3,4],impl:s.GEOB},PCNT:{title:"Play counter",versions:[3,4],impl:s.PlayCounter},POPM:{title:"Popularimeter",versions:[3,4],impl:s.Popularimeter},RBUF:{title:"Recommended buffer size",versions:[3,4],impl:s.Unknown},AENC:{title:"Audio encryption",versions:[3,4],impl:s.AENC},LINK:{title:"Linked information",versions:[3,4],impl:s.LINK},POSS:{title:"Position synchronisation",versions:[3,4],impl:s.Unknown},USER:{title:"Terms of use",versions:[3,4],impl:s.Unknown},OWNE:{title:"Ownership",versions:[3,4],impl:s.Unknown},COMR:{title:"Commercial",versions:[3,4],impl:s.Unknown},ENCR:{title:"Encryption method registration",versions:[3,4],impl:s.Unknown},GRID:{title:"Group ID registration",versions:[3,4],impl:s.Unknown},PRIV:{title:"Private frame",versions:[3,4],impl:s.IdBin},IPLS:{title:"Involved people list",versions:[3],impl:s.TextList},SIGN:{title:"Signature",versions:[4],impl:s.Unknown},SEEK:{title:"Seek",versions:[4],impl:s.Unknown},ASPI:{title:"Audio seek point index",versions:[4],impl:s.Unknown},RGAD:{title:"Replay Gain Adjustment",versions:[3,4],impl:s.RGAD},TCMP:{title:"iTunes Compilation Flag",versions:[3,4],impl:s.Bool},TSO2:{title:"Album Artist sort order",versions:[3,4],impl:s.Text},TSOC:{title:"Composer sort order",versions:[3,4],impl:s.Text},PCST:{title:"iTunes podcast marker",versions:[3,4],impl:s.PCST},TDES:{title:"iTunes podcast description",versions:[3,4],impl:s.Text},TKWD:{title:"iTunes podcast keywords",versions:[3,4],impl:s.Unknown},TGID:{title:"Podcast URL",versions:[3,4],impl:s.Text},TDEN:{title:"Encoding time",versions:[3,4],impl:s.Text},WFED:{title:"Podcast feed URL",versions:[3,4],impl:s.Text},GRP1:{title:"Group Number",versions:[3,4],impl:s.Text},NCON:{title:"MusicMatch Binary",versions:[3,4],impl:s.Unknown},CTOC:{title:"Chapter TOC",versions:[4],impl:s.CTOC},CHAP:{title:"Chapter",versions:[4],impl:s.CHAP},XHD3:{title:"mp3hd",versions:[3,4],impl:s.Unknown},CM1:{title:"User defined text",versions:[2],impl:s.Text,upgrade:"TXXX"}},be={ASIN:"ASIN Id",CATALOGNUMBER:"Catalog Nr",SCRIPT:"Script",BARCODE:"Barcode",originalyear:"Original Year",replaygain_track_gain:"Replaygain track gain",replaygain_album_gain:"Replaygain album gain",replaygain_track_peak:"Replaygain track peak",replaygain_album_peak:"Replaygain album peak",Artists:"Artists",Supplier:"Supplier","Release type":"Release type","Acoustid Id":"Acoustid Id","MusicBrainz Track Disambiguation":"MusicBrainz Track Disambiguation","MusicBrainz Album Type":"MusicBrainz Album Type","MusicBrainz Album Artist Id":"MusicBrainz Album Artist Id","MusicBrainz Artist Id":"MusicBrainz Artist Id","MusicBrainz Album Id":"MusicBrainz Album Id","MusicBrainz Release Track Id":"MusicBrainz Release Track Id","MusicBrainz Release Group Id":"MusicBrainz Release Group Id","MusicBrainz Recording Id":"MusicBrainz Recording Id","MusicBrainz Album Status":"MusicBrainz Album Status","MusicBrainz Album Release Country":"MusicBrainz Album Release Country","MusicBrainz TRM Id":"MusicBrainz TRM Id","Discogs Artist ID":"Discogs Artist Id","Discogs Label ID":"Discogs Label Id","Discogs Master Release ID":"Discogs Master Release Id","Discogs Release ID":"Discogs Master Release Id","Discogs Votes":"Discogs Votes","Discogs Rating":"Discogs Rating"},Pe={"http://musicbrainz.org":"MusicBrainz Track Id"},xe={"http://musicbrainz.org":"MusicBrainz Track Id","":"Default Comment"};function $i(o){return o==="TXXX"?Object.keys(be).map(t=>({subid:t,name:be[t]})):o==="UFID"?Object.keys(Pe).map(t=>({subid:t,name:Pe[t]})):o==="COMM"?Object.keys(xe).map(t=>({subid:t,name:xe[t]})):[]}var te="internal_file",Ae=[{id:te,width:200,force:!0},{id:"TRCK",width:60,force:!0},{id:"TIT2",width:200,force:!0},{id:"TALB",width:200,force:!0},{id:"TPE1",width:140,force:!0},{id:"TPE2",width:140,force:!0},{id:"TOPE",width:140},{id:"TCON",width:100,force:!0},{id:"TPOS",width:60,force:!0},{id:"TIT1",width:200,force:!0},{id:"GRP1",width:60,force:!0},{id:"TMOO",width:100},{id:"APIC",width:100,force:!0},{id:"USLT",width:200,force:!0},{id:"TSOP",width:140},{id:"TSO2",width:140},{id:"TXXX",subid:"Artists",width:140},{id:"IPLS",width:140},{id:"TIPL",width:140},{id:"TMCL",width:140},{id:"TYER",width:100},{id:"TDOR",width:100,force:!0},{id:"TDRC",width:100,force:!0},{id:"TDRL",width:80},{id:"TDAT",width:60},{id:"TORY",width:60},{id:"TXXX",subid:"originalyear",width:60},{id:"TXXX",subid:"MusicBrainz Album Type",width:100,force:!0},{id:"TXXX",subid:"MusicBrainz Album Status",width:60,force:!0},{id:"TXXX",subid:"MusicBrainz Album Release Country",width:60},{id:"TXXX",subid:"MusicBrainz Track Disambiguation",width:100},{id:"TXXX",subid:"Release type",width:100},{id:"TXXX",subid:"SCRIPT",width:60},{id:"TLAN",width:60},{id:"TMED",width:40},{id:"TLEN",width:60},{id:"TIME",width:60},{id:"TKEY",width:60},{id:"TBPM",width:60},{id:"APIC",width:80},{id:"TPUB",width:140},{id:"WPUB",width:140},{id:"WCOP",width:140},{id:"TCOP",width:140},{id:"TCOM",width:140},{id:"TSOC",width:140},{id:"MCDI",width:40},{id:"TXXX",subid:"Acoustid Id",width:40},{id:"TXXX",subid:"ASIN",width:100},{id:"UFID",subid:"http://musicbrainz.org",width:80},{id:"TXXX",subid:"MusicBrainz Release Track Id",width:80},{id:"TXXX",subid:"MusicBrainz Album Id",width:80},{id:"TXXX",subid:"MusicBrainz Album Artist Id",width:80},{id:"TXXX",subid:"MusicBrainz Artist Id",width:80},{id:"TXXX",subid:"MusicBrainz Release Group Id",width:80},{id:"TSSE",width:80},{id:"TFLT",width:80},{id:"TSST",width:80},{id:"TXXX",subid:"Ripping tool",width:80},{id:"TXXX",subid:"Ripping date",width:80},{id:"TDEN",width:80},{id:"TXXX",subid:"Rip date",width:80},{id:"TXXX",subid:"Source",width:80},{id:"TXXX",subid:"Supplier",width:80},{id:"TENC",width:80},{id:"TXXX",subid:"ASIN",width:110},{id:"TSRC",width:110},{id:"TXXX",subid:"BARCODE",width:110},{id:"PRIV",subid:"http://www.cdtag.com",width:100},{id:"TXXX",subid:"CATALOGNUMBER",width:110},{id:"TCMP",width:40},{id:"COMM",width:140},{id:"WXXX",width:140},{id:"GEOB",width:140}],Ct={0:"Other",1:"32x32 pixels 'file icon' (PNG only)",2:"Other file icon",3:"Cover (front)",4:"Cover (back)",5:"Leaflet page",6:"Media (e.g. lable side of CD)",7:"Lead artist/lead performer/soloist",8:"Artist/performer",9:"Conductor",10:"Band/Orchestra",11:"Composer",12:"Lyricist/text writer",13:"Recording Location",14:"During recording",15:"During performance",16:"Movie/video screen capture",17:"A bright coloured fish",18:"Illustration",19:"Band/artist logotype",20:"Publisher/Studio logotype"};function _n(o,t){if(o&1){let e=P();d(0,"image-cropper",5),f("cropperReady",function(){m(e);let i=u();return p(i.cropperReady())})("loadImageFailed",function(){m(e);let i=u();return p(i.loadImageFailed())})("imageLoaded",function(){m(e);let i=u();return p(i.imageLoaded())})("imageCropped",function(i){m(e);let a=u();return p(a.imageCropped(i))}),l()}if(o&2){let e=u();E("maintainAspectRatio",e.maintainAspectRatio)("format",e.format)("imageBase64",e.current.source)}}var ht=(()=>{class o{edit;maintainAspectRatio=!0;current={};format="jpeg";dialogInit(e,n){this.edit=n.data,this.edit&&(this.edit.result=this.edit.frames.map(i=>({id:i.id,value:ve({},i.value)})),this.edit.result.length>0&&this.displayFrame(this.edit.result[0]))}displayFrame(e){let n=`data:${e.value.mimeType||"image/jpeg"};base64,${e.value.bin}`;this.current.frame=e,this.current.source=n}onDropFile(e){e.preventDefault(),this.uploadFile(e.dataTransfer?.files)}selectFile(e){this.uploadFile(e.target.files)}onDragOverFile(e){e.stopPropagation(),e.preventDefault()}splitBase64(e){return{mimeType:e.slice(5,e.indexOf(";")),base64:e.slice(e.indexOf("base64,")+7)}}buildFrame(e){let{mimeType:n,base64:i}=this.splitBase64(e);return{id:"APIC",value:{mimeType:n,description:"",bin:i,pictureType:3}}}uploadFile(e){if(!e||e.length===0)return;let n=e[0],i=new FileReader;i.readAsDataURL(n),i.onload=a=>{let r=a.target.result;this.current.frame||(this.current.frame=this.buildFrame(r),this.edit?.result&&this.edit.result.push(this.current.frame)),this.current.source=r;let{mimeType:c,base64:T}=this.splitBase64(r);this.current.frame.value.mimeType=c,this.current.frame.value.bin=T},i.onerror=a=>{console.error(a)}}loadImageFailed(){}cropperReady(){}imageLoaded(){}imageCropped(e){if(this.current?.frame&&e.base64){let{mimeType:n,base64:i}=this.splitBase64(e.base64);this.current.frame.value.mimeType=n,this.current.frame.value.bin=i}}static \u0275fac=function(n){return new(n||o)};static \u0275cmp=v({type:o,selectors:[["app-dialog-tag-image"]],standalone:!1,decls:8,vars:3,consts:()=>{let e;e=$localize`:␟d833321cc90a0b0a52714c6d5ec97fbe6c7cfa5c␟2501989539336327542:Upload image`;let n;return n=$localize`:␟9adf24384bd663ce0cf256940aae864e83991330␟6234579371454134968:Maintain Aspect Ratio`,[n,["type","checkbox",3,"ngModelChange","checked","ngModel"],[1,"drop-zone",3,"drop","dragover"],["output","base64",3,"maintainAspectRatio","format","imageBase64"],["type","file","placeholder",e,"accept",".png,.jpeg,.jpg",3,"change"],["output","base64",3,"cropperReady","loadImageFailed","imageLoaded","imageCropped","maintainAspectRatio","format","imageBase64"]]},template:function(n,i){n&1&&(d(0,"label")(1,"input",1),G("ngModelChange",function(r){return k(i.maintainAspectRatio,r)||(i.maintainAspectRatio=r),r}),l(),$(2),h(3,0),F(),l(),d(4,"div",2),f("drop",function(r){return i.onDropFile(r)})("dragover",function(r){return i.onDragOverFile(r)}),g(5,_n,1,3,"image-cropper",3),d(6,"form")(7,"input",4),f("change",function(r){return i.selectFile(r)}),l()()()),n&2&&(_(),E("checked",i.maintainAspectRatio),w("ngModel",i.maintainAspectRatio),_(4),C(i.current.source?5:-1))},dependencies:[pe,ee,z,ue,V,me,Ke],styles:["[_nghost-%COMP%]   .drop-zone[_ngcontent-%COMP%]{padding:10px 20px;border-width:2px;border-style:dotted;border-color:var(--secondary)}"]})}return o})();function un(o,t){if(o&1){let e=P();d(0,"textarea",1),G("ngModelChange",function(i){m(e);let a=u();return k(a.currentLyrics.value.text,i)||(a.currentLyrics.value.text=i),p(i)}),l()}if(o&2){let e=u();w("ngModel",e.currentLyrics.value.text)}}var ft=(()=>{class o{edit;currentLyrics;dialogInit(e,n){if(this.edit=n.data,this.edit){if(this.edit.result=this.edit.frames.map(i=>({id:i.id,value:ve({},i.value)})),this.edit.result.length===0){let i={id:"USLT",value:{id:"",language:"",text:""}};this.edit.result.push(i)}this.currentLyrics=this.edit.result[0]}}static \u0275fac=function(n){return new(n||o)};static \u0275cmp=v({type:o,selectors:[["app-dialog-tag-lyrics"]],standalone:!1,decls:1,vars:1,consts:()=>{let e;e=$localize`:␟037aa3ea211cc632fa094de77aaefe2ab6e097a2␟6110089012347909146:off`;let n;return n=$localize`:␟037aa3ea211cc632fa094de77aaefe2ab6e097a2␟6110089012347909146:off`,[["autocomplete","off","autocorrect",e,"autocapitalize",n,"spellcheck","false",3,"ngModel"],["autocomplete","off","autocorrect",e,"autocapitalize",n,"spellcheck","false",3,"ngModelChange","ngModel"]]},template:function(n,i){n&1&&g(0,un,1,1,"textarea",0),n&2&&C(i.currentLyrics?0:-1)},dependencies:[_e,z,V],styles:["[_nghost-%COMP%]   textarea[_ngcontent-%COMP%]{width:100%;height:100%}"]})}return o})();var pn=["cellContainer"];function gn(o,t){if(o&1&&M(0,"app-cell-editor-display",1),o&2){let e=u();E("lines",e.lines)}}function Cn(o,t){o&1&&Kt(0,null,0)}var Tt=(()=>{class o extends Te{dialogOverlay;resolver;cell=void 0;navigKeyDownRequest=new j;lines=[];inactive=!0;container;unsubscribe=new Oe;componentRef;constructor(e,n){super(),this.dialogOverlay=e,this.resolver=n}ngOnDestroy(){this.clearEdit(),this.unsubscribe.next(),this.unsubscribe.complete()}clickEvent(){this.edit()}onCellEditorNavigationKeyDown(e){this.navigKeyDownRequest.emit(e)}ngOnChanges(e){e.cell&&this.display()}navigTo(){}static picFrameToString(e){return Ct[e.value.pictureType]||"image"}static popularimeterFrameToString(e){return`${e.value.rating} - ${e.value.email} - ${e.value.count}`}static boolFrameToString(e){return`${e.value.bool}`}static textListFrameToString(e){return e.value.list.join(`
`)}static textFrameToString(e){return e.value.text}static idTextFrameToString(e){return e.value.text}static playCounterFrameToString(e){return`${e.value.num}`}static geobFrameToString(e){return`Binary ${e.value&&e.value.bin?e.value.bin.length:0} bytes`}static idBinFrameToString(e){return`Binary ${e.value&&e.value.bin?e.value.bin.length:0} bytes`}static langDescFrameToString(e){return e.value.text}edit(){switch(this.cell?.column.def.impl){case s.Filename:case s.IdText:case s.LangDescText:case s.Text:this.cell.column.def.id==="USLT"?this.editLyrics():this.startEdit(gt);break;case s.Bool:this.editBool();break;case s.Pic:this.editPictures();break;default:}}startEdit(e){this.inactive&&(this.inactive=!1,setTimeout(()=>{this.createComponent(e),this.componentRef&&(this.componentRef.instance.cell=this.cell,this.componentRef.instance.ngOnChanges&&this.componentRef.instance.ngOnChanges({cell:{current:this.cell}}),this.componentRef.instance.navigBlur&&this.componentRef.instance.navigBlur.pipe(he(this.unsubscribe)).subscribe(()=>{this.clearEdit(),this.inactive=!0}),this.componentRef.instance.navigChange&&this.componentRef.instance.navigChange.pipe(he(this.unsubscribe)).subscribe(()=>{this.setChanged()}))}))}clearEdit(){this.componentRef&&this.componentRef.destroy(),this.container&&this.container.clear()}createComponent(e){if(this.clearEdit(),this.container){let n=this.resolver.resolveComponentFactory(e);this.componentRef=this.container.createComponent(n)}}editBool(){this.cell&&(this.cell.frames.length===0&&this.cell.frames.push({id:this.cell.column.def.id,value:{bool:!1}}),this.cell.frames[0].value.bool=!this.cell.frames[0].value.bool,this.setChanged())}setChanged(){this.cell&&(this.cell.changed=!0,this.cell.parent.changed=!0,this.display())}editPictures(){let e=this.cell;if(e){let n={frames:e.frames};this.dialogOverlay.open({title:"Tag Pictures",childComponent:ht,data:n,onOkBtn:()=>R(this,null,function*(){return e.frames=n.result||[],this.setChanged(),Promise.resolve()}),onCancelBtn:()=>R(this,null,function*(){return Promise.resolve()})})}}editLyrics(){let e=this.cell;if(e){let n={frames:e.frames};this.dialogOverlay.open({title:"Tag Lyrics",childComponent:ft,data:n,panelClass:"overlay-panel-large-buttons",onOkBtn:()=>R(this,null,function*(){return e.frames=n.result?n.result.filter(i=>i.value.text.length>0):[],this.setChanged(),Promise.resolve()}),onCancelBtn:()=>R(this,null,function*(){return Promise.resolve()})})}}display(){this.lines=this.cell?this.cell.frames.map(e=>this.frameToString(e)):[]}frameToString(e){switch(this.cell?.column.def.impl){case s.Filename:case s.Text:return o.textFrameToString(e);case s.LangDescText:return o.langDescFrameToString(e);case s.IdText:return o.idTextFrameToString(e);case s.Pic:return o.picFrameToString(e);case s.TextList:return o.textListFrameToString(e);case s.IdBin:return o.idBinFrameToString(e);case s.GEOB:return o.geobFrameToString(e);case s.Bool:return o.boolFrameToString(e);case s.Popularimeter:return o.popularimeterFrameToString(e);case s.PlayCounter:return o.playCounterFrameToString(e);case s.MusicCDId:case s.EventTimingCodes:case s.SYLT:case s.ETCO:case s.PCST:case s.LINK:case s.AENC:case s.RVAD:case s.RGAD:case s.RVAD2:case s.CTOC:case s.CHAP:case s.Unknown:default:return`TODO CELLEDITOR: ${this.cell?.column.def.name}`}}static \u0275fac=function(n){return new(n||o)(L(We),L(Ht))};static \u0275cmp=v({type:o,selectors:[["app-cell-editor"]],viewQuery:function(n,i){if(n&1&&Y(pn,5,zt),n&2){let a;Q(a=Z())&&(i.container=a.first)}},hostBindings:function(n,i){n&1&&f("click",function(r){return i.clickEvent(r)})},inputs:{cell:"cell"},outputs:{navigKeyDownRequest:"navigKeyDownRequest"},standalone:!1,features:[ni([{provide:Te,useExisting:$t(()=>o)}]),Wt,q],decls:2,vars:2,consts:[["cellContainer",""],[3,"lines"]],template:function(n,i){n&1&&(g(0,gn,1,1,"app-cell-editor-display",1),g(1,Cn,2,0,"ng-container")),n&2&&(C(i.inactive?0:-1),_(),C(i.inactive?-1:1))},dependencies:[pt],encapsulation:2})}return o})();var fn=(o,t)=>t.def.id,Tn=(o,t)=>t.title;function Mn(o,t){if(o&1){let e=P();d(0,"div",15),$(1),h(2,5),F(),d(3,"div",16)(4,"app-tag-editor-autocomplete",22),G("valueChange",function(i){m(e);let a=u(2);return k(a.multiStr,i)||(a.multiStr=i),p(i)}),l()(),d(5,"button",19),f("click",function(){m(e);let i=u(2);return p(i.editor.setColumnText(i.activeCol,i.multiStr))}),h(6,6),l(),d(7,"button",19),f("click",function(){m(e);let i=u(2);return p(i.editor.appendColumnText(i.activeCol,i.multiStr))}),h(8,7),l(),d(9,"button",19),f("click",function(){m(e);let i=u(2);return p(i.editor.removeColumnText(i.activeCol,i.multiStr))}),h(10,8),l()()}if(o&2){let e=u(2);_(4),E("getList",e.activeCol.getAutoCompleteList),w("value",e.multiStr)}}function On(o,t){if(o&1&&(d(0,"option",18),O(1),l()),o&2){let e=t.$implicit,n=t.$index;E("value",n),_(),B(e.def.name)}}function En(o,t){if(o&1){let e=P();d(0,"div",15),O(1),M(2,"br"),d(3,"button",19),f("click",function(){let i=m(e).$implicit;return p(i.click())}),M(4,"i",23),l()()}if(o&2){let e=t.$implicit;_(),X(" ",e.title)}}function Sn(o,t){if(o&1){let e=P();d(0,"div",9)(1,"div",10)(2,"div",11)(3,"a",12),f("click",function(){m(e);let i=u();return p(i.close())})("keydown.enter",function(){m(e);let i=u();return p(i.close())}),M(4,"i",13),l()(),$(5),h(6,0),F(),d(7,"span"),O(8),l()(),d(9,"div",14),g(10,Mn,11,2,"div",15),d(11,"div",15),$(12),h(13,1),F(),d(14,"div",16)(15,"select",17),G("ngModelChange",function(i){m(e);let a=u();return k(a.sourceColumnIndex,i)||(a.sourceColumnIndex=i),p(i)}),y(16,On,2,2,"option",18,fn),l()(),d(18,"button",19),f("click",function(){m(e);let i=u();return p(i.editor.copyColumn(i.sourceColumnIndex,i.activeCol))}),h(19,2),l(),d(20,"button",19),f("click",function(){m(e);let i=u();return p(i.editor.appendFromColumn(i.sourceColumnIndex,i.activeCol))}),h(21,3),l(),d(22,"div",20)(23,"button",19),f("click",function(){m(e);let i=u();return p(i.editor.insertFromColumn(i.sourceColumnIndex,0,i.activeCol))}),h(24,4),l(),M(25,"input",21),l()(),y(26,En,5,1,"div",15,Tn),l()()}if(o&2){let e=u();_(8),B(e.activeCol.def.name),_(2),C(e.activeCol.multi?10:-1),_(5),w("ngModel",e.sourceColumnIndex),_(),I(e.editor.columns),_(10),I(e.activeCol.actions)}}var Mt=(()=>{class o{editor;activeCol;requestClose=new j;sourceColumnIndex=0;multiStr="";close(){this.requestClose.emit()}static \u0275fac=function(n){return new(n||o)};static \u0275cmp=v({type:o,selectors:[["app-admin-tag-editor-column-tool"]],inputs:{editor:"editor",activeCol:"activeCol"},outputs:{requestClose:"requestClose"},standalone:!1,decls:1,vars:1,consts:()=>{let e;e=$localize`:␟f4e529ae5ffd73001d1ff4bbdeeb0a72e342e5c8␟7819314041543176992:Close`;let n;n=$localize`:␟d731f73de19f7407b321fce2ff8de9425d72c662␟1607698600866936391:Current Column:`;let i;i=$localize`:␟37b491bdf12da2468699e357868ea7284bbeb61d␟5804004197558421795:Column Source`;let a;a=$localize`:␟1979da7460819153e11d2078244645d94291b69c␟4323470180912194028:Copy`;let r;r=$localize`:␟0d03d787306410e77e4703cc6da4486836dec357␟7771562252675241359:Append`;let c;c=$localize`:␟e97cdb4e187e8c55422b6e55c4285b93e2570553␟6908115012584116794:Insert at`;let T;T=$localize`:␟8fd7e975ff82c96b835d595a37b7c823e0e6b047␟6476905889975409604:Column Text`;let A;A=$localize`:␟55dd9f44e64851bca3b7bfc9283a5ff36f030228␟4359847060009771702:Set`;let S;S=$localize`:␟0d03d787306410e77e4703cc6da4486836dec357␟7771562252675241359:Append`;let N;return N=$localize`:␟019d4bd6a5690f0cfa0ecf346a4e6bf7f0d8debb␟4814285799071780083:Remove`,[n,i,a,r,c,T,A,S,N,[1,"column-tools"],[1,"column-tools-title"],[1,"close-panel"],["tabindex","0","title",e,1,"close",3,"click","keydown.enter"],["aria-hidden","true"],[1,"column-tool-content"],[1,"column-tool"],[1,"input-box"],[3,"ngModelChange","ngModel"],[3,"value"],[1,"button-on-background",3,"click"],[1,"button-with-add-on","button-insert-at"],["type","number"],[3,"valueChange","getList","value"],[1,"icon-down-thin"]]},template:function(n,i){n&1&&g(0,Sn,28,3,"div",9),n&2&&C(i.activeCol&&i.editor?0:-1)},dependencies:[_i,ui,di,z,V,fe],styles:['[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]{border:1px solid var(--control-border);padding-bottom:15px}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .close-panel[_ngcontent-%COMP%]{float:right;display:inline-block;overflow:hidden;width:2.5rem;height:2.5rem;max-width:2.5rem;max-height:2.5rem;margin-top:-15px}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .close-panel[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:2.5rem;height:2.5rem;border:none;background-color:transparent;font-size:1.5rem;transition:.25s linear}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .close-panel[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]:before, [_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .close-panel[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]:after{position:absolute;content:"";width:.75rem;height:.125rem;background-color:var(--on-control-hover);overflow:hidden}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .close-panel[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]:before{transform:rotate(-45deg)}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .close-panel[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]:after{transform:rotate(45deg)}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .close-panel[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]:hover{transform:rotate(360deg)}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .close-panel[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]:hover:before, [_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .close-panel[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]:hover:after{background-color:var(--accent)}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .column-tools-title[_ngcontent-%COMP%]{padding-top:15px;padding-left:15px;padding-right:15px}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .column-tools-title[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--on-control-active)}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .input-box[_ngcontent-%COMP%]{border-radius:3px;padding-left:3px;padding-right:3px;align-items:center;background-color:var(--input);border:1px solid var(--input-border)}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .input-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{flex:1;border:none;min-height:20px;background-color:var(--input);color:var(--on-input)}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .input-box[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:var(--on-input);font-size:14px;cursor:pointer}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .input-box[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]:hover{color:var(--on-input-hover)}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .input-box[_ngcontent-%COMP%]{display:flex}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .button-insert-at[_ngcontent-%COMP%]{display:inline-flex}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .button-insert-at[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:50px;border-color:var(--on-control-ambient)}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   app-tag-editor-autocomplete[_ngcontent-%COMP%]{flex:1;border:none;min-height:24px;height:24px;background-color:var(--input);color:var(--on-input)}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{flex:1;border:none;height:24px;background-color:var(--input);color:var(--on-input);width:100%}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .column-tool-content[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .column-tool[_ngcontent-%COMP%]{padding:15px 15px 0;font-size:.8em;align-self:center}']})}return o})();var An=()=>({standalone:!0}),Rn=(o,t)=>t.title;function vn(o,t){if(o&1){let e=P();d(0,"div",0)(1,"label")(2,"input",1),G("ngModelChange",function(i){let a=m(e).$implicit;return k(a.enabled,i)||(a.enabled=i),p(i)}),l(),O(3),l(),d(4,"app-tag-editor-autocomplete",2),G("valueChange",function(i){let a=m(e).$implicit;return k(a.value,i)||(a.value=i),p(i)}),l()()}if(o&2){let e=t.$implicit;_(2),E("ngModelOptions",Fe(6,An)),w("ngModel",e.enabled),_(),X(" ",e.title),_(),E("getList",e.getList)("standalone",!0),w("value",e.value)}}var Ot=(()=>{class o{data;edit={title:{title:"Album Title",value:"",enabled:!0,autocomplete:[]},artist:{title:"Artist",value:"",enabled:!1,autocomplete:[]},albumArtist:{title:"Album Artist",value:"",enabled:!0,autocomplete:[]},originalReleaseTime:{title:"Original Release Time",value:"",enabled:!0,autocomplete:[]},recordingTime:{title:"Recording Time",value:"",enabled:!0,autocomplete:[]},genre:{title:"Genre",value:"",enabled:!0,autocomplete:[]},part:{title:"Part of Set",value:"",enabled:!0,autocomplete:[]},status:{title:"Album Status",value:"",enabled:!0,autocomplete:[]},type:{title:"Album Type",value:"",enabled:!0,autocomplete:[]}};edits=Object.keys(this.edit).map(e=>{let n=this.edit[e];return n.getList=()=>this.getAutoCompleteList(n),n});getAutoCompleteList(e){return e.autocomplete}dialogInit(e,n){this.data=n.data}static \u0275fac=function(n){return new(n||o)};static \u0275cmp=v({type:o,selectors:[["app-dialog-album"]],standalone:!1,decls:4,vars:0,consts:[[1,"user-form-control"],["type","checkbox",3,"ngModelChange","ngModelOptions","ngModel"],[3,"valueChange","getList","standalone","value"]],template:function(n,i){n&1&&(d(0,"div")(1,"form"),y(2,vn,5,7,"div",0,Rn),l()()),n&2&&(_(2),I(i.edits))},dependencies:[pe,ee,z,ue,V,me,fe],styles:["[_nghost-%COMP%]   .user-form-control[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]{width:100%}"]})}return o})();var bn=(o,t)=>t.id;function xn(o,t){if(o&1){let e=P();d(0,"div",7)(1,"div",8)(2,"label")(3,"input",9),G("ngModelChange",function(i){let a=m(e).$implicit;return k(a.checked,i)||(a.checked=i),p(i)}),f("change",function(){m(e);let i=u();return p(i.checkChange())}),l(),O(4),l()(),d(5,"div",10),O(6),l()()}if(o&2){let e=t.$implicit;_(3),E("checked",e.checked),w("ngModel",e.checked),_(),X(" ",e.name||e.frameDef.title," "),_(2),X(" ",e.id," ")}}var Et=(()=>{class o{data;filteredColumns=[];allColumns=[];version=4;urls={2:"http://id3.org/id3v2-00",3:"http://id3.org/id3v2.3.0",4:"http://id3.org/id3v2.4.0-frames"};trackByFn(e,n){return n.id}checkChange(){this.setResult()}setResult(){this.data&&(this.data.resultColumns=this.filteredColumns.filter(e=>e.checked))}refresh(){this.filteredColumns=this.allColumns.filter(e=>e.frameDef.versions.includes(this.version)),this.setResult()}setVersion(e){this.version=e,this.refresh()}dialogInit(e,n){this.data=n.data,this.allColumns=[];let i=this.data?.columns||[];Object.keys(D).forEach(a=>{let r=$i(a);if(r.length===0){let c=i.find(T=>T.def.id===a);this.allColumns.push({id:a,frameDef:D[a],column:c,checked:!!c})}else for(let c of r){let T=i.find(A=>A.def.id===a&&A.def.subid===c.subid);this.allColumns.push({id:a,subid:c.subid,name:c.name,frameDef:D[a],column:T,checked:!!T})}}),this.allColumns=this.allColumns.sort((a,r)=>(a.name||a.frameDef.title).localeCompare(r.name||r.frameDef.title)),this.refresh()}static \u0275fac=function(n){return new(n||o)};static \u0275cmp=v({type:o,selectors:[["app-dialog-choose-columns"]],standalone:!1,decls:20,vars:5,consts:()=>{let e;return e=$localize`:␟367a4acc6ee5c0c00dafae1ce57a32bed7ed035e␟2271963085536331910:ID3v2 Tag Version`,[e,[1,"choose-version"],[1,"select"],["type","radio","name","release",3,"click","checked"],["target","_blank","rel","noopener",3,"href"],[1,"icon-info"],[1,"columns"],[1,"column"],[1,"title"],["type","checkbox",3,"ngModelChange","change","checked","ngModel"],[1,"id"]]},template:function(n,i){n&1&&(d(0,"form",1)(1,"fieldset")(2,"span"),h(3,0),l(),d(4,"label",2)(5,"input",3),f("click",function(){return i.setVersion(4)}),l(),O(6," 2.4"),l(),d(7,"label",2)(8,"input",3),f("click",function(){return i.setVersion(3)}),l(),O(9," 2.3"),l(),d(10,"label",2)(11,"input",3),f("click",function(){return i.setVersion(2)}),l(),O(12," 2.2"),l(),M(13,"br"),d(14,"a",4),M(15,"i",5),O(16),l()()(),d(17,"div",6),y(18,xn,7,4,"div",7,bn),l()),n&2&&(_(5),E("checked",i.version===4),_(3),E("checked",i.version===3),_(3),E("checked",i.version===2),_(3),E("href",i.urls[i.version],Ge),_(2),X(" ",i.urls[i.version]),_(2),I(i.filteredColumns))},dependencies:[pe,ee,z,ue,V,me],styles:["[_nghost-%COMP%]   .choose-version[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{margin-left:15px}[_nghost-%COMP%]   .choose-version[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{font-size:.8em}[_nghost-%COMP%]   .columns[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap}[_nghost-%COMP%]   .column[_ngcontent-%COMP%]{width:33%;border-top-width:1px;border-top-style:solid;border-bottom-width:0;border-bottom-style:solid;border-color:var(--control-border);padding-top:5px;padding-bottom:5px;padding-right:15px;display:flex;flex-flow:row nowrap;align-items:center;font-size:.8em}[_nghost-%COMP%]   .column[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{color:var(--on-control-hover)}[_nghost-%COMP%]   .column[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.8em;color:var(--on-control)}[_nghost-%COMP%]   .column[_ngcontent-%COMP%]   .id[_ngcontent-%COMP%]{margin-left:auto;width:80px;padding-right:15px;text-align:right;font-size:.8em}[_nghost-%COMP%]   .column[_ngcontent-%COMP%]:last-child{border-bottom-width:1px}@media (max-width: 1400px){[_nghost-%COMP%]   .column[_ngcontent-%COMP%]{width:50%}}@media (max-width: 768px){[_nghost-%COMP%]   .column[_ngcontent-%COMP%]{width:100%}}"]})}return o})();var Ne=(()=>{class o{data;unsubscribe=new Oe;dialogInit(e,n){this.data=n.data,this.data&&(this.data.close=()=>{e.close()}),e.beforeClose().pipe(he(this.unsubscribe)).subscribe(()=>{this.data=void 0})}ngOnDestroy(){this.unsubscribe.next(),this.unsubscribe.complete()}static \u0275fac=function(n){return new(n||o)};static \u0275cmp=v({type:o,selectors:[["app-dialog-match-release"]],standalone:!1,decls:1,vars:1,consts:[[3,"data"]],template:function(n,i){n&1&&M(0,"app-match-release",0),n&2&&E("data",i.data)},encapsulation:2})}return o})();function yn(o,t){if(o&1&&M(0,"img",0),o&2){let e=u();E("src",e.src,Ge)("alt",e.image==null?null:e.image.title)}}var St=(()=>{class o{image;src;ngOnChanges(){this.src=void 0,this.image&&(this.src=`data:${this.image.mimeType||"image/jpeg"};base64,${this.image.base64}`)}static \u0275fac=function(n){return new(n||o)};static \u0275cmp=v({type:o,selectors:[["app-image-base64"]],inputs:{image:"image"},standalone:!1,features:[q],decls:1,vars:1,consts:[[3,"src","alt"]],template:function(n,i){n&1&&g(0,yn,1,2,"img",0),n&2&&C(i.src?0:-1)},styles:["[_nghost-%COMP%]{display:block}[_nghost-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:auto}"]})}return o})();var Dn=(o,t)=>t.image.id;function Ln(o,t){o&1&&M(0,"i",7)}function wn(o,t){if(o&1&&(d(0,"div",12),M(1,"app-image-base64",13),l(),d(2,"div",14)(3,"div",15)(4,"label"),M(5,"input",16),O(6),l()()()),o&2){let e=u().$implicit;_(),E("image",e.base64),_(4),E("checked",e.checked),_(),X(" ",e.image.types)}}function kn(o,t){if(o&1&&(d(0,"div",11),g(1,wn,7,3),l()),o&2){let e=t.$implicit;_(),C(e.base64?1:-1)}}function Gn(o,t){if(o&1&&(d(0,"div",8),M(1,"app-background-text-list",9),d(2,"div",10),y(3,kn,2,1,"div",11,Dn),l()()),o&2){let e=u();_(),E("list",e.images),_(2),I(e.images)}}var ye=(()=>{class o{app;jam;notify;data;isImageSearchRunning=!1;showFrontImagesOnly=!0;images;coverArtArchive;constructor(e,n,i){this.app=e,this.jam=n,this.notify=i}trackByFn(e,n){return n.image.id}ngOnChanges(){this.data?this.loadCoverartImages(this.data).catch(e=>{this.notify.error(e)}):(this.images=void 0,this.coverArtArchive=void 0)}onToggleShowFrontImagesOnly(){if(!this.showFrontImagesOnly&&this.coverArtArchive)for(let e of this.coverArtArchive)!e.base64&&!e.requested&&this.getBase64Image(e).catch(n=>{console.error(n)});this.coverArtArchive&&(this.images=this.coverArtArchive.filter(e=>e.image.front||!this.showFrontImagesOnly))}getChecked(){return this.coverArtArchive?this.coverArtArchive.filter(e=>e.checked&&e.base64):[]}loadImages(e){return R(this,null,function*(){if(e.images){this.coverArtArchive=e.images.map(a=>{if(a.types.length===0&&a.types.push("Other"),a.image&&(a.image=a.image.replace("http:","https:")),a.thumbnails){let c=a.thumbnails;Object.keys(c).forEach(T=>{c[T]=c[T].replace("http:","https:")})}return{image:a,checked:!1}});let n=this.coverArtArchive.filter(a=>a.image.front||a.image.types.includes("Front")).sort((a,r)=>a.image.types.length-r.image.types.length);this.images=this.showFrontImagesOnly?n:this.coverArtArchive,this.images.forEach(a=>{this.getBase64Image(a).catch(r=>{console.error(r)})});let i=n.find(a=>a.image.types.length===1);i||(i=n[0]),i&&(i.checked=!0)}else this.images=void 0,this.coverArtArchive=[]})}loadCoverartImages(e){return R(this,null,function*(){if(e.mbReleaseID){this.isImageSearchRunning=!0;let n=yield this.jam.metadata.coverartarchiveLookup({type:st.release,mbID:e.mbReleaseID});yield this.loadImages(n.data),this.coverArtArchive&&this.coverArtArchive.length===0&&e.mbReleaseGroupID?(this.images=void 0,this.coverArtArchive=void 0,n=yield this.jam.metadata.coverartarchiveLookup({type:st.releaseGroup,mbID:e.mbReleaseGroupID}),yield this.loadImages(n.data),this.isImageSearchRunning=!1):this.isImageSearchRunning=!1}})}getBase64Image(e){return R(this,null,function*(){if(e.requested)return;let n=e.image.thumbnails[500]||e.image.thumbnails.small;e.requested=!0;let i;try{i=yield this.jam.metadata.coverartarchiveImageBinary({url:n})}catch(a){console.error(a)}e.requested=!1,i?e.base64={title:n,mimeType:i.contentType,base64:Bi(i.buffer)}:this.notify.error({error:"Invalid result from https://coverartarchive.org"})})}static \u0275fac=function(n){return new(n||o)(L(Ce),L(ge),L(Ee))};static \u0275cmp=v({type:o,selectors:[["app-match-coverart"]],inputs:{data:"data"},standalone:!1,features:[q],decls:10,vars:4,consts:()=>{let e;e=$localize`:␟2f1af3c61d7c0984f04ef0e8c4838aa7e6d90d93␟6069974144025121503:Front only`;let n;return n=$localize`:␟2689f5742c952b88d105a84ff9e924d15e269dba␟2840633634490107011:Coverart`,[e,n,[1,"match-album-images"],[1,"front-only-choice"],["type","checkbox",3,"ngModelChange","change","checked","ngModel"],[1,"section"],["href","https://coverartarchive.org/","rel","noopener","target","_blank"],[1,"icon-spin","icon-spinner"],[1,"match-images"],["name","Images",3,"list"],[1,"media-cards"],[1,"media-card","no-hover"],[1,"image"],[3,"image"],[1,"footer"],[1,"footer-content"],["type","checkbox",3,"checked"]]},template:function(n,i){n&1&&(d(0,"div",2)(1,"label",3)(2,"input",4),G("ngModelChange",function(r){return k(i.showFrontImagesOnly,r)||(i.showFrontImagesOnly=r),r}),f("change",function(){return i.onToggleShowFrontImagesOnly()}),l(),$(3),h(4,0),F(),l(),d(5,"div",5)(6,"a",6),h(7,1),l()(),g(8,Ln,1,0,"i",7),g(9,Gn,5,1,"div",8),l()),n&2&&(_(2),E("checked",i.showFrontImagesOnly),w("ngModel",i.showFrontImagesOnly),_(6),C(i.isImageSearchRunning?8:-1),_(),C(i.images&&!i.isImageSearchRunning?9:-1))},dependencies:[Oi,ee,z,V,St],styles:["[_nghost-%COMP%]{padding-top:15px}[_nghost-%COMP%]   .section[_ngcontent-%COMP%]{color:var(--on-background-highlight);text-transform:uppercase;padding-bottom:10px;white-space:nowrap}[_nghost-%COMP%]   .section[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--on-background-highlight)}[_nghost-%COMP%]   .section[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:var(--on-background)}[_nghost-%COMP%]   .front-only-choice[_ngcontent-%COMP%]{float:right;font-size:.8em}[_nghost-%COMP%]   .match-images[_ngcontent-%COMP%]{min-height:200px;display:flex;flex-flow:row wrap}@media (max-width: 768px){[_nghost-%COMP%]   .match-images[_ngcontent-%COMP%]{justify-content:space-around}}[_nghost-%COMP%]   .match-images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{max-width:200px;max-height:200px}"]})}return o})();var Je=["2 Tone","2-Step Garage","4-Beat","A Cappella","Abstract","Acid","Acid Breaks","Acid House","Acid Jazz","Acid Punk","Acid Rock","Acid Techno","Acid Trance","Acousmatic Music","Acoustic","Adult Contemporary","African","African Blues","African Heavy Metal","African Hip Hop","Afro / Cosmic Disco","Afro-Cuban Jazz","Afrobeat","Aggrotech","Alternative","Alternative Country","Alternative Dance","Alternative Hip Hop","Alternative Metal","Alternative Rock","Ambient","Ambient Dub","Ambient House","American Folk Revival","Americana","Anarcho Punk","Anime","Anti-folk","Apala","Arab Pop","Art Punk","Art Rock","Asian","Asian American Jazz","Asian Underground","Atlanta Hip Hop","Audio Theatre","Audiobook","Australian Country Music","Australian Hip Hop","AustroPop","Avant-garde","Avant-garde Jazz","Avant-garde Metal","Avantgarde","Ax\xE9","Bachata","Background Music","Baila","Baithak Gana","Bakersfield sound","Balearic Beat","Balearic Trance","Ballad","Baltimore Club","Banda","Baroque","Baroque Pop","Bass","Bassline","Baul","Beat","Beat Music","Beautiful Music","Bebop","Benga","Berlin School","Bhangra","Big Band","Big Beat","Big Room","Bikutsi","BitPop","Black Metal","Blue-Eyed Soul","Bluegrass","Blues","Blues Country","Blues Rock","Blues Shouter","Bolero","Bongo Flava","Boogie","Boogie-Woogie","Booty Bass","Bossa Nova","Bounce Music","Bouncy House","Bouncy Techno","Bouyon","Brazilian","Brazilian Rock","Breakbeat","Breakbeat Hardcore","Breakcore","Breakstep","Brega","Brick City club","Brill Building","British Blues","British Dance Band","British Folk revival","British Hip Hop","BritPop","Broken Beat","Brostep","Bubblegum Dance","Bubblegum Pop","Bullerengue","C-Pop","Cabaret","Cadence-lypso","Cajun","Cajun fiddle tunes","Calypso","Canadian Blues","Canci\xF3n","Canterbury scene","Canzone","Cape Jazz","Caribbean","Celtic","Celtic Metal","Celtic Music","Celtic Punk","Cha Cha Cha","Chalga","Chamber Jazz","Chamber Music","Chanson","Chap Hop","Chicago Blues","Chicago Hip Hop","Chicago House","Chicano Rap","Chicha","Chill-out","Chillout","Chillstep","Chillwave","Chimurenga","Chinese Rock","Chiptune","Chopped & Screwed","Choro","Chorus","Christian Country Music","Christian Gangsta Rap","Christian Hip Hop","Christian Metal","Christian Pop","Christian Punk","Christian Rap","Christian Rock","Chutney","Chutney soca","Classic Country","Classic female Blues","Classic Rock","Classical","Classical crossover","Close harmony","Club","Club-House","Coldwave","Comedy","Compas","Complextro","Congolese rumba","Conscious Hip Hop","Contemporary Christian","Contemporary Folk","Contemporary R&B","Continental Jazz","Cool Jazz","Country","Country Blues","Country Pop","Country Rap","Country Rock","Country-Rap","Coup\xE9-D\xE9cal\xE9","Western Music","CowPunk","Criolla","Crossover","Crossover Jazz","Crossover Thrash","Crunk","Crunkcore","Crust Punk","Crustgrind","Cult","Cumbia","Cumbia Rap","Cybergrind","D-beat","Dance","Dance Hall","Dance-Pop","Dance-Punk","Dance-Rock","Dancehall","Dancehall Music","Dangdut","Dansband Music","Dark Ambient","Dark Cabaret","Dark Electro","Dark Wave","Darkcore","Darkcore jungle","Darkstep","Darkwave","Death 'n' roll","Death industrial","Death Metal","Death-Doom","Deathcore","DeathRock","Deep Funk","Deep House","Delta Blues","Desert Rock","Detroit Blues","Detroit Hip Hop","Detroit Techno","Digital hardcore","Disco","Disco polo","Diva House","Dixieland","Djent","Doom Metal","Doomcore","Downtempo","Dream","Dream Pop","Dream Trance","Drill","Drill & Bass","Drone Metal","Drone Music","Drum & Bass","Drum Solo","Drumstep","Dub","Dub Techno","Dubstep","Dubstyle","Dubtronica","Duet","Dunedin Sound","Dutch House","East Coast Hip Hop","Easy Listening","EBM","Eclectic","Electric Blues","Electro","Electro House","Electro Music","Electro Swing","Electro-Industrial","Electroacoustic","Electroacoustic Music","Electroclash","Electronic","Electronic Body Music","Electronic Rock","Electronica","Electronicore","ElectroPop","ElectroPunk","Elevator Music","Emo","Ethereal Wave","Ethnic","Ethnic electronica","Ethno Jazz","Euro Disco","Euro-House","Euro-Techno","Eurobeat","Eurodance","European free Jazz","EuroPop","Experimental","Experimental Hip Hop","Experimental Music","Experimental Rock","Fado","Fann at-Tanbura","Fast Fusion","Fidget House","Fijiri","Filk Music","Filmi","Flamenco","Florida Breaks","Folk","Folk Metal","Folk Pop","Folk Punk","Folk Rock","Folk-Rock","Folklore","Folktronica","Forr\xF3","Franco-Country","Freak Folk","Freakbeat","Free Funk","Free Improvisation","Free Jazz","Free Tekno","Freestyle","Freestyle Music","Freestyle Rap","French House","French Pop","Frevo","Fuji Music","Full On","Funk","Funk Carioca","Funk Metal","Funkstep","Funktronica","Funky House","Furniture Music","Fusion","Future Garage","Future House","FuturePop","G-Funk","Gabba","Game","Game Boy Music","Gamelan","Gangsta Rap","Garage","Garage House","Garage Punk","Garage Rock","Genge","Ghetto House","Ghettotech","Glam Metal","Glam Rock","Glitch","Glitch Hop","Global","Go-go","Goa","Goa Trance","Golden Age Hip Hop","Goregrind","Gospel","Gospel Blues","Gothic","Gothic Metal","Gothic Rock","Grime","Grindcore","Grindie","Groove Metal","Grunge","Grupera","Guajira","Gypsy Jazz","Gypsy Punk","Happy Hardcore","Hard Bop","Hard House","Hard NRG","Hard Rock","Hard Trance","Hardbag","Hardcore","Hardcore Rap","Hardcore Hip Hop","Hardcore Punk","Hardstep","Hardstyle","Heavy Metal","Hellbilly Music","Hi-NRG","Highlife","Hill Country Blues","Hip Hop","Hip Hop Soul","Hip House","Hip Pop","Hip Hop","Hiplife","Hokum","Hokum Blues","Honky Tonk","Horror Punk","Horrorcore","House","House Music","Houston Hip Hop","Huayno","Humour","Hyphy","IDM","Igbo highlife","Igbo Rap","Illbient","Indian Pop","Indie","Indie Folk","Indie Pop","Indie Rock","Indietronica","Industrial","Industrial Folk","Industrial Hip Hop","Industrial Metal","Industrial Music","Industrial Rock","Industro-Goth","Instrumental","Instrumental Country","Instrumental Hip Hop","Instrumental Pop","Instrumental Rock","Iranian Pop","Isicathamiya","Isolationism","Italo Dance","Italo Disco","Italo House","J-Pop","Jam Band","Jangle Pop","Japanoise","Jazz","Jazz Blues","Jazz Fusion","Jazz House","Jazz Rap","Jazz Rock","Jazz-Funk","Jazz+Funk","Jerkin'","Jersey Club","Jit","JPop","J\xF9j\xFA","Jump Blues","Jump-up","Jumpstyle","Jungle","K-Pop","Kadongo Kamu","Kansas City Blues","Kansas City Jazz","Kapuka","Keroncong","Khaliji","Kizomba","Krautrock","Kuduro","Kwaito","Kwassa Kwassa","Kwela","La\xEFk\xF3","Lambada","Laptronica","Latin","Latin alternative","Latin ballad","Latin Christian","Latin House","Latin Jazz","Latin Metal","Latin Pop","Latin Rock","Latin Swing","Lavani","Leftfield","Lento Violento","Liquid Dubstep","Liquid Funk","Livetronica","Liwa","Lo-fi","Lo-Fi","Louisiana Blues","Louisiana Swamp Pop","Lounge","Lounge Music","Lovers Rock","Low Bap","Lowercase","Luk Krung","Luk Thung","Lyrical Hip Hop","M-Base","Mafioso Rap","Mainstream Jazz","M\xE1kina","Makossa","Maloya","Mambo","MandoPop","Manila Sound","Maracatu","Mariachi","Marrabenta","Math Rock","Mathcore","Mbalax","Mbaqanga","Mbube","Medieval Metal","Meditative","Melbourne Bounce","Melodic Death Metal","Melodic Metalcore","Memphis Blues","Merengue","MerenRap","M\xE9ringue","Metal","Metalcore","Mexican Pop","Mexican Son","Miami Bass","Microhouse","Middle of the road","Midwest Hip Hop","Minimal Techno","Minimal Wave","Modal Jazz","Moombahcore","Moombahton","Morlam","Morna","Mosambique","Motswako","M\xFAsica Criolla","M\xFAsica Popular Brasileira","M\xFAsica Sertaneja","Musical","Musique Concr\xE8te","Nagoya Kei","Nashville Sound","National Folk","Native American","NDW","Ndombolo","NederPop","Neo Soul","Neo-Bop Jazz","Neo-Psychedelia","Neo-Swing","Neoclassical","Neoclassical Metal","Neofolk","Neotraditional Country","Nerdcore","Neue Deutsche Welle","NeuroFunk","Neurohop","New Age","New Beat","New jack swing","New Jersey Hip Hop","New Prog","New Rave","New Romantic","New Romanticism","New School Hip Hop","New Wave","New-age Music","Nintendocore","Nitzhonot","No wave","Noise","Noise Rock","Noisegrind","Nortec","Norte\xF1o","Northern Soul","Novelty Ragtime","Nu Jazz","Nu Metal","Nu Skool Breaks","Nu-Breakz","Nu-Disco","Nu-Funk","Nu-Gaze","Nu-NRG","Nueva canci\xF3n","Old School Hip Hop","Oldies","Opera","Operatic Pop","Orchestral Jazz","Original Pilipino Music","Other","Outlaw Country","Outsider House","P-Funk","Pagan Metal","Pagode","Paisley Underground","Palm-wine","Piedmont Blues","Pinoy Pop","Podcast","Political Hip Hop","Polka","Polsk Punk","Pop","Pop Punk","Pop Rap","Pop Rock","Pop Soul","Pop Sunda","Pop-Folk","Pop-Funk","Porn Groove","Porro","Post-Bop","Post-Disco","Post-Grunge","Post-Hardcore","Post-Metal","Post-Punk","Post-Punk Revival","Post-Rock","Power Ballad","Power Electronics","Power Metal","Power Noise","Power Pop","Powerviolence","Pranks","Primus","Progressive Bluegrass","Progressive Country","Progressive Folk","Progressive House","Progressive Metal","Progressive Pop","Progressive Rock","Progressive Trance","Protest Song","Psybient","Psychedelic","Psychedelic Folk","Psychedelic Pop","Psychedelic Rock","Psychedelic Trance","Psychobilly","Punkabilly","Psytrance","Punk","Punk Blues","Punk Jazz","Punk Rock","Punta","Punta Rock","R&B","Raga Rock","Ragga","Ragga Jungle","Raggacore","Ragini","Ragtime","Ra\xEF","Ranchera","Rap","Rap Metal","Rap Music","Rap Opera","Rap Rock","Rapcore","Rara tech","Rasin","Rave","Reactionary Bluegrass","Rebetiko","Red Dirt","Reggae","Reggae Espa\xF1ol","Spanish Reggae","Reggae Fusion","Reggaestep","Reggaeton","Regional Mexican","Retro","Revival","Rhythm & Blues","Rhythmic Soul","Riot grrrl","Rock","Rock & Roll","Rock en Espa\xF1ol","Rock in Opposition","Rockabilly","Rocksteady","Rumba","Russian Pop","Sadcore","Sakara","Salsa","Salsa rom\xE1ntica","Samba","Samba Rock","Sambass","Satire","Sawt","Schlager","Screamo","Sega","Seggae","Semba","Sertanejo","Shangaan electro","Shibuya-kei","Shoegaze","Showtunes","Singer-songwriter","Ska","Ska Jazz","Ska Punk","Skate Punk","Skiffle","Skweee","Slow Jam","Slow Rock","Slowcore","Sludge Metal","Smooth Jazz","Snap Music","Soca","Soft Rock","Son","Son Cubano","Sonata","Songo","Songo-Salsa","Sophisti-Pop","Soukous","Soul","Soul Blues","Soul Jazz","Sound Clip","Soundtrack","Southern Hip Hop","Southern Rock","Southern Soul","Space","Space Age Pop","Space Disco","Space Music","Space Rock","Speech","Speed garage","Speed Metal","Speedcore","St.Louis Blues","St.Louis Hip Hop","Stoner Rock","Straight-ahead Jazz","Street Punk","Stride Jazz","Sufi Rock","SungPoetry","Sunshine Pop","Suomisaundi","Surf Pop","Surf Rock","Swamp Blues","Swing","Symphonic black Metal","Symphonic Metal","Symphonic Rock","Symphony","Synthpop","SynthPop","Synthwave","Taarab","Tango","Tech House","Tech Trance","Techdombe","Technical death Metal","Techno","Techno-Industrial","Techstep","Tecno Brega","Tecnobrega","Teen Pop","Tejano","Terror","Texas Blues","Texas Country","Thai Pop","Third stream","Thrash Metal","Thrashcore","Timba","Top 40","Trad Jazz","Traditional Country Music","Traditional Pop Music","Trailer","Trance","Trance Music","TRap","TRapstep","Tribal","Tribal House","Trip hop","Trip-Hop","Trival","Trop Rock","Tropical","Tropical House","Tropicalia","TropiPop","Truck-driving Country","Turkish Pop","Turntablism","Twin Cities Hip Hop","Twoubadou","UK Funky","UK Garage","UK Hardcore","Unblack Metal","Underground Hip Hop","Uplifting Trance","Urban Pasifika","V-Pop","Vallenato","Vaporwave","Video game Music","Viking Metal","VisPop","Visual Kei","Vocal","Vocal Jazz","Vocal Trance","War Metal","Weltmusik","West Coast Blues","West Coast Hip Hop","West Coast Jazz","Western swing","Witch House","Wonky","Wonky Pop","World Fusion","World Music","Worldbeat","Zouglou","Zouk","Zouk-Lambada","Zydeco"];var Ye;function Fi(o){return o.replace(/[& \-.]/g,"").toLowerCase()}function Rt(o){let t=Fi(o);return Ye||(Ye={},Je.forEach(e=>{Ye[Fi(e)]=e})),Ye[t]}function Qe(o,t){let e=o.slice(0);for(let n of t){let i=e.find(a=>a.name===n.name);i?i.count+=n.count:e.push(n)}return e}function Xi(o){if(!o||!o.length)return[];let t=[];for(let e of o){let n=e.name.split("/").map(i=>i.trim()).filter(i=>i.length>0);for(let i of n){let a=Rt(i);if(a){let r=t.find(c=>c.name===a);r?r.count+=e.count:t.push({name:a,count:e.count})}}}return t.sort((e,n)=>n.count-e.count)}function Ui(o){if(!o||!o.length)return[];let t=[];for(let e of o){let n=e.name.split(";").map(i=>i.trim()).filter(i=>i.length>0);for(let i of n){let a=Rt(i);if(a){let r=t.find(c=>c.name===a);r?r.count+=e.count:t.push({name:a,count:e.count})}}}return t.sort((e,n)=>n.count-e.count)}function Hi(o){if(!o)return[];let t=[];for(let e of o){let n=Rt(e.name);if(n){let i=t.find(a=>a.name===n);i?i.count+=1:t.push({name:n,count:1})}}return t}function zi(o){return o.tags?Hi(o.tags):[]}function Vi(o){return o?Hi(o.tags):[]}function $n(o,t){o&1&&M(0,"i",6)}function Fn(o,t){if(o&1){let e=P();d(0,"label",10)(1,"input",12),G("ngModelChange",function(i){let a=m(e).$implicit;return k(a.checked,i)||(a.checked=i),p(i)}),l(),O(2),l()}if(o&2){let e=t.$implicit;E("title",Be("Usage Count: ",e.tag.count)),_(),w("ngModel",e.checked),_(),ei(" ",e.tag.name," [",e.tag.count,"] ")}}function Xn(o,t){if(o&1){let e=P();y(0,Fn,3,5,"label",10,J),d(2,"label",11)(3,"input",12),G("ngModelChange",function(i){m(e);let a=u();return k(a.customGenre.checked,i)||(a.customGenre.checked=i),p(i)}),l(),d(4,"input",13),G("ngModelChange",function(i){m(e);let a=u();return k(a.customGenre.text,i)||(a.customGenre.text=i),p(i)}),l()()}if(o&2){let e=u();I(e.genres),_(3),w("ngModel",e.customGenre.checked),_(),w("ngModel",e.customGenre.text)}}function Un(o,t){if(o&1&&M(0,"app-match-coverart",7),o&2){let e=u();E("data",e.coverArtSearch)}}var Ie=(()=>{class o{app;jam;isRunning=!1;loadLyricsRequest=new j;loadMoodsRequest=new j;coverArt;isGenreSearchRunning=!1;genres;customGenre={text:"",checked:!0};coverArtSearch;constructor(e,n){this.app=e,this.jam=n}getGenres(){let e=(this.genres||[]).filter(n=>n.checked).map(n=>n.tag.name);return this.customGenre.checked&&this.customGenre.text.trim().length>0&&e.push(this.customGenre.text.trim()),e}getCoverArtImages(){return this.coverArt?this.coverArt.getChecked():[]}loadGenres(e,n,i){return R(this,null,function*(){this.isGenreSearchRunning=!0;let a=[];n.mbGroup.secondaryTypes&&n.mbGroup.secondaryTypes.find(A=>["audiobook","audio drama","spokenword"].includes(A))&&a.push({count:1,name:"Audiobook"});for(let A of e)if(A.track.tag?.genres&&A.track.tag.genres.length>0){let S=A.track.tag.genres[0],N=a.find(x=>x.name===S);N?N.count++:a.push({count:1,name:S})}let r=Xi(a),c=[];i.mbRelease.tags&&(c=c.concat(i.mbRelease.tags)),n.mbGroup.tags&&(c=c.concat(n.mbGroup.tags)),r=Qe(r,Ui(c));let T=(yield this.jam.metadata.lastfmLookup({type:rt.album,mbID:i.mbRelease.id})).data;if(T.album&&(r=Qe(r,zi(T.album))),r.length===0&&i.mbRelease.artistCredit.length>0){let A=(yield this.jam.metadata.lastfmLookup({type:rt.artist,mbID:i.mbRelease.artistCredit[0].artist.id})).data;A&&A.artist&&(r=Qe(r,Vi(A.artist)))}this.genres=r.sort((A,S)=>S.count-A.count).map((A,S)=>({tag:A,checked:S===0})),this.isGenreSearchRunning=!1})}static \u0275fac=function(n){return new(n||o)(L(Ce),L(ge))};static \u0275cmp=v({type:o,selectors:[["app-match-apply"]],viewQuery:function(n,i){if(n&1&&Y(ye,5),n&2){let a;Q(a=Z())&&(i.coverArt=a.first)}},inputs:{isRunning:"isRunning"},outputs:{loadLyricsRequest:"loadLyricsRequest",loadMoodsRequest:"loadMoodsRequest"},standalone:!1,decls:14,vars:7,consts:()=>{let e;e=$localize`:␟33c750c68c3e29d7fee57a180f508d8d202bdd04␟1790640569414740156:Genres`;let n;n=$localize`:␟ac0f81713a84217c9bd1d9bb460245d8190b073f␟5937251202465808296:More`;let i;i=$localize`:␟64573fe39daeccde26bea87757731f84dbbb1e20␟8931780837517904129:Load Lyrics`;let a;return a=$localize`:␟fcc14666a1cf83864f70059f03a0a3855d901235␟896097993346243998:Load AcousticBrainz Moods`,[e,n,i,a,[1,"match-apply"],[1,"section"],[1,"icon-spin","icon-spinner"],[3,"data"],[1,"match-track-moods"],[1,"button-on-background",3,"click"],[1,"select",3,"title"],[1,"select"],["type","checkbox",3,"ngModelChange","ngModel"],["type","text",3,"ngModelChange","ngModel"]]},template:function(n,i){n&1&&(d(0,"div",4)(1,"div")(2,"div",5),h(3,0),l(),g(4,$n,1,0,"i",6),g(5,Xn,5,2),l(),g(6,Un,1,1,"app-match-coverart",7),d(7,"div",8)(8,"div",5),h(9,1),l(),d(10,"button",9),f("click",function(){return i.loadLyricsRequest.emit()}),h(11,2),l(),d(12,"button",9),f("click",function(){return i.loadMoodsRequest.emit()}),h(13,3),l()()()),n&2&&(_(4),C(i.isGenreSearchRunning?4:-1),_(),C(i.genres&&!i.isGenreSearchRunning?5:-1),_(),C(i.coverArtSearch?6:-1),_(4),oe("disabled",!i.isRunning),_(2),oe("disabled",!i.isRunning))},dependencies:[_e,ee,z,V,ye],styles:["[_nghost-%COMP%]   .match-apply[_ngcontent-%COMP%]{flex:1 1 auto;overflow-y:auto;overflow-x:auto;padding:15px}[_nghost-%COMP%]   .match-apply[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{padding-bottom:10px}[_nghost-%COMP%]   .match-apply[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{padding-right:4px;font-size:.9em;text-transform:uppercase}[_nghost-%COMP%]   .match-apply[_ngcontent-%COMP%]   .select[_ngcontent-%COMP%]{padding-top:2px;padding-bottom:2px;display:block;font-size:.9em}[_nghost-%COMP%]   .match-apply[_ngcontent-%COMP%]   .select[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{margin-right:4px}[_nghost-%COMP%]   .match-apply[_ngcontent-%COMP%]   .select[_ngcontent-%COMP%]:hover{background-color:var(--background-hover)}[_nghost-%COMP%]   .section[_ngcontent-%COMP%]{color:var(--on-background-highlight);text-transform:uppercase;padding-bottom:10px;white-space:nowrap}[_nghost-%COMP%]   app-match-coverart[_ngcontent-%COMP%]{border-top:1px solid var(--background-border)}[_nghost-%COMP%]   .match-track-moods[_ngcontent-%COMP%]{border-top:1px solid var(--background-border);padding-top:15px}"]})}return o})();var vt=class{frameValues={};build(){return this.frameValues}text(t,e){if(e){let n={id:t,value:{text:e}};this.frameValues[t]=[n]}return this}idText(t,e,n){if(n){let i={id:t,value:{id:e,text:n}},a=(this.frameValues[t]||[]).filter(r=>r.value.id!==e);this.frameValues[t]=a.concat([i])}return this}nrAndTotal(t,e,n){if(e){let i=e.toString()+(n?`/${n.toString()}`:""),a={id:t,value:{text:i}};this.frameValues[t]=[a]}return this}keyTextList(t,e,n){if(n){let i=this.frameValues[t]||[],a=i.length>0?i[0]:{id:t,value:{list:[]}};a.value.list.push(e),a.value.list.push(n),this.frameValues[t]=[a]}return this}bool(t,e){if(e!==void 0){let n={id:t,value:{bool:e}};this.frameValues[t]=[n]}return this}idLangText(t,e,n,i){if(e){let a=i||"",r=(this.frameValues[t]||[]).filter(T=>T.value.id!==a),c={id:t,value:{id:a,language:n||"",text:e}};this.frameValues[t]=r.concat([c])}return this}addPicture(t,e,n,i,a){let r={id:t,value:{description:n||"",pictureType:e,bin:a,mimeType:i}};return this.frameValues[t]=(this.frameValues[t]||[]).concat([r]),this}addChapter(t,e,n,i,a,r,c){let T={id:t,value:{id:e,start:n,end:i,offset:a,offsetEnd:r},subframes:c};return this.frameValues[t]=(this.frameValues[t]||[]).concat([T]),this}},Ze=class{rawBuilder=new vt;buildFrames(){return this.rawBuilder.build()}artist(t){return this.rawBuilder.text("TPE1",t),this}artistSort(t){return this.rawBuilder.text("TSOP",t),this}albumArtist(t){return this.rawBuilder.text("TPE2",t),this}albumArtistSort(t){return this.rawBuilder.text("TSO2",t),this}album(t){return this.rawBuilder.text("TALB",t),this}albumSort(t){return this.rawBuilder.text("TSOA",t),this}originalAlbum(t){return this.rawBuilder.text("TOAL",t),this}originalArtist(t){return this.rawBuilder.text("TOPE",t),this}originalDate(t){return this.rawBuilder.text("TDOR",t),this}title(t){return this.rawBuilder.text("TIT2",t),this}work(t){return this.rawBuilder.text("TIT1",t),this}titleSort(t){return this.rawBuilder.text("TSOT",t),this}genre(t){return this.rawBuilder.text("TCON",t),this}bmp(t){return this.rawBuilder.text("TBPM",t?t.toString():void 0),this}mood(t){return this.rawBuilder.text("TMOO",t),this}media(t){return this.rawBuilder.text("TMED",t),this}language(t){return this.rawBuilder.text("TLAN",t),this}grouping(t){return this.rawBuilder.text("GRP1",t),this}date(t){return this.rawBuilder.text("TDRC",t),this}track(t,e){return this.rawBuilder.nrAndTotal("TRCK",t,e),this}disc(t,e){return this.rawBuilder.nrAndTotal("TPOS",t,e),this}year(t){return this.rawBuilder.text("TORY",t?t.toString():void 0),this}artists(t){return this.rawBuilder.idText("TXXX","Artists",t),this}isCompilation(t){return t!==void 0&&this.rawBuilder.bool("TCMP",t===1||t==="true"||t===!0),this}originalYear(t){return this.rawBuilder.text("TYER",t),this}composer(t){return this.rawBuilder.text("TCOM",t),this}composerSort(t){return this.rawBuilder.text("TSOC",t),this}remixer(t){return this.rawBuilder.text("TPE4",t),this}label(t){return this.rawBuilder.text("TPUB",t),this}subtitle(t){return this.rawBuilder.text("TIT3",t),this}discSubtitle(t){return this.rawBuilder.text("TSST",t),this}lyricist(t){return this.rawBuilder.text("TEXT",t),this}lyrics(t,e,n){return this.rawBuilder.idLangText("USLT",t,e,n),this}encoder(t){return this.rawBuilder.text("TENC",t),this}encoderSettings(t){return this.rawBuilder.text("TSSE",t),this}key(t){return this.rawBuilder.text("TKEY",t),this}copyright(t){return this.rawBuilder.text("TCOP",t),this}isrc(t){return this.rawBuilder.text("TSRC",t),this}barcode(t){return this.rawBuilder.idText("TXXX","BARCODE",t),this}asin(t){return this.rawBuilder.idText("TXXX","ASIN",t),this}catalogNumber(t){return this.rawBuilder.idText("TXXX","CATALOGNUMBER",t),this}script(t){return this.rawBuilder.idText("TXXX","SCRIPT",t),this}license(t){return this.rawBuilder.idText("TXXX","LICENSE",t),this}website(t){return this.rawBuilder.text("WOAR",t),this}movement(t){return this.rawBuilder.text("MVNM",t),this}movementNr(t,e){return this.rawBuilder.nrAndTotal("MVIN",t,e),this}writer(t){return this.rawBuilder.idText("TXXX","Writer",t),this}custom(t,e){return this.rawBuilder.idText("TXXX","VERSION",e),this}musicianCredit(t,e){return this.rawBuilder.keyTextList("TMCL",t,e),this}involved(t,e){return this.rawBuilder.keyTextList("TIPL",t,e),this}discogsArtistID(t){return this.rawBuilder.idText("TXXX","Discogs Artist ID",t),this}discogsAlbumArtistID(t){return this.rawBuilder.idText("TXXX","Discogs Album Artist ID",t),this}discogsLabelID(t){return this.rawBuilder.idText("TXXX","Discogs Label ID",t),this}discogsMasterReleaseID(t){return this.rawBuilder.idText("TXXX","Discogs Master Release ID",t),this}discogsReleaseID(t){return this.rawBuilder.idText("TXXX","Discogs Release ID",t),this}discogsVotes(t){return this.rawBuilder.idText("TXXX","Discogs Votes",t),this}discogsRating(t){return this.rawBuilder.idText("TXXX","Discogs Rating",t),this}mbAlbumStatus(t){return this.rawBuilder.idText("TXXX","MusicBrainz Album Status",t),this}mbAlbumType(t){return this.rawBuilder.idText("TXXX","MusicBrainz Album Type",t),this}mbAlbumReleaseCountry(t){return this.rawBuilder.idText("TXXX","MusicBrainz Album Release Country",t),this}mbTrackID(t){return this.rawBuilder.idText("UFID","http://musicbrainz.org",t),this}mbReleaseTrackID(t){return this.rawBuilder.idText("TXXX","MusicBrainz Release Track Id",t),this}mbAlbumID(t){return this.rawBuilder.idText("TXXX","MusicBrainz Album Id",t),this}mbOriginalAlbumID(t){return this.rawBuilder.idText("TXXX","MusicBrainz Original Album Id",t),this}mbArtistID(t){return this.rawBuilder.idText("TXXX","MusicBrainz Artist Id",t),this}mbOriginalArtistID(t){return this.rawBuilder.idText("TXXX","MusicBrainz Original Artist Id",t),this}mbAlbumArtistID(t){return this.rawBuilder.idText("TXXX","MusicBrainz Album Artist Id",t),this}mbReleaseGroupID(t){return this.rawBuilder.idText("TXXX","MusicBrainz Release Group Id",t),this}mbWorkID(t){return this.rawBuilder.idText("TXXX","MusicBrainz Work Id",t),this}mbTRMID(t){return this.rawBuilder.idText("TXXX","MusicBrainz TRM Id",t),this}mbDiscID(t){return this.rawBuilder.idText("TXXX","MusicBrainz Disc Id",t),this}acoustidID(t){return this.rawBuilder.idText("TXXX","Acoustid Id",t),this}acoustidFingerprint(t){return this.rawBuilder.idText("TXXX","Acoustid Fingerprint",t),this}musicIPPUID(t){return this.rawBuilder.idText("TXXX","MusicIP PUID",t),this}comment(t,e){return this.rawBuilder.idText("COMM",t,e),this}trackLength(t){return this.rawBuilder.text("TLEN",t?t.toString():void 0),this}mbTrackDisambiguation(t){return this.rawBuilder.idText("TXXX","MusicBrainz Track Disambiguation",t),this}addPicture(t,e,n,i){return this.rawBuilder.addPicture("APIC",t,e,n,i),this}chapter(t,e,n,i,a,r){return this.rawBuilder.addChapter("CHAP",t,e,n,i,a,r),this}};function zn(o,t,e){if(e&&e.length>0)o.genre(e.slice(0,2).join("/"));else if(t.track.tagRaw){let n=t.track.tagRaw.frames.TCON;if(n){let i=n.map(a=>a.value.text);o.genre(i.slice(0,2).join("/"))}}}function Vn(o,t,e,n,i,a){o.mbTrackID(e.recording?.id).date(n?.date).originalDate(i?.firstReleaseDate).album(n?.title).albumSort(n?.sortName).title(e.title).media(a?.format).track(e.position,a?.trackCount).disc(a?.position,n?.media.length).trackLength(e.length).language(n?.textRepresentation.language).script(n?.textRepresentation.script).barcode(n?.barcode).isrc(e.recording?.isrcs&&e.recording.isrcs.length>0?e.recording.isrcs[0]:void 0).mbAlbumStatus(n?.status?n.status.toLowerCase():void 0).mbAlbumReleaseCountry(n?.country).mbAlbumID(n?.id).mbReleaseTrackID(e.id).mbReleaseGroupID(n?.releaseGroup.id).mbTrackDisambiguation(e.recording?.disambiguation).asin(n?.asin).discSubtitle(a?.title),e.recording?.aliases&&e.recording.aliases.length>0&&e.recording.aliases[0].sortName&&e.recording.aliases[0].sortName!==e.title&&o.titleSort(e.recording.aliases[0].sortName);let r=n?.artistCredit[0];if(r&&o.albumArtist(r.name).albumArtistSort(r.artist.sortName).mbAlbumArtistID(r.artist.id),e.artistCredit&&e.artistCredit.length>0){let T=e.artistCredit.map(S=>`${S.artist.name} ${S.joinphrase}`).join(" ").replace(/ {2}/g," ").trim(),A=e.artistCredit.map(S=>(S.artist.sortName?S.artist.sortName:"").trim()).filter(S=>S.length>0).join(" & ").replace(/ {2}/g," ").trim();o.artist(T).artistSort(A).mbArtistID(e.artistCredit[0].artist.id)}else r&&o.artist(r.name).artistSort(r.artist.sortName).mbArtistID(r.artist.id);let c=n?.labelInfo[0];c&&(c.label&&o.label(c.label.name),o.catalogNumber(c.catalogNumber))}function Wn(o,t,e,n){let i=[];n?.releaseGroup.primaryType&&i.push(n.releaseGroup.primaryType),n?.releaseGroup.secondaryTypes&&(i=i.concat(n.releaseGroup.secondaryTypes)),i.length>0&&o.mbAlbumType(i.map(a=>a.toLowerCase()).join("/")),i.includes("compilation")&&o.isCompilation(!0)}function jn(o,t,e){if(e&&e.length>0)for(let n of e){let i=0;n.image.types.includes("Medium")?i=6:n.image.types.includes("Booklet")?i=5:n.image.types.includes("Front")?i=3:n.image.types.includes("Back")&&(i=4),n.base64&&o.addPicture(i,"",n.base64.mimeType,n.base64.base64)}else if(t.track.tagRaw){let n=t.track.tagRaw.frames.APIC;if(n)for(let i of n)o.addPicture(i.value.pictureType,i.value.description,i.value.mimeType,i.value.bin)}}function qn(o,t){t.abdata?.moods&&t.abdata.moods.length>0&&o.mood(t.abdata.moods.join("/"))}function Kn(o,t,e){if(t.acoustidEntries&&e.recording?.id){let n=t.acoustidEntries.find(i=>i.recordingID===e.recording?.id);n&&o.acoustidID(n.acoustID)}}function Wi(o,t,e){if(!o.mbTrack)return;let n=o.mbTrack,i=o.mbRelease,a=o.mbGroup,r=o.mbMedia,c=new Ze;return Vn(c,o,n,i,a,r),Wn(c,o,n,i),zn(c,o,t),jn(c,o,e),qn(c,o),Kn(c,o,n),o.lyrics&&c.lyrics(o.lyrics.lyrics),{version:4,frames:c.buildFrames()}}function ji(o,t){let e=[];if(o){for(let n of o)if(n.recordings){for(let i of n.recordings)if(i.releasegroups&&i.id){for(let a of i.releasegroups)if(a.id&&a.releases){for(let r of a.releases)if(r.id&&r.mediums)for(let c of r.mediums){let T={releaseGroupID:a.id,releaseGroupName:a.title,releaseID:r.id,releaseName:r.title,mediaNr:c.position,mediaTrackCount:c.track_count,recordingID:i.id,recordingName:i.title,recordingDuration:i.duration,trackID:t.id,trackName:t.name,trackDuration:t.duration,score:n.score,acoustID:n.id};e.push(T)}}}}}return e}var et=class{releasegroups=[];add(t){let e=this.releasegroups.find(c=>c.id===t.releaseGroupID);e||(e={id:t.releaseGroupID,name:t.releaseGroupName,releases:[],score:0},this.releasegroups.push(e));let n=e.releases.find(c=>c.id===t.releaseID);n||(n={id:t.releaseID,name:t.releaseName,mediums:[],score:0},e.releases.push(n));let i=n.mediums.find(c=>c.nr===t.mediaNr);i||(i={nr:t.mediaNr,recordings:[],trackCount:t.mediaTrackCount,score:0},n.mediums.push(i));let a=i.recordings.find(c=>c.id===t.recordingID);a||(a={id:t.recordingID,name:t.recordingName,duration:t.recordingDuration,matches:[]},i.recordings.push(a));let r=a.matches.find(c=>c.trackID===t.trackID);r?r.score<t.score&&(r.score=t.score):a.matches.push({trackID:t.trackID,trackName:t.trackName,trackDuration:t.trackDuration,score:t.score,acoustID:t.acoustID})}};function Jn(o){let t=o.map(e=>[e.score*e.weight,e.weight]).reduce((e,n)=>[e[0]+n[0],e[1]+n[1]],[0,0]);return t[0]/t[1]}function qi(o){return o.replace(/[ .\-()[\]]/g,"").toLowerCase()}var bt=class{mbTrack;index;currentMatch;matchings=[];abData;constructor(t,e,n){this.mbTrack=t,this.index=n,this.matchings=this.createMatchingScores(e),this.currentMatch=this.matchings[0]}createMatchingScores(t){let e=[];return t.forEach((n,i)=>{let a={match:n,score:0,scores:this.createScores(n,i)};a.score=Jn(a.scores),e.push(a)}),e=e.filter(n=>n.score>0).sort((n,i)=>i.score-n.score),e}createScores(t,e){let n=[];return this.scoreTitle(t,n),this.scoreTrackNr(t,n),this.scoreDuration(t,n),this.scoreAcoustid(t,n),n.push({name:"index",score:e===this.index?1:0,weight:.1}),n}scoreAcoustid(t,e){if(t.acoustidEntries&&this.mbTrack.recording?.id){let n=this.mbTrack.recording.id,i=t.acoustidEntries.find(a=>a.recordingID===n);i&&e.push({name:"acoustid",score:i.score,weight:1})}}scoreDuration(t,e){if(this.mbTrack.length!==void 0){let n=Math.abs(Math.round(t.track.duration||0)*1e3-(this.mbTrack.length||0)),i=0;n===0?i=1:n<1e3?i=.8:n<1e4&&(i=.2),e.push({name:"duration",score:i,weight:.2})}}scoreTrackNr(t,e){let n=t.track.tag?.trackNr||ki(t.track.name);n>0&&e.push({name:"trackNr",score:n===this.mbTrack.position?1:0,weight:.2})}scoreTitle(t,e){let n=t.track.tag?.title||Se(t.track.name);if(n&&n.trim().length>0){let i=[qi(this.mbTrack.title||this.mbTrack.recording?.title||"Unknown")];for(let r of this.mbTrack.recording?.aliases||[]){let c=qi(r.name);i.push(c)}let a=i.map(r=>({title:r,score:Gi(n,r)})).sort((r,c)=>c.score-r.score);a.length>0&&e.push({name:"title",score:a[0].score,weight:1})}}};function Yn(o){let t=(o||"").split("-");return new Date(t[0]?Number(t[0]):9999,t[1]?Number(t[1]):12,t[2]?Number(t[2]):31).valueOf()}var xt=class{mbMedia;tracks=[];score=0;expanded;complete=!1;constructor(t,e,n){this.mbMedia=t,this.tracks=(t.tracks||[]).map((i,a)=>new bt(i,e,n+a))}updateScore(){this.score=0,this.complete=this.tracks.length>0;for(let t of this.tracks)t.currentMatch?this.score+=t.currentMatch.score:this.complete=!1;this.tracks.length>0?this.score=this.score/this.tracks.length:this.complete=!1}},Nt=class{mbRelease;media=[];score=0;loaded=!1;isLoading=!1;sortDate=0;totalTrack=0;expanded;complete;constructor(t){this.mbRelease=t,this.sortDate=Yn(t.date),this.totalTrack=this.mbRelease.media.reduce((e,n)=>e+n.trackCount,0)}updateScore(){this.score=0,this.complete=this.media.length>0;for(let t of this.media)t.updateScore(),this.score=Math.max(t.score,this.score),t.complete||(this.complete=!1)}setLookupRelease(t,e){this.mbRelease=t,this.totalTrack=this.mbRelease.media.reduce((i,a)=>i+a.trackCount,0);let n=0;this.media=t.media.map(i=>{let a=new xt(i,e,n);return n+=i.trackCount,a}),this.cleanDuplicateMatchings(),this.updateScore()}cleanDuplicateMatchings(){let t={};for(let e of this.media)for(let n of e.tracks)n.currentMatch&&(t[n.currentMatch.match.track.id]=t[n.currentMatch.match.track.id]||[],t[n.currentMatch.match.track.id].push(n));for(let e of Object.keys(t)){let n=t[e];if(n.length>1){n=n.sort((i,a)=>(a.currentMatch?.score||0)-(i.currentMatch?.score||0)),n.shift();for(let i of n)i.currentMatch=void 0}}}},yt=class{mbGroup;releases=[];score=0;expanded;selecting;currentRelease;constructor(t){this.mbGroup=t;for(let e of t.releases||[])this.releases.push(new Nt(e));this.releases=this.releases.sort((e,n)=>e.sortDate-n.sortDate)}findRelease(t){return this.releases.find(e=>e.mbRelease.id===t)}updateScore(){for(let t of this.releases)t.updateScore();this.score=this.currentRelease?this.currentRelease.score:0}enough(t){return!!(this.currentRelease&&this.currentRelease.totalTrack===t&&this.currentRelease.complete)}},De=class{groups=[];enough(t){return!!this.groups.find(e=>e.enough(t))}addReleaseGroup(t){let e=new yt(t);return this.groups.push(e),e}findReleaseGroup(t){return this.groups.find(e=>e.mbGroup.id===t)}sort(){for(let t of this.groups)t.updateScore();this.groups=this.groups.sort((t,e)=>e.score-t.score)}};var Me=function(o){return o[o.acoustID=0]="acoustID",o[o.musicbrainzRefresh=1]="musicbrainzRefresh",o[o.musicbrainzByTags=2]="musicbrainzByTags",o[o.auto=3]="auto",o}(Me||{}),Re=class{q;id;name;matchings=[];constructor(t){this.q=t,this.id=`musicbrainz-${JSON.stringify(t)}`,this.name=`MusicBrainz Search for ${Object.keys(t).filter(e=>e!=="type").map(e=>`${e}: "${t[e]}"`).join(", ")}`}},tt=class o{jam;notify;isRunning=!1;isAborted=!1;manual=!1;currentAction;folder;matchings=[];matchTree=new De;manualSearchData={artists:[],albums:[],artist:"",releaseGroup:"",getAutoCompleteAlbumList:()=>{if(this.manualSearchData.albums.length===0)for(let t of this.matchings){let e=(t.track?.tag?.album||"").trim();e.length>0&&!this.manualSearchData.albums.includes(e)&&this.manualSearchData.albums.push(e)}return this.manualSearchData.albums},getAutoCompleteArtistList:()=>{if(this.manualSearchData.artists.length===0)for(let t of this.matchings){let e=(t.track?.tag?.artist||"").trim();e.length>0&&!this.manualSearchData.artists.includes(e)&&this.manualSearchData.artists.push(e)}return this.manualSearchData.artists}};constructor(t,e){this.jam=t,this.notify=e}static cleanAlbumName(t){let e=t.indexOf("("),n=t;return e>1&&(n=n.slice(0,e)),e=n.indexOf("["),e>1&&(n=n.slice(0,e)),n=n.trim(),n.length===0?t:n}abort(){this.matchings=[],this.isAborted=!0}stop(){this.isRunning&&(this.isAborted=!0)}start(t){this.isRunning||(this.isAborted=!1,this.isRunning=!0,this.run(t).then(()=>{this.matchTree.sort(),this.isRunning=!1,this.isAborted=!1,this.currentAction=""}).catch(e=>{this.notify.error(e),this.isRunning=!1,this.isAborted=!1,this.currentAction=""}))}clear(){this.isRunning||(this.matchTree=new De)}manualSearch(){this.isRunning||(this.isAborted=!1,this.isRunning=!0,this.searchManual().then(()=>{this.isRunning=!1,this.isAborted=!1,this.currentAction=""}).catch(t=>{this.notify.error(t),this.isRunning=!1,this.isAborted=!1,this.currentAction=""}))}prepare(t,e){this.matchings=t,this.folder=e,this.isRunning||(this.isAborted=!1)}selectMatch(t,e,n,i){let a=this.matchings.find(c=>c.track.id===t);if(!a)return;let r=i.matchings.find(c=>c.match.track.id===t);r||(r={match:a,score:1,scores:[]},i.matchings.push(r)),r.score=1,r.scores.find(c=>c.name==="Manual Match")||r.scores.push({name:"Manual Match",score:1,weight:1});for(let c of n.media)for(let T of c.tracks)T.currentMatch&&T.currentMatch.match.track.id===a.track.id&&(T.currentMatch=void 0);i.currentMatch=r,e.updateScore()}setManualSearch(){if(this.manual=!0,this.manualSearchData.artist.length===0){let t=this.manualSearchData.getAutoCompleteArtistList();t.length>0&&(this.manualSearchData.artist=t[0])}if(this.manualSearchData.releaseGroup.length===0){let t=this.manualSearchData.getAutoCompleteAlbumList();t.length>0?this.manualSearchData.releaseGroup=t[0]:this.folder&&(this.manualSearchData.releaseGroup=this.folder.name)}}apply(t,e){for(let n of e.media)for(let i of n.tracks)i.currentMatch&&(i.currentMatch.match.mbTrack=i.mbTrack,i.currentMatch.match.mbMedia=n.mbMedia,i.currentMatch.match.mbRelease=e.mbRelease,i.currentMatch.match.mbGroup=t.mbGroup)}stopApply(){for(let t of this.matchings)t.mbTrack=void 0,t.mbMedia=void 0,t.mbRelease=void 0,t.mbGroup=void 0,t.genres=void 0}setRunning(t){this.currentAction=t,this.isRunning=!0}stopRunning(){this.isRunning=!1,this.currentAction=""}searchManual(){return R(this,null,function*(){let t={type:W.releaseGroup};if(this.manualSearchData.artist&&this.manualSearchData.artist.trim().length>0&&(t.artist=this.manualSearchData.artist),this.manualSearchData.releaseGroup&&this.manualSearchData.releaseGroup.trim().length>0&&(t.releasegroup=this.manualSearchData.releaseGroup),Object.keys(t).length>1){let e=new Re(t);yield this.runQuery(e,[])}})}setRelease(t,e){t.currentRelease=e,e.loaded||this.loadRelease(e).catch(n=>{this.notify.error(n)})}removeMatching(t,e,n){n.currentMatch=void 0,t.updateScore()}loadLyrics(t){this.isRunning||!t||(this.setRunning("Searching Lyrics"),this.loadLyricsOVH(t).then(()=>{this.stopRunning()}).catch(e=>{this.stopRunning(),this.notify.error(e)}))}loadMoods(t){this.isRunning||!t||(this.setRunning("Searching Moods"),this.loadAcousticBrainz(t).then(()=>{this.stopRunning()}).catch(e=>{this.stopRunning(),this.notify.error(e)}))}loadAcousticBrainz(t){return R(this,null,function*(){for(let e of t.media)for(let n of e.tracks)if(!n.abData&&n.currentMatch?.match?.mbTrack?.recording?.id){let i=(yield this.jam.metadata.acousticbrainzLookup({mbID:n.currentMatch.match.mbTrack.recording.id})).data;if(i.highlevel){let a=[],r=[],c=[],T=[],A=Object.keys(i.highlevel);for(let N of A){let x=i.highlevel[N].value;i.highlevel[N].probability>.8&&!x.includes("not_")&&(N.startsWith("mood_")||N==="timbre"||N==="danceability"?r.includes(x)||r.push(x):N.startsWith("genre_")?a.includes(x)||a.push(x):N.startsWith("tonal_")||N==="voice_instrumental"?c.includes(x)||c.push(x):T.includes(x)||T.push(x))}let S={genres:a,moods:r,tonal:c,other:T};n.abData=S,n.currentMatch.match.abdata=S}}})}shouldStop(){return this.matchTree.enough(this.matchings.length)||this.isAborted}acoustId(){return R(this,null,function*(){this.currentAction="Checking files with AcoustID";let t=[];for(let n of this.matchings){if(!n.acoustidEntries){this.currentAction=`Checking files with AcoustID: ${n.track.name}`;try{let i=yield this.jam.metadata.acoustidLookup({trackID:n.track.id});n.acoustidEntries=ji(i.data,n.track)}catch(i){console.error(i)}if(this.isAborted)return}n.acoustidEntries&&(t=t.concat(n.acoustidEntries))}let e=new et;for(let n of t)e.add(n);for(let n of e.releasegroups){if(this.shouldStop())return;let i=this.matchTree.findReleaseGroup(n.id);if(i||(i=yield this.addReleaseGroupByID(n.id)),i&&!i.currentRelease&&(yield this.loadBestMatchingCurrentRelease(i),this.shouldStop()))return;this.matchTree.sort()}})}loadLyricsOVH(t){return R(this,null,function*(){for(let e of t.media)for(let n of e.tracks)if(n.currentMatch&&!n.currentMatch.match.lyrics&&n.mbTrack.artistCredit&&n.mbTrack.artistCredit.length>0){let i=n.mbTrack.artistCredit[0].name,a=n.mbTrack.title;n.currentMatch.match.lyrics=(yield this.jam.metadata.lyricsovhSearch({title:a,artist:i})).data}})}loadRelease(t){return R(this,null,function*(){if(!(!t||t.loaded||t.isLoading)){t.isLoading=!0;try{this.currentAction=`Loading MusicBrainz Release: ${t.mbRelease.id}`;let e=yield this.jam.metadata.musicbrainzLookup({type:Ve.release,mbID:t.mbRelease.id});if(!e.data?.release)return Promise.reject(Error("Got empty data"));t.setLookupRelease(e.data.release,this.matchings),t.loaded=!0,t.isLoading=!1}catch(e){return t.isLoading=!1,Promise.reject(e)}}})}addReleaseGroupByReleaseID(t){return R(this,null,function*(){this.currentAction=`Loading MusicBrainz Release: ${t}`;let e=yield this.jam.metadata.musicbrainzLookup({type:Ve.release,mbID:t});return e.data.release?this.addReleaseGroupByID(e.data.release.releaseGroup.id):Promise.reject(Error("Got empty data"))})}addReleaseGroupByID(t){return R(this,null,function*(){let e=this.matchTree.findReleaseGroup(t);if(!e){this.currentAction=`Loading MusicBrainz Release Group: ${t}`;let n=yield this.jam.metadata.musicbrainzLookup({type:Ve.releaseGroup,mbID:t});e=this.matchTree.addReleaseGroup(n.data.releaseGroup)}return e})}buildQuickQueries(){let t=[],e=[],n=[];for(let i of this.matchings)if(i.track.tag&&i.track.tag.album){let a=o.cleanAlbumName(i.track.tag.album);i.track.tag.album&&!e.includes(a)&&e.push(a),i.track.tag.artist&&!n.includes(i.track.tag.artist)&&n.push(i.track.tag.artist)}return e.length===1&&t.push(new Re({type:W.releaseGroup,releasegroup:e[0],artist:n.length>0?n[0]:void 0})),this.folder?.tag&&t.push(new Re({type:W.releaseGroup,releasegroup:this.folder.name,artist:this.folder.tag.artist})),t}buildQueries(){let t=[],e=(i,a)=>{let r=t.find(c=>c.id===i.id);if(r){r.matchings.push(a);return}i.matchings.push(a),t.push(i)},n=(i,a,r)=>{let c={type:i.type};for(let T of Object.keys(i)){let A=i[T];if(A===void 0||A===""||A.toString().trim()==="")return;let S=A.toString().split("(");S.length>0&&(c[T]=S[0])}r&&(c.tracks=this.matchings.length),e(new Re(c),a)};for(let i of this.matchings)n({type:W.releaseGroup,releasegroup:i.track.tag?.album,artist:i.track.tag?.artist},i);for(let i of this.matchings)n({type:W.release,release:i.track.tag?.album,artist:i.track.tag?.artist},i,!0);for(let i of this.matchings)n({type:W.release,release:i.track.tag?.album,artist:i.track.tag?.artist},i);for(let i of this.matchings)if(i.track.tag?.title)n({type:W.recording,recording:i.track.tag.title,release:i.track.tag.album,artist:i.track.tag.artist},i);else{let a=Se(i.track.name);n({type:W.recording,recording:a,release:i.track.tag?.album,artist:i.track.tag?.artist},i)}for(let i of this.matchings)if(i.track.tag?.title)n({type:W.recording,recording:i.track.tag.title,release:i.track.tag.album},i),n({type:W.recording,recording:i.track.tag.title,artist:i.track.tag.artist},i);else{let a=Se(i.track.name);n({type:W.recording,recording:a,release:i.track.tag?.album},i),n({type:W.recording,recording:a,artist:i.track.tag?.artist},i)}for(let i of this.matchings)n({type:W.releaseGroup,releasegroup:i.track.tag?.album},i),n({type:W.release,release:i.track.tag?.album},i,!0),n({type:W.release,release:i.track.tag?.album},i);for(let i of this.matchings)if(i.track.tag?.title)n({type:W.recording,recording:i.track.tag.title},i);else{let a=Se(i.track.name);n({type:W.recording,recording:a},i)}return t}loadBestMatchingCurrentRelease(t){return R(this,null,function*(){let e=t.releases.sort((n,i)=>{let a=Math.abs((n.totalTrack||0)-this.matchings.length),r=Math.abs((i.totalTrack||0)-this.matchings.length);return a===r?n.sortDate-i.sortDate:a-r});for(let n of e){if(this.shouldStop())return;if(yield this.loadRelease(n),n.complete){t.currentRelease=n;return}}t.releases.length>0&&(yield this.loadRelease(t.releases[0]),t.currentRelease=t.releases[0])})}loadByReleaseGroups(t){return R(this,null,function*(){for(let e of t){if(this.shouldStop())return;let n=this.matchTree.findReleaseGroup(e.id);n||(n=yield this.addReleaseGroupByID(e.id)),n&&!n.currentRelease&&(yield this.loadBestMatchingCurrentRelease(n))}})}loadByReleases(t){return R(this,null,function*(){for(let e of t){if(this.shouldStop())return;let n=this.matchTree.findReleaseGroup(e.releaseGroup.id);n||(n=yield this.addReleaseGroupByID(e.releaseGroup.id)),n&&!n.currentRelease&&(yield this.loadBestMatchingCurrentRelease(n))}})}loadByRecordings(t){return R(this,null,function*(){for(let e of t){if(this.shouldStop())return;if(e.releases)for(let n of e.releases){if(this.shouldStop())return;let i=this.matchTree.findReleaseGroup(n.releaseGroup.id);i||(i=yield this.addReleaseGroupByID(n.releaseGroup.id)),i&&!i.currentRelease&&(yield this.loadBestMatchingCurrentRelease(i))}}})}runQuery(t,e){return R(this,null,function*(){if(this.shouldStop())return;this.currentAction=t.name;let n=(yield this.jam.metadata.musicbrainzSearch(t.q)).data;if(n.releaseGroups?yield this.loadByReleaseGroups(n.releaseGroups):n.releases?yield this.loadByReleases(n.releases):n.recordings?yield this.loadByRecordings(n.recordings):console.error("TODO",n),this.matchTree.sort(),this.shouldStop())return;let i=e.shift();i&&(yield this.runQuery(i,e))})}musicBrainzByQuickTags(){return R(this,null,function*(){let t=this.buildQuickQueries(),e=t.shift();e&&(yield this.runQuery(e,t))})}musicBrainzByTags(){return R(this,null,function*(){let t=this.buildQueries(),e=t.shift();e&&(yield this.runQuery(e,t))})}musicBrainzRefresh(){return R(this,null,function*(){for(let t of this.matchings){if(this.shouldStop())return;if(t.track.tag){let e;if(t.track.tag.mbReleaseGroupID&&(e=yield this.addReleaseGroupByID(t.track.tag.mbReleaseGroupID)),!e&&t.track.tag.mbReleaseID&&(e=yield this.addReleaseGroupByReleaseID(t.track.tag.mbReleaseID)),e){if(t.track.tag.mbReleaseID){let n=e.findRelease(t.track.tag.mbReleaseID);n?yield this.loadRelease(n):console.error("Could not find the release with id",t.track.tag.mbReleaseID),e.currentRelease=n,e.enough(this.matchings.length)||(e.currentRelease=void 0)}e.currentRelease||(yield this.loadBestMatchingCurrentRelease(e))}}}})}run(t){return R(this,null,function*(){switch(t){case Me.acoustID:yield this.acoustId();break;case Me.musicbrainzByTags:if(yield this.musicBrainzByQuickTags(),this.shouldStop())return;yield this.musicBrainzByTags();break;case Me.musicbrainzRefresh:yield this.musicBrainzRefresh();break;case Me.auto:if(yield this.musicBrainzRefresh(),this.shouldStop()||(yield this.musicBrainzByQuickTags(),this.shouldStop())||(yield this.acoustId(),this.shouldStop()))return;yield this.musicBrainzByTags();break;default:break}})}};var Zn=["actionMenu"];function eo(o,t){o&1&&(d(0,"a",18),M(1,"i",26),$(2),h(3,1),F(),l())}function to(o,t){o&1&&(d(0,"a",18),M(1,"i",27),$(2),h(3,2),F(),l())}function io(o,t){if(o&1){let e=P();d(0,"app-match-results",28),f("chooseReleaseRequest",function(i){m(e);let a=u();return p(a.chooseRelease(i))}),l()}if(o&2){let e=u();E("matcher",e.matcher)}}function no(o,t){if(o&1&&(d(0,"div",23),M(1,"i",29),O(2),l()),o&2){let e=u();_(2),X(" ",e.matcher.currentAction)}}function oo(o,t){o&1&&(d(0,"button",31),M(1,"i",29),l())}function ao(o,t){if(o&1){let e=P();d(0,"button",33),f("click",function(){m(e);let i=u(2);return p(i.apply())}),h(1,4),l()}}function ro(o,t){if(o&1){let e=P();d(0,"div",24)(1,"div",30),g(2,oo,2,0,"button",31),g(3,ao,2,0,"button",31),d(4,"button",32),f("click",function(){m(e);let i=u();return p(i.stopApply())}),h(5,3),l()()()}if(o&2){let e=u();_(2),C(e.matcher.isRunning?2:-1),_(),C(e.matcher.isRunning?-1:3)}}function so(o,t){o&1&&h(0,5)}function lo(o,t){o&1&&h(0,6)}function co(o,t){o&1&&h(0,7)}function _o(o,t){o&1&&h(0,8)}function uo(o,t){if(o&1){let e=P();d(0,"div")(1,"button",34),f("click",function(){m(e);let i=u(3);return p(i.matcher.start(i.RunType.auto))}),h(2,9),l(),d(3,"button",35),f("click",function(i){m(e);let a=u(3);return p(a.onContextMenu(i))}),O(4,"\xA0\u2026\xA0"),l()()}}function mo(o,t){if(o&1){let e=P();d(0,"div")(1,"button",32),f("click",function(){m(e);let i=u(3);return p(i.matcher.stop())}),h(2,10),l()()}}function po(o,t){if(o&1&&(d(0,"div",30),g(1,uo,5,0,"div"),g(2,mo,3,0,"div"),l()),o&2){let e=u(2);_(),C(e.matcher.isRunning?-1:1),_(),C(e.matcher.isRunning?2:-1)}}function go(o,t){if(o&1){let e=P();d(0,"div")(1,"button",33),f("click",function(){m(e);let i=u(3);return p(i.matcher.manualSearch())}),h(2,13),l(),d(3,"button",32),f("click",function(){m(e);let i=u(3);return p(i.matcher.clear())}),h(4,14),l(),d(5,"button",32),f("click",function(){m(e);let i=u(3);return p(i.matcher.manual=!1)}),h(6,15),l()()}}function Co(o,t){if(o&1){let e=P();d(0,"div")(1,"button",32),f("click",function(){m(e);let i=u(3);return p(i.matcher.stop())}),h(2,16),l()()}}function ho(o,t){if(o&1){let e=P();d(0,"div",30)(1,"div",36)(2,"div")(3,"div"),h(4,11),l(),d(5,"app-tag-editor-autocomplete",37),G("valueChange",function(i){m(e);let a=u(2);return k(a.matcher.manualSearchData.releaseGroup,i)||(a.matcher.manualSearchData.releaseGroup=i),p(i)}),l()(),d(6,"div")(7,"div"),h(8,12),l(),d(9,"app-tag-editor-autocomplete",37),G("valueChange",function(i){m(e);let a=u(2);return k(a.matcher.manualSearchData.artist,i)||(a.matcher.manualSearchData.artist=i),p(i)}),l()()(),g(10,go,7,0,"div"),g(11,Co,3,0,"div"),l()}if(o&2){let e=u(2);_(5),E("getList",e.matcher.manualSearchData.getAutoCompleteAlbumList)("standalone",!0),w("value",e.matcher.manualSearchData.releaseGroup),_(4),E("getList",e.matcher.manualSearchData.getAutoCompleteArtistList)("standalone",!0),w("value",e.matcher.manualSearchData.artist),_(),C(e.matcher.isRunning?-1:10),_(),C(e.matcher.isRunning?11:-1)}}function fo(o,t){if(o&1&&(d(0,"div",24),g(1,po,3,2,"div",30),g(2,ho,12,8,"div",30),l()),o&2){let e=u();_(),C(e.matcher.manual?-1:1),_(),C(e.matcher.manual?2:-1)}}var it=(()=>{class o{app;jam;notify;contextMenuService;data;rightActive=!0;matchApply;actionMenu;matcher;current;RunType=Me;constructor(e,n,i,a){this.app=e,this.jam=n,this.notify=i,this.contextMenuService=a,this.matcher=new tt(n,i)}ngOnChanges(){this.data?this.matcher.prepare(this.data.matchings.map(e=>({track:e.track})),this.data.folder):this.matcher.abort()}ngOnDestroy(){this.matcher.abort()}apply(){let e=this.matchApply.getGenres();for(let n of this.matcher.matchings)n.genres=e;if(this.data){let n=this.matchApply.getCoverArtImages();for(let i of this.data.matchings){let a=this.matcher.matchings.find(r=>r.track.id===i.track.id);i.rawTag=a?Wi(a,e,n):void 0}this.data.apply&&this.data.apply(),this.data.close&&this.data.close()}}chooseRelease({group:e,release:n}){this.stopApply(),this.current={group:e,release:n},this.matchApply.coverArtSearch={mbReleaseID:n.mbRelease.id,mbReleaseGroupID:e.mbGroup.id},this.matcher.apply(e,n),this.data&&this.matchApply.loadGenres(this.data.matchings,e,n).catch(i=>{this.notify.error(i)})}stopApply(){this.current=void 0,this.matchApply.genres=void 0,this.matcher.stopApply()}loadLyricsRequest(){this.current&&this.matcher.loadLyrics(this.current.group.currentRelease)}loadMoodsRequest(){this.current&&this.matcher.loadMoods(this.current.group.currentRelease)}onContextMenu(e){this.contextMenuService.show.next({contextMenu:this.actionMenu,event:e,item:void 0}),e.preventDefault(),e.stopPropagation()}static \u0275fac=function(n){return new(n||o)(L(Ce),L(ge),L(Ee),L(Ue))};static \u0275cmp=v({type:o,selectors:[["app-match-release"]],viewQuery:function(n,i){if(n&1&&(Y(Ie,5),Y(Zn,5)),n&2){let a;Q(a=Z())&&(i.matchApply=a.first),Q(a=Z())&&(i.actionMenu=a.first)}},hostVars:2,hostBindings:function(n,i){n&2&&oe("right-active",i.rightActive)},inputs:{data:"data"},standalone:!1,features:[q],decls:16,vars:9,consts:()=>{let e;e=$localize`:␟d8bda62007c2bacc6bd73d2797ba6fab5eb96daf␟1739704243369512276:Show Tracks`;let n;n=$localize`:␟f1bca2b5b0d2d87b0641062e24bb678109d06c8d␟1818664258537534853:Show Matchings`;let i;i=$localize`:␟d7b35c384aecd25a516200d6921836374613dfe7␟2159130950882492111:Cancel`;let a;a=$localize`:␟c2d0ac9f528bbd5f53fd34269fde8b59e029621b␟4391289919356861627:Apply`;let r;r=$localize`:␟f8b6e885edfef63c69668c4d6a9580133a00ead7␟3795661313994709664:Manual Search with MusicBrainz`;let c;c=$localize`:␟be9ffa65590ff07f22e4cd0b96ba46657cd645d2␟6390950868913125525:Match with AcoustID`;let T;T=$localize`:␟4eefd958f9ebadbe763175761b9e1f266f8867d4␟6034730998727247542:Match with MusicBrainz (Text)`;let A;A=$localize`:␟c66e707e109490f913f700b7ca5d4eca128bc84c␟8911327935348537973:Match with MusicBrainz (Musicbrainz IDs)`;let S;S=$localize`:␟bc7ebf67b7122e93bd293232982b1b45f3e5d8bc␟9028301309562848662:Auto Match`;let N;N=$localize`:␟1d0d5c9a36e72bd9643ff1ede69736ae063d652b␟3133539296286953705:Stop`;let x;x=$localize`:␟37a750182b4e4604bcc5c232d8c485c4721cd80d␟766537929493990192:Album Name`;let ie;ie=$localize`:␟378660a509ecaa4d2dd3b4b0b8975760cfe3576d␟2492300395471245755:Artist`;let se;se=$localize`:␟7e892ba15f2c6c17e83510e273b3e10fc32ea016␟4580988005648117665:Search`;let ne;ne=$localize`:␟99ee4faa69cd2ea8e3678c1f557c0ff1f05aae46␟8700121026680200191:Clear`;let le;le=$localize`:␟f4e529ae5ffd73001d1ff4bbdeeb0a72e342e5c8␟7819314041543176992:Close`;let ce;return ce=$localize`:␟1d0d5c9a36e72bd9643ff1ede69736ae063d652b␟3133539296286953705:Stop`,[["actionMenu",""],e,n,i,a,r,c,T,A,S,N,x,ie,se,ne,le,ce,[1,"toggle",3,"click"],[1,"button-on-control"],[1,"content"],[1,"match-files",3,"matchings"],[1,"match-releases",3,"loadLyricsRequest","loadMoodsRequest","hidden","isRunning"],[1,"match-releases",3,"matcher"],[1,"current-log"],[1,"buttons"],["contextMenuItem","",3,"execute"],[1,"icon-left"],[1,"icon-right"],[1,"match-releases",3,"chooseReleaseRequest","matcher"],[1,"icon-spin","icon-spinner"],[1,"match-actions"],[1,"button-primary"],[1,"button-accent",3,"click"],[1,"button-primary",3,"click"],[1,"button-on-control","button-with-add-on",3,"click"],[1,"button-on-control","button-add-on",3,"click"],[1,"match-search"],[3,"valueChange","getList","standalone","value"]]},template:function(n,i){if(n&1){let a=P();d(0,"div",17),f("click",function(){return m(a),p(i.rightActive=!i.rightActive)}),g(1,eo,4,0,"a",18),g(2,to,4,0,"a",18),l(),d(3,"div",19),M(4,"app-match-file-list",20),d(5,"app-match-apply",21),f("loadLyricsRequest",function(){return m(a),p(i.loadLyricsRequest())})("loadMoodsRequest",function(){return m(a),p(i.loadMoodsRequest())}),l(),g(6,io,1,1,"app-match-results",22),l(),g(7,no,3,1,"div",23),g(8,ro,6,2,"div",24),d(9,"context-menu",null,0),K(11,so,1,0,"ng-template",25),f("execute",function(){return m(a),p(i.matcher.setManualSearch())}),K(12,lo,1,0,"ng-template",25),f("execute",function(){return m(a),p(i.matcher.start(i.RunType.acoustID))}),K(13,co,1,0,"ng-template",25),f("execute",function(){return m(a),p(i.matcher.start(i.RunType.musicbrainzByTags))}),K(14,_o,1,0,"ng-template",25),f("execute",function(){return m(a),p(i.matcher.start(i.RunType.musicbrainzRefresh))}),l(),g(15,fo,3,2,"div",24)}n&2&&(_(),C(i.rightActive?1:-1),_(),C(i.rightActive?-1:2),_(2),E("matchings",i.matcher.matchings),_(),E("hidden",!i.current)("isRunning",i.matcher.isRunning),_(),C(i.current?-1:6),_(),C(i.matcher.isRunning?7:-1),_(),C(i.current?8:-1),_(7),C(i.current?-1:15))},styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;width:100%;height:100%;overflow:hidden}[_nghost-%COMP%]   .toggle[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex:1 1 auto;overflow-y:auto}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]{overflow-y:auto;overflow-x:auto;display:block;height:100%;width:50%;font-size:.8em;padding-right:15px}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-releases[_ngcontent-%COMP%]{border-left:1px solid var(--background-border);display:flex;flex-direction:column;flex:1 1 auto;width:50%;font-size:.9em}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-releases[hidden][_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .buttons[_ngcontent-%COMP%]{flex:0 0 auto;padding:5px;display:flex;align-items:center;justify-content:center;border-top:1px solid var(--background-border)}[_nghost-%COMP%]   .buttons[_ngcontent-%COMP%]   .match-actions[_ngcontent-%COMP%]{text-align:center;vertical-align:middle;margin-top:10px;margin-bottom:30px}[_nghost-%COMP%]   .buttons[_ngcontent-%COMP%]   .match-actions[_ngcontent-%COMP%]   app-tag-editor-autocomplete[_ngcontent-%COMP%]{height:28px;display:block}[_nghost-%COMP%]   .buttons[_ngcontent-%COMP%]   .match-actions[_ngcontent-%COMP%]   .match-search[_ngcontent-%COMP%]{display:flex;flex-direction:row;text-align:left}@media (max-width: 768px){[_nghost-%COMP%]   .buttons[_ngcontent-%COMP%]   .match-actions[_ngcontent-%COMP%]   .match-search[_ngcontent-%COMP%]{flex-direction:column}}[_nghost-%COMP%]   .buttons[_ngcontent-%COMP%]   .match-actions[_ngcontent-%COMP%]   .match-search[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{flex:1;padding-left:10px;padding-right:10px}[_nghost-%COMP%]   .buttons[_ngcontent-%COMP%]   .match-actions[_ngcontent-%COMP%]   .match-search[_ngcontent-%COMP%]{margin-bottom:10px}[_nghost-%COMP%]   .buttons[_ngcontent-%COMP%]   .match-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:10px;margin-right:10px}[_nghost-%COMP%]   .buttons[_ngcontent-%COMP%]   .match-actions[_ngcontent-%COMP%]   .match-progress[_ngcontent-%COMP%]{display:block;font-size:.9em}[_nghost-%COMP%]   .current-log[_ngcontent-%COMP%]{font-size:.8em;padding:5px}@media (max-width: 768px){[_nghost-%COMP%]   .toggle[_ngcontent-%COMP%]{display:block;position:relative;width:100%;height:auto;text-align:center;padding-top:5px;padding-bottom:5px}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]{overflow-y:auto}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]{height:auto;width:100%;overflow-y:inherit;display:block;padding-right:0}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-releases[_ngcontent-%COMP%]{height:auto;width:100%;display:none;border-left:none}.right-active[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-releases[_ngcontent-%COMP%]{display:block}.right-active[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]{display:none}}"]})}return o})();function Oo(o,t){if(o&1&&(d(0,"span",0),ae(1,"number"),Xt(),d(2,"svg",1),M(3,"rect",2),l()()),o&2){let e=u();E("title",Be("Score: ",de(1,4,e.score))),_(3),jt("y",12-e.score*10)("fill",e.color)}}var It=(()=>{class o{score;color;getMatchColor(e){return e>.7?"green":e>.3?"yellow":"red"}ngOnChanges(){this.color=this.score===void 0?void 0:this.getMatchColor(this.score)}static \u0275fac=function(n){return new(n||o)};static \u0275cmp=v({type:o,selectors:[["app-score-box"]],inputs:{score:"score"},standalone:!1,features:[q],decls:1,vars:1,consts:[[3,"title"],["xmlns","http://www.w3.org/2000/svg","width","10","height","12"],["height","12","width","10"]],template:function(n,i){n&1&&g(0,Oo,4,6,"span",0),n&2&&C(i.score?0:-1)},dependencies:[Xe],styles:["[_nghost-%COMP%]{width:100%;height:100%}[_nghost-%COMP%]   svg[_ngcontent-%COMP%]{overflow:hidden;vertical-align:middle;background-color:var(--background-hover);border:1px solid var(--background-border)}"]})}return o})();function nt(o){let t={};for(let e of o.cells)if(e.column.def.id!==te)for(let n of e.frames){let i=t[e.column.def.id]||[];i.push(n),t[e.column.def.id]=i}return{version:4,frames:t}}function Dt(o){let t=Di(o);if(t=t.filter(e=>!isNaN(Number(e))),t.length>0)return t[0]}function Le(o){let t=o.cells.find(e=>e.column.def.id==="TPOS");return`${o.track.parentID}|${t&&t.frames.length>0?t.frames[0].value.text:""}`}function Ki(o,t){let e=[],n="";if(t.frames.TPOS&&t.frames.TPOS.length>0){let a=t.frames.TPOS[0],r=(a.value.text||"").split("/")[0],c=(a.value.text||"").split("/")[1]||"99";if(Number(c)>1){for(;r.length<c.length;)r=`0${r}`;n+=`${r}-`}}if(t.frames.TRCK&&t.frames.TRCK.length>0){let a=t.frames.TRCK[0],r=(a.value.text||"").split("/")[0],c=(a.value.text||"").split("/")[1]||"99";for(;r.length<c.length;)r=`0${r}`;n+=r}if(e.push(n),t.frames.TIT2&&t.frames.TIT2.length>0){let a=t.frames.TIT2[0];e.push(a.value.text)}if(t.frames.TPE1&&t.frames.TPE1.length>0){let a=t.frames.TPE1[0];e.push(a.value.text)}let i=`.${Li(o.name)}`;return`${wi(e.join(" - "),"")}${i}`}var ot=class o{jam;columns=[];edits=[];constructor(t){this.jam=t}removeColumnText(t,e){let n=this.columns.indexOf(t);for(let i of this.edits){let a=i.cells[n],r=a.frames.length>0?a.frames[0].value.text:void 0;r&&this.updateEditTextCell(i,t,r.replace(e,""))}}updateEditTextCell(t,e,n){let i=this.columns.indexOf(e),a=t.cells[i],r=n||"",c=[];r.length>0&&(c=[{id:a.column.def.id,value:s.LangDescText===e.def.impl?{id:"",language:"",text:r}:{id:a.column.def.subid,text:r}}]),(a.frames.length===0||a.frames[0].value.text!==r)&&(t.cells[i]={parent:t,track:a.track,column:e,frames:c,changed:!0},t.changed=!0)}setColumnTrackNrFromFile(t){let e={};for(let n of this.edits){let i=Le(n);e[i]=(e[i]||0)+1}for(let n of this.edits){let i=Dt(n.track.name);if(i){let a=Le(n),r=`${i}/${(e[a]||0).toString()}`;this.updateEditTextCell(n,t,r)}}}setColumnFilenames(t){let e=this.columns.indexOf(t);for(let n of this.edits){let i=n.cells[e],a=Ki(i.track,nt(n));this.updateEditTextCell(n,t,a)}}setColumnTrackNrByIndex(t){let e={},n={};for(let i of this.edits){let a=Le(i);e[a]=(e[a]||0)+1}for(let i of this.edits){let a=Le(i);n[a]=(n[a]||0)+1;let r=`${(n[a]||0).toString()}/${(e[a]||0).toString()}`;this.updateEditTextCell(i,t,r)}}addIndexToTitleCol(t){let e=this.columns.indexOf(t);this.edits.forEach((n,i)=>{let a=n.cells[e],r=a.frames.length>0?a.frames[0].value.text:"";r=`${r} ${(i+1).toString()}`.trim(),this.updateEditTextCell(n,t,r)})}setColumnPartOfSet(t){let e=this.columns.indexOf(t),n=[];for(let i of this.edits)n.includes(i.track.parentID)||n.push(i.track.parentID);for(let i of this.edits){let a=i.cells[e],r=`${(n.indexOf(a.track.parentID)+1).toString()}/${n.length.toString()}`;this.updateEditTextCell(i,t,r)}}setColumnTotalTrack(t){let e={};for(let i of this.edits)e[i.track.parentID]=(e[i.track.parentID]||0)+1;let n=this.columns.indexOf(t);this.edits.forEach((i,a)=>{let r=i.cells[n],c;r.frames.length>0?(c=r.frames[0].value.text.split("/")[0],isNaN(Number(c))||(c=Number(c).toString())):c=Dt(i.track.name),c||(c=(a+1).toString());let T=`${c||""}/${(e[i.track.parentID]||0).toString()}`;this.updateEditTextCell(i,t,T)})}setAlbumArtistFrames(t){let e=this.columns.findIndex(n=>n.def.id==="TPE1");if(e>=0)for(let n of this.edits){let i=n.cells[e],a=i.frames.length>0?i.frames[0].value.text:void 0;a&&this.updateEditTextCell(n,t,a)}}setReleaseDateFromYearFrames(t){this.copyColumn(this.columns.findIndex(e=>e.def.id==="TYER"),t)}getCellText(t){return t.frames.length>0?t.frames[0].value.text:void 0}insertFromColumn(t,e,n){let i=this.columns.indexOf(n);if(t>=0)for(let a of this.edits){let r=this.getCellText(a.cells[t]),c=this.getCellText(a.cells[i])||"";if(r){let T=c.slice(0,e)+r+c.slice(e);this.updateEditTextCell(a,n,T)}}}copyColumn(t,e){if(t>=0)for(let n of this.edits){let i=n.cells[t],a=i.frames.length>0?i.frames[0].value.text:void 0;a&&this.updateEditTextCell(n,e,a)}}appendFromColumn(t,e){let n=this.columns.indexOf(e);if(t>=0)for(let i of this.edits){let a=this.getCellText(i.cells[t]);if(a){let r=this.getCellText(i.cells[n])||"";this.updateEditTextCell(i,e,r+a)}}}setColumnText(t,e){for(let n of this.edits)this.updateEditTextCell(n,t,e)}appendColumnText(t,e){let n=this.columns.indexOf(t);for(let i of this.edits){let a=this.getCellText(i.cells[n])||"";this.updateEditTextCell(i,t,a+e)}}setColumnFromTitleFrames(t){this.copyColumn(this.columns.findIndex(e=>e.def.id==="TIT2"),t)}clearColumn(t){let e=this.columns.indexOf(t);for(let n of this.edits)n.cells[e].frames.length>0&&(n.cells[e]={parent:n,track:n.cells[e].track,column:n.cells[e].column,frames:[],changed:!0},n.changed=!0)}findMissingLyrics(){return R(this,arguments,function*(t=[]){let e=this.findOrAddColumn(t,{frameDef:D.USLT,id:"USLT"}),n=this.findOrAddColumn(t,{frameDef:D.TPE1,id:"TPE1"}),i=this.findOrAddColumn(t,{frameDef:D.TIT2,id:"TIT2"}),a=this.columns.indexOf(e),r=this.columns.indexOf(n),c=this.columns.indexOf(i);for(let T of this.edits)if(!this.getCellText(T.cells[a])){let S=this.getCellText(T.cells[r]),N=this.getCellText(T.cells[c]);if(N&&S){let x=yield this.jam.metadata.lyricsovhSearch({title:N,artist:S});x?.data?.lyrics&&this.updateEditTextCell(T,e,x.data.lyrics)}}})}setAudiobookFrames(t=[]){let e=this.findOrAddColumn(t,{frameDef:D.TCON,id:"TCON"}),n=this.findOrAddColumn(t,{frameDef:D.TXXX,id:"TXXX",subid:"MusicBrainz Album Type"});for(let i of this.edits)this.updateEditTextCell(i,e,"Audiobook"),this.updateEditTextCell(i,n,"album/audiobook")}setAudioSeriesFrames(t=[]){let e=this.findOrAddColumn(t,{frameDef:D.TCON,id:"TCON"}),n=this.findOrAddColumn(t,{frameDef:D.TXXX,id:"TXXX",subid:"MusicBrainz Album Type"});for(let i of this.edits)this.updateEditTextCell(i,e,"Audio Series"),this.updateEditTextCell(i,n,"album/audiodrama")}setSoundtrackFrames(t=[]){let e=this.findOrAddColumn(t,{frameDef:D.TCON,id:"TCON"}),n=this.findOrAddColumn(t,{frameDef:D.TXXX,id:"TXXX",subid:"MusicBrainz Album Type"});for(let i of this.edits)this.updateEditTextCell(i,e,"Soundtrack"),this.updateEditTextCell(i,n,"album/soundtrack")}setVariousArtistFrames(t=[]){let e=this.findOrAddColumn(t,{frameDef:D.TXXX,id:"TXXX",subid:"MusicBrainz Album Type"}),n=this.findOrAddColumn(t,{frameDef:D.TXXX,id:"TXXX",subid:"MusicBrainz Album Artist Id"}),i=this.findOrAddColumn(t,{frameDef:D.TPE2,id:"TPE2"});for(let a of this.edits)this.updateEditTextCell(a,e,"album/compilation"),this.updateEditTextCell(a,i,qe),this.updateEditTextCell(a,n,Ni)}setBootlegFrames(t=[]){let e=this.findOrAddColumn(t,{frameDef:D.TXXX,id:"TXXX",subid:"MusicBrainz Album Status"}),n=this.findOrAddColumn(t,{frameDef:D.TXXX,id:"TXXX",subid:"MusicBrainz Album Type"});for(let i of this.edits)this.updateEditTextCell(i,e,"bootleg"),this.updateEditTextCell(i,n,"album/live")}build(t){this.edits=[],this.upgradeTrackTags(t),this.buildColumns(t),this.buildEdits(t)}upgradeTrackTags(t){for(let e of t)this.upgradeTrackTag(e)}upgradeTrackTag(t){let e=t.tagRaw;if(!(!e||e.version===void 0)&&e.version<4){let n=o.getRawTagFrames(e),i={version:4,frames:{}},a=this.upgradeDateFramesTov24Date(n);a&&(n=n.filter(r=>!a.dateFrames.includes(r)),n.push(a.newFrame));for(let r of n){let c=this.ensureID3v2FrameVersionDef(r.id,4);c?(r.id=c,i.frames[c]=i.frames[c]||[],i.frames[c].push(r)):console.error("upgradeTrackTag","missing id3v2 update",r.id,"=>",c)}t.tagRaw=i}}ensureID3v2FrameVersionDef(t,e){let n=D[t];if(!n)return;if(n.versions.indexOf(e)>=0)return t;if(n.versions[0]>e){let r=Object.keys(D).find(T=>D[T].upgrade===t);if(!r){console.error(`ensureID3v2FrameVersionDef: Missing v2.${n.versions} -> v2.${e} mapping ${t}`);return}let c=D[r];return c.versions.indexOf(e)<0?c.versions[0]>e?this.ensureID3v2FrameVersionDef(r,e):void 0:r}if(!n.upgrade){console.error(`ensureID3v2FrameVersionDef: Missing v2.${n.versions} -> v2.${e} mapping ${t}`);return}let i=n.upgrade,a=D[i];return a.versions.indexOf(e)<0?a.versions[0]<e?this.ensureID3v2FrameVersionDef(i,e):void 0:i}upgradeDateFramesTov24Date(t){let e=t.find(c=>["TYER","TYE"].indexOf(c.id)>=0),n=t.find(c=>["TDAT","TDA"].indexOf(c.id)>=0),i=t.find(c=>["TIME","TIM"].indexOf(c.id)>=0);if(!e&&!n&&!i)return;let a=[],r=[];return e&&e.value&&Object.prototype.hasOwnProperty.call(e.value,"text")&&(a.push(e),r.push(e.value.text)),n&&n.value&&Object.prototype.hasOwnProperty.call(n.value,"text")&&(a.push(n),r.push(n.value.text)),i&&i.value&&Object.prototype.hasOwnProperty.call(i.value,"text")&&(a.push(i),r.push(i.value.text)),{newFrame:{id:"TDRC",value:{text:r.join("-")}},dateFrames:a}}findOrAddColumn(t,e){let n=this.columns.find(a=>a.def.id===e.id&&a.def.subid===e.subid);if(n)return n;let i=this.frameDef2Column(e.id,e.subid,e.frameDef,Ae.findIndex(a=>o.matchColumn({id:e.id,value:e.subid?{id:e.subid}:void 0},a)));return this.columns.push(i),this.buildEdits(t),i}updateColumns(t,e){let n=[],i=[];for(let a of this.columns)e.find(c=>c.id===a.def.id&&c.subid===a.def.subid)||n.push(a);for(let a of e)if(!this.columns.find(c=>c.def.id===a.id&&c.def.subid===a.subid)){let c=this.frameDef2Column(a.id,a.subid,a.frameDef,0);i.push(c)}this.columns=this.columns.filter(a=>!n.includes(a)).concat(i),this.buildEdits(t)}static getRawTagFrames(t){let e=[];return Object.keys(t.frames).forEach(n=>{e=e.concat(t.frames[n])}),e}static getFrameDefName(t,e,n){let i=n.title,a=e||"";return n.impl===s.IdText?t==="TXXX"&&be[a]?i=be[a]:t==="UFID"&&Pe[a]?i=Pe[a]:e&&(i+=` (${e})`):n.impl===s.LangDescText?t==="COMM"&&xe[a]?i=xe[a]:e&&(i+=` (${e})`):n.impl===s.IdBin&&e&&(i+=` (${e})`),i}static matchColumn(t,e){return e.subid&&(!t.value||!t.value.id||t.value.id!==e.subid)?!1:t.id===e.id}getAutoCompleteList(t,e){if(t.def.id==="TCON")return Je;if(t.def.id==="TXXX"&&t.def.subid==="MusicBrainz Album Type")return["album","album/compilation","album/soundtrack","album/spokenword","album/interview","album/audiobook","album/audiodrama","album/live","album/remix","album/dj-mix","album/mixtape/street","single","ep","broadcast","other","other/spokenword","other/audiodrama","other/interview"];if(t.def.id==="TXXX"&&t.def.subid==="MusicBrainz Album Status")return["official","promotional","bootleg","pseudo-release"];if(t.def.id==="TPOS")return["1/1","1/2","2/2","1/3","2/3","3/3","1/4","2/4","3/4","4/4"];let n=this.columns.indexOf(t),i=[];for(let a of this.edits){let r=a.cells[n];if(r!==e&&r.frames.length>0&&r.frames[0].value&&r.frames[0].value.text){let c=r.frames[0].value.text;i.includes(c)||i.push(c)}}return t.def.id==="TPE2"&&!i.includes(qe)&&i.push(qe),i}setColumnActions(t,e,n,i){let a=[];[s.IdText,s.Text,s.LangDescText].includes(i)&&(t.multi=!0,e==="TRCK"?(a.push({icon:"icon-down-thin",title:"Set Track Nr by Index",click:()=>{this.setColumnTrackNrByIndex(t)}}),a.push({icon:"icon-down-thin",title:"Set Track Nr by Filename",click:()=>{this.setColumnTrackNrFromFile(t)}}),a.push({icon:"icon-down-thin",title:"Set Total Tracks",click:()=>{this.setColumnTotalTrack(t)}})):e==="TPOS"?a.push({icon:"icon-down-thin",title:"Try find Part of Set",click:()=>{this.setColumnPartOfSet(t)}}):e==="TIT2"?a.push({icon:"icon-down-thin",title:"Add Index Nr to Title",click:()=>{this.addIndexToTitleCol(t)}}):e==="TPE2"?a.push({icon:"icon-down-thin",title:"Copy from Artist Column",click:()=>{this.setAlbumArtistFrames(t)}}):e==="TALB"?a.push({icon:"icon-down-thin",title:"Copy from Title Column",click:()=>{this.setColumnFromTitleFrames(t)}}):e==="TDOR"?a.push({icon:"icon-down-thin",title:"Copy from Year Column",click:()=>{this.setReleaseDateFromYearFrames(t)}}):e==="USLT"&&a.push({icon:"icon-down-thin",title:"Search for missing Lyrics",click:()=>{this.findMissingLyrics().catch(r=>{console.error(r)})}})),i!==s.Filename?a.push({icon:"icon-remove",title:"Clear all Cells in this Column",click:()=>{this.clearColumn(t)}}):i===s.Filename&&a.push({icon:"icon-down-thin",title:"Set Filenames by Meta Data",click:()=>{this.setColumnFilenames(t)}}),t.actions=a}frameDef2Column(t,e,n,i){let a=o.getFrameDefName(t,e,n),r=n.impl;t==="UFID"&&Pe[e||""]&&(r=s.IdText);let c={def:{id:t,subid:e,name:a,width:i>=0?Ae[i].width:100,impl:r},sort:i>=0?i+1:-1,actions:[]};return this.setColumnActions(c,t,e,r),c.getAutoCompleteList=T=>this.getAutoCompleteList(c,T),c}frame2Column(t,e){let n={def:{id:t.id,name:t.id+(t.value&&t.value.id?` - ${t.value.id}`:""),subid:t.value&&t.value.id?t.value.id:void 0,width:e>=0?Ae[e].width:100,impl:s.Unknown},sort:e,actions:[]};return n.getAutoCompleteList=i=>this.getAutoCompleteList(n,i),n}buildColumns(t){this.columns=[],!(!t||t.length===0)&&(Ae.forEach((e,n)=>{if(e.force){let i=this.frameDef2Column(e.id,e.subid,D[e.id],n);this.columns.push(i)}}),t.forEach(e=>{if(!e.tagRaw||!e.tagRaw.frames)return;let n=o.getRawTagFrames(e.tagRaw);n.unshift({id:te,value:{text:e.name}});for(let i of n)if(!this.columns.find(r=>o.matchColumn(i,r.def))){let r=D[i.id],c=Ae.findIndex(T=>o.matchColumn(i,T));if(r){let T;i.value&&i.value.id!==void 0&&(T=i.value.id),this.columns.push(this.frameDef2Column(i.id,T,D[i.id],c))}else this.columns.push(this.frame2Column(i,c))}}))}buildEdits(t){this.columns.sort((i,a)=>i.sort<0?1:a.sort<0?-1:i.sort-a.sort);let e=(i,a,r,c,T)=>this.columns.map(A=>{let S=T?T.cells.find(N=>N.column.def.id===A.def.id&&N.column.def.subid===A.def.subid):void 0;return{parent:c,track:i,tag:a,column:A,frames:S?S.frames:r.filter(N=>o.matchColumn(N,A.def)),changed:S?S.changed:!1}}),n=this.edits||[];this.edits=t.map(i=>{let a=[];a.push({id:te,value:{text:i.name}}),i.tagRaw&&Object.keys(i.tagRaw.frames).forEach(T=>{a=a.concat(i.tagRaw?.frames[T]||[])});let r=n.find(T=>T.track===i),c={track:i,tag:i.tagRaw,cells:[],editing:!1,changed:r?r.changed:!1,saving:!1};return c.cells=e(i,i.tagRaw,a,c,r),c})}};var Ao=["actionMenu"],Ji=(o,t)=>t.def.id+t.def.subid,Ro=(o,t)=>t.track.id,vo=(o,t)=>t.column.def.id+t.column.def.subid;function bo(o,t){o&1&&M(0,"app-loading")}function xo(o,t){o&1&&(M(0,"i",11),$(1),h(2,1),F())}function No(o,t){o&1&&(M(0,"i",11),$(1),h(2,2),F())}function yo(o,t){o&1&&(M(0,"i",11),$(1),h(2,3),F())}function Io(o,t){o&1&&(M(0,"i",11),$(1),h(2,4),F())}function Do(o,t){o&1&&(M(0,"i",11),$(1),h(2,5),F())}function Lo(o,t){o&1&&(M(0,"i",11),$(1),h(2,6),F())}function wo(o,t){if(o&1){let e=P();d(0,"div",12),$(1),h(2,7),F(),M(3,"br"),$(4),h(5,8),F(),M(6,"br"),d(7,"button",16),f("click",function(){m(e);let i=u(2);return p(i.loadRecursive())}),M(8,"i",17),$(9),h(10,9),F(),l()()}}function ko(o,t){if(o&1){let e=P();d(0,"button",26),f("click",function(){m(e);let i=u(3);return p(i.save())}),M(1,"i",27),l()}}function Go(o,t){o&1&&(d(0,"button",24),M(1,"i",28),l())}function Bo(o,t){if(o&1){let e=P();d(0,"div",13)(1,"button",18),f("click",function(){m(e);let i=u(2);return p(i.refresh())}),M(2,"i",17),l(),d(3,"button",19),f("click",function(){m(e);let i=u(2);return p(i.brainz())}),M(4,"app-mb-icon",20),l(),d(5,"button",21),f("click",function(){m(e);let i=u(2);return p(i.chooseColumns())}),M(6,"i",22),l(),g(7,ko,2,0,"button",23),g(8,Go,2,0,"button",24),d(9,"button",25),f("click",function(i){m(e);let a=u(2);return p(a.onContextMenu(i))}),O(10,"\u2026"),l()()}if(o&2){let e=u(2);_(4),E("size",12),_(3),C(e.isSaving?-1:7),_(),C(e.isSaving?8:-1)}}function $o(o,t){o&1&&M(0,"app-loading")}function Fo(o,t){if(o&1){let e=P();d(0,"th",32),f("click",function(){let i=m(e).$implicit,a=u(3);return p(a.activeCol=i)}),d(1,"div")(2,"span",33),O(3),l()()()}if(o&2){let e=t.$implicit;_(2),E("title",e.def.id),_(),B(e.def.name)}}function Xo(o,t){if(o&1&&M(0,"col"),o&2){let e=t.$implicit;at("min-width",e.def.width||60,"px")}}function Uo(o,t){if(o&1){let e=P();d(0,"i",37),f("click",function(){m(e);let i=u(2).$implicit,a=u(3);return p(a.saveEdit(i))}),l()}}function Ho(o,t){o&1&&M(0,"i",36)}function zo(o,t){if(o&1&&(g(0,Uo,1,0,"i",27),g(1,Ho,1,0,"i",36)),o&2){let e=u().$implicit;C(e.saving?-1:0),_(),C(e.saving?1:-1)}}function Vo(o,t){if(o&1){let e=P();d(0,"td")(1,"app-cell-editor",38),f("navigKeyDownRequest",function(i){m(e);let a=u(4);return p(a.onCellEditorNavigationKeyDown(i))}),l()()}if(o&2){let e=t.$implicit;_(),oe("changed",e.changed),E("cell",e)}}function Wo(o,t){if(o&1&&(d(0,"tr")(1,"td",34)(2,"div",35),g(3,zo,2,2),l()(),y(4,Vo,2,3,"td",null,vo),l()),o&2){let e=t.$implicit;_(3),C(e.changed?3:-1),_(),I(e.cells)}}function jo(o,t){if(o&1&&(d(0,"div",15)(1,"table")(2,"thead")(3,"tr",29),M(4,"th"),y(5,Fo,4,2,"th",30,Ji),l()(),d(7,"colgroup"),M(8,"col"),y(9,Xo,1,2,"col",31,Ji),l(),d(11,"tbody"),y(12,Wo,6,1,"tr",null,Ro),l()()()),o&2){let e=u(2);_(5),I(e.editor.columns),_(3),at("min-width",40,"px"),_(),I(e.editor.columns),_(3),I(e.editor.edits)}}function qo(o,t){if(o&1){let e=P();g(0,wo,11,0,"div",12),g(1,Bo,11,3,"div",13),d(2,"app-admin-tag-editor-column-tool",14),f("requestClose",function(){m(e);let i=u();return p(i.activeCol=void 0)}),l(),g(3,$o,1,0,"app-loading"),g(4,jo,14,2,"div",15)}if(o&2){let e=u();C(e.canLoadRecursive?0:-1),_(),C(e.tracks&&e.tracks.length>0&&e.editor.edits?1:-1),_(),E("editor",e.editor)("activeCol",e.activeCol),_(),C(e.tracks?-1:3),_(),C(e.tracks&&e.tracks.length>0&&e.editor.edits?4:-1)}}var we=(()=>{class o{app;folderService;contextMenuService;jam;notify;dialogOverlay;folder;tracks;editor;canLoadRecursive=!1;activeCol;isSaving=!1;id;cellEditors;actionMenu;constructor(e,n,i,a,r,c){this.app=e,this.folderService=n,this.contextMenuService=i,this.jam=a,this.notify=r,this.dialogOverlay=c,this.editor=new ot(a)}onScroll(){}canDeactivate(){return!this.isSaving}ngOnChanges(){this.refresh()}refresh(){this.folder=void 0,this.tracks=void 0,this.activeCol=void 0,this.id&&this.jam.folder.id({id:this.id,folderIncFolders:!0,folderIncTracks:!0,folderIncParents:!0,folderIncTag:!0,trackIncTag:!0,trackIncRawTag:!0,folderChildIncTag:!0}).then(e=>{this.display(e)}).catch(e=>{this.notify.error(e)})}loadRecursive(){this.folder&&(this.canLoadRecursive=!1,this.tracks=void 0,this.jam.track.search({childOfID:this.folder.id,trackIncTag:!0,trackIncRawTag:!0,orderBy:Ci.filename}).then(e=>{this.tracks=e.items,this.editor.build(this.tracks)}).catch(e=>{this.notify.error(e)}))}onCellEditorNavigationKeyDown(e){if(Si(e.event)){let n=this.editor.edits.findIndex(a=>a===e.cell.parent),i=this.editor.edits[n+(Ri(e.event)?1:-1)];if(i){let a=i.cells[e.cell.parent.cells.indexOf(e.cell)];if(a){let r=this.cellEditors.find(c=>c.cell===a);r&&setTimeout(()=>{r.navigTo()})}}}else if(Pi(e.event)){let n=e.cell.parent.cells[e.cell.parent.cells.indexOf(e.cell)+(Ai(e.event)?1:-1)];if(n){let i=this.cellEditors.find(a=>a.cell===n);i&&setTimeout(()=>{i.navigTo()})}}}save(){if(this.isSaving)return;let e=this.editor.edits.filter(a=>a.changed);if(e.length===0)return;let n=[];for(let a of e)a.saving=!0,n.push(this.prepareEditSave(a));let i=n.shift();i&&(this.isSaving=!0,this.runSave(i,n).then(()=>{this.isSaving=!1}).catch(a=>{this.isSaving=!1;for(let r of e)r.saving=!1;this.notify.error(a)}))}prepareEditSave(e){let n={edit:e,track:e.track},i=e.cells.filter(r=>r.changed),a=i.find(r=>r.column.def.id===te);if(a){i=i.filter(c=>c.column.def.id!==te);let r=a.frames[0].value.text;r&&e.track.name!==r&&(n.filename=r)}return i.length>0&&(n.rawTag=nt(e)),n}saveEdit(e){if(!e.changed||this.isSaving)return;this.isSaving=!0;let n=this.prepareEditSave(e);this.runSave(n,[]).then(()=>{this.isSaving=!1}).catch(i=>{this.isSaving=!1,this.notify.error(i)})}chooseColumns(){this.isSaving&&this.notify.error(Error("Saving is in progress"));let e={columns:this.editor.columns,resultColumns:[]};this.dialogOverlay.open({title:"Choose Columns",childComponent:Et,panelClass:"overlay-panel-large-buttons",data:e,onOkBtn:()=>R(this,null,function*(){try{this.tracks&&this.editor.updateColumns(this.tracks,e.resultColumns)}catch(n){return this.notify.error(n),Promise.reject(n)}}),onCancelBtn:()=>R(this,null,function*(){return Promise.resolve()})})}brainz(){if(!this.folder||!this.tracks)return;this.canDeactivate()||this.notify.error(Error("Saving is in progress"));let e={folder:this.folder,matchings:this.tracks.map(n=>({track:n})),apply:()=>{for(let n of e.matchings)n.track&&n.rawTag&&(n.track.tagRaw=n.rawTag);if(this.tracks){this.editor.build(this.tracks);for(let n of e.matchings)if(n.track&&n.rawTag){let i=this.editor.edits.find(a=>a.track===n.track);if(i){i.changed=!0;for(let a of i.cells)a.column.def.id!==te&&(a.changed=!0)}}}}};this.dialogOverlay.open({title:"Release Matching",childComponent:Ne,data:e,panelClass:"overlay-panel-large"})}editAlbumValues(){if(this.canDeactivate()||this.notify.error(Error("Saving is in progress")),!this.tracks)return;let e={tracks:this.tracks};this.dialogOverlay.open({title:"Edit Album Values",childComponent:Ot,data:e,onOkBtn:()=>R(this,null,function*(){return Promise.resolve()}),onCancelBtn:()=>R(this,null,function*(){return Promise.resolve()})})}onContextMenu(e){this.contextMenuService.show.next({contextMenu:this.actionMenu,event:e,item:void 0}),e.preventDefault(),e.stopPropagation()}runSave(e,n){return R(this,null,function*(){try{if(e.filename){let a=yield this.jam.track.rename({id:e.track.id,name:e.filename});this.folderService.waitForQueueResult("Renaming Track",a,[e.track.parentID],[],[e.track.id])}if(e.rawTag){let a=yield this.jam.track.rawTagSet({id:e.track.id,tag:e.rawTag});this.folderService.waitForQueueResult("Writing Track Tag",a,[e.track.parentID],[],[e.track.id])}e.edit.saving=!1,e.rawTag&&(e.edit.tag=e.rawTag),e.edit.changed=!1}catch(a){return Promise.reject(a)}let i=n.shift();i&&(yield this.runSave(i,n))})}display(e){this.folder=e,this.tracks=e.tracks||[],this.editor.build(this.tracks),this.canLoadRecursive=this.tracks.length===0&&(e.folders||[]).length>0,this.canLoadRecursive&&e.type===hi.multialbum&&this.loadRecursive()}static \u0275fac=function(n){return new(n||o)(L(Ce),L(fi),L(Ue),L(ge),L(Ee),L(We))};static \u0275cmp=v({type:o,selectors:[["app-admin-tag-editor"]],viewQuery:function(n,i){if(n&1&&(Y(Ao,5),Y(Te,5)),n&2){let a;Q(a=Z())&&(i.actionMenu=a.first),Q(a=Z())&&(i.cellEditors=a)}},hostBindings:function(n,i){n&1&&f("beforeunload",function(){return i.canDeactivate()},Ut)},inputs:{id:"id"},standalone:!1,features:[q],decls:10,vars:2,consts:()=>{let e;e=$localize`:␟d00dbae4a3e4f5fb5287c3ef6fde8035dc5a79f5␟9064106308242024618:Set Audiobook Frames`;let n;n=$localize`:␟116ee2407dea6f965ec08ff5bb957760df6e2a85␟6656311361426574635:Set Audio Series Frames`;let i;i=$localize`:␟2e873296abc631156e0a97d7e843751195b38829␟63335187416623423:Set Soundtrack Frames`;let a;a=$localize`:␟257a97bb09d914993dd99f36ffd6e9a6a93f8a17␟5117338775318483791:Set Bootleg Frames`;let r;r=$localize`:␟eeb69f5267a060943ed0dc902afd909d53a412f8␟6494641063048624386:Set Various Artists Compilation Frames`;let c;c=$localize`:␟16a5908d3ecf5faa7a16cf0303c1ae1fb559a6cc␟6928752720245775068:Search & Fill Missing Lyrics Frames`;let T;T=$localize`:␟c41714c6798a576f0adf11857f08f0db361d15d7␟3968113785629853013:Load all Tracks`;let A;A=$localize`:␟60b5e271ee1483cf2fc9c49d0b861258f490661d␟930157484605471697:This folder does not contain any tracks with tags.`;let S;S=$localize`:␟2ea320c88da8bc29388471e4b48d5c1f0c8d620e␟7184376553461822627:Do you want to load all tracks from subfolders?`;let N;N=$localize`:␟dca3a8d76fb406f412af59611c7bf2dd739df4b5␟6250552114791622521:Load recursive`;let x;x=$localize`:␟c8d1785038d461ec66b5799db21864182b35900a␟1102717806459547726:Refresh`;let ie;ie=$localize`:␟3f74c61be995a66526e146600cd47c901b71604f␟6520843897216456434:Match with MusicBrainz`;let se;se=$localize`:␟9695ccaa90cd56b8b6822739823bd35e4ef835b7␟1194863084167414951:Choose Columns`;let ne;ne=$localize`:␟52c9a103b812f258bcddc3d90a6e3f46871d25fe␟3768927257183755959:Save`;let le;le=$localize`:␟52c9a103b812f258bcddc3d90a6e3f46871d25fe␟3768927257183755959:Save`;let ce;return ce=$localize`:␟ac0f81713a84217c9bd1d9bb460245d8190b073f␟5937251202465808296:More`,[["actionMenu",""],e,n,i,a,r,c,A,S,N,["contextMenuItem","",3,"execute"],[1,"icon-edit"],[1,"load-recursive"],[1,"actions"],[3,"requestClose","editor","activeCol"],[1,"editor"],["title",T,1,"button-on-control",3,"click"],[1,"icon-reload"],["title",x,1,"button-on-control",3,"click"],["title",ie,1,"button-on-control",3,"click"],[3,"size"],["title",se,1,"button-on-control",3,"click"],[1,"icon-list-add"],["title",ne,1,"button-on-control"],["title",le,1,"button-on-control"],["title",ce,1,"button-on-control",3,"click"],["title",ne,1,"button-on-control",3,"click"],[1,"icon-floppy"],[1,"icon-spin","icon-spnner"],[1,"header-row"],[1,"header-row-title"],[3,"min-width"],[1,"header-row-title",3,"click"],[3,"title"],[1,"col-state"],[1,"cell-editor"],[1,"icon-spin","icon-spinner"],[1,"icon-floppy",3,"click"],[1,"cell-editor",3,"navigKeyDownRequest","cell"]]},template:function(n,i){if(n&1){let a=P();g(0,bo,1,0,"app-loading"),d(1,"context-menu",null,0),K(3,xo,3,0,"ng-template",10),f("execute",function(){return m(a),p(i.editor.setAudiobookFrames(i.tracks))}),K(4,No,3,0,"ng-template",10),f("execute",function(){return m(a),p(i.editor.setAudioSeriesFrames(i.tracks))}),K(5,yo,3,0,"ng-template",10),f("execute",function(){return m(a),p(i.editor.setSoundtrackFrames(i.tracks))}),K(6,Io,3,0,"ng-template",10),f("execute",function(){return m(a),p(i.editor.setBootlegFrames(i.tracks))}),K(7,Do,3,0,"ng-template",10),f("execute",function(){return m(a),p(i.editor.setVariousArtistFrames(i.tracks))}),K(8,Lo,3,0,"ng-template",10),f("execute",function(){return m(a),p(i.editor.findMissingLyrics(i.tracks))}),l(),g(9,qo,5,6)}n&2&&(C(i.folder?-1:0),_(9),C(i.folder?9:-1))},dependencies:[vi,bi,ze,He,Tt,Mt],styles:["[_nghost-%COMP%]{height:100%;width:100%;overflow:hidden;display:flex;flex-direction:column}[_nghost-%COMP%]   .actions[_ngcontent-%COMP%]{padding:10px 15px 0;border-bottom-color:var(--background-border);border-bottom-width:1px;border-bottom-style:solid}[_nghost-%COMP%]   .actions[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{margin-right:5px;margin-bottom:10px}[_nghost-%COMP%]   .actions[_ngcontent-%COMP%] > label[_ngcontent-%COMP%]{text-transform:uppercase;letter-spacing:1px;font-size:11px;margin-left:5px;margin-right:5px}[_nghost-%COMP%]   .load-recursive[_ngcontent-%COMP%]{text-align:center;margin-top:30px;margin-left:30px;margin-right:30px}[_nghost-%COMP%]   .load-recursive[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-top:10px}[_nghost-%COMP%]   .editor[_ngcontent-%COMP%]{width:100%;height:100%;display:block;position:relative;overflow:auto}[_nghost-%COMP%]   .editor[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{table-layout:fixed;border-width:0;width:auto}[_nghost-%COMP%]   .editor[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .cell-editor[_ngcontent-%COMP%]{width:100%;height:34px;border-top-width:1px;border-top-style:solid;border-left-width:1px;border-left-style:solid;text-align:left;padding-bottom:1px;padding-top:1px;font-size:11px;color:var(--on-background);border-color:var(--background-border);overflow:hidden;display:flex;align-items:center}[_nghost-%COMP%]   .editor[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .cell-editor.changed[_ngcontent-%COMP%]{padding-bottom:0;padding-top:0;border-width:1px;border-style:solid;border-left-width:2px;border-top-width:2px;border-color:var(--background-box)}[_nghost-%COMP%]   .editor[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .cell-editor[_ngcontent-%COMP%]:focus-within{padding-bottom:0;padding-top:0;border-width:1px;border-style:solid;border-left-width:2px;border-top-width:2px;color:var(--on-background-highlight)}[_nghost-%COMP%]   .editor[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{border-right-width:1px;border-right-style:solid;border-right-color:var(--background-border)}[_nghost-%COMP%]   .editor[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr.header-row[_ngcontent-%COMP%]{border-top-width:1px;border-top-style:solid;border-top-color:var(--background-border)}[_nghost-%COMP%]   .editor[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr.header-row[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;font-size:.8em;padding-left:4px;padding-right:4px;border-top:none;border-bottom:none;color:var(--on-background-highlight);background-color:var(--background);position:sticky}[_nghost-%COMP%]   .editor[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr.header-row[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{padding:0;visibility:hidden}[_nghost-%COMP%]   .editor[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr.header-row[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:hover   .actions[_ngcontent-%COMP%]{visibility:inherit}[_nghost-%COMP%]   .editor[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th.header-row-title[_ngcontent-%COMP%]{cursor:pointer;-webkit-user-select:none;user-select:none}[_nghost-%COMP%]   .editor[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border:none;max-width:200px}[_nghost-%COMP%]   .editor[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td.col-state[_ngcontent-%COMP%]{text-align:center;width:40px}[_nghost-%COMP%]   .editor[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td.col-state[_ngcontent-%COMP%]   .cell-editor[_ngcontent-%COMP%]{padding-top:6px;font-size:18px}[_nghost-%COMP%]   .editor[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:last-of-type   .cell-editor[_ngcontent-%COMP%]{border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:var(--background-border)}"]})}return o})();var ke=(()=>{class o{route;id;child;unsubscribe=new Oe;constructor(e){this.route=e}ngOnInit(){this.route.parent?.parent?.params&&this.route.parent.parent.params.pipe(he(this.unsubscribe)).subscribe(e=>{this.id=e.id})}ngOnDestroy(){this.unsubscribe.next(),this.unsubscribe.complete()}canDeactivate(){return!!(this.child&&this.child.canDeactivate())}static \u0275fac=function(n){return new(n||o)(L(Ti))};static \u0275cmp=v({type:o,selectors:[["app-admin-folder-tag-editor"]],viewQuery:function(n,i){if(n&1&&Y(we,7),n&2){let a;Q(a=Z())&&(i.child=a.first)}},standalone:!1,decls:1,vars:1,consts:[[3,"id"]],template:function(n,i){n&1&&M(0,"app-admin-tag-editor",0),n&2&&E("id",i.id)},styles:["[_nghost-%COMP%]{height:100%;width:100%;overflow:hidden;display:block}"]})}return o})();function Qo(o,t){if(o&1&&(d(0,"div")(1,"span",15),h(2,5),l(),O(3,"\xA0"),d(4,"span",17),O(5),l()()),o&2){let e=u(2).$implicit;_(5),B(e.abdata.moods)}}function Zo(o,t){o&1&&(d(0,"div")(1,"span",15),h(2,6),l(),O(3,"\xA0"),d(4,"span",17),h(5,7),l()())}function ea(o,t){if(o&1&&(d(0,"div")(1,"span",15),h(2,1),l(),O(3,"\xA0"),d(4,"span",16),O(5),l(),O(6,"\xA0 "),d(7,"span",15),h(8,2),l(),O(9,"\xA0"),d(10,"span",17),O(11),l(),O(12,"\xA0 "),d(13,"span",15),h(14,3),l(),O(15,"\xA0"),d(16,"span",17),O(17),ae(18,"mbArtistCredits"),l(),O(19,"\xA0 "),d(20,"span",15),h(21,4),l(),O(22,"\xA0"),d(23,"span",17),O(24),l(),O(25,"\xA0 "),g(26,Qo,6,1,"div"),g(27,Zo,6,0,"div"),l()),o&2){let e=u().$implicit;_(5),B(e.mbTrack.position),_(6),B(e.mbTrack.title||"?"),_(6),B(de(18,6,e.mbTrack.artistCredit)),_(7),B((e.mbRelease==null?null:e.mbRelease.title)||"?"),_(2),C(e.abdata?26:-1),_(),C(e.lyrics?27:-1)}}function ta(o,t){if(o&1){let e=P();d(0,"div",11),f("dragstart",function(i){let a=m(e).$implicit,r=u();return p(r.drag(i,a))}),d(1,"div",12),M(2,"span",13),l(),d(3,"div",14),O(4),g(5,ea,28,8,"div"),l()()}if(o&2){let e=t.$implicit;_(4),X(" ",e.track.name," "),_(),C(e.mbTrack?5:-1)}}var Lt=(()=>{class o{cd;matchings=[];dragStartRequest=new j;constructor(e){this.cd=e}drag(e,n){this.cd.markForCheck(),e.dataTransfer&&e.dataTransfer.setData("text",n.track.id)}static \u0275fac=function(n){return new(n||o)(L(si))};static \u0275cmp=v({type:o,selectors:[["app-match-file-list"]],inputs:{matchings:"matchings"},outputs:{dragStartRequest:"dragStartRequest"},standalone:!1,decls:5,vars:1,consts:()=>{let e;e=$localize`:␟47d8f933b9e780457fa67f554a6541ece2e319c2␟813409290835006132:${"\uFFFD0\uFFFD"}:INTERPOLATION: Tracks`;let n;n=$localize`:␟62105695c62cfa82a2676943102f9fc3c887bc48␟443542841142643147:TrackNr:`;let i;i=$localize`:␟8737210008395d7b014e5118d2ed198ae9745215␟2517309683610083249:Title:`;let a;a=$localize`:␟7918b6e7567484cccee5e53dca8985639a43479e␟3140202407838809744:Artist:`;let r;r=$localize`:␟ce99fbb2724383169925d4042ed56a458b5cdfc8␟1276947660844876641:Album:`;let c;c=$localize`:␟06c55f883d53d51c34401167ec5fec8dda96de4e␟6458132837581302237:Moods:`;let T;T=$localize`:␟35242a5d250cd67e3698ca65dc94729706a57e9e␟1342610846383662061:Lyrics:`;let A;return A=$localize`:␟0594812d4c50c2adbd1a892a3497c4e5c19e4b32␟6286037250766429054:yes`,[e,n,i,a,r,c,T,A,[1,"match-file-list"],[1,"match-file-list-header"],["draggable","true",1,"match-file"],["draggable","true",1,"match-file",3,"dragstart"],[1,"handle"],[1,"grippy"],[1,"title"],[1,"label"],[1,"currentRelease"],[1,"value"]]},template:function(n,i){n&1&&(d(0,"div",8)(1,"div",9),h(2,0),l(),y(3,ta,6,2,"div",10,J),l()),n&2&&(_(2),Jt(i.matchings.length),Yt(2),_(),I(i.matchings))},dependencies:[je],styles:['[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]{display:flex;flex-flow:column wrap;-webkit-user-select:none;user-select:none;width:100%;padding-top:5px;background-color:var(--background);color:var(--on-background);margin-bottom:15px}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file-list-header[_ngcontent-%COMP%]{text-align:center;padding-bottom:5px}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]{min-height:48px;display:flex;flex-flow:row nowrap;align-items:center;align-content:space-evenly;width:100%;padding:10px;line-height:1.25em;margin-bottom:1px;border-top-width:1px;border-top-style:solid;border-bottom-width:0;border-bottom-style:solid;border-bottom-color:var(--background-border);border-top-color:var(--background-border)}@media (max-width: 1000px){[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]{height:auto}}@media (max-width: 522px){[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]{font-size:.9em}}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .number[_ngcontent-%COMP%]{min-width:32px;text-align:right}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .play-count[_ngcontent-%COMP%]{min-width:20px;text-align:right}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .rating[_ngcontent-%COMP%]{min-width:30px;text-align:center}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .play-date[_ngcontent-%COMP%]{min-width:100px}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .fav[_ngcontent-%COMP%]{min-width:30px;text-align:center}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{flex-grow:1}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .length[_ngcontent-%COMP%]{min-width:80px;text-align:right}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{margin-left:15px}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:last-of-type{margin-right:15px}@media (max-width: 400px){[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{margin-left:0}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:last-of-type{margin-right:0}}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]:hover{background-color:var(--background-hover)}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]:last-child{border-bottom-width:1px}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .small-screen-icon[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{color:var(--on-background-highlight)}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--on-background);font-size:.8em}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{padding:0;display:inline-block;margin:0 10px 0 0}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{font-size:.8em;vertical-align:middle}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   a.title-link[_ngcontent-%COMP%]{font-size:inherit;margin-right:10px;color:var(--on-background-highlight)}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--on-background)}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:var(--on-background-hover)}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]{width:0;margin-left:0;cursor:move}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]   span.grippy[_ngcontent-%COMP%]{display:inline-block;width:26px;height:8px;transform:rotate(90deg);margin-left:-8px}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]   span.grippy[_ngcontent-%COMP%], [_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]   span.grippy[_ngcontent-%COMP%]:before{background-image:radial-gradient(#7b7b7b 40%,transparent 40%);background-size:4px 4px;background-position:0 100%;background-repeat:repeat-x}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]   span.grippy[_ngcontent-%COMP%]:before{content:"";display:block;width:100%;height:33%}@media (max-width: 1000px){[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]{height:auto;min-height:48px}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{display:block}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:inline-block;margin-left:0}}@media (max-width: 400px){[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]{flex-flow:row wrap;align-items:inherit;width:100%;font-size:.9em}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .small-screen-icon[_ngcontent-%COMP%]{display:inline-block}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]{order:2;width:25%;text-align:center}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]   span.grippy[_ngcontent-%COMP%]{transform:rotate(0)}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{order:6;margin-left:0;margin-right:0;padding-right:0;padding-left:0;width:100%}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{margin-left:0;margin-right:0;padding-right:0;padding-left:0;overflow:hidden;text-overflow:ellipsis}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{width:100%;margin-left:0;margin-right:0;overflow:hidden;text-overflow:ellipsis}}@media (max-width: 1200px){[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .fav[_ngcontent-%COMP%]{display:none}}@media (max-width: 400px){[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .number[_ngcontent-%COMP%], [_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .play-count[_ngcontent-%COMP%], [_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .rating[_ngcontent-%COMP%], [_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .play-date[_ngcontent-%COMP%], [_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .length[_ngcontent-%COMP%]{margin-left:0;margin-right:0;padding-right:0;padding-left:0;font-size:.8em;width:30%;flex-grow:1;text-align:center}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .number[_ngcontent-%COMP%]{order:1;width:25%;text-align:left}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .play-count[_ngcontent-%COMP%]{order:2}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .rating[_ngcontent-%COMP%]{order:3}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .play-date[_ngcontent-%COMP%]{order:4}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .length[_ngcontent-%COMP%]{order:5;width:25%;text-align:right}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{order:6}}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]{padding-left:0}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:11px}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   span.value[_ngcontent-%COMP%]{color:var(--on-background-highlight);padding-right:5px}@media (max-width: 768px){[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]{display:none}}']})}return o})();var na=(o,t)=>({"button-primary":o,"button-on-background":t}),oa=o=>({missing:o});function aa(o,t){if(o&1&&(d(0,"span",18),O(1),l()),o&2){let e=u(2).$implicit;_(),B(e.mbGroup.artistCredit[0].name)}}function ra(o,t){if(o&1&&O(0),o&2){let e=t.$implicit;X(" /",e," ")}}function sa(o,t){if(o&1&&y(0,ra,1,1,null,null,J),o&2){let e=u(2).$implicit;I(e.mbGroup.secondaryTypes)}}function la(o,t){o&1&&M(0,"i",26)}function ca(o,t){o&1&&M(0,"i",27)}function da(o,t){if(o&1&&(d(0,"span",18),O(1),g(2,la,1,0,"i",26),g(3,ca,1,0,"i",27),l()),o&2){let e=t.$implicit;_(),X("",e.tracks.length," "),_(),C(e.complete?2:-1),_(),C(e.complete?-1:3)}}function _a(o,t){if(o&1&&(d(0,"span",24),h(1,6),l(),d(2,"span",18),O(3),l()),o&2){let e=u(2).$implicit;_(3),B(e.currentRelease.totalTrack)}}function ua(o,t){if(o&1&&(d(0,"div",19)(1,"span",24),h(2,0),l(),d(3,"span",18),M(4,"app-score-box",25),l(),d(5,"span",24),h(6,1),l(),g(7,aa,2,1,"span",18),d(8,"span",24),h(9,2),l(),d(10,"span",18),O(11),g(12,sa,2,0),l(),M(13,"br"),d(14,"span",24),h(15,3),l(),d(16,"span",18),O(17),l(),d(18,"span",24),h(19,4),l(),d(20,"span",18),O(21),l(),M(22,"br"),d(23,"span",24),h(24,5),l(),y(25,da,4,3,"span",18,J),g(27,_a,4,1),l()),o&2){let e=u().$implicit;_(4),E("score",e.currentRelease.score),_(3),C(e.mbGroup.artistCredit?7:-1),_(4),X("",e.mbGroup.primaryType," "),_(),C(e.mbGroup.secondaryTypes?12:-1),_(5),B(e.currentRelease.mbRelease.date||"?"),_(4),B(e.currentRelease.mbRelease.country||"?"),_(4),I(e.currentRelease.media),_(2),C(e.currentRelease.media.length>1?27:-1)}}function ma(o,t){if(o&1){let e=P();d(0,"button",28),f("click",function(){m(e);let i=u().$implicit;return p(i.expanded=!i.expanded)}),h(1,7),l()}}function pa(o,t){if(o&1){let e=P();d(0,"button",28),f("click",function(){m(e);let i=u().$implicit;return p(i.selecting=!i.selecting)}),h(1,8),l()}}function ga(o,t){if(o&1){let e=P();d(0,"button",29),f("click",function(){m(e);let i=u().$implicit,a=u(2);return p(a.chooseRelease(i,i.currentRelease))}),h(1,9),l()}if(o&2){let e=u().$implicit;E("ngClass",ai(1,na,e.currentRelease.complete,!e.currentRelease.complete))}}function Ca(o,t){o&1&&O(0," / ")}function ha(o,t){if(o&1&&(g(0,Ca,1,0),O(1)),o&2){let e=t.$implicit,n=t.$index;C(n>0?0:-1),_(),X(" ",e.trackCount," ")}}function fa(o,t){if(o&1&&y(0,ha,2,2,null,null,J),o&2){let e=u().$implicit;I(e.mbRelease.media)}}function Ta(o,t){o&1&&O(0," ? ")}function Ma(o,t){if(o&1){let e=P();d(0,"label",31),f("click",function(){let i=m(e).$implicit,a=u(2).$implicit,r=u(2);return p(r.matcher.setRelease(a,i))}),M(1,"input",32),d(2,"span",24),h(3,10),l(),d(4,"span",18),M(5,"app-score-box",25),l(),d(6,"span",24),h(7,11),l(),d(8,"span",18),O(9),l(),d(10,"span",24),h(11,12),l(),d(12,"span",18),O(13),l(),d(14,"span",24),h(15,13),l(),d(16,"span",18),g(17,fa,2,0),g(18,Ta,1,0),l()()}if(o&2){let e=t.$implicit,n=u(2).$implicit;_(),E("checked",e===n.currentRelease),_(4),E("score",e.score),_(4),B(e.mbRelease.date||"?"),_(4),B(e.mbRelease.country||"?"),_(4),C(e.mbRelease.media?17:-1),_(),C(e.mbRelease.media?-1:18)}}function Oa(o,t){if(o&1&&(d(0,"div")(1,"form")(2,"fieldset"),y(3,Ma,19,6,"label",30,J),l()()()),o&2){let e=u().$implicit;_(3),I(e.releases)}}function Ea(o,t){o&1&&M(0,"i",34)}function Sa(o,t){o&1&&M(0,"i",35)}function Pa(o,t){if(o&1){let e=P();d(0,"div",33),f("click",function(){m(e);let i=u().$implicit;return p(i.expanded=!i.expanded)}),M(1,"i"),ae(2,"stringToggle"),$(3),h(4,14),F(),O(5),g(6,Ea,1,0,"i",34),g(7,Sa,1,0,"i",35),l()}if(o&2){let e=u().$implicit;_(),Zt(ri(2,5,e.expanded,"icon-minus","icon-plus")),_(4),X(" ",e.mbMedia.position," "),_(),C(e.complete?6:-1),_(),C(e.complete?-1:7)}}function Aa(o,t){if(o&1){let e=P();d(0,"div",38),ae(1,"number"),ae(2,"json"),M(3,"app-score-box",25),d(4,"a",39),f("click",function(){m(e);let i=u().$implicit,a=u(4).$implicit,r=u(2);return p(r.matcher.removeMatching(a,a.currentRelease,i))}),M(5,"i",40),l(),O(6),l()}if(o&2){let e=u().$implicit;E("title",ii("Score: ",de(1,5,e.currentMatch.score)," ",de(2,7,e.currentMatch.scores))),_(3),E("score",e.currentMatch.score),_(3),X(" ",e.currentMatch.match.track.name," ")}}function Ra(o,t){if(o&1){let e=P();d(0,"div",37),f("drop",function(i){let a=m(e).$implicit,r=u(4).$implicit,c=u(2);return p(c.drop(i,r,r.currentRelease,a))})("dragover",function(i){m(e);let a=u(6);return p(a.allowDrop(i))}),O(1),ae(2,"mbArtistCredits"),g(3,Aa,7,9,"div",38),l()}if(o&2){let e=t.$implicit;E("ngClass",oi(7,oa,!e.currentMatch)),_(),ti(" ",e.mbTrack.position," - ",e.mbTrack.title," - ",de(2,5,e.mbTrack.artistCredit)," "),_(2),C(e.currentMatch?3:-1)}}function va(o,t){if(o&1&&(d(0,"div"),y(1,Ra,4,9,"div",36,J),l()),o&2){let e=u().$implicit;_(),I(e.tracks)}}function ba(o,t){if(o&1&&(d(0,"div"),g(1,Pa,8,9,"div"),g(2,va,3,0,"div"),l()),o&2){let e=t.$implicit,n=t.$count;_(),C(n>1?1:-1),_(),C(e.expanded||n<2?2:-1)}}function xa(o,t){if(o&1&&(d(0,"div",23),y(1,ba,3,2,"div",null,J),l()),o&2){let e=u().$implicit;_(),I(e.currentRelease.media)}}function Na(o,t){if(o&1&&(d(0,"div",16)(1,"div",17)(2,"span",18),O(3),l()(),g(4,ua,28,7,"div",19),d(5,"div",20),g(6,ma,2,0,"button",21),g(7,pa,2,0,"button",21),g(8,ga,2,4,"button",22),g(9,Oa,5,0,"div"),l(),g(10,xa,3,0,"div",23),l()),o&2){let e=t.$implicit,n=u(2);_(3),B(e.mbGroup.title),_(),C(e.currentRelease?4:-1),_(2),C(n.matcher.isRunning?-1:6),_(),C(!n.matcher.isRunning&&e.releases.length>1?7:-1),_(),C(!n.matcher.isRunning&&e.currentRelease?8:-1),_(),C(e.selecting?9:-1),_(),C(e.expanded&&e.currentRelease?10:-1)}}function ya(o,t){if(o&1&&(d(0,"div",15),y(1,Na,11,7,"div",16,J),l()),o&2){let e=u();_(),I(e.matcher.matchTree.groups)}}var wt=(()=>{class o{matcher;chooseReleaseRequest=new j;chooseRelease(e,n){this.chooseReleaseRequest.emit({group:e,release:n})}allowDrop(e){e.preventDefault()}drop(e,n,i,a){if(e.preventDefault(),!e.dataTransfer)return;let r=e.dataTransfer.getData("text");this.matcher?.selectMatch(r,n,i,a)}static \u0275fac=function(n){return new(n||o)};static \u0275cmp=v({type:o,selectors:[["app-match-results"]],inputs:{matcher:"matcher"},outputs:{chooseReleaseRequest:"chooseReleaseRequest"},standalone:!1,decls:1,vars:1,consts:()=>{let e;e=$localize`:␟9c5fdf21ec2cc7baa6f062f2dc417af45c8dbe60␟2332107018974972998:Score:`;let n;n=$localize`:␟181d9cc99eed91d7852bd736b8a79c5907b45171␟2179591033024116895:Artist: `;let i;i=$localize`:␟61402178af0b9f5caed0039f945af2a1aa44a199␟5368772156211954254:Type: `;let a;a=$localize`:␟05fa0bded36de6e73a1fa44838b627349dace044␟6899410641137821757:Date:`;let r;r=$localize`:␟33d64f1b5578cd3ff6413272a9bf0384e9c8626b␟4863373404095396982:Country:`;let c;c=$localize`:␟65bf4c02f9a036e9636d10cf81f1b20d7ed4aaf9␟5867760138967480184:Tracks:`;let T;T=$localize`:␟531e01644fee19759b4ce5a878390932ef913389␟8058716232090816784:All tracks matched`;let A;A=$localize`:␟095b08f20cb01fbf9e6c14b9cc035aac5590010d␟7216252099739448639:Unmatched tracks!`;let S;S=$localize`:␟7879085ff555563b56e31cc46b16fe088b1e491e␟8270728553315605434:Total Tracks:`;let N;N=$localize`:␟cb98522066062d775f3b81f29c898a7cc76292c0␟1575810254412583888:Tracks`;let x;x=$localize`:␟43e86094b83c2bf239e942d85e71da6e8d64fb63␟4587452935087847438:Releases`;let ie;ie=$localize`:␟0ba8f2b283773330626571f482bea4faf3353d3b␟5992669063673581330:Choose `;let se;se=$localize`:␟9c5fdf21ec2cc7baa6f062f2dc417af45c8dbe60␟2332107018974972998:Score:`;let ne;ne=$localize`:␟05fa0bded36de6e73a1fa44838b627349dace044␟6899410641137821757:Date:`;let le;le=$localize`:␟33d64f1b5578cd3ff6413272a9bf0384e9c8626b␟4863373404095396982:Country:`;let ce;ce=$localize`:␟65bf4c02f9a036e9636d10cf81f1b20d7ed4aaf9␟5867760138967480184:Tracks:`;let b;b=$localize`:␟531e01644fee19759b4ce5a878390932ef913389␟8058716232090816784:All tracks matched`;let kt;kt=$localize`:␟095b08f20cb01fbf9e6c14b9cc035aac5590010d␟7216252099739448639:Unmatched tracks!`;let Gt;Gt=$localize`:␟8a27a855a00b08d2ca981207638ea9097032412b␟3250391385569692601:Media`;let Bt;return Bt=$localize`:␟588011b76eaa42ff648f34c6418d8732f3b894b8␟6043994951771855575:Remove Matching`,[e,n,i,a,r,c,S,N,x,ie,se,ne,le,ce,Gt,[1,"match-results"],[1,"match-releasegroup"],[1,"match-releasegroup-title"],[1,"value"],[1,"match-release-info"],[1,"match-select-releases"],[1,"button-on-background"],[1,"button-primary",3,"ngClass"],[1,"match-tracks-info"],[1,"label"],[3,"score"],["title",T,1,"icon-checkmark"],["title",A,1,"icon-warning"],[1,"button-on-background",3,"click"],[1,"button-primary",3,"click","ngClass"],[1,"select"],[1,"select",3,"click"],["type","radio","name","release",3,"checked"],[3,"click"],["title",b,1,"icon-checkmark"],["title",kt,1,"icon-warning"],[1,"match-track-info",3,"ngClass"],[1,"match-track-info",3,"drop","dragover","ngClass"],[3,"title"],["title",Bt,3,"click"],[1,"icon-trash"]]},template:function(n,i){n&1&&g(0,ya,3,0,"div",15),n&2&&C(i.matcher?0:-1)},dependencies:[li,pe,ue,me,It,Xe,xi,je,Ei],styles:["[_nghost-%COMP%]   .match-results[_ngcontent-%COMP%]{flex:1 1 auto;overflow-y:auto;overflow-x:auto}[_nghost-%COMP%]   .match-results[_ngcontent-%COMP%]   .icon-checkmark[_ngcontent-%COMP%]{color:var(--primary)}[_nghost-%COMP%]   .match-results[_ngcontent-%COMP%]   .icon-warning[_ngcontent-%COMP%]{color:var(--accent)}[_nghost-%COMP%]   .match-results[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:var(--on-background-highlight);padding-right:5px}[_nghost-%COMP%]   .match-results[_ngcontent-%COMP%]   .match-releasegroup[_ngcontent-%COMP%]{padding:5px 5px 5px 15px}[_nghost-%COMP%]   .match-results[_ngcontent-%COMP%]   .match-releasegroup[_ngcontent-%COMP%]   .match-release-info[_ngcontent-%COMP%], [_nghost-%COMP%]   .match-results[_ngcontent-%COMP%]   .match-releasegroup[_ngcontent-%COMP%]   .match-tracks-info[_ngcontent-%COMP%]{font-size:.8em}[_nghost-%COMP%]   .match-results[_ngcontent-%COMP%]   .match-releasegroup[_ngcontent-%COMP%]   .match-release-info[_ngcontent-%COMP%], [_nghost-%COMP%]   .match-results[_ngcontent-%COMP%]   .match-releasegroup[_ngcontent-%COMP%]   .match-tracks-info[_ngcontent-%COMP%], [_nghost-%COMP%]   .match-results[_ngcontent-%COMP%]   .match-releasegroup[_ngcontent-%COMP%]   .match-select-releases[_ngcontent-%COMP%]{padding-top:4px}[_nghost-%COMP%]   .match-results[_ngcontent-%COMP%]   .match-releasegroup[_ngcontent-%COMP%]   .match-select-releases[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:.7em;line-height:.7em;vertical-align:top}[_nghost-%COMP%]   .match-results[_ngcontent-%COMP%]   .match-releasegroup[_ngcontent-%COMP%]   app-image-base64[_ngcontent-%COMP%]{height:32px;width:32px}[_nghost-%COMP%]   .match-results[_ngcontent-%COMP%]   .match-releasegroup[_ngcontent-%COMP%]   .match-track-info[_ngcontent-%COMP%]{padding-top:2px;padding-bottom:2px;border-top:1px solid var(--background-border)}[_nghost-%COMP%]   .match-results[_ngcontent-%COMP%]   .match-releasegroup[_ngcontent-%COMP%]   .match-track-info.missing[_ngcontent-%COMP%]{color:var(--accent)}[_nghost-%COMP%]   .match-results[_ngcontent-%COMP%]   .match-releasegroup[_ngcontent-%COMP%]   .match-release[_ngcontent-%COMP%]{white-space:nowrap;padding:5px 5px 5px 42px}"]})}return o})();var Da=[{path:"",component:ke}],Yi=Mi.forChild(Da);var ec=(()=>{class o{static \u0275fac=function(n){return new(n||o)};static \u0275mod=Vt({type:o});static \u0275inj=Ft({imports:[ci,yi,mi,Ke,gi,pi,Ii,Yi]})}return o})();$e(Ne,function(){return[it]},[]);$e(ke,function(){return[we]},[]);$e(it,function(){return[ze,He,Lt,wt,Ie,fe]},[]);export{ec as TagEditorModule};
