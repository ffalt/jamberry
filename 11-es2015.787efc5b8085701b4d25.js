"use strict";(self.webpackChunkjamberry=self.webpackChunkjamberry||[]).push([[11],{17469:function(t,e,n){n.d(e,{ap:function(){return M},QG:function(){return C},Ll:function(){return x}});var o=n(37716);function i(t,e,n,o){return new(n||(n=Promise))(function(i,r){function s(t){try{c(o.next(t))}catch(e){r(e)}}function a(t){try{c(o.throw(t))}catch(e){r(e)}}function c(t){t.done?i(t.value):function(t){return t instanceof n?t:new n(function(e){e(t)})}(t.value).then(s,a)}c((o=o.apply(t,e||[])).next())})}var r=n(38583),s=n(39075);const a=["wrapper"],c=["sourceImage"];function l(t,e){if(1&t){const t=o.EpF();o.TgZ(0,"img",4,5),o.NdJ("load",function(){return o.CHM(t),o.oxw().imageLoadedInView()}),o.qZA()}if(2&t){const t=o.oxw();o.Udp("visibility",t.imageVisible?"visible":"hidden")("transform",t.safeTransformStyle),o.Q6J("src",t.safeImgDataUrl,o.LSH)}}function d(t,e){if(1&t){const t=o.EpF();o.ynx(0),o.TgZ(1,"span",9),o.NdJ("mousedown",function(e){o.CHM(t);const n=o.oxw(2);return n.startMove(e,n.moveTypes.Resize,"topleft")})("touchstart",function(e){o.CHM(t);const n=o.oxw(2);return n.startMove(e,n.moveTypes.Resize,"topleft")}),o._UZ(2,"span",10),o.qZA(),o.TgZ(3,"span",11),o._UZ(4,"span",10),o.qZA(),o.TgZ(5,"span",12),o.NdJ("mousedown",function(e){o.CHM(t);const n=o.oxw(2);return n.startMove(e,n.moveTypes.Resize,"topright")})("touchstart",function(e){o.CHM(t);const n=o.oxw(2);return n.startMove(e,n.moveTypes.Resize,"topright")}),o._UZ(6,"span",10),o.qZA(),o.TgZ(7,"span",13),o._UZ(8,"span",10),o.qZA(),o.TgZ(9,"span",14),o.NdJ("mousedown",function(e){o.CHM(t);const n=o.oxw(2);return n.startMove(e,n.moveTypes.Resize,"bottomright")})("touchstart",function(e){o.CHM(t);const n=o.oxw(2);return n.startMove(e,n.moveTypes.Resize,"bottomright")}),o._UZ(10,"span",10),o.qZA(),o.TgZ(11,"span",15),o._UZ(12,"span",10),o.qZA(),o.TgZ(13,"span",16),o.NdJ("mousedown",function(e){o.CHM(t);const n=o.oxw(2);return n.startMove(e,n.moveTypes.Resize,"bottomleft")})("touchstart",function(e){o.CHM(t);const n=o.oxw(2);return n.startMove(e,n.moveTypes.Resize,"bottomleft")}),o._UZ(14,"span",10),o.qZA(),o.TgZ(15,"span",17),o._UZ(16,"span",10),o.qZA(),o.TgZ(17,"span",18),o.NdJ("mousedown",function(e){o.CHM(t);const n=o.oxw(2);return n.startMove(e,n.moveTypes.Resize,"top")})("touchstart",function(e){o.CHM(t);const n=o.oxw(2);return n.startMove(e,n.moveTypes.Resize,"top")}),o.qZA(),o.TgZ(18,"span",19),o.NdJ("mousedown",function(e){o.CHM(t);const n=o.oxw(2);return n.startMove(e,n.moveTypes.Resize,"right")})("touchstart",function(e){o.CHM(t);const n=o.oxw(2);return n.startMove(e,n.moveTypes.Resize,"right")}),o.qZA(),o.TgZ(19,"span",20),o.NdJ("mousedown",function(e){o.CHM(t);const n=o.oxw(2);return n.startMove(e,n.moveTypes.Resize,"bottom")})("touchstart",function(e){o.CHM(t);const n=o.oxw(2);return n.startMove(e,n.moveTypes.Resize,"bottom")}),o.qZA(),o.TgZ(20,"span",21),o.NdJ("mousedown",function(e){o.CHM(t);const n=o.oxw(2);return n.startMove(e,n.moveTypes.Resize,"left")})("touchstart",function(e){o.CHM(t);const n=o.oxw(2);return n.startMove(e,n.moveTypes.Resize,"left")}),o.qZA(),o.BQk()}}function g(t,e){if(1&t){const t=o.EpF();o.TgZ(0,"div",6),o.NdJ("keydown",function(e){return o.CHM(t),o.oxw().keyboardAccess(e)}),o.TgZ(1,"div",7),o.NdJ("mousedown",function(e){o.CHM(t);const n=o.oxw();return n.startMove(e,n.moveTypes.Move)})("touchstart",function(e){o.CHM(t);const n=o.oxw();return n.startMove(e,n.moveTypes.Move)}),o.qZA(),o.YNc(2,d,21,0,"ng-container",8),o.qZA()}if(2&t){const t=o.oxw();o.Udp("top",t.cropper.y1,"px")("left",t.cropper.x1,"px")("width",t.cropper.x2-t.cropper.x1,"px")("height",t.cropper.y2-t.cropper.y1,"px")("margin-left","center"===t.alignImage?t.marginLeft:null)("visibility",t.imageVisible?"visible":"hidden"),o.ekj("rounded",t.roundCropper),o.xp6(2),o.Q6J("ngIf",!t.hideResizeSquares)}}const h={Move:"move",Resize:"resize",Pinch:"pinch"};let p=(()=>{class t{crop(t,e,n,o){const i=this.getImagePosition(t,e,n,o),r=i.x2-i.x1,s=i.y2-i.y1,a=document.createElement("canvas");a.width=r,a.height=s;const c=a.getContext("2d");if(!c)return;null!=o.backgroundColor&&(c.fillStyle=o.backgroundColor,c.fillRect(0,0,r,s));const l=(o.transform.scale||1)*(o.transform.flipH?-1:1),d=(o.transform.scale||1)*(o.transform.flipV?-1:1),g=e.transformed;c.setTransform(l,0,0,d,g.size.width/2,g.size.height/2),c.translate(-i.x1/l,-i.y1/d),c.rotate((o.transform.rotate||0)*Math.PI/180),c.drawImage(g.image,-g.size.width/2,-g.size.height/2);const h={width:r,height:s,imagePosition:i,cropperPosition:Object.assign({},n)};o.containWithinAspectRatio&&(h.offsetImagePosition=this.getOffsetImagePosition(t,e,n,o));const p=this.getResizeRatio(r,s,o);return 1!==p&&(h.width=Math.round(r*p),h.height=o.maintainAspectRatio?Math.round(h.width/o.aspectRatio):Math.round(s*p),function(t,e,n){const o=t.width,i=t.height,r=o/(e=Math.round(e)),s=i/(n=Math.round(n)),a=Math.ceil(r/2),c=Math.ceil(s/2),l=t.getContext("2d");if(l){const d=l.getImageData(0,0,o,i),g=l.createImageData(e,n),h=d.data,p=g.data;for(let t=0;t<n;t++)for(let n=0;n<e;n++){const l=4*(n+t*e),d=t*s;let g=0,u=0,f=0,m=0,M=0,C=0,x=0;const v=Math.floor(n*r),_=Math.floor(t*s);let O=Math.ceil((n+1)*r),P=Math.ceil((t+1)*s);O=Math.min(O,o),P=Math.min(P,i);for(let t=_;t<P;t++){const e=Math.abs(d-t)/c,i=n*r,s=e*e;for(let n=v;n<O;n++){const e=Math.abs(i-n)/a,r=Math.sqrt(s+e*e);if(r>=1)continue;g=2*r*r*r-3*r*r+1;const c=4*(n+t*o);x+=g*h[c+3],f+=g,h[c+3]<255&&(g=g*h[c+3]/250),m+=g*h[c],M+=g*h[c+1],C+=g*h[c+2],u+=g}}p[l]=m/u,p[l+1]=M/u,p[l+2]=C/u,p[l+3]=x/f}t.width=e,t.height=n,l.putImageData(g,0,0)}}(a,h.width,h.height)),h.base64=a.toDataURL("image/"+o.format,this.getQuality(o)),h}getImagePosition(t,e,n,o){const i=e.transformed.size.width/t.nativeElement.offsetWidth,r={x1:Math.round(n.x1*i),y1:Math.round(n.y1*i),x2:Math.round(n.x2*i),y2:Math.round(n.y2*i)};return o.containWithinAspectRatio||(r.x1=Math.max(r.x1,0),r.y1=Math.max(r.y1,0),r.x2=Math.min(r.x2,e.transformed.size.width),r.y2=Math.min(r.y2,e.transformed.size.height)),r}getOffsetImagePosition(t,e,n,o){const i=e.transformed.size.width/t.nativeElement.offsetWidth;let r,s;(o.canvasRotation+e.exifTransform.rotate)%2?(r=(e.transformed.size.width-e.original.size.height)/2,s=(e.transformed.size.height-e.original.size.width)/2):(r=(e.transformed.size.width-e.original.size.width)/2,s=(e.transformed.size.height-e.original.size.height)/2);const a={x1:Math.round(n.x1*i)-r,y1:Math.round(n.y1*i)-s,x2:Math.round(n.x2*i)-r,y2:Math.round(n.y2*i)-s};return o.containWithinAspectRatio||(a.x1=Math.max(a.x1,0),a.y1=Math.max(a.y1,0),a.x2=Math.min(a.x2,e.transformed.size.width),a.y2=Math.min(a.y2,e.transformed.size.height)),a}getResizeRatio(t,e,n){const o=n.resizeToWidth/t,i=n.resizeToHeight/e,r=new Array;n.resizeToWidth>0&&r.push(o),n.resizeToHeight>0&&r.push(i);const s=0===r.length?1:Math.min(...r);return s>1&&!n.onlyScaleDown?s:Math.min(s,1)}getQuality(t){return Math.min(1,Math.max(0,t.imageQuality/100))}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=(0,o.Yz7)({factory:function(){return new t},token:t,providedIn:"root"}),t})();class u{constructor(){this.format="png",this.maintainAspectRatio=!0,this.transform={},this.aspectRatio=1,this.resizeToWidth=0,this.resizeToHeight=0,this.cropperMinWidth=0,this.cropperMinHeight=0,this.cropperMaxHeight=0,this.cropperMaxWidth=0,this.cropperStaticWidth=0,this.cropperStaticHeight=0,this.canvasRotation=0,this.initialStepSize=3,this.roundCropper=!1,this.onlyScaleDown=!1,this.imageQuality=92,this.autoCrop=!0,this.backgroundColor=void 0,this.containWithinAspectRatio=!1,this.hideResizeSquares=!1,this.alignImage="center",this.cropperScaledMinWidth=20,this.cropperScaledMinHeight=20,this.cropperScaledMaxWidth=20,this.cropperScaledMaxHeight=20,this.stepSize=this.initialStepSize}setOptions(t){Object.keys(t).filter(t=>t in this).forEach(e=>this[e]=t[e]),this.validateOptions()}setOptionsFromChanges(t){Object.keys(t).filter(t=>t in this).forEach(e=>this[e]=t[e].currentValue),this.validateOptions()}validateOptions(){if(this.maintainAspectRatio&&!this.aspectRatio)throw new Error("`aspectRatio` should > 0 when `maintainAspectRatio` is enabled")}}let f=(()=>{class t{constructor(){this.autoRotateSupported=new Promise(t=>{const e=new Image;e.onload=()=>{t(1===e.width&&2===e.height)},e.src="data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAEAAgMBEQACEQEDEQH/xABKAAEAAAAAAAAAAAAAAAAAAAALEAEAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAAAAAAAAAAAAAAAEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwA/8H//2Q=="})}loadImageFile(t,e){return new Promise((n,o)=>{const i=new FileReader;i.onload=i=>{this.loadImage(i.target.result,t.type,e).then(n).catch(o)},i.readAsDataURL(t)})}loadImage(t,e,n){return this.isValidImageType(e)?this.loadBase64Image(t,n):Promise.reject(new Error("Invalid image type"))}isValidImageType(t){return/image\/(png|jpg|jpeg|bmp|gif|tiff|webp)/.test(t)}loadImageFromURL(t,e){return new Promise((n,o)=>{const i=new Image;i.onerror=()=>o,i.onload=()=>{const t=document.createElement("canvas"),o=t.getContext("2d");t.width=i.width,t.height=i.height,o.drawImage(i,0,0),this.loadBase64Image(t.toDataURL(),e).then(n)},i.crossOrigin="anonymous",i.src=t})}loadBase64Image(t,e){return new Promise((e,n)=>{const o=new Image;o.onload=()=>e({originalImage:o,originalBase64:t}),o.onerror=n,o.src=t}).then(t=>this.transformImageBase64(t,e))}transformImageBase64(t,e){return i(this,void 0,void 0,function*(){const n=yield this.autoRotateSupported,o=yield function(t){switch("string"==typeof t&&(t=function(t){const e=new DataView(function(t){t=t.replace(/^data\:([^\;]+)\;base64,/gim,"");const e=atob(t),n=e.length,o=new Uint8Array(n);for(let i=0;i<n;i++)o[i]=e.charCodeAt(i);return o.buffer}(t));if(65496!=e.getUint16(0,!1))return-2;const n=e.byteLength;let o=2;for(;o<n;){if(e.getUint16(o+2,!1)<=8)return-1;const t=e.getUint16(o,!1);if(o+=2,65505==t){if(1165519206!=e.getUint32(o+=2,!1))return-1;const t=18761==e.getUint16(o+=6,!1);o+=e.getUint32(o+4,t);const n=e.getUint16(o,t);o+=2;for(let i=0;i<n;i++)if(274==e.getUint16(o+12*i,t))return e.getUint16(o+12*i+8,t)}else{if(65280!=(65280&t))break;o+=e.getUint16(o,!1)}}return-1}(t)),t){case 2:return{rotate:0,flip:!0};case 3:return{rotate:2,flip:!1};case 4:return{rotate:2,flip:!0};case 5:return{rotate:1,flip:!0};case 6:return{rotate:1,flip:!1};case 7:return{rotate:3,flip:!0};case 8:return{rotate:3,flip:!1};default:return{rotate:0,flip:!1}}}(n?-1:t.originalBase64);return t.originalImage&&t.originalImage.complete?this.transformLoadedImage({original:{base64:t.originalBase64,image:t.originalImage,size:{width:t.originalImage.naturalWidth,height:t.originalImage.naturalHeight}},exifTransform:o},e):Promise.reject(new Error("No image loaded"))})}transformLoadedImage(t,e){return i(this,void 0,void 0,function*(){const n=e.canvasRotation+t.exifTransform.rotate,o={width:t.original.image.naturalWidth,height:t.original.image.naturalHeight};if(0===n&&!t.exifTransform.flip&&!e.containWithinAspectRatio)return{original:{base64:t.original.base64,image:t.original.image,size:Object.assign({},o)},transformed:{base64:t.original.base64,image:t.original.image,size:Object.assign({},o)},exifTransform:t.exifTransform};const i=this.getTransformedSize(o,t.exifTransform,e),r=document.createElement("canvas");r.width=i.width,r.height=i.height;const s=r.getContext("2d");s.setTransform(t.exifTransform.flip?-1:1,0,0,1,r.width/2,r.height/2),s.rotate(Math.PI*(n/2)),s.drawImage(t.original.image,-o.width/2,-o.height/2);const a=r.toDataURL(),c=yield this.loadImageFromBase64(a);return{original:{base64:t.original.base64,image:t.original.image,size:Object.assign({},o)},transformed:{base64:a,image:c,size:{width:c.width,height:c.height}},exifTransform:t.exifTransform}})}loadImageFromBase64(t){return new Promise((e,n)=>{const o=new Image;o.onload=()=>e(o),o.onerror=n,o.src=t})}getTransformedSize(t,e,n){const o=n.canvasRotation+e.rotate;if(n.containWithinAspectRatio){if(o%2){const e=t.height/n.aspectRatio;return{width:Math.max(t.height,t.width*n.aspectRatio),height:Math.max(t.width,e)}}{const e=t.width/n.aspectRatio;return{width:Math.max(t.width,t.height*n.aspectRatio),height:Math.max(t.height,e)}}}return o%2?{height:t.width,width:t.height}:{width:t.width,height:t.height}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=(0,o.Yz7)({factory:function(){return new t},token:t,providedIn:"root"}),t})(),m=(()=>{class t{resetCropperPosition(t,e,n){if(!(null==t?void 0:t.nativeElement))return;const o=t.nativeElement;if(n.cropperStaticHeight&&n.cropperStaticWidth)e.x1=0,e.x2=o.offsetWidth>n.cropperStaticWidth?n.cropperStaticWidth:o.offsetWidth,e.y1=0,e.y2=o.offsetHeight>n.cropperStaticHeight?n.cropperStaticHeight:o.offsetHeight;else{const t=Math.min(n.cropperScaledMaxWidth,o.offsetWidth),i=Math.min(n.cropperScaledMaxHeight,o.offsetHeight);if(n.maintainAspectRatio)if(t/n.aspectRatio<i){e.x1=0,e.x2=t;const i=t/n.aspectRatio;e.y1=(o.offsetHeight-i)/2,e.y2=e.y1+i}else{e.y1=0,e.y2=i;const t=i*n.aspectRatio;e.x1=(o.offsetWidth-t)/2,e.x2=e.x1+t}else e.x1=0,e.x2=t,e.y1=0,e.y2=i}}move(t,e,n){const o=this.getClientX(t)-e.clientX,i=this.getClientY(t)-e.clientY;n.x1=e.x1+o,n.y1=e.y1+i,n.x2=e.x2+o,n.y2=e.y2+i}resize(t,e,n,o,i){const r=this.getClientX(t)-e.clientX,s=this.getClientY(t)-e.clientY;switch(e.position){case"left":n.x1=Math.min(Math.max(e.x1+r,n.x2-i.cropperScaledMaxWidth),n.x2-i.cropperScaledMinWidth);break;case"topleft":n.x1=Math.min(Math.max(e.x1+r,n.x2-i.cropperScaledMaxWidth),n.x2-i.cropperScaledMinWidth),n.y1=Math.min(Math.max(e.y1+s,n.y2-i.cropperScaledMaxHeight),n.y2-i.cropperScaledMinHeight);break;case"top":n.y1=Math.min(Math.max(e.y1+s,n.y2-i.cropperScaledMaxHeight),n.y2-i.cropperScaledMinHeight);break;case"topright":n.x2=Math.max(Math.min(e.x2+r,n.x1+i.cropperScaledMaxWidth),n.x1+i.cropperScaledMinWidth),n.y1=Math.min(Math.max(e.y1+s,n.y2-i.cropperScaledMaxHeight),n.y2-i.cropperScaledMinHeight);break;case"right":n.x2=Math.max(Math.min(e.x2+r,n.x1+i.cropperScaledMaxWidth),n.x1+i.cropperScaledMinWidth);break;case"bottomright":n.x2=Math.max(Math.min(e.x2+r,n.x1+i.cropperScaledMaxWidth),n.x1+i.cropperScaledMinWidth),n.y2=Math.max(Math.min(e.y2+s,n.y1+i.cropperScaledMaxHeight),n.y1+i.cropperScaledMinHeight);break;case"bottom":n.y2=Math.max(Math.min(e.y2+s,n.y1+i.cropperScaledMaxHeight),n.y1+i.cropperScaledMinHeight);break;case"bottomleft":n.x1=Math.min(Math.max(e.x1+r,n.x2-i.cropperScaledMaxWidth),n.x2-i.cropperScaledMinWidth),n.y2=Math.max(Math.min(e.y2+s,n.y1+i.cropperScaledMaxHeight),n.y1+i.cropperScaledMinHeight);break;case"center":const a=t.scale,c=Math.min(Math.max(i.cropperScaledMinWidth,Math.abs(e.x2-e.x1)*a),i.cropperScaledMaxWidth),l=Math.min(Math.max(i.cropperScaledMinHeight,Math.abs(e.y2-e.y1)*a),i.cropperScaledMaxHeight);n.x1=e.clientX-c/2,n.x2=e.clientX+c/2,n.y1=e.clientY-l/2,n.y2=e.clientY+l/2,n.x1<0?(n.x2-=n.x1,n.x1=0):n.x2>o.width&&(n.x1-=n.x2-o.width,n.x2=o.width),n.y1<0?(n.y2-=n.y1,n.y1=0):n.y2>o.height&&(n.y1-=n.y2-o.height,n.y2=o.height)}i.maintainAspectRatio&&this.checkAspectRatio(e.position,n,o,i)}checkAspectRatio(t,e,n,o){let i=0,r=0;switch(t){case"top":e.x2=e.x1+(e.y2-e.y1)*o.aspectRatio,i=Math.max(e.x2-n.width,0),r=Math.max(0-e.y1,0),(i>0||r>0)&&(e.x2-=r*o.aspectRatio>i?r*o.aspectRatio:i,e.y1+=r*o.aspectRatio>i?r:i/o.aspectRatio);break;case"bottom":e.x2=e.x1+(e.y2-e.y1)*o.aspectRatio,i=Math.max(e.x2-n.width,0),r=Math.max(e.y2-n.height,0),(i>0||r>0)&&(e.x2-=r*o.aspectRatio>i?r*o.aspectRatio:i,e.y2-=r*o.aspectRatio>i?r:i/o.aspectRatio);break;case"topleft":e.y1=e.y2-(e.x2-e.x1)/o.aspectRatio,i=Math.max(0-e.x1,0),r=Math.max(0-e.y1,0),(i>0||r>0)&&(e.x1+=r*o.aspectRatio>i?r*o.aspectRatio:i,e.y1+=r*o.aspectRatio>i?r:i/o.aspectRatio);break;case"topright":e.y1=e.y2-(e.x2-e.x1)/o.aspectRatio,i=Math.max(e.x2-n.width,0),r=Math.max(0-e.y1,0),(i>0||r>0)&&(e.x2-=r*o.aspectRatio>i?r*o.aspectRatio:i,e.y1+=r*o.aspectRatio>i?r:i/o.aspectRatio);break;case"right":case"bottomright":e.y2=e.y1+(e.x2-e.x1)/o.aspectRatio,i=Math.max(e.x2-n.width,0),r=Math.max(e.y2-n.height,0),(i>0||r>0)&&(e.x2-=r*o.aspectRatio>i?r*o.aspectRatio:i,e.y2-=r*o.aspectRatio>i?r:i/o.aspectRatio);break;case"left":case"bottomleft":e.y2=e.y1+(e.x2-e.x1)/o.aspectRatio,i=Math.max(0-e.x1,0),r=Math.max(e.y2-n.height,0),(i>0||r>0)&&(e.x1+=r*o.aspectRatio>i?r*o.aspectRatio:i,e.y2-=r*o.aspectRatio>i?r:i/o.aspectRatio);break;case"center":e.x2=e.x1+(e.y2-e.y1)*o.aspectRatio,e.y2=e.y1+(e.x2-e.x1)/o.aspectRatio;const t=Math.max(0-e.x1,0),s=Math.max(e.x2-n.width,0),a=Math.max(e.y2-n.height,0),c=Math.max(0-e.y1,0);(t>0||s>0||a>0||c>0)&&(e.x1+=a*o.aspectRatio>t?a*o.aspectRatio:t,e.x2-=c*o.aspectRatio>s?c*o.aspectRatio:s,e.y1+=c*o.aspectRatio>s?c:s/o.aspectRatio,e.y2-=a*o.aspectRatio>t?a:t/o.aspectRatio)}}getClientX(t){return(t.touches&&t.touches[0]?t.touches[0].clientX:t.clientX)||0}getClientY(t){return(t.touches&&t.touches[0]?t.touches[0].clientY:t.clientY)||0}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=(0,o.Yz7)({factory:function(){return new t},token:t,providedIn:"root"}),t})(),M=(()=>{class t{constructor(t,e,n,i,r){this.cropService=t,this.cropperPositionService=e,this.loadImageService=n,this.sanitizer=i,this.cd=r,this.Hammer="undefined"!=typeof window?window.Hammer:null,this.settings=new u,this.setImageMaxSizeRetries=0,this.marginLeft="0px",this.moveTypes=h,this.imageVisible=!1,this.format=this.settings.format,this.transform={},this.maintainAspectRatio=this.settings.maintainAspectRatio,this.aspectRatio=this.settings.aspectRatio,this.resizeToWidth=this.settings.resizeToWidth,this.resizeToHeight=this.settings.resizeToHeight,this.cropperMinWidth=this.settings.cropperMinWidth,this.cropperMinHeight=this.settings.cropperMinHeight,this.cropperMaxHeight=this.settings.cropperMaxHeight,this.cropperMaxWidth=this.settings.cropperMaxWidth,this.cropperStaticWidth=this.settings.cropperStaticWidth,this.cropperStaticHeight=this.settings.cropperStaticHeight,this.canvasRotation=this.settings.canvasRotation,this.initialStepSize=this.settings.initialStepSize,this.roundCropper=this.settings.roundCropper,this.onlyScaleDown=this.settings.onlyScaleDown,this.imageQuality=this.settings.imageQuality,this.autoCrop=this.settings.autoCrop,this.backgroundColor=this.settings.backgroundColor,this.containWithinAspectRatio=this.settings.containWithinAspectRatio,this.hideResizeSquares=this.settings.hideResizeSquares,this.cropper={x1:-100,y1:-100,x2:1e4,y2:1e4},this.alignImage=this.settings.alignImage,this.disabled=!1,this.imageCropped=new o.vpe,this.startCropImage=new o.vpe,this.imageLoaded=new o.vpe,this.cropperReady=new o.vpe,this.loadImageFailed=new o.vpe,this.reset()}ngOnChanges(t){this.onChangesUpdateSettings(t),this.onChangesInputImage(t),this.loadedImage&&this.loadedImage.original.image.complete&&(t.containWithinAspectRatio||t.canvasRotation)&&this.loadImageService.transformLoadedImage(this.loadedImage,this.settings).then(t=>this.setLoadedImage(t)).catch(t=>this.loadImageError(t)),(t.cropper||t.maintainAspectRatio||t.aspectRatio)&&(this.setMaxSize(),this.setCropperScaledMinSize(),this.setCropperScaledMaxSize(),this.maintainAspectRatio&&(t.maintainAspectRatio||t.aspectRatio)?this.resetCropperPosition():t.cropper&&(this.checkCropperPosition(!1),this.doAutoCrop()),this.cd.markForCheck()),t.transform&&(this.transform=this.transform||{},this.setCssTransform(),this.doAutoCrop())}onChangesUpdateSettings(t){this.settings.setOptionsFromChanges(t),this.settings.cropperStaticHeight&&this.settings.cropperStaticWidth&&this.settings.setOptions({hideResizeSquares:!0,cropperMinWidth:this.settings.cropperStaticWidth,cropperMinHeight:this.settings.cropperStaticHeight,cropperMaxHeight:this.settings.cropperStaticHeight,cropperMaxWidth:this.settings.cropperStaticWidth,maintainAspectRatio:!1})}onChangesInputImage(t){(t.imageChangedEvent||t.imageURL||t.imageBase64||t.imageFile)&&this.reset(),t.imageChangedEvent&&this.isValidImageChangedEvent()&&this.loadImageFile(this.imageChangedEvent.target.files[0]),t.imageURL&&this.imageURL&&this.loadImageFromURL(this.imageURL),t.imageBase64&&this.imageBase64&&this.loadBase64Image(this.imageBase64),t.imageFile&&this.imageFile&&this.loadImageFile(this.imageFile)}isValidImageChangedEvent(){return this.imageChangedEvent&&this.imageChangedEvent.target&&this.imageChangedEvent.target.files&&this.imageChangedEvent.target.files.length>0}setCssTransform(){this.safeTransformStyle=this.sanitizer.bypassSecurityTrustStyle("scaleX("+(this.transform.scale||1)*(this.transform.flipH?-1:1)+")scaleY("+(this.transform.scale||1)*(this.transform.flipV?-1:1)+")rotate("+(this.transform.rotate||0)+"deg)")}ngOnInit(){this.settings.stepSize=this.initialStepSize,this.activatePinchGesture()}reset(){this.imageVisible=!1,this.loadedImage=null,this.safeImgDataUrl="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=",this.moveStart={active:!1,type:null,position:null,x1:0,y1:0,x2:0,y2:0,clientX:0,clientY:0},this.maxSize={width:0,height:0},this.cropper.x1=-100,this.cropper.y1=-100,this.cropper.x2=1e4,this.cropper.y2=1e4}loadImageFile(t){this.loadImageService.loadImageFile(t,this.settings).then(t=>this.setLoadedImage(t)).catch(t=>this.loadImageError(t))}loadBase64Image(t){this.loadImageService.loadBase64Image(t,this.settings).then(t=>this.setLoadedImage(t)).catch(t=>this.loadImageError(t))}loadImageFromURL(t){this.loadImageService.loadImageFromURL(t,this.settings).then(t=>this.setLoadedImage(t)).catch(t=>this.loadImageError(t))}setLoadedImage(t){this.loadedImage=t,this.safeImgDataUrl=this.sanitizer.bypassSecurityTrustResourceUrl(t.transformed.base64),this.cd.markForCheck()}loadImageError(t){console.error(t),this.loadImageFailed.emit()}imageLoadedInView(){null!=this.loadedImage&&(this.imageLoaded.emit(this.loadedImage),this.setImageMaxSizeRetries=0,setTimeout(()=>this.checkImageMaxSizeRecursively()))}checkImageMaxSizeRecursively(){this.setImageMaxSizeRetries>40?this.loadImageFailed.emit():this.sourceImageLoaded()?(this.setMaxSize(),this.setCropperScaledMinSize(),this.setCropperScaledMaxSize(),this.resetCropperPosition(),this.cropperReady.emit(Object.assign({},this.maxSize)),this.cd.markForCheck()):(this.setImageMaxSizeRetries++,setTimeout(()=>this.checkImageMaxSizeRecursively(),50))}sourceImageLoaded(){return this.sourceImage&&this.sourceImage.nativeElement&&this.sourceImage.nativeElement.offsetWidth>0}onResize(){!this.loadedImage||(this.resizeCropperPosition(),this.setMaxSize(),this.setCropperScaledMinSize(),this.setCropperScaledMaxSize())}activatePinchGesture(){if(this.Hammer){const t=new this.Hammer(this.wrapper.nativeElement);t.get("pinch").set({enable:!0}),t.on("pinchmove",this.onPinch.bind(this)),t.on("pinchend",this.pinchStop.bind(this)),t.on("pinchstart",this.startPinch.bind(this))}else(0,o.X6Q)()&&console.warn("[NgxImageCropper] Could not find HammerJS - Pinch Gesture won't work")}resizeCropperPosition(){const t=this.sourceImage.nativeElement;(this.maxSize.width!==t.offsetWidth||this.maxSize.height!==t.offsetHeight)&&(this.cropper.x1=this.cropper.x1*t.offsetWidth/this.maxSize.width,this.cropper.x2=this.cropper.x2*t.offsetWidth/this.maxSize.width,this.cropper.y1=this.cropper.y1*t.offsetHeight/this.maxSize.height,this.cropper.y2=this.cropper.y2*t.offsetHeight/this.maxSize.height)}resetCropperPosition(){this.cropperPositionService.resetCropperPosition(this.sourceImage,this.cropper,this.settings),this.doAutoCrop(),this.imageVisible=!0}keyboardAccess(t){this.changeKeyboardStepSize(t),this.keyboardMoveCropper(t)}changeKeyboardStepSize(t){t.key>="1"&&t.key<="9"&&(this.settings.stepSize=+t.key)}keyboardMoveCropper(t){if(!["ArrowUp","ArrowDown","ArrowRight","ArrowLeft"].includes(t.key))return;const e=t.shiftKey?h.Resize:h.Move,n=t.altKey?function(t){switch(t){case"ArrowUp":return"bottom";case"ArrowRight":return"left";case"ArrowDown":return"top";case"ArrowLeft":default:return"right"}}(t.key):function(t){switch(t){case"ArrowUp":return"top";case"ArrowRight":return"right";case"ArrowDown":return"bottom";case"ArrowLeft":default:return"left"}}(t.key),o=function(t,e){switch(t){case"ArrowUp":return{clientX:0,clientY:-1*e};case"ArrowRight":return{clientX:e,clientY:0};case"ArrowDown":return{clientX:0,clientY:e};case"ArrowLeft":default:return{clientX:-1*e,clientY:0}}}(t.key,this.settings.stepSize);t.preventDefault(),t.stopPropagation(),this.startMove({clientX:0,clientY:0},e,n),this.moveImg(o),this.moveStop()}startMove(t,e,n=null){this.moveStart&&this.moveStart.active&&this.moveStart.type===h.Pinch||(t.preventDefault&&t.preventDefault(),this.moveStart=Object.assign({active:!0,type:e,position:n,clientX:this.cropperPositionService.getClientX(t),clientY:this.cropperPositionService.getClientY(t)},this.cropper))}startPinch(t){!this.safeImgDataUrl||(t.preventDefault&&t.preventDefault(),this.moveStart=Object.assign({active:!0,type:h.Pinch,position:"center",clientX:this.cropper.x1+(this.cropper.x2-this.cropper.x1)/2,clientY:this.cropper.y1+(this.cropper.y2-this.cropper.y1)/2},this.cropper))}moveImg(t){this.moveStart.active&&(t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),this.moveStart.type===h.Move?(this.cropperPositionService.move(t,this.moveStart,this.cropper),this.checkCropperPosition(!0)):this.moveStart.type===h.Resize&&(!this.cropperStaticWidth&&!this.cropperStaticHeight&&this.cropperPositionService.resize(t,this.moveStart,this.cropper,this.maxSize,this.settings),this.checkCropperPosition(!1)),this.cd.detectChanges())}onPinch(t){this.moveStart.active&&(t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),this.moveStart.type===h.Pinch&&(this.cropperPositionService.resize(t,this.moveStart,this.cropper,this.maxSize,this.settings),this.checkCropperPosition(!1)),this.cd.detectChanges())}setMaxSize(){if(this.sourceImage){const t=this.sourceImage.nativeElement;this.maxSize.width=t.offsetWidth,this.maxSize.height=t.offsetHeight,this.marginLeft=this.sanitizer.bypassSecurityTrustStyle("calc(50% - "+this.maxSize.width/2+"px)")}}setCropperScaledMinSize(){this.loadedImage&&this.loadedImage.transformed&&this.loadedImage.transformed.image?(this.setCropperScaledMinWidth(),this.setCropperScaledMinHeight()):(this.settings.cropperScaledMinWidth=20,this.settings.cropperScaledMinHeight=20)}setCropperScaledMinWidth(){this.settings.cropperScaledMinWidth=this.cropperMinWidth>0?Math.max(20,this.cropperMinWidth/this.loadedImage.transformed.image.width*this.maxSize.width):20}setCropperScaledMinHeight(){this.settings.cropperScaledMinHeight=this.maintainAspectRatio?Math.max(20,this.settings.cropperScaledMinWidth/this.aspectRatio):this.cropperMinHeight>0?Math.max(20,this.cropperMinHeight/this.loadedImage.transformed.image.height*this.maxSize.height):20}setCropperScaledMaxSize(){if(this.loadedImage&&this.loadedImage.transformed&&this.loadedImage.transformed.image){const t=this.loadedImage.transformed.size.width/this.maxSize.width;this.settings.cropperScaledMaxWidth=this.cropperMaxWidth>20?this.cropperMaxWidth/t:this.maxSize.width,this.settings.cropperScaledMaxHeight=this.cropperMaxHeight>20?this.cropperMaxHeight/t:this.maxSize.height,this.maintainAspectRatio&&(this.settings.cropperScaledMaxWidth>this.settings.cropperScaledMaxHeight*this.aspectRatio?this.settings.cropperScaledMaxWidth=this.settings.cropperScaledMaxHeight*this.aspectRatio:this.settings.cropperScaledMaxWidth<this.settings.cropperScaledMaxHeight*this.aspectRatio&&(this.settings.cropperScaledMaxHeight=this.settings.cropperScaledMaxWidth/this.aspectRatio))}else this.settings.cropperScaledMaxWidth=this.maxSize.width,this.settings.cropperScaledMaxHeight=this.maxSize.height}checkCropperPosition(t=!1){this.cropper.x1<0&&(this.cropper.x2-=t?this.cropper.x1:0,this.cropper.x1=0),this.cropper.y1<0&&(this.cropper.y2-=t?this.cropper.y1:0,this.cropper.y1=0),this.cropper.x2>this.maxSize.width&&(this.cropper.x1-=t?this.cropper.x2-this.maxSize.width:0,this.cropper.x2=this.maxSize.width),this.cropper.y2>this.maxSize.height&&(this.cropper.y1-=t?this.cropper.y2-this.maxSize.height:0,this.cropper.y2=this.maxSize.height)}moveStop(){this.moveStart.active&&(this.moveStart.active=!1,this.doAutoCrop())}pinchStop(){this.moveStart.active&&(this.moveStart.active=!1,this.doAutoCrop())}doAutoCrop(){this.autoCrop&&this.crop()}crop(){if(this.sourceImage&&this.sourceImage.nativeElement&&null!=this.loadedImage.transformed.image){this.startCropImage.emit();const t=this.cropService.crop(this.sourceImage,this.loadedImage,this.cropper,this.settings);return null!=t&&this.imageCropped.emit(t),t}return null}}return t.\u0275fac=function(e){return new(e||t)(o.Y36(p),o.Y36(m),o.Y36(f),o.Y36(s.H7),o.Y36(o.sBO))},t.\u0275cmp=o.Xpm({type:t,selectors:[["image-cropper"]],viewQuery:function(t,e){if(1&t&&(o.Gf(a,7),o.Gf(c,5)),2&t){let t;o.iGM(t=o.CRH())&&(e.wrapper=t.first),o.iGM(t=o.CRH())&&(e.sourceImage=t.first)}},hostVars:4,hostBindings:function(t,e){1&t&&o.NdJ("resize",function(){return e.onResize()},!1,o.Jf7)("mousemove",function(t){return e.moveImg(t)},!1,o.evT)("touchmove",function(t){return e.moveImg(t)},!1,o.evT)("mouseup",function(){return e.moveStop()},!1,o.evT)("touchend",function(){return e.moveStop()},!1,o.evT),2&t&&(o.Udp("text-align",e.alignImage),o.ekj("disabled",e.disabled))},inputs:{format:"format",transform:"transform",maintainAspectRatio:"maintainAspectRatio",aspectRatio:"aspectRatio",resizeToWidth:"resizeToWidth",resizeToHeight:"resizeToHeight",cropperMinWidth:"cropperMinWidth",cropperMinHeight:"cropperMinHeight",cropperMaxHeight:"cropperMaxHeight",cropperMaxWidth:"cropperMaxWidth",cropperStaticWidth:"cropperStaticWidth",cropperStaticHeight:"cropperStaticHeight",canvasRotation:"canvasRotation",initialStepSize:"initialStepSize",roundCropper:"roundCropper",onlyScaleDown:"onlyScaleDown",imageQuality:"imageQuality",autoCrop:"autoCrop",backgroundColor:"backgroundColor",containWithinAspectRatio:"containWithinAspectRatio",hideResizeSquares:"hideResizeSquares",cropper:"cropper",alignImage:"alignImage",disabled:"disabled",imageChangedEvent:"imageChangedEvent",imageURL:"imageURL",imageBase64:"imageBase64",imageFile:"imageFile"},outputs:{imageCropped:"imageCropped",startCropImage:"startCropImage",imageLoaded:"imageLoaded",cropperReady:"cropperReady",loadImageFailed:"loadImageFailed"},features:[o.TTD],decls:5,vars:10,consts:[["wrapper",""],["class","source-image",3,"src","visibility","transform","load",4,"ngIf"],[1,"overlay"],["class","cropper","tabindex","0",3,"rounded","top","left","width","height","margin-left","visibility","keydown",4,"ngIf"],[1,"source-image",3,"src","load"],["sourceImage",""],["tabindex","0",1,"cropper",3,"keydown"],[1,"move",3,"mousedown","touchstart"],[4,"ngIf"],[1,"resize","topleft",3,"mousedown","touchstart"],[1,"square"],[1,"resize","top"],[1,"resize","topright",3,"mousedown","touchstart"],[1,"resize","right"],[1,"resize","bottomright",3,"mousedown","touchstart"],[1,"resize","bottom"],[1,"resize","bottomleft",3,"mousedown","touchstart"],[1,"resize","left"],[1,"resize-bar","top",3,"mousedown","touchstart"],[1,"resize-bar","right",3,"mousedown","touchstart"],[1,"resize-bar","bottom",3,"mousedown","touchstart"],[1,"resize-bar","left",3,"mousedown","touchstart"]],template:function(t,e){1&t&&(o.TgZ(0,"div",null,0),o.YNc(2,l,2,5,"img",1),o._UZ(3,"div",2),o.YNc(4,g,3,15,"div",3),o.qZA()),2&t&&(o.Udp("background",e.imageVisible&&e.backgroundColor),o.xp6(2),o.Q6J("ngIf",e.safeImgDataUrl),o.xp6(1),o.Udp("width",e.maxSize.width,"px")("height",e.maxSize.height,"px")("margin-left","center"===e.alignImage?e.marginLeft:null),o.xp6(1),o.Q6J("ngIf",e.imageVisible))},directives:[r.O5],styles:['[_nghost-%COMP%]{display:flex;position:relative;width:100%;max-width:100%;max-height:100%;overflow:hidden;padding:5px;text-align:center}[_nghost-%COMP%] > div[_ngcontent-%COMP%]{width:100%;position:relative}[_nghost-%COMP%] > div[_ngcontent-%COMP%]   img.source-image[_ngcontent-%COMP%]{max-width:100%;max-height:100%;transform-origin:center}[_nghost-%COMP%]   .overlay[_ngcontent-%COMP%]{position:absolute;pointer-events:none;touch-action:none;outline:var(--cropper-overlay-color,#fff) solid 100vw;top:0;left:0}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]{position:absolute;display:flex;color:#53535c;background:0 0;outline:rgba(255,255,255,.3) solid 100vw;outline:var(--cropper-outline-color,rgba(255,255,255,.3)) solid 100vw;touch-action:none}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]:after{position:absolute;content:"";top:0;bottom:0;left:0;right:0;pointer-events:none;border:1px dashed;opacity:.75;color:inherit;z-index:1}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .move[_ngcontent-%COMP%]{width:100%;cursor:move;border:1px solid rgba(255,255,255,.5)}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]:focus   .move[_ngcontent-%COMP%]{border-color:#1e90ff;border-width:2px}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize[_ngcontent-%COMP%]{position:absolute;display:inline-block;line-height:6px;padding:8px;opacity:.85;z-index:1}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize[_ngcontent-%COMP%]   .square[_ngcontent-%COMP%]{display:inline-block;background:#53535c;width:6px;height:6px;border:1px solid rgba(255,255,255,.5);box-sizing:content-box}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize.topleft[_ngcontent-%COMP%]{top:-12px;left:-12px;cursor:nwse-resize}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize.top[_ngcontent-%COMP%]{top:-12px;left:calc(50% - 12px);cursor:ns-resize}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize.topright[_ngcontent-%COMP%]{top:-12px;right:-12px;cursor:nesw-resize}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize.right[_ngcontent-%COMP%]{top:calc(50% - 12px);right:-12px;cursor:ew-resize}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize.bottomright[_ngcontent-%COMP%]{bottom:-12px;right:-12px;cursor:nwse-resize}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize.bottom[_ngcontent-%COMP%]{bottom:-12px;left:calc(50% - 12px);cursor:ns-resize}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize.bottomleft[_ngcontent-%COMP%]{bottom:-12px;left:-12px;cursor:nesw-resize}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize.left[_ngcontent-%COMP%]{top:calc(50% - 12px);left:-12px;cursor:ew-resize}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize-bar[_ngcontent-%COMP%]{position:absolute;z-index:1}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize-bar.top[_ngcontent-%COMP%]{top:-11px;left:11px;width:calc(100% - 22px);height:22px;cursor:ns-resize}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize-bar.right[_ngcontent-%COMP%]{top:11px;right:-11px;height:calc(100% - 22px);width:22px;cursor:ew-resize}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize-bar.bottom[_ngcontent-%COMP%]{bottom:-11px;left:11px;width:calc(100% - 22px);height:22px;cursor:ns-resize}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize-bar.left[_ngcontent-%COMP%]{top:11px;left:-11px;height:calc(100% - 22px);width:22px;cursor:ew-resize}[_nghost-%COMP%]   .cropper.rounded[_ngcontent-%COMP%]{outline-color:transparent}[_nghost-%COMP%]   .cropper.rounded[_ngcontent-%COMP%]:after{border-radius:100%;box-shadow:0 0 0 100vw rgba(255,255,255,.3);box-shadow:0 0 0 100vw var(--cropper-outline-color,rgba(255,255,255,.3))}@media (orientation:portrait){[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]{outline-width:100vh}[_nghost-%COMP%]   .cropper.rounded[_ngcontent-%COMP%]:after{box-shadow:0 0 0 100vh rgba(255,255,255,.3);box-shadow:0 0 0 100vh var(--cropper-outline-color,rgba(255,255,255,.3))}}[_nghost-%COMP%]   .cropper.rounded[_ngcontent-%COMP%]   .move[_ngcontent-%COMP%]{border-radius:100%}.disabled[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .move[_ngcontent-%COMP%], .disabled[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize[_ngcontent-%COMP%], .disabled[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize-bar[_ngcontent-%COMP%]{display:none}'],changeDetection:0}),t})(),C=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=o.oAB({type:t}),t.\u0275inj=o.cJS({imports:[[r.ez]]}),t})();function x(t){const e=t.split(","),n=e[0].replace("data:","").replace(";base64",""),o=atob(e[1]),i=new ArrayBuffer(o.length),r=new Uint8Array(i);for(let s=0;s<o.length;s+=1)r[s]=o.charCodeAt(s);return new Blob([i],{type:n})}},70011:function(t,e,n){n.r(e),n.d(e,{AdminModule:function(){return jn}});var o=n(31664),i=n(38583),r=n(90665),s=n(39075),a=n(42976),c=n(67396),l=n(72271),d=n(17469),g=n(37716);let h=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=g.Xpm({type:t,selectors:[["app-admin"]],decls:6,vars:0,consts:[[1,"left"],[1,"middle"]],template:function(t,e){1&t&&(g.TgZ(0,"div",0),g._UZ(1,"app-admin-sidebar"),g.qZA(),g._UZ(2,"app-splitter"),g.TgZ(3,"div",1),g._UZ(4,"router-outlet"),g.qZA(),g._UZ(5,"app-admin-queue-requests"))},styles:["[_nghost-%COMP%]{width:100%;height:100%;flex:1;display:flex;flex-flow:row nowrap;overflow:hidden;align-items:flex-start;align-content:flex-start}[_nghost-%COMP%]   .left[_ngcontent-%COMP%]{width:15%;height:100%;min-width:140px}[_nghost-%COMP%]   .middle[_ngcontent-%COMP%]{width:85%;flex-grow:1;height:100%}@media (max-width: 1400px){[_nghost-%COMP%]   .left[_ngcontent-%COMP%]{width:20%}[_nghost-%COMP%]   .middle[_ngcontent-%COMP%]{width:80%}}@media (max-width: 768px){[_nghost-%COMP%]{min-height:100%;position:absolute;display:block;flex:none;flex-flow:inherit}[_nghost-%COMP%]   app-splitter[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .left[_ngcontent-%COMP%]{width:100%!important;height:auto}[_nghost-%COMP%]   .middle[_ngcontent-%COMP%]{width:100%;min-height:100%}}"]}),t})();var p=n(64762),u=n(76277),f=n(79765),m=n(46782);const M=["overview","tags","health","tracks","tracks-health"];var C=n(60918),x=n(75723),v=n(8986);function _(t,e){1&t&&g._UZ(0,"i",14)}function O(t,e){if(1&t&&(g.TgZ(0,"i"),g.ALo(1,"stringToggle"),g.qZA()),2&t){const t=g.oxw().$implicit;g.Tol(g.Dn7(1,2,t.expanded,"icon-minus","icon-plus"))}}function P(t,e){if(1&t){const t=g.EpF();g.ynx(0),g.TgZ(1,"div",7),g.NdJ("click",function(){const e=g.CHM(t).$implicit;return g.oxw().selectNode(e)}),g.TgZ(2,"span",8),g.NdJ("click",function(){const e=g.CHM(t).$implicit;return g.oxw().toggleNode(e)}),g.YNc(3,_,1,0,"i",9),g.YNc(4,O,2,6,"i",10),g.qZA(),g.TgZ(5,"span",11),g.NdJ("click",function(){const e=g.CHM(t).$implicit;return g.oxw().toggleNode(e)}),g.TgZ(6,"i"),g.ALo(7,"stringToggle"),g.qZA(),g.qZA(),g.TgZ(8,"span",12),g._uU(9),g.qZA(),g.TgZ(10,"span",13),g._uU(11),g.qZA(),g.qZA(),g.BQk()}if(2&t){const t=e.$implicit,n=g.oxw();g.xp6(1),g.Udp("padding-left",12*t.level,"px"),g.ekj("active",t===n.selected),g.xp6(1),g.MGl("title","Subfolders: ",t.folder.folderCount,""),g.xp6(1),g.Q6J("ngIf",t.isLoading),g.xp6(1),g.Q6J("ngIf",!t.isLoading&&t.hasChildren),g.xp6(1),g.Udp("color",t.color),g.Q6J("title",t.folder.type),g.xp6(1),g.Tol(g.Dn7(7,15,t.expanded,"icon-folder-open","icon-folder")),g.xp6(2),g.Q6J("title",t.folder.name),g.xp6(1),g.Oqu(t.folder.name),g.xp6(2),g.hij("| ",t.folder.type,"")}}function b(t,e){if(t.children)for(const n of t.children)e(n),b(n,e)}let Z=(()=>{class t{constructor(t,e,n,o){this.app=t,this.jam=e,this.notify=n,this.folderService=o,this.nodes=[],this.expandIDs=[],this.autoSelect=!1,this.selectionChange=new g.vpe,this.unsubscribe=new f.xQ}ngOnInit(){this.folderService.foldersChange.pipe((0,m.R)(this.unsubscribe)).subscribe(t=>{const e=this.nodes.find(e=>e.folder.id===t.id);e&&this.jam.folder.id({id:t.id,folderIncTrackCount:!0,folderIncChildFolderCount:!0}).then(n=>{e.folder=n,t.mode===C.dw.fsnRefreshChilds&&e.expanded&&(this.collapseNode(e),e.hasChildren=(n.folderCount||0)>0,e.children=void 0,e.isLoading=!1,e.hasChildren&&(e.expanded=!0,this.checkLoadExpanded(e)))}).catch(t=>{console.error(t)})})}ngOnDestroy(){this.unsubscribe.next(),this.unsubscribe.complete()}selectNode(t){this.selectionChange.emit(t.folder),this.autoSelect&&(this.selected=t)}toggleNode(t){t.expanded?this.collapseNode(t):this.expandNode(t)}refresh(){!this.jam.auth.isLoggedIn()||this.jam.folder.search({level:0,folderIncChildFolderCount:!0,folderIncTrackCount:!0}).then(t=>{this.nodes=t.items.map(t=>({folder:t,hasChildren:(t.folderCount||0)>0,level:0,color:this.typeToColor(t),expanded:this.expandIDs.includes(t.id),isLoading:!1}));for(const e of this.nodes)this.checkLoadExpanded(e)}).catch(t=>{this.notify.error(t)})}typeToColor(t){switch(t.type){case x.Sr.unknown:return"#ff9fAA";case x.Sr.artist:return"#6f806e";case x.Sr.collection:return"#adbced";case x.Sr.album:return"#bdbd9c";case x.Sr.multialbum:return"#bdaaae";case x.Sr.extras:return"#bdbdbd";default:return""}}onFolderUpdate(t){const e=this.nodes.find(e=>e.folder.id===t.id);e&&(e.folder=t)}selectFolderByID(t){const e=this.nodes.find(e=>e.folder.id===t);e?this.selected=e:this.jam.folder.id({id:t,folderIncParents:!0}).then(e=>{if(e.parents){for(const t of e.parents)this.expandIDs.includes(t.id)||this.expandIDs.push(t.id);for(const e of this.nodes)e.expanded=this.expandIDs.includes(e.folder.id),this.checkLoadExpanded(e,t)}}).catch(t=>{this.notify.error(t)})}checkLoadExpanded(t,e){t.expanded&&!t.isLoading&&this.loadChildren(t,t=>{for(const n of t)this.checkLoadExpanded(n,e)}),t.folder.id===e&&(this.selected=t,this.viewport&&this.viewport.scrollToIndex(this.nodes.indexOf(t)))}loadChildren(t,e){t.isLoading||(t.isLoading=!0,this.jam.folder.search({parentIDs:[t.folder.id],folderIncChildFolderCount:!0,folderIncTrackCount:!0}).then(n=>{const o=n.items.sort((t,e)=>t.name.localeCompare(e.name)).map(e=>({folder:e,hasChildren:(e.folderCount||0)>0,level:t.level+1,color:this.typeToColor(e),expanded:this.expandIDs.includes(e.id),isLoading:!1})),i=this.nodes.indexOf(t);i>=0&&(this.nodes=this.nodes.slice(0,i+1).concat(o).concat(this.nodes.slice(i+1))),t.children=o,t.isLoading=!1,e&&e(o)}).catch(t=>{this.notify.error(t)}))}collapseNode(t){if(t.expanded){const e=[];b(t,t=>e.push(t.folder.id)),this.nodes=this.nodes.filter(t=>!e.includes(t.folder.id)),t.expanded=!1,t.children=void 0,this.expandIDs=(this.expandIDs||[]).filter(e=>e!==t.folder.id)}}expandNode(t){if(!t.expanded){if(t.children){const e=this.nodes.indexOf(t);this.nodes=this.nodes.slice(0,e+1).concat(t.children).concat(this.nodes.slice(e+1))}else this.loadChildren(t);this.expandIDs.push(t.folder.id),t.expanded=!0}}}return t.\u0275fac=function(e){return new(e||t)(g.Y36(C.zi),g.Y36(x.K4),g.Y36(C.c),g.Y36(C.Cr))},t.\u0275cmp=g.Xpm({type:t,selectors:[["app-admin-folder-tree"]],viewQuery:function(t,e){if(1&t&&g.Gf(o.N7,7),2&t){let t;g.iGM(t=g.CRH())&&(e.viewport=t.first)}},inputs:{autoSelect:"autoSelect"},outputs:{selectionChange:"selectionChange"},decls:8,vars:2,consts:[[1,"actions"],[1,"name"],["title","Refresh Folder Tree",1,"button-on-control",3,"click"],[1,"icon-reload"],[1,"tree"],[1,"list-container","list-group",2,"height","100%",3,"itemSize"],[4,"cdkVirtualFor","cdkVirtualForOf"],[1,"node",3,"click"],[1,"node-toggle",3,"title","click"],["class","icon-spin icon-spinner",4,"ngIf"],[3,"class",4,"ngIf"],[1,"node-icon",3,"title","click"],[3,"title"],[1,"node-type"],[1,"icon-spin","icon-spinner"]],template:function(t,e){1&t&&(g.TgZ(0,"div",0),g.TgZ(1,"span",1),g._uU(2,"Folders"),g.qZA(),g.TgZ(3,"button",2),g.NdJ("click",function(){return e.refresh()}),g._UZ(4,"i",3),g.qZA(),g.qZA(),g.TgZ(5,"div",4),g.TgZ(6,"cdk-virtual-scroll-viewport",5),g.YNc(7,P,12,19,"ng-container",6),g.qZA(),g.qZA()),2&t&&(g.xp6(6),g.Q6J("itemSize",22),g.xp6(1),g.Q6J("cdkVirtualForOf",e.nodes))},directives:[o.N7,o.xd,o.x0,i.O5],pipes:[v.C],styles:["[_nghost-%COMP%]{width:100%;height:100%;display:flex;flex-direction:column}[_nghost-%COMP%]   .actions[_ngcontent-%COMP%]{padding:15px 15px 10px;background-color:var(--background-transparent);color:var(--on-control)}[_nghost-%COMP%]   .actions[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{padding-right:10px;vertical-align:middle;color:var(--on-control-active);font-size:20px;font-weight:100}[_nghost-%COMP%]   .tree[_ngcontent-%COMP%]{margin-top:10px;flex:1}[_nghost-%COMP%]   cdk-virtual-scroll-viewport[_ngcontent-%COMP%]{width:100%;height:100%;min-height:100%;overflow-x:hidden}[_nghost-%COMP%]   cdk-virtual-scroll-viewport[_ngcontent-%COMP%]     .cdk-virtual-scroll-content-wrapper{width:100%}[_nghost-%COMP%]   .node[_ngcontent-%COMP%]{width:100%;display:block;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;text-decoration:none;vertical-align:middle;height:22px;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;user-select:none;font-size:.9em}[_nghost-%COMP%]   .node[_ngcontent-%COMP%]   .node-toggle[_ngcontent-%COMP%]{display:inline-block;min-width:20px}[_nghost-%COMP%]   .node[_ngcontent-%COMP%]   .node-type[_ngcontent-%COMP%]{padding-left:5px;font-size:.7em;text-transform:uppercase}[_nghost-%COMP%]   .node.active[_ngcontent-%COMP%]{color:var(--on-control-hover)}"]}),t})();var w=n(40150);function y(t,e){1&t&&(g.TgZ(0,"a"),g._UZ(1,"i",8),g._uU(2," Show Folder Tools"),g.qZA())}function A(t,e){1&t&&(g.TgZ(0,"a"),g._UZ(1,"i",9),g._uU(2," Show Folder Tree"),g.qZA())}const k=function(t){return["/admin/folder",t,"overview"]},T=function(t){return["/admin/folder",t,"tracks"]},I=function(t){return["/admin/folder",t,"sub-folders"]},q=function(t){return["/admin/folder",t,"tags"]},S=function(t){return["/admin/folder",t,"health"]},U=function(t){return["/admin/folder",t,"tracks-health"]};function R(t,e){if(1&t&&(g.TgZ(0,"div",10),g.TgZ(1,"ul",11),g.TgZ(2,"li",12),g.TgZ(3,"a"),g._uU(4,"Overview"),g.qZA(),g.qZA(),g.TgZ(5,"li",12),g.TgZ(6,"a"),g._uU(7,"Tracks"),g.qZA(),g.qZA(),g.TgZ(8,"li",12),g.TgZ(9,"a"),g._uU(10,"Folders"),g.qZA(),g.qZA(),g.TgZ(11,"li",12),g.TgZ(12,"a"),g._uU(13,"Tags"),g.qZA(),g.qZA(),g.TgZ(14,"li",12),g.TgZ(15,"a"),g._uU(16,"Health"),g.qZA(),g.qZA(),g.TgZ(17,"li",12),g.TgZ(18,"a"),g._uU(19,"Track Health"),g.qZA(),g.qZA(),g.qZA(),g.qZA()),2&t){const t=g.oxw();g.xp6(2),g.Q6J("routerLink",g.VKq(6,k,t.id)),g.xp6(3),g.Q6J("routerLink",g.VKq(8,T,t.id)),g.xp6(3),g.Q6J("routerLink",g.VKq(10,I,t.id)),g.xp6(3),g.Q6J("routerLink",g.VKq(12,q,t.id)),g.xp6(3),g.Q6J("routerLink",g.VKq(14,S,t.id)),g.xp6(3),g.Q6J("routerLink",g.VKq(16,U,t.id))}}let J=(()=>{class t{constructor(t,e,n){this.route=t,this.router=e,this.uiState=n,this.id="",this.rightActive=!1,this.unsubscribe=new f.xQ,this.mode="overview"}refresh(){this.tree&&this.tree.refresh()}selectionChange(t){this.router.navigate([`/admin/folder/${t.id}/${this.mode}`]).catch(t=>{console.error(t)})}onFolderUpdate(t){this.tree&&this.tree.onFolderUpdate(t)}ngOnInit(){this.router.events.pipe((0,m.R)(this.unsubscribe)).subscribe(t=>{if(t instanceof u.m2&&this.route.firstChild&&this.route.firstChild.snapshot.url[0]){const t=this.route.firstChild.snapshot.url[0].path;M.includes(t)&&(this.mode=t)}}),this.route&&this.route.params.pipe((0,m.R)(this.unsubscribe)).subscribe(t=>{const e=t.id;this.id=e,this.tree&&e&&setTimeout(()=>{this.tree&&this.tree.selectFolderByID(e)})}),this.tree&&(this.tree.expandIDs=this.uiState.data["app-admin-folders"]||[]),this.refresh()}ngOnDestroy(){this.tree&&(this.uiState.data["app-admin-folders"]=this.tree.expandIDs),this.unsubscribe.next(),this.unsubscribe.complete()}}return t.\u0275fac=function(e){return new(e||t)(g.Y36(u.gz),g.Y36(u.F0),g.Y36(C.JU))},t.\u0275cmp=g.Xpm({type:t,selectors:[["app-admin-folder"]],viewQuery:function(t,e){if(1&t&&g.Gf(Z,7),2&t){let t;g.iGM(t=g.CRH())&&(e.tree=t.first)}},hostVars:2,hostBindings:function(t,e){2&t&&g.ekj("right-active",e.rightActive)},decls:11,vars:3,consts:[[1,"toggle",3,"click"],[4,"ngIf"],[1,"content"],[1,"left-content"],[3,"selectionChange"],[1,"right-content"],["class","navigation",4,"ngIf"],[1,"router-content"],[1,"icon-right"],[1,"icon-left"],[1,"navigation"],[1,"tabs"],["routerLinkActive","active",3,"routerLink"]],template:function(t,e){1&t&&(g.TgZ(0,"div",0),g.NdJ("click",function(){return e.rightActive=!e.rightActive}),g.YNc(1,y,3,0,"a",1),g.YNc(2,A,3,0,"a",1),g.qZA(),g.TgZ(3,"div",2),g.TgZ(4,"div",3),g.TgZ(5,"app-admin-folder-tree",4),g.NdJ("selectionChange",function(t){return e.selectionChange(t)}),g.qZA(),g.qZA(),g._UZ(6,"app-splitter"),g.TgZ(7,"div",5),g.YNc(8,R,20,18,"div",6),g.TgZ(9,"div",7),g._UZ(10,"router-outlet"),g.qZA(),g.qZA(),g.qZA()),2&t&&(g.xp6(1),g.Q6J("ngIf",!e.rightActive),g.xp6(1),g.Q6J("ngIf",e.rightActive),g.xp6(6),g.Q6J("ngIf",e.id))},directives:[i.O5,Z,w.H,u.lC,u.Od,u.rH],styles:["[_nghost-%COMP%]{overflow-y:auto;overflow-x:hidden;height:100%;width:100%;min-height:100%;flex:1 1 auto;position:relative;display:flex;flex-direction:column;overflow:hidden}[_nghost-%COMP%]   .toggle[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]{width:100%;z-index:1;display:flex;flex-flow:row wrap;justify-content:space-between;align-items:center;background-color:var(--background-transparent);color:var(--on-control)}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%]{padding-left:0;margin-top:0;margin-bottom:0;list-style:none;border:none;display:flex;flex-flow:row wrap;width:100%}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{position:relative;display:flex;padding:10px 15px;margin-bottom:-1px;cursor:pointer;flex:1;align-self:stretch;text-align:center;border-top-width:4px;border-top-style:solid;border-top-color:transparent;border-bottom-width:4px;border-bottom-style:solid;border-bottom-color:transparent;align-items:center;align-content:center;justify-content:center}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]:hover{background-color:var(--control-hover);transition:all .4s ease;border-bottom-width:4px;border-bottom-style:solid;border-bottom-color:transparent}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{padding-bottom:15px}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{margin-right:2px;line-height:1.42857143;border-radius:4px 4px 0 0;position:relative;display:block;cursor:pointer;padding:2px 0;border:none;font-size:14px;text-transform:uppercase;letter-spacing:.5px;color:var(--on-control);-webkit-user-select:none;-moz-user-select:none;user-select:none}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]:focus, [_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]:hover{background-color:unset;border:none;color:var(--on-control-hover)}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%] > li.active[_ngcontent-%COMP%]{cursor:default;border-bottom-color:var(--primary)!important}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%] > li.active[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:default;background-color:unset;color:var(--on-control-hover)}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%] > li.active[_ngcontent-%COMP%]:focus, [_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%] > li.active[_ngcontent-%COMP%]:hover{border-bottom-color:var(--primary)}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%] > li.disabled[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{color:var(--on-control-ambient-disabled)}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%] > li.disabled[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]:focus, [_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%] > li.disabled[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]:hover{color:var(--on-control-ambient-disabled);text-decoration:none;cursor:not-allowed;background-color:transparent}@media (max-width: 768px){[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%]{align-items:center;align-content:center;justify-content:center}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{padding:5px;min-width:33%}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{font-size:.8em}}@media (max-width: 400px){[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{padding:0 5px}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{font-size:.7em}}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs.mini[_ngcontent-%COMP%]{padding-left:15px;padding-right:15px}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs.mini[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{flex:0}@media (max-width: 768px){[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs.mini[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{min-width:20px}}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]{width:100%;height:100%;flex:1;display:flex;flex-flow:row nowrap;overflow:hidden;align-items:flex-start;align-content:flex-start;padding:0;min-height:100%}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .left-content[_ngcontent-%COMP%]{height:100%;width:20%;display:block;border-right:1px solid var(--background-border);min-width:240px}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .right-content[_ngcontent-%COMP%]{width:80%;flex-shrink:1;flex-grow:1;height:100%;display:flex;flex-flow:column nowrap;position:relative;overflow:hidden}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .right-content[_ngcontent-%COMP%]   .router-content[_ngcontent-%COMP%]{width:100%;height:100%;display:block;overflow:hidden}@media (max-width: 522px){[_nghost-%COMP%]{height:100%;width:100%;min-height:100%;overflow:hidden}[_nghost-%COMP%]   .toggle[_ngcontent-%COMP%]{display:block;position:relative;width:100%;height:33px;text-align:center;padding-top:5px;border-bottom:1px solid var(--background-border)}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]{width:100%;height:calc(100% - 33px);min-height:calc(100% - 33px);overflow:hidden;display:block;flex:none;position:relative}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   app-splitter[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .left-content[_ngcontent-%COMP%]{display:flex;height:100%;width:100%}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .right-content[_ngcontent-%COMP%]{display:none;height:100%;width:100%}.right-active[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .left-content[_ngcontent-%COMP%]{display:none}.right-active[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .right-content[_ngcontent-%COMP%]{display:flex}}"]}),t})(),Q=(()=>{class t{constructor(t){this.route=t,this.unsubscribe=new f.xQ}ngOnInit(){this.route&&this.route.parent&&this.route.parent.params.pipe((0,m.R)(this.unsubscribe)).subscribe(t=>{this.resolve(t),this.refresh()})}idChanged(){}refresh(){}ngOnDestroy(){this.unsubscribe.next(),this.unsubscribe.complete()}resolve(t){this.id=t.id,this.idChanged()}}return t.\u0275fac=function(e){return new(e||t)(g.Y36(u.gz))},t.\u0275cmp=g.Xpm({type:t,selectors:[["app-admin-base-parent-view-id"]],decls:0,vars:0,template:function(t,e){},styles:[""]}),t})(),N=(()=>{class t{selectionChange(t){this.data&&(this.data.folder=t)}dialogInit(t,e){var n;this.data=e.data,this.tree&&(this.tree.refresh(),(null===(n=this.data)||void 0===n?void 0:n.selectID)&&this.tree.selectFolderByID(this.data.selectID))}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=g.Xpm({type:t,selectors:[["app-dialog-choose-folder"]],viewQuery:function(t,e){if(1&t&&g.Gf(Z,7),2&t){let t;g.iGM(t=g.CRH())&&(e.tree=t.first)}},decls:1,vars:1,consts:[[3,"autoSelect","selectionChange"]],template:function(t,e){1&t&&(g.TgZ(0,"app-admin-folder-tree",0),g.NdJ("selectionChange",function(t){return e.selectionChange(t)}),g.qZA()),2&t&&g.Q6J("autoSelect",!0)},directives:[Z],styles:["[_nghost-%COMP%]{flex:1}"]}),t})();const z=function(){return{standalone:!0}};function F(t,e){if(1&t){const t=g.EpF();g.TgZ(0,"div"),g.TgZ(1,"form"),g.TgZ(2,"div",1),g.TgZ(3,"label"),g._uU(4,"Name"),g.qZA(),g.TgZ(5,"input",2),g.NdJ("ngModelChange",function(e){return g.CHM(t),g.oxw().edit.name=e}),g.qZA(),g.qZA(),g.qZA(),g.qZA()}if(2&t){const t=g.oxw();g.xp6(5),g.Q6J("ngModel",t.edit.name)("ngModelOptions",g.DdM(2,z))}}let H=(()=>{class t{dialogInit(t,e){this.edit=e.data}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=g.Xpm({type:t,selectors:[["app-dialog-folder"]],decls:1,vars:1,consts:[[4,"ngIf"],[1,"user-form-control"],["type","text","name","folder-name",3,"ngModel","ngModelOptions","ngModelChange"]],template:function(t,e){1&t&&g.YNc(0,F,6,3,"div",0),2&t&&g.Q6J("ngIf",e.edit)},directives:[i.O5,r._Y,r.JL,r.F,r.Fj,r.JJ,r.On],styles:["[_nghost-%COMP%] > div[_ngcontent-%COMP%]{margin-left:20px;margin-right:20px}[_nghost-%COMP%]   input[type=text][_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]   input[_ngcontent-%COMP%]{font-size:1.3em;line-height:1.3em}[_nghost-%COMP%]   .user-form-control[_ngcontent-%COMP%]{margin-bottom:8px;display:block}"]}),t})();var Y=n(24654),D=n(87639),E=n(7480),B=n(62569);function j(t,e){if(1&t&&(g.ynx(0),g._uU(1),g.BQk()),2&t){const t=g.oxw().$implicit;g.xp6(1),g.hij(" / ",null==t.folder.tag?null:t.folder.tag.albumType,"")}}const L=function(t){return["/admin/folder",t,"overview"]};function W(t,e){if(1&t){const t=g.EpF();g.TgZ(0,"tr",10),g.NdJ("click",function(){const e=g.CHM(t).$implicit;return e.selected=!e.selected}),g.TgZ(1,"td",4),g.TgZ(2,"a",11),g._uU(3),g.qZA(),g.qZA(),g.TgZ(4,"td",5),g._uU(5),g.qZA(),g.TgZ(6,"td",6),g._uU(7),g.qZA(),g.TgZ(8,"td",7),g._uU(9),g.qZA(),g.TgZ(10,"td",8),g._uU(11),g.YNc(12,j,2,1,"ng-container",12),g.qZA(),g.qZA()}if(2&t){const t=e.$implicit;g.ekj("selected",t.selected),g.xp6(2),g.Q6J("routerLink",g.VKq(9,L,t.folder.id)),g.xp6(1),g.Oqu(t.folder.name),g.xp6(2),g.Oqu(null==t.folder.tag?null:t.folder.tag.artist),g.xp6(2),g.Oqu(null==t.folder.tag?null:t.folder.tag.album),g.xp6(2),g.Oqu(null==t.folder.tag?null:t.folder.tag.year),g.xp6(2),g.hij(" ",t.folder.type," "),g.xp6(1),g.Q6J("ngIf",null==t.folder.tag?null:t.folder.tag.albumType)}}function $(t,e){if(1&t&&(g.TgZ(0,"table",2),g.TgZ(1,"tr",3),g.TgZ(2,"td",4),g._uU(3,"Title"),g.qZA(),g.TgZ(4,"td",5),g._uU(5,"Artist"),g.qZA(),g.TgZ(6,"td",6),g._uU(7,"Album"),g.qZA(),g.TgZ(8,"td",7),g._uU(9,"Year"),g.qZA(),g.TgZ(10,"td",8),g._uU(11,"Type"),g.qZA(),g.qZA(),g.YNc(12,W,13,11,"tr",9),g.qZA()),2&t){const t=g.oxw();g.xp6(12),g.Q6J("ngForOf",t.folderItems)}}class G{constructor(t){this.folder=t}}let V=(()=>{class t{constructor(){this.folders=[],this.folderItems=[]}getSortValue(t,e){var n,o;switch(t){case"name":return e.name;case"artist":return null===(n=e.tag)||void 0===n?void 0:n.artist;case"album":return null===(o=e.tag)||void 0===o?void 0:o.album;case"type":return e.type;default:return}}ngOnChanges(){this.folderItems=(this.folders||[]).map(t=>new G(t))}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=g.Xpm({type:t,selectors:[["app-admin-folder-list"]],inputs:{folders:"folders"},features:[g.TTD],decls:2,vars:2,consts:[["name","Folders",3,"list"],["class","folders",4,"ngIf"],[1,"folders"],[1,"folder","heading"],[1,"title"],[1,"artist"],[1,"album"],[1,"year"],[1,"type"],["class","folder",3,"selected","click",4,"ngFor","ngForOf"],[1,"folder",3,"click"],[3,"routerLink"],[4,"ngIf"]],template:function(t,e){1&t&&(g._UZ(0,"app-background-text-list",0),g.YNc(1,$,13,1,"table",1)),2&t&&(g.Q6J("list",e.folderItems),g.xp6(1),g.Q6J("ngIf",e.folderItems&&e.folderItems.length>0))},directives:[B.$,i.O5,i.sg,u.yS],styles:["[_nghost-%COMP%]{width:100%;overflow:auto;display:block}[_nghost-%COMP%]   .folders[_ngcontent-%COMP%]{padding:15px;font-size:.8em;width:100%}[_nghost-%COMP%]   .heading[_ngcontent-%COMP%]{font-size:.9em}[_nghost-%COMP%]   .folder[_ngcontent-%COMP%]{border-bottom:1px solid var(--control-border)}[_nghost-%COMP%]   .folder[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:5px 10px}[_nghost-%COMP%]   .folder[_ngcontent-%COMP%]:hover{background-color:var(--background-hover)}[_nghost-%COMP%]   .folder.selected[_ngcontent-%COMP%]{background-color:var(--background-active)}"]}),t})();function X(t,e){1&t&&g._UZ(0,"app-loading")}function K(t,e){if(1&t){const t=g.EpF();g.TgZ(0,"button",11),g.NdJ("click",function(){return g.CHM(t),g.oxw(2).moveSubfolders()}),g._UZ(1,"i",12),g.qZA()}}function tt(t,e){if(1&t&&g._UZ(0,"app-admin-folder-list",13),2&t){const t=g.oxw(2);g.Q6J("folders",t.folder.folders)}}function et(t,e){if(1&t){const t=g.EpF();g.TgZ(0,"div",2),g.TgZ(1,"div",3),g.TgZ(2,"button",4),g.NdJ("click",function(){return g.CHM(t),g.oxw().refresh()}),g._UZ(3,"i",5),g.qZA(),g.TgZ(4,"button",6),g.NdJ("click",function(){return g.CHM(t),g.oxw().newFolder()}),g._UZ(5,"i",7),g.qZA(),g.YNc(6,K,2,0,"button",8),g.qZA(),g._UZ(7,"app-background-text-list",9),g.YNc(8,tt,1,1,"app-admin-folder-list",10),g.qZA()}if(2&t){const t=g.oxw();g.xp6(6),g.Q6J("ngIf",null==t.folder||null==t.folder.folders?null:t.folder.folders.length),g.xp6(1),g.Q6J("list",t.folder.folders),g.xp6(1),g.Q6J("ngIf",null==t.folder.folders?null:t.folder.folders.length)}}let nt=(()=>{class t extends Q{constructor(t,e,n,o,i,r){super(t),this.jam=e,this.notify=n,this.folderService=o,this.dialogsService=i,this.dialogOverlay=r}ngOnInit(){super.ngOnInit(),this.folderService.foldersChange.pipe((0,m.R)(this.unsubscribe)).subscribe(t=>{t.id===this.id&&this.refresh()})}ngOnDestroy(){super.ngOnDestroy()}refresh(){this.folder=void 0,this.id&&this.jam.folder.id({id:this.id,folderIncFolders:!0,folderIncTag:!0}).then(t=>{this.folder=t}).catch(t=>{this.notify.error(t)})}newFolder(){if(!this.folder)return;const t=this.folder,e={folder:t,name:""};this.dialogOverlay.open({childComponent:H,title:"New Folder",data:e,onOkBtn:()=>(0,p.mG)(this,void 0,void 0,function*(){try{this.jam.folder.create({id:t.id,name:e.name}).then(e=>{this.folderService.waitForQueueResult("Creating Folder",e,[],[t.id])}).catch(t=>{this.notify.error(t)})}catch(n){return this.notify.error(n),Promise.reject(n)}}),onCancelBtn:()=>(0,p.mG)(this,void 0,void 0,function*(){return Promise.resolve()})})}moveSubfolders(){var t;if(!this.id||!(null===(t=this.folder)||void 0===t?void 0:t.folders))return;const e=this.id,n=this.folder.folders.map(t=>t.id),o=[e].concat(n),i={selectID:e,disableIDs:o};this.dialogOverlay.open({title:"Move Subfolders to",childComponent:N,data:i,panelClass:"overlay-panel-large-buttons",onOkBtn:()=>(0,p.mG)(this,void 0,void 0,function*(){try{const t=i.folder;if(!t)return;o.push(t.id),this.jam.folder.move({ids:n,newParentID:t.id}).then(t=>{this.folderService.waitForQueueResult("Moving Folders",t,[],o)}).catch(t=>{this.notify.error(t)})}catch(t){return this.notify.error(t),Promise.reject(t)}}),onCancelBtn:()=>(0,p.mG)(this,void 0,void 0,function*(){return Promise.resolve()})})}}return t.\u0275fac=function(e){return new(e||t)(g.Y36(u.gz),g.Y36(x.K4),g.Y36(C.c),g.Y36(C.Cr),g.Y36(Y.Hr),g.Y36(D.SL))},t.\u0275cmp=g.Xpm({type:t,selectors:[["app-admin-folder-folders"]],features:[g.qOj],decls:2,vars:2,consts:[[4,"ngIf"],["class","folders",4,"ngIf"],[1,"folders"],[1,"actions"],["title","Refresh",1,"button-on-control",3,"click"],[1,"icon-reload"],["title","New Folder\u2026",1,"button-on-control",3,"click"],[1,"icon-plus"],["class","button-on-control","title","Move Subfolders\u2026",3,"click",4,"ngIf"],["name","Folders",3,"list"],[3,"folders",4,"ngIf"],["title","Move Subfolders\u2026",1,"button-on-control",3,"click"],[1,"icon-right-bold"],[3,"folders"]],template:function(t,e){1&t&&(g.YNc(0,X,1,0,"app-loading",0),g.YNc(1,et,9,3,"div",1)),2&t&&(g.Q6J("ngIf",!e.folder),g.xp6(1),g.Q6J("ngIf",e.folder&&e.folder.folders))},directives:[i.O5,E.N,B.$,V],styles:["[_nghost-%COMP%]{height:100%;width:100%;display:block;overflow:hidden}[_nghost-%COMP%]   .folders[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;width:100%}[_nghost-%COMP%]   .folders[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{padding:10px 15px 0;border-bottom-color:var(--background-border);border-bottom-width:1px;border-bottom-style:solid}[_nghost-%COMP%]   .folders[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{margin-right:5px;margin-bottom:10px}[_nghost-%COMP%]   .folders[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%] > label[_ngcontent-%COMP%]{text-transform:uppercase;letter-spacing:1px;font-size:11px;margin-left:5px;margin-right:5px}[_nghost-%COMP%]   .folders[_ngcontent-%COMP%]   app-admin-folder-list[_ngcontent-%COMP%]{overflow-y:auto}"]}),t})();var ot=n(81515),it=n(91841),rt=n(89888),st=n(22689);function at(t,e){if(1&t){const t=g.EpF();g.TgZ(0,"image-cropper",6),g.NdJ("imageCropped",function(e){return g.CHM(t),g.oxw().imageCropped(e)})("imageLoaded",function(){return g.CHM(t),g.oxw().imageLoaded()})("cropperReady",function(){return g.CHM(t),g.oxw().cropperReady()})("loadImageFailed",function(){return g.CHM(t),g.oxw().loadImageFailed()}),g.qZA()}if(2&t){const t=g.oxw();g.Q6J("imageBase64",t.imageBase64)("format","jpeg")("maintainAspectRatio",t.maintainAspectRatio)}}function ct(t,e){if(1&t&&(g.TgZ(0,"div",7),g._UZ(1,"img",8),g.qZA()),2&t){const t=g.oxw();g.xp6(1),g.Q6J("src",t.croppedImage,g.LSH)}}let lt=(()=>{class t{constructor(t,e,n,o){this.app=t,this.jam=e,this.folderService=n,this.notify=o,this.imageBase64="",this.mimeType="image/jpeg",this.maintainAspectRatio=!0,this.imageEdited=new g.vpe,this.unsubscribe=new f.xQ}ngOnDestroy(){this.unsubscribe.next(),this.unsubscribe.complete()}load(){this.data&&this.jam.image.imageBinary({id:this.data.artwork.id}).then(t=>{this.imageBase64=`data:${t.contentType||"image/jpeg"};base64,${(0,st.q)(t.buffer)}`}).catch(t=>{this.notify.error(t)})}imageCropped(t){t.base64&&(this.croppedImage=t.base64,this.croppedImageFile=(0,d.Ll)(t.base64))}imageLoaded(){}cropperReady(){}loadImageFailed(){}ngOnChanges(t){this.load()}upload(){if(!this.croppedImageFile||!this.data)return;const t=this.data.folderID,e=new File([this.croppedImageFile],this.data.artwork.name,{type:this.croppedImageFile.type});this.jam.artwork.update({id:this.data.artwork.id},e).pipe((0,m.R)(this.unsubscribe)).subscribe(e=>{e.type===it.dt.Response&&(this.folderService.waitForQueueResult("Updating Folder Artwork",e.body,[t]),this.imageEdited.emit())},t=>{this.notify.error(t)},()=>{this.notify.success("Upload done")})}}return t.\u0275fac=function(e){return new(e||t)(g.Y36(C.zi),g.Y36(x.K4),g.Y36(C.Cr),g.Y36(C.c))},t.\u0275cmp=g.Xpm({type:t,selectors:[["app-admin-artwork-edit"]],inputs:{data:"data"},outputs:{imageEdited:"imageEdited"},features:[g.TTD],decls:9,vars:4,consts:[[1,"image-crop"],["type","checkbox",3,"ngModel","checked","ngModelChange"],[3,"imageBase64","format","maintainAspectRatio","imageCropped","imageLoaded","cropperReady","loadImageFailed",4,"ngIf"],["class","image-preview",4,"ngIf"],[1,"buttons"],[1,"button-on-control",3,"click"],[3,"imageBase64","format","maintainAspectRatio","imageCropped","imageLoaded","cropperReady","loadImageFailed"],[1,"image-preview"],[3,"src"]],template:function(t,e){1&t&&(g.TgZ(0,"div",0),g.TgZ(1,"label"),g.TgZ(2,"input",1),g.NdJ("ngModelChange",function(t){return e.maintainAspectRatio=t}),g.qZA(),g._uU(3," Maintain Aspect Ratio "),g.qZA(),g.YNc(4,at,1,3,"image-cropper",2),g.qZA(),g.YNc(5,ct,2,1,"div",3),g.TgZ(6,"div",4),g.TgZ(7,"button",5),g.NdJ("click",function(){return e.upload()}),g._uU(8,"Use Cropped Artwork"),g.qZA(),g.qZA()),2&t&&(g.xp6(2),g.Q6J("ngModel",e.maintainAspectRatio)("checked",e.maintainAspectRatio),g.xp6(2),g.Q6J("ngIf",e.imageBase64),g.xp6(1),g.Q6J("ngIf",e.croppedImage))},directives:[r.Wl,r.JJ,r.On,i.O5,d.ap],styles:["[_nghost-%COMP%]{width:100%;display:block;text-align:center}[_nghost-%COMP%]   image-cropper[_ngcontent-%COMP%]{width:300px;display:block}[_nghost-%COMP%]   .image-crop[_ngcontent-%COMP%]{display:inline-block;text-align:center;margin-left:10px;margin-right:10px}[_nghost-%COMP%]   .image-preview[_ngcontent-%COMP%]{margin-left:10px;margin-right:10px;display:inline-block}[_nghost-%COMP%]   .image-preview[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:300px}"]}),t})();function dt(t,e){if(1&t){const t=g.EpF();g.TgZ(0,"app-admin-artwork-edit",1),g.NdJ("imageEdited",function(){return g.CHM(t),g.oxw().onImageEdited()}),g.qZA()}if(2&t){const t=g.oxw();g.Q6J("data",t.data)}}let gt=(()=>{class t{constructor(){this.loading=!0}dialogInit(t,e){this.data=e.data,this.reference=t}onImageEdited(){this.reference&&this.reference.close()}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=g.Xpm({type:t,selectors:[["app-image-edit-overlay-content"]],decls:1,vars:1,consts:[[3,"data","imageEdited",4,"ngIf"],[3,"data","imageEdited"]],template:function(t,e){1&t&&g.YNc(0,dt,1,1,"app-admin-artwork-edit",0),2&t&&g.Q6J("ngIf",e.data)},directives:[i.O5,lt],styles:[""]}),t})();const ht=["inlineEditControl"];function pt(t,e){if(1&t){const t=g.EpF();g.TgZ(0,"div",2),g.TgZ(1,"input",3,4),g.NdJ("blur",function(e){return g.CHM(t),g.oxw().onBlur(e)})("keydown.enter",function(){return g.CHM(t),g.oxw().apply()})("ngModelChange",function(e){return g.CHM(t),g.oxw().value=e}),g.qZA(),g.qZA()}if(2&t){const t=g.oxw();g.xp6(1),g.Q6J("required",t.required)("name",t.value)("ngModel",t.value)("type",t.type)("placeholder",t.placeholder)}}function ut(t,e){if(1&t){const t=g.EpF();g.TgZ(0,"div"),g.TgZ(1,"div",5),g.NdJ("click",function(){g.CHM(t);const e=g.oxw();return e.edit(e.value)})("focus",function(){g.CHM(t);const e=g.oxw();return e.edit(e.value)}),g._uU(2),g._UZ(3,"i",6),g.qZA(),g.qZA()}if(2&t){const t=g.oxw();g.xp6(2),g.hij("",t.value,"\xa0")}}let ft=(()=>{class t{constructor(){this.placeholder="",this.type="text",this.required=!1,this.disabled=!1,this.endEditRequest=new g.vpe,this.editing=!1,this.editValue="",this.preValue="",this.onChange=Function.prototype,this.onTouched=Function.prototype}get value(){return this.editValue}set value(t){t!==this.editValue&&(this.editValue=t,this.onChange(t))}writeValue(t){this.editValue=t}registerOnChange(t){this.onChange=t}registerOnTouched(t){this.onTouched=t}onBlur(t){this.editing=!1,this.endEditRequest.emit()}apply(){this.editing=!1,this.endEditRequest.emit()}edit(t){this.disabled||(this.preValue=t,this.editing=!0,setTimeout(()=>{var t;(null===(t=this.inlineEditControl)||void 0===t?void 0:t.nativeElement)&&this.inlineEditControl.nativeElement.focus()}))}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=g.Xpm({type:t,selectors:[["app-inline-edit"]],viewQuery:function(t,e){if(1&t&&g.Gf(ht,5),2&t){let t;g.iGM(t=g.CRH())&&(e.inlineEditControl=t.first)}},inputs:{placeholder:"placeholder",type:"type",required:"required",disabled:"disabled"},outputs:{endEditRequest:"endEditRequest"},features:[g._Bn([{provide:r.JU,useExisting:t,multi:!0}])],decls:2,vars:2,consts:[["class","inline-edit-edit",4,"ngIf"],[4,"ngIf"],[1,"inline-edit-edit"],[3,"required","name","ngModel","type","placeholder","blur","keydown.enter","ngModelChange"],["inlineEditControl",""],["title","Click to edit","tabindex","0",1,"inline-edit",3,"click","focus"],[1,"icon-edit"]],template:function(t,e){1&t&&(g.YNc(0,pt,3,5,"div",0),g.YNc(1,ut,4,1,"div",1)),2&t&&(g.Q6J("ngIf",e.editing),g.xp6(1),g.Q6J("ngIf",!e.editing))},directives:[i.O5,r.Fj,r.Q7,r.JJ,r.On],styles:[".inline-edit{cursor:pointer}.inline-edit i{font-size:.7em}.inline-edit-edit{width:100%;display:block}.inline-edit-edit input{width:100%}\n"],encapsulation:2}),t})();var mt=n(74627);function Mt(t,e){if(1&t){const t=g.EpF();g.TgZ(0,"div",1),g.TgZ(1,"div",2),g.TgZ(2,"img",3),g.NdJ("click",function(){const e=g.CHM(t).$implicit;return g.oxw().editArtwork(e.artwork)}),g.qZA(),g.TgZ(3,"div",4),g._uU(4),g.qZA(),g.TgZ(5,"div",5),g._uU(6),g.qZA(),g.TgZ(7,"div",6),g._uU(8),g.qZA(),g.TgZ(9,"div",7),g._uU(10),g.ALo(11,"filesize"),g.qZA(),g.qZA(),g.TgZ(12,"div",8),g.TgZ(13,"app-inline-edit",9),g.NdJ("ngModelChange",function(e){return g.CHM(t).$implicit.name=e})("endEditRequest",function(){const e=g.CHM(t).$implicit;return g.oxw().editArtworkName(e)}),g.qZA(),g.TgZ(14,"a",10),g.NdJ("click",function(){const e=g.CHM(t).$implicit;return g.oxw().removeArtwork(e)}),g._UZ(15,"i",11),g.qZA(),g.qZA(),g.qZA()}if(2&t){const t=e.$implicit;g.xp6(2),g.Q6J("src",t.thumbnail,g.LSH),g.xp6(2),g.Oqu(t.artwork.types),g.xp6(2),g.Oqu(t.artwork.format),g.xp6(2),g.AsE("",t.artwork.width,"x",t.artwork.height,""),g.xp6(2),g.Oqu(g.lcZ(11,7,t.artwork.size)),g.xp6(3),g.Q6J("ngModel",t.name)}}function Ct(t){const e=t.split(".");return e.pop(),e.join(".")}function xt(t){const e=t.split(".");return e[e.length-1]}let vt=(()=>{class t{constructor(t,e,n,o,i,r){this.app=t,this.jam=e,this.notify=n,this.folderService=o,this.dialogs=i,this.dialogOverlay=r}trackByFn(t,e){return e.artwork.id}ngOnChanges(t){this.displayArtworks()}editArtworkName(t){this.jam.artwork.rename({id:t.artwork.id,newName:t.name}).then(t=>{this.folderService.waitForQueueResult("Renaming Artwork",t,this.folderID?[this.folderID]:[],[])}).catch(t=>{this.notify.error(t)})}editArtwork(t){this.dialogOverlay.open({childComponent:gt,title:"Edit Image",data:{artwork:t,folderID:this.folderID},panelClass:""})}showArtwork(t){const e=t.types.join(", ");this.dialogOverlay.open({title:e,childComponent:rt.$w,data:{name:e,url:this.jam.image.imageUrl({id:t.id})}})}removeArtwork(t){this.dialogs.confirm("Remove Artworks?",`Do you want to delete "${t.artwork.name}"?`,()=>{this.jam.artwork.remove({id:t.artwork.id}).then(e=>{this.nodes&&(this.nodes=this.nodes.filter(e=>e!==t)),this.folderService.waitForQueueResult("Removing Artwork",e,this.folderID?[this.folderID]:[])}).catch(t=>{this.notify.error(t)})})}displayArtworks(){this.nodes=[],this.artworks&&(this.nodes=this.artworks.map(t=>({name:Ct(t.name),type:xt(t.name),artwork:t,thumbnail:this.jam.image.imageUrl({id:t.id,size:128,format:x.GU.webp})})))}}return t.\u0275fac=function(e){return new(e||t)(g.Y36(C.zi),g.Y36(x.K4),g.Y36(C.c),g.Y36(C.Cr),g.Y36(Y.Hr),g.Y36(D.SL))},t.\u0275cmp=g.Xpm({type:t,selectors:[["app-admin-artwork-list"]],inputs:{artworks:"artworks",folderID:"folderID"},features:[g.TTD],decls:1,vars:2,consts:[["class","artwork",4,"ngFor","ngForOf","ngForTrackBy"],[1,"artwork"],[1,"artwork-img"],[3,"src","click"],[1,"mode"],[1,"format"],[1,"dims"],[1,"size"],[1,"artwork-types"],["type","text",3,"ngModel","ngModelChange","endEditRequest"],["title","Delete Image",1,"delete-button",3,"click"],[1,"icon-trash"]],template:function(t,e){1&t&&g.YNc(0,Mt,16,9,"div",0),2&t&&g.Q6J("ngForOf",e.nodes)("ngForTrackBy",e.trackByFn)},directives:[i.sg,ft,r.JJ,r.On],pipes:[mt.c],styles:["[_nghost-%COMP%]   .artwork[_ngcontent-%COMP%]{display:inline-block;padding-top:15px;padding-right:15px;font-size:.8em;text-align:center;width:200px}[_nghost-%COMP%]   .artwork[_ngcontent-%COMP%]   .artwork-img[_ngcontent-%COMP%]{position:relative;overflow:hidden}[_nghost-%COMP%]   .artwork[_ngcontent-%COMP%]   .artwork-img[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:auto}[_nghost-%COMP%]   .artwork[_ngcontent-%COMP%]   .artwork-img[_ngcontent-%COMP%]   .dims[_ngcontent-%COMP%], [_nghost-%COMP%]   .artwork[_ngcontent-%COMP%]   .artwork-img[_ngcontent-%COMP%]   .size[_ngcontent-%COMP%], [_nghost-%COMP%]   .artwork[_ngcontent-%COMP%]   .artwork-img[_ngcontent-%COMP%]   .format[_ngcontent-%COMP%], [_nghost-%COMP%]   .artwork[_ngcontent-%COMP%]   .artwork-img[_ngcontent-%COMP%]   .mode[_ngcontent-%COMP%]{position:absolute;padding:5px;background-color:var(--background-transparent);color:var(--on-background-active)}[_nghost-%COMP%]   .artwork[_ngcontent-%COMP%]   .artwork-img[_ngcontent-%COMP%]   .mode[_ngcontent-%COMP%]{top:0;left:0}[_nghost-%COMP%]   .artwork[_ngcontent-%COMP%]   .artwork-img[_ngcontent-%COMP%]   .format[_ngcontent-%COMP%]{bottom:0;left:0}[_nghost-%COMP%]   .artwork[_ngcontent-%COMP%]   .artwork-img[_ngcontent-%COMP%]   .dims[_ngcontent-%COMP%]{top:0;right:0}[_nghost-%COMP%]   .artwork[_ngcontent-%COMP%]   .artwork-img[_ngcontent-%COMP%]   .size[_ngcontent-%COMP%]{bottom:0;right:0}[_nghost-%COMP%]   .artwork-types[_ngcontent-%COMP%]{display:flex;flex-direction:row;width:100%;overflow:hidden}[_nghost-%COMP%]   .artwork-types[_ngcontent-%COMP%]   app-inline-edit[_ngcontent-%COMP%]{flex:1}[_nghost-%COMP%]   .artwork-types[_ngcontent-%COMP%]   .delete-button[_ngcontent-%COMP%]{-webkit-user-select:none;-moz-user-select:none;user-select:none}"]}),t})();function _t(t,e){1&t&&g._UZ(0,"app-loading")}function Ot(t,e){1&t&&g._UZ(0,"i",17)}function Pt(t,e){if(1&t){const t=g.EpF();g.TgZ(0,"input",18),g.NdJ("ngModelChange",function(e){return g.CHM(t),g.oxw().$implicit.checked=e}),g.qZA()}if(2&t){const t=g.oxw().$implicit;g.Q6J("ngModel",t.checked)("checked",t.checked)}}function bt(t,e){if(1&t){const t=g.EpF();g.TgZ(0,"div"),g.TgZ(1,"div",11),g.NdJ("click",function(){const e=g.CHM(t).$implicit;return e.checked=!e.checked}),g._UZ(2,"img",12),g.qZA(),g.TgZ(3,"div",13),g.TgZ(4,"div",14),g.TgZ(5,"label"),g.YNc(6,Ot,1,0,"i",15),g.YNc(7,Pt,1,2,"input",16),g._uU(8),g.qZA(),g.qZA(),g.qZA(),g.qZA()}if(2&t){const t=e.$implicit;g.xp6(2),g.s9C("alt",t.name),g.Q6J("src",t.thumbnail,g.LSH),g.xp6(4),g.Q6J("ngIf",t.storing),g.xp6(1),g.Q6J("ngIf",!t.storing),g.xp6(1),g.hij(" ",t.name," ")}}function Zt(t,e){if(1&t&&(g.TgZ(0,"div"),g._UZ(1,"app-background-text-list",8),g.TgZ(2,"div",9),g.YNc(3,bt,9,5,"div",10),g.qZA(),g.qZA()),2&t){const t=g.oxw();g.xp6(1),g.Q6J("list",t.nodes),g.xp6(2),g.Q6J("ngForOf",t.nodes)("ngForTrackBy",t.trackByFn)}}function wt(t,e){if(1&t&&g._UZ(0,"app-admin-artwork-list",21),2&t){const t=g.oxw(2);g.Q6J("folderID",t.data.folder.id)("artworks",t.artworks)}}function yt(t,e){if(1&t&&(g.TgZ(0,"div",19),g.TgZ(1,"div",2),g._uU(2,"Current Images"),g.qZA(),g.YNc(3,wt,1,2,"app-admin-artwork-list",20),g.qZA()),2&t){const t=g.oxw();g.xp6(3),g.Q6J("ngIf",!t.isArtRefreshing)}}function At(t,e){1&t&&(g.TgZ(0,"button",24),g._UZ(1,"i",17),g.qZA())}function kt(t,e){if(1&t){const t=g.EpF();g.TgZ(0,"button",25),g.NdJ("click",function(){return g.CHM(t),g.oxw(2).use()}),g._uU(1,"Use Checked Artwork"),g.qZA()}}function Tt(t,e){if(1&t&&(g.TgZ(0,"div"),g.YNc(1,At,2,0,"button",22),g.YNc(2,kt,2,0,"button",23),g.qZA()),2&t){const t=g.oxw();g.xp6(1),g.Q6J("ngIf",t.isWorking),g.xp6(1),g.Q6J("ngIf",!t.isWorking)}}let It=(()=>{class t{constructor(t,e,n,o){this.jam=t,this.notify=e,this.folderService=n,this.http=o,this.isWorking=!1,this.isArtRefreshing=!1,this.searchSource={name:"",url:""},this.unsubscribe=new f.xQ}trackByFn(t,e){return e.image}ngOnDestroy(){this.unsubscribe.next(),this.unsubscribe.complete()}ngOnChanges(t){this.search(),this.data&&this.data.folder&&(this.data.folder.artworks?this.artworks=this.data.folder.artworks:this.refreshArtworks())}refreshArtworks(){!this.data||(this.isArtRefreshing=!0,this.jam.artwork.search({folderIDs:[this.data.folder.id]}).then(t=>{this.isArtRefreshing=!1,this.artworks=t.items}).catch(t=>{this.isArtRefreshing=!1,console.error(t)}))}loadWikiDataID(t){var e,n;return(0,p.mG)(this,void 0,void 0,function*(){const o=yield this.jam.metadata.musicbrainzLookup({type:x.ej.artist,mbID:t});if(null===(n=null===(e=null==o?void 0:o.data)||void 0===e?void 0:e.artist)||void 0===n?void 0:n.relations){const t=o.data.artist.relations.find(t=>"wikidata"===t.type);if(null==t?void 0:t.url)return t.url.resource.split("/").pop()}})}loadWikiCommonImage(t){var e,n;return(0,p.mG)(this,void 0,void 0,function*(){const o=yield this.loadWikiDataID(t);if(!o)return;const i=yield this.jam.metadata.wikidataLookup({wikiDataID:o}),r=null===(n=null===(e=null==i?void 0:i.data)||void 0===e?void 0:e.entity)||void 0===n?void 0:n.claims;if(!r)return;const s=Object.keys(r);for(const t of s){let e=r[t];e=e.filter(t=>"string"==typeof t.mainsnak.datavalue.value&&(0,ot.U_)(t.mainsnak.datavalue.value.toLowerCase(),["jpg","jpeg","png"]));const n=e[0];if(n){const t=`https://en.wikipedia.org/w/api.php?format=json&action=query&origin=*&titles=File:${n.mainsnak.datavalue.value}&prop=imageinfo&iiprop=extmetadata|url&iiextmetadatafilter=LicenseShortName`,e=yield this.http.get(t).toPromise();if(e&&e.query.pages){const t=e.query.pages[Object.keys(e.query.pages)[0]];if(t&&t.imageinfo[0])return{name:x.iJ.artist,thumbnail:t.imageinfo[0].url,image:t.imageinfo[0].url,licence:t.imageinfo[0].extmetadata.LicenseShortName.value,checked:!0,storing:!1,types:[x.iJ.artist]}}}}})}loadWikiCommon(t){this.loadWikiCommonImage(t).then(t=>{this.nodes=[],t&&(t.checked=!0,this.nodes.push(t))}).catch(t=>{this.nodes=[],this.notify.error(t)})}use(){var t;const e=(this.nodes||[]).find(t=>t.checked&&!t.storing),n=null===(t=this.data)||void 0===t?void 0:t.folder;e&&n?(this.isWorking=!0,e.storing=!0,this.jam.artwork.createByUrl({folderID:n.id,url:e.image,types:e.types}).then(t=>{this.folderService.waitForQueueResult("Creating Artwork",t,[n.id]).pipe((0,m.R)(this.unsubscribe)).subscribe(()=>{e.storing=!1,e.checked=!1}),this.use()}).catch(t=>{e.storing=!1,this.notify.error(t)})):this.isWorking=!1}ngOnInit(){this.folderService.foldersChange.pipe((0,m.R)(this.unsubscribe)).subscribe(t=>{var e;t.id===(null===(e=this.data)||void 0===e?void 0:e.folder.id)&&this.refreshArtworks()})}loadReleaseGroupAndRelease(t,e){this.jam.metadata.coverartarchiveLookup({type:x.xB.releaseGroup,mbID:e}).then(e=>{let n=this.coverArtResponseToNodes(e.data);this.jam.metadata.coverartarchiveLookup({type:x.xB.release,mbID:t}).then(t=>{n=n.concat(this.coverArtResponseToNodes(t.data)),this.display(n)}).catch(t=>{this.notify.error(t)})}).catch(t=>{this.notify.error(t)})}loadReleaseGroup(t){this.jam.metadata.coverartarchiveLookup({type:x.xB.releaseGroup,mbID:t}).then(t=>{const e=this.coverArtResponseToNodes(t.data);this.display(e)}).catch(t=>{this.notify.error(t)})}loadRelease(t){t&&this.jam.metadata.coverartarchiveLookup({type:x.xB.release,mbID:t}).then(t=>{const e=this.coverArtResponseToNodes(t.data);this.display(e),0===e.length&&this.data&&this.data.folder&&this.data.folder.tag&&this.data.folder.tag.mbReleaseGroupID&&(this.nodes=void 0,this.loadReleaseGroup(this.data.folder.tag.mbReleaseGroupID))}).catch(t=>{this.notify.error(t)})}coverArtResponseToNodes(t){return t.images?t.images.map(t=>(0===t.types.length&&t.types.push("Other"),{name:(t.types||[]).join("/").toLowerCase(),thumbnail:this.jam.metadata.coverartarchiveImageUrl({url:t.thumbnails.small}),licence:"",image:t.image,types:(t.types||[]).map(t=>t.toLowerCase()),checked:!1,storing:!1,stored:!1})):[]}search(){this.data&&this.data.folder&&this.data.folder.tag&&(this.data.folder.type===x.Sr.artist?this.data.folder.tag.mbArtistID&&(this.searchSource={name:"Wiki Commons",url:"https://commons.wikimedia.org"},this.loadWikiCommon(this.data.folder.tag.mbArtistID)):this.data&&this.data.folder&&this.data.folder.tag&&(this.searchSource={name:"Coverart Archive",url:"https://coverartarchive.org"},this.data.folder.tag.mbReleaseID&&this.data.folder.tag.mbReleaseGroupID?this.loadReleaseGroupAndRelease(this.data.folder.tag.mbReleaseID,this.data.folder.tag.mbReleaseGroupID):this.data.folder.tag.mbReleaseID?this.loadRelease(this.data.folder.tag.mbReleaseID):this.data.folder.tag.mbReleaseGroupID&&this.loadReleaseGroup(this.data.folder.tag.mbReleaseGroupID)))}display(t){this.nodes=t;let e=t.find(t=>1===t.types.length&&t.types[0]===x.iJ.front);e||(e=t.find(t=>t.types.includes(x.iJ.front))),e&&this.nodes.forEach(t=>t.checked=t===e)}}return t.\u0275fac=function(e){return new(e||t)(g.Y36(x.K4),g.Y36(C.c),g.Y36(C.Cr),g.Y36(it.eN))},t.\u0275cmp=g.Xpm({type:t,selectors:[["app-admin-folder-artwork-search"]],inputs:{data:"data"},features:[g.TTD],decls:11,vars:6,consts:[[1,"image-selector"],[1,"art-source"],[1,"section"],["rel","noopener","target","_blank",3,"href"],[4,"ngIf"],[1,"artwork"],["class","current",4,"ngIf"],[1,"buttons"],["name","Images",3,"list"],[1,"images"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"image",3,"click"],[3,"alt","src"],[1,"footer"],[1,"footer-content"],["class","icon-spin icon-spinner",4,"ngIf"],["type","checkbox",3,"ngModel","checked","ngModelChange",4,"ngIf"],[1,"icon-spin","icon-spinner"],["type","checkbox",3,"ngModel","checked","ngModelChange"],[1,"current"],[3,"folderID","artworks",4,"ngIf"],[3,"folderID","artworks"],["class","button-on-control",4,"ngIf"],["class","button-on-control",3,"click",4,"ngIf"],[1,"button-on-control"],[1,"button-on-control",3,"click"]],template:function(t,e){1&t&&(g.TgZ(0,"div",0),g.TgZ(1,"div",1),g.TgZ(2,"div",2),g.TgZ(3,"a",3),g._uU(4),g.qZA(),g.qZA(),g.YNc(5,_t,1,0,"app-loading",4),g.YNc(6,Zt,4,3,"div",4),g.qZA(),g.TgZ(7,"div",5),g.YNc(8,yt,4,1,"div",6),g.qZA(),g.qZA(),g.TgZ(9,"div",7),g.YNc(10,Tt,3,2,"div",4),g.qZA()),2&t&&(g.xp6(3),g.Q6J("href",e.searchSource.url,g.LSH),g.xp6(1),g.Oqu(e.searchSource.name),g.xp6(1),g.Q6J("ngIf",!e.nodes),g.xp6(1),g.Q6J("ngIf",e.nodes),g.xp6(2),g.Q6J("ngIf",e.data&&e.artworks),g.xp6(2),g.Q6J("ngIf",e.nodes&&e.nodes.length>0))},directives:[i.O5,E.N,B.$,i.sg,r.Wl,r.JJ,r.On,vt],styles:["[_nghost-%COMP%]   .image-selector[_ngcontent-%COMP%]{display:flex;flex-flow:column wrap;height:calc(100% - 40px)}[_nghost-%COMP%]   .image-buttons[_ngcontent-%COMP%]{height:40px}[_nghost-%COMP%]   .artwork[_ngcontent-%COMP%]{overflow-y:auto;width:50%;height:100%;padding-left:15px}[_nghost-%COMP%]   .art-source[_ngcontent-%COMP%]{padding-right:15px;overflow-y:auto;width:50%;height:100%;border-right:1px solid var(--background-border)}[_nghost-%COMP%]   .art-source[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block}[_nghost-%COMP%]   .art-source[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{display:inline-block;padding-top:15px;padding-right:15px;font-size:.8em}[_nghost-%COMP%]   .art-source[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:185px;min-width:185px;min-height:185px;height:auto}[_nghost-%COMP%]   .art-source[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]{font-size:.8em}[_nghost-%COMP%]   .section[_ngcontent-%COMP%]{border-bottom:1px solid var(--background-border);padding-bottom:5px}[_nghost-%COMP%]   .section[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--on-background-active)}[_nghost-%COMP%]   .section[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:var(--on-background)}"]}),t})(),qt=(()=>{class t{dialogInit(t,e){this.data=e.data}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=g.Xpm({type:t,selectors:[["app-dialog-folder-artwork-search"]],decls:1,vars:1,consts:[[3,"data"]],template:function(t,e){1&t&&g._UZ(0,"app-admin-folder-artwork-search",0),2&t&&g.Q6J("data",e.data)},directives:[It],styles:[""]}),t})();function St(t,e){1&t&&(g.TgZ(0,"div",1),g.TgZ(1,"div",2),g._UZ(2,"i",3),g.qZA(),g.qZA())}function Ut(t,e){1&t&&(g.TgZ(0,"div",2),g._uU(1,"No Hints"),g.qZA())}function Rt(t,e){if(1&t&&(g.TgZ(0,"div",10),g._uU(1),g.qZA()),2&t){const t=e.$implicit;g.xp6(1),g.Oqu(t)}}function Jt(t,e){if(1&t&&(g.TgZ(0,"div",2),g._UZ(1,"i",8),g._uU(2),g.YNc(3,Rt,2,1,"div",9),g.qZA()),2&t){const t=e.$implicit;g.xp6(2),g.hij(" ",t.hint.name," "),g.xp6(1),g.Q6J("ngForOf",t.details)}}function Qt(t,e){1&t&&g._UZ(0,"i",3)}function Nt(t,e){if(1&t&&(g.ynx(0),g._uU(1),g.BQk()),2&t){const t=g.oxw().$implicit;g.xp6(1),g.Oqu(t.name)}}function zt(t,e){if(1&t){const t=g.EpF();g.TgZ(0,"button",11),g.NdJ("click",function(){return g.CHM(t).$implicit.click()}),g.YNc(1,Qt,1,0,"i",12),g.YNc(2,Nt,2,1,"ng-container",13),g.qZA()}if(2&t){const t=e.$implicit;g.xp6(1),g.Q6J("ngIf",t.running),g.xp6(1),g.Q6J("ngIf",!t.running)}}function Ft(t,e){if(1&t&&(g.TgZ(0,"div",1),g.YNc(1,Ut,2,0,"div",4),g.YNc(2,Jt,4,2,"div",5),g.TgZ(3,"div",6),g.YNc(4,zt,3,2,"button",7),g.qZA(),g.qZA()),2&t){const t=g.oxw();g.xp6(1),g.Q6J("ngIf",0===t.hints.length),g.xp6(1),g.Q6J("ngForOf",t.hints)("ngForTrackBy",t.trackByFn),g.xp6(2),g.Q6J("ngForOf",t.solutions)}}let Ht=(()=>{class t{constructor(t,e,n,o,i,r){this.app=t,this.router=e,this.jam=n,this.notify=o,this.dialogOverlay=i,this.folderService=r,this.solutions=[],this.unsubscribe=new f.xQ}ngOnDestroy(){this.unsubscribe.next(),this.unsubscribe.complete()}trackByFn(t,e){return e.hint.id}searchImages(t){this.dialogOverlay.open({title:"Search Artwork Images",childComponent:qt,data:{folder:t},panelClass:"overlay-panel-large-buttons"})}ngOnChanges(){this.display(this.folderHealth)}static describeImageInvalidHint(t,e){if(!t.details||0===t.details.length)return[];const n=[t.details[0].reason];return t.details[0].expected&&n.push(`Expected: ${t.details[0].expected} Actual: ${t.details[0].actual}`),n}static describeAlbumTracksMissingHint(t,e){if(!t.details||0===t.details.length)return[];const n=[];return t.details[0].expected&&n.push(`Expected: ${t.details[0].expected} Actual: ${t.details[0].actual}`),n}describeImageQualityHint(t,e){if(this.addAlbumImageSearchSolution(e),!t.details||0===t.details.length)return[];const n=[t.details[0].reason];return n.push(`Expected: ${t.details[0].expected} Actual: ${t.details[0].actual}`),n}addArtistImageSearchSolution(t){t.tag&&t.tag.mbArtistID&&this.solutions.push({name:"Search",click:()=>(0,p.mG)(this,void 0,void 0,function*(){this.searchImages(t)})})}addAlbumImageSearchSolution(t){t.tag&&(t.tag.mbReleaseID||t.tag.mbReleaseGroupID)&&this.solutions.push({name:"Search",click:()=>(0,p.mG)(this,void 0,void 0,function*(){this.searchImages(t)})})}addRenameSolution(t,e){if(!this.solutions.find(t=>"Rename"===t.name)){const n={name:"Rename",click:()=>(0,p.mG)(this,void 0,void 0,function*(){if(n.running)return;n.running=!0;const o=yield this.jam.folder.rename({id:t.id,name:e});this.folderService.waitForQueueResult("Renaming Folder",o,[t.id]).pipe((0,m.R)(this.unsubscribe)).subscribe(()=>{n.running=!1})})};this.solutions.push(n)}}addEditTagSolution(t){this.solutions.find(t=>"Edit Tags"===t.name)||this.solutions.push({name:"Edit Tags",click:()=>(0,p.mG)(this,void 0,void 0,function*(){this.router.navigate([`/admin/folder/${t.id}/tags`]).catch(t=>{console.error(t)})})})}describeMBIDMissingHint(t,e){return this.addEditTagSolution(e),[]}describeAlbumTagMissingHint(t,e){return this.addEditTagSolution(e),t.details?[`Expected: ${t.details.map(t=>t.expected).join(",")}`]:[]}describeNameNonConformHint(t,e){const n=t.details&&t.details.length>0?t.details[0].expected:"";return n?(this.addRenameSolution(e,n),[`Current: ${e.name}`,`Suggested Name: ${n}`]):[]}describeArtistImageMissingHint(t,e){return this.addArtistImageSearchSolution(e),[]}describeAlbumImageMissingHint(t,e){return this.addAlbumImageSearchSolution(e),[]}describeHint(e,n){switch(e.id){case x.Mx.albumMBIDExists:return this.describeMBIDMissingHint(e,n);case x.Mx.albumTagsExists:return this.describeAlbumTagMissingHint(e,n);case x.Mx.albumNameConform:case x.Mx.artistNameConform:return this.describeNameNonConformHint(e,n);case x.Mx.albumImageExists:return this.describeAlbumImageMissingHint(e,n);case x.Mx.albumTracksComplete:return t.describeAlbumTracksMissingHint(e,n);case x.Mx.artistImageExists:return this.describeArtistImageMissingHint(e,n);case x.Mx.artistImageValid:case x.Mx.albumImageValid:return t.describeImageInvalidHint(e,n);case x.Mx.albumImageQuality:return this.describeImageQualityHint(e,n)}return[]}display(t){this.hints=[],this.solutions=[],(null==t?void 0:t.health)&&(this.hints=t.health.map(e=>({hint:e,details:this.describeHint(e,t.folder)})))}}return t.\u0275fac=function(e){return new(e||t)(g.Y36(C.zi),g.Y36(u.F0),g.Y36(x.K4),g.Y36(C.c),g.Y36(D.SL),g.Y36(C.Cr))},t.\u0275cmp=g.Xpm({type:t,selectors:[["app-folder-health"]],inputs:{folderHealth:"folderHealth"},features:[g.TTD],decls:2,vars:2,consts:[["class","hints",4,"ngIf"],[1,"hints"],[1,"hint"],[1,"icon-spin","icon-spinner"],["class","hint",4,"ngIf"],["class","hint",4,"ngFor","ngForOf","ngForTrackBy"],[1,"solutions"],["class","button-on-background",3,"click",4,"ngFor","ngForOf"],[1,"icon-warning"],["class","details",4,"ngFor","ngForOf"],[1,"details"],[1,"button-on-background",3,"click"],["class","icon-spin icon-spinner",4,"ngIf"],[4,"ngIf"]],template:function(t,e){1&t&&(g.YNc(0,St,3,0,"div",0),g.YNc(1,Ft,5,4,"div",0)),2&t&&(g.Q6J("ngIf",!e.hints),g.xp6(1),g.Q6J("ngIf",e.hints))},directives:[i.O5,i.sg],styles:["[_nghost-%COMP%]{height:100%;width:100%;overflow-y:auto;overflow-x:auto;display:block}[_nghost-%COMP%]   .icon-warning[_ngcontent-%COMP%]{color:var(--accent)}[_nghost-%COMP%]   .label[_ngcontent-%COMP%]{padding-left:28px;font-size:.8em;text-transform:uppercase;min-width:30%;display:inline-block}[_nghost-%COMP%]   .hints[_ngcontent-%COMP%]{padding-top:10px}[_nghost-%COMP%]   .hint[_ngcontent-%COMP%]{padding-bottom:10px}"]}),t})();function Yt(t,e){if(1&t&&(g.TgZ(0,"option",11),g._uU(1),g.qZA()),2&t){const t=e.$implicit;g.Q6J("value",t),g.xp6(1),g.Oqu(t)}}function Dt(t,e){if(1&t){const t=g.EpF();g.TgZ(0,"select",9),g.NdJ("ngModelChange",function(e){return g.CHM(t),g.oxw().filter=e})("ngModelChange",function(){return g.CHM(t),g.oxw().onFilterChange()}),g.YNc(1,Yt,2,2,"option",10),g.qZA()}if(2&t){const t=g.oxw();g.Q6J("ngModel",t.filter),g.xp6(1),g.Q6J("ngForOf",t.modes)}}function Et(t,e){1&t&&g._UZ(0,"app-loading")}function Bt(t,e){if(1&t&&(g.ynx(0),g.TgZ(1,"div",20),g._uU(2,"Album"),g.qZA(),g.TgZ(3,"div",21),g._uU(4),g.qZA(),g.TgZ(5,"div",22),g._uU(6),g.qZA(),g.TgZ(7,"div",23),g._uU(8),g.qZA(),g.BQk()),2&t){const t=g.oxw().$implicit;g.xp6(4),g.Oqu(null==t.folder.tag?null:t.folder.tag.album),g.xp6(2),g.Oqu(null==t.folder.tag?null:t.folder.tag.artist),g.xp6(2),g.Oqu(null==t.folder.tag?null:t.folder.tag.year)}}function jt(t,e){if(1&t&&(g.ynx(0),g.TgZ(1,"div",20),g._uU(2,"Album"),g.qZA(),g.TgZ(3,"div",21),g._uU(4),g.qZA(),g.TgZ(5,"div",22),g._uU(6),g.qZA(),g.TgZ(7,"div",23),g._uU(8),g.qZA(),g.BQk()),2&t){const t=g.oxw().$implicit;g.xp6(4),g.Oqu(null==t.folder.tag?null:t.folder.tag.album),g.xp6(2),g.Oqu(null==t.folder.tag?null:t.folder.tag.artist),g.xp6(2),g.Oqu(null==t.folder.tag?null:t.folder.tag.year)}}function Lt(t,e){if(1&t&&(g.ynx(0),g.TgZ(1,"div",20),g._uU(2,"Artist"),g.qZA(),g.TgZ(3,"div",21),g._uU(4),g.qZA(),g.BQk()),2&t){const t=g.oxw().$implicit;g.xp6(4),g.Oqu(null==t.folder.tag?null:t.folder.tag.artist)}}function Wt(t,e){if(1&t&&(g.ynx(0),g.TgZ(1,"div",20),g._uU(2,"Collection"),g.qZA(),g.TgZ(3,"div",21),g._uU(4),g.qZA(),g.BQk()),2&t){const t=g.oxw().$implicit;g.xp6(4),g.Oqu(t.folder.name)}}function $t(t,e){if(1&t&&(g.ynx(0),g.TgZ(1,"div",21),g._uU(2),g.qZA(),g.BQk()),2&t){const t=g.oxw().$implicit;g.xp6(2),g.Oqu(t.folder.name)}}const Gt=function(t){return["/admin/folder",t,"overview"]};function Vt(t,e){if(1&t&&(g.TgZ(0,"div",12),g.TgZ(1,"div",13),g.TgZ(2,"a",14),g.ynx(3,15),g.YNc(4,Bt,9,3,"ng-container",16),g.YNc(5,jt,9,3,"ng-container",16),g.YNc(6,Lt,5,1,"ng-container",16),g.YNc(7,Wt,5,1,"ng-container",16),g.YNc(8,$t,3,1,"ng-container",17),g.BQk(),g.qZA(),g.qZA(),g.TgZ(9,"div",18),g._UZ(10,"app-folder-health",19),g.qZA(),g.qZA()),2&t){const t=e.$implicit;g.xp6(2),g.Q6J("routerLink",g.VKq(7,Gt,t.folder.id)),g.xp6(1),g.Q6J("ngSwitch",t.folder.type),g.xp6(1),g.Q6J("ngSwitchCase","multialbum"),g.xp6(1),g.Q6J("ngSwitchCase","album"),g.xp6(1),g.Q6J("ngSwitchCase","artist"),g.xp6(1),g.Q6J("ngSwitchCase","collection"),g.xp6(3),g.Q6J("folderHealth",t)}}let Xt=(()=>{class t extends Q{constructor(t,e,n,o,i){super(t),this.app=e,this.jam=n,this.notify=o,this.folderService=i,this.modes=[]}onFilterChange(){this.reDisplay()}ngOnInit(){super.ngOnInit(),this.folderService.foldersChange.pipe((0,m.R)(this.unsubscribe)).subscribe(t=>{if(t.id===this.id)this.refresh();else if(this.all){const e=this.all.find(e=>e.folder.id===t.id);e&&this.jam.folder.health({ids:[t.id],folderIncTag:!0}).then(t=>{if(this.all){const n=t.find(t=>t.folder.id===e.folder.id);n?this.all[this.all.indexOf(e)]=n:this.all=this.all.filter(t=>t.folder.id!==e.folder.id)}this.reDisplay()}).catch(t=>{this.notify.error(t)})}})}ngOnDestroy(){super.ngOnDestroy()}refresh(){this.hints=void 0,this.jam.folder.health({childOfID:this.id,folderIncTag:!0}).then(t=>{this.display(t)}).catch(t=>{this.notify.error(t)})}reDisplay(){this.hints=this.filter&&this.all?this.all.filter(t=>t.health&&t.health.find(t=>t.name===this.filter)):this.all}display(t){this.all=t,this.modes=[];for(const e of t)if(e.health)for(const t of e.health)this.modes.includes(t.name)||this.modes.push(t.name);this.reDisplay()}}return t.\u0275fac=function(e){return new(e||t)(g.Y36(u.gz),g.Y36(C.zi),g.Y36(x.K4),g.Y36(C.c),g.Y36(C.Cr))},t.\u0275cmp=g.Xpm({type:t,selectors:[["app-admin-folder-health"]],features:[g.qOj],decls:9,vars:4,consts:[[1,"health"],[1,"actions"],["title","Refresh List",1,"button-on-control",3,"click"],[1,"icon-reload"],["placeholder","Type of Hints",3,"ngModel","ngModelChange",4,"ngIf"],[1,"health-content"],[4,"ngIf"],["name","Folder Health Issues",3,"list"],["class","folder",4,"ngFor","ngForOf"],["placeholder","Type of Hints",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"folder"],[1,"meta"],[3,"routerLink"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"folder-health"],[3,"folderHealth"],[1,"type"],[1,"name"],[1,"artist"],[1,"year"]],template:function(t,e){1&t&&(g.TgZ(0,"div",0),g.TgZ(1,"div",1),g.TgZ(2,"button",2),g.NdJ("click",function(){return e.refresh()}),g._UZ(3,"i",3),g.qZA(),g.YNc(4,Dt,2,2,"select",4),g.qZA(),g.TgZ(5,"div",5),g.YNc(6,Et,1,0,"app-loading",6),g._UZ(7,"app-background-text-list",7),g.YNc(8,Vt,11,9,"div",8),g.qZA(),g.qZA()),2&t&&(g.xp6(4),g.Q6J("ngIf",e.modes.length>0),g.xp6(2),g.Q6J("ngIf",!e.hints),g.xp6(1),g.Q6J("list",e.hints),g.xp6(1),g.Q6J("ngForOf",e.hints))},directives:[i.O5,B.$,i.sg,r.EJ,r.JJ,r.On,r.YN,r.Kr,E.N,u.yS,i.RF,i.n9,i.ED,Ht],styles:["[_nghost-%COMP%]{height:100%;width:100%}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]{height:100%;width:100%;display:flex;flex-direction:column}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{padding:10px 15px 0;border-bottom-color:var(--background-border);border-bottom-width:1px;border-bottom-style:solid}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{margin-right:5px;margin-bottom:10px}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%] > label[_ngcontent-%COMP%]{text-transform:uppercase;letter-spacing:1px;font-size:11px;margin-left:5px;margin-right:5px}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .health-content[_ngcontent-%COMP%]{padding:15px;overflow-y:auto;overflow-x:auto}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]{border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:var(--background-border);padding:15px;display:flex;flex-flow:row wrap;flex-flow:row nowrap}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]{width:30%;padding-right:15px;margin-left:15px;display:flex;flex-flow:column wrap;position:relative}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:100%;text-overflow:ellipsis;overflow:hidden}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]   .type[_ngcontent-%COMP%]{text-transform:uppercase}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]   .type[_ngcontent-%COMP%], [_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]   .year[_ngcontent-%COMP%], [_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]   .state[_ngcontent-%COMP%]{letter-spacing:1px;font-size:.8em}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-size:24px;font-weight:100;color:var(--on-background-active)}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--on-background-active)}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:var(--on-background)}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{font-size:14px;line-height:1.2em}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{margin-top:auto}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-bottom:5px;margin-right:5px;height:27px;font-weight:500;padding:1px 15px 0}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{transform:scale(1.3);transform-origin:center}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{-webkit-user-select:none;-moz-user-select:none;user-select:none;border:1px solid transparent;padding:4px 9px 7px;border-radius:50%;display:none;position:absolute;right:1px;bottom:0}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{background-color:var(--control-hover);color:var(--on-background-hover)}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]:hover   .actions[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], [_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]:hover   app-fav-icon[_ngcontent-%COMP%]{display:inline}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .folder-health[_ngcontent-%COMP%]{display:flex;width:70%}@media (max-width: 400px){[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]{padding-left:0;padding-right:0}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]{font-size:.8em}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-size:16px}}"]}),t})();var Kt=n(67111);function te(t,e){if(1&t&&(g.TgZ(0,"div"),g.TgZ(1,"div"),g._uU(2),g.ALo(3,"stringToggle"),g.qZA(),g._UZ(4,"app-loading"),g.qZA()),2&t){const t=g.oxw();g.xp6(2),g.Oqu(g.Dn7(3,1,t.isUploading,"Uploading","Creating Artwork"))}}function ee(t,e){if(1&t){const t=g.EpF();g.TgZ(0,"div",2),g.NdJ("drop",function(e){return g.CHM(t),g.oxw().onDropFile(e)})("dragover",function(e){return g.CHM(t),g.oxw().onDragOverFile(e)}),g.TgZ(1,"form"),g.TgZ(2,"input",3),g.NdJ("change",function(e){return g.CHM(t),g.oxw().selectFile(e)}),g.qZA(),g.qZA(),g.qZA()}}let ne=(()=>{class t{constructor(t,e,n){this.jam=t,this.notify=e,this.folderService=n,this.isIdle=!0,this.isUploading=!1,this.unsubscribe=new f.xQ}ngOnDestroy(){this.unsubscribe.next(),this.unsubscribe.complete()}dialogInit(t,e){var n;this.reference=t,this.folder=null===(n=e.data)||void 0===n?void 0:n.folder}waitForCreationEnd(t){if(!this.folder)return;const e=this.folder.id;this.folderService.waitForQueueResult("Creating Artwork",t,[]).pipe((0,m.R)(this.unsubscribe)).subscribe(n=>{this.isIdle=!0,this.folderService.notifyFolderChange(e,C.dw.fsnRefresh),t.error||(this.notify.success("Upload done"),this.reference&&this.reference.close())})}onDropFile(t){var e;t.preventDefault(),this.uploadFile(null===(e=t.dataTransfer)||void 0===e?void 0:e.files)}onDragOverFile(t){t.stopPropagation(),t.preventDefault()}selectFile(t){this.uploadFile(t.target.files)}uploadFile(t){if(!t||0===t.length||!this.folder)return;const e=t[0];this.isIdle=!1,this.isUploading=!0,this.jam.artwork.createByUpload({folderID:this.folder.id,types:[]},e).pipe((0,m.R)(this.unsubscribe)).subscribe(t=>{if(t.type!==it.dt.UploadProgress&&t instanceof it.Zn){const e=t.body;e&&this.waitForCreationEnd(e)}},t=>{this.isUploading=!1,this.isIdle=!0,this.notify.error(t)},()=>{this.isUploading=!1})}}return t.\u0275fac=function(e){return new(e||t)(g.Y36(x.K4),g.Y36(C.c),g.Y36(C.Cr))},t.\u0275cmp=g.Xpm({type:t,selectors:[["app-dialog-upload-image"]],decls:2,vars:2,consts:[[4,"ngIf"],["class","drop-zone",3,"drop","dragover",4,"ngIf"],[1,"drop-zone",3,"drop","dragover"],["type","file","placeholder","Upload image","accept",".png,.jpeg,.jpg",3,"change"]],template:function(t,e){1&t&&(g.YNc(0,te,5,5,"div",0),g.YNc(1,ee,3,0,"div",1)),2&t&&(g.Q6J("ngIf",!e.isIdle),g.xp6(1),g.Q6J("ngIf",e.isIdle))},directives:[i.O5,E.N,r._Y,r.JL,r.F],pipes:[v.C],styles:["[_nghost-%COMP%]   .drop-zone[_ngcontent-%COMP%]{margin:10px 20px;border-width:2px;border-style:dotted;border-color:var(--secondary);height:80%}[_nghost-%COMP%]   input[type=text][_ngcontent-%COMP%]{width:100%}"]}),t})();var oe=n(99743);function ie(t,e){1&t&&g._UZ(0,"app-loading")}function re(t,e){if(1&t&&g._UZ(0,"app-info-note",21),2&t){const t=g.oxw(2);g.Q6J("info",t.folder.info)}}function se(t,e){if(1&t&&(g.ynx(0),g._uU(1),g.BQk()),2&t){const t=g.oxw(2);g.xp6(1),g.hij(" / ",null==t.folder.tag?null:t.folder.tag.albumType,"")}}function ae(t,e){if(1&t&&(g.TgZ(0,"div"),g.TgZ(1,"div",13),g._uU(2,"Artist"),g.qZA(),g.TgZ(3,"div"),g._uU(4),g.qZA(),g.qZA()),2&t){const t=g.oxw(2);g.xp6(4),g.Oqu(null==t.folder.tag?null:t.folder.tag.artist)}}function ce(t,e){if(1&t&&(g.TgZ(0,"div"),g.TgZ(1,"div",13),g._uU(2,"Album"),g.qZA(),g.TgZ(3,"div"),g._uU(4),g.qZA(),g.qZA()),2&t){const t=g.oxw(2);g.xp6(4),g.Oqu(null==t.folder.tag?null:t.folder.tag.album)}}function le(t,e){if(1&t&&(g.TgZ(0,"div"),g.TgZ(1,"div",13),g._uU(2,"Year"),g.qZA(),g.TgZ(3,"div"),g._uU(4),g.qZA(),g.qZA()),2&t){const t=g.oxw(2);g.xp6(4),g.hij(" ",null==t.folder.tag?null:t.folder.tag.year,"")}}function de(t,e){if(1&t&&(g.TgZ(0,"div"),g.TgZ(1,"div",13),g._uU(2,"Genres"),g.qZA(),g.TgZ(3,"div"),g._uU(4),g.qZA(),g.qZA()),2&t){const t=g.oxw(2);g.xp6(4),g.hij(" ",null==t.folder.tag?null:t.folder.tag.genres,"")}}function ge(t,e){if(1&t&&(g.TgZ(0,"div"),g.TgZ(1,"div",13),g._uU(2,"MB Release Id"),g.qZA(),g.TgZ(3,"div"),g.TgZ(4,"a",22),g._uU(5),g.qZA(),g.qZA(),g.qZA()),2&t){const t=g.oxw(2);g.xp6(4),g.MGl("href","https://musicbrainz.org/release/",null==t.folder.tag?null:t.folder.tag.mbReleaseID,"",g.LSH),g.xp6(1),g.Oqu(null==t.folder.tag?null:t.folder.tag.mbReleaseID)}}function he(t,e){if(1&t&&(g.TgZ(0,"div"),g.TgZ(1,"div",13),g._uU(2,"MB Artist Id"),g.qZA(),g.TgZ(3,"div"),g.TgZ(4,"a",22),g._uU(5),g.qZA(),g.qZA(),g.qZA()),2&t){const t=g.oxw(2);g.xp6(4),g.MGl("href","https://musicbrainz.org/artist/",null==t.folder.tag?null:t.folder.tag.mbArtistID,"",g.LSH),g.xp6(1),g.Oqu(null==t.folder.tag?null:t.folder.tag.mbArtistID)}}const pe=function(t){return["/admin/folder",t]};function ue(t,e){if(1&t&&(g.TgZ(0,"div"),g.TgZ(1,"div",13),g._uU(2,"Parent Folder Id"),g.qZA(),g.TgZ(3,"div"),g.TgZ(4,"a",23),g._uU(5),g.qZA(),g.qZA(),g.qZA()),2&t){const t=g.oxw(2);g.xp6(4),g.Q6J("routerLink",g.VKq(2,pe,t.folder.parentID)),g.xp6(1),g.Oqu(t.folder.parentID)}}function fe(t,e){if(1&t){const t=g.EpF();g.TgZ(0,"button",24),g.NdJ("click",function(){return g.CHM(t),g.oxw(2).searchImages()}),g._UZ(1,"i",25),g._uU(2," Search Artwork "),g.qZA()}}function me(t,e){if(1&t){const t=g.EpF();g.TgZ(0,"button",26),g.NdJ("click",function(){return g.CHM(t),g.oxw(2).searchImages()}),g._UZ(1,"i",25),g._uU(2," Search Art"),g.qZA()}}function Me(t,e){if(1&t&&(g.TgZ(0,"div",27),g._UZ(1,"app-admin-artwork-list",28),g.qZA()),2&t){const t=g.oxw(2);g.xp6(1),g.Q6J("folderID",t.folder.id)("artworks",t.folder.artworks)}}function Ce(t,e){if(1&t){const t=g.EpF();g.TgZ(0,"div",2),g.TgZ(1,"div",3),g.TgZ(2,"button",4),g.NdJ("click",function(){return g.CHM(t),g.oxw().refresh()}),g._UZ(3,"i",5),g.qZA(),g.TgZ(4,"button",6),g.NdJ("click",function(){return g.CHM(t),g.oxw().moveFolder()}),g._UZ(5,"i",7),g.qZA(),g.TgZ(6,"button",8),g.NdJ("click",function(){return g.CHM(t),g.oxw().removeFolder()}),g._UZ(7,"i",9),g.qZA(),g.qZA(),g.TgZ(8,"div",10),g.YNc(9,re,1,1,"app-info-note",11),g.TgZ(10,"div",12),g.TgZ(11,"div"),g.TgZ(12,"div"),g.TgZ(13,"div",13),g._uU(14,"Name"),g.qZA(),g.TgZ(15,"div"),g.TgZ(16,"app-inline-edit",14),g.NdJ("ngModelChange",function(e){return g.CHM(t),g.oxw().name=e})("endEditRequest",function(){return g.CHM(t),g.oxw().editFolderName()}),g.qZA(),g.qZA(),g.qZA(),g.TgZ(17,"div"),g.TgZ(18,"div",13),g._uU(19,"Type"),g.qZA(),g.TgZ(20,"div"),g._uU(21),g.YNc(22,se,2,1,"ng-container",0),g.qZA(),g.qZA(),g.TgZ(23,"div"),g.TgZ(24,"div",13),g._uU(25,"Track Count"),g.qZA(),g.TgZ(26,"div"),g._uU(27),g.qZA(),g.qZA(),g.TgZ(28,"div"),g.TgZ(29,"div",13),g._uU(30,"Folder Count"),g.qZA(),g.TgZ(31,"div"),g._uU(32),g.qZA(),g.qZA(),g.YNc(33,ae,5,1,"div",0),g.YNc(34,ce,5,1,"div",0),g.qZA(),g.TgZ(35,"div"),g.YNc(36,le,5,1,"div",0),g.YNc(37,de,5,1,"div",0),g.YNc(38,ge,6,2,"div",0),g.YNc(39,he,6,2,"div",0),g.YNc(40,ue,6,4,"div",0),g.qZA(),g.qZA(),g.TgZ(41,"div",15),g.TgZ(42,"div",3),g.TgZ(43,"button",16),g.NdJ("click",function(){return g.CHM(t),g.oxw().uploadImage()}),g._UZ(44,"i",17),g._uU(45," Upload Artwork"),g.qZA(),g.YNc(46,fe,3,0,"button",18),g.YNc(47,me,3,0,"button",19),g.qZA(),g.YNc(48,Me,2,2,"div",20),g.qZA(),g.qZA(),g.qZA()}if(2&t){const t=g.oxw();g.xp6(9),g.Q6J("ngIf",null==t.folder.info?null:t.folder.info.description),g.xp6(7),g.Q6J("ngModel",t.name),g.xp6(5),g.hij("",t.folder.type," "),g.xp6(1),g.Q6J("ngIf",t.isAlbum),g.xp6(5),g.Oqu(t.folder.trackCount),g.xp6(5),g.Oqu(t.folder.folderCount),g.xp6(1),g.Q6J("ngIf",null==t.folder.tag?null:t.folder.tag.artist),g.xp6(1),g.Q6J("ngIf",null==t.folder.tag?null:t.folder.tag.album),g.xp6(2),g.Q6J("ngIf",null==t.folder.tag?null:t.folder.tag.year),g.xp6(1),g.Q6J("ngIf",null==t.folder.tag||null==t.folder.tag.genres?null:t.folder.tag.genres.length),g.xp6(1),g.Q6J("ngIf",null==t.folder.tag?null:t.folder.tag.mbReleaseID),g.xp6(1),g.Q6J("ngIf",null==t.folder.tag?null:t.folder.tag.mbArtistID),g.xp6(1),g.Q6J("ngIf",t.folder.parentID),g.xp6(6),g.Q6J("ngIf",t.isAlbum&&t.folder.tag&&(t.folder.tag.mbReleaseID||t.folder.tag.mbReleaseGroupID)),g.xp6(1),g.Q6J("ngIf",t.isArtist&&t.folder.tag&&t.folder.tag.mbArtistID),g.xp6(1),g.Q6J("ngIf",t.folder.artworks&&t.folder.artworks.length>0)}}let xe=(()=>{class t extends Q{constructor(t,e,n,o,i,r,s,a){super(t),this.app=e,this.jam=n,this.notify=o,this.dialogsService=i,this.dialogOverlay=r,this.folderService=s,this.router=a,this.name="",this.isAlbum=!1,this.isArtist=!1}ngOnInit(){super.ngOnInit(),this.folderService.foldersChange.pipe((0,m.R)(this.unsubscribe)).subscribe(t=>{t.id===this.id&&this.refresh()})}ngOnDestroy(){super.ngOnDestroy()}editFolderName(){if(!this.folder)return;const t=(this.name||"").trim();if(0===t.length||t===this.folder.name)return void(this.name=this.folder.name);const e=this.folder.id;this.jam.folder.rename({id:e,name:t}).then(t=>{this.folderService.waitForQueueResult("Renaming Folder",t,[e])}).catch(t=>{this.notify.error(t)})}refresh(){this.id&&this.jam.folder.id({id:this.id,folderIncTag:!0,folderIncParents:!0,folderIncArtworks:!0,folderIncChildFolderCount:!0,folderIncTrackCount:!0}).then(t=>{this.display(t)}).catch(t=>{404===t.code?this.router.navigate(["/admin/folder/"]).catch(t=>{console.error(t)}):this.notify.error(t)})}uploadImage(){this.dialogOverlay.open({title:"Upload Folder Images",childComponent:ne,data:{folder:this.folder},panelClass:"overlay-panel-large-buttons"})}searchImages(){this.dialogOverlay.open({title:"Search Artwork Images",childComponent:qt,data:{folder:this.folder},panelClass:"overlay-panel-large-buttons"})}removeFolder(){const t=this.folder;!t||this.dialogsService.confirm("Remove Folder?",`Sure to remove Folder "${t.name}"?`,()=>{this.jam.folder.remove({id:t.id}).then(e=>{t.parentID&&this.router.navigate([`/admin/folder/${t.parentID}/overview`]).catch(t=>{console.error(t)}),this.folderService.waitForQueueResult("Removing Folder",e,[t.id],t.parentID?[t.parentID]:[])}).catch(t=>{this.notify.error(t)})})}moveFolder(){const t=this.folder;if(!t)return;const e={selectID:t.id,disableIDs:[t.id]};this.dialogOverlay.open({title:"Move Folder to",childComponent:N,data:e,panelClass:"overlay-panel-large-buttons",onOkBtn:()=>(0,p.mG)(this,void 0,void 0,function*(){const n=e.folder;if(n)try{this.jam.folder.move({ids:[t.id],newParentID:n.id}).then(e=>{this.folderService.waitForQueueResult("Moving Folder",e,[t.id],(t.parentID?[t.parentID]:[]).concat([n.id]))}).catch(t=>{this.notify.error(t)})}catch(o){return this.notify.error(o),Promise.reject(o)}}),onCancelBtn:()=>(0,p.mG)(this,void 0,void 0,function*(){return Promise.resolve()})})}display(t){this.name="",this.isAlbum=!1,this.isArtist=!1,this.folder=t,t&&(this.name=t.name,this.isAlbum=Kt.Dz.includes(t.type),this.isArtist=t.type===x.Sr.artist)}}return t.\u0275fac=function(e){return new(e||t)(g.Y36(u.gz),g.Y36(C.zi),g.Y36(x.K4),g.Y36(C.c),g.Y36(Y.Hr),g.Y36(D.SL),g.Y36(C.Cr),g.Y36(u.F0))},t.\u0275cmp=g.Xpm({type:t,selectors:[["app-admin-folder"]],features:[g.qOj],decls:2,vars:2,consts:[[4,"ngIf"],["class","folder",4,"ngIf"],[1,"folder"],[1,"actions"],["title","Refresh",1,"button-on-control",3,"click"],[1,"icon-reload"],["title","Move Folder\u2026",1,"button-on-control",3,"click"],[1,"icon-right-bold"],["title","Remove Folder\u2026",1,"button-on-control",3,"click"],[1,"icon-trash"],[1,"content"],[3,"info",4,"ngIf"],[1,"properties"],[1,"label"],["type","text",3,"ngModel","ngModelChange","endEditRequest"],[1,"artworks"],[1,"button-on-control",3,"click"],[1,"icon-upload-cloud"],["class","button-on-control","title","Album Images",3,"click",4,"ngIf"],["class","button-on-control","title","Artist Images",3,"click",4,"ngIf"],["class","artworks-content",4,"ngIf"],[3,"info"],["target","_blank","rel","noopener",3,"href"],[3,"routerLink"],["title","Album Images",1,"button-on-control",3,"click"],[1,"icon-picture"],["title","Artist Images",1,"button-on-control",3,"click"],[1,"artworks-content"],[3,"folderID","artworks"]],template:function(t,e){1&t&&(g.YNc(0,ie,1,0,"app-loading",0),g.YNc(1,Ce,49,16,"div",1)),2&t&&(g.Q6J("ngIf",!e.folder),g.xp6(1),g.Q6J("ngIf",e.folder))},directives:[i.O5,E.N,ft,r.JJ,r.On,oe.a,u.yS,vt],styles:["[_nghost-%COMP%]{height:100%;width:100%;overflow:hidden;display:block}[_nghost-%COMP%]   .actions[_ngcontent-%COMP%]{padding:10px 15px 0;border-bottom-color:var(--background-border);border-bottom-width:1px;border-bottom-style:solid}[_nghost-%COMP%]   .actions[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{margin-right:5px;margin-bottom:10px}[_nghost-%COMP%]   .actions[_ngcontent-%COMP%] > label[_ngcontent-%COMP%]{text-transform:uppercase;letter-spacing:1px;font-size:11px;margin-left:5px;margin-right:5px}[_nghost-%COMP%]   .folder[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;width:100%}[_nghost-%COMP%]   .folder[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{overflow-y:auto;display:flex;flex-direction:column}[_nghost-%COMP%]   .folder[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .properties[_ngcontent-%COMP%]{width:100%;display:flex;flex-wrap:wrap;flex-direction:row;padding:15px}[_nghost-%COMP%]   .folder[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .properties[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{flex:0 0 50%}@media (max-width: 522px){[_nghost-%COMP%]   .folder[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .properties[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{flex:0 0 100%}}[_nghost-%COMP%]   .folder[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .properties[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{padding-top:5px;padding-bottom:5px}[_nghost-%COMP%]   .folder[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .properties[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{color:var(--on-background-active)}[_nghost-%COMP%]   .folder[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .properties[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--on-background-active)}[_nghost-%COMP%]   .folder[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .properties[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:var(--on-background)}[_nghost-%COMP%]   .folder[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .properties[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{color:var(--on-background);font-size:.7em;text-transform:uppercase;padding-bottom:2px}[_nghost-%COMP%]   .folder[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .artworks[_ngcontent-%COMP%]{border-top:1px solid var(--background-border)}[_nghost-%COMP%]   .folder[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .artworks[_ngcontent-%COMP%]   .artworks-content[_ngcontent-%COMP%]{padding:0 15px 15px}"]}),t})();function ve(t,e){1&t&&(g.TgZ(0,"div",2),g.TgZ(1,"div",3),g._UZ(2,"i",4),g.qZA(),g.qZA())}function _e(t,e){1&t&&(g.TgZ(0,"div",3),g._uU(1,"No Hints"),g.qZA())}function Oe(t,e){if(1&t&&(g.TgZ(0,"div",3),g._UZ(1,"i",9),g._uU(2),g.TgZ(3,"div",10),g._uU(4),g.qZA(),g.qZA()),2&t){const t=e.$implicit;g.xp6(2),g.hij(" ",t.hint.name," "),g.xp6(2),g.Oqu(t.description)}}function Pe(t,e){1&t&&g._UZ(0,"i",4)}function be(t,e){if(1&t&&(g.ynx(0),g._uU(1),g.BQk()),2&t){const t=g.oxw().$implicit;g.xp6(1),g.Oqu(t.name)}}function Ze(t,e){if(1&t){const t=g.EpF();g.TgZ(0,"button",11),g.NdJ("click",function(){return g.CHM(t).$implicit.click()}),g.YNc(1,Pe,1,0,"i",12),g.YNc(2,be,2,1,"ng-container",0),g.qZA()}if(2&t){const t=e.$implicit;g.xp6(1),g.Q6J("ngIf",t.running),g.xp6(1),g.Q6J("ngIf",!t.running)}}function we(t,e){if(1&t&&(g.TgZ(0,"div",2),g.YNc(1,_e,2,0,"div",5),g.YNc(2,Oe,5,2,"div",6),g.TgZ(3,"div",7),g.YNc(4,Ze,3,2,"button",8),g.qZA(),g.qZA()),2&t){const t=g.oxw(2);g.xp6(1),g.Q6J("ngIf",0===t.hints.length),g.xp6(1),g.Q6J("ngForOf",t.hints)("ngForTrackBy",t.trackByFn),g.xp6(2),g.Q6J("ngForOf",t.solutions)}}function ye(t,e){if(1&t&&(g.ynx(0),g.YNc(1,ve,3,0,"div",1),g.YNc(2,we,5,4,"div",1),g.BQk()),2&t){const t=g.oxw();g.xp6(1),g.Q6J("ngIf",!(t.trackHealth.health&&t.hints)),g.xp6(1),g.Q6J("ngIf",t.trackHealth.health&&t.hints)}}let Ae=(()=>{class t{constructor(t,e,n,o,i){this.app=t,this.jam=e,this.notify=n,this.folderService=o,this.router=i,this.solutions=[],this.resolvedEvent=new g.vpe,this.unsubscribe=new f.xQ}trackByFn(t,e){return e.hint.id}ngOnChanges(t){this.display(this.trackHealth)}ngOnDestroy(){this.unsubscribe.next(),this.unsubscribe.complete()}ngOnInit(){this.folderService.tracksChange.pipe((0,m.R)(this.unsubscribe)).subscribe(t=>{const e=this.trackHealth;e&&e.track.id===t.id&&(e.health=[],this.jam.track.health({ids:[e.track.id],healthMedia:!0}).then(t=>{const n=t.find(t=>t.track.id===e.track.id);n&&n.health?(e.track=n.track,e.health=n.health):e.health=[],0===e.health.length&&this.resolvedEvent.emit(),this.display(e)}).catch(t=>{this.notify.error(t)}))})}fixAll(){for(const t of this.solutions)t.fixable&&!t.running&&t.click&&t.click()}display(t){this.hints=[],this.solutions=[],(null==t?void 0:t.health)&&(this.hints=t.health.map(e=>({hint:e,description:this.describeHint(e,t.track)})))}describeTagHint(t,e){let n="";return t.id===x.U.tagValuesExists?n=(t.details||[]).map(t=>t.reason.toUpperCase()).join(", "):t.id===x.U.id3v2Garbage?n=(t.details||[]).map(t=>t.reason).join(", "):t.id===x.U.id3v2Valid&&(n=(t.details||[]).map(t=>t.expected&&t.actual?`${t.reason}  (${t.actual} instead of ${t.expected})`:t.reason).join(", ")),this.solutions.find(t=>"Edit Tag"===t.name)||this.solutions.push({name:"Edit Tag",click:()=>{this.router.navigate([`/admin/folder/${e.parentID}/tags`]).catch(t=>{console.error(t)})}}),n}describeMp3GarbageHint(t,e){let n="";if(t.details&&t.details.length>0&&(n=`${t.details[0].reason} (${t.details[0].actual} bytes)`),!this.solutions.find(t=>"Fix MP3"===t.name)){const n={name:"Fix MP3",fixable:!0,click:()=>{n.running||(n.running=!0,this.jam.track.fix({id:e.id,fixID:t.id}).then(t=>{this.folderService.waitForQueueResult("Fixing Track MP3",t,[],[],[e.id])}).catch(t=>{this.notify.error(t)}))}};this.solutions.push(n)}return n}describeMp3ErrorHint(t,e){const n=`Stream Errors: ${(t.details||[]).length}`;if(!this.solutions.find(t=>"Fix Stream"===t.name)){const n={name:"Fix Stream",fixable:!0,click:()=>{n.running||(n.running=!0,this.jam.track.fix({id:e.id,fixID:t.id}).then(t=>{this.folderService.waitForQueueResult("Fixing Track Stream",t,[],[],[e.id])}).catch(t=>{this.notify.error(t)}))}};this.solutions.push(n)}return n}describeID3v1Hint(t,e){if(!this.solutions.find(t=>"Remove ID3v1"===t.name)){const n={name:"Remove ID3v1",fixable:!0,click:()=>{n.running||(n.running=!0,this.jam.track.fix({id:e.id,fixID:t.id}).then(t=>{this.folderService.waitForQueueResult("Remove ID3v1",t,[],[],[e.id])}).catch(t=>{this.notify.error(t)}))}};this.solutions.push(n)}return""}describeMP3HeaderHint(t,e){let n="";if(t.id===x.U.mp3HeaderValid&&(n=(t.details||[]).map(t=>t.expected&&t.actual?`${t.reason}  (${t.actual} instead of ${t.expected})`:t.reason).join(", ")),!this.solutions.find(t=>"Fix Header"===t.name)){const n={name:"Fix Header",fixable:!0,click:()=>{n.running||(n.running=!0,this.jam.track.fix({id:e.id,fixID:t.id}).then(t=>{this.folderService.waitForQueueResult("Fixing Track Header",t,[],[],[e.id])}).catch(t=>{this.notify.error(t)}))}};this.solutions.push(n)}return n}describeHint(t,e){switch(t.id){case x.U.tagValuesExists:case x.U.id3v2Garbage:case x.U.id3v2Exists:case x.U.id3v2Valid:return this.describeTagHint(t,e);case x.U.mp3Garbage:return this.describeMp3GarbageHint(t,e);case x.U.mp3MediaValid:return this.describeMp3ErrorHint(t,e);case x.U.id3v2NoId3v1:return this.describeID3v1Hint(t,e);case x.U.mp3HeaderExists:case x.U.mp3HeaderValid:return this.describeMP3HeaderHint(t,e)}return""}}return t.\u0275fac=function(e){return new(e||t)(g.Y36(C.zi),g.Y36(x.K4),g.Y36(C.c),g.Y36(C.Cr),g.Y36(u.F0))},t.\u0275cmp=g.Xpm({type:t,selectors:[["app-track-health"]],inputs:{trackHealth:"trackHealth"},outputs:{resolvedEvent:"resolvedEvent"},features:[g.TTD],decls:1,vars:1,consts:[[4,"ngIf"],["class","hints",4,"ngIf"],[1,"hints"],[1,"hint"],[1,"icon-spin","icon-spinner"],["class","hint",4,"ngIf"],["class","hint",4,"ngFor","ngForOf","ngForTrackBy"],[1,"solutions"],["class","button-on-background",3,"click",4,"ngFor","ngForOf"],[1,"icon-warning"],[1,"details"],[1,"button-on-background",3,"click"],["class","icon-spin icon-spinner",4,"ngIf"]],template:function(t,e){1&t&&g.YNc(0,ye,3,2,"ng-container",0),2&t&&g.Q6J("ngIf",e.trackHealth)},directives:[i.O5,i.sg],styles:["[_nghost-%COMP%]{height:100%;width:100%;overflow-y:auto;overflow-x:auto;display:block}[_nghost-%COMP%]   .icon-warning[_ngcontent-%COMP%]{color:var(--accent)}[_nghost-%COMP%]   .details[_ngcontent-%COMP%]{padding-left:28px;font-size:.8em;display:block;padding-top:5px}[_nghost-%COMP%]   .hint[_ngcontent-%COMP%]{padding-bottom:15px}[_nghost-%COMP%]   .solutions[_ngcontent-%COMP%]{padding-bottom:15px}[_nghost-%COMP%]   .solutions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-right:5px}[_nghost-%COMP%]   .detail[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{text-transform:uppercase;letter-spacing:1.25px;font-size:11px;min-width:80px;margin-right:10px;display:inline-block}"]}),t})();function ke(t,e){1&t&&g._UZ(0,"app-loading")}function Te(t,e){if(1&t){const t=g.EpF();g.TgZ(0,"div",9),g.TgZ(1,"div",10),g._uU(2),g.qZA(),g.TgZ(3,"div",11),g.TgZ(4,"app-track-health",12),g.NdJ("resolvedEvent",function(){const e=g.CHM(t).$implicit;return g.oxw().trackHealthResolved(e)}),g.qZA(),g.qZA(),g.qZA()}if(2&t){const t=e.$implicit;g.xp6(2),g.hij(" ",t.track.name," "),g.xp6(2),g.Q6J("trackHealth",t)}}let Ie=(()=>{class t extends Q{constructor(t,e,n,o,i){super(t),this.app=e,this.jam=n,this.notify=o,this.folderService=i,this.modes=[],this.mediaCheck=!1}onFilterChange(){this.reDisplay()}ngOnInit(){super.ngOnInit(),this.folderService.foldersChange.pipe((0,m.R)(this.unsubscribe)).subscribe(t=>{t.id===this.id&&this.refresh()})}ngOnDestroy(){super.ngOnDestroy()}checkChange(){this.refresh()}trackHealthResolved(t){this.all&&(this.all=this.all.filter(e=>e!==t),this.reDisplay())}refresh(){this.hints=void 0,this.id&&this.jam.track.health({folderIDs:[this.id],healthMedia:this.mediaCheck}).then(t=>{this.display(t)}).catch(t=>{this.notify.error(t)})}reDisplay(){this.hints=this.filter&&this.all?this.all.filter(t=>t.health&&t.health.find(t=>t.name===this.filter)):this.all}display(t){this.all=t,this.modes=[];for(const e of t)if(e.health)for(const t of e.health)this.modes.includes(t.name)||this.modes.push(t.name);this.reDisplay()}}return t.\u0275fac=function(e){return new(e||t)(g.Y36(u.gz),g.Y36(C.zi),g.Y36(x.K4),g.Y36(C.c),g.Y36(C.Cr))},t.\u0275cmp=g.Xpm({type:t,selectors:[["app-admin-tracks-health"]],features:[g.qOj],decls:11,vars:5,consts:[[1,"health"],[1,"actions"],["title","Refresh List",1,"button-on-control",3,"click"],[1,"icon-reload"],["type","checkbox",3,"ngModel","checked","ngModelChange","change"],[1,"content"],[4,"ngIf"],["name","Track Health Issues",3,"list"],["class","track",4,"ngFor","ngForOf"],[1,"track"],[1,"meta"],[1,"track-health"],[3,"trackHealth","resolvedEvent"]],template:function(t,e){1&t&&(g.TgZ(0,"div",0),g.TgZ(1,"div",1),g.TgZ(2,"button",2),g.NdJ("click",function(){return e.refresh()}),g._UZ(3,"i",3),g.qZA(),g.TgZ(4,"label"),g.TgZ(5,"input",4),g.NdJ("ngModelChange",function(t){return e.mediaCheck=t})("change",function(){return e.checkChange()}),g.qZA(),g._uU(6," Check Media "),g.qZA(),g.qZA(),g.TgZ(7,"div",5),g.YNc(8,ke,1,0,"app-loading",6),g._UZ(9,"app-background-text-list",7),g.YNc(10,Te,5,2,"div",8),g.qZA(),g.qZA()),2&t&&(g.xp6(5),g.Q6J("ngModel",e.mediaCheck)("checked",e.mediaCheck),g.xp6(3),g.Q6J("ngIf",!e.hints),g.xp6(1),g.Q6J("list",e.hints),g.xp6(1),g.Q6J("ngForOf",e.hints))},directives:[r.Wl,r.JJ,r.On,i.O5,B.$,i.sg,E.N,Ae],styles:["[_nghost-%COMP%]{height:100%;width:100%}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]{height:100%;width:100%;display:flex;flex-direction:column}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{padding:10px 15px 0;border-bottom-color:var(--background-border);border-bottom-width:1px;border-bottom-style:solid}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{margin-right:5px;margin-bottom:10px}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%] > label[_ngcontent-%COMP%]{text-transform:uppercase;letter-spacing:1px;font-size:11px;margin-left:5px;margin-right:5px}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{padding:15px;overflow-y:auto;overflow-x:auto}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .track[_ngcontent-%COMP%]{flex-flow:row nowrap}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .track[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]{width:30%;overflow:hidden;padding-right:15px;text-overflow:ellipsis}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .track[_ngcontent-%COMP%]   .track-health[_ngcontent-%COMP%]{width:70%}"]}),t})();var qe=n(6906);function Se(t,e){if(1&t){const t=g.EpF();g.TgZ(0,"tr",13),g.NdJ("click",function(){const e=g.CHM(t).$implicit;return e.selected=!e.selected}),g.TgZ(1,"td",4),g._uU(2),g.qZA(),g.TgZ(3,"td",5),g._uU(4),g.qZA(),g.TgZ(5,"td",6),g._uU(6),g.qZA(),g.TgZ(7,"td",7),g._uU(8),g.qZA(),g.TgZ(9,"td",8),g._uU(10),g.qZA(),g.TgZ(11,"td",9),g._uU(12),g.qZA(),g.TgZ(13,"td",10),g._uU(14),g.qZA(),g.TgZ(15,"td",11),g._uU(16),g.ALo(17,"duration"),g.qZA(),g.qZA()}if(2&t){const t=e.$implicit;g.ekj("selected",t.selected),g.xp6(2),g.Oqu(null==t.track.tag?null:t.track.tag.trackNr),g.xp6(2),g.Oqu(null==t.track.tag?null:t.track.tag.title),g.xp6(2),g.Oqu(null==t.track.tag?null:t.track.tag.artist),g.xp6(2),g.Oqu(null==t.track.tag?null:t.track.tag.album),g.xp6(2),g.Oqu(null==t.track.media?null:t.track.media.format),g.xp6(2),g.Oqu(null==t.track.media?null:t.track.media.bitRate),g.xp6(2),g.Oqu(null==t.track.media?null:t.track.media.sampleRate),g.xp6(2),g.Oqu(g.lcZ(17,10,t.track.duration))}}function Ue(t,e){if(1&t&&(g.TgZ(0,"table",2),g.TgZ(1,"tr",3),g.TgZ(2,"td",4),g._uU(3,"Track Nr."),g.qZA(),g.TgZ(4,"td",5),g._uU(5,"Title"),g.qZA(),g.TgZ(6,"td",6),g._uU(7,"Artist"),g.qZA(),g.TgZ(8,"td",7),g._uU(9,"Album"),g.qZA(),g.TgZ(10,"td",8),g._uU(11,"Format"),g.qZA(),g.TgZ(12,"td",9),g._uU(13,"BitRate"),g.qZA(),g.TgZ(14,"td",10),g._uU(15,"SampleRate"),g.qZA(),g.TgZ(16,"td",11),g._uU(17,"Duration"),g.qZA(),g.qZA(),g.YNc(18,Se,18,12,"tr",12),g.qZA()),2&t){const t=g.oxw();g.xp6(18),g.Q6J("ngForOf",t.trackItems)}}let Re=(()=>{class t{constructor(t){this.router=t,this.tracks=[]}getSortValue(t,e){var n,o,i;switch(t){case"number":return null===(n=e.track.tag)||void 0===n?void 0:n.trackNr;case"name":return e.track.name;case"artist":return null===(o=e.track.tag)||void 0===o?void 0:o.artist;case"album":return null===(i=e.track.tag)||void 0===i?void 0:i.album;case"duration":return e.track.duration;default:return}}ngOnChanges(t){this.trackItems=(this.tracks||[]).map(t=>({track:t}))}toTrackFolder(t){this.router.navigate([`/admin/folder/${t.parentID}/overview`]).catch(t=>{console.error(t)})}}return t.\u0275fac=function(e){return new(e||t)(g.Y36(u.F0))},t.\u0275cmp=g.Xpm({type:t,selectors:[["app-admin-track-list"]],inputs:{tracks:"tracks"},features:[g.TTD],decls:2,vars:2,consts:[["name","Tracks",3,"list"],["class","tracks",4,"ngIf"],[1,"tracks"],[1,"track","heading"],[1,"number"],[1,"title"],[1,"artist"],[1,"album"],[1,"format"],[1,"bitrate"],[1,"samplerate"],[1,"duration"],["class","track",3,"selected","click",4,"ngFor","ngForOf"],[1,"track",3,"click"]],template:function(t,e){1&t&&(g._UZ(0,"app-background-text-list",0),g.YNc(1,Ue,19,1,"table",1)),2&t&&(g.Q6J("list",e.tracks),g.xp6(1),g.Q6J("ngIf",e.tracks&&e.tracks.length>0))},directives:[B.$,i.O5,i.sg],pipes:[qe.u],styles:["[_nghost-%COMP%]{width:100%;overflow:auto;display:block}[_nghost-%COMP%]   .tracks[_ngcontent-%COMP%]{padding:15px;font-size:.8em;width:100%}[_nghost-%COMP%]   .heading[_ngcontent-%COMP%]{font-size:.9em}[_nghost-%COMP%]   .track[_ngcontent-%COMP%]{border-bottom:1px solid var(--control-border)}[_nghost-%COMP%]   .track[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:5px 10px}[_nghost-%COMP%]   .track[_ngcontent-%COMP%]:hover{background-color:var(--background-hover)}[_nghost-%COMP%]   .track.selected[_ngcontent-%COMP%]{background-color:var(--background-active)}"]}),t})();function Je(t,e){1&t&&g._UZ(0,"app-loading")}function Qe(t,e){if(1&t){const t=g.EpF();g.TgZ(0,"div",3),g.TgZ(1,"div",4),g.TgZ(2,"button",5),g.NdJ("click",function(){return g.CHM(t),g.oxw().refresh()}),g._UZ(3,"i",6),g.qZA(),g.TgZ(4,"button",7),g.NdJ("click",function(){return g.CHM(t),g.oxw().moveTracks()}),g._UZ(5,"i",8),g.qZA(),g.TgZ(6,"button",9),g.NdJ("click",function(){return g.CHM(t),g.oxw().deleteTracks()}),g._UZ(7,"i",10),g.qZA(),g.qZA(),g._UZ(8,"app-admin-track-list",11),g.qZA()}if(2&t){const t=g.oxw();g.xp6(8),g.Q6J("tracks",t.folder.tracks)}}let Ne=(()=>{class t extends Q{constructor(t,e,n,o,i,r){super(t),this.jam=e,this.notify=n,this.folderService=o,this.dialogsService=i,this.dialogOverlay=r}ngOnInit(){super.ngOnInit(),this.folderService.foldersChange.pipe((0,m.R)(this.unsubscribe)).subscribe(t=>{t.id===this.id&&this.refresh()})}ngOnDestroy(){super.ngOnDestroy()}deleteTracks(){const t=this.getTrackIDs();0!==t.length&&this.dialogsService.confirm("Remove Tracks?",`Sure to remove ${t.length} Track${t.length>1?"s":""}?`,()=>{for(const e of t)this.jam.track.remove({id:e}).then(t=>{this.folderService.waitForQueueResult("Removing Track",t,[],[],[e])}).catch(t=>{this.notify.error(t)})})}getTrackIDs(){var t,e;if(!(null===(t=this.tracks)||void 0===t?void 0:t.trackItems)||!(null===(e=this.folder)||void 0===e?void 0:e.tracks))return[];const n=this.tracks.trackItems.filter(t=>t.selected).map(t=>t.track.id);return n.length>0?n:this.folder.tracks.map(t=>t.id)}moveTracks(){const t=this.getTrackIDs();if(0===t.length)return;const e={selectID:this.id};this.dialogOverlay.open({title:"Move Tracks to",childComponent:N,data:e,panelClass:"overlay-panel-large-buttons",onOkBtn:()=>(0,p.mG)(this,void 0,void 0,function*(){const n=e.folder;if(n)return this.jam.track.move({ids:t,folderID:n.id}).then(e=>{var o;this.folderService.waitForQueueResult("Moving Tracks",e,[],[n.id].concat((null===(o=this.folder)||void 0===o?void 0:o.parentID)?[this.folder.parentID]:[]),t)}).catch(t=>{this.notify.error(t)}),Promise.resolve()}),onCancelBtn:()=>(0,p.mG)(this,void 0,void 0,function*(){return Promise.resolve()})})}refresh(){this.folder=void 0,this.id&&this.jam.folder.id({id:this.id,folderIncTracks:!0,trackIncTag:!0,trackIncMedia:!0}).then(t=>{this.folder=t}).catch(t=>{this.notify.error(t)})}}return t.\u0275fac=function(e){return new(e||t)(g.Y36(u.gz),g.Y36(x.K4),g.Y36(C.c),g.Y36(C.Cr),g.Y36(Y.Hr),g.Y36(D.SL))},t.\u0275cmp=g.Xpm({type:t,selectors:[["app-admin-folder-tracks"]],viewQuery:function(t,e){if(1&t&&g.Gf(Re,5),2&t){let t;g.iGM(t=g.CRH())&&(e.tracks=t.first)}},features:[g.qOj],decls:3,vars:3,consts:[[4,"ngIf"],["name","Tracks",3,"list"],["class","tracks",4,"ngIf"],[1,"tracks"],[1,"actions"],["title","Refresh",1,"button-on-control",3,"click"],[1,"icon-reload"],["title","Move Tracks\u2026",1,"button-on-control",3,"click"],[1,"icon-right-bold"],["title","Delete Tracks\u2026",1,"button-on-control",3,"click"],[1,"icon-trash"],[1,"content",3,"tracks"]],template:function(t,e){1&t&&(g.YNc(0,Je,1,0,"app-loading",0),g._UZ(1,"app-background-text-list",1),g.YNc(2,Qe,9,1,"div",2)),2&t&&(g.Q6J("ngIf",!e.folder),g.xp6(1),g.Q6J("list",null==e.folder?null:e.folder.tracks),g.xp6(1),g.Q6J("ngIf",e.folder&&e.folder.tracks&&e.folder.tracks.length>0))},directives:[i.O5,B.$,E.N,Re],styles:["[_nghost-%COMP%]{height:100%;width:100%;display:block;overflow:hidden}[_nghost-%COMP%]   .tracks[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;width:100%}[_nghost-%COMP%]   .tracks[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{padding:10px 15px 0;border-bottom-color:var(--background-border);border-bottom-width:1px;border-bottom-style:solid}[_nghost-%COMP%]   .tracks[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{margin-right:5px;margin-bottom:10px}[_nghost-%COMP%]   .tracks[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%] > label[_ngcontent-%COMP%]{text-transform:uppercase;letter-spacing:1px;font-size:11px;margin-left:5px;margin-right:5px}[_nghost-%COMP%]   .tracks[_ngcontent-%COMP%]   app-admin-track-list[_ngcontent-%COMP%]{overflow-y:auto}"]}),t})();var ze=n(95197);function Fe(t,e){if(1&t){const t=g.EpF();g.TgZ(0,"button",9),g.NdJ("click",function(){g.CHM(t);const e=g.oxw(3);return e.refresh(e.current.pos,!1)}),g._UZ(1,"i",10),g._uU(2," Refresh"),g.qZA()}}function He(t,e){if(1&t){const t=g.EpF();g.TgZ(0,"button",9),g.NdJ("click",function(){return g.CHM(t),g.oxw(3).fixAll()}),g._uU(1,"Fix all fixable"),g.qZA()}}function Ye(t,e){if(1&t){const t=g.EpF();g.TgZ(0,"div",5),g.TgZ(1,"button",6),g.NdJ("click",function(){return g.CHM(t),g.oxw(2).start()}),g._UZ(2,"i",7),g._uU(3," Next"),g.qZA(),g.YNc(4,Fe,3,0,"button",8),g.YNc(5,He,2,0,"button",8),g.qZA()}if(2&t){const t=g.oxw(2);g.xp6(4),g.Q6J("ngIf",t.current),g.xp6(1),g.Q6J("ngIf",t.current&&t.current.health&&t.current.health.length>0)}}function De(t,e){if(1&t){const t=g.EpF();g.TgZ(0,"div",5),g.TgZ(1,"button",9),g.NdJ("click",function(){return g.CHM(t),g.oxw(2).stop()}),g._UZ(2,"i",11),g._uU(3," Stop"),g.qZA(),g.qZA()}}function Ee(t,e){if(1&t&&(g.ynx(0),g.YNc(1,Ye,6,2,"div",4),g.YNc(2,De,4,0,"div",4),g.BQk()),2&t){const t=g.oxw();g.xp6(1),g.Q6J("ngIf",!t.searching),g.xp6(1),g.Q6J("ngIf",t.searching)}}function Be(t,e){1&t&&g._UZ(0,"app-loading")}function je(t,e){1&t&&g._UZ(0,"i",16)}function Le(t,e){if(1&t){const t=g.EpF();g.TgZ(0,"div",18),g.TgZ(1,"div",19),g._uU(2),g.qZA(),g.TgZ(3,"div",20),g.TgZ(4,"app-track-health",21),g.NdJ("resolvedEvent",function(){const e=g.CHM(t).$implicit;return g.oxw(3).trackHealthResolved(e)}),g.qZA(),g.qZA(),g.qZA()}if(2&t){const t=e.$implicit;g.xp6(2),g.hij(" ",t.track.name," "),g.xp6(2),g.Q6J("trackHealth",t)}}function We(t,e){if(1&t&&(g.ynx(0),g.YNc(1,Le,5,2,"div",17),g.BQk()),2&t){const t=g.oxw(2);g.xp6(1),g.Q6J("ngForOf",t.current.health)("ngForTrackBy",t.trackByFn)}}const $e=function(t){return["/admin/folder",t,"tags"]};function Ge(t,e){if(1&t&&(g.TgZ(0,"div"),g.TgZ(1,"div",12),g.TgZ(2,"span"),g.YNc(3,je,1,0,"i",13),g.qZA(),g.TgZ(4,"span"),g._uU(5),g.qZA(),g.TgZ(6,"a",14),g._UZ(7,"i",15),g._uU(8),g.qZA(),g.qZA(),g.YNc(9,We,2,2,"ng-container",2),g.qZA()),2&t){const t=g.oxw();g.xp6(3),g.Q6J("ngIf",t.searching),g.xp6(2),g.AsE("",t.current.pos+1," / ",t.folders.length,""),g.xp6(1),g.Q6J("routerLink",g.VKq(6,$e,t.current.folder.id)),g.xp6(2),g.hij(" ",t.current.folder.name,""),g.xp6(1),g.Q6J("ngIf",t.current.health)}}let Ve=(()=>{class t{constructor(t,e,n,o,i,r){this.app=t,this.jam=e,this.notify=n,this.uiState=o,this.folderService=i,this.userStorage=r,this.searching=!1,this.unsubscribe=new f.xQ,r.userChange.pipe((0,m.R)(this.unsubscribe)).subscribe(t=>{this.loadFromStorage()})}trackHealthResolved(t){this.current&&this.current.health&&(this.current.health=this.current.health.filter(e=>e!==t))}trackByFn(t,e){return e.track.id}stop(){this.searching=!1}start(){this.searching||!this.folders||(this.searching=!0,this.request())}request(){if(!this.searching)return;let t=0;this.current&&(t=this.current.pos+1),this.refresh(t,!0)}fixAll(){this.searching||!this.current||!this.trackHealthComponents||this.trackHealthComponents.forEach(t=>{t.fixAll()})}refresh(e,n){this.current=void 0,this.searching=!0;const o=this.folders&&this.folders[e];if(!o)return void(this.searching=!1);const i={folder:o,pos:e};this.current=i,this.userStorage.set(t.localStorageName,{folderID:o.id}),this.jam.track.health({folderIDs:[o.id],healthMedia:!0}).then(t=>{t.length>0?(i.health=t,this.searching=!1):n?this.request():(i.health=[],this.searching=!1)}).catch(t=>{this.current=void 0,this.searching=!1,this.notify.error(t)})}ngOnInit(){const t=this.uiState.data["app-admin-radar"];t&&(this.folders=t.folders,this.current=t.current,this.folders)||this.loadFolders()}ngOnDestroy(){this.uiState.data["app-admin-radar"]={folders:this.folders,current:this.current},this.current=void 0,this.searching=!1,this.folders=void 0,this.unsubscribe.next(),this.unsubscribe.complete()}loadFromStorage(){const e=this.userStorage.get(t.localStorageName);if((null==e?void 0:e.folderID)&&this.folders){const t=this.folders.findIndex(t=>t.id===e.folderID);t>=0&&(this.current={folder:this.folders[t],pos:t},this.refresh(t,!1))}}loadFolders(){this.jam.folder.search({folderTypes:[x.Sr.album,x.Sr.multialbum]}).then(t=>{this.folders=t.items,this.loadFromStorage()}).catch(t=>{this.notify.error(t)})}}return t.localStorageName="admin.radar",t.\u0275fac=function(e){return new(e||t)(g.Y36(C.zi),g.Y36(x.K4),g.Y36(C.c),g.Y36(C.JU),g.Y36(C.Cr),g.Y36(C.TZ))},t.\u0275cmp=g.Xpm({type:t,selectors:[["app-admin-radar"]],viewQuery:function(t,e){if(1&t&&g.Gf(Ae,5),2&t){let t;g.iGM(t=g.CRH())&&(e.trackHealthComponents=t)}},decls:6,vars:3,consts:[[1,"radar"],["section","Health Radar"],[4,"ngIf"],[1,"content"],["class","buttons",4,"ngIf"],[1,"buttons"],[1,"button-primary",3,"click"],[1,"icon-play"],["class","button-on-control",3,"click",4,"ngIf"],[1,"button-on-control",3,"click"],[1,"icon-reload"],[1,"icon-stop"],[1,"current"],["class","icon-spin icon-spinner",4,"ngIf"],[3,"routerLink"],[1,"icon-folder"],[1,"icon-spin","icon-spinner"],["class","track",4,"ngFor","ngForOf","ngForTrackBy"],[1,"track"],[1,"meta"],[1,"track-health"],[3,"trackHealth","resolvedEvent"]],template:function(t,e){1&t&&(g.TgZ(0,"div",0),g.TgZ(1,"app-view-header-slim",1),g.YNc(2,Ee,3,2,"ng-container",2),g.qZA(),g.TgZ(3,"div",3),g.YNc(4,Be,1,0,"app-loading",2),g.YNc(5,Ge,10,8,"div",2),g.qZA(),g.qZA()),2&t&&(g.xp6(2),g.Q6J("ngIf",e.folders),g.xp6(2),g.Q6J("ngIf",!e.folders),g.xp6(1),g.Q6J("ngIf",e.folders&&e.current))},directives:[ze.p,i.O5,E.N,u.yS,i.sg,Ae],styles:["[_nghost-%COMP%]{height:100%;width:100%;overflow-y:auto;overflow-x:auto;display:block}[_nghost-%COMP%]   .radar[_ngcontent-%COMP%]{display:flex;flex-direction:column}[_nghost-%COMP%]   .radar[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{padding:15px}[_nghost-%COMP%]   .radar[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]{min-width:130px;display:inline-block}[_nghost-%COMP%]   .radar[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{margin-right:5px}[_nghost-%COMP%]   .radar[_ngcontent-%COMP%]   .current[_ngcontent-%COMP%]{padding-top:15px;padding-bottom:15px;border-bottom:1px solid var(--background-border)}[_nghost-%COMP%]   .radar[_ngcontent-%COMP%]   .current[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{padding-right:15px}[_nghost-%COMP%]   .radar[_ngcontent-%COMP%]   .track[_ngcontent-%COMP%]{border-bottom:1px solid var(--background-border)}[_nghost-%COMP%]   .radar[_ngcontent-%COMP%]   .track[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]{padding-top:15px;padding-bottom:15px}[_nghost-%COMP%]   .radar[_ngcontent-%COMP%]   .track[_ngcontent-%COMP%]   .track-health[_ngcontent-%COMP%]{padding-left:15px}@media (max-width: 768px){[_nghost-%COMP%]   .radar[_ngcontent-%COMP%]   .current[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block}[_nghost-%COMP%]   .radar[_ngcontent-%COMP%]   .track[_ngcontent-%COMP%]   .track-health[_ngcontent-%COMP%]{padding-left:0}}"]}),t})();const Xe=function(){return{standalone:!0}};function Ke(t,e){if(1&t){const t=g.EpF();g.TgZ(0,"form"),g.TgZ(1,"div",1),g.TgZ(2,"label",2),g._uU(3,"Root name"),g.qZA(),g.TgZ(4,"input",3),g.NdJ("ngModelChange",function(e){return g.CHM(t),g.oxw().edit.name=e}),g.qZA(),g.qZA(),g.TgZ(5,"div",1),g.TgZ(6,"label",4),g._uU(7,"Path"),g.qZA(),g.TgZ(8,"input",5),g.NdJ("ngModelChange",function(e){return g.CHM(t),g.oxw().edit.path=e}),g.qZA(),g.qZA(),g.TgZ(9,"div",1),g.TgZ(10,"label"),g._uU(11,"Scan Strategy"),g.qZA(),g.TgZ(12,"fieldset"),g.TgZ(13,"label",6),g.TgZ(14,"input",7),g.NdJ("ngModelChange",function(e){return g.CHM(t),g.oxw().edit.strategy=e}),g.qZA(),g._uU(15," Auto"),g.qZA(),g.TgZ(16,"label",6),g.TgZ(17,"input",7),g.NdJ("ngModelChange",function(e){return g.CHM(t),g.oxw().edit.strategy=e}),g.qZA(),g._uU(18," Artist/Album"),g.qZA(),g.TgZ(19,"label",6),g.TgZ(20,"input",7),g.NdJ("ngModelChange",function(e){return g.CHM(t),g.oxw().edit.strategy=e}),g.qZA(),g._uU(21," Compilations"),g.qZA(),g.TgZ(22,"label",6),g.TgZ(23,"input",7),g.NdJ("ngModelChange",function(e){return g.CHM(t),g.oxw().edit.strategy=e}),g.qZA(),g._uU(24," Audiobook"),g.qZA(),g.qZA(),g.qZA(),g.qZA()}if(2&t){const t=g.oxw();g.xp6(4),g.Q6J("ngModel",t.edit.name)("ngModelOptions",g.DdM(12,Xe)),g.xp6(4),g.Q6J("ngModel",t.edit.path)("ngModelOptions",g.DdM(13,Xe)),g.xp6(6),g.Q6J("ngModel",t.edit.strategy)("value",t.RootScanStrategy.auto),g.xp6(3),g.Q6J("ngModel",t.edit.strategy)("value",t.RootScanStrategy.artistalbum),g.xp6(3),g.Q6J("ngModel",t.edit.strategy)("value",t.RootScanStrategy.compilation),g.xp6(3),g.Q6J("ngModel",t.edit.strategy)("value",t.RootScanStrategy.audiobook)}}let tn=(()=>{class t{constructor(){this.RootScanStrategy=x.hy}dialogInit(t,e){this.edit=e.data}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=g.Xpm({type:t,selectors:[["app-dialog-root"]],decls:1,vars:1,consts:[[4,"ngIf"],[1,"root-form-control"],["for","root-name"],["id","root-name","type","text",3,"ngModel","ngModelOptions","ngModelChange"],["for","root-path"],["id","root-path","type","text",3,"ngModel","ngModelOptions","ngModelChange"],[1,"select"],["type","radio","name","strategy",3,"ngModel","value","ngModelChange"]],template:function(t,e){1&t&&g.YNc(0,Ke,25,14,"form",0),2&t&&g.Q6J("ngIf",e.edit)},directives:[i.O5,r._Y,r.JL,r.F,r.Fj,r.JJ,r.On,r._],styles:["[_nghost-%COMP%]   input[type=text][_ngcontent-%COMP%]{width:100%;line-height:1.3em;padding:5px;min-width:300px}[_nghost-%COMP%]   input[type=radio][_ngcontent-%COMP%]{margin-right:5px}[_nghost-%COMP%]   .root-form-control[_ngcontent-%COMP%]{margin-bottom:8px;display:block}[_nghost-%COMP%]   .select[_ngcontent-%COMP%]{margin-right:15px;display:block;font-size:.8em;line-height:1.5em}"]}),t})();var en=n(79178);function nn(t,e){1&t&&(g.TgZ(0,"span"),g._uU(1,"Not scanned"),g.qZA())}function on(t,e){if(1&t&&(g.TgZ(0,"span",21),g._uU(1,"Error:"),g._UZ(2,"br"),g._uU(3),g.qZA()),2&t){const t=g.oxw().$implicit;g.xp6(3),g.Oqu(t.status.error)}}function rn(t,e){1&t&&(g.ynx(0),g._uU(1,"Working\u2026"),g.BQk())}function sn(t,e){if(1&t&&(g.ynx(0),g._uU(1,"Last Change:"),g._UZ(2,"br"),g._uU(3),g.ALo(4,"date"),g.BQk()),2&t){const t=g.oxw(2).$implicit;g.xp6(3),g.Oqu(g.xi3(4,1,t.status.lastScan,"medium"))}}function an(t,e){if(1&t&&(g.TgZ(0,"span"),g.YNc(1,rn,2,0,"ng-container",11),g.YNc(2,sn,5,4,"ng-container",11),g.qZA()),2&t){const t=g.oxw().$implicit;g.xp6(1),g.Q6J("ngIf",t.status.scanning),g.xp6(1),g.Q6J("ngIf",!t.status.scanning)}}function cn(t,e){if(1&t){const t=g.EpF();g.TgZ(0,"tr",10),g.NdJ("dblclick",function(){const e=g.CHM(t).$implicit;return g.oxw(2).editRoot(e)}),g.TgZ(1,"td",4),g._uU(2),g.qZA(),g.TgZ(3,"td",5),g._uU(4),g.qZA(),g.TgZ(5,"td",6),g._uU(6),g.qZA(),g.TgZ(7,"td",7),g.YNc(8,nn,2,0,"span",11),g.YNc(9,on,4,1,"span",12),g.YNc(10,an,3,2,"span",11),g.qZA(),g.TgZ(11,"td",8),g.TgZ(12,"a",13),g.NdJ("click",function(){const e=g.CHM(t).$implicit;return g.oxw(2).refreshRoot(e)}),g._UZ(13,"i",14),g.qZA(),g.TgZ(14,"a",15),g.NdJ("click",function(){const e=g.CHM(t).$implicit;return g.oxw(2).refreshRootMeta(e)}),g._UZ(15,"i",16),g.qZA(),g.TgZ(16,"a",17),g.NdJ("click",function(){const e=g.CHM(t).$implicit;return g.oxw(2).editRoot(e)}),g._UZ(17,"i",18),g.qZA(),g.TgZ(18,"a",19),g.NdJ("click",function(){const e=g.CHM(t).$implicit;return g.oxw(2).deleteRoot(e)}),g._UZ(19,"i",20),g.qZA(),g.qZA(),g.qZA()}if(2&t){const t=e.$implicit;g.xp6(2),g.Oqu(t.name),g.xp6(2),g.Oqu(t.path),g.xp6(2),g.Oqu(t.strategy),g.xp6(2),g.Q6J("ngIf",!t.status),g.xp6(1),g.Q6J("ngIf",t.status&&t.status.error),g.xp6(1),g.Q6J("ngIf",t.status&&!t.status.error)}}function ln(t,e){if(1&t&&(g.TgZ(0,"table",2),g.TgZ(1,"tr",3),g.TgZ(2,"td",4),g._uU(3,"Name"),g.qZA(),g.TgZ(4,"td",5),g._uU(5,"Path"),g.qZA(),g.TgZ(6,"td",6),g._uU(7,"Strategy"),g.qZA(),g.TgZ(8,"td",7),g._uU(9,"Status"),g.qZA(),g.TgZ(10,"td",8),g._uU(11,"Actions"),g.qZA(),g.qZA(),g.YNc(12,cn,20,6,"tr",9),g.qZA()),2&t){const t=g.oxw();g.xp6(12),g.Q6J("ngForOf",t.roots)}}let dn=(()=>{class t{constructor(t,e,n,o,i,r,s){this.router=t,this.route=e,this.app=n,this.notify=o,this.dialogs=i,this.rootService=r,this.dialogOverlay=s,this.roots=[]}refreshRoot(t){this.rootService.rescanRoot(t)}refreshRootMeta(t){this.rootService.refreshRootMeta(t)}editRoot(t){const e={root:t,name:t.name,path:t.path,strategy:t.strategy};this.dialogOverlay.open({title:"Edit Root",childComponent:tn,data:e,onOkBtn:()=>(0,p.mG)(this,void 0,void 0,function*(){try{yield this.rootService.applyDialogRoot(e)}catch(t){return this.notify.error(t),Promise.reject(t)}}),onCancelBtn:()=>(0,p.mG)(this,void 0,void 0,function*(){return Promise.resolve()})})}deleteRoot(t){this.dialogs.confirm("Delete Root","Do you want to the delete the root folder?",()=>{this.rootService.removeRoot(t)})}}return t.\u0275fac=function(e){return new(e||t)(g.Y36(u.F0),g.Y36(u.gz),g.Y36(C.zi),g.Y36(C.c),g.Y36(Y.Hr),g.Y36(C.Nb),g.Y36(D.SL))},t.\u0275cmp=g.Xpm({type:t,selectors:[["app-admin-root-list"]],inputs:{roots:"roots"},decls:2,vars:2,consts:[["name","Roots",3,"list"],["class","roots",4,"ngIf"],[1,"roots"],[1,"root","heading"],[1,"title"],[1,"path"],[1,"strategy"],[1,"status"],[1,"actions"],["class","root",3,"dblclick",4,"ngFor","ngForOf"],[1,"root",3,"dblclick"],[4,"ngIf"],["class","error",4,"ngIf"],["title","Rescan Root","appClickStop","",3,"click"],[1,"icon-rescan"],["title","Refresh Root Meta","appClickStop","",3,"click"],[1,"icon-broom"],["title","Edit Root","appClickStop","",3,"click"],[1,"icon-edit"],["title","Delete Root","appClickStop","",3,"click"],[1,"icon-remove"],[1,"error"]],template:function(t,e){1&t&&(g._UZ(0,"app-background-text-list",0),g.YNc(1,ln,13,1,"table",1)),2&t&&(g.Q6J("list",e.roots),g.xp6(1),g.Q6J("ngIf",e.roots&&e.roots.length>0))},directives:[B.$,i.O5,i.sg,en.D],pipes:[i.uU],styles:["[_nghost-%COMP%]{width:100%;overflow:auto;display:block}[_nghost-%COMP%]   .roots[_ngcontent-%COMP%]{padding:15px;font-size:.9em;width:100%}[_nghost-%COMP%]   .root[_ngcontent-%COMP%]{height:60px;border-bottom:1px solid var(--control-border)}[_nghost-%COMP%]   .root[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:5px 10px}[_nghost-%COMP%]   .root[_ngcontent-%COMP%]:hover{background-color:var(--background-hover)}[_nghost-%COMP%]   .root.selected[_ngcontent-%COMP%]{background-color:var(--background-active)}[_nghost-%COMP%]   .error[_ngcontent-%COMP%]{color:var(--accent)}[_nghost-%COMP%]   .heading[_ngcontent-%COMP%]{height:40px;font-size:.9em}[_nghost-%COMP%]   .actions[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{margin-right:5px}"]}),t})(),gn=(()=>{class t{constructor(t,e,n,o,i,r,s){this.router=t,this.route=e,this.app=n,this.notify=o,this.dialogs=i,this.rootService=r,this.dialogOverlay=s,this.unsubscribe=new f.xQ}static getSortValue(t,e){switch(t){case"name":return e.name;case"path":return e.path;default:return}}ngOnInit(){this.rootService.rootsChange.pipe((0,m.R)(this.unsubscribe)).subscribe(t=>{this.roots=(t||[]).sort((t,e)=>t.name.localeCompare(e.name))},t=>{this.notify.error(t)}),this.rootService.refreshRoots()}ngOnDestroy(){this.unsubscribe.next(),this.unsubscribe.complete()}refresh(){this.rootService.refreshRoots()}newRoot(){const t={name:"",path:"",strategy:x.hy.auto};this.dialogOverlay.open({title:"New Root",childComponent:tn,data:t,onOkBtn:()=>(0,p.mG)(this,void 0,void 0,function*(){try{yield this.rootService.applyDialogRoot(t)}catch(e){return this.notify.error(e),Promise.reject(e)}}),onCancelBtn:()=>(0,p.mG)(this,void 0,void 0,function*(){return Promise.resolve()})})}refreshRoots(){this.rootService.rescanRoots()}}return t.\u0275fac=function(e){return new(e||t)(g.Y36(u.F0),g.Y36(u.gz),g.Y36(C.zi),g.Y36(C.c),g.Y36(Y.Hr),g.Y36(C.Nb),g.Y36(D.SL))},t.\u0275cmp=g.Xpm({type:t,selectors:[["app-admin-root"]],decls:11,vars:1,consts:[[1,"roots"],["section","Roots"],[1,"actions"],["title","Refresh",1,"button-on-control",3,"click"],[1,"icon-reload"],["title","New Root\u2026",1,"button-on-control",3,"click"],[1,"icon-plus"],["title","Rescan all Roots",1,"button-on-control",3,"click"],[1,"icon-rescan"],[1,"content"],[3,"roots"]],template:function(t,e){1&t&&(g.TgZ(0,"div",0),g.TgZ(1,"app-view-header-slim",1),g.TgZ(2,"div",2),g.TgZ(3,"button",3),g.NdJ("click",function(){return e.refresh()}),g._UZ(4,"i",4),g.qZA(),g.TgZ(5,"button",5),g.NdJ("click",function(){return e.newRoot()}),g._UZ(6,"i",6),g.qZA(),g.TgZ(7,"button",7),g.NdJ("click",function(){return e.refreshRoots()}),g._UZ(8,"i",8),g.qZA(),g.qZA(),g.qZA(),g.TgZ(9,"div",9),g._UZ(10,"app-admin-root-list",10),g.qZA(),g.qZA()),2&t&&(g.xp6(10),g.Q6J("roots",e.roots))},directives:[ze.p,dn],styles:["[_nghost-%COMP%]{height:100%;width:100%;overflow-y:auto;overflow-x:auto;display:block}[_nghost-%COMP%]   .roots[_ngcontent-%COMP%]{height:100%;overflow-y:auto;overflow-x:hidden}[_nghost-%COMP%]   .roots[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{margin-right:5px;margin-bottom:10px}"]}),t})();function hn(t,e){1&t&&g._UZ(0,"app-loading")}function pn(t,e){if(1&t){const t=g.EpF();g.ynx(0),g.TgZ(1,"div"),g.TgZ(2,"div",6),g._uU(3,"Server"),g.qZA(),g.TgZ(4,"div",7),g.TgZ(5,"label"),g.TgZ(6,"input",8),g.NdJ("ngModelChange",function(e){return g.CHM(t),g.oxw().settings.library.scanAtStart=e})("ngModelChange",function(){return g.CHM(t),g.oxw().onChange()}),g.qZA(),g._uU(7," Scan all Roots on Server Start "),g.qZA(),g.qZA(),g.qZA(),g.TgZ(8,"div"),g.TgZ(9,"div",6),g._uU(10,"External Services"),g.qZA(),g.TgZ(11,"div",7),g.TgZ(12,"label"),g.TgZ(13,"input",9),g.NdJ("ngModelChange",function(e){return g.CHM(t),g.oxw().settings.externalServices.enabled=e})("ngModelChange",function(){return g.CHM(t),g.oxw().onChange()}),g.qZA(),g._uU(14," Allow Request to External Services "),g.qZA(),g.qZA(),g.qZA(),g.TgZ(15,"div"),g.TgZ(16,"div",6),g._uU(17,"Chat"),g.qZA(),g.TgZ(18,"div",7),g.TgZ(19,"label",10),g._uU(20,"Maximum Number of Messages"),g.qZA(),g.TgZ(21,"input",11),g.NdJ("ngModelChange",function(e){return g.CHM(t),g.oxw().settings.chat.maxMessages=e})("ngModelChange",function(){return g.CHM(t),g.oxw().onChange()}),g.qZA(),g.qZA(),g.TgZ(22,"div",7),g.TgZ(23,"div",12),g.TgZ(24,"label",13),g._uU(25,"Maximum Age of Message"),g.qZA(),g.TgZ(26,"input",14),g.NdJ("ngModelChange",function(e){return g.CHM(t),g.oxw().settings.chat.maxAge.value=e})("ngModelChange",function(){return g.CHM(t),g.oxw().onChange()}),g.qZA(),g.qZA(),g.TgZ(27,"select",15),g.NdJ("ngModelChange",function(e){return g.CHM(t),g.oxw().settings.chat.maxAge.unit=e})("ngModelChange",function(){return g.CHM(t),g.oxw().onChange()}),g.TgZ(28,"option",16),g._uU(29,"year"),g.qZA(),g.TgZ(30,"option",16),g._uU(31,"years"),g.qZA(),g.TgZ(32,"option",16),g._uU(33,"month"),g.qZA(),g.TgZ(34,"option",16),g._uU(35,"months"),g.qZA(),g.TgZ(36,"option",16),g._uU(37,"day"),g.qZA(),g.TgZ(38,"option",16),g._uU(39,"days"),g.qZA(),g.TgZ(40,"option",16),g._uU(41,"minute"),g.qZA(),g.TgZ(42,"option",16),g._uU(43,"minutes"),g.qZA(),g.TgZ(44,"option",16),g._uU(45,"second"),g.qZA(),g.TgZ(46,"option",16),g._uU(47,"seconds"),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.TgZ(48,"div"),g.TgZ(49,"div",6),g._uU(50,"Artist Index"),g.qZA(),g.TgZ(51,"div",7),g.TgZ(52,"label",17),g._uU(53,"Ignored Articles in Artist Names"),g.qZA(),g.TgZ(54,"textarea",18),g.NdJ("ngModelChange",function(e){return g.CHM(t),g.oxw().ignoreArticles=e})("ngModelChange",function(){return g.CHM(t),g.oxw().onChange()}),g.qZA(),g.qZA(),g.qZA(),g.BQk()}if(2&t){const t=g.oxw();g.xp6(6),g.Q6J("ngModel",t.settings.library.scanAtStart),g.xp6(7),g.Q6J("ngModel",t.settings.externalServices.enabled),g.xp6(8),g.Q6J("ngModel",t.settings.chat.maxMessages),g.xp6(5),g.Q6J("ngModel",t.settings.chat.maxAge.value),g.xp6(1),g.Q6J("ngModel",t.settings.chat.maxAge.unit),g.xp6(1),g.Q6J("value","year"),g.xp6(2),g.Q6J("value","years"),g.xp6(2),g.Q6J("value","month"),g.xp6(2),g.Q6J("value","months"),g.xp6(2),g.Q6J("value","day"),g.xp6(2),g.Q6J("value","days"),g.xp6(2),g.Q6J("value","minute"),g.xp6(2),g.Q6J("value","minutes"),g.xp6(2),g.Q6J("value","second"),g.xp6(2),g.Q6J("value","seconds"),g.xp6(8),g.Q6J("ngModel",t.ignoreArticles)}}let un=(()=>{class t{constructor(t,e,n){this.app=t,this.jam=e,this.notify=n,this.ignoreArticles=""}ngOnInit(){this.refresh()}onChange(){}refresh(){this.jam.admin.settings().then(t=>{this.display(t)}).catch(t=>{this.notify.error(t)})}save(){const t=this.settings;!t||(t.index.ignoreArticles=this.ignoreArticles.split("\n").map(t=>t.trim()).filter(t=>t.length>0),this.settings=void 0,this.jam.admin.settingsUpdate(t).then(()=>{this.notify.success("Settings updated"),this.settings=t}).catch(e=>{this.notify.error(e),this.settings=t}))}display(t){this.settings=t,this.ignoreArticles=t.index.ignoreArticles.join("\n")}}return t.\u0275fac=function(e){return new(e||t)(g.Y36(C.zi),g.Y36(x.K4),g.Y36(C.c))},t.\u0275cmp=g.Xpm({type:t,selectors:[["app-admin-settings"]],decls:8,vars:2,consts:[[1,"settings"],["section","Admin Settings"],["title","Save",1,"button-on-control",3,"click"],[1,"icon-floppy"],[1,"content"],[4,"ngIf"],[1,"section-title"],[1,"section-entry"],["type","checkbox","title","Scan all Roots on Server Start",3,"ngModel","ngModelChange"],["type","checkbox","title","Allow Request to External Services",3,"ngModel","ngModelChange"],["for","max_messages"],["id","max_messages","type","number",3,"ngModel","ngModelChange"],[1,"chat-max-age"],["for","max_age"],["id","max_age","type","number",3,"ngModel","ngModelChange"],["placeholder","Unit of Age",3,"ngModel","ngModelChange"],[3,"value"],["for","ignore_articles"],["id","ignore_articles","rows","10","cols","20",3,"ngModel","ngModelChange"]],template:function(t,e){1&t&&(g.TgZ(0,"div",0),g.TgZ(1,"app-view-header-slim",1),g.TgZ(2,"button",2),g.NdJ("click",function(){return e.save()}),g._UZ(3,"i",3),g._uU(4," Save Settings"),g.qZA(),g.qZA(),g.TgZ(5,"div",4),g.YNc(6,hn,1,0,"app-loading",5),g.YNc(7,pn,55,16,"ng-container",5),g.qZA(),g.qZA()),2&t&&(g.xp6(6),g.Q6J("ngIf",!e.settings),g.xp6(1),g.Q6J("ngIf",e.settings))},directives:[ze.p,i.O5,E.N,r.Wl,r.JJ,r.On,r.wV,r.Fj,r.EJ,r.YN,r.Kr],styles:["[_nghost-%COMP%]   .settings[_ngcontent-%COMP%]{overflow-y:auto;overflow-x:hidden;height:100%}[_nghost-%COMP%]   .settings[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{padding:15px 15px 0}[_nghost-%COMP%]   .settings[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .chat-max-age[_ngcontent-%COMP%]{display:inline-block}[_nghost-%COMP%]   .settings[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .section-entry[_ngcontent-%COMP%]{padding-bottom:15px}[_nghost-%COMP%]   .settings[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-size:12px;padding-bottom:3px}[_nghost-%COMP%]   .settings[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{margin-top:-1px;display:inline-block;vertical-align:middle}"]}),t})(),fn=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=g.Xpm({type:t,selectors:[["app-admin-start"]],decls:4,vars:0,consts:[[1,"start"],["section","Administration"],[1,"content"]],template:function(t,e){1&t&&(g.TgZ(0,"div",0),g._UZ(1,"app-view-header-slim",1),g.TgZ(2,"div",2),g._UZ(3,"app-admin-section-cards"),g.qZA(),g.qZA())},styles:["[_nghost-%COMP%]{height:100%;width:100%;overflow-y:auto;overflow-x:auto;display:block}[_nghost-%COMP%]   .start[_ngcontent-%COMP%]{height:100%;overflow-y:auto;overflow-x:hidden}"]}),t})();const mn=function(){return{standalone:!0}};function Mn(t,e){if(1&t){const t=g.EpF();g.TgZ(0,"div"),g.TgZ(1,"form"),g.TgZ(2,"div",1),g.TgZ(3,"label"),g._uU(4,"Name"),g.qZA(),g.TgZ(5,"input",2),g.NdJ("ngModelChange",function(e){return g.CHM(t),g.oxw().edit.edit.name=e}),g.qZA(),g.qZA(),g.TgZ(6,"div",1),g.TgZ(7,"label"),g._uU(8,"Email"),g.qZA(),g.TgZ(9,"input",3),g.NdJ("ngModelChange",function(e){return g.CHM(t),g.oxw().edit.edit.email=e}),g.qZA(),g.qZA(),g.TgZ(10,"div",4),g._uU(11,"Roles"),g.qZA(),g.TgZ(12,"div",5),g.TgZ(13,"label"),g.TgZ(14,"input",6),g.NdJ("ngModelChange",function(e){return g.CHM(t),g.oxw().edit.edit.roleAdmin=e}),g.qZA(),g._uU(15," Administrator "),g.qZA(),g._UZ(16,"br"),g.TgZ(17,"label"),g.TgZ(18,"input",7),g.NdJ("ngModelChange",function(e){return g.CHM(t),g.oxw().edit.edit.rolePodcast=e}),g.qZA(),g._uU(19," Manage Podcasts "),g.qZA(),g._UZ(20,"br"),g.TgZ(21,"label"),g.TgZ(22,"input",7),g.NdJ("ngModelChange",function(e){return g.CHM(t),g.oxw().edit.edit.roleStream=e}),g.qZA(),g._uU(23," Can Stream/Download "),g.qZA(),g._UZ(24,"br"),g.TgZ(25,"label"),g.TgZ(26,"input",8),g.NdJ("ngModelChange",function(e){return g.CHM(t),g.oxw().edit.edit.roleUpload=e}),g.qZA(),g._uU(27," Can Upload "),g.qZA(),g.qZA(),g._UZ(28,"hr"),g.TgZ(29,"div",1),g._UZ(30,"input",9,10),g.TgZ(32,"label",11),g._uU(33,"Your Admin Password"),g.qZA(),g.TgZ(34,"input",12),g.NdJ("ngModelChange",function(e){return g.CHM(t),g.oxw().edit.edit.password=e}),g.qZA(),g.qZA(),g.qZA(),g.qZA()}if(2&t){const t=g.oxw();g.xp6(5),g.Q6J("ngModel",t.edit.edit.name)("ngModelOptions",g.DdM(14,mn)),g.xp6(4),g.Q6J("ngModel",t.edit.edit.email)("ngModelOptions",g.DdM(15,mn)),g.xp6(5),g.Q6J("ngModel",t.edit.edit.roleAdmin)("ngModelOptions",g.DdM(16,mn)),g.xp6(4),g.Q6J("ngModel",t.edit.edit.rolePodcast)("ngModelOptions",g.DdM(17,mn)),g.xp6(4),g.Q6J("ngModel",t.edit.edit.roleStream)("ngModelOptions",g.DdM(18,mn)),g.xp6(4),g.Q6J("ngModel",t.edit.edit.roleUpload)("ngModelOptions",g.DdM(19,mn)),g.xp6(8),g.Q6J("ngModel",t.edit.edit.password)("ngModelOptions",g.DdM(20,mn))}}let Cn=(()=>{class t{dialogInit(t,e){this.edit=e.data}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=g.Xpm({type:t,selectors:[["app-dialog-user"]],decls:1,vars:1,consts:[[4,"ngIf"],[1,"user-form-control"],["type","text","name","username",3,"ngModel","ngModelOptions","ngModelChange"],["type","email","name","mail",3,"ngModel","ngModelOptions","ngModelChange"],[1,"user-form-section"],[1,"user-form-roles"],["type","checkbox","title","Allow User to administrate",3,"ngModel","ngModelOptions","ngModelChange"],["type","checkbox","title","Allow User to manage podcasts",3,"ngModel","ngModelOptions","ngModelChange"],["type","checkbox","title","Allow User to upload files",3,"ngModel","ngModelOptions","ngModelChange"],["type","text","name","user","autocomplete","username",1,"dummy"],["name",""],[1,"label-pass"],["name","pass","type","password","autocomplete","password",3,"ngModel","ngModelOptions","ngModelChange"]],template:function(t,e){1&t&&g.YNc(0,Mn,35,21,"div",0),2&t&&g.Q6J("ngIf",e.edit)},directives:[i.O5,r._Y,r.JL,r.F,r.Fj,r.JJ,r.On,r.Wl],styles:["[_nghost-%COMP%] > div[_ngcontent-%COMP%]{margin-left:15px;margin-right:15px}[_nghost-%COMP%]   input[type=text][_ngcontent-%COMP%], [_nghost-%COMP%]   input[type=email][_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]   input[_ngcontent-%COMP%]{line-height:1.3em;padding:5px}[_nghost-%COMP%]   .label-pass[_ngcontent-%COMP%]{padding-right:15px;font-size:.8em}[_nghost-%COMP%]   .dummy[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .user-form-control[_ngcontent-%COMP%]{margin-bottom:8px;display:block}[_nghost-%COMP%]   .user-form-roles[_ngcontent-%COMP%]{margin-bottom:10px}[_nghost-%COMP%]   .user-form-roles[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{line-height:1.5em}"]}),t})();var xn=n(69100);let vn=(()=>{class t{constructor(t,e){this.jam=t,this.notify=e,this.hasChanged=!1,this.unsubscribe=new f.xQ}ngOnDestroy(){this.unsubscribe.next(),this.unsubscribe.complete()}dialogInit(t,e){this.user=e.data,this.setImageSource()}dialogResult(){return this.hasChanged}setImageSource(){this.userAvatar=this.user?`${this.jam.image.imageUrl({id:this.user.id,size:60,format:x.GU.webp})}?${(0,xn.O)()}`:void 0}onDropFile(t){var e;t.preventDefault(),this.uploadFile(null===(e=t.dataTransfer)||void 0===e?void 0:e.files)}onDragOverFile(t){t.stopPropagation(),t.preventDefault()}selectFile(t){this.uploadFile(t.target.files)}uploadFile(t){t&&0!==t.length&&this.user&&this.jam.user.uploadUserImage({id:this.user.id},t[0]).pipe((0,m.R)(this.unsubscribe)).subscribe(t=>{t.type===it.dt.UploadProgress||t instanceof it.Zn&&(this.setImageSource(),this.hasChanged=!0)},t=>{this.setImageSource(),this.notify.error(t)},()=>{this.notify.success("Upload done")})}}return t.\u0275fac=function(e){return new(e||t)(g.Y36(x.K4),g.Y36(C.c))},t.\u0275cmp=g.Xpm({type:t,selectors:[["app-dialog-avatar"]],decls:6,vars:1,consts:[[1,"drop-zone",3,"drop","dragover"],[1,"root-form-control"],[3,"src"],["type","file","placeholder","Upload image","accept",".png,.jpeg,.jpg",3,"change"]],template:function(t,e){1&t&&(g.TgZ(0,"div",0),g.NdJ("drop",function(t){return e.onDropFile(t)})("dragover",function(t){return e.onDragOverFile(t)}),g.TgZ(1,"form"),g.TgZ(2,"div",1),g._UZ(3,"img",2),g.qZA(),g.qZA(),g.TgZ(4,"form"),g.TgZ(5,"input",3),g.NdJ("change",function(t){return e.selectFile(t)}),g.qZA(),g.qZA(),g.qZA()),2&t&&(g.xp6(3),g.Q6J("src",e.userAvatar,g.LSH))},directives:[r._Y,r.JL,r.F],styles:["[_nghost-%COMP%]   .drop-zone[_ngcontent-%COMP%]{margin:10px 20px;border-width:2px;border-style:dotted;border-color:var(--secondary)}[_nghost-%COMP%]   input[type=text][_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]   .root-form-control[_ngcontent-%COMP%]{margin-bottom:8px;display:block;text-align:center}"]}),t})();const _n=function(){return{standalone:!0}};function On(t,e){if(1&t){const t=g.EpF();g.TgZ(0,"div",1),g.TgZ(1,"form"),g._UZ(2,"input",2),g.TgZ(3,"label"),g._uU(4,"Your Admin Password"),g.qZA(),g.TgZ(5,"input",3),g.NdJ("ngModelChange",function(e){return g.CHM(t),g.oxw().data.password=e}),g.qZA(),g.qZA(),g.TgZ(6,"form"),g._UZ(7,"input",4),g.TgZ(8,"label"),g._uU(9,"New Password for User "),g.TgZ(10,"span"),g._uU(11),g.qZA(),g.qZA(),g.TgZ(12,"input",5),g.NdJ("ngModelChange",function(e){return g.CHM(t),g.oxw().data.newPassword=e}),g.qZA(),g.qZA(),g.qZA()}if(2&t){const t=g.oxw();g.xp6(5),g.Q6J("ngModel",t.data.password)("ngModelOptions",g.DdM(5,_n)),g.xp6(6),g.Oqu(t.data.user.name),g.xp6(1),g.Q6J("ngModel",t.data.newPassword)("ngModelOptions",g.DdM(6,_n))}}let Pn=(()=>{class t{dialogInit(t,e){this.data=e.data}dialogResult(){return!0}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=g.Xpm({type:t,selectors:[["app-dialog-user-pass"]],decls:1,vars:1,consts:[["class","user-form-control",4,"ngIf"],[1,"user-form-control"],["type","text","name","user","autocomplete","username",1,"dummy"],["name","pass","type","password","autocomplete","current-password",3,"ngModel","ngModelOptions","ngModelChange"],["type","text","name","new_name",1,"dummy"],["name","new_password","autocomplete","off","type","password","autocomplete","new-password",3,"ngModel","ngModelOptions","ngModelChange"]],template:function(t,e){1&t&&g.YNc(0,On,13,7,"div",0),2&t&&g.Q6J("ngIf",e.data)},directives:[i.O5,r._Y,r.JL,r.F,r.Fj,r.JJ,r.On],styles:["[_nghost-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:10px}[_nghost-%COMP%]   label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:bold}[_nghost-%COMP%]   .dummy[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   input[_ngcontent-%COMP%]{line-height:1.3em;padding:5px;width:100%;margin-bottom:15px}"]}),t})();var bn=n(97254);function Zn(t,e){1&t&&g._UZ(0,"i",20)}function wn(t,e){1&t&&g._UZ(0,"i",20)}function yn(t,e){1&t&&g._UZ(0,"i",20)}function An(t,e){1&t&&g._UZ(0,"i",20)}function kn(t,e){if(1&t){const t=g.EpF();g.TgZ(0,"tr",9),g.NdJ("dblclick",function(){const e=g.CHM(t).$implicit;return g.oxw(2).editUser(e)}),g.TgZ(1,"td",3),g._UZ(2,"app-coverart-image",10),g.qZA(),g.TgZ(3,"td",4),g._uU(4),g.qZA(),g.TgZ(5,"td",5),g._uU(6),g.qZA(),g.TgZ(7,"td",6),g.YNc(8,Zn,1,0,"i",11),g.qZA(),g.TgZ(9,"td",6),g.YNc(10,wn,1,0,"i",11),g.qZA(),g.TgZ(11,"td",6),g.YNc(12,yn,1,0,"i",11),g.qZA(),g.TgZ(13,"td",6),g.YNc(14,An,1,0,"i",11),g.qZA(),g.TgZ(15,"td",7),g.TgZ(16,"a",12),g.NdJ("click",function(){const e=g.CHM(t).$implicit;return g.oxw(2).editUserAvatar(e)}),g._UZ(17,"i",13),g.qZA(),g.TgZ(18,"a",14),g.NdJ("click",function(){const e=g.CHM(t).$implicit;return g.oxw(2).setUserPassword(e)}),g._UZ(19,"i",15),g.qZA(),g.TgZ(20,"a",16),g.NdJ("click",function(){const e=g.CHM(t).$implicit;return g.oxw(2).editUser(e)}),g._UZ(21,"i",17),g.qZA(),g.TgZ(22,"a",18),g.NdJ("click",function(){const e=g.CHM(t).$implicit;return g.oxw(2).deleteUser(e)}),g._UZ(23,"i",19),g.qZA(),g.qZA(),g.qZA()}if(2&t){const t=e.$implicit;g.xp6(2),g.Q6J("coverArtObj",t)("alt",t.name)("size",28)("round",!0),g.xp6(2),g.Oqu(t.name),g.xp6(2),g.Oqu(t.email),g.xp6(2),g.Q6J("ngIf",t.roles.admin),g.xp6(2),g.Q6J("ngIf",t.roles.podcast),g.xp6(2),g.Q6J("ngIf",t.roles.upload),g.xp6(2),g.Q6J("ngIf",t.roles.stream)}}function Tn(t,e){if(1&t&&(g.TgZ(0,"table",1),g.TgZ(1,"tr",2),g.TgZ(2,"td",3),g._uU(3,"Avatar"),g.qZA(),g.TgZ(4,"td",4),g._uU(5,"Name"),g.qZA(),g.TgZ(6,"td",5),g._uU(7,"Email"),g.qZA(),g.TgZ(8,"td",6),g._uU(9,"Administrator"),g.qZA(),g.TgZ(10,"td",6),g._uU(11,"Manage Podcasts"),g.qZA(),g.TgZ(12,"td",6),g._uU(13,"Can Upload"),g.qZA(),g.TgZ(14,"td",6),g._uU(15,"Can Stream"),g.qZA(),g.TgZ(16,"td",7),g._uU(17,"Actions"),g.qZA(),g.qZA(),g.YNc(18,kn,24,10,"tr",8),g.qZA()),2&t){const t=g.oxw();g.xp6(18),g.Q6J("ngForOf",t.users)}}let In=(()=>{class t{constructor(t,e,n,o,i,r,s){this.router=t,this.route=e,this.app=n,this.notify=o,this.dialogs=i,this.userService=r,this.dialogOverlay=s,this.users=[],this.unsubscribe=new f.xQ}ngOnDestroy(){this.unsubscribe.next(),this.unsubscribe.complete()}editUser(t){const e={user:t,edit:{password:"",name:t.name,email:t.email||"",roleAdmin:t.roles.admin,rolePodcast:t.roles.podcast,roleStream:t.roles.stream,roleUpload:t.roles.upload}};this.dialogOverlay.open({childComponent:Cn,title:"Edit User",data:e,onOkBtn:()=>(0,p.mG)(this,void 0,void 0,function*(){try{yield this.userService.applyDialogUser(e),this.notify.success("User edited")}catch(t){return this.notify.error(t),Promise.reject(t)}}),onCancelBtn:()=>(0,p.mG)(this,void 0,void 0,function*(){return Promise.resolve()})})}editUserAvatar(t){this.dialogOverlay.open({childComponent:vn,title:"Edit User Avatar",data:t}).afterClosed().pipe((0,m.R)(this.unsubscribe)).subscribe(()=>{this.userService.refreshUser(t.id)})}setUserPassword(t){const e={user:t,password:"",newPassword:""};this.dialogOverlay.open({childComponent:Pn,title:"Set User Password",data:e,onOkBtn:()=>(0,p.mG)(this,void 0,void 0,function*(){try{yield this.userService.setPassword(t.id,e.password,e.newPassword),this.notify.success("Password changed")}catch(n){return this.notify.error(n),Promise.reject(n)}}),onCancelBtn:()=>(0,p.mG)(this,void 0,void 0,function*(){return Promise.resolve()})})}deleteUser(t){this.dialogs.confirm("Delete User","Do you want to the delete the user?",()=>{this.userService.removeUser(t).then(()=>{this.notify.success("User deleted")}).catch(t=>{this.notify.error(t)})})}}return t.\u0275fac=function(e){return new(e||t)(g.Y36(u.F0),g.Y36(u.gz),g.Y36(C.zi),g.Y36(C.c),g.Y36(Y.Hr),g.Y36(C.NZ),g.Y36(D.SL))},t.\u0275cmp=g.Xpm({type:t,selectors:[["app-admin-user-list"]],inputs:{users:"users"},decls:1,vars:1,consts:[["class","users",4,"ngIf"],[1,"users"],[1,"user","heading"],[1,"avatar"],[1,"title"],[1,"email"],[1,"role"],[1,"actions"],["class","user",3,"dblclick",4,"ngFor","ngForOf"],[1,"user",3,"dblclick"],[3,"coverArtObj","alt","size","round"],["class","icon-checkmark",4,"ngIf"],["title","Change Avatar",3,"click"],[1,"icon-picture"],["title","Set Password",3,"click"],[1,"icon-key"],["title","Edit User",3,"click"],[1,"icon-edit"],["title","Delete User",3,"click"],[1,"icon-remove"],[1,"icon-checkmark"]],template:function(t,e){1&t&&g.YNc(0,Tn,19,1,"table",0),2&t&&g.Q6J("ngIf",e.users&&e.users.length>0)},directives:[i.O5,i.sg,bn.A],styles:["[_nghost-%COMP%]{width:100%;overflow:auto;display:block}[_nghost-%COMP%]   .users[_ngcontent-%COMP%]{padding:15px;font-size:.9em;width:100%}[_nghost-%COMP%]   .user[_ngcontent-%COMP%]{height:60px;border-bottom:1px solid var(--control-border)}[_nghost-%COMP%]   .user[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:5px 10px}[_nghost-%COMP%]   .user[_ngcontent-%COMP%]:hover{background-color:var(--background-hover)}[_nghost-%COMP%]   .user.selected[_ngcontent-%COMP%]{background-color:var(--background-active)}[_nghost-%COMP%]   .heading[_ngcontent-%COMP%]{font-size:.9em;height:40px}[_nghost-%COMP%]   .icon-checkmark[_ngcontent-%COMP%]{color:var(--primary)}[_nghost-%COMP%]   .actions[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{margin-right:5px}"]}),t})();const qn=[{path:"",component:h,children:[{path:"",pathMatch:"full",component:fn,data:{name:"Admin"}},{path:"settings",component:un,data:{name:"Admin Settings"}},{path:"root",component:gn,data:{name:"Roots",icon:"icon-root"}},{path:"user",component:(()=>{class t{constructor(t,e,n,o,i,r){this.app=t,this.dialogs=e,this.jam=n,this.notify=o,this.userService=i,this.dialogOverlay=r,this.unsubscribe=new f.xQ}getSortValue(t,e){switch(t){case"name":return e.name;case"email":return e.email;case"roleAdmin":return e.roles.admin?1:0;case"rolePodcast":return e.roles.podcast?1:0;case"roleUpload":return e.roles.upload?1:0;case"roleStream":return e.roles.stream?1:0;default:return}}ngOnInit(){this.userService.usersChange.pipe((0,m.R)(this.unsubscribe)).subscribe(t=>{this.users=(t||[]).sort((t,e)=>t.name.localeCompare(e.name))},t=>{this.notify.error(t)}),this.userService.refreshUsers()}ngOnDestroy(){this.unsubscribe.next(),this.unsubscribe.complete()}refresh(){this.userService.refreshUsers()}newUser(){const t={edit:{password:"",name:"",email:"",roleAdmin:!1,rolePodcast:!1,roleStream:!0,roleUpload:!1}};this.dialogOverlay.open({title:"New User",childComponent:Cn,data:t,onOkBtn:()=>(0,p.mG)(this,void 0,void 0,function*(){try{yield this.userService.applyDialogUser(t),this.notify.success("User created")}catch(e){return this.notify.error(e),Promise.reject(e)}}),onCancelBtn:()=>(0,p.mG)(this,void 0,void 0,function*(){return Promise.resolve()})})}}return t.\u0275fac=function(e){return new(e||t)(g.Y36(C.zi),g.Y36(Y.Hr),g.Y36(x.K4),g.Y36(C.c),g.Y36(C.NZ),g.Y36(D.SL))},t.\u0275cmp=g.Xpm({type:t,selectors:[["app-admin-users"]],decls:9,vars:1,consts:[[1,"users"],["section","Users"],[1,"actions"],["title","Refresh",1,"button-on-control",3,"click"],[1,"icon-reload"],["title","New User\u2026",1,"button-on-control",3,"click"],[1,"icon-plus"],[1,"content"],[3,"users"]],template:function(t,e){1&t&&(g.TgZ(0,"div",0),g.TgZ(1,"app-view-header-slim",1),g.TgZ(2,"div",2),g.TgZ(3,"button",3),g.NdJ("click",function(){return e.refresh()}),g._UZ(4,"i",4),g.qZA(),g.TgZ(5,"button",5),g.NdJ("click",function(){return e.newUser()}),g._UZ(6,"i",6),g.qZA(),g.qZA(),g.qZA(),g.TgZ(7,"div",7),g._UZ(8,"app-admin-user-list",8),g.qZA(),g.qZA()),2&t&&(g.xp6(8),g.Q6J("users",e.users))},directives:[ze.p,In],styles:["[_nghost-%COMP%]{height:100%;width:100%;overflow-y:auto;overflow-x:auto;display:block}[_nghost-%COMP%]   .users[_ngcontent-%COMP%]{height:100%;overflow-y:auto;overflow-x:hidden}[_nghost-%COMP%]   .users[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{margin-right:5px;margin-bottom:10px}[_nghost-%COMP%]   .users[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{padding:0 15px 15px}[_nghost-%COMP%]   .users[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{text-transform:uppercase;letter-spacing:1.25px;font-size:13.2px;margin-bottom:10px;color:var(--on-control-ambient)}@media (max-width: 522px){[_nghost-%COMP%]   .users[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{padding-left:10px;padding-right:10px}}"]}),t})(),data:{name:"Users",icon:"icon-user"}},{path:"folder",redirectTo:"folder/"},{path:"folder/:id",component:J,data:{id:"folder",name:"Folders",icon:"icon-folder",link:"folder"},children:[{path:"overview",component:xe},{path:"health",component:Xt},{path:"sub-folders",component:nt},{path:"tracks",component:Ne},{path:"tracks-health",component:Ie},{path:"tags",loadChildren:()=>(0,p.mG)(void 0,void 0,void 0,function*(){return Promise.all([n.e(592),n.e(187)]).then(n.bind(n,4187)).then(t=>t.TagEditorModule)})}]},{path:"radar",component:Ve,data:{name:"Health Radar",icon:"icon-health"}}]}],Sn=u.Bz.forChild(qn);function Un(t,e){if(1&t&&(g.ynx(0),g._uU(1),g.BQk()),2&t){const t=g.oxw(2);g.xp6(1),g.hij("(",t.folderService.current.count,")")}}function Rn(t,e){if(1&t&&(g.TgZ(0,"div",7),g.TgZ(1,"span",3),g._uU(2,"Other requests in queue:"),g.qZA(),g._uU(3),g.qZA()),2&t){const t=g.oxw(2);g.xp6(3),g.hij(" ",t.folderService.queue.length," ")}}function Jn(t,e){if(1&t&&(g.TgZ(0,"div",1),g.TgZ(1,"div",2),g.TgZ(2,"span",3),g._uU(3,"Current:"),g.qZA(),g._UZ(4,"i",4),g._uU(5),g.YNc(6,Un,2,1,"ng-container",5),g.qZA(),g.YNc(7,Rn,4,1,"div",6),g.qZA()),2&t){const t=g.oxw();g.xp6(5),g.hij(" ",t.folderService.current.title," "),g.xp6(1),g.Q6J("ngIf",t.folderService.current.count>1),g.xp6(1),g.Q6J("ngIf",t.folderService.queue.length>0)}}let Qn=(()=>{class t{constructor(t){this.folderService=t}}return t.\u0275fac=function(e){return new(e||t)(g.Y36(C.Cr))},t.\u0275cmp=g.Xpm({type:t,selectors:[["app-admin-queue-requests"]],decls:1,vars:1,consts:[["class","queue-overlay",4,"ngIf"],[1,"queue-overlay"],[1,"current"],[1,"label"],[1,"icon-spin","icon-spinner"],[4,"ngIf"],["class","other",4,"ngIf"],[1,"other"]],template:function(t,e){1&t&&g.YNc(0,Jn,8,3,"div",0),2&t&&g.Q6J("ngIf",e.folderService.current)},directives:[i.O5],styles:["[_nghost-%COMP%]   .queue-overlay[_ngcontent-%COMP%]{position:fixed;right:16px;bottom:16px;padding:15px;background-color:var(--control);color:var(--on-control);border:1px solid var(--control-border);z-index:1000}[_nghost-%COMP%]   .queue-overlay[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{text-transform:uppercase;font-size:.8em;letter-spacing:1px;color:var(--on-control-ambient)}[_nghost-%COMP%]   .queue-overlay[_ngcontent-%COMP%]   .other[_ngcontent-%COMP%]{border-top:1px solid var(--background-border)}"]}),t})();const Nn=function(t){return["/admin",t]};function zn(t,e){if(1&t&&(g.TgZ(0,"a",6),g._UZ(1,"i"),g.TgZ(2,"span"),g._uU(3),g.qZA(),g.qZA()),2&t){const t=e.$implicit;g.Q6J("routerLink",g.VKq(4,Nn,t.id)),g.xp6(1),g.Tol(t.icon),g.xp6(2),g.Oqu(t.text)}}function Fn(t,e){if(1&t&&(g.TgZ(0,"div",4),g.YNc(1,zn,4,6,"a",5),g.qZA()),2&t){const t=g.oxw();g.xp6(1),g.Q6J("ngForOf",t.sections)("ngForTrackBy",t.trackByFn)}}let Hn=(()=>{class t{constructor(t,e){this.app=t,this.router=e,this.collapsed={},this.sections=[],this.showMobileNavig=!1,this.sections=(qn[0].children||[]).filter(t=>{var e;return t.path&&t.path.length>0&&(null===(e=t.data)||void 0===e?void 0:e.name)}).map(t=>({id:t.data&&t.data.link?t.data.link:t.path,text:t.data?t.data.name:"",icon:t.data&&t.data.icon?t.data.icon:"icon-admin"}))}ngOnInit(){this.app.view.currentSidebar=this,this.router.events.forEach(()=>{this.showMobileNavig=!1}).catch(t=>{console.error(t)})}ngOnDestroy(){this.app.view.currentSidebar=void 0}trackByFn(t,e){return e.id}toggleMobileNavig(){this.showMobileNavig=!this.showMobileNavig}}return t.\u0275fac=function(e){return new(e||t)(g.Y36(C.zi),g.Y36(u.F0))},t.\u0275cmp=g.Xpm({type:t,selectors:[["app-admin-sidebar"]],decls:5,vars:5,consts:[[1,"navigation"],[1,"list"],[1,"header",3,"click"],["class","collapse",4,"ngIf"],[1,"collapse"],["class","item","routerLinkActive","active",3,"routerLink",4,"ngFor","ngForOf","ngForTrackBy"],["routerLinkActive","active",1,"item",3,"routerLink"]],template:function(t,e){1&t&&(g.TgZ(0,"section",0),g.TgZ(1,"div",1),g.TgZ(2,"div",2),g.NdJ("click",function(){return e.collapsed.main=!e.collapsed.main}),g._uU(3,"Administration"),g.qZA(),g.YNc(4,Fn,2,2,"div",3),g.qZA(),g.qZA()),2&t&&(g.ekj("show",e.showMobileNavig),g.xp6(1),g.ekj("active",e.collapsed.main),g.xp6(3),g.Q6J("ngIf",!e.collapsed.main))},directives:[i.O5,i.sg,u.yS,u.Od],styles:['@charset "UTF-8";[_nghost-%COMP%]{position:relative;flex:0 1 100%;display:flex;flex-direction:column;height:100%}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]{padding:15px;flex-grow:1;width:100%;overflow-y:auto;overflow-x:hidden;background-color:var(--control);color:var(--on-control)}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]{display:flex;flex-flow:column wrap;margin-bottom:15px}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{color:var(--on-control-ambient);font-size:11px;text-transform:uppercase;letter-spacing:1px;margin-bottom:5px;cursor:pointer;border-right-width:3px;border-right-style:solid;border-right-color:transparent}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]:hover{color:var(--on-control-ambient-hover);border-right-color:var(--primary)}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]:after{font-family:"jam";content:"\\e804";padding-left:4px}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{color:var(--on-control);padding:5px 0;display:flex;flex-flow:row nowrap;align-items:center;border-right-width:3px;border-right-style:solid;border-right-color:transparent;transition:all .1s ease-in-out;transform-origin:left center}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   app-coverart-image[_ngcontent-%COMP%]{margin-right:6px}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{width:25px;display:block}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]:hover{color:var(--on-control-hover);border-right-color:var(--primary)}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .item.active[_ngcontent-%COMP%]{transform:scale(1.1)}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]{margin-top:8px;padding-left:4px}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{color:var(--on-control);font-size:14px;font-weight:bold}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .active[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]:after{content:"\\e807"}@media (max-width: 768px){[_nghost-%COMP%]{height:auto}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]{display:none;position:fixed;z-index:10;max-height:calc(100% - 60px);overflow-y:auto;flex-flow:row wrap;border-bottom:1px solid var(--control-box-border)}[_nghost-%COMP%]   .navigation.show[_ngcontent-%COMP%]{display:flex}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .index-list[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]{flex:1}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{border-right-width:0}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]:after{content:""}}']}),t})();var Yn=n(59766);const Dn=function(t){return["/admin",t]};function En(t,e){if(1&t&&(g.TgZ(0,"div",1),g.TgZ(1,"div",2),g._UZ(2,"app-iconart-image",3),g.qZA(),g.TgZ(3,"div",4),g.TgZ(4,"a",5),g._uU(5),g.qZA(),g.qZA(),g.qZA()),2&t){const t=e.$implicit;g.Q6J("routerLink",g.VKq(3,Dn,t.id)),g.xp6(2),g.Q6J("icon",t.icon),g.xp6(3),g.Oqu(t.text)}}let Bn=(()=>{class t{constructor(){this.sections=[],this.sections=(qn[0].children||[]).filter(t=>{var e;return t.path&&t.path.length>0&&(null===(e=t.data)||void 0===e?void 0:e.name)}).map(t=>({id:t.data&&t.data.link?t.data.link:t.path,text:t.data?t.data.name:"",icon:t.data&&t.data.icon?t.data.icon:"icon-admin"}))}trackByFn(t,e){return e.id}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=g.Xpm({type:t,selectors:[["app-admin-section-cards"]],decls:1,vars:2,consts:[["class","section-card no-hover",3,"routerLink",4,"ngFor","ngForOf","ngForTrackBy"],[1,"section-card","no-hover",3,"routerLink"],[1,"image"],[3,"icon"],[1,"footer"],[1,"footer-content"]],template:function(t,e){1&t&&g.YNc(0,En,6,5,"div",0),2&t&&g.Q6J("ngForOf",e.sections)("ngForTrackBy",e.trackByFn)},directives:[i.sg,u.rH,Yn.B],styles:['[_nghost-%COMP%]{display:flex;flex-flow:row wrap}@media (max-width: 768px){[_nghost-%COMP%]{justify-content:space-around}}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]{margin:15px;width:calc((100% / 4) - 30px);position:relative;overflow:hidden;display:flex;cursor:pointer}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]:before{content:"";display:block;margin-top:100%}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .fav[_ngcontent-%COMP%], [_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]{position:absolute;top:1px;padding:5px;transform:translateY(-31px);transition:transform .3s}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .fav[_ngcontent-%COMP%]{right:1px;border-bottom-left-radius:3px;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;user-select:none}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]{left:1px;font-size:.8em;border-bottom-right-radius:3px}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]{padding:5px;position:absolute;bottom:1px;left:1px;right:1px;overflow:hidden;height:auto}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]   .footer-buttons[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]:hover   .fav[_ngcontent-%COMP%], [_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]:hover   .date[_ngcontent-%COMP%]{transform:translateY(0)}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]:hover   .footer[_ngcontent-%COMP%]   .footer-buttons[_ngcontent-%COMP%]{display:block}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%], [_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%], [_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .fav[_ngcontent-%COMP%]{background-color:var(--background-transparent);color:var(--on-background-active)}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], [_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], [_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .fav[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--on-background-active)}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, [_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, [_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .fav[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:var(--on-background)}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .footer-subline[_ngcontent-%COMP%]{display:block;font-size:.8em}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .footer-buttons[_ngcontent-%COMP%]{height:40px;padding-top:10px;white-space:nowrap}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .footer-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-bottom:5px;margin-right:5px}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .footer-buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{float:right;margin-right:5px}@media (max-width: 1600px){[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]{width:calc((100% / 4) - 30px)}}@media (max-width: 1200px){[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]{width:calc((100% / 3) - 30px)}}@media (max-width: 522px){[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]{width:calc((100% / 2) - 30px)}}@media (max-width: 400px){[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]{margin:10px}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]{font-size:.8em}}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{min-height:135px;min-width:135px;display:flex;align-items:center;justify-content:center}']}),t})(),jn=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=g.oAB({type:t}),t.\u0275inj=g.cJS({providers:[],imports:[[i.ez,l.m,r.u5,s.t6,d.QG,c.vI,o.Cl,a.In,Sn]]}),t})();g.B6R(h,[Hn,w.H,u.lC,Qn],[]),g.B6R(fn,[ze.p,Bn],[])},81515:function(t,e,n){function o(t,e){if(void 0===t&&void 0===e)throw new Error("Trying to compare two undefined values");if(void 0===t||void 0===e)return 0;const n=String(t),o=String(e),i=function(t,e){const n=[];let o,i=0;for(let r=0;r<=e.length;r++)for(let s=0;s<=t.length;s++)o=r&&s?t.charAt(s-1)===e.charAt(r-1)?i:Math.min(n[s],n[s-1],i)+1:r+s,i=n[s],n[s]=o;return n.pop()||0}(n,o);return n.length>o.length?1-i/n.length:1-i/o.length}function i(t,e){const n={};return function(t,e){const n=e||2,o=`-${t.toLowerCase().replace(/[^\w, ]+/,"")}-`,i=[];for(let r=0;r<o.length-n+1;r+=1)i.push(o.slice(r,r+n));return i}(t,e||2).forEach(t=>{t in n?n[t]+=1:n[t]=1}),n}function r(t){if("string"!=typeof t)throw new Error("Must use a string as argument to FuzzySet functions");return t.toLowerCase()}n.d(e,{VI:function(){return l},Cb:function(){return h},C6:function(){return p},U_:function(){return d},kQ:function(){return g},RQ:function(){return a},f_:function(){return c}});class s{constructor(t,e,n,o){this.version="0.0.1",this.exactSet={},this.matchDict={},this.items={},this.arr=t||[],this.useLevenshtein=e||!0,this.gramSizeLower=n||2,this.gramSizeUpper=o||3;for(let i=this.gramSizeLower;i<this.gramSizeUpper+1;i+=1)this.items[i]=[];this.arr.forEach(t=>{this.add(t)})}get(t,e){const n=this.getVal(t);return!n&&e?e:n}add(t){if(!(r(t)in this.exactSet))for(let e=this.gramSizeLower;e<this.gramSizeUpper+1;e+=1)this.addVal(t,e)}length(){let t=0;for(const e in this.exactSet)Object.prototype.hasOwnProperty.call(this.exactSet,e)&&(t+=1);return t}isEmpty(){for(const t in this.exactSet)if(Object.prototype.hasOwnProperty.call(this.exactSet,t))return!1;return!0}values(){const t=[];for(const e in this.exactSet)Object.prototype.hasOwnProperty.call(this.exactSet,e)&&t.push(this.exactSet[e]);return t}getVal(t){const e=r(t),n=this.exactSet[e];if(n)return[[1,n]];for(let o=this.gramSizeUpper;o>=this.gramSizeLower;o-=1){const e=this.getValGram(t,o);if(e)return e}}getValGram(t,e){const n=r(t),s={},a=i(n,e),c=this.items[e];let l,d=0;for(const o in a)if(Object.prototype.hasOwnProperty.call(a,o)){const t=a[o];if(d+=Math.pow(t,2),o in this.matchDict)for(const e of this.matchDict[o]){const n=e[0];l=e[1],n in s?s[n]+=t*l:s[n]=t*l}}if(function(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}(s))return;const g=Math.sqrt(d);let h,p=[];Object.keys(s).forEach(t=>{h=s[t];const e=parseInt(t,10);p.push([h/(g*c[e][0]),c[e][1]])});const u=(t,e)=>t[0]<e[0]?1:t[0]>e[0]?-1:0;if(p.sort(u),this.useLevenshtein){const t=[],e=Math.min(50,p.length);for(let i=0;i<e;i+=1)t.push([o(p[i][1],n),p[i][1]]);p=t,p.sort(u)}const f=[];for(const o of p)o[0]===p[0][0]&&f.push([o[0],this.exactSet[o[1]]]);return f}addVal(t,e){const n=r(t),o=this.items[e]||[],s=o.length;o.push(0);const a=i(n,e);let c=0;for(const i in a)if(Object.prototype.hasOwnProperty.call(a,i)){const t=a[i];c+=Math.pow(t,2),i in this.matchDict?this.matchDict[i].push([s,t]):this.matchDict[i]=[[s,t]]}const l=Math.sqrt(c);o[s]=[l,n],this.items[e]=o,this.exactSet[n]=t}}function a(t){return t.split(/[.,\\/ -]/).map(t=>t.trim()).filter(t=>t.length>0)}function c(t){return t.replace(/\.[^/.]+$/,"")}function l(t){return t.substring(t.lastIndexOf(".")+1,t.length)||t}function d(t,e){return e.includes(l(t))}function g(t,e){return t.toString().replace(/:/g," - ").replace(/[?/!\\]/g,e)}function h(t){if(!t)return 0;const e=c(t).split(/[ \-_.:;?!~,`"&|()<>{}[\]\r\n/\\]+/).map(Number).filter(t=>!isNaN(t));return e.length>0?e[0]:0}function p(t,e){const n=new s;n.add(t);const o=n.get(e);return o?o[0][0]:0}},22689:function(t,e,n){function o(t){let e="";const n=new Uint8Array(t),o=n.byteLength;for(let i=0;i<o;i++)e+=String.fromCharCode(n[i]);return window.btoa(e)}n.d(e,{q:function(){return o}})}}]);