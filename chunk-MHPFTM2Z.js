import{b as ii}from"./chunk-T2QKBMPN.js";import{G as ti}from"./chunk-ZVKVGF76.js";import{$d as _e,Ld as ei,Sd as Qe,Td as be,Y as vt,c as ci,d as pi,da as de,e as U,ia as z,k as zt,ub as Jt,vb as Xt}from"./chunk-H2EXZDP6.js";var oi=ci((Ii,Se)=>{"use strict";(function(f,h){"use strict";if(!f||!f.document)throw new Error("SoundManager requires a browser with window and document objects.");var s=null;function d(S,A){this.setupOptions={url:S||null,flashVersion:8,debugMode:!0,debugFlash:!1,useConsole:!0,consoleOnly:!0,waitForWindowLoad:!1,bgColor:"#ffffff",useHighPerformance:!1,flashPollingInterval:null,html5PollingInterval:null,flashLoadTimeout:1e3,wmode:null,allowScriptAccess:"always",useFlashBlock:!1,useHTML5Audio:!0,forceUseGlobalHTML5Audio:!1,ignoreMobileRestrictions:!1,html5Test:/^(probably|maybe)$/i,preferFlash:!1,noSWFCache:!1,idPrefix:"sound"},this.defaultOptions={autoLoad:!1,autoPlay:!1,from:null,loops:1,onid3:null,onerror:null,onload:null,whileloading:null,onplay:null,onpause:null,onresume:null,whileplaying:null,onposition:null,onstop:null,onfinish:null,multiShot:!0,multiShotEvents:!1,position:null,pan:0,playbackRate:1,stream:!0,to:null,type:null,usePolicyFile:!1,volume:100},this.flash9Options={onfailure:null,isMovieStar:null,usePeakData:!1,useWaveformData:!1,useEQData:!1,onbufferchange:null,ondataerror:null},this.movieStarOptions={bufferTime:3,serverURL:null,onconnect:null,duration:null},this.audioFormats={mp3:{type:['audio/mpeg; codecs="mp3"',"audio/mpeg","audio/mp3","audio/MPA","audio/mpa-robust"],required:!0},mp4:{related:["aac","m4a","m4b"],type:['audio/mp4; codecs="mp4a.40.2"',"audio/aac","audio/x-m4a","audio/MP4A-LATM","audio/mpeg4-generic"],required:!1},ogg:{type:["audio/ogg; codecs=vorbis"],required:!1},opus:{type:["audio/ogg; codecs=opus","audio/opus"],required:!1},wav:{type:['audio/wav; codecs="1"',"audio/wav","audio/wave","audio/x-wav"],required:!1},flac:{type:["audio/flac"],required:!1}},this.movieID="sm2-container",this.id=A||"sm2movie",this.debugID="soundmanager-debug",this.debugURLParam=/([#?&])debug=1/i,this.versionNumber="V2.97a.20170601",this.version=null,this.movieURL=null,this.altURL=null,this.swfLoaded=!1,this.enabled=!1,this.oMC=null,this.sounds={},this.soundIDs=[],this.muted=!1,this.didFlashBlock=!1,this.filePattern=null,this.filePatterns={flash8:/\.mp3(\?.*)?$/i,flash9:/\.mp3(\?.*)?$/i},this.features={buffering:!1,peakData:!1,waveformData:!1,eqData:!1,movieStar:!1},this.sandbox={type:null,types:{remote:"remote (domain-based) rules",localWithFile:"local with file access (no internet access)",localWithNetwork:"local with network (internet access only, no local access)",localTrusted:"local, trusted (local+internet access)"},description:null,noRemote:null,noLocal:null},this.html5={usingFlash:null},this.flash={},this.html5Only=!1,this.ignoreFlash=!1;var j,t=this,Lt=null,T=null,O="soundManager",E=O+": ",ri="HTML5::",te,C=navigator.userAgent,Ee=f.location.href.toString(),w=document,$e,Dt,ze,M,se=[],Je=!0,J,Te=!1,we=!1,R=!1,V=!1,ke=!1,v,li=0,Me,q,Xe,At,et,fe,pe,me,Ft,tt,it,st,X,Re,he,at,Oe,xe,He,ge,It,nt,Et=["log","info","warn","error"],kt=8,ot,rt,Rt,ve=null,lt=null,P,ut,ye,Y,xt,Ne,Ce,oe,I,Pe=!1,dt=!1,Ht,Nt,Ct,Ue=0,Le=null,je,re=[],De,K=null,Ut,qe,Ae,jt,le,We,ft,qt,N,Wt=Array.prototype.slice,G=!1,ht,ae,ct,Bt,ne,Vt,pt,Fe,Kt=0,mt,W=1e3,gt=C.match(/(ipad|iphone|ipod)/i),yt=C.match(/android/i),ue=C.match(/msie|trident/i),ui=C.match(/webkit/i),Be=C.match(/safari/i)&&!C.match(/chrome/i),bt=C.match(/opera/i),Ve=C.match(/(mobile|pre\/|xoom)/i)||gt||yt,_t=!Ee.match(/usehtml5audio/i)&&!Ee.match(/sm2-ignorebadua/i)&&Be&&!C.match(/silk/i)&&C.match(/OS\sX\s10_6_([3-7])/i),St=f.console!==h&&console.log!==h,Tt=w.hasFocus!==h?w.hasFocus():null,Ke=Be&&(w.hasFocus===h||!w.hasFocus()),Gt=!Ke,Qt=/(mp3|mp4|mpa|m4a|m4b)/i,wt="about:blank",di="data:audio/wave;base64,/UklGRiYAAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQIAAAD//w==",Ie=w.location?w.location.protocol.match(/http/i):null,fi=Ie?"":"//",Yt=/^\s*audio\/(?:x-)?(?:mpeg4|aac|flv|mov|mp4|m4v|m4a|m4b|mp4v|3gp|3g2)\s*(?:$|;)/i,Zt=["mpeg4","aac","flv","mov","mp4","m4v","f4v","m4a","m4b","mp4v","3gp","3g2"],hi=new RegExp("\\.("+Zt.join("|")+")(\\?.*)?$","i");this.mimePattern=/^\s*audio\/(?:x-)?(?:mp(?:eg|3))\s*(?:$|;)/i,this.useAltURL=!Ie,Y={swfBox:"sm2-object-box",swfDefault:"movieContainer",swfError:"swf_error",swfTimedout:"swf_timedout",swfLoaded:"swf_loaded",swfUnblocked:"swf_unblocked",sm2Debug:"sm2_debug",highPerf:"high_performance",flashDebug:"flash_debug"},jt=[null,"MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED"],this.hasHTML5=(function(){try{return Audio!==h&&(bt&&opera!==h&&opera.version()<10?new Audio(null):new Audio).canPlayType!==h}catch{return!1}})(),this.setup=function(i){var e=!t.url;return i!==h&&R&&K&&t.ok()&&(i.flashVersion!==h||i.url!==h||i.html5Test!==h)&&oe(P("setupLate")),Xe(i),G||(Ve?(!t.setupOptions.ignoreMobileRestrictions||t.setupOptions.forceUseGlobalHTML5Audio)&&(re.push(X.globalHTML5),G=!0):t.setupOptions.forceUseGlobalHTML5Audio&&(re.push(X.globalHTML5),G=!0)),!mt&&Ve&&(t.setupOptions.ignoreMobileRestrictions?re.push(X.ignoreMobile):((!t.setupOptions.useHTML5Audio||t.setupOptions.preferFlash)&&t._wD(X.mobileUA),t.setupOptions.useHTML5Audio=!0,t.setupOptions.preferFlash=!1,gt?t.ignoreFlash=!0:(yt&&!C.match(/android\s2\.3/i)||!yt)&&(t._wD(X.globalHTML5),G=!0))),i&&(e&&Oe&&i.url!==h&&t.beginDelayedInit(),!Oe&&i.url!==h&&w.readyState==="complete"&&setTimeout(he,1)),mt=!0,t},this.ok=function(){return K?R&&!V:t.useHTML5Audio&&t.hasHTML5},this.supported=this.ok,this.getMovie=function(i){return te(i)||w[i]||f[i]},this.createSound=function(i,e){var a,l,o,p=null;if(a=O+".createSound(): ",l=a+P(R?"notOK":"notReady"),!R||!t.ok())return oe(l),!1;if(e!==h&&(i={id:i,url:e}),o=q(i),o.url=je(o.url),o.id===h&&(o.id=t.setupOptions.idPrefix+Kt++),o.id.toString().charAt(0).match(/^[0-9]$/)&&t._wD(a+P("badID",o.id),2),t._wD(a+o.id+(o.url?" ("+o.url+")":""),1),I(o.id,!0))return t._wD(a+o.id+" exists",1),t.sounds[o.id];function y(){return o=Ne(o),t.sounds[o.id]=new j(o),t.soundIDs.push(o.id),t.sounds[o.id]}if(qe(o))p=y(),t.html5Only||t._wD(o.id+": Using HTML5"),p._setup_html5(o);else{if(t.html5Only)return t._wD(o.id+": No HTML5 support for this sound, and no Flash. Exiting."),y();if(t.html5.usingFlash&&o.url&&o.url.match(/data:/i))return t._wD(o.id+": data: URIs not supported via Flash. Exiting."),y();M>8&&(o.isMovieStar===null&&(o.isMovieStar=!!(o.serverURL||o.type&&o.type.match(Yt)||o.url&&o.url.match(hi))),o.isMovieStar&&(t._wD(a+"using MovieStar handling"),o.loops>1&&v("noNSLoop"))),o=Ce(o,a),p=y(),M===8?T._createSound(o.id,o.loops||1,o.usePolicyFile):(T._createSound(o.id,o.url,o.usePeakData,o.useWaveformData,o.useEQData,o.isMovieStar,o.isMovieStar?o.bufferTime:!1,o.loops||1,o.serverURL,o.duration||null,o.autoPlay,!0,o.autoLoad,o.usePolicyFile),o.serverURL||(p.connected=!0,o.onconnect&&o.onconnect.apply(p))),!o.serverURL&&(o.autoLoad||o.autoPlay)&&p.load(o)}return!o.serverURL&&o.autoPlay&&p.play(),p},this.destroySound=function(i,e){if(!I(i))return!1;var a=t.sounds[i],l;for(a.stop(),a._iO={},a.unload(),l=0;l<t.soundIDs.length;l++)if(t.soundIDs[l]===i){t.soundIDs.splice(l,1);break}return e||a.destruct(!0),a=null,delete t.sounds[i],!0},this.load=function(i,e){return I(i)?t.sounds[i].load(e):!1},this.unload=function(i){return I(i)?t.sounds[i].unload():!1},this.onPosition=function(i,e,a,l){return I(i)?t.sounds[i].onposition(e,a,l):!1},this.onposition=this.onPosition,this.clearOnPosition=function(i,e,a){return I(i)?t.sounds[i].clearOnPosition(e,a):!1},this.play=function(i,e){var a=null,l=e&&!(e instanceof Object);if(!R||!t.ok())return oe(O+".play(): "+P(R?"notOK":"notReady")),!1;if(I(i,l))l&&(e={url:e});else{if(!l)return!1;l&&(e={url:e}),e&&e.url&&(t._wD(O+'.play(): Attempting to create "'+i+'"',1),e.id=i,a=t.createSound(e).play())}return a===null&&(a=t.sounds[i].play(e)),a},this.start=this.play,this.setPlaybackRate=function(i,e,a){return I(i)?t.sounds[i].setPlaybackRate(e,a):!1},this.setPosition=function(i,e){return I(i)?t.sounds[i].setPosition(e):!1},this.stop=function(i){return I(i)?(t._wD(O+".stop("+i+")",1),t.sounds[i].stop()):!1},this.stopAll=function(){var i;t._wD(O+".stopAll()",1);for(i in t.sounds)t.sounds.hasOwnProperty(i)&&t.sounds[i].stop()},this.pause=function(i){return I(i)?t.sounds[i].pause():!1},this.pauseAll=function(){var i;for(i=t.soundIDs.length-1;i>=0;i--)t.sounds[t.soundIDs[i]].pause()},this.resume=function(i){return I(i)?t.sounds[i].resume():!1},this.resumeAll=function(){var i;for(i=t.soundIDs.length-1;i>=0;i--)t.sounds[t.soundIDs[i]].resume()},this.togglePause=function(i){return I(i)?t.sounds[i].togglePause():!1},this.setPan=function(i,e){return I(i)?t.sounds[i].setPan(e):!1},this.setVolume=function(i,e){var a,l;if(i!==h&&!isNaN(i)&&e===h){for(a=0,l=t.soundIDs.length;a<l;a++)t.sounds[t.soundIDs[a]].setVolume(i);return!1}return I(i)?t.sounds[i].setVolume(e):!1},this.mute=function(i){var e=0;if(i instanceof String&&(i=null),i)return I(i)?(t._wD(O+'.mute(): Muting "'+i+'"'),t.sounds[i].mute()):!1;for(t._wD(O+".mute(): Muting all sounds"),e=t.soundIDs.length-1;e>=0;e--)t.sounds[t.soundIDs[e]].mute();return t.muted=!0,!0},this.muteAll=function(){t.mute()},this.unmute=function(i){var e;if(i instanceof String&&(i=null),i)return I(i)?(t._wD(O+'.unmute(): Unmuting "'+i+'"'),t.sounds[i].unmute()):!1;for(t._wD(O+".unmute(): Unmuting all sounds"),e=t.soundIDs.length-1;e>=0;e--)t.sounds[t.soundIDs[e]].unmute();return t.muted=!1,!0},this.unmuteAll=function(){t.unmute()},this.toggleMute=function(i){return I(i)?t.sounds[i].toggleMute():!1},this.getMemoryUse=function(){var i=0;return T&&M!==8&&(i=parseInt(T._getMemoryUse(),10)),i},this.disable=function(i){var e;if(i===h&&(i=!1),V)return!1;for(V=!0,v("shutdown",1),e=t.soundIDs.length-1;e>=0;e--)ot(t.sounds[t.soundIDs[e]]);return ot(t),Me(i),N.remove(f,"load",pe),!0},this.canPlayMIME=function(i){var e;return t.hasHTML5&&(e=Ae({type:i})),!e&&K&&(e=i&&t.ok()?!!(M>8&&i.match(Yt)||i.match(t.mimePattern)):null),e},this.canPlayURL=function(i){var e;return t.hasHTML5&&(e=Ae({url:i})),!e&&K&&(e=i&&t.ok()?!!i.match(t.filePattern):null),e},this.canPlayLink=function(i){return i.type!==h&&i.type&&t.canPlayMIME(i.type)?!0:t.canPlayURL(i.href)},this.getSoundById=function(i,e){if(!i)return null;var a=t.sounds[i];return!a&&!e&&t._wD(O+'.getSoundById(): Sound "'+i+'" not found.',2),a},this.onready=function(i,e){var a="onready",l=!1;if(typeof i=="function")R&&t._wD(P("queue",a)),e||(e=f),et(a,i,e),fe(),l=!0;else throw P("needFunction",a);return l},this.ontimeout=function(i,e){var a="ontimeout",l=!1;if(typeof i=="function")R&&t._wD(P("queue",a)),e||(e=f),et(a,i,e),fe({type:a}),l=!0;else throw P("needFunction",a);return l},this._writeDebug=function(i,e){var a="soundmanager-debug",l,o;return t.setupOptions.debugMode?St&&t.useConsole&&(e&&typeof e=="object"?console.log(i,e):Et[e]!==h?console[Et[e]](i):console.log(i),t.consoleOnly)?!0:(l=te(a),l?(o=w.createElement("div"),++li%2===0&&(o.className="sm2-alt"),e===h?e=0:e=parseInt(e,10),o.appendChild(w.createTextNode(i)),e&&(e>=2&&(o.style.fontWeight="bold"),e===3&&(o.style.color="#ff3333")),l.insertBefore(o,l.firstChild),l=null,!0):!1):!1},Ee.indexOf("sm2-debug=alert")!==-1&&(this._writeDebug=function(i){f.alert(i)}),this._wD=this._writeDebug,this._debug=function(){var i,e;for(v("currentObj",1),i=0,e=t.soundIDs.length;i<e;i++)t.sounds[t.soundIDs[i]]._debug()},this.reboot=function(i,e){t.soundIDs.length&&t._wD("Destroying "+t.soundIDs.length+" SMSound object"+(t.soundIDs.length!==1?"s":"")+"...");var a,l,o;for(a=t.soundIDs.length-1;a>=0;a--)t.sounds[t.soundIDs[a]].destruct();if(T)try{ue&&(lt=T.innerHTML),ve=T.parentNode.removeChild(T)}catch{v("badRemove",2)}if(lt=ve=K=T=null,t.enabled=Oe=R=Pe=dt=Te=we=V=G=t.swfLoaded=!1,t.soundIDs=[],t.sounds={},Kt=0,mt=!1,i)se=[];else for(a in se)if(se.hasOwnProperty(a))for(l=0,o=se[a].length;l<o;l++)se[a][l].fired=!1;return e||t._wD(O+": Rebooting..."),t.html5={usingFlash:null},t.flash={},t.html5Only=!1,t.ignoreFlash=!1,f.setTimeout(function(){e||t.beginDelayedInit()},20),t},this.reset=function(){return v("reset"),t.reboot(!0,!0)},this.getMoviePercent=function(){return T&&"PercentLoaded"in T?T.PercentLoaded():null},this.beginDelayedInit=function(){ke=!0,he(),setTimeout(function(){return dt?!1:(He(),Re(),dt=!0,!0)},20),me()},this.destruct=function(){t._wD(O+".destruct()"),t.disable(!0)},j=function(i){var e=this,a,l,o,p,y,_,L=!1,D=[],F=0,Z,ce,ee=null,Q,$;Q={duration:null,time:null},this.id=i.id,this.sID=this.id,this.url=i.url,this.options=q(i),this.instanceOptions=this.options,this._iO=this.instanceOptions,this.pan=this.options.pan,this.volume=this.options.volume,this.isHTML5=!1,this._a=null,$=!this.url,this.id3={},this._debug=function(){t._wD(e.id+": Merged options:",e.options)},this.load=function(n){var u=null,r;if(n!==h?e._iO=q(n,e.options):(n=e.options,e._iO=n,ee&&ee!==e.url&&(v("manURL"),e._iO.url=e.url,e.url=null)),e._iO.url||(e._iO.url=e.url),e._iO.url=je(e._iO.url),e.instanceOptions=e._iO,r=e._iO,t._wD(e.id+": load ("+r.url+")"),!r.url&&!e.url)return t._wD(e.id+": load(): url is unassigned. Exiting.",2),e;if(!e.isHTML5&&M===8&&!e.url&&!r.autoPlay&&t._wD(e.id+": Flash 8 load() limitation: Wait for onload() before calling play().",1),r.url===e.url&&e.readyState!==0&&e.readyState!==2)return v("onURL",1),e.readyState===3&&r.onload&&Fe(e,function(){r.onload.apply(e,[!!e.duration])}),e;if(e.loaded=!1,e.readyState=1,e.playState=0,e.id3={},qe(r))u=e._setup_html5(r),u._called_load?t._wD(e.id+": Ignoring request to load again"):(e._html5_canplay=!1,e.url!==r.url&&(t._wD(v("manURL")+": "+r.url),e._a.src=r.url,e.setPosition(0)),e._a.autobuffer="auto",e._a.preload="auto",e._a._called_load=!0);else{if(t.html5Only)return t._wD(e.id+": No flash support. Exiting."),e;if(e._iO.url&&e._iO.url.match(/data:/i))return t._wD(e.id+": data: URIs not supported via Flash. Exiting."),e;try{e.isHTML5=!1,e._iO=Ce(Ne(r)),e._iO.autoPlay&&(e._iO.position||e._iO.from)&&(t._wD(e.id+": Disabling autoPlay because of non-zero offset case"),e._iO.autoPlay=!1),r=e._iO,M===8?T._load(e.id,r.url,r.stream,r.autoPlay,r.usePolicyFile):T._load(e.id,r.url,!!r.stream,!!r.autoPlay,r.loops||1,!!r.autoLoad,r.usePolicyFile)}catch{v("smError",2),J("onload",!1),ge({type:"SMSOUND_LOAD_JS_EXCEPTION",fatal:!0})}}return e.url=r.url,e},this.unload=function(){return e.readyState!==0&&(t._wD(e.id+": unload()"),e.isHTML5?(p(),e._a&&(e._a.pause(),ee=We(e._a))):M===8?T._unload(e.id,wt):T._unload(e.id),a()),e},this.destruct=function(n){t._wD(e.id+": Destruct"),e.isHTML5?(p(),e._a&&(e._a.pause(),We(e._a),G||o(),e._a._s=null,e._a=null)):(e._iO.onfailure=null,T._destroySound(e.id)),n||t.destroySound(e.id,!0)},this.play=function(n,u){var r,m,b,B,k,Mt,Ot,$t=!0;if(r=e.id+": play(): ",u=u===h?!0:u,n||(n={}),e.url&&(e._iO.url=e.url),e._iO=q(e._iO,e.options),e._iO=q(n,e._iO),e._iO.url=je(e._iO.url),e.instanceOptions=e._iO,!e.isHTML5&&e._iO.serverURL&&!e.connected)return e.getAutoPlay()||(t._wD(r+" Netstream not connected yet - setting autoPlay"),e.setAutoPlay(!0)),e;if(qe(e._iO)&&(e._setup_html5(e._iO),y()),e.playState===1&&!e.paused){if(m=e._iO.multiShot,!m)return t._wD(r+"Already playing (one-shot)",1),e.isHTML5&&e.setPosition(e._iO.position),e;t._wD(r+"Already playing (multi-shot)",1)}if(n.url&&n.url!==e.url&&(!e.readyState&&!e.isHTML5&&M===8&&$?$=!1:e.load(e._iO)),e.loaded)t._wD(r.substr(0,r.lastIndexOf(":")));else if(e.readyState===0){if(t._wD(r+"Attempting to load"),!e.isHTML5&&!t.html5Only)e._iO.autoPlay=!0,e.load(e._iO);else if(e.isHTML5)e.load(e._iO);else return t._wD(r+"Unsupported type. Exiting."),e;e.instanceOptions=e._iO}else{if(e.readyState===2)return t._wD(r+"Could not load - exiting",2),e;t._wD(r+"Loading - attempting to play...")}return!e.isHTML5&&M===9&&e.position>0&&e.position===e.duration&&(t._wD(r+"Sound at end, resetting to position: 0"),n.position=0),e.paused&&e.position>=0&&(!e._iO.serverURL||e.position>0)?(t._wD(r+"Resuming from paused state",1),e.resume()):(e._iO=q(n,e._iO),(!e.isHTML5&&e._iO.position!==null&&e._iO.position>0||e._iO.from!==null&&e._iO.from>0||e._iO.to!==null)&&e.instanceCount===0&&e.playState===0&&!e._iO.serverURL&&(B=function(){e._iO=q(n,e._iO),e.play(e._iO)},e.isHTML5&&!e._html5_canplay?(t._wD(r+"Beginning load for non-zero offset case"),e.load({_oncanplay:B})):!e.isHTML5&&!e.loaded&&(!e.readyState||e.readyState!==2)&&(t._wD(r+"Preloading for non-zero offset case"),e.load({onload:B})),e._iO=ce()),(!e.instanceCount||e._iO.multiShotEvents||e.isHTML5&&e._iO.multiShot&&!G||!e.isHTML5&&M>8&&!e.getAutoPlay())&&e.instanceCount++,e._iO.onposition&&e.playState===0&&_(e),e.playState=1,e.paused=!1,e.position=e._iO.position!==h&&!isNaN(e._iO.position)?e._iO.position:0,e.isHTML5||(e._iO=Ce(Ne(e._iO))),e._iO.onplay&&u&&(e._iO.onplay.apply(e),L=!0),e.setVolume(e._iO.volume,!0),e.setPan(e._iO.pan,!0),e._iO.playbackRate!==1&&e.setPlaybackRate(e._iO.playbackRate),e.isHTML5?e.instanceCount<2?(y(),b=e._setup_html5(),e.setPosition(e._iO.position),b.play()):(t._wD(e.id+": Cloning Audio() for instance #"+e.instanceCount+"..."),k=new Audio(e._iO.url),Mt=function(){N.remove(k,"ended",Mt),e._onfinish(e),We(k),k=null},Ot=function(){N.remove(k,"canplay",Ot);try{k.currentTime=e._iO.position/W}catch{oe(e.id+": multiShot play() failed to apply position of "+e._iO.position/W)}k.play()},N.add(k,"ended",Mt),e._iO.volume!==h&&(k.volume=Math.max(0,Math.min(1,e._iO.volume/100))),e.muted&&(k.muted=!0),e._iO.position?N.add(k,"canplay",Ot):k.play()):($t=T._start(e.id,e._iO.loops||1,M===9?e.position:e.position/W,e._iO.multiShot||!1),M===9&&!$t&&(t._wD(r+"No sound hardware, or 32-sound ceiling hit",2),e._iO.onplayerror&&e._iO.onplayerror.apply(e)))),e},this.start=this.play,this.stop=function(n){var u=e._iO,r;return e.playState===1&&(t._wD(e.id+": stop()"),e._onbufferchange(0),e._resetOnPosition(0),e.paused=!1,e.isHTML5||(e.playState=0),Z(),u.to&&e.clearOnPosition(u.to),e.isHTML5?e._a&&(r=e.position,e.setPosition(0),e.position=r,e._a.pause(),e.playState=0,e._onTimer(),p()):(T._stop(e.id,n),u.serverURL&&e.unload()),e.instanceCount=0,e._iO={},u.onstop&&u.onstop.apply(e)),e},this.setAutoPlay=function(n){t._wD(e.id+": Autoplay turned "+(n?"on":"off")),e._iO.autoPlay=n,e.isHTML5||(T._setAutoPlay(e.id,n),n&&!e.instanceCount&&e.readyState===1&&(e.instanceCount++,t._wD(e.id+": Incremented instance count to "+e.instanceCount)))},this.getAutoPlay=function(){return e._iO.autoPlay},this.setPlaybackRate=function(n){var u=Math.max(.5,Math.min(4,n));if(u!==n&&t._wD(e.id+": setPlaybackRate("+n+"): limiting rate to "+u,2),e.isHTML5)try{e._iO.playbackRate=u,e._a.playbackRate=u}catch(r){t._wD(e.id+": setPlaybackRate("+u+") failed: "+r.message,2)}return e},this.setPosition=function(n){n===h&&(n=0);var u,r,m=e.isHTML5?Math.max(n,0):Math.min(e.duration||e._iO.duration,Math.max(n,0));if(e.position=m,r=e.position/W,e._resetOnPosition(e.position),e._iO.position=m,!e.isHTML5)u=M===9?e.position:r,e.readyState&&e.readyState!==2&&T._setPosition(e.id,u,e.paused||!e.playState,e._iO.multiShot);else if(e._a){if(e._html5_canplay){if(e._a.currentTime.toFixed(3)!==r.toFixed(3)){t._wD(e.id+": setPosition("+r+")");try{e._a.currentTime=r,(e.playState===0||e.paused)&&e._a.pause()}catch(b){t._wD(e.id+": setPosition("+r+") failed: "+b.message,2)}}}else if(r)return t._wD(e.id+": setPosition("+r+"): Cannot seek yet, sound not ready",2),e;e.paused&&e._onTimer(!0)}return e},this.pause=function(n){return e.paused||e.playState===0&&e.readyState!==1||(t._wD(e.id+": pause()"),e.paused=!0,e.isHTML5?(e._setup_html5().pause(),p()):(n||n===h)&&T._pause(e.id,e._iO.multiShot),e._iO.onpause&&e._iO.onpause.apply(e)),e},this.resume=function(){var n=e._iO;return e.paused&&(t._wD(e.id+": resume()"),e.paused=!1,e.playState=1,e.isHTML5?(e._setup_html5().play(),y()):(n.isMovieStar&&!n.serverURL&&e.setPosition(e.position),T._pause(e.id,n.multiShot)),!L&&n.onplay?(n.onplay.apply(e),L=!0):n.onresume&&n.onresume.apply(e)),e},this.togglePause=function(){return t._wD(e.id+": togglePause()"),e.playState===0?(e.play({position:M===9&&!e.isHTML5?e.position:e.position/W}),e):(e.paused?e.resume():e.pause(),e)},this.setPan=function(n,u){return n===h&&(n=0),u===h&&(u=!1),e.isHTML5||T._setPan(e.id,n),e._iO.pan=n,u||(e.pan=n,e.options.pan=n),e},this.setVolume=function(n,u){return n===h&&(n=100),u===h&&(u=!1),e.isHTML5?e._a&&(t.muted&&!e.muted&&(e.muted=!0,e._a.muted=!0),e._a.volume=Math.max(0,Math.min(1,n/100))):T._setVolume(e.id,t.muted&&!e.muted||e.muted?0:n),e._iO.volume=n,u||(e.volume=n,e.options.volume=n),e},this.mute=function(){return e.muted=!0,e.isHTML5?e._a&&(e._a.muted=!0):T._setVolume(e.id,0),e},this.unmute=function(){e.muted=!1;var n=e._iO.volume!==h;return e.isHTML5?e._a&&(e._a.muted=!1):T._setVolume(e.id,n?e._iO.volume:e.options.volume),e},this.toggleMute=function(){return e.muted?e.unmute():e.mute()},this.onPosition=function(n,u,r){return D.push({position:parseInt(n,10),method:u,scope:r!==h?r:e,fired:!1}),e},this.onposition=this.onPosition,this.clearOnPosition=function(n,u){var r;if(n=parseInt(n,10),!isNaN(n))for(r=0;r<D.length;r++)n===D[r].position&&(!u||u===D[r].method)&&(D[r].fired&&F--,D.splice(r,1))},this._processOnPosition=function(){var n,u,r=D.length;if(!r||!e.playState||F>=r)return!1;for(n=r-1;n>=0;n--)u=D[n],!u.fired&&e.position>=u.position&&(u.fired=!0,F++,u.method.apply(u.scope,[u.position]),r=D.length);return!0},this._resetOnPosition=function(n){var u,r,m=D.length;if(!m)return!1;for(u=m-1;u>=0;u--)r=D[u],r.fired&&n<=r.position&&(r.fired=!1,F--);return!0},ce=function(){var n=e._iO,u=n.from,r=n.to,m,b;return b=function(){t._wD(e.id+': "To" time of '+r+" reached."),e.clearOnPosition(r,b),e.stop()},m=function(){t._wD(e.id+': Playing "from" '+u),r!==null&&!isNaN(r)&&e.onPosition(r,b)},u!==null&&!isNaN(u)&&(n.position=u,n.multiShot=!1,m()),n},_=function(){var n,u=e._iO.onposition;if(u)for(n in u)u.hasOwnProperty(n)&&e.onPosition(parseInt(n,10),u[n])},Z=function(){var n,u=e._iO.onposition;if(u)for(n in u)u.hasOwnProperty(n)&&e.clearOnPosition(parseInt(n,10))},y=function(){e.isHTML5&&Ht(e)},p=function(){e.isHTML5&&Nt(e)},a=function(n){n||(D=[],F=0),L=!1,e._hasTimer=null,e._a=null,e._html5_canplay=!1,e.bytesLoaded=null,e.bytesTotal=null,e.duration=e._iO&&e._iO.duration?e._iO.duration:null,e.durationEstimate=null,e.buffered=[],e.eqData=[],e.eqData.left=[],e.eqData.right=[],e.failures=0,e.isBuffering=!1,e.instanceOptions={},e.instanceCount=0,e.loaded=!1,e.metadata={},e.readyState=0,e.muted=!1,e.paused=!1,e.peakData={left:0,right:0},e.waveformData={left:[],right:[]},e.playState=0,e.position=null,e.id3={}},a(),this._onTimer=function(n){var u,r=!1,m,b={};return(e._hasTimer||n)&&e._a&&(n||(e.playState>0||e.readyState===1)&&!e.paused)&&(u=e._get_html5_duration(),u!==Q.duration&&(Q.duration=u,e.duration=u,r=!0),e.durationEstimate=e.duration,m=e._a.currentTime*W||0,m!==Q.time&&(Q.time=m,r=!0),(r||n)&&e._whileplaying(m,b,b,b,b)),r},this._get_html5_duration=function(){var n=e._iO,u=e._a&&e._a.duration?e._a.duration*W:n&&n.duration?n.duration:null,r=u&&!isNaN(u)&&u!==1/0?u:null;return r},this._apply_loop=function(n,u){!n.loop&&u>1&&t._wD("Note: Native HTML5 looping is infinite.",1),n.loop=u>1?"loop":""},this._setup_html5=function(n){var u=q(e._iO,n),r=G?Lt:e._a,m=decodeURI(u.url),b;if(G?m===decodeURI(ht)&&(b=!0):m===decodeURI(ee)&&(b=!0),r){if(r._s){if(G)r._s&&r._s.playState&&!b&&r._s.stop();else if(!G&&m===decodeURI(ee))return e._apply_loop(r,u.loops),r}b||(ee&&a(!1),r.src=u.url,e.url=u.url,ee=u.url,ht=u.url,r._called_load=!1)}else u.autoLoad||u.autoPlay?(e._a=new Audio(u.url),e._a.load()):e._a=bt&&opera.version()<10?new Audio(null):new Audio,r=e._a,r._called_load=!1,G&&(Lt=r);return e.isHTML5=!0,e._a=r,r._s=e,l(),e._apply_loop(r,u.loops),u.autoLoad||u.autoPlay?e.load():(r.autobuffer=!1,r.preload="auto"),r},l=function(){if(e._a._added_events)return!1;var n;function u(r,m,b){return e._a?e._a.addEventListener(r,m,b||!1):null}e._a._added_events=!0;for(n in ne)ne.hasOwnProperty(n)&&u(n,ne[n]);return!0},o=function(){var n;function u(r,m,b){return e._a?e._a.removeEventListener(r,m,b||!1):null}t._wD(e.id+": Removing event listeners"),e._a._added_events=!1;for(n in ne)ne.hasOwnProperty(n)&&u(n,ne[n])},this._onload=function(n){var u,r=!!n||!e.isHTML5&&M===8&&e.duration;return u=e.id+": ",t._wD(u+(r?"onload()":"Failed to load / invalid sound?"+(e.duration?" -":" Zero-length duration reported.")+" ("+e.url+")"),r?1:2),!r&&!e.isHTML5&&(t.sandbox.noRemote===!0&&t._wD(u+P("noNet"),1),t.sandbox.noLocal===!0&&t._wD(u+P("noLocal"),1)),e.loaded=r,e.readyState=r?3:2,e._onbufferchange(0),!r&&!e.isHTML5&&e._onerror(),e._iO.onload&&Fe(e,function(){e._iO.onload.apply(e,[r])}),!0},this._onerror=function(n,u){e._iO.onerror&&Fe(e,function(){e._iO.onerror.apply(e,[n,u])})},this._onbufferchange=function(n){return e.playState===0||n&&e.isBuffering||!n&&!e.isBuffering?!1:(e.isBuffering=n===1,e._iO.onbufferchange&&(t._wD(e.id+": Buffer state change: "+n),e._iO.onbufferchange.apply(e,[n])),!0)},this._onsuspend=function(){return e._iO.onsuspend&&(t._wD(e.id+": Playback suspended"),e._iO.onsuspend.apply(e)),!0},this._onfailure=function(n,u,r){e.failures++,t._wD(e.id+": Failure ("+e.failures+"): "+n),e._iO.onfailure&&e.failures===1?e._iO.onfailure(n,u,r):t._wD(e.id+": Ignoring failure")},this._onwarning=function(n,u,r){e._iO.onwarning&&e._iO.onwarning(n,u,r)},this._onfinish=function(){var n=e._iO.onfinish;e._onbufferchange(0),e._resetOnPosition(0),e.instanceCount&&(e.instanceCount--,e.instanceCount||(Z(),e.playState=0,e.paused=!1,e.instanceCount=0,e.instanceOptions={},e._iO={},p(),e.isHTML5&&(e.position=0)),(!e.instanceCount||e._iO.multiShotEvents)&&n&&(t._wD(e.id+": onfinish()"),Fe(e,function(){n.apply(e)})))},this._whileloading=function(n,u,r,m){var b=e._iO;e.bytesLoaded=n,e.bytesTotal=u,e.duration=Math.floor(r),e.bufferLength=m,!e.isHTML5&&!b.isMovieStar?b.duration?e.durationEstimate=e.duration>b.duration?e.duration:b.duration:e.durationEstimate=parseInt(e.bytesTotal/e.bytesLoaded*e.duration,10):e.durationEstimate=e.duration,e.isHTML5||(e.buffered=[{start:0,end:e.duration}]),(e.readyState!==3||e.isHTML5)&&b.whileloading&&b.whileloading.apply(e)},this._whileplaying=function(n,u,r,m,b){var B=e._iO,k;return isNaN(n)||n===null?!1:(e.position=Math.max(0,n),e._processOnPosition(),!e.isHTML5&&M>8&&(B.usePeakData&&u!==h&&u&&(e.peakData={left:u.leftPeak,right:u.rightPeak}),B.useWaveformData&&r!==h&&r&&(e.waveformData={left:r.split(","),right:m.split(",")}),B.useEQData&&b!==h&&b&&b.leftEQ&&(k=b.leftEQ.split(","),e.eqData=k,e.eqData.left=k,b.rightEQ!==h&&b.rightEQ&&(e.eqData.right=b.rightEQ.split(",")))),e.playState===1&&(!e.isHTML5&&M===8&&!e.position&&e.isBuffering&&e._onbufferchange(0),B.whileplaying&&B.whileplaying.apply(e)),!0)},this._oncaptiondata=function(n){t._wD(e.id+": Caption data received."),e.captiondata=n,e._iO.oncaptiondata&&e._iO.oncaptiondata.apply(e,[n])},this._onmetadata=function(n,u){t._wD(e.id+": Metadata received.");var r={},m,b;for(m=0,b=n.length;m<b;m++)r[n[m]]=u[m];e.metadata=r,e._iO.onmetadata&&e._iO.onmetadata.call(e,e.metadata)},this._onid3=function(n,u){t._wD(e.id+": ID3 data received.");var r=[],m,b;for(m=0,b=n.length;m<b;m++)r[n[m]]=u[m];e.id3=q(e.id3,r),e._iO.onid3&&e._iO.onid3.apply(e)},this._onconnect=function(n){n=n===1,t._wD(e.id+": "+(n?"Connected.":"Failed to connect? - "+e.url),n?1:2),e.connected=n,n&&(e.failures=0,I(e.id)&&(e.getAutoPlay()?e.play(h,e.getAutoPlay()):e._iO.autoLoad&&e.load()),e._iO.onconnect&&e._iO.onconnect.apply(e,[n]))},this._ondataerror=function(n){e.playState>0&&(t._wD(e.id+": Data error: "+n),e._iO.ondataerror&&e._iO.ondataerror.apply(e))},this._debug()},xe=function(){return w.body||w.getElementsByTagName("div")[0]},te=function(i){return w.getElementById(i)},q=function(i,e){var a=i||{},l,o;l=e===h?t.defaultOptions:e;for(o in l)l.hasOwnProperty(o)&&a[o]===h&&(typeof l[o]!="object"||l[o]===null?a[o]=l[o]:a[o]=q(a[o],l[o]));return a},Fe=function(i,e){!i.isHTML5&&M===8?f.setTimeout(e,0):e()},At={onready:1,ontimeout:1,defaultOptions:1,flash9Options:1,movieStarOptions:1},Xe=function(i,e){var a,l=!0,o=e!==h,p=t.setupOptions,y=At;if(i===h){l=[];for(a in p)p.hasOwnProperty(a)&&l.push(a);for(a in y)y.hasOwnProperty(a)&&(typeof t[a]=="object"?l.push(a+": {...}"):t[a]instanceof Function?l.push(a+": function() {...}"):l.push(a));return t._wD(P("setup",l.join(", "))),!1}for(a in i)if(i.hasOwnProperty(a))if(typeof i[a]!="object"||i[a]===null||i[a]instanceof Array||i[a]instanceof RegExp)o&&y[e]!==h?t[e][a]=i[a]:p[a]!==h?(t.setupOptions[a]=i[a],t[a]=i[a]):y[a]===h?(oe(P(t[a]===h?"setupUndef":"setupError",a),2),l=!1):t[a]instanceof Function?t[a].apply(t,i[a]instanceof Array?i[a]:[i[a]]):t[a]=i[a];else if(y[a]===h)oe(P(t[a]===h?"setupUndef":"setupError",a),2),l=!1;else return Xe(i[a],a);return l};function Ge(i){return t.preferFlash&&ae&&!t.ignoreFlash&&t.flash[i]!==h&&t.flash[i]}N=(function(){var i=f.attachEvent,e={add:i?"attachEvent":"addEventListener",remove:i?"detachEvent":"removeEventListener"};function a(y){var _=Wt.call(y),L=_.length;return i?(_[1]="on"+_[1],L>3&&_.pop()):L===3&&_.push(!1),_}function l(y,_){var L=y.shift(),D=[e[_]];i?L[D](y[0],y[1]):L[D].apply(L,y)}function o(){l(a(arguments),"add")}function p(){l(a(arguments),"remove")}return{add:o,remove:p}})();function H(i){return function(e){var a=this._s,l;return!a||!a._a?(a&&a.id?t._wD(a.id+": Ignoring "+e.type):t._wD(ri+"Ignoring "+e.type),l=null):l=i.call(this,e),l}}ne={abort:H(function(){t._wD(this._s.id+": abort")}),canplay:H(function(){var i=this._s,e;if(!i._html5_canplay){if(i._html5_canplay=!0,t._wD(i.id+": canplay"),i._onbufferchange(0),e=i._iO.position!==h&&!isNaN(i._iO.position)?i._iO.position/W:null,this.currentTime!==e){t._wD(i.id+": canplay: Setting position to "+e);try{this.currentTime=e}catch(a){t._wD(i.id+": canplay: Setting position of "+e+" failed: "+a.message,2)}}i._iO._oncanplay&&i._iO._oncanplay()}}),canplaythrough:H(function(){var i=this._s;i.loaded||(i._onbufferchange(0),i._whileloading(i.bytesLoaded,i.bytesTotal,i._get_html5_duration()),i._onload(!0))}),durationchange:H(function(){var i=this._s,e;e=i._get_html5_duration(),!isNaN(e)&&e!==i.duration&&(t._wD(this._s.id+": durationchange ("+e+")"+(i.duration?", previously "+i.duration:"")),i.durationEstimate=i.duration=e)}),ended:H(function(){var i=this._s;t._wD(i.id+": ended"),i._onfinish()}),error:H(function(){var i=jt[this.error.code]||null;t._wD(this._s.id+": HTML5 error, code "+this.error.code+(i?" ("+i+")":"")),this._s._onload(!1),this._s._onerror(this.error.code,i)}),loadeddata:H(function(){var i=this._s;t._wD(i.id+": loadeddata"),!i._loaded&&!Be&&(i.duration=i._get_html5_duration())}),loadedmetadata:H(function(){t._wD(this._s.id+": loadedmetadata")}),loadstart:H(function(){t._wD(this._s.id+": loadstart"),this._s._onbufferchange(1)}),play:H(function(){this._s._onbufferchange(0)}),playing:H(function(){t._wD(this._s.id+": playing \u266B"),this._s._onbufferchange(0)}),progress:H(function(i){var e=this._s,a,l,o,p=0,y=i.type==="progress",_=i.target.buffered,L=i.loaded||0,D=i.total||1;if(e.buffered=[],_&&_.length){for(a=0,l=_.length;a<l;a++)e.buffered.push({start:_.start(a)*W,end:_.end(a)*W});if(p=(_.end(0)-_.start(0))*W,L=Math.min(1,p/(i.target.duration*W)),y&&_.length>1){for(o=[],l=_.length,a=0;a<l;a++)o.push(i.target.buffered.start(a)*W+"-"+i.target.buffered.end(a)*W);t._wD(this._s.id+": progress, timeRanges: "+o.join(", "))}y&&!isNaN(L)&&t._wD(this._s.id+": progress, "+Math.floor(L*100)+"% loaded")}isNaN(L)||(e._whileloading(L,D,e._get_html5_duration()),L&&D&&L===D&&ne.canplaythrough.call(this,i))}),ratechange:H(function(){t._wD(this._s.id+": ratechange")}),suspend:H(function(i){var e=this._s;t._wD(this._s.id+": suspend"),ne.progress.call(this,i),e._onsuspend()}),stalled:H(function(){t._wD(this._s.id+": stalled")}),timeupdate:H(function(){this._s._onTimer()}),waiting:H(function(){var i=this._s;t._wD(this._s.id+": waiting"),i._onbufferchange(1)})},qe=function(i){var e;return!i||!i.type&&!i.url&&!i.serverURL||i.serverURL||i.type&&Ge(i.type)?e=!1:e=i.type?Ae({type:i.type}):Ae({url:i.url})||t.html5Only||i.url.match(/data:/i),e},We=function(i){var e;return i&&(e=Be?wt:t.html5.canPlayType("audio/wav")?di:wt,i.src=e,i._called_unload!==h&&(i._called_load=!1)),G&&(ht=null),e},Ae=function(i){if(!t.useHTML5Audio||!t.hasHTML5)return!1;var e=i.url||null,a=i.type||null,l=t.audioFormats,o,p,y,_;if(a&&t.html5[a]!==h)return t.html5[a]&&!Ge(a);if(!le){le=[];for(_ in l)l.hasOwnProperty(_)&&(le.push(_),l[_].related&&(le=le.concat(l[_].related)));le=new RegExp("\\.("+le.join("|")+")(\\?.*)?$","i")}return y=e?e.toLowerCase().match(le):null,!y||!y.length?a?(p=a.indexOf(";"),y=(p!==-1?a.substr(0,p):a).substr(6)):o=!1:y=y[1],y&&t.html5[y]!==h?o=t.html5[y]&&!Ge(y):(a="audio/"+y,o=t.html5.canPlayType({type:a}),t.html5[y]=o,o=o&&t.html5[a]&&!Ge(a)),o},qt=function(){if(!t.useHTML5Audio||!t.hasHTML5)return t.html5.usingFlash=!0,K=!0,!1;var i=Audio!==h?bt&&opera.version()<10?new Audio(null):new Audio:null,e,a,l={},o,p;function y(_){var L,D,F=!1,Z=!1;if(!i||typeof i.canPlayType!="function")return F;if(_ instanceof Array){for(p=0,D=_.length;p<D;p++)(t.html5[_[p]]||i.canPlayType(_[p]).match(t.html5Test))&&(Z=!0,t.html5[_[p]]=!0,t.flash[_[p]]=!!_[p].match(Qt));F=Z}else L=i&&typeof i.canPlayType=="function"?i.canPlayType(_):!1,F=!!(L&&L.match(t.html5Test));return F}o=t.audioFormats;for(e in o)if(o.hasOwnProperty(e)&&(a="audio/"+e,l[e]=y(o[e].type),l[a]=l[e],e.match(Qt)?(t.flash[e]=!0,t.flash[a]=!0):(t.flash[e]=!1,t.flash[a]=!1),o[e]&&o[e].related))for(p=o[e].related.length-1;p>=0;p--)l["audio/"+o[e].related[p]]=l[e],t.html5[o[e].related[p]]=l[e],t.flash[o[e].related[p]]=l[e];return l.canPlayType=i?y:null,t.html5=q(t.html5,l),t.html5.usingFlash=Ut(),K=t.html5.usingFlash,!0},X={notReady:"Unavailable - wait until onready() has fired.",notOK:"Audio support is not available.",domError:O+"exception caught while appending SWF to DOM.",spcWmode:"Removing wmode, preventing known SWF loading issue(s)",swf404:E+"Verify that %s is a valid path.",tryDebug:"Try "+O+".debugFlash = true for more security details (output goes to SWF.)",checkSWF:"See SWF output for more debug info.",localFail:E+"Non-HTTP page ("+w.location.protocol+` URL?) Review Flash player security settings for this special case:
http://www.macromedia.com/support/documentation/en/flashplayer/help/settings_manager04.html
May need to add/allow path, eg. c:/sm2/ or /users/me/sm2/`,waitFocus:E+"Special case: Waiting for SWF to load with window focus...",waitForever:E+"Waiting indefinitely for Flash (will recover if unblocked)...",waitSWF:E+"Waiting for 100% SWF load...",needFunction:E+"Function object expected for %s",badID:'Sound ID "%s" should be a string, starting with a non-numeric character',currentObj:E+"_debug(): Current sound objects",waitOnload:E+"Waiting for window.onload()",docLoaded:E+"Document already loaded",onload:E+"initComplete(): calling soundManager.onload()",onloadOK:O+".onload() complete",didInit:E+"init(): Already called?",secNote:"Flash security note: Network/internet URLs will not load due to security restrictions. Access can be configured via Flash Player Global Security Settings Page: http://www.macromedia.com/support/documentation/en/flashplayer/help/settings_manager04.html",badRemove:E+"Failed to remove Flash node.",shutdown:O+".disable(): Shutting down",queue:E+"Queueing %s handler",smError:"SMSound.load(): Exception: JS-Flash communication failed, or JS error.",fbTimeout:"No flash response, applying ."+Y.swfTimedout+" CSS...",fbLoaded:"Flash loaded",fbHandler:E+"flashBlockHandler()",manURL:"SMSound.load(): Using manually-assigned URL",onURL:O+".load(): current URL already assigned.",badFV:O+'.flashVersion must be 8 or 9. "%s" is invalid. Reverting to %s.',as2loop:"Note: Setting stream:false so looping can work (flash 8 limitation)",noNSLoop:"Note: Looping not implemented for MovieStar formats",needfl9:"Note: Switching to flash 9, required for MP4 formats.",mfTimeout:"Setting flashLoadTimeout = 0 (infinite) for off-screen, mobile flash case",needFlash:E+"Fatal error: Flash is needed to play some required formats, but is not available.",gotFocus:E+"Got window focus.",policy:"Enabling usePolicyFile for data access",setup:O+".setup(): allowed parameters: %s",setupError:O+'.setup(): "%s" cannot be assigned with this method.',setupUndef:O+'.setup(): Could not find option "%s"',setupLate:O+".setup(): url, flashVersion and html5Test property changes will not take effect until reboot().",noURL:E+"Flash URL required. Call soundManager.setup({url:...}) to get started.",sm2Loaded:"SoundManager 2: Ready. \u2713",reset:O+".reset(): Removing event callbacks",mobileUA:"Mobile UA detected, preferring HTML5 by default.",globalHTML5:"Using singleton HTML5 Audio() pattern for this device.",ignoreMobile:"Ignoring mobile restrictions for this device."},P=function(){var i,e,a,l,o;if(i=Wt.call(arguments),l=i.shift(),o=X&&X[l]?X[l]:"",o&&i&&i.length)for(e=0,a=i.length;e<a;e++)o=o.replace("%s",i[e]);return o},Ne=function(i){return M===8&&i.loops>1&&i.stream&&(v("as2loop"),i.stream=!1),i},Ce=function(i,e){return i&&!i.usePolicyFile&&(i.onid3||i.usePeakData||i.useWaveformData||i.useEQData)&&(t._wD((e||"")+P("policy")),i.usePolicyFile=!0),i},oe=function(i){St&&console.warn!==h?console.warn(i):t._wD(i)},$e=function(){return!1},ot=function(i){var e;for(e in i)i.hasOwnProperty(e)&&typeof i[e]=="function"&&(i[e]=$e);e=null},rt=function(i){i===h&&(i=!1),(V||i)&&t.disable(i)},Rt=function(i){var e=null,a;if(i)if(i.match(/\.swf(\?.*)?$/i)){if(e=i.substr(i.toLowerCase().lastIndexOf(".swf?")+4),e)return i}else i.lastIndexOf("/")!==i.length-1&&(i+="/");return a=(i&&i.lastIndexOf("/")!==-1?i.substr(0,i.lastIndexOf("/")+1):"./")+t.movieURL,t.noSWFCache&&(a+="?ts="+new Date().getTime()),a},it=function(){M=parseInt(t.flashVersion,10),M!==8&&M!==9&&(t._wD(P("badFV",M,kt)),t.flashVersion=M=kt);var i=t.debugMode||t.debugFlash?"_debug.swf":".swf";t.useHTML5Audio&&!t.html5Only&&t.audioFormats.mp4.required&&M<9&&(t._wD(P("needfl9")),t.flashVersion=M=9),t.version=t.versionNumber+(t.html5Only?" (HTML5-only mode)":M===9?" (AS3/Flash 9)":" (AS2/Flash 8)"),M>8?(t.defaultOptions=q(t.defaultOptions,t.flash9Options),t.features.buffering=!0,t.defaultOptions=q(t.defaultOptions,t.movieStarOptions),t.filePatterns.flash9=new RegExp("\\.(mp3|"+Zt.join("|")+")(\\?.*)?$","i"),t.features.movieStar=!0):t.features.movieStar=!1,t.filePattern=t.filePatterns[M!==8?"flash9":"flash8"],t.movieURL=(M===8?"soundmanager2.swf":"soundmanager2_flash9.swf").replace(".swf",i),t.features.peakData=t.features.waveformData=t.features.eqData=M>8},It=function(i,e){T&&T._setPolling(i,e)},nt=function(){if(t.debugURLParam.test(Ee)&&(t.setupOptions.debugMode=t.debugMode=!0),!te(t.debugID)){var i,e,a,l,o;if(t.debugMode&&!te(t.debugID)&&(!St||!t.useConsole||!t.consoleOnly)){i=w.createElement("div"),i.id=t.debugID+"-toggle",l={position:"fixed",bottom:"0px",right:"0px",width:"1.2em",height:"1.2em",lineHeight:"1.2em",margin:"2px",textAlign:"center",border:"1px solid #999",cursor:"pointer",background:"#fff",color:"#333",zIndex:10001},i.appendChild(w.createTextNode("-")),i.onclick=xt,i.title="Toggle SM2 debug console",C.match(/msie 6/i)&&(i.style.position="absolute",i.style.cursor="hand");for(o in l)l.hasOwnProperty(o)&&(i.style[o]=l[o]);if(e=w.createElement("div"),e.id=t.debugID,e.style.display=t.debugMode?"block":"none",t.debugMode&&!te(i.id)){try{a=xe(),a.appendChild(i)}catch(p){throw new Error(P("domError")+` 
`+p.toString())}a.appendChild(e)}}a=null}},I=this.getSoundById,v=function(i,e){return i?t._wD(P(i),e):""},xt=function(){var i=te(t.debugID),e=te(t.debugID+"-toggle");i&&(Je?(e.innerHTML="+",i.style.display="none"):(e.innerHTML="-",i.style.display="block"),Je=!Je)},J=function(i,e,a){if(f.sm2Debugger!==h)try{sm2Debugger.handleEvent(i,e,a)}catch{return!1}return!0},ye=function(){var i=[];return t.debugMode&&i.push(Y.sm2Debug),t.debugFlash&&i.push(Y.flashDebug),t.useHighPerformance&&i.push(Y.highPerf),i.join(" ")},ut=function(){var i=P("fbHandler"),e=t.getMoviePercent(),a=Y,l={type:"FLASHBLOCK"};t.html5Only||(t.ok()?(t.didFlashBlock&&t._wD(i+": Unblocked"),t.oMC&&(t.oMC.className=[ye(),a.swfDefault,a.swfLoaded+(t.didFlashBlock?" "+a.swfUnblocked:"")].join(" "))):(K&&(t.oMC.className=ye()+" "+a.swfDefault+" "+(e===null?a.swfTimedout:a.swfError),t._wD(i+": "+P("fbTimeout")+(e?" ("+P("fbLoaded")+")":""))),t.didFlashBlock=!0,fe({type:"ontimeout",ignoreInit:!0,error:l}),ge(l)))},et=function(i,e,a){se[i]===h&&(se[i]=[]),se[i].push({method:e,scope:a||null,fired:!1})},fe=function(i){if(i||(i={type:t.ok()?"onready":"ontimeout"}),!R&&i&&!i.ignoreInit||i.type==="ontimeout"&&(t.ok()||V&&!i.ignoreInit))return!1;var e={success:i&&i.ignoreInit?t.ok():!V},a=i&&i.type?se[i.type]||[]:[],l=[],o,p,y=[e],_=K&&!t.ok();for(i.error&&(y[0].error=i.error),o=0,p=a.length;o<p;o++)a[o].fired!==!0&&l.push(a[o]);if(l.length)for(o=0,p=l.length;o<p;o++)l[o].scope?l[o].method.apply(l[o].scope,y):l[o].method.apply(this,y),_||(l[o].fired=!0);return!0},pe=function(){f.setTimeout(function(){t.useFlashBlock&&ut(),fe(),typeof t.onload=="function"&&(v("onload",1),t.onload.apply(f),v("onloadOK",1)),t.waitForWindowLoad&&N.add(f,"load",pe)},1)},ct=function(){if(ae!==h)return ae;var i=!1,e=navigator,a,l,o,p=f.ActiveXObject,y;try{y=e.plugins}catch{y=void 0}if(y&&y.length)l="application/x-shockwave-flash",o=e.mimeTypes,o&&o[l]&&o[l].enabledPlugin&&o[l].enabledPlugin.description&&(i=!0);else if(p!==h&&!C.match(/MSAppHost/i)){try{a=new p("ShockwaveFlash.ShockwaveFlash")}catch{a=null}i=!!a,a=null}return ae=i,i},Ut=function(){var i,e,a=t.audioFormats,l=gt&&!!C.match(/os (1|2|3_0|3_1)\s/i);if(l?(t.hasHTML5=!1,t.html5Only=!0,t.oMC&&(t.oMC.style.display="none")):t.useHTML5Audio&&((!t.html5||!t.html5.canPlayType)&&(t._wD("SoundManager: No HTML5 Audio() support detected."),t.hasHTML5=!1),_t&&t._wD(E+"Note: Buggy HTML5 Audio in Safari on this OS X release, see https://bugs.webkit.org/show_bug.cgi?id=32159 - "+(ae?"will use flash fallback for MP3/MP4, if available":" would use flash fallback for MP3/MP4, but none detected."),1)),t.useHTML5Audio&&t.hasHTML5){De=!0;for(e in a)a.hasOwnProperty(e)&&a[e].required&&(t.html5.canPlayType(a[e].type)?t.preferFlash&&(t.flash[e]||t.flash[a[e].type])&&(i=!0):(De=!1,i=!0))}return t.ignoreFlash&&(i=!1,De=!0),t.html5Only=t.hasHTML5&&t.useHTML5Audio&&!i,!t.html5Only},je=function(i){var e,a,l=0,o;if(i instanceof Array){for(e=0,a=i.length;e<a;e++)if(i[e]instanceof Object){if(t.canPlayMIME(i[e].type)){l=e;break}}else if(t.canPlayURL(i[e])){l=e;break}i[l].url&&(i[l]=i[l].url),o=i[l]}else o=i;return o},Ht=function(i){i._hasTimer||(i._hasTimer=!0,!Ve&&t.html5PollingInterval&&(Le===null&&Ue===0&&(Le=setInterval(Ct,t.html5PollingInterval)),Ue++))},Nt=function(i){i._hasTimer&&(i._hasTimer=!1,!Ve&&t.html5PollingInterval&&Ue--)},Ct=function(){var i;if(Le!==null&&!Ue){clearInterval(Le),Le=null;return}for(i=t.soundIDs.length-1;i>=0;i--)t.sounds[t.soundIDs[i]].isHTML5&&t.sounds[t.soundIDs[i]]._hasTimer&&t.sounds[t.soundIDs[i]]._onTimer()},ge=function(i){i=i!==h?i:{},typeof t.onerror=="function"&&t.onerror.apply(f,[{type:i.type!==h?i.type:null}]),i.fatal!==h&&i.fatal&&t.disable()},Bt=function(){if(!(!_t||!ct())){var i=t.audioFormats,e,a;for(a in i)if(i.hasOwnProperty(a)&&(a==="mp3"||a==="mp4")&&(t._wD(O+": Using flash fallback for "+a+" format"),t.html5[a]=!1,i[a]&&i[a].related))for(e=i[a].related.length-1;e>=0;e--)t.html5[i[a].related[e]]=!1}},this._setSandboxType=function(i){var e=t.sandbox;e.type=i,e.description=e.types[e.types[i]!==h?i:"unknown"],e.type==="localWithFile"?(e.noRemote=!0,e.noLocal=!1,v("secNote",2)):e.type==="localWithNetwork"?(e.noRemote=!1,e.noLocal=!0):e.type==="localTrusted"&&(e.noRemote=!1,e.noLocal=!1)},this._externalInterfaceOK=function(i){if(!t.swfLoaded){var e;if(J("swf",!0),J("flashtojs",!0),t.swfLoaded=!0,Ke=!1,_t&&Bt(),!i||i.replace(/\+dev/i,"")!==t.versionNumber.replace(/\+dev/i,"")){e=O+': Fatal: JavaScript file build "'+t.versionNumber+'" does not match Flash SWF build "'+i+'" at '+t.url+". Ensure both are up-to-date.",setTimeout(function(){throw new Error(e)},0);return}setTimeout(ze,ue?100:1)}},He=function(i,e){if(Te&&we)return!1;function a(){var m=[],b,B=[],k=" + ";b="SoundManager "+t.version+(!t.html5Only&&t.useHTML5Audio?t.hasHTML5?" + HTML5 audio":", no HTML5 audio support":""),t.html5Only?t.html5PollingInterval&&m.push("html5PollingInterval ("+t.html5PollingInterval+"ms)"):(t.preferFlash&&m.push("preferFlash"),t.useHighPerformance&&m.push("useHighPerformance"),t.flashPollingInterval&&m.push("flashPollingInterval ("+t.flashPollingInterval+"ms)"),t.html5PollingInterval&&m.push("html5PollingInterval ("+t.html5PollingInterval+"ms)"),t.wmode&&m.push("wmode ("+t.wmode+")"),t.debugFlash&&m.push("debugFlash"),t.useFlashBlock&&m.push("flashBlock")),m.length&&(B=B.concat([m.join(k)])),t._wD(b+(B.length?k+B.join(", "):""),1),Vt()}if(t.html5Only)return it(),a(),t.oMC=te(t.movieID),ze(),Te=!0,we=!0,!1;var l=e||t.url,o=t.altURL||l,p="JS/Flash audio component (SoundManager 2)",y=xe(),_=ye(),L=null,D=w.getElementsByTagName("html")[0],F,Z,ce,ee,Q,$,n,u;L=D&&D.dir&&D.dir.match(/rtl/i),i=i===h?t.id:i;function r(m,b){return'<param name="'+m+'" value="'+b+'" />'}if(it(),t.url=Rt(Ie?l:o),e=t.url,t.wmode=!t.wmode&&t.useHighPerformance?"transparent":t.wmode,t.wmode!==null&&(C.match(/msie 8/i)||!ue&&!t.useHighPerformance)&&navigator.platform.match(/win32|win64/i)&&(re.push(X.spcWmode),t.wmode=null),F={name:i,id:i,src:e,quality:"high",allowScriptAccess:t.allowScriptAccess,bgcolor:t.bgColor,pluginspage:fi+"www.macromedia.com/go/getflashplayer",title:p,type:"application/x-shockwave-flash",wmode:t.wmode,hasPriority:"true"},t.debugFlash&&(F.FlashVars="debug=1"),t.wmode||delete F.wmode,ue)Z=w.createElement("div"),ee=['<object id="'+i+'" data="'+e+'" type="'+F.type+'" title="'+F.title+'" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0">',r("movie",e),r("AllowScriptAccess",t.allowScriptAccess),r("quality",F.quality),t.wmode?r("wmode",t.wmode):"",r("bgcolor",t.bgColor),r("hasPriority","true"),t.debugFlash?r("FlashVars",F.FlashVars):"","</object>"].join("");else{Z=w.createElement("embed");for(ce in F)F.hasOwnProperty(ce)&&Z.setAttribute(ce,F[ce])}if(nt(),_=ye(),y=xe(),y)if(t.oMC=te(t.movieID)||w.createElement("div"),t.oMC.id)u=t.oMC.className,t.oMC.className=(u?u+" ":Y.swfDefault)+(_?" "+_:""),t.oMC.appendChild(Z),ue&&(Q=t.oMC.appendChild(w.createElement("div")),Q.className=Y.swfBox,Q.innerHTML=ee),we=!0;else{if(t.oMC.id=t.movieID,t.oMC.className=Y.swfDefault+" "+_,$=null,Q=null,t.useFlashBlock||(t.useHighPerformance?$={position:"fixed",width:"8px",height:"8px",bottom:"0px",left:"0px",overflow:"hidden"}:($={position:"absolute",width:"6px",height:"6px",top:"-9999px",left:"-9999px"},L&&($.left=Math.abs(parseInt($.left,10))+"px"))),ui&&(t.oMC.style.zIndex=1e4),!t.debugFlash)for(n in $)$.hasOwnProperty(n)&&(t.oMC.style[n]=$[n]);try{ue||t.oMC.appendChild(Z),y.appendChild(t.oMC),ue&&(Q=t.oMC.appendChild(w.createElement("div")),Q.className=Y.swfBox,Q.innerHTML=ee),we=!0}catch(m){throw new Error(P("domError")+` 
`+m.toString())}}return Te=!0,a(),!0},Re=function(){return t.html5Only?(He(),!1):T?!1:t.url?(T=t.getMovie(t.id),T||(ve?(ue?t.oMC.innerHTML=lt:t.oMC.appendChild(ve),ve=null,Te=!0):He(t.id,t.url),T=t.getMovie(t.id)),typeof t.oninitmovie=="function"&&setTimeout(t.oninitmovie,1),pt(),!0):(v("noURL"),!1)},me=function(){setTimeout(Ft,1e3)},tt=function(){f.setTimeout(function(){oe(E+"useFlashBlock is false, 100% HTML5 mode is possible. Rebooting with preferFlash: false..."),t.setup({preferFlash:!1}).reboot(),t.didFlashBlock=!0,t.beginDelayedInit()},1)},Ft=function(){var i,e=!1;if(t.url&&!Pe){if(Pe=!0,N.remove(f,"load",me),ae&&Ke&&!Tt){v("waitFocus");return}R||(i=t.getMoviePercent(),i>0&&i<100&&(e=!0)),setTimeout(function(){if(i=t.getMoviePercent(),e){Pe=!1,t._wD(P("waitSWF")),f.setTimeout(me,1);return}R||(t._wD(O+": No Flash response within expected time. Likely causes: "+(i===0?"SWF load failed, ":"")+"Flash blocked or JS-Flash security error."+(t.debugFlash?" "+P("checkSWF"):""),2),!Ie&&i&&(v("localFail",2),t.debugFlash||v("tryDebug",2)),i===0&&t._wD(P("swf404",t.url),1),J("flashtojs",!1,": Timed out"+(Ie?" (Check flash security or flash blockers)":" (No plugin/missing SWF?)"))),!R&&Gt&&(i===null?t.useFlashBlock||t.flashLoadTimeout===0?(t.useFlashBlock&&ut(),v("waitForever")):!t.useFlashBlock&&De?tt():(v("waitForever"),fe({type:"ontimeout",ignoreInit:!0,error:{type:"INIT_FLASHBLOCK"}})):t.flashLoadTimeout===0?v("waitForever"):!t.useFlashBlock&&De?tt():rt(!0))},t.flashLoadTimeout)}},st=function(){function i(){N.remove(f,"focus",st)}return Tt||!Ke?(i(),!0):(Gt=!0,Tt=!0,v("gotFocus"),Pe=!1,me(),i(),!0)},pt=function(){re.length&&(t._wD("SoundManager 2: "+re.join(" "),1),re=[])},Vt=function(){pt();var i,e=[];if(t.useHTML5Audio&&t.hasHTML5){for(i in t.audioFormats)t.audioFormats.hasOwnProperty(i)&&e.push(i+" = "+t.html5[i]+(!t.html5[i]&&K&&t.flash[i]?" (using flash)":t.preferFlash&&t.flash[i]&&K?" (preferring flash)":t.html5[i]?"":" ("+(t.audioFormats[i].required?"required, ":"")+"and no flash support)"));t._wD("SoundManager 2 HTML5 support: "+e.join(", "),1)}},Me=function(i){if(R)return!1;if(t.html5Only)return v("sm2Loaded",1),R=!0,pe(),J("onload",!0),!0;var e=t.useFlashBlock&&t.flashLoadTimeout&&!t.getMoviePercent(),a=!0,l;return e||(R=!0),l={type:!ae&&K?"NO_FLASH":"INIT_TIMEOUT"},t._wD("SoundManager 2 "+(V?"failed to load":"loaded")+" ("+(V?"Flash security/load error":"OK")+") "+String.fromCharCode(V?10006:10003),V?2:1),V||i?(t.useFlashBlock&&t.oMC&&(t.oMC.className=ye()+" "+(t.getMoviePercent()===null?Y.swfTimedout:Y.swfError)),fe({type:"ontimeout",error:l,ignoreInit:!0}),J("onload",!1),ge(l),a=!1):J("onload",!0),V||(t.waitForWindowLoad&&!ke?(v("waitOnload"),N.add(f,"load",pe)):(t.waitForWindowLoad&&ke&&v("docLoaded"),pe())),a},Dt=function(){var i,e=t.setupOptions;for(i in e)e.hasOwnProperty(i)&&(t[i]===h?t[i]=e[i]:t[i]!==e[i]&&(t.setupOptions[i]=t[i]))},ze=function(){if(R)return v("didInit"),!1;function i(){N.remove(f,"load",t.beginDelayedInit)}if(t.html5Only)return R||(i(),t.enabled=!0,Me()),!0;Re();try{T._externalInterfaceTest(!1),It(!0,t.flashPollingInterval||(t.useHighPerformance?10:50)),t.debugMode||T._disableDebug(),t.enabled=!0,J("jstoflash",!0),t.html5Only||N.add(f,"unload",$e)}catch(e){return t._wD("js/flash exception: "+e.toString()),J("jstoflash",!1),ge({type:"JS_TO_FLASH_EXCEPTION",fatal:!0}),rt(!0),Me(),!1}return Me(),i(),!0},he=function(){return Oe?!1:(Oe=!0,Dt(),nt(),!ae&&t.hasHTML5&&(t._wD("SoundManager 2: No Flash detected"+(t.useHTML5Audio?". Trying HTML5-only mode.":", enabling HTML5."),1),t.setup({useHTML5Audio:!0,preferFlash:!1})),qt(),!ae&&K&&(re.push(X.needFlash),t.setup({flashLoadTimeout:1})),w.removeEventListener&&w.removeEventListener("DOMContentLoaded",he,!1),Re(),!0)},ft=function(){return w.readyState==="complete"&&(he(),w.detachEvent("onreadystatechange",ft)),!0},at=function(){ke=!0,he(),N.remove(f,"load",at)},ct(),N.add(f,"focus",st),N.add(f,"load",me),N.add(f,"load",at),w.addEventListener?w.addEventListener("DOMContentLoaded",he,!1):w.attachEvent?w.attachEvent("onreadystatechange",ft):(J("onload",!1),ge({type:"NO_DOM2_EVENTS",fatal:!0}))}(f.SM2_DEFER===h||!SM2_DEFER)&&(s=new d),typeof Se=="object"&&Se&&typeof Se.exports=="object"?(Se.exports.SoundManager=d,Se.exports.soundManager=s):typeof define=="function"&&define.amd&&define(function(){function S(A){if(!f.soundManager&&A instanceof Function){var j=A(d);j instanceof d&&(f.soundManager=j)}return f.soundManager}return{constructor:d,getInstance:S}}),f.SoundManager=d,f.soundManager=s})(window)});var si=(()=>{let f=class f{constructor(){this.dir="auto",this.lang="en-US",this.enabled=!1,this.requireInteraction=!1,this.silent=!0}checkCompatibility(){return"Notification"in globalThis}isPermissionGranted(s){return s==="granted"}requestPermission(){return U(this,null,function*(){return Notification.requestPermission()})}show(s){return U(this,null,function*(){if(this.enabled){if(this.title=s.title,this.body=s.body,Object.hasOwn(s,"silent")&&(this.silent=s.silent),Object.hasOwn(s,"icon")&&(this.icon=s.icon),!this.checkCompatibility()){console.error("Notification API not available in this browser.");return}return this.requestPermission().then(d=>this.isPermissionGranted(d)).then(()=>this.create())}})}create(){let s={dir:this.dir??"auto",lang:this.lang||"en-US",tag:this.tag,body:this.body,icon:this.icon,silent:this.silent,badge:this.badge,requireInteraction:this.requireInteraction},d=new Notification(this.title??"",s);return this.close(d),d}close(s){s.close()}};f.\u0275fac=function(d){return new(d||f)},f.\u0275prov=de({token:f,factory:f.\u0275fac,providedIn:"root"});let c=f;return c})();var ai=(()=>{let f=class f{constructor(){this.entries=[],this.currentIndex=-1,this.repeatQueue=!1,this.queueChange=new Jt,this.jam=z(_e)}get isEmpty(){return this.entries.length===0}get hasPrevious(){return this.currentIndex>0&&this.entries.length>1}get hasNext(){return!!this.getNext()}set(s){this.entries=s??[],this.currentIndex=-1}indexOfTrack(s){return this.entries.findIndex(d=>d.id===s)}add(s,d){(d||this.indexOfTrack(s.id)<0)&&(this.entries.push(s),this.publishChanges())}addMedias(s,d){let S=0;for(let A of s)(d||this.indexOfTrack(A.id)<0)&&(this.entries.push(A),S++);return S>0&&this.publishChanges(),S}first(){if(this.entries.length!==0)return this.currentIndex=0,this.entries[0]}getCurrent(){return this.entries[this.currentIndex]}getNext(){if(this.entries.length===0)return;let s=this.currentIndex;if(s<this.entries.length-1)s++;else if(this.repeatQueue)s=0;else return;return this.entries[s]}next(){if(this.entries.length!==0){if(this.currentIndex<this.entries.length-1)this.currentIndex++;else if(this.repeatQueue)this.currentIndex=0;else return;return this.entries[this.currentIndex]}}previous(){if(this.entries.length!==0)return this.currentIndex>0?this.currentIndex--:this.currentIndex=this.entries.length-1,this.entries[this.currentIndex]}remove(s){let d=this.indexOfTrack(s.id);d>=0&&(this.entries.splice(d,1),this.currentIndex>=this.entries.length&&(this.currentIndex=this.entries.length-1),this.publishChanges())}clear(){this.entries=[],this.currentIndex=-1,this.publishChanges()}shuffle(){this.entries.sort(()=>.5-Math.random()),this.publishChanges()}isPlayed(s){return this.indexOfTrack(s.id)<this.currentIndex}isInQueue(s){return this.indexOfTrack(s.id)>=0}setIndexByTrack(s){let d=this.indexOfTrack(s.id);d>-1&&(this.currentIndex=d)}publishChanges(){this.queueChange.emit()}addEpisode(s){return U(this,null,function*(){return this.addMedias([s])})}addPodcast(s){return U(this,null,function*(){let d=yield this.jam.episode.search({podcastIDs:[s.id],statuses:[be.completed],episodeIncTag:!0,episodeIncState:!0});return this.addMedias(d.items)})}addFolder(s){return U(this,null,function*(){let d=yield this.jam.folder.tracks({childOfID:s.id,trackIncTag:!0,trackIncState:!0});return this.addMedias(d.items)})}addSeries(s){return U(this,null,function*(){let d=yield this.jam.series.tracks({ids:[s.id],trackIncTag:!0,trackIncState:!0});return this.addMedias(d.items)})}addPlaylist(s){return U(this,null,function*(){let d=yield this.jam.playlist.entries({ids:[s.id],trackIncTag:!0,trackIncState:!0,episodeIncTag:!0,episodeIncState:!0});return this.addMedias(d.items)})}addAlbums(s){return U(this,null,function*(){let d=yield this.jam.album.tracks({ids:s.map(S=>S.id),trackIncTag:!0,trackIncState:!0});return this.addMedias(d.items)})}addAlbum(s){return U(this,null,function*(){let d=yield this.jam.album.tracks({ids:[s.id],trackIncTag:!0,trackIncState:!0});return this.addMedias(d.items)})}addAlbumByID(s){return U(this,null,function*(){let d=yield this.jam.album.tracks({ids:[s],trackIncTag:!0,trackIncState:!0});return this.addMedias(d.items)})}addArtist(s){return U(this,null,function*(){let d=yield this.jam.artist.tracks({ids:[s.id],trackIncTag:!0,trackIncState:!0});return this.addMedias(d.items)})}addArtists(s){return U(this,null,function*(){let d=yield this.jam.artist.tracks({ids:s.map(S=>S.id),trackIncTag:!0,trackIncState:!0});return this.addMedias(d.items)})}addArtistByID(s){return U(this,null,function*(){let d=yield this.jam.artist.tracks({ids:[s],trackIncTag:!0,trackIncState:!0});return this.addMedias(d.items)})}};f.\u0275fac=function(d){return new(d||f)},f.\u0275prov=de({token:f,factory:f.\u0275fac,providedIn:"root"});let c=f;return c})();var x=(()=>{let f=class f{};f.PLAY=1,f.PAUSE=2,f.REWIND=3,f.FORWARD=4,f.PREVIOUS=5,f.NEXT=6,f.SEEK=7,f.STOP=8;let c=f;return c})();var ni=(()=>{let f=class f{constructor(){this.jam=z(_e),this.ngZone=z(Xt),this.subscribers={},this.updatePositionState=(s,d,S)=>{if(this.mediaSession&&"setPositionState"in navigator.mediaSession){let A=(s??0)/1e3,j={duration:A,playbackRate:d??1,position:Math.min(A,(S??0)/1e3)};try{navigator.mediaSession.setPositionState(j)}catch(t){console.error(t)}}},this.mediaSession=navigator.mediaSession,this.initMediaSession()}setMedia(s){if(this.mediaSession){let S=[96,128,192,256,384,512].map(j=>({src:this.jam.image.imageUrl({id:s.id,size:j,format:Qe.png}),sizes:`${j}x${j}`,type:"image/png"})),A={title:s.tag?s.tag.title:s.name,artist:s.tag?s.tag.artist:void 0,album:s.tag?s.tag.album:void 0,artwork:S};this.mediaSession.metadata=new MediaMetadata(A)}}setPlaybackState(s,d){if(this.mediaSession){let S="none";s?S="playing":d&&(S="paused"),this.mediaSession.playbackState=S}}on(s,d){let S=this.subscribers[s]??[];S.push(d),this.subscribers[s]=S}publish(s,d){let S=this.subscribers[s];if(S)for(let A of S)A(d)}initMediaSession(){if(this.mediaSession){this.mediaSession.setActionHandler("play",()=>{this.ngZone.run(()=>{this.publish(x.PLAY)})}),this.mediaSession.setActionHandler("pause",()=>{this.ngZone.run(()=>{this.publish(x.PAUSE)})}),this.mediaSession.setActionHandler("seekbackward",()=>{this.ngZone.run(()=>{this.publish(x.REWIND)})}),this.mediaSession.setActionHandler("seekforward",()=>{this.ngZone.run(()=>{this.publish(x.FORWARD)})});try{this.mediaSession.setActionHandler("stop",()=>{this.ngZone.run(()=>{this.publish(x.STOP)})})}catch{console.warn('Warning! The "stop" media session action is not supported.')}try{this.mediaSession.setActionHandler("seekto",s=>{this.ngZone.run(()=>{this.publish(x.SEEK,{fastSeek:s.fastSeek,seekTime:s.seekTime})})})}catch{console.warn('Warning! The "seekto" media session action is not supported.')}this.mediaSession.setActionHandler("previoustrack",()=>{this.ngZone.run(()=>{this.publish(x.PREVIOUS)})}),this.mediaSession.setActionHandler("nexttrack",()=>{this.ngZone.run(()=>{this.publish(x.NEXT)})})}}};f.\u0275fac=function(d){return new(d||f)},f.\u0275prov=de({token:f,factory:f.\u0275fac,providedIn:"root"});let c=f;return c})();var Ye=class{constructor(){this.startAt=0,this.lapTime=0}start(){this.startAt=this.startAt===0?Date.now():this.startAt}pause(){this.lapTime=this.startAt?this.lapTime+Date.now()-this.startAt:this.lapTime,this.startAt=0}reset(){this.lapTime=0,this.startAt=0}time(){return this.lapTime+(this.startAt?Date.now()-this.startAt:0)}};var g=(function(c){return c[c.TRACK=1]="TRACK",c[c.PLAY=2]="PLAY",c[c.PLAYSTART=3]="PLAYSTART",c[c.PLAYRESUME=4]="PLAYRESUME",c[c.PAUSE=5]="PAUSE",c[c.FINISH=6]="FINISH",c[c.SEEK=7]="SEEK",c[c.SEEKED=8]="SEEKED",c[c.BUFFERINGSTART=9]="BUFFERINGSTART",c[c.BUFFERINGEND=10]="BUFFERINGEND",c[c.AUDIOERROR=11]="AUDIOERROR",c[c.TIME=12]="TIME",c[c.NOSTREAM=13]="NOSTREAM",c[c.NOPROTOCOL=14]="NOPROTOCOL",c[c.NOCONNECTION=15]="NOCONNECTION",c[c.MUTE=16]="MUTE",c[c.VOLUME=17]="VOLUME",c[c.LOADING=18]="LOADING",c[c.SPEED=19]="SPEED",c})(g||{});var ie=pi(oi());ie.soundManager.debugMode=!1;ie.soundManager.forceUseGlobalHTML5Audio=!0;ie.soundManager.useHTML5Audio=!0;ie.soundManager.preferFlash=!1;var Ze=class{constructor(f){this.jam=f,this.subscribers={},this.volume=50,this.isMute=!1}duration(){return this.soundObject?this.soundObject.duration??0:0}getAudioSupport(){let f={formats:Object.keys(ie.soundManager.audioFormats??{})};return f.formats.sort((h,s)=>h.localeCompare(s)),f}getVolume(){return!this.soundObject||this.isMute?this.volume:this.soundObject.volume}buildSoundObject(f,h){return ie.soundManager.createSound({url:this.jam.stream.streamUrl({id:f.id}),id:f.id,volume:this.isMute?0:this.volume,autoLoad:!0,autoPlay:!1,position:h,onbufferchange:()=>{this.publish(g.BUFFERINGSTART)},ondataerror:()=>{this.publish(g.AUDIOERROR)},whileloading:()=>{this.publish(g.LOADING,this.getLoading())},onfinish:()=>{this.publish(g.FINISH)},onload:s=>{this.publish(g.BUFFERINGEND,s)},onpause:()=>{this.publish(g.PAUSE)},onplay:()=>{this.publish(g.PLAY)},onresume:()=>{this.publish(g.PLAYRESUME)},onstop:()=>{this.publish(g.FINISH)},whileplaying:()=>{let s=this.position();this.publish(g.TIME,s)}})}initialize(f,h,s,d){this.unloadLast();let S=ie.soundManager.getSoundById(f.id);if(!S){if(S=this.buildSoundObject(f,h),!S){d(new Error("Soundplayer could not be initialized."));return}this.lastMedia=f}s||S.play(),this.soundObject=S,this.publish(g.TRACK,f),this.publish(g.SPEED,this.speed()),this.publish(g.VOLUME,this.getVolume()),d()}isMuted(){return this.isMute}mute(){this.isMute=!0,this.soundObject&&this.soundObject.setVolume(0),this.publish(g.MUTE,!0)}on(f,h){let s=this.subscribers[f]??[];s.push(h),this.subscribers[f]=s}pause(){this.soundObject&&this.soundObject.pause()}play(){this.soundObject&&(this.soundObject.playState===0?this.soundObject.play():this.soundObject.resume())}position(){return this.soundObject&&this.soundObject.position||0}preload(){}seek(f){this.soundObject&&this.soundObject.setPosition(f)}setSpeed(f){this.soundObject&&(this.soundObject.setPlaybackRate(f),this.publish(g.SPEED,this.speed()))}setVolume(f){this.volume=f,this.soundObject&&this.soundObject.setVolume(f),this.publish(g.VOLUME,this.getVolume())}speed(){return this.soundObject?this.soundObject._iO.playbackRate:1}stop(){this.soundObject&&(this.soundObject.stop(),this.unloadLast(),this.lastMedia=void 0)}unmute(){this.isMute=!1,this.soundObject&&this.soundObject.setVolume(this.volume),this.publish(g.MUTE,!1)}getLoading(){return this.soundObject?this.soundObject.bytesLoaded??0:0}publish(f,h){let s=this.subscribers[f];if(s)for(let d of s)d(h)}unloadLast(){this.lastMedia&&(ie.soundManager.unload(this.lastMedia.id),ie.soundManager.destroySound(this.lastMedia.id),this.lastMedia=void 0)}};var Qi=(()=>{let f=class f{constructor(){this.isMuted=!1,this.isPlaying=!1,this.repeatTrack=!1,this.scrobbleWatch=new Ye,this.scrobbled=!1,this.unsubscribe=new zt,this.queue=z(ai),this.notify=z(ti),this.notification=z(si),this.mediasession=z(ni),this.userStorage=z(ii),this.jam=z(_e),this.subscribers={};let s=this.userStorage,d=this.jam;this.soundPlayer=new Ze(d),this.subscribeSoundPlayerEvents(),this.subscribeMediaSessionEvents(),s.userChange.pipe(vt(this.unsubscribe)).subscribe(()=>{setTimeout(()=>{this.loadFromStorage()},0)}),this.loadFromStorage(),this.queue.queueChange.pipe(vt(this.unsubscribe)).subscribe(()=>{this.syncQueueWithLocalStorage()})}get empty(){return!(this.currentTrack??this.currentEpisode)}ngOnDestroy(){this.unsubscribe.next(),this.unsubscribe.complete()}playQueuePos(s){this.queue.currentIndex=s-1,this.next()}play(s,d=!1,S,A){S===void 0&&this.isPlaying&&this.currentMedia&&this.currentMedia.id===s.id||(d&&(this.queue.add(s),this.syncQueueWithLocalStorage()),this.queue.setIndexByTrack(s),this.scrobbled=!1,this.currentEpisode=void 0,this.currentTrack=void 0,this.currentMedia=s,this.currentTime=S??0,this.scrobbleWatch.reset(),s.objType===ei.episode?this.currentEpisode=s:this.currentTrack=s,this.soundPlayer.initialize(s,S,!!A,j=>{j?this.notify.error(j):(this.setCurrentMedia(s),this.setPlaying(!A),this.syncPlayerWithLocalStorage())}))}stop(){this.currentMedia!==void 0&&(this.currentMedia=void 0,this.currentTrack=void 0,this.currentEpisode=void 0,this.soundPlayer.stop(),this.setPlaying(!1))}onTrackFinish(){if(!this.currentMedia)return;if(this.repeatTrack){let d=this.currentMedia;this.currentMedia=void 0,this.play(d);return}let s=this.queue.next();s?this.play(s):(this.currentTrack=void 0,this.currentEpisode=void 0,this.currentMedia=void 0,this.currentTime=void 0,this.totalTime=void 0,this.queue.currentIndex=-1,this.setPlaying(!1),this.publish(g.TRACK,void 0),this.syncPlayerWithLocalStorage())}togglePlayPause(){if(this.currentMedia===void 0){let s=this.queue.next();s&&this.play(s)}else this.isPlaying?this.soundPlayer.pause():this.soundPlayer.play()}next(){let s=this.queue.next();s&&this.play(s)}previous(){let s=this.queue.previous();s&&this.play(s)}speed(s){this.soundPlayer.setSpeed(s)}seek(s){this.currentMedia&&(this.soundPlayer.seek(s),this.syncPlayerWithLocalStorage())}volume(s){this.soundPlayer.setVolume(s)}forward(s){this.seek(this.soundPlayer.position()+s*1e3)}rewind(s){this.seek(Math.max(0,this.soundPlayer.position()-s*1e3))}volumeUp(){let s=this.soundPlayer.getVolume();this.soundPlayer.setVolume(Math.min(s+10,100))}volumeDown(){let s=this.soundPlayer.getVolume();this.soundPlayer.setVolume(Math.max(s-10,0))}mute(){this.soundPlayer.mute()}unmute(){this.soundPlayer.unmute()}toggleMute(){this.soundPlayer.isMuted()?this.unmute():this.mute()}getVolume(){return this.soundPlayer.getVolume()}getSpeed(){return this.soundPlayer.speed()}on(s,d){let S=this.subscribers[s];S?S.push(d):this.subscribers[s]=[d]}startTrack(s){this.queue.clear(),this.play(s,!0)}startSeries(s){this.queue.clear(),this.queue.addSeries(s).then(()=>{this.next()}).catch(d=>{this.notify.error(d)})}startFolder(s){this.queue.clear(),this.queue.addFolder(s).then(()=>{this.next()}).catch(d=>{this.notify.error(d)})}startPlaylist(s){this.queue.clear(),this.queue.addPlaylist(s).then(()=>{this.next()}).catch(d=>{this.notify.error(d)})}startAlbum(s){this.queue.clear(),this.queue.addAlbum(s).then(()=>{this.next()}).catch(d=>{this.notify.error(d)})}startAlbums(s){this.queue.clear(),this.queue.addAlbums(s).then(()=>{this.next()}).catch(d=>{this.notify.error(d)})}startTracks(s){this.queue.clear(),this.queue.addMedias(s),this.next()}startArtists(s){this.queue.clear(),this.queue.addArtists(s).then(()=>{this.next()}).catch(d=>{this.notify.error(d)})}startArtist(s){this.queue.clear(),this.queue.addArtist(s).then(()=>{this.next()}).catch(d=>{this.notify.error(d)})}startPodcast(s){this.queue.clear(),this.queue.addPodcast(s).then(()=>{this.next()}).catch(d=>{this.notify.error(d)})}startEpisode(s){s.status===be.completed&&(this.queue.clear(),this.play(s,!0),this.next())}startEpisodeSeek(s,d){s.status===be.completed&&(this.currentMedia&&this.currentMedia.id===s.id?this.seek(d):(this.queue.clear(),this.play(s,!0,d)))}addEpisode(s){s.status===be.completed&&this.resolveAddTracks(this.queue.addEpisode(s))}addPodcast(s){this.resolveAddTracks(this.queue.addPodcast(s))}addSeries(s){this.resolveAddTracks(this.queue.addSeries(s))}addFolder(s){this.resolveAddTracks(this.queue.addFolder(s))}addPlaylist(s){this.resolveAddTracks(this.queue.addPlaylist(s))}addAlbum(s){this.resolveAddTracks(this.queue.addAlbum(s))}addArtist(s){this.resolveAddTracks(this.queue.addArtist(s))}addTrack(s){this.queue.add(s,!0),this.resolveAddTracks(Promise.resolve(1))}currentPercent(){return this.currentTime===void 0||this.totalTime===void 0?0:this.currentTime*100/this.totalTime}resolveAddTracks(s){s.then(d=>{this.notify.success(`Tracks added to queue: ${d}`)}).catch(d=>{this.notify.error(d)})}startPositionStore(){this.stopPositionStore(),this.positionStoreTimer=setInterval(()=>{this.syncPlayerWithLocalStorage()},10*1e3)}stopPositionStore(){clearInterval(this.positionStoreTimer)}setPlaying(s){this.isPlaying!==s&&(this.isPlaying=s,s?(this.startPositionStore(),this.scrobbleWatch.start()):(this.scrobbleWatch.pause(),this.stopPositionStore()),this.syncPlayerWithLocalStorage(),this.mediasession.setPlaybackState(s,!!this.currentMedia))}loadFromStorage(){this.loadQueueFromStorage();let s=this.userStorage.get(f.localPlayerStorageName);if(s){this.queue.currentIndex=s.index;let d=this.queue.getCurrent();d&&this.play(d,!1,s.position,!0)}}loadQueueFromStorage(){this.queue.set(this.userStorage.get(f.localQueueStorageName)??[])}syncPlayerWithLocalStorage(){let s={index:this.queue.currentIndex,position:Math.round(this.soundPlayer.position())};this.userStorage.set(f.localPlayerStorageName,s)}syncQueueWithLocalStorage(){this.userStorage.set(f.localQueueStorageName,this.queue.entries)}subscribeSoundPlayerEvents(){this.audioSupport=this.soundPlayer.getAudioSupport(),this.soundPlayer.on(g.PLAY,()=>{this.publish(g.PLAY,void 0),this.setPlaying(!0)}),this.soundPlayer.on(g.TRACK,s=>{this.publish(g.TRACK,s)}),this.soundPlayer.on(g.PLAYSTART,()=>{this.publish(g.PLAYSTART,void 0),this.setPlaying(!0)}),this.soundPlayer.on(g.PLAYRESUME,()=>{this.publish(g.PLAYRESUME,void 0),this.setPlaying(!0)}),this.soundPlayer.on(g.PAUSE,()=>{this.publish(g.PAUSE,void 0),this.setPlaying(!1)}),this.soundPlayer.on(g.FINISH,()=>{this.publish(g.FINISH,void 0),this.onTrackFinish()}),this.soundPlayer.on(g.LOADING,s=>{this.publish(g.LOADING,s)}),this.soundPlayer.on(g.BUFFERINGSTART,()=>{this.publish(g.BUFFERINGSTART,void 0)}),this.soundPlayer.on(g.BUFFERINGEND,()=>{this.publish(g.BUFFERINGEND,void 0),this.totalTime=this.soundPlayer.duration(),this.publish(g.TIME,this.currentTime??0)}),this.soundPlayer.on(g.SEEK,s=>{this.publish(g.SEEK,s)}),this.soundPlayer.on(g.SEEKED,()=>{this.publish(g.SEEKED,void 0)}),this.soundPlayer.on(g.VOLUME,s=>{this.publish(g.VOLUME,s)}),this.soundPlayer.on(g.MUTE,s=>{this.isMuted=s,this.publish(g.MUTE,s)}),this.soundPlayer.on(g.TIME,s=>{if(this.currentTime=s,this.totalTime=this.soundPlayer.duration(),!this.scrobbled&&this.currentMedia?.id){let d=this.scrobbleWatch.time(),S=Math.min(this.totalTime/2,14400*1e3);S>0&&d>=S&&(this.scrobbled=!0,this.jam.nowplaying.scrobble({id:this.currentMedia.id}).catch(A=>{console.error(A)}))}this.mediasession.updatePositionState(this.totalTime,this.getSpeed(),this.currentTime),this.publish(g.TIME,s)}),this.soundPlayer.on(g.SPEED,s=>{this.publish(g.SPEED,s)}),this.soundPlayer.on(g.AUDIOERROR,()=>{this.publish(g.AUDIOERROR,void 0),this.setPlaying(!1)}),this.soundPlayer.on(g.NOSTREAM,()=>{this.publish(g.NOSTREAM,void 0)})}subscribeMediaSessionEvents(){this.mediasession.on(x.PLAY,()=>{this.togglePlayPause()}),this.mediasession.on(x.PAUSE,()=>{this.togglePlayPause()}),this.mediasession.on(x.NEXT,()=>{this.next()}),this.mediasession.on(x.PREVIOUS,()=>{this.previous()}),this.mediasession.on(x.REWIND,()=>{this.rewind(5)}),this.mediasession.on(x.FORWARD,()=>{this.forward(5)}),this.mediasession.on(x.STOP,()=>{this.stop()}),this.mediasession.on(x.SEEK,s=>{this.seek(s.seekTime*1e3)})}publish(s,d){let S=this.subscribers[s];if(S)for(let A of S)A(d)}setCurrentMedia(s){this.mediasession.setMedia(s),this.setPushNotification(s)}closePushNotification(){this.currentNotification&&(this.notification.close(this.currentNotification),this.currentNotification=void 0)}setPushNotification(s){this.closePushNotification(),s&&this.notification.show({body:s.tag?.artist??"[Unknown Artist]",title:s.tag?.title??"[Unknown Title]",icon:this.jam.image.imageUrl({id:s.id,size:128,format:Qe.webp})}).then(d=>{this.currentNotification=d}).catch(d=>{console.error(d)})}};f.localPlayerStorageName="player",f.localQueueStorageName="queue",f.\u0275fac=function(d){return new(d||f)},f.\u0275prov=de({token:f,factory:f.\u0275fac,providedIn:"root"});let c=f;return c})();export{si as a,ai as b,g as c,Qi as d};
