<app-background-text *ngIf="!tracks || tracks.length===0" text="No Tracks in Queue"></app-background-text>

<context-menu #queueMenu>
	<ng-template contextMenuItem let-track>
		<app-context-entry-fav [base]="track" baseType="track"></app-context-entry-fav>
	</ng-template>
	<ng-template contextMenuItem let-track>
		<app-context-entry-rate [base]="track" baseType="track"></app-context-entry-rate>
	</ng-template>
	<ng-template contextMenuItem (execute)="queue.remove($event.item)"><i class="icon-list-add"></i> Remove From Queue</ng-template>
	<ng-template contextMenuItem (execute)="actions.download($event.item)"><i class="icon-download-cloud"></i> Download</ng-template>
	<ng-template contextMenuItem (execute)="navig.toTrack($event.item)"><i class="icon-track"></i> Show Track Details</ng-template>
</context-menu>

<div class="tracks-wrapper">
	<ng-container *ngIf="tracks && tracks.length>0">
		<cdk-virtual-scroll-viewport style="height: 100%; width:100%;" itemSize="60">
			<div class="tracks" cdkDropList [cdkDropListData]="tracks" (cdkDropListDropped)="onDrop($event)">
				<div class="track" *cdkVirtualFor="let track of tracks; let index = index"
						 (tap)="tapPlayQueuePos($event, index)"
						 (panstart)="onPanStart($event)"
						 (panmove)="onPanMove($event)"
						 (panend)="onPanEnd($event, track)"
						 (pancancel)="onPanCancel($event)"
						 [contextMenu]="queueMenu" [contextMenuSubject]="track"
						 cdkDrag>
					<div class="handle" cdkDragHandle><span class="grippy"></span></div>
					<div class="number">
						<ng-container *ngIf="player.currentTrack && player.currentTrack.id===track.id">
							<i [class]="{'icon-play':player.isPlaying,'icon-pause':!player.isPlaying}"></i>
						</ng-container>
						<ng-container *ngIf="!player.currentTrack || player.currentTrack.id!==track.id">
							<i class="icon-hash small-screen-icon"></i>
						</ng-container>
						<ng-container>{{index + 1}}</ng-container>
					</div>
					<div class="title"><p>{{track.tag ? track.tag.title : track.name}}</p><a *ngIf="track.tag && track.tag.artist" (click)="navig.toArtistID(track.artistID,track.tag.artist)">{{track.tag.artist}}</a></div>
					<div class="length"><i class="icon-stopwatch small-screen-icon"></i> {{track.duration|duration}}</div>
					<div class="remove"><a title="Remove From Queue" (click)="queue.remove(track)" appClickStop><i class="icon-remove"></i></a></div>
				</div>
			</div>
		</cdk-virtual-scroll-viewport>
	</ng-container>
</div>

<div *ngIf="showControls" class="queue-actions" [class.disabled]="!tracks || tracks.length===0">
	<button class="queue-action" (click)="queue.clear()" title="Clear Queue"><i class="icon-remove"></i> Clear</button>
	<button class="queue-action" (click)="queue.shuffle()" title="Randomize Order of Tracks"><i class="icon-shuffle"></i> Shuffle</button>
<!--	<button class="queue-action" (click)="newPlaylist(tracks)" title="Save to new Playlist"><i class="icon-playlist"></i> Save as</button>-->
</div>
