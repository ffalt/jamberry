import{a as f}from"./chunk-DYCPZPVS.js";import{G as c}from"./chunk-ZVKVGF76.js";import{$d as m,a as n,da as o,e as r,ia as a,ub as u}from"./chunk-H2EXZDP6.js";var C=(()=>{let t=class t{constructor(){this.usersChange=new u,this.userChange=new f,this.jam=a(m),this.notify=a(c),this.users=[]}applyDialogUser(s){return r(this,null,function*(){if(s.user)yield this.jam.user.update(n({id:s.user.id},s.edit)),this.refreshUser(s.user.id);else{let e=yield this.jam.user.create(s.edit);this.users.push(e),this.usersChange.emit(this.users)}})}removeUser(s){return r(this,null,function*(){yield this.jam.user.remove({id:s.id}),this.users=this.users.filter(e=>e.id!==s.id),this.usersChange.emit(this.users),this.userChange.emit(s.id)})}refreshUser(s){this.jam.user.id({id:s}).then(e=>{let i=this.users.findIndex(d=>d.id===s);i===-1?this.users.push(e):this.users[i]=e,this.usersChange.emit(this.users),this.userChange.emit(s,e)}).catch(e=>{this.notify.error(e)})}refreshUsers(){this.jam.user.search({}).then(s=>{this.users=s.items,this.usersChange.emit(this.users)}).catch(s=>{this.notify.error(s)})}setPassword(s,e,i){return r(this,null,function*(){return this.jam.user.changePassword({id:s,password:e,newPassword:i})})}};t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=o({token:t,factory:t.\u0275fac,providedIn:"root"});let h=t;return h})();export{C as a};
