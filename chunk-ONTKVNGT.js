import{c as k}from"./chunk-XP5ERWDG.js";import{a as j}from"./chunk-5YFZ6GCD.js";import{c as G,d as A,e as R,f as $,g as B,h as z,o as X}from"./chunk-Y5Z5ITNC.js";import{F as V,G as D}from"./chunk-ZVKVGF76.js";import{f as W,h as F}from"./chunk-T6GM3CFW.js";import{Ac as u,Hb as f,Ib as N,Ob as i,Pb as g,Qb as O,Ub as C,Vb as M,_b as x,_d as U,ab as l,ac as p,dc as T,fc as m,ia as s,na as v,nb as E,oa as I,tc as S,uc as y,vc as b,yc as P,zc as h}from"./chunk-H2EXZDP6.js";function q(r,a){if(r&1){let c=x();i(0,"label"),C(1),p(2,3),M(),i(3,"input",11),u("ngModelChange",function(e){v(c);let n=m();return h(n.credentials.server,e)||(n.credentials.server=e),I(e)}),g()()}if(r&2){let c=m();l(3),P("ngModel",c.credentials.server)}}function J(r,a){if(r&1&&(i(0,"div",10),S(1),g()),r&2){let c=m();l(),y(c.error)}}var ae=(()=>{let a=class a{constructor(){this.app=s(k),this.credentials={server:"",username:"",password:""},this.showServer=!1,this.route=s(W),this.router=s(F),this.auth=s(U),this.notify=s(D),this.init()}init(){let o=this.getFixed();this.credentials.server=o.server??"",this.credentials.username=o.user??"",this.credentials.password=o.pass??"",this.showServer=this.credentials.server==="",this.auth.clear().catch(e=>{console.error(e)})}getFixed(){return document.jamberry_config?.fixed??{}}ngOnInit(){this.returnUrl=decodeURIComponent(this.returnUrlFromRoute()??"/library")}returnUrlFromRoute(){return this.route.snapshot.queryParams.returnUrl}login(o){o.preventDefault(),this.auth.login(this.credentials.server,this.credentials.username,this.credentials.password).then(()=>{this.router.navigateByUrl(this.returnUrl??"/library").catch(e=>{console.error(e)})}).catch(e=>{this.notify.error(e),this.error=V(e)})}};a.\u0275fac=function(e){return new(e||a)},a.\u0275cmp=E({type:a,selectors:[["app-login"]],decls:21,vars:5,consts:()=>{let o;o=$localize`:␟08c74dc9762957593b91f6eb5d65efdfc975bf48␟5248717555542428023:Username`;let e;e=$localize`:␟c32ef07f8803a223a83ed17024b38e8d82292407␟1431416938026210429:Password`;let n;n=$localize`:␟6765b4c916060f6bc42d9bb69e80377dbcb5e4e9␟2454050363478003966:Login`;let d;d=$localize`:␟e08a77594f3d89311cdf6da5090044270909c194␟2392488717875840729:User`;let t;t=$localize`:␟c32ef07f8803a223a83ed17024b38e8d82292407␟1431416938026210429:Password`;let L;L=$localize`:␟905882c0fe09eee755ee6730ecf10e3b85cb6d9c␟2188854519574316630:Server`;let w;return w=$localize`:␟905882c0fe09eee755ee6730ecf10e3b85cb6d9c␟2188854519574316630:Server`,[n,d,t,w,[1,"view-login"],[1,"container-login",3,"submit"],[1,"login-card"],["autocomplete","username","name","user","placeholder",o,"type","text",3,"ngModelChange","ngModel"],["autocomplete","password","name","pass","placeholder",e,"type","password",3,"ngModelChange","ngModel"],["name","login","type","submit","value","login",1,"login-submit"],[1,"error"],["type","text","name","server","placeholder",L,3,"ngModelChange","ngModel"]]},template:function(e,n){e&1&&(i(0,"div",4)(1,"div",5),T("submit",function(t){return n.login(t)}),i(2,"div",6)(3,"h1"),O(4,"app-logo-icon"),S(5),C(6),p(7,0),M(),g(),O(8,"br"),i(9,"form"),f(10,q,4,1,"label"),i(11,"label"),C(12),p(13,1),M(),i(14,"input",7),u("ngModelChange",function(t){return h(n.credentials.username,t)||(n.credentials.username=t),t}),g()(),i(15,"label"),C(16),p(17,2),M(),i(18,"input",8),u("ngModelChange",function(t){return h(n.credentials.password,t)||(n.credentials.password=t),t}),g()(),O(19,"input",9),g()(),f(20,J,2,1,"div",10),g()()),e&2&&(l(5),b("\xA0",n.app.name," "),l(5),N(n.showServer?10:-1),l(4),P("ngModel",n.credentials.username),l(4),P("ngModel",n.credentials.password),l(2),N(n.error?20:-1))},dependencies:[X,z,G,A,R,B,$,j],styles:["[_nghost-%COMP%]   .view-login[_ngcontent-%COMP%]{position:fixed;height:100%;width:100%;overflow-y:auto}[_nghost-%COMP%]   .view-login[_ngcontent-%COMP%]   .container-login[_ngcontent-%COMP%]{max-width:400px;width:80%;z-index:15;margin-left:auto;margin-right:auto;margin-top:100px}[_nghost-%COMP%]   .view-login[_ngcontent-%COMP%]   .error[_ngcontent-%COMP%]{text-align:center;color:var(--accent)}[_nghost-%COMP%]   .view-login[_ngcontent-%COMP%]   .login-card[_ngcontent-%COMP%]{overflow:hidden;padding:30px;min-width:274px;max-width:400px;margin:0 auto 10px;border-radius:2px;border-style:solid;border-width:1px}[_nghost-%COMP%]   .view-login[_ngcontent-%COMP%]   .login-card[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-weight:100;text-align:center;font-size:2.3em}[_nghost-%COMP%]   .view-login[_ngcontent-%COMP%]   .login-card[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]   app-logo-icon[_ngcontent-%COMP%]{height:42px;width:42px;vertical-align:baseline}[_nghost-%COMP%]   .view-login[_ngcontent-%COMP%]   .login-card[_ngcontent-%COMP%]   input[type=submit][_ngcontent-%COMP%]{width:100%;display:block;margin-bottom:10px;position:relative}[_nghost-%COMP%]   .view-login[_ngcontent-%COMP%]   .login-card[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%], [_nghost-%COMP%]   .view-login[_ngcontent-%COMP%]   .login-card[_ngcontent-%COMP%]   input[type=password][_ngcontent-%COMP%]{height:44px;font-size:16px;width:100%;margin-top:4px;margin-bottom:10px;padding:0 8px;box-sizing:border-box}[_nghost-%COMP%]   .view-login[_ngcontent-%COMP%]   .login-card[_ngcontent-%COMP%]   .login-submit[_ngcontent-%COMP%]{text-align:center;font-size:14px;font-weight:700;height:36px;padding:0 8px;border:0;cursor:pointer;background-color:var(--primary);color:var(--on-primary)}[_nghost-%COMP%]   .view-login[_ngcontent-%COMP%]   .login-card[_ngcontent-%COMP%]   .login-submit[_ngcontent-%COMP%]:hover{border:0}[_nghost-%COMP%]   .view-login[_ngcontent-%COMP%]   .login-card[_ngcontent-%COMP%]   .login-help[_ngcontent-%COMP%]{width:100%;text-align:center;font-size:12px}[_nghost-%COMP%]   .view-login[_ngcontent-%COMP%]   .login-card[_ngcontent-%COMP%]   .login-help[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none;font-weight:400;text-align:center;display:inline-block;opacity:.6;transition:opacity ease .5s}[_nghost-%COMP%]   .view-login[_ngcontent-%COMP%]   .login-card[_ngcontent-%COMP%]   .login-help[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{opacity:1}@media (max-width: 522px){[_nghost-%COMP%]   .view-login[_ngcontent-%COMP%]{margin-top:-20px}[_nghost-%COMP%]   .view-login[_ngcontent-%COMP%]   .container-login[_ngcontent-%COMP%]{margin-top:0}[_nghost-%COMP%]   .view-login[_ngcontent-%COMP%]   .container-login[_ngcontent-%COMP%]   .login-card[_ngcontent-%COMP%]{min-width:inherit}[_nghost-%COMP%]   .view-login[_ngcontent-%COMP%]   .container-login[_ngcontent-%COMP%]   .login-card[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin-top:0;margin-bottom:0;font-size:1.5em}}"]});let r=a;return r})();export{ae as LoginComponent};
