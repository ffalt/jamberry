import{$,$a as Z,A as N,Aa as O,Ba as y,Ca as C,Cc as pt,Dc as k,E as H,Ec as lt,Ga as W,H as a,Ha as G,Ia as _,La as J,Md as at,O as K,Ob as st,Od as ct,Q as R,Qd as ut,Rd as mt,Sd as ht,Td as ft,Ud as dt,V as F,W as V,Z as j,_ as c,a as w,aa as g,ba as B,da as D,f,gb as tt,hb as et,i as d,ia as Q,ib as s,ja as X,jb as ot,lb as it,m as T,n as S,o as P,oa as Y,pa as L,qa as z,r as p,s as I,tb as nt,u as M,ua as U,y as q,yb as rt,z as l,za as v}from"./chunk-2CUFB47X.js";var x=(()=>{class o{tpl=a(V);static \u0275fac=function(t){return new(t||o)};static \u0275dir=g({type:o,selectors:[["","appAutocompleteContent",""]],standalone:!1})}return o})();var gt=["root"],vt=o=>({control:o});function yt(o,m){o&1&&U(0)}function Ct(o,m){if(o&1&&(L(0,"div",1),D(1,yt,1,0,"ng-container",2),z()),o&2){let e=O().control,t=O();F(),Y("ngTemplateOutlet",t.content().tpl)("ngTemplateOutletContext",Z(2,vt,e))}}function xt(o,m){if(o&1&&Q(0,Ct,2,4,"div",1),o&2){let e=m.control;X(e!=null&&e.isVisible?0:-1)}}var bt=(()=>{class o{rootTemplate=ot.required("root");content=it.required(x);static \u0275fac=function(t){return new(t||o)};static \u0275cmp=c({type:o,selectors:[["app-autocomplete"]],contentQueries:function(t,i,n){t&1&&W(n,i.content,x,5),t&2&&_()},viewQuery:function(t,i){t&1&&G(i.rootTemplate,gt,5),t&2&&_()},exportAs:["appAutocomplete"],standalone:!1,decls:2,vars:0,consts:[["root",""],[1,"ac-content"],[4,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(t,i){t&1&&D(0,xt,1,1,"ng-template",null,0,tt)},dependencies:[nt],styles:[".ac-content[_ngcontent-%COMP%]{width:100%;display:block;overflow-y:auto;background-color:var(--control);color:var(--on-control);box-shadow:var(--control-box-shadow);border-color:var(--control-box-border);border-width:1px;border-style:solid;border-radius:0;font-size:14px}"]})}return o})();function At(o){return o.target.value}var h=-1;function wt(o,m){return P(document,"click").pipe(p(e=>{let t=e.target,i=t!==m,n=!!o&&!o.overlayElement.contains(t);return i&&n}),l(o.detachments()))}var Dt=(()=>{class o{appAutocomplete=s();appAutocompleteControl=s();appAutocompleteSettings=s();appAutocompleteNavigKeyDown=et();isVisible=!1;activeIndex=h;query="";options=[];unsubscribe=new d;host=a(R);vcr=a(j);overlay=a(lt);keydown$=new d;keyup$=new d;overlayRef;settings={allowEmpty:!1,debounceTime:300};isCreated=!1;ngOnInit(){this.filterEnterEvent(this.keydown$),this.listenAndSuggest(this.keyup$),this.navigateSuggestionsWithArrows(this.keydown$)}ngOnDestroy(){this.unsubscribe.next(),this.unsubscribe.complete()}ngOnChanges(e){e.appAutocompleteSettings&&(this.settings=w(w({},this.settings),this.appAutocompleteSettings()))}selectOption(e){this.hide();let t=this.appAutocompleteControl();t&&(this.query=t.autocompleteSelectResult(e))}handleEsc(e){dt(e)&&(this.hide(),e.preventDefault()),this.keydown$.next(e)}onkeyup(e){e.preventDefault(),e.stopPropagation(),this.keyup$.next(e)}run(){!this.query||this.query.length==0||this.request(this.query).then(e=>{this.activeIndex=h,this.options=e,this.display()}).catch(e=>console.error(e))}static resolveNextIndex(e,t,i){let n=t?1:-1,r=i.length-1,E=h,b=e+n,A=b;return b===r+1&&(A=E),b===E-1&&(A=r),A}updateIndex(e){this.activeIndex=o.resolveNextIndex(this.activeIndex,ht(e),this.options)}listenAndSuggest(e){e.pipe(p(t=>!at(t)),T(At),I(this.settings.debounceTime),S,M(),N(t=>f(this,null,function*(){return this.query=t})),p(t=>this.settings.allowEmpty||t.length>0),q(t=>f(this,null,function*(){return this.request(t)})),l(this.unsubscribe)).subscribe(t=>{this.activeIndex=h,this.options=t,this.display()})}display(){if(!this.options||this.options.length===0){this.isVisible=!1;return}this.isCreated||this.openDropdown(),this.isVisible=this.options&&this.options.length>0}request(e){return f(this,null,function*(){let t=this.appAutocompleteControl();return t?t.autocompleteGetData(e):[]})}filterEnterEvent(e){e.pipe(p(ft),l(this.unsubscribe)).subscribe(()=>{if(!this.isVisible){this.query=this.host.nativeElement.value;let n=this.appAutocompleteControl();n&&n.autocompleteEnter(this.query);return}let t=this.options[this.activeIndex];this.hide();let i=this.appAutocompleteControl();t?this.selectOption(t):i&&i.autocompleteEnter(this.query)})}navigateSuggestionsWithArrows(e){e.pipe(p(ct),l(this.unsubscribe)).subscribe(t=>{ut(t)?(this.hide(),this.host.nativeElement.selectionStart===this.host.nativeElement.value.length&&this.appAutocompleteNavigKeyDown.emit(t)):mt(t)?(this.hide(),this.host.nativeElement.selectionEnd===0&&this.appAutocompleteNavigKeyDown.emit(t)):this.isVisible?(this.updateIndex(t),this.display()):this.appAutocompleteNavigKeyDown.emit(t)})}openDropdown(){let e=this.appAutocomplete()?.rootTemplate();if(!e)return;this.overlayRef=this.createOverlay();let t=new st(e,this.vcr,{control:this});this.overlayRef.attach(t),wt(this.overlayRef,this.host.nativeElement).pipe(l(this.unsubscribe)).subscribe(()=>{this.close()}),this.isCreated=!0,this.isVisible=!0}hide(){this.isVisible=!1,this.activeIndex=h}close(){this.overlayRef&&(this.overlayRef.detach(),this.overlayRef=void 0),this.isCreated=!1}createOverlay(){return this.overlay.create(this.getOverlayConfig())}getOverlayConfig(){return new pt({hasBackdrop:!1,backdropClass:"",panelClass:"ngx-autocomplete",scrollStrategy:this.overlay.scrollStrategies.block(),positionStrategy:this.getOverlayPosition()})}getOverlayPosition(){let e=[new k({originX:"start",originY:"bottom"},{overlayX:"start",overlayY:"top"}),new k({originX:"start",originY:"top"},{overlayX:"start",overlayY:"bottom"})];return this.overlay.position().flexibleConnectedTo(this.host).withFlexibleDimensions(!1).withPositions(e).withPush(!1)}static \u0275fac=function(t){return new(t||o)};static \u0275dir=g({type:o,selectors:[["","appAutocomplete",""]],hostBindings:function(t,i){t&1&&v("keydown",function(r){return i.handleEsc(r)})("keyup",function(r){return i.onkeyup(r)})},inputs:{appAutocomplete:[1,"appAutocomplete"],appAutocompleteControl:[1,"appAutocompleteControl"],appAutocompleteSettings:[1,"appAutocompleteSettings"]},outputs:{appAutocompleteNavigKeyDown:"appAutocompleteNavigKeyDown"},standalone:!1,features:[K]})}return o})();var Ot=(()=>{class o{transform(e,t){let i=t.replace(/[-[\]/{}()*+?.\\^$|]/g,"\\$&");i=i.split(" ").filter(r=>r.length>0).join("|");let n=new RegExp(i,"gi");return t?e.replace(n,r=>`<b>${r}</b>`):e}static \u0275fac=function(t){return new(t||o)};static \u0275pipe=B({name:"highlight",type:o,pure:!0,standalone:!1})}return o})();var _t=["*"],kt=(()=>{class o{option=s();control=s();get getActive(){let e=this.control();return e?e.options[e.activeIndex]===this.option():!1}mouseDownEvent(e){let t=this.control(),i=this.option();t&&i&&(t.selectOption(i),e.stopPropagation())}static \u0275fac=function(t){return new(t||o)};static \u0275cmp=c({type:o,selectors:[["app-autocomplete-option"]],hostVars:2,hostBindings:function(t,i){t&1&&v("mousedown",function(r){return i.mouseDownEvent(r)}),t&2&&J("active",i.getActive)},inputs:{option:[1,"option"],control:[1,"control"]},standalone:!1,ngContentSelectors:_t,decls:1,vars:0,template:function(t,i){t&1&&(y(),C(0))},styles:["[_nghost-%COMP%]{display:block;padding:5px;cursor:pointer}[_nghost-%COMP%]:hover{background-color:var(--control-hover);color:var(--on-control-hover)}.active[_nghost-%COMP%]{background-color:var(--control-active);color:var(--on-control-active)}[_nghost-%COMP%]     b{color:var(--on-control-active)}"],changeDetection:0})}return o})();var Et=["*"],Tt=(()=>{class o{static \u0275fac=function(t){return new(t||o)};static \u0275cmp=c({type:o,selectors:[["app-autocomplete-option-header"]],standalone:!1,ngContentSelectors:Et,decls:1,vars:0,template:function(t,i){t&1&&(y(),C(0))},styles:["[_nghost-%COMP%]{display:block;padding:5px;font-size:11px;background-color:var(--control-box);color:var(--on-control);text-transform:uppercase;letter-spacing:1px}"]})}return o})();var se=(()=>{class o{static \u0275fac=function(t){return new(t||o)};static \u0275mod=$({type:o});static \u0275inj=H({imports:[rt]})}return o})();export{x as a,bt as b,Dt as c,Tt as d,Ot as e,kt as f,se as g};
