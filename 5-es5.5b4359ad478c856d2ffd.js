function _get(t,e,n){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=_superPropBase(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function _superPropBase(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=_getPrototypeOf(t)););return t}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _createSuper(t){return function(){var e,n=_getPrototypeOf(t);if(_isNativeReflectConstruct()){var i=_getPrototypeOf(this).constructor;e=Reflect.construct(n,arguments,i)}else e=n.apply(this,arguments);return _possibleConstructorReturn(this,e)}}function _possibleConstructorReturn(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _createForOfIteratorHelper(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=_unsupportedIterableToArray(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o,r=!0,a=!1;return{s:function(){i=t[Symbol.iterator]()},n:function(){var t=i.next();return r=t.done,t},e:function(t){a=!0,o=t},f:function(){try{r||null==i.return||i.return()}finally{if(a)throw o}}}}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{"13Ib":function(t,e,n){"use strict";n.r(e),n.d(e,"AdminModule",(function(){return Po}));var i,o,r=n("vxfF"),a=n("ofXK"),c=n("3Pt+"),s=n("jhN1"),l=n("EgUb"),d=n("CUJY"),h=n("FpXt"),u=n("rIor"),g=n("fXoL"),p=((i=function t(){_classCallCheck(this,t)}).\u0275fac=function(t){return new(t||i)},i.\u0275cmp=g.Jb({type:i,selectors:[["app-admin"]],decls:6,vars:0,consts:[[1,"left"],[1,"middle"]],template:function(t,e){1&t&&(g.Vb(0,"div",0),g.Qb(1,"app-admin-sidebar"),g.Ub(),g.Qb(2,"app-splitter"),g.Vb(3,"div",1),g.Qb(4,"router-outlet"),g.Ub(),g.Qb(5,"app-admin-queue-requests"))},styles:["[_nghost-%COMP%]{width:100%;height:100%;flex:1;display:flex;flex-flow:row nowrap;overflow:hidden;align-items:flex-start;align-content:flex-start}[_nghost-%COMP%]   .left[_ngcontent-%COMP%]{width:15%;height:100%;min-width:140px}[_nghost-%COMP%]   .middle[_ngcontent-%COMP%]{width:85%;flex-grow:1;height:100%}@media (max-width:1400px){[_nghost-%COMP%]   .left[_ngcontent-%COMP%]{width:20%}[_nghost-%COMP%]   .middle[_ngcontent-%COMP%]{width:80%}}@media (max-width:768px){[_nghost-%COMP%]{min-height:100%;position:absolute;display:block;flex:none;flex-flow:inherit}[_nghost-%COMP%]   app-splitter[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .left[_ngcontent-%COMP%]{width:100%!important;height:auto}[_nghost-%COMP%]   .middle[_ngcontent-%COMP%]{width:100%;min-height:100%}}"]}),i),f=n("mrSG"),b=n("XNiG"),m=n("1G5W"),v=n("tyNb"),C=((o=function(){function t(e){_classCallCheck(this,t),this.route=e,this.unsubscribe=new b.a}return _createClass(t,[{key:"ngOnInit",value:function(){var t=this;this.route&&this.route.parent&&this.route.parent.params.pipe(Object(m.a)(this.unsubscribe)).subscribe((function(e){t.resolve(e),t.refresh()}))}},{key:"idChanged",value:function(){}},{key:"refresh",value:function(){}},{key:"ngOnDestroy",value:function(){this.unsubscribe.next(),this.unsubscribe.complete()}},{key:"resolve",value:function(t){this.id=t.id,this.idChanged()}}]),t}()).\u0275fac=function(t){return new(t||o)(g.Pb(v.a))},o.\u0275cmp=g.Jb({type:o,selectors:[["app-admin-base-parent-view-id"]],decls:0,vars:0,template:function(t,e){},styles:[""]}),o),M=n("S2AD"),O=n("bQbs"),y=n("6O88"),P=n("gOm6");function _(t,e){1&t&&g.Qb(0,"i",14)}function k(t,e){if(1&t&&(g.Vb(0,"i"),g.hc(1,"stringToggle"),g.Ub()),2&t){var n=g.gc().$implicit;g.Eb(g.kc(1,2,n.expanded,"icon-minus","icon-plus"))}}function x(t,e){if(1&t){var n=g.Wb();g.Tb(0),g.Vb(1,"div",7),g.dc("click",(function(){g.yc(n);var t=e.$implicit;return g.gc().selectNode(t)})),g.Vb(2,"span",8),g.dc("click",(function(){g.yc(n);var t=e.$implicit;return g.gc().toggleNode(t)})),g.Gc(3,_,1,0,"i",9),g.Gc(4,k,2,6,"i",10),g.Ub(),g.Vb(5,"span",11),g.dc("click",(function(){g.yc(n);var t=e.$implicit;return g.gc().toggleNode(t)})),g.Vb(6,"i"),g.hc(7,"stringToggle"),g.Ub(),g.Ub(),g.Vb(8,"span",12),g.Ic(9),g.Ub(),g.Vb(10,"span",13),g.Ic(11),g.Ub(),g.Ub(),g.Sb()}if(2&t){var i=e.$implicit,o=g.gc();g.Cb(1),g.Fc("padding-left",12*i.level,"px"),g.Gb("active",i===o.selected),g.Cb(1),g.pc("title","Subfolders: ",i.folder.folderCount,""),g.Cb(1),g.nc("ngIf",i.isLoading),g.Cb(1),g.nc("ngIf",!i.isLoading&&i.hasChildren),g.Cb(1),g.Fc("color",i.color),g.nc("title",i.folder.type),g.Cb(1),g.Eb(g.kc(7,15,i.expanded,"icon-folder-open","icon-folder")),g.Cb(2),g.nc("title",i.folder.name),g.Cb(1),g.Jc(i.folder.name),g.Cb(2),g.Kc("| ",i.folder.type,"")}}var w,I,U=((I=function(){function t(e,n,i,o){_classCallCheck(this,t),this.app=e,this.jam=n,this.notify=i,this.folderService=o,this.nodes=[],this.expandIDs=[],this.autoSelect=!1,this.selectionChange=new g.n,this.unsubscribe=new b.a}return _createClass(t,[{key:"ngOnInit",value:function(){var t=this;this.folderService.foldersChange.pipe(Object(m.a)(this.unsubscribe)).subscribe((function(e){var n=t.nodes.find((function(t){return t.folder.id===e.id}));n&&t.jam.folder.id({id:e.id,folderCounts:!0}).then((function(i){n.folder=i,e.mode===O.b.fsnRefreshChilds&&n.expanded&&(t.collapseNode(n),n.hasChildren=i.folderCount>0,n.children=void 0,n.isLoading=!1,n.hasChildren&&(n.expanded=!0,t.checkLoadExpanded(n)))})).catch((function(t){console.error(t)}))}))}},{key:"ngOnDestroy",value:function(){this.unsubscribe.next(),this.unsubscribe.complete()}},{key:"selectNode",value:function(t){this.selectionChange.emit(t.folder),this.autoSelect&&(this.selected=t)}},{key:"toggleNode",value:function(t){t.expanded?this.collapseNode(t):this.expandNode(t)}},{key:"refresh",value:function(){var t=this;this.jam.auth.isLoggedIn()&&this.jam.folder.search({level:0,folderCounts:!0}).then((function(e){t.nodes=e.items.map((function(e){return{folder:e,hasChildren:e.folderCount>0,level:0,color:t.typeToColor(e),expanded:t.expandIDs.includes(e.id),isLoading:!1}}));var n,i=_createForOfIteratorHelper(t.nodes);try{for(i.s();!(n=i.n()).done;){var o=n.value;t.checkLoadExpanded(o)}}catch(r){i.e(r)}finally{i.f()}})).catch((function(e){t.notify.error(e)}))}},{key:"typeToColor",value:function(t){switch(t.type){case y.e.unknown:return"#ff9fAA";case y.e.artist:return"#6f806e";case y.e.collection:return"#adbced";case y.e.album:return"#bdbd9c";case y.e.multialbum:return"#bdaaae";case y.e.extras:return"#bdbdbd";default:return""}}},{key:"onFolderUpdate",value:function(t){var e=this.nodes.find((function(e){return e.folder.id===t.id}));e&&(e.folder=t)}},{key:"selectFolderByID",value:function(t){var e=this,n=this.nodes.find((function(e){return e.folder.id===t}));n?this.selected=n:this.jam.folder.id({id:t,folderParents:!0}).then((function(n){if(n.parents){var i,o=_createForOfIteratorHelper(n.parents);try{for(o.s();!(i=o.n()).done;){var r=i.value;e.expandIDs.includes(r.id)||e.expandIDs.push(r.id)}}catch(l){o.e(l)}finally{o.f()}var a,c=_createForOfIteratorHelper(e.nodes);try{for(c.s();!(a=c.n()).done;){var s=a.value;s.expanded=e.expandIDs.includes(s.folder.id),e.checkLoadExpanded(s,t)}}catch(l){c.e(l)}finally{c.f()}}})).catch((function(t){e.notify.error(t)}))}},{key:"checkLoadExpanded",value:function(t,e){var n=this;t.expanded&&!t.isLoading&&this.loadChildren(t,(function(t){var i,o=_createForOfIteratorHelper(t);try{for(o.s();!(i=o.n()).done;){var r=i.value;n.checkLoadExpanded(r,e)}}catch(a){o.e(a)}finally{o.f()}})),t.folder.id===e&&(this.selected=t,this.viewport&&this.viewport.scrollToIndex(this.nodes.indexOf(t)))}},{key:"loadChildren",value:function(t,e){var n=this;t.isLoading||(t.isLoading=!0,this.jam.folder.search({parentID:t.folder.id,folderCounts:!0}).then((function(i){var o=i.items.sort((function(t,e){return t.name.localeCompare(e.name)})).map((function(e){return{folder:e,hasChildren:e.folderCount>0,level:t.level+1,color:n.typeToColor(e),expanded:n.expandIDs.includes(e.id),isLoading:!1}})),r=n.nodes.indexOf(t);r>=0&&(n.nodes=n.nodes.slice(0,r+1).concat(o).concat(n.nodes.slice(r+1))),t.children=o,t.isLoading=!1,e&&e(o)})).catch((function(t){n.notify.error(t)})))}},{key:"collapseNode",value:function(t){if(t.expanded){var e=[];!function t(e,n){if(e.children){var i,o=_createForOfIteratorHelper(e.children);try{for(o.s();!(i=o.n()).done;){var r=i.value;n(r),t(r,n)}}catch(a){o.e(a)}finally{o.f()}}}(t,(function(t){return e.push(t.folder.id)})),this.nodes=this.nodes.filter((function(t){return!e.includes(t.folder.id)})),t.expanded=!1,t.children=void 0,this.expandIDs=(this.expandIDs||[]).filter((function(e){return e!==t.folder.id}))}}},{key:"expandNode",value:function(t){if(!t.expanded){if(t.children){var e=this.nodes.indexOf(t);this.nodes=this.nodes.slice(0,e+1).concat(t.children).concat(this.nodes.slice(e+1))}else this.loadChildren(t);this.expandIDs.push(t.folder.id),t.expanded=!0}}}]),t}()).\u0275fac=function(t){return new(t||I)(g.Pb(O.e),g.Pb(y.k),g.Pb(O.i),g.Pb(O.a))},I.\u0275cmp=g.Jb({type:I,selectors:[["app-admin-folder-tree"]],viewQuery:function(t,e){var n;1&t&&g.Ec(r.d,!0),2&t&&g.uc(n=g.ec())&&(e.viewport=n.first)},inputs:{autoSelect:"autoSelect"},outputs:{selectionChange:"selectionChange"},decls:9,vars:2,consts:[[1,"actions"],[1,"name"],["title","Refresh List",1,"button-on-control",3,"click"],[1,"icon-reload"],[1,"tree"],[1,"list-container","list-group",2,"height","100%",3,"itemSize"],[4,"cdkVirtualFor","cdkVirtualForOf"],[1,"node",3,"click"],[1,"node-toggle",3,"title","click"],["class","icon-spin icon-spinner",4,"ngIf"],[3,"class",4,"ngIf"],[1,"node-icon",3,"title","click"],[3,"title"],[1,"node-type"],[1,"icon-spin","icon-spinner"]],template:function(t,e){1&t&&(g.Vb(0,"div",0),g.Vb(1,"span",1),g.Ic(2,"Folders"),g.Ub(),g.Vb(3,"button",2),g.dc("click",(function(){return e.refresh()})),g.Qb(4,"i",3),g.Ic(5," Refresh"),g.Ub(),g.Ub(),g.Vb(6,"div",4),g.Vb(7,"cdk-virtual-scroll-viewport",5),g.Gc(8,x,12,19,"ng-container",6),g.Ub(),g.Ub()),2&t&&(g.Cb(7),g.nc("itemSize",22),g.Cb(1),g.nc("cdkVirtualForOf",e.nodes))},directives:[r.d,r.a,r.c,a.t],pipes:[P.a],styles:["[_nghost-%COMP%]{width:100%;height:100%;display:flex;flex-direction:column}[_nghost-%COMP%]   .actions[_ngcontent-%COMP%]{padding:10px 15px;background-color:var(--background-transparent);color:var(--on-control)}[_nghost-%COMP%]   .actions[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{padding-right:10px;vertical-align:middle;color:var(--on-control-active);font-size:20px;font-weight:100}[_nghost-%COMP%]   .tree[_ngcontent-%COMP%]{margin-top:10px;flex:1}[_nghost-%COMP%]   cdk-virtual-scroll-viewport[_ngcontent-%COMP%]{width:100%;height:100%;min-height:100%;overflow-x:hidden}[_nghost-%COMP%]   cdk-virtual-scroll-viewport[_ngcontent-%COMP%]     .cdk-virtual-scroll-content-wrapper{width:100%}[_nghost-%COMP%]   .node[_ngcontent-%COMP%]{width:100%;display:block;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;text-decoration:none;vertical-align:middle;height:22px;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;font-size:.9em}[_nghost-%COMP%]   .node[_ngcontent-%COMP%]   .node-toggle[_ngcontent-%COMP%]{display:inline-block;min-width:20px}[_nghost-%COMP%]   .node[_ngcontent-%COMP%]   .node-type[_ngcontent-%COMP%]{padding-left:5px;font-size:.7em;text-transform:uppercase}[_nghost-%COMP%]   .node.active[_ngcontent-%COMP%]{color:var(--on-control-hover)}"]}),I),S=((w=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"selectionChange",value:function(t){this.data.folder=t}},{key:"dialogInit",value:function(t,e){this.data=e.data,this.tree.refresh(),this.tree.selectFolderByID(e.data.selectID)}}]),t}()).\u0275fac=function(t){return new(t||w)},w.\u0275cmp=g.Jb({type:w,selectors:[["app-dialog-choose-folder"]],viewQuery:function(t,e){var n;1&t&&g.Ec(U,!0),2&t&&g.uc(n=g.ec())&&(e.tree=n.first)},decls:1,vars:1,consts:[[3,"autoSelect","selectionChange"]],template:function(t,e){1&t&&(g.Vb(0,"app-admin-folder-tree",0),g.dc("selectionChange",(function(t){return e.selectionChange(t)})),g.Ub()),2&t&&g.nc("autoSelect",!0)},directives:[U],styles:["[_nghost-%COMP%]{flex:1}"]}),w),V=function(){return{standalone:!0}};function A(t,e){if(1&t){var n=g.Wb();g.Vb(0,"div"),g.Vb(1,"form"),g.Vb(2,"div",1),g.Vb(3,"label"),g.Ic(4,"Name"),g.Ub(),g.Vb(5,"input",2),g.dc("ngModelChange",(function(t){return g.yc(n),g.gc().edit.name=t})),g.Ub(),g.Ub(),g.Ub(),g.Ub()}if(2&t){var i=g.gc();g.Cb(5),g.nc("ngModel",i.edit.name)("ngModelOptions",g.rc(2,V))}}var R,z=((R=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"dialogInit",value:function(t,e){this.edit=e.data}}]),t}()).\u0275fac=function(t){return new(t||R)},R.\u0275cmp=g.Jb({type:R,selectors:[["app-dialog-folder"]],decls:1,vars:1,consts:[[4,"ngIf"],[1,"user-form-control"],["type","text","name","folder-name",3,"ngModel","ngModelOptions","ngModelChange"]],template:function(t,e){1&t&&g.Gc(0,A,6,3,"div",0),2&t&&g.nc("ngIf",e.edit)},directives:[a.t,c.w,c.j,c.k,c.c,c.i,c.l],styles:["[_nghost-%COMP%] > div[_ngcontent-%COMP%]{margin-left:20px;margin-right:20px}[_nghost-%COMP%]   input[type=text][_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]   input[_ngcontent-%COMP%]{font-size:1.3em;line-height:1.3em}[_nghost-%COMP%]   .user-form-control[_ngcontent-%COMP%]{margin-bottom:8px;display:block}"]}),R),F=n("WXCC"),D=n("ZNE6"),Q=n("jDOu"),j=n("PJw1"),T=n("oyw4");function E(t,e){if(1&t&&(g.Tb(0),g.Ic(1),g.Sb()),2&t){var n=g.gc().$implicit;g.Cb(1),g.Kc(" / ",n.folder.tag.albumType,"")}}var G=function(t){return["/admin/folder",t,"overview"]};function B(t,e){if(1&t&&(g.Vb(0,"tr",10),g.dc("click",(function(){var t=e.$implicit;return t.selected=!t.selected})),g.Vb(1,"td",4),g.Vb(2,"a",11),g.Ic(3),g.Ub(),g.Ub(),g.Vb(4,"td",5),g.Ic(5),g.Ub(),g.Vb(6,"td",6),g.Ic(7),g.Ub(),g.Vb(8,"td",7),g.Ic(9),g.Ub(),g.Vb(10,"td",8),g.Ic(11),g.Gc(12,E,2,1,"ng-container",12),g.Ub(),g.Ub()),2&t){var n=e.$implicit;g.Gb("selected",n.selected),g.Cb(2),g.nc("routerLink",g.sc(9,G,n.folder.id)),g.Cb(1),g.Jc(n.folder.name),g.Cb(2),g.Jc(n.folder.tag.artist),g.Cb(2),g.Jc(n.folder.tag.album),g.Cb(2),g.Jc(n.folder.tag.year),g.Cb(2),g.Kc(" ",n.folder.type," "),g.Cb(1),g.nc("ngIf",n.folder.tag.albumType)}}function H(t,e){if(1&t&&(g.Vb(0,"table",2),g.Vb(1,"tr",3),g.Vb(2,"td",4),g.Ic(3,"Title"),g.Ub(),g.Vb(4,"td",5),g.Ic(5,"Artist"),g.Ub(),g.Vb(6,"td",6),g.Ic(7,"Album"),g.Ub(),g.Vb(8,"td",7),g.Ic(9,"Year"),g.Ub(),g.Vb(10,"td",8),g.Ic(11,"Type"),g.Ub(),g.Ub(),g.Gc(12,B,13,11,"tr",9),g.Ub()),2&t){var n=g.gc();g.Cb(12),g.nc("ngForOf",n.folderItems)}}var L,J=((L=function(){function t(){_classCallCheck(this,t),this.folders=[],this.folderItems=[]}return _createClass(t,[{key:"getSortValue",value:function(t,e){switch(t){case"name":return e.name;case"artist":return e.tag.artist;case"album":return e.tag.album;case"type":return e.type;default:return}}},{key:"ngOnChanges",value:function(){this.folderItems=(this.folders||[]).map((function(t){return{folder:t}}))}}]),t}()).\u0275fac=function(t){return new(t||L)},L.\u0275cmp=g.Jb({type:L,selectors:[["app-admin-folder-list"]],inputs:{folders:"folders"},features:[g.Ab],decls:2,vars:2,consts:[["name","Folders",3,"list"],["class","folders",4,"ngIf"],[1,"folders"],[1,"folder","heading"],[1,"title"],[1,"artist"],[1,"album"],[1,"year"],[1,"type"],["class","folder",3,"selected","click",4,"ngFor","ngForOf"],[1,"folder",3,"click"],[3,"routerLink"],[4,"ngIf"]],template:function(t,e){1&t&&(g.Qb(0,"app-background-text-list",0),g.Gc(1,H,13,1,"table",1)),2&t&&(g.nc("list",e.folderItems),g.Cb(1),g.nc("ngIf",e.folderItems&&e.folderItems.length>0))},directives:[T.a,a.t,a.s,v.f],styles:["[_nghost-%COMP%]{width:100%;overflow:auto;display:block}[_nghost-%COMP%]   .folders[_ngcontent-%COMP%]{padding:15px;font-size:.9em;width:100%}[_nghost-%COMP%]   .heading[_ngcontent-%COMP%]{font-size:.9em}[_nghost-%COMP%]   .folder[_ngcontent-%COMP%]{border-bottom:1px solid var(--control-border)}[_nghost-%COMP%]   .folder[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:5px 10px}[_nghost-%COMP%]   .folder[_ngcontent-%COMP%]:hover{background-color:var(--background-hover)}[_nghost-%COMP%]   .folder.selected[_ngcontent-%COMP%]{background-color:var(--background-active)}"]}),L);function W(t,e){1&t&&g.Qb(0,"app-loading")}function N(t,e){1&t&&(g.Qb(0,"i",12),g.Ic(1," New Folder\u2026"))}function $(t,e){1&t&&(g.Qb(0,"i",13),g.Ic(1," Move Subfolders\u2026"))}function q(t,e){if(1&t&&g.Qb(0,"app-admin-folder-list",14),2&t){var n=g.gc(2);g.nc("folders",n.folder.folders)}}function K(t,e){if(1&t){var n=g.Wb();g.Vb(0,"div",2),g.Vb(1,"context-menu",null,3),g.Gc(3,N,2,0,"ng-template",4),g.dc("execute",(function(){return g.yc(n),g.gc().newFolder()})),g.Gc(4,$,2,0,"ng-template",5),g.dc("execute",(function(){return g.yc(n),g.gc().moveSubfolders()})),g.Ub(),g.Vb(5,"div",6),g.Vb(6,"button",7),g.dc("click",(function(){return g.yc(n),g.gc().refresh()})),g.Qb(7,"i",8),g.Ic(8," Refresh"),g.Ub(),g.Vb(9,"button",9),g.Ic(10,"\u2026"),g.Ub(),g.Ub(),g.Qb(11,"app-background-text-list",10),g.Gc(12,q,1,1,"app-admin-folder-list",11),g.Ub()}if(2&t){var i=g.vc(2),o=g.gc();g.Cb(4),g.nc("visible",o.folder.folders&&o.folder.folders.length>0),g.Cb(5),g.nc("contextMenu",i)("contextMenuSubject",o.folder)("contextMenuTriggerLeft",!0),g.Cb(2),g.nc("list",o.folder.folders),g.Cb(1),g.nc("ngIf",o.folder.folders.length>0)}}var Y,X=((Y=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,i,o,r,a,c){var s;return _classCallCheck(this,n),(s=e.call(this,t)).jam=i,s.notify=o,s.folderService=r,s.dialogsService=a,s.dialogOverlay=c,s}return _createClass(n,[{key:"ngOnInit",value:function(){var t=this;_get(_getPrototypeOf(n.prototype),"ngOnInit",this).call(this),this.folderService.foldersChange.pipe(Object(m.a)(this.unsubscribe)).subscribe((function(e){e.id===t.id&&t.refresh()}))}},{key:"ngOnDestroy",value:function(){_get(_getPrototypeOf(n.prototype),"ngOnDestroy",this).call(this)}},{key:"refresh",value:function(){var t=this;this.folder=void 0,this.jam.folder.id({id:this.id,folderSubfolders:!0,folderTag:!0}).then((function(e){t.folder=e})).catch((function(e){t.notify.error(e)}))}},{key:"newFolder",value:function(){var t=this,e={folder:this.folder,name:""};this.dialogOverlay.open({childComponent:z,title:"New Folder",data:e,onOkBtn:function(){return Object(f.a)(t,void 0,void 0,regeneratorRuntime.mark((function t(){var n=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.prev=0,this.jam.folder.create({id:e.folder.id,name:e.name}).then((function(t){n.folderService.waitForQueueResult("Creating Folder",t,[],[e.folder.id])})).catch((function(t){n.notify.error(t)})),t.next=7;break;case 4:return t.prev=4,t.t0=t.catch(0),t.abrupt("return",(this.notify.error(t.t0),Promise.reject(t.t0)));case 7:case"end":return t.stop()}}),t,this,[[0,4]])})))},onCancelBtn:function(){return Object(f.a)(t,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Promise.resolve());case 1:case"end":return t.stop()}}),t)})))}})}},{key:"moveSubfolders",value:function(){var t=this,e=this.folder.folders.map((function(t){return t.id})),n=[this.id].concat(e),i={selectID:this.id,disableIDs:n};this.dialogOverlay.open({title:"Move Subfolders to",childComponent:S,data:i,panelClass:"overlay-panel-large-buttons",onOkBtn:function(){return Object(f.a)(t,void 0,void 0,regeneratorRuntime.mark((function t(){var o=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.prev=0,n.push(i.folder.id),this.jam.folder.parent_update({ids:e,folderID:i.folder.id}).then((function(t){o.folderService.waitForQueueResult("Moving Folders",t,[],n)})).catch((function(t){o.notify.error(t)})),t.next=7;break;case 4:return t.prev=4,t.t0=t.catch(0),t.abrupt("return",(this.notify.error(t.t0),Promise.reject(t.t0)));case 7:case"end":return t.stop()}}),t,this,[[0,4]])})))},onCancelBtn:function(){return Object(f.a)(t,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Promise.resolve());case 1:case"end":return t.stop()}}),t)})))}})}}]),n}(C)).\u0275fac=function(t){return new(t||Y)(g.Pb(v.a),g.Pb(y.k),g.Pb(O.i),g.Pb(O.a),g.Pb(O.g),g.Pb(M.b))},Y.\u0275cmp=g.Jb({type:Y,selectors:[["app-admin-folder-folders"]],features:[g.zb],decls:2,vars:2,consts:[[4,"ngIf"],["class","folders",4,"ngIf"],[1,"folders"],["folderActionMenu",""],["contextMenuItem","","title","New Folder",3,"execute"],["contextMenuItem","","title","Move Subfolders to another Folder",3,"visible","execute"],[1,"actions"],["title","Refresh Folder",1,"button-on-control",3,"click"],[1,"icon-reload"],[1,"button-on-control",3,"contextMenu","contextMenuSubject","contextMenuTriggerLeft"],["name","Folders",3,"list"],[3,"folders",4,"ngIf"],[1,"icon-list-add"],[1,"icon-right-bold"],[3,"folders"]],template:function(t,e){1&t&&(g.Gc(0,W,1,0,"app-loading",0),g.Gc(1,K,13,6,"div",1)),2&t&&(g.nc("ngIf",!e.folder),g.Cb(1),g.nc("ngIf",e.folder&&e.folder.folders))},directives:[a.t,F.a,D.a,Q.a,j.a,T.a,J],styles:["[_nghost-%COMP%]{display:block;overflow:hidden}[_nghost-%COMP%], [_nghost-%COMP%]   .folders[_ngcontent-%COMP%]{height:100%;width:100%}[_nghost-%COMP%]   .folders[_ngcontent-%COMP%]{display:flex;flex-direction:column}[_nghost-%COMP%]   .folders[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{padding:10px 15px;border-bottom:1px solid var(--background-border)}[_nghost-%COMP%]   .folders[_ngcontent-%COMP%]   app-admin-folder-list[_ngcontent-%COMP%]{overflow-y:auto}"]}),Y),Z=["overview","tags","health","tracks","tracks-health"],tt=n("uLy5");function et(t,e){1&t&&(g.Vb(0,"a",8),g.Qb(1,"i",9),g.Ic(2," Show Folder Tools"),g.Ub())}function nt(t,e){1&t&&(g.Vb(0,"a",8),g.Qb(1,"i",10),g.Ic(2," Show Folder Tree"),g.Ub())}var it=function(t){return["/admin/folder",t,"overview"]},ot=function(t){return["/admin/folder",t,"tracks"]},rt=function(t){return["/admin/folder",t,"sub-folders"]},at=function(t){return["/admin/folder",t,"tags"]},ct=function(t){return["/admin/folder",t,"health"]},st=function(t){return["/admin/folder",t,"tracks-health"]};function lt(t,e){if(1&t&&(g.Vb(0,"div",11),g.Vb(1,"ul",12),g.Vb(2,"li",13),g.Vb(3,"a"),g.Ic(4,"Overview"),g.Ub(),g.Ub(),g.Vb(5,"li",13),g.Vb(6,"a"),g.Ic(7,"Tracks"),g.Ub(),g.Ub(),g.Vb(8,"li",13),g.Vb(9,"a"),g.Ic(10,"Folders"),g.Ub(),g.Ub(),g.Vb(11,"li",13),g.Vb(12,"a"),g.Ic(13,"Tag Editor"),g.Ub(),g.Ub(),g.Vb(14,"li",13),g.Vb(15,"a"),g.Ic(16,"Health"),g.Ub(),g.Ub(),g.Vb(17,"li",13),g.Vb(18,"a"),g.Ic(19,"Tracks Health"),g.Ub(),g.Ub(),g.Ub(),g.Ub()),2&t){var n=g.gc();g.Cb(2),g.nc("routerLink",g.sc(6,it,n.id)),g.Cb(3),g.nc("routerLink",g.sc(8,ot,n.id)),g.Cb(3),g.nc("routerLink",g.sc(10,rt,n.id)),g.Cb(3),g.nc("routerLink",g.sc(12,at,n.id)),g.Cb(3),g.nc("routerLink",g.sc(14,ct,n.id)),g.Cb(3),g.nc("routerLink",g.sc(16,st,n.id))}}var dt,ht=((dt=function(){function t(e,n,i){_classCallCheck(this,t),this.route=e,this.router=n,this.uiState=i,this.id="",this.rightActive=!1,this.unsubscribe=new b.a,this.mode="overview"}return _createClass(t,[{key:"refresh",value:function(){this.tree&&this.tree.refresh()}},{key:"selectionChange",value:function(t){this.router.navigate(["/admin/folder/".concat(t.id,"/").concat(this.mode)]).catch((function(t){console.error(t)}))}},{key:"onFolderUpdate",value:function(t){this.tree&&this.tree.onFolderUpdate(t)}},{key:"ngOnInit",value:function(){var t=this;this.router.events.pipe(Object(m.a)(this.unsubscribe)).subscribe((function(e){if(e instanceof v.b&&t.route.firstChild&&t.route.firstChild.snapshot.url[0]){var n=t.route.firstChild.snapshot.url[0].path;Z.includes(n)&&(t.mode=n)}})),this.route&&this.route.params.pipe(Object(m.a)(this.unsubscribe)).subscribe((function(e){var n=e.id;t.id=n,t.tree&&n&&setTimeout((function(){t.tree&&t.tree.selectFolderByID(n)}))})),this.tree.expandIDs=this.uiState.data["app-admin-folders"]||[],this.refresh()}},{key:"ngOnDestroy",value:function(){this.uiState.data["app-admin-folders"]=this.tree.expandIDs,this.unsubscribe.next(),this.unsubscribe.complete()}}]),t}()).\u0275fac=function(t){return new(t||dt)(g.Pb(v.a),g.Pb(v.c),g.Pb(O.o))},dt.\u0275cmp=g.Jb({type:dt,selectors:[["app-admin-folder"]],viewQuery:function(t,e){var n;1&t&&g.Ec(U,!0),2&t&&g.uc(n=g.ec())&&(e.tree=n.first)},hostVars:2,hostBindings:function(t,e){2&t&&g.Gb("right-active",e.rightActive)},decls:11,vars:3,consts:[[1,"toggle",3,"click"],["class","button-on-control",4,"ngIf"],[1,"content"],[1,"left-content"],[3,"selectionChange"],[1,"right-content"],["class","navigation",4,"ngIf"],[1,"router-content"],[1,"button-on-control"],[1,"icon-right"],[1,"icon-left"],[1,"navigation"],[1,"tabs"],["routerLinkActive","active",3,"routerLink"]],template:function(t,e){1&t&&(g.Vb(0,"div",0),g.dc("click",(function(){return e.rightActive=!e.rightActive})),g.Gc(1,et,3,0,"a",1),g.Gc(2,nt,3,0,"a",1),g.Ub(),g.Vb(3,"div",2),g.Vb(4,"div",3),g.Vb(5,"app-admin-folder-tree",4),g.dc("selectionChange",(function(t){return e.selectionChange(t)})),g.Ub(),g.Ub(),g.Qb(6,"app-splitter"),g.Vb(7,"div",5),g.Gc(8,lt,20,18,"div",6),g.Vb(9,"div",7),g.Qb(10,"router-outlet"),g.Ub(),g.Ub(),g.Ub()),2&t&&(g.Cb(1),g.nc("ngIf",!e.rightActive),g.Cb(1),g.nc("ngIf",e.rightActive),g.Cb(6),g.nc("ngIf",e.id))},directives:[a.t,U,tt.a,v.h,v.e,v.d],styles:["[_nghost-%COMP%]{overflow-y:auto;overflow-x:hidden;height:100%;width:100%;min-height:100%;flex:1 1 auto;position:relative;display:flex;flex-direction:column;overflow:hidden}[_nghost-%COMP%]   .toggle[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]{z-index:1;justify-content:space-between;align-items:center;background-color:var(--background-transparent);color:var(--on-control)}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%], [_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%]{width:100%;display:flex;flex-flow:row wrap}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%]{padding-left:0;margin-top:0;margin-bottom:0;list-style:none;border:none}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{position:relative;display:flex;padding:10px 15px;margin-bottom:-1px;cursor:pointer;flex:1;align-self:stretch;text-align:center;border-top:4px solid transparent;border-bottom:4px solid transparent;align-items:center;align-content:center;justify-content:center}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]:hover{background-color:var(--control-hover);transition:all .4s ease;border-bottom:4px solid transparent}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{padding-bottom:15px}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{margin-right:2px;line-height:1.42857143;border-radius:4px 4px 0 0;position:relative;display:block;cursor:pointer;padding:2px 0;border:none;font-size:14px;text-transform:uppercase;letter-spacing:.5px;color:var(--on-control);-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]:focus, [_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]:hover{background-color:unset;border:none;color:var(--on-control-hover)}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%] > li.active[_ngcontent-%COMP%]{cursor:default;border-bottom-color:var(--primary)!important}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%] > li.active[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:default;background-color:unset;color:var(--on-control-hover)}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%] > li.active[_ngcontent-%COMP%]:focus, [_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%] > li.active[_ngcontent-%COMP%]:hover{border-bottom-color:var(--primary)}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%] > li.disabled[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{color:var(--on-control-ambient-disabled)}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%] > li.disabled[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]:focus, [_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%] > li.disabled[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]:hover{color:var(--on-control-ambient-disabled);text-decoration:none;cursor:not-allowed;background-color:transparent}@media (max-width:768px){[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%]{align-items:center;align-content:center;justify-content:center}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{padding:5px;min-width:33%}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{font-size:.8em}}@media (max-width:400px){[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{padding:0 5px}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{font-size:.8em}}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs.mini[_ngcontent-%COMP%]{padding-left:15px;padding-right:15px}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs.mini[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{flex:0}@media (max-width:768px){[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .tabs.mini[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{min-width:20px}}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]{width:100%;height:100%;flex:1;display:flex;flex-flow:row nowrap;overflow:hidden;align-items:flex-start;align-content:flex-start;padding:0;min-height:100%}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .left-content[_ngcontent-%COMP%]{height:100%;width:20%;display:block;border-right:1px solid var(--background-border);min-width:240px}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .right-content[_ngcontent-%COMP%]{width:80%;flex-shrink:1;flex-grow:1;height:100%;display:flex;flex-flow:column nowrap;position:relative;overflow:hidden}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .right-content[_ngcontent-%COMP%]   .router-content[_ngcontent-%COMP%]{width:100%;height:100%;display:block;overflow:hidden}@media (max-width:522px){[_nghost-%COMP%]{height:100%;width:100%;min-height:100%;overflow:hidden}[_nghost-%COMP%]   .toggle[_ngcontent-%COMP%]{height:33px;text-align:center;padding-top:5px;border-bottom:1px solid var(--background-border)}[_nghost-%COMP%]   .content[_ngcontent-%COMP%], [_nghost-%COMP%]   .toggle[_ngcontent-%COMP%]{display:block;position:relative;width:100%}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]{height:calc(100% - 33px);min-height:calc(100% - 33px);overflow:hidden;flex:none}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   app-splitter[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .left-content[_ngcontent-%COMP%]{display:flex;height:100%;width:100%}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .right-content[_ngcontent-%COMP%]{display:none;height:100%;width:100%}.right-active[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .left-content[_ngcontent-%COMP%]{display:none}.right-active[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .right-content[_ngcontent-%COMP%]{display:flex}}"]}),dt),ut=n("pCJo"),gt=n("tk/3"),pt=n("PEb7"),ft=n("P7EQ");function bt(t,e){if(1&t){var n=g.Wb();g.Vb(0,"image-cropper",6),g.dc("imageCropped",(function(t){return g.yc(n),g.gc().imageCropped(t)}))("imageLoaded",(function(){return g.yc(n),g.gc().imageLoaded()}))("cropperReady",(function(){return g.yc(n),g.gc().cropperReady()}))("loadImageFailed",(function(){return g.yc(n),g.gc().loadImageFailed()})),g.Ub()}if(2&t){var i=g.gc();g.nc("imageBase64",i.imageBase64)("format","jpeg")("maintainAspectRatio",i.maintainAspectRatio)}}function mt(t,e){if(1&t&&(g.Vb(0,"div",7),g.Qb(1,"img",8),g.Ub()),2&t){var n=g.gc();g.Cb(1),g.nc("src",n.croppedImage,g.Ac)}}var vt,Ct=((vt=function(){function t(e,n,i,o){_classCallCheck(this,t),this.app=e,this.jam=n,this.folderService=i,this.notify=o,this.imageBase64="",this.mimeType="image/jpeg",this.maintainAspectRatio=!0,this.imageEdited=new g.n,this.unsubscribe=new b.a}return _createClass(t,[{key:"ngOnDestroy",value:function(){this.unsubscribe.next(),this.unsubscribe.complete()}},{key:"load",value:function(){var t=this;this.data&&this.jam.folder.artwork_image_binary({id:this.data.artwork.id}).then((function(e){t.imageBase64="data:".concat(t.mimeType||"image/jpeg",";base64,").concat(Object(ft.a)(e))})).catch((function(e){t.notify.error(e)}))}},{key:"imageCropped",value:function(t){this.croppedImage=t.base64,this.croppedImageFile=Object(u.c)(t.base64)}},{key:"imageLoaded",value:function(){}},{key:"cropperReady",value:function(){}},{key:"loadImageFailed",value:function(){}},{key:"ngOnChanges",value:function(t){this.load()}},{key:"upload",value:function(){var t=this,e=new File([this.croppedImageFile],this.data.artwork.name,{type:this.croppedImageFile.type});this.jam.folder.artworkUpload_update({id:this.data.artwork.id},e).pipe(Object(m.a)(this.unsubscribe)).subscribe((function(e){e.type===gt.f.Response&&(t.folderService.waitForQueueResult("Updating Folder Artwork",e.body,[t.data.folderID]),t.imageEdited.emit())}),(function(e){t.notify.error(e)}),(function(){t.notify.success("Upload done")}))}}]),t}()).\u0275fac=function(t){return new(t||vt)(g.Pb(O.e),g.Pb(y.k),g.Pb(O.a),g.Pb(O.i))},vt.\u0275cmp=g.Jb({type:vt,selectors:[["app-admin-artwork-edit"]],inputs:{data:"data"},outputs:{imageEdited:"imageEdited"},features:[g.Ab],decls:9,vars:4,consts:[[1,"image-crop"],["type","checkbox",3,"ngModel","checked","ngModelChange"],[3,"imageBase64","format","maintainAspectRatio","imageCropped","imageLoaded","cropperReady","loadImageFailed",4,"ngIf"],["class","image-preview",4,"ngIf"],[1,"buttons"],[1,"button-on-control",3,"click"],[3,"imageBase64","format","maintainAspectRatio","imageCropped","imageLoaded","cropperReady","loadImageFailed"],[1,"image-preview"],[3,"src"]],template:function(t,e){1&t&&(g.Vb(0,"div",0),g.Vb(1,"label"),g.Vb(2,"input",1),g.dc("ngModelChange",(function(t){return e.maintainAspectRatio=t})),g.Ub(),g.Ic(3," Maintain Aspect Ratio "),g.Ub(),g.Gc(4,bt,1,3,"image-cropper",2),g.Ub(),g.Gc(5,mt,2,1,"div",3),g.Vb(6,"div",4),g.Vb(7,"button",5),g.dc("click",(function(){return e.upload()})),g.Ic(8,"Use Cropped Artwork"),g.Ub(),g.Ub()),2&t&&(g.Cb(2),g.nc("ngModel",e.maintainAspectRatio)("checked",e.maintainAspectRatio),g.Cb(2),g.nc("ngIf",e.imageBase64),g.Cb(1),g.nc("ngIf",e.croppedImage))},directives:[c.a,c.i,c.l,a.t,u.a],styles:["[_nghost-%COMP%]{width:100%;display:block;text-align:center}[_nghost-%COMP%]   image-cropper[_ngcontent-%COMP%]{width:300px;display:block}[_nghost-%COMP%]   .image-crop[_ngcontent-%COMP%]{text-align:center}[_nghost-%COMP%]   .image-crop[_ngcontent-%COMP%], [_nghost-%COMP%]   .image-preview[_ngcontent-%COMP%]{display:inline-block;margin-left:10px;margin-right:10px}[_nghost-%COMP%]   .image-preview[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:300px}"]}),vt);function Mt(t,e){if(1&t){var n=g.Wb();g.Vb(0,"app-admin-artwork-edit",1),g.dc("imageEdited",(function(){return g.yc(n),g.gc().onImageEdited()})),g.Ub()}if(2&t){var i=g.gc();g.nc("data",i.data)}}var Ot,yt=((Ot=function(){function t(){_classCallCheck(this,t),this.loading=!0}return _createClass(t,[{key:"dialogInit",value:function(t,e){this.data=e.data,this.reference=t}},{key:"onImageEdited",value:function(){this.reference.close()}}]),t}()).\u0275fac=function(t){return new(t||Ot)},Ot.\u0275cmp=g.Jb({type:Ot,selectors:[["app-image-edit-overlay-content"]],decls:1,vars:1,consts:[[3,"data","imageEdited",4,"ngIf"],[3,"data","imageEdited"]],template:function(t,e){1&t&&g.Gc(0,Mt,1,1,"app-admin-artwork-edit",0),2&t&&g.nc("ngIf",e.data)},directives:[a.t,Ct],styles:[""]}),Ot),Pt=["inlineEditControl"];function _t(t,e){if(1&t){var n=g.Wb();g.Vb(0,"div",2),g.Vb(1,"input",3,4),g.dc("blur",(function(t){return g.yc(n),g.gc().onBlur(t)}))("keydown.enter",(function(){return g.yc(n),g.gc().apply()}))("ngModelChange",(function(t){return g.yc(n),g.gc().value=t})),g.Ub(),g.Ub()}if(2&t){var i=g.gc();g.Cb(1),g.nc("required",i.required)("name",i.value)("ngModel",i.value)("type",i.type)("placeholder",i.placeholder)}}function kt(t,e){if(1&t){var n=g.Wb();g.Vb(0,"div"),g.Vb(1,"div",5),g.dc("click",(function(){g.yc(n);var t=g.gc();return t.edit(t.value)}))("focus",(function(){g.yc(n);var t=g.gc();return t.edit(t.value)})),g.Ic(2),g.Qb(3,"i",6),g.Ub(),g.Ub()}if(2&t){var i=g.gc();g.Cb(2),g.Kc("",i.value,"\xa0")}}var xt,wt=((xt=function(){function t(){_classCallCheck(this,t),this.placeholder="",this.type="text",this.required=!1,this.disabled=!1,this.endEditRequest=new g.n,this.editing=!1,this._value="",this.preValue="",this.onChange=Function.prototype,this.onTouched=Function.prototype}return _createClass(t,[{key:"writeValue",value:function(t){this._value=t}},{key:"registerOnChange",value:function(t){this.onChange=t}},{key:"registerOnTouched",value:function(t){this.onTouched=t}},{key:"onBlur",value:function(t){this.editing=!1,this.endEditRequest.emit()}},{key:"apply",value:function(){this.editing=!1,this.endEditRequest.emit()}},{key:"edit",value:function(t){var e=this;this.disabled||(this.preValue=t,this.editing=!0,setTimeout((function(){return e.inlineEditControl.nativeElement.focus()})))}},{key:"value",get:function(){return this._value},set:function(t){t!==this._value&&(this._value=t,this.onChange(t))}}]),t}()).\u0275fac=function(t){return new(t||xt)},xt.\u0275cmp=g.Jb({type:xt,selectors:[["app-inline-edit"]],viewQuery:function(t,e){var n;1&t&&g.Oc(Pt,!0),2&t&&g.uc(n=g.ec())&&(e.inlineEditControl=n.first)},inputs:{placeholder:"placeholder",type:"type",required:"required",disabled:"disabled"},outputs:{endEditRequest:"endEditRequest"},features:[g.Bb([{provide:c.h,useExisting:xt,multi:!0}])],decls:2,vars:2,consts:[["class","inline-edit-edit",4,"ngIf"],[4,"ngIf"],[1,"inline-edit-edit"],[3,"required","name","ngModel","type","placeholder","blur","keydown.enter","ngModelChange"],["inlineEditControl",""],["title","Click to edit","tabindex","0",1,"inline-edit",3,"click","focus"],[1,"icon-edit"]],template:function(t,e){1&t&&(g.Gc(0,_t,3,5,"div",0),g.Gc(1,kt,4,1,"div",1)),2&t&&(g.nc("ngIf",e.editing),g.Cb(1),g.nc("ngIf",!e.editing))},directives:[a.t,c.c,c.s,c.i,c.l],styles:[".inline-edit{cursor:pointer}.inline-edit i{font-size:.7em}.inline-edit-edit{width:100%;display:block}.inline-edit-edit input{width:100%}"],encapsulation:2}),xt),It=n("GKVu");function Ut(t,e){if(1&t){var n=g.Wb();g.Vb(0,"div",1),g.Vb(1,"div",2),g.Vb(2,"img",3),g.dc("click",(function(){g.yc(n);var t=e.$implicit;return g.gc().editArtwork(t.artwork)})),g.Ub(),g.Vb(3,"div",4),g.Ic(4),g.Ub(),g.Vb(5,"div",5),g.Ic(6),g.Ub(),g.Vb(7,"div",6),g.Ic(8),g.Ub(),g.Vb(9,"div",7),g.Ic(10),g.hc(11,"filesize"),g.Ub(),g.Ub(),g.Vb(12,"div",8),g.Vb(13,"app-inline-edit",9),g.dc("ngModelChange",(function(t){return g.yc(n),e.$implicit.name=t}))("endEditRequest",(function(){g.yc(n);var t=e.$implicit;return g.gc().editArtworkName(t)})),g.Ub(),g.Vb(14,"a",10),g.dc("click",(function(){g.yc(n);var t=e.$implicit;return g.gc().removeArtwork(t)})),g.Qb(15,"i",11),g.Ub(),g.Ub(),g.Ub()}if(2&t){var i=e.$implicit;g.Cb(2),g.nc("src",i.thumbnail,g.Ac),g.Cb(2),g.Jc(i.artwork.types),g.Cb(2),g.Jc(i.artwork.format),g.Cb(2),g.Lc("",i.artwork.width,"x",i.artwork.height,""),g.Cb(2),g.Jc(g.ic(11,7,i.artwork.size)),g.Cb(3),g.nc("ngModel",i.name)}}function St(t){var e=t.split(".");return e[e.length-1]}var Vt,At=((Vt=function(){function t(e,n,i,o,r,a){_classCallCheck(this,t),this.app=e,this.jam=n,this.notify=i,this.folderService=o,this.dialogs=r,this.dialogOverlay=a}return _createClass(t,[{key:"trackByFn",value:function(t,e){return e.artwork.id}},{key:"ngOnChanges",value:function(t){this.displayArtworks()}},{key:"editArtworkName",value:function(t){var e=this;this.jam.folder.artwork_name_update({id:t.artwork.id,name:t.name}).then((function(t){e.folderService.waitForQueueResult("Renaming Artwork",t,[e.folderID],[])})).catch((function(t){e.notify.error(t)}))}},{key:"editArtwork",value:function(t){this.dialogOverlay.open({childComponent:yt,title:"Edit Image",data:{artwork:t,folderID:this.folderID},panelClass:""})}},{key:"showArtwork",value:function(t){var e=t.types.join(", ");this.dialogOverlay.open({title:e,childComponent:pt.d,data:{name:e,url:this.jam.folder.artwork_image_url({id:t.id})}})}},{key:"removeArtwork",value:function(t){var e=this;this.dialogs.confirm("Remove Artworks?",'Do you want to delete "'.concat(t.artwork.name,'"?'),(function(){e.jam.folder.artwork_delete({id:t.artwork.id}).then((function(n){e.nodes=e.nodes.filter((function(e){return e!==t})),e.folderService.waitForQueueResult("Removing Artwork",n,[e.folderID])})).catch((function(t){e.notify.error(t)}))}))}},{key:"displayArtworks",value:function(){var t=this;this.nodes=[],this.artworks&&(this.nodes=this.artworks.map((function(e){return{name:(n=e.name,i=n.split("."),i.pop(),i.join(".")),type:St(e.name),artwork:e,thumbnail:t.jam.folder.artwork_image_url({id:e.id,size:128})};var n,i})))}}]),t}()).\u0275fac=function(t){return new(t||Vt)(g.Pb(O.e),g.Pb(y.k),g.Pb(O.i),g.Pb(O.a),g.Pb(O.g),g.Pb(M.b))},Vt.\u0275cmp=g.Jb({type:Vt,selectors:[["app-admin-artwork-list"]],inputs:{artworks:"artworks",folderID:"folderID"},features:[g.Ab],decls:1,vars:2,consts:[["class","artwork",4,"ngFor","ngForOf","ngForTrackBy"],[1,"artwork"],[1,"artwork-img"],[3,"src","click"],[1,"mode"],[1,"format"],[1,"dims"],[1,"size"],[1,"artwork-types"],["type","text",3,"ngModel","ngModelChange","endEditRequest"],["title","Delete Image",1,"delete-button",3,"click"],[1,"icon-trash"]],template:function(t,e){1&t&&g.Gc(0,Ut,16,9,"div",0),2&t&&g.nc("ngForOf",e.nodes)("ngForTrackBy",e.trackByFn)},directives:[a.s,wt,c.i,c.l],pipes:[It.a],styles:["[_nghost-%COMP%]   .artwork[_ngcontent-%COMP%]{display:inline-block;padding-top:15px;padding-right:15px;font-size:.8em;text-align:center;width:200px}[_nghost-%COMP%]   .artwork[_ngcontent-%COMP%]   .artwork-img[_ngcontent-%COMP%]{position:relative;overflow:hidden}[_nghost-%COMP%]   .artwork[_ngcontent-%COMP%]   .artwork-img[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:auto}[_nghost-%COMP%]   .artwork[_ngcontent-%COMP%]   .artwork-img[_ngcontent-%COMP%]   .dims[_ngcontent-%COMP%], [_nghost-%COMP%]   .artwork[_ngcontent-%COMP%]   .artwork-img[_ngcontent-%COMP%]   .format[_ngcontent-%COMP%], [_nghost-%COMP%]   .artwork[_ngcontent-%COMP%]   .artwork-img[_ngcontent-%COMP%]   .mode[_ngcontent-%COMP%], [_nghost-%COMP%]   .artwork[_ngcontent-%COMP%]   .artwork-img[_ngcontent-%COMP%]   .size[_ngcontent-%COMP%]{position:absolute;padding:5px;background-color:var(--background-transparent);color:var(--on-background-active)}[_nghost-%COMP%]   .artwork[_ngcontent-%COMP%]   .artwork-img[_ngcontent-%COMP%]   .mode[_ngcontent-%COMP%]{top:0;left:0}[_nghost-%COMP%]   .artwork[_ngcontent-%COMP%]   .artwork-img[_ngcontent-%COMP%]   .format[_ngcontent-%COMP%]{bottom:0;left:0}[_nghost-%COMP%]   .artwork[_ngcontent-%COMP%]   .artwork-img[_ngcontent-%COMP%]   .dims[_ngcontent-%COMP%]{top:0;right:0}[_nghost-%COMP%]   .artwork[_ngcontent-%COMP%]   .artwork-img[_ngcontent-%COMP%]   .size[_ngcontent-%COMP%]{bottom:0;right:0}[_nghost-%COMP%]   .artwork-types[_ngcontent-%COMP%]{display:flex;flex-direction:row;width:100%;overflow:hidden}[_nghost-%COMP%]   .artwork-types[_ngcontent-%COMP%]   app-inline-edit[_ngcontent-%COMP%]{flex:1}[_nghost-%COMP%]   .artwork-types[_ngcontent-%COMP%]   .delete-button[_ngcontent-%COMP%]{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}"]}),Vt);function Rt(t,e){1&t&&g.Qb(0,"app-loading")}function zt(t,e){1&t&&g.Qb(0,"i",17)}function Ft(t,e){if(1&t){var n=g.Wb();g.Vb(0,"input",18),g.dc("ngModelChange",(function(t){return g.yc(n),g.gc().$implicit.checked=t})),g.Ub()}if(2&t){var i=g.gc().$implicit;g.nc("ngModel",i.checked)("checked",i.checked)}}function Dt(t,e){if(1&t&&(g.Vb(0,"div"),g.Vb(1,"div",11),g.dc("click",(function(){var t=e.$implicit;return t.checked=!t.checked})),g.Qb(2,"img",12),g.Ub(),g.Vb(3,"div",13),g.Vb(4,"div",14),g.Vb(5,"label"),g.Gc(6,zt,1,0,"i",15),g.Gc(7,Ft,1,2,"input",16),g.Ic(8),g.Ub(),g.Ub(),g.Ub(),g.Ub()),2&t){var n=e.$implicit;g.Cb(2),g.oc("alt",n.name),g.nc("src",n.thumbnail,g.Ac),g.Cb(4),g.nc("ngIf",n.storing),g.Cb(1),g.nc("ngIf",!n.storing),g.Cb(1),g.Kc(" ",n.name," ")}}function Qt(t,e){if(1&t&&(g.Vb(0,"div"),g.Qb(1,"app-background-text-list",8),g.Vb(2,"div",9),g.Gc(3,Dt,9,5,"div",10),g.Ub(),g.Ub()),2&t){var n=g.gc();g.Cb(1),g.nc("list",n.nodes),g.Cb(2),g.nc("ngForOf",n.nodes)("ngForTrackBy",n.trackByFn)}}function jt(t,e){if(1&t&&g.Qb(0,"app-admin-artwork-list",21),2&t){var n=g.gc(2);g.nc("folderID",n.data.folder.id)("artworks",n.data.folder.artworks)}}function Tt(t,e){if(1&t&&(g.Vb(0,"div",19),g.Vb(1,"div",2),g.Ic(2,"Current Images"),g.Ub(),g.Gc(3,jt,1,2,"app-admin-artwork-list",20),g.Ub()),2&t){var n=g.gc();g.Cb(3),g.nc("ngIf",!n.isArtRefreshing)}}function Et(t,e){1&t&&(g.Vb(0,"button",24),g.Qb(1,"i",17),g.Ub())}function Gt(t,e){if(1&t){var n=g.Wb();g.Vb(0,"button",25),g.dc("click",(function(){return g.yc(n),g.gc(2).use()})),g.Ic(1,"Use Checked Artwork"),g.Ub()}}function Bt(t,e){if(1&t&&(g.Vb(0,"div"),g.Gc(1,Et,2,0,"button",22),g.Gc(2,Gt,2,0,"button",23),g.Ub()),2&t){var n=g.gc();g.Cb(1),g.nc("ngIf",n.isWorking),g.Cb(1),g.nc("ngIf",!n.isWorking)}}var Ht,Lt,Jt=((Lt=function(){function t(e,n,i,o){_classCallCheck(this,t),this.jam=e,this.notify=n,this.folderService=i,this.http=o,this.isWorking=!1,this.isArtRefreshing=!1,this.searchSource={name:"",url:""},this.unsubscribe=new b.a}return _createClass(t,[{key:"trackByFn",value:function(t,e){return e.image}},{key:"ngOnDestroy",value:function(){this.unsubscribe.next(),this.unsubscribe.complete()}},{key:"ngOnChanges",value:function(t){this.search(),this.data&&this.data.folder&&!this.data.folder.artworks&&this.refreshArtworks()}},{key:"refreshArtworks",value:function(){var t=this;this.isArtRefreshing=!0,this.jam.folder.artworks({id:this.data.folder.id}).then((function(e){t.isArtRefreshing=!1,t.data.folder.artworks=e})).catch((function(e){t.isArtRefreshing=!1,console.error(e)}))}},{key:"loadWikiDataID",value:function(t){return Object(f.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.jam.metadata.musicbrainz_lookup({type:y.o.artist,id:t});case 2:if(!((n=e.sent)&&n.artist&&n.artist.relations)){e.next=7;break}if(!(i=n.artist.relations.find((function(t){return"wikidata"===t.type})))){e.next=7;break}return e.abrupt("return",i.url.resource.split("/").pop());case 7:case"end":return e.stop()}}),e,this)})))}},{key:"loadWikiCommonImage",value:function(t){return Object(f.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,i,o,r,a,c,s,l,d,h,u,g;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadWikiDataID(t);case 2:if(!(n=e.sent)){e.next=28;break}return e.next=6,this.jam.metadata.wikidata_lookup({id:n});case 6:if(i=e.sent,!(o=i.entity?i.entity.claims:i.data?i.data.claims:void 0)){e.next=28;break}r=Object.keys(o),a=0,c=r;case 11:if(!(a<c.length)){e.next=28;break}if(s=c[a],l=(l=o[s]).filter((function(t){return"string"==typeof t.mainsnak.datavalue.value&&Object(ut.d)(t.mainsnak.datavalue.value.toLowerCase(),["jpg","jpeg","png"])})),!(d=l[0])){e.next=25;break}return h="https://en.wikipedia.org/w/api.php?format=json&action=query&origin=*&titles=File:".concat(d.mainsnak.datavalue.value,"&prop=imageinfo&iiprop=extmetadata|url&iiextmetadatafilter=LicenseShortName"),e.next=20,this.http.get(h).toPromise();case 20:if(!(u=e.sent)||!u.query.pages){e.next=25;break}if(!(g=u.query.pages[Object.keys(u.query.pages)[0]])||!g.imageinfo[0]){e.next=25;break}return e.abrupt("return",{name:y.b.artist,thumbnail:g.imageinfo[0].url,image:g.imageinfo[0].url,licence:g.imageinfo[0].extmetadata.LicenseShortName.value,checked:!0,storing:!1,types:[y.b.artist]});case 25:a++,e.next=11;break;case 28:case"end":return e.stop()}}),e,this)})))}},{key:"loadWikiCommon",value:function(t){var e=this;this.loadWikiCommonImage(t).then((function(t){e.nodes=[],t&&(t.checked=!0,e.nodes.push(t))})).catch((function(t){e.nodes=[],e.notify.error(t)}))}},{key:"use",value:function(){var t=this,e=this.nodes.find((function(t){return t.checked&&!t.storing}));e?(this.isWorking=!0,e.storing=!0,this.jam.folder.artwork_create({id:this.data.folder.id,url:e.image,types:e.types}).then((function(n){t.folderService.waitForQueueResult("Creating Artwork",n,[t.data.folder.id]).pipe(Object(m.a)(t.unsubscribe)).subscribe((function(){e.storing=!1,e.checked=!1})),t.use()})).catch((function(n){e.storing=!1,t.notify.error(n)}))):this.isWorking=!1}},{key:"ngOnInit",value:function(){var t=this;this.folderService.foldersChange.pipe(Object(m.a)(this.unsubscribe)).subscribe((function(e){e.id===t.data.folder.id&&t.refreshArtworks()}))}},{key:"loadReleaseGroupAndRelease",value:function(e,n){var i=this;this.jam.metadata.coverartarchive_lookup({type:y.c.releaseGroup,id:n}).then((function(n){var o=t.coverArtResponseToNodes(n);i.jam.metadata.coverartarchive_lookup({type:y.c.release,id:e}).then((function(e){o=o.concat(t.coverArtResponseToNodes(e)),i.display(o)})).catch((function(t){i.notify.error(t)}))})).catch((function(t){i.notify.error(t)}))}},{key:"loadReleaseGroup",value:function(e){var n=this;this.jam.metadata.coverartarchive_lookup({type:y.c.releaseGroup,id:e}).then((function(e){var i=t.coverArtResponseToNodes(e);n.display(i)})).catch((function(t){n.notify.error(t)}))}},{key:"loadRelease",value:function(e){var n=this;e&&this.jam.metadata.coverartarchive_lookup({type:y.c.release,id:e}).then((function(e){var i=t.coverArtResponseToNodes(e);n.display(i),0===i.length&&n.data&&n.data.folder&&n.data.folder.tag&&n.data.folder.tag.mbReleaseGroupID&&(n.nodes=void 0,n.loadReleaseGroup(n.data.folder.tag.mbReleaseGroupID))})).catch((function(t){n.notify.error(t)}))}},{key:"search",value:function(){this.data&&this.data.folder&&this.data.folder.tag&&(this.data.folder.type===y.e.artist?this.data.folder.tag.mbArtistID&&(this.searchSource={name:"Wiki Commons",url:"https://commons.wikimedia.org"},this.loadWikiCommon(this.data.folder.tag.mbArtistID)):this.data&&this.data.folder&&this.data.folder.tag&&(this.searchSource={name:"Coverart Archive",url:"https://coverartarchive.org"},this.data.folder.tag.mbReleaseID&&this.data.folder.tag.mbReleaseGroupID?this.loadReleaseGroupAndRelease(this.data.folder.tag.mbReleaseID,this.data.folder.tag.mbReleaseGroupID):this.data.folder.tag.mbReleaseID?this.loadRelease(this.data.folder.tag.mbReleaseID):this.data.folder.tag.mbReleaseGroupID&&this.loadReleaseGroup(this.data.folder.tag.mbReleaseGroupID)))}},{key:"display",value:function(t){this.nodes=t;var e=t.find((function(t){return 1===t.types.length&&t.types[0]===y.b.front}));e||(e=t.find((function(t){return t.types.includes(y.b.front)}))),e&&this.nodes.forEach((function(t){return t.checked=t===e}))}}],[{key:"coverArtResponseToNodes",value:function(t){return t.images?t.images.map((function(t){return 0===t.types.length&&t.types.push("Other"),t.image&&(t.image=t.image.replace("http:","https:")),t.thumbnails&&t.thumbnails.small&&(t.thumbnails.small=t.thumbnails.small.replace("http:","https:")),{name:(t.types||[]).join("/").toLowerCase(),thumbnail:t.thumbnails.small,licence:"",image:t.image,types:(t.types||[]).map((function(t){return t.toLowerCase()})),checked:!1,storing:!1,stored:!1}})):[]}}]),t}()).\u0275fac=function(t){return new(t||Lt)(g.Pb(y.k),g.Pb(O.i),g.Pb(O.a),g.Pb(gt.b))},Lt.\u0275cmp=g.Jb({type:Lt,selectors:[["app-admin-folder-artwork-search"]],inputs:{data:"data"},features:[g.Ab],decls:11,vars:6,consts:[[1,"image-selector"],[1,"art-source"],[1,"section"],["rel","noopener","target","_blank",3,"href"],[4,"ngIf"],[1,"artwork"],["class","current",4,"ngIf"],[1,"buttons"],["name","Images",3,"list"],[1,"images"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"image",3,"click"],[3,"alt","src"],[1,"footer"],[1,"footer-content"],["class","icon-spin icon-spinner",4,"ngIf"],["type","checkbox",3,"ngModel","checked","ngModelChange",4,"ngIf"],[1,"icon-spin","icon-spinner"],["type","checkbox",3,"ngModel","checked","ngModelChange"],[1,"current"],[3,"folderID","artworks",4,"ngIf"],[3,"folderID","artworks"],["class","button-on-control",4,"ngIf"],["class","button-on-control",3,"click",4,"ngIf"],[1,"button-on-control"],[1,"button-on-control",3,"click"]],template:function(t,e){1&t&&(g.Vb(0,"div",0),g.Vb(1,"div",1),g.Vb(2,"div",2),g.Vb(3,"a",3),g.Ic(4),g.Ub(),g.Ub(),g.Gc(5,Rt,1,0,"app-loading",4),g.Gc(6,Qt,4,3,"div",4),g.Ub(),g.Vb(7,"div",5),g.Gc(8,Tt,4,1,"div",6),g.Ub(),g.Ub(),g.Vb(9,"div",7),g.Gc(10,Bt,3,2,"div",4),g.Ub()),2&t&&(g.Cb(3),g.nc("href",e.searchSource.url,g.Ac),g.Cb(1),g.Jc(e.searchSource.name),g.Cb(1),g.nc("ngIf",!e.nodes),g.Cb(1),g.nc("ngIf",e.nodes),g.Cb(2),g.nc("ngIf",e.data&&e.data.folder.artworks),g.Cb(2),g.nc("ngIf",e.nodes&&e.nodes.length>0))},directives:[a.t,F.a,T.a,a.s,c.a,c.i,c.l,At],styles:["[_nghost-%COMP%]   .image-selector[_ngcontent-%COMP%]{display:flex;flex-flow:column wrap;height:calc(100% - 40px)}[_nghost-%COMP%]   .image-buttons[_ngcontent-%COMP%]{height:40px}[_nghost-%COMP%]   .artwork[_ngcontent-%COMP%]{padding-left:15px}[_nghost-%COMP%]   .art-source[_ngcontent-%COMP%], [_nghost-%COMP%]   .artwork[_ngcontent-%COMP%]{overflow-y:auto;width:50%;height:100%}[_nghost-%COMP%]   .art-source[_ngcontent-%COMP%]{padding-right:15px;border-right:1px solid var(--background-border)}[_nghost-%COMP%]   .art-source[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block}[_nghost-%COMP%]   .art-source[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{display:inline-block;padding-top:15px;padding-right:15px;font-size:.8em}[_nghost-%COMP%]   .art-source[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:185px;min-width:185px;min-height:185px;height:auto}[_nghost-%COMP%]   .art-source[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]{font-size:.8em}[_nghost-%COMP%]   .section[_ngcontent-%COMP%]{border-bottom:1px solid var(--background-border);padding-bottom:5px}[_nghost-%COMP%]   .section[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--on-background-active)}[_nghost-%COMP%]   .section[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:var(--on-background)}"]}),Lt),Wt=((Ht=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"dialogInit",value:function(t,e){this.data=e.data}}]),t}()).\u0275fac=function(t){return new(t||Ht)},Ht.\u0275cmp=g.Jb({type:Ht,selectors:[["app-dialog-folder-artwork-search"]],decls:1,vars:1,consts:[[3,"data"]],template:function(t,e){1&t&&g.Qb(0,"app-admin-folder-artwork-search",0),2&t&&g.nc("data",e.data)},directives:[Jt],styles:[""]}),Ht);function Nt(t,e){1&t&&(g.Vb(0,"div",1),g.Vb(1,"div",2),g.Qb(2,"i",3),g.Ub(),g.Ub())}function $t(t,e){1&t&&(g.Vb(0,"div",2),g.Ic(1,"No Hints"),g.Ub())}function qt(t,e){if(1&t&&(g.Vb(0,"div",10),g.Ic(1),g.Ub()),2&t){var n=e.$implicit;g.Cb(1),g.Jc(n)}}function Kt(t,e){if(1&t&&(g.Vb(0,"div",2),g.Qb(1,"i",8),g.Ic(2),g.Gc(3,qt,2,1,"div",9),g.Ub()),2&t){var n=e.$implicit;g.Cb(2),g.Kc(" ",n.hint.name," "),g.Cb(1),g.nc("ngForOf",n.details)}}function Yt(t,e){1&t&&g.Qb(0,"i",3)}function Xt(t,e){if(1&t&&(g.Tb(0),g.Ic(1),g.Sb()),2&t){var n=g.gc().$implicit;g.Cb(1),g.Jc(n.name)}}function Zt(t,e){if(1&t&&(g.Vb(0,"button",11),g.dc("click",(function(){return e.$implicit.click()})),g.Gc(1,Yt,1,0,"i",12),g.Gc(2,Xt,2,1,"ng-container",13),g.Ub()),2&t){var n=e.$implicit;g.Cb(1),g.nc("ngIf",n.running),g.Cb(1),g.nc("ngIf",!n.running)}}function te(t,e){if(1&t&&(g.Vb(0,"div",1),g.Gc(1,$t,2,0,"div",4),g.Gc(2,Kt,4,2,"div",5),g.Vb(3,"div",6),g.Gc(4,Zt,3,2,"button",7),g.Ub(),g.Ub()),2&t){var n=g.gc();g.Cb(1),g.nc("ngIf",0===n.hints.length),g.Cb(1),g.nc("ngForOf",n.hints)("ngForTrackBy",n.trackByFn),g.Cb(2),g.nc("ngForOf",n.solutions)}}var ee,ne=((ee=function(){function t(e,n,i,o,r,a){_classCallCheck(this,t),this.app=e,this.router=n,this.jam=i,this.notify=o,this.dialogOverlay=r,this.folderService=a,this.solutions=[]}return _createClass(t,[{key:"trackByFn",value:function(t,e){return e.hint.id}},{key:"searchImages",value:function(t){this.dialogOverlay.open({title:"Search Artwork Images",childComponent:Wt,data:{folder:t},panelClass:"overlay-panel-large-buttons"})}},{key:"ngOnChanges",value:function(){this.display(this.folderHealth)}},{key:"describeImageQualityHint",value:function(t,e){if(this.addAlbumImageSearchSolution(e),!t.details||0===t.details.length)return[];var n=[t.details[0].reason];return n.push("Expected: ".concat(t.details[0].expected," Actual: ").concat(t.details[0].actual)),n}},{key:"addArtistImageSearchSolution",value:function(t){var e=this;t.tag&&t.tag.mbArtistID&&this.solutions.push({name:"Search",click:function(){return Object(f.a)(e,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.searchImages(t);case 1:case"end":return e.stop()}}),e,this)})))}})}},{key:"addAlbumImageSearchSolution",value:function(t){var e=this;t.tag&&(t.tag.mbReleaseID||t.tag.mbReleaseGroupID)&&this.solutions.push({name:"Search",click:function(){return Object(f.a)(e,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.searchImages(t);case 1:case"end":return e.stop()}}),e,this)})))}})}},{key:"addRenameSolution",value:function(t,e){var n=this;if(!this.solutions.find((function(t){return"Rename"===t.name}))){var i={name:"Rename",click:function(){return Object(f.a)(n,void 0,void 0,regeneratorRuntime.mark((function n(){var o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!i.running){n.next=2;break}return n.abrupt("return");case 2:return i.running=!0,n.next=5,this.jam.folder.name_update({id:t.id,name:e});case 5:o=n.sent,i.running=!1,this.folderService.waitForQueueResult("Renaming Folder",o,[t.id]);case 7:case"end":return n.stop()}}),n,this)})))}};this.solutions.push(i)}}},{key:"addEditTagSolution",value:function(t){var e=this;this.solutions.find((function(t){return"Edit Tags"===t.name}))||this.solutions.push({name:"Edit Tags",click:function(){return Object(f.a)(e,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.router.navigate(["/admin/folder/".concat(t.id,"/tags")]).catch((function(t){console.error(t)}));case 1:case"end":return e.stop()}}),e,this)})))}})}},{key:"describeMBIDMissingHint",value:function(t,e){return this.addEditTagSolution(e),[]}},{key:"describeAlbumTagMissingHint",value:function(t,e){return this.addEditTagSolution(e),["Expected: ".concat(t.details.map((function(t){return t.expected})).join(","))]}},{key:"describeNameNonConformHint",value:function(t,e){var n=t.details&&t.details.length>0?t.details[0].expected:"";return n?(this.addRenameSolution(e,n),["Current: "+e.name,"Suggested Name: "+n]):[]}},{key:"describeArtistImageMissingHint",value:function(t,e){return this.addArtistImageSearchSolution(e),[]}},{key:"describeAlbumImageMissingHint",value:function(t,e){return this.addAlbumImageSearchSolution(e),[]}},{key:"describeHint",value:function(e,n){switch(e.id){case y.d.albumMBIDExists:return this.describeMBIDMissingHint(e,n);case y.d.albumTagsExists:return this.describeAlbumTagMissingHint(e,n);case y.d.albumNameConform:case y.d.artistNameConform:return this.describeNameNonConformHint(e,n);case y.d.albumImageExists:return this.describeAlbumImageMissingHint(e,n);case y.d.albumTracksComplete:return t.describeAlbumTracksMissingHint(e,n);case y.d.artistImageExists:return this.describeArtistImageMissingHint(e,n);case y.d.artistImageValid:case y.d.albumImageValid:return t.describeImageInvalidHint(e,n);case y.d.albumImageQuality:return this.describeImageQualityHint(e,n)}return[]}},{key:"display",value:function(t){var e=this;this.hints=[],this.solutions=[],t.health&&(this.hints=t.health.map((function(n){return{hint:n,details:e.describeHint(n,t.folder)}})))}}],[{key:"describeImageInvalidHint",value:function(t,e){if(!t.details||0===t.details.length)return[];var n=[t.details[0].reason];return t.details[0].expected&&n.push("Expected: ".concat(t.details[0].expected," Actual: ").concat(t.details[0].actual)),n}},{key:"describeAlbumTracksMissingHint",value:function(t,e){if(!t.details||0===t.details.length)return[];var n=[];return t.details[0].expected&&n.push("Expected: ".concat(t.details[0].expected," Actual: ").concat(t.details[0].actual)),n}}]),t}()).\u0275fac=function(t){return new(t||ee)(g.Pb(O.e),g.Pb(v.c),g.Pb(y.k),g.Pb(O.i),g.Pb(M.b),g.Pb(O.a))},ee.\u0275cmp=g.Jb({type:ee,selectors:[["app-folder-health"]],inputs:{folderHealth:"folderHealth"},features:[g.Ab],decls:2,vars:2,consts:[["class","hints",4,"ngIf"],[1,"hints"],[1,"hint"],[1,"icon-spin","icon-spinner"],["class","hint",4,"ngIf"],["class","hint",4,"ngFor","ngForOf","ngForTrackBy"],[1,"solutions"],["class","button-on-background",3,"click",4,"ngFor","ngForOf"],[1,"icon-warning"],["class","details",4,"ngFor","ngForOf"],[1,"details"],[1,"button-on-background",3,"click"],["class","icon-spin icon-spinner",4,"ngIf"],[4,"ngIf"]],template:function(t,e){1&t&&(g.Gc(0,Nt,3,0,"div",0),g.Gc(1,te,5,4,"div",0)),2&t&&(g.nc("ngIf",!e.hints),g.Cb(1),g.nc("ngIf",e.hints))},directives:[a.t,a.s],styles:["[_nghost-%COMP%]{height:100%;width:100%;overflow-y:auto;overflow-x:auto;display:block}[_nghost-%COMP%]   .icon-warning[_ngcontent-%COMP%]{color:var(--accent)}[_nghost-%COMP%]   .label[_ngcontent-%COMP%]{padding-left:28px;font-size:.8em;text-transform:uppercase;min-width:30%;display:inline-block}[_nghost-%COMP%]   .hints[_ngcontent-%COMP%]{padding-top:10px}[_nghost-%COMP%]   .hint[_ngcontent-%COMP%]{padding-bottom:10px}"]}),ee);function ie(t,e){if(1&t&&(g.Vb(0,"option",11),g.Ic(1),g.Ub()),2&t){var n=e.$implicit;g.nc("value",n),g.Cb(1),g.Jc(n)}}function oe(t,e){if(1&t){var n=g.Wb();g.Vb(0,"select",9),g.dc("ngModelChange",(function(t){return g.yc(n),g.gc().filter=t}))("ngModelChange",(function(){return g.yc(n),g.gc().onFilterChange()})),g.Gc(1,ie,2,2,"option",10),g.Ub()}if(2&t){var i=g.gc();g.nc("ngModel",i.filter),g.Cb(1),g.nc("ngForOf",i.modes)}}function re(t,e){1&t&&g.Qb(0,"app-loading")}function ae(t,e){if(1&t&&(g.Tb(0),g.Vb(1,"div",20),g.Ic(2,"Album"),g.Ub(),g.Vb(3,"div",21),g.Ic(4),g.Ub(),g.Vb(5,"div",22),g.Ic(6),g.Ub(),g.Vb(7,"div",23),g.Ic(8),g.Ub(),g.Sb()),2&t){var n=g.gc().$implicit;g.Cb(4),g.Jc(n.folder.tag.album),g.Cb(2),g.Jc(n.folder.tag.artist),g.Cb(2),g.Jc(n.folder.tag.year)}}function ce(t,e){if(1&t&&(g.Tb(0),g.Vb(1,"div",20),g.Ic(2,"Album"),g.Ub(),g.Vb(3,"div",21),g.Ic(4),g.Ub(),g.Vb(5,"div",22),g.Ic(6),g.Ub(),g.Vb(7,"div",23),g.Ic(8),g.Ub(),g.Sb()),2&t){var n=g.gc().$implicit;g.Cb(4),g.Jc(n.folder.tag.album),g.Cb(2),g.Jc(n.folder.tag.artist),g.Cb(2),g.Jc(n.folder.tag.year)}}function se(t,e){if(1&t&&(g.Tb(0),g.Vb(1,"div",20),g.Ic(2,"Artist"),g.Ub(),g.Vb(3,"div",21),g.Ic(4),g.Ub(),g.Sb()),2&t){var n=g.gc().$implicit;g.Cb(4),g.Jc(n.folder.tag.artist)}}function le(t,e){if(1&t&&(g.Tb(0),g.Vb(1,"div",20),g.Ic(2,"Collection"),g.Ub(),g.Vb(3,"div",21),g.Ic(4),g.Ub(),g.Sb()),2&t){var n=g.gc().$implicit;g.Cb(4),g.Jc(n.folder.name)}}function de(t,e){if(1&t&&(g.Tb(0),g.Vb(1,"div",21),g.Ic(2),g.Ub(),g.Sb()),2&t){var n=g.gc().$implicit;g.Cb(2),g.Jc(n.folder.name)}}var he=function(t){return["/admin/folder",t,"overview"]};function ue(t,e){if(1&t&&(g.Vb(0,"div",12),g.Vb(1,"div",13),g.Vb(2,"a",14),g.Tb(3,15),g.Gc(4,ae,9,3,"ng-container",16),g.Gc(5,ce,9,3,"ng-container",16),g.Gc(6,se,5,1,"ng-container",16),g.Gc(7,le,5,1,"ng-container",16),g.Gc(8,de,3,1,"ng-container",17),g.Sb(),g.Ub(),g.Ub(),g.Vb(9,"div",18),g.Qb(10,"app-folder-health",19),g.Ub(),g.Ub()),2&t){var n=e.$implicit;g.Cb(2),g.nc("routerLink",g.sc(7,he,n.folder.id)),g.Cb(1),g.nc("ngSwitch",n.folder.type),g.Cb(1),g.nc("ngSwitchCase","multialbum"),g.Cb(1),g.nc("ngSwitchCase","album"),g.Cb(1),g.nc("ngSwitchCase","artist"),g.Cb(1),g.nc("ngSwitchCase","collection"),g.Cb(3),g.nc("folderHealth",n)}}var ge,pe=((ge=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,i,o,r,a){var c;return _classCallCheck(this,n),(c=e.call(this,t)).app=i,c.jam=o,c.notify=r,c.folderService=a,c.modes=[],c}return _createClass(n,[{key:"onFilterChange",value:function(){this.reDisplay()}},{key:"ngOnInit",value:function(){var t=this;_get(_getPrototypeOf(n.prototype),"ngOnInit",this).call(this),this.folderService.foldersChange.pipe(Object(m.a)(this.unsubscribe)).subscribe((function(e){if(e.id===t.id)t.refresh();else{var n=t.all.find((function(t){return t.folder.id===e.id}));n&&t.jam.folder.health({id:e.id,folderTag:!0}).then((function(e){var i=e.find((function(t){return t.folder.id===n.folder.id}));i?t.all[t.all.indexOf(n)]=i:t.all=t.all.filter((function(t){return t.folder.id!==n.folder.id})),t.reDisplay()})).catch((function(e){t.notify.error(e)}))}}))}},{key:"ngOnDestroy",value:function(){_get(_getPrototypeOf(n.prototype),"ngOnDestroy",this).call(this)}},{key:"refresh",value:function(){var t=this;this.hints=void 0,this.jam.folder.health({childOfID:this.id,folderTag:!0}).then((function(e){t.display(e)})).catch((function(e){t.notify.error(e)}))}},{key:"reDisplay",value:function(){var t=this;this.hints=this.filter?this.all.filter((function(e){return e.health&&e.health.find((function(e){return e.name===t.filter}))})):this.all}},{key:"display",value:function(t){this.all=t,this.modes=[];var e,n=_createForOfIteratorHelper(t);try{for(n.s();!(e=n.n()).done;){var i=e.value;if(i.health){var o,r=_createForOfIteratorHelper(i.health);try{for(r.s();!(o=r.n()).done;){var a=o.value;this.modes.includes(a.name)||this.modes.push(a.name)}}catch(c){r.e(c)}finally{r.f()}}}}catch(c){n.e(c)}finally{n.f()}this.reDisplay()}}]),n}(C)).\u0275fac=function(t){return new(t||ge)(g.Pb(v.a),g.Pb(O.e),g.Pb(y.k),g.Pb(O.i),g.Pb(O.a))},ge.\u0275cmp=g.Jb({type:ge,selectors:[["app-admin-folder-health"]],features:[g.zb],decls:10,vars:4,consts:[[1,"health"],[1,"actions"],["title","Refresh List",1,"button-on-control",3,"click"],[1,"icon-reload"],["placeholder","Type of Hints",3,"ngModel","ngModelChange",4,"ngIf"],[1,"health-content"],[4,"ngIf"],["name","Folder Health Issues",3,"list"],["class","folder",4,"ngFor","ngForOf"],["placeholder","Type of Hints",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"folder"],[1,"meta"],[3,"routerLink"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"folder-health"],[3,"folderHealth"],[1,"type"],[1,"name"],[1,"artist"],[1,"year"]],template:function(t,e){1&t&&(g.Vb(0,"div",0),g.Vb(1,"div",1),g.Vb(2,"button",2),g.dc("click",(function(){return e.refresh()})),g.Qb(3,"i",3),g.Ic(4," Refresh"),g.Ub(),g.Gc(5,oe,2,2,"select",4),g.Ub(),g.Vb(6,"div",5),g.Gc(7,re,1,0,"app-loading",6),g.Qb(8,"app-background-text-list",7),g.Gc(9,ue,11,9,"div",8),g.Ub(),g.Ub()),2&t&&(g.Cb(5),g.nc("ngIf",e.modes.length>0),g.Cb(2),g.nc("ngIf",!e.hints),g.Cb(1),g.nc("list",e.hints),g.Cb(1),g.nc("ngForOf",e.hints))},directives:[a.t,T.a,a.s,c.t,c.i,c.l,c.n,c.v,F.a,v.f,a.x,a.y,a.z,ne],styles:["[_nghost-%COMP%], [_nghost-%COMP%]   .health[_ngcontent-%COMP%]{height:100%;width:100%}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]{display:flex;flex-direction:column}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{padding:10px 15px;border-bottom:1px solid var(--background-border)}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .health-content[_ngcontent-%COMP%]{padding:15px;overflow-y:auto;overflow-x:auto}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]{border-bottom:1px solid var(--background-border);padding:15px;display:flex;flex-flow:row wrap;flex-flow:row nowrap}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]{width:30%;padding-right:15px;margin-left:15px;display:flex;flex-flow:column wrap;position:relative}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:100%;text-overflow:ellipsis;overflow:hidden}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]   .type[_ngcontent-%COMP%]{text-transform:uppercase}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]   .state[_ngcontent-%COMP%], [_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]   .type[_ngcontent-%COMP%], [_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]   .year[_ngcontent-%COMP%]{letter-spacing:1px;font-size:.8em}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-size:24px;font-weight:100;color:var(--on-background-active)}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--on-background-active)}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:var(--on-background)}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{font-size:14px;line-height:1.2em}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{margin-top:auto}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-bottom:5px;margin-right:5px;height:27px;font-weight:500;padding:1px 15px 0}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{transform:scale(1.3);transform-origin:center}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;border:1px solid transparent;padding:4px 9px 7px;border-radius:50%;display:none;position:absolute;right:1px;bottom:0}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{background-color:var(--control-hover);color:var(--on-background-hover)}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]:hover   .actions[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], [_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]:hover   app-fav-icon[_ngcontent-%COMP%]{display:inline}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .folder-health[_ngcontent-%COMP%]{display:flex;width:70%}@media (max-width:400px){[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]{padding-left:0;padding-right:0}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]{font-size:.8em}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .folder[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-size:16px}}"]}),ge);function fe(t,e){if(1&t&&(g.Vb(0,"div"),g.Vb(1,"div"),g.Ic(2),g.hc(3,"stringToggle"),g.Ub(),g.Qb(4,"app-loading"),g.Ub()),2&t){var n=g.gc();g.Cb(2),g.Jc(g.kc(3,1,n.isUploading,"Uploading","Creating Artwork"))}}function be(t,e){if(1&t){var n=g.Wb();g.Vb(0,"div",2),g.dc("drop",(function(t){return g.yc(n),g.gc().onDropFile(t)}))("dragover",(function(t){return g.yc(n),g.gc().onDragOverFile(t)})),g.Vb(1,"form"),g.Vb(2,"input",3),g.dc("change",(function(t){return g.yc(n),g.gc().selectFile(t)})),g.Ub(),g.Ub(),g.Ub()}}var me,ve=((me=function(){function t(e,n,i){_classCallCheck(this,t),this.jam=e,this.notify=n,this.folderService=i,this.isIdle=!0,this.isUploading=!1,this.unsubscribe=new b.a}return _createClass(t,[{key:"ngOnDestroy",value:function(){this.unsubscribe.next(),this.unsubscribe.complete()}},{key:"dialogInit",value:function(t,e){this.reference=t,this.folder=e.data.folder}},{key:"waitForCreationEnd",value:function(t){var e=this;this.folderService.waitForQueueResult("Creating Artwork",t,[]).pipe(Object(m.a)(this.unsubscribe)).subscribe((function(n){e.isIdle=!0,e.folderService.notifyFolderChange(e.folder.id,O.b.fsnRefresh),t.error||(e.notify.success("Upload done"),e.reference.close())}))}},{key:"onDropFile",value:function(t){t.preventDefault(),this.uploadFile(t.dataTransfer.files)}},{key:"onDragOverFile",value:function(t){t.stopPropagation(),t.preventDefault()}},{key:"selectFile",value:function(t){this.uploadFile(t.target.files)}},{key:"uploadFile",value:function(t){var e=this;if(0!==t.length){var n=t[0];this.isIdle=!1,this.isUploading=!0,this.jam.folder.artworkUpload_create({id:this.folder.id,types:[]},n).pipe(Object(m.a)(this.unsubscribe)).subscribe((function(t){if(t.type===gt.f.UploadProgress);else if(t instanceof gt.j){var n=t.body;n&&e.waitForCreationEnd(n)}}),(function(t){e.isUploading=!1,e.isIdle=!0,e.notify.error(t)}),(function(){e.isUploading=!1}))}}}]),t}()).\u0275fac=function(t){return new(t||me)(g.Pb(y.k),g.Pb(O.i),g.Pb(O.a))},me.\u0275cmp=g.Jb({type:me,selectors:[["app-dialog-upload-image"]],decls:2,vars:2,consts:[[4,"ngIf"],["class","drop-zone",3,"drop","dragover",4,"ngIf"],[1,"drop-zone",3,"drop","dragover"],["type","file","placeholder","Upload image","accept",".png,.jpeg,.jpg",3,"change"]],template:function(t,e){1&t&&(g.Gc(0,fe,5,5,"div",0),g.Gc(1,be,3,0,"div",1)),2&t&&(g.nc("ngIf",!e.isIdle),g.Cb(1),g.nc("ngIf",e.isIdle))},directives:[a.t,F.a,c.w,c.j,c.k],pipes:[P.a],styles:["[_nghost-%COMP%]   .drop-zone[_ngcontent-%COMP%]{margin:10px 20px;border:2px dotted var(--secondary);height:80%}[_nghost-%COMP%]   input[type=text][_ngcontent-%COMP%]{width:100%}"]}),me),Ce=n("c36T");function Me(t,e){1&t&&g.Qb(0,"app-loading")}function Oe(t,e){1&t&&(g.Qb(0,"i",21),g.Ic(1," Move Folder\u2026"))}function ye(t,e){1&t&&(g.Qb(0,"i",22),g.Ic(1," Remove Folder\u2026"))}function Pe(t,e){if(1&t&&g.Qb(0,"app-info-note",23),2&t){var n=g.gc(2);g.nc("info",n.folder.info)}}function _e(t,e){if(1&t&&(g.Tb(0),g.Ic(1),g.Sb()),2&t){var n=g.gc(2);g.Cb(1),g.Kc(" / ",n.folder.tag.albumType,"")}}function ke(t,e){if(1&t&&(g.Vb(0,"div"),g.Vb(1,"div",13),g.Ic(2,"Artist:"),g.Ub(),g.Vb(3,"div"),g.Ic(4),g.Ub(),g.Ub()),2&t){var n=g.gc(2);g.Cb(4),g.Jc(n.folder.tag.artist)}}function xe(t,e){if(1&t&&(g.Vb(0,"div"),g.Vb(1,"div",13),g.Ic(2,"Album:"),g.Ub(),g.Vb(3,"div"),g.Ic(4),g.Ub(),g.Ub()),2&t){var n=g.gc(2);g.Cb(4),g.Jc(n.folder.tag.album)}}function we(t,e){if(1&t&&(g.Vb(0,"div"),g.Vb(1,"div",13),g.Ic(2,"Year:"),g.Ub(),g.Vb(3,"div"),g.Ic(4),g.Ub(),g.Ub()),2&t){var n=g.gc(2);g.Cb(4),g.Kc(" ",n.folder.tag.year,"")}}function Ie(t,e){if(1&t&&(g.Vb(0,"div"),g.Vb(1,"div",13),g.Ic(2,"Genre:"),g.Ub(),g.Vb(3,"div"),g.Ic(4),g.Ub(),g.Ub()),2&t){var n=g.gc(2);g.Cb(4),g.Kc(" ",n.folder.tag.genres,"")}}function Ue(t,e){if(1&t&&(g.Vb(0,"div"),g.Vb(1,"div",13),g.Ic(2,"MB Release ID:"),g.Ub(),g.Vb(3,"div"),g.Vb(4,"a",24),g.Ic(5),g.Ub(),g.Ub(),g.Ub()),2&t){var n=g.gc(2);g.Cb(4),g.pc("href","https://musicbrainz.org/release/",n.folder.tag.mbReleaseID,"",g.Ac),g.Cb(1),g.Jc(n.folder.tag.mbReleaseID)}}function Se(t,e){if(1&t&&(g.Vb(0,"div"),g.Vb(1,"div",13),g.Ic(2,"MB Artist ID:"),g.Ub(),g.Vb(3,"div"),g.Vb(4,"a",24),g.Ic(5),g.Ub(),g.Ub(),g.Ub()),2&t){var n=g.gc(2);g.Cb(4),g.pc("href","https://musicbrainz.org/artist/",n.folder.tag.mbArtistID,"",g.Ac),g.Cb(1),g.Jc(n.folder.tag.mbArtistID)}}var Ve=function(t){return["/admin/folder",t]};function Ae(t,e){if(1&t&&(g.Vb(0,"div"),g.Vb(1,"div",13),g.Ic(2,"Parent Id:"),g.Ub(),g.Vb(3,"div"),g.Vb(4,"a",25),g.Ic(5),g.Ub(),g.Ub(),g.Ub()),2&t){var n=g.gc(2);g.Cb(4),g.nc("routerLink",g.sc(2,Ve,n.folder.parentID)),g.Cb(1),g.Jc(n.folder.parentID)}}function Re(t,e){if(1&t){var n=g.Wb();g.Vb(0,"button",26),g.dc("click",(function(){return g.yc(n),g.gc(2).searchImages()})),g.Qb(1,"i",27),g.Ic(2," Search Art"),g.Ub()}}function ze(t,e){if(1&t){var n=g.Wb();g.Vb(0,"button",28),g.dc("click",(function(){return g.yc(n),g.gc(2).searchImages()})),g.Qb(1,"i",27),g.Ic(2," Search Art"),g.Ub()}}function Fe(t,e){if(1&t&&(g.Vb(0,"div"),g.Qb(1,"app-admin-artwork-list",29),g.Ub()),2&t){var n=g.gc(2);g.Cb(1),g.nc("folderID",n.folder.id)("artworks",n.folder.artworks)}}function De(t,e){if(1&t){var n=g.Wb();g.Vb(0,"div",2),g.Vb(1,"div",3),g.Vb(2,"button",4),g.dc("click",(function(){return g.yc(n),g.gc().refresh()})),g.Qb(3,"i",5),g.Ic(4," Refresh"),g.Ub(),g.Vb(5,"context-menu",null,6),g.Gc(7,Oe,2,0,"ng-template",7),g.dc("execute",(function(){return g.yc(n),g.gc().moveFolder()})),g.Gc(8,ye,2,0,"ng-template",8),g.dc("execute",(function(){return g.yc(n),g.gc().removeFolder()})),g.Ub(),g.Vb(9,"button",9),g.Ic(10,"\u2026"),g.Ub(),g.Ub(),g.Vb(11,"div",10),g.Gc(12,Pe,1,1,"app-info-note",11),g.Vb(13,"div",12),g.Vb(14,"div"),g.Vb(15,"div"),g.Vb(16,"div",13),g.Ic(17,"Name:"),g.Ub(),g.Vb(18,"div"),g.Vb(19,"app-inline-edit",14),g.dc("ngModelChange",(function(t){return g.yc(n),g.gc().name=t}))("endEditRequest",(function(){return g.yc(n),g.gc().editFolderName()})),g.Ub(),g.Ub(),g.Ub(),g.Vb(20,"div"),g.Vb(21,"div",13),g.Ic(22,"Type:"),g.Ub(),g.Vb(23,"div"),g.Ic(24),g.Gc(25,_e,2,1,"ng-container",0),g.Ub(),g.Ub(),g.Vb(26,"div"),g.Vb(27,"div",13),g.Ic(28,"Tracks:"),g.Ub(),g.Vb(29,"div"),g.Ic(30),g.Ub(),g.Ub(),g.Vb(31,"div"),g.Vb(32,"div",13),g.Ic(33,"Folders:"),g.Ub(),g.Vb(34,"div"),g.Ic(35),g.Ub(),g.Ub(),g.Gc(36,ke,5,1,"div",0),g.Gc(37,xe,5,1,"div",0),g.Ub(),g.Vb(38,"div"),g.Gc(39,we,5,1,"div",0),g.Gc(40,Ie,5,1,"div",0),g.Gc(41,Ue,6,2,"div",0),g.Gc(42,Se,6,2,"div",0),g.Gc(43,Ae,6,4,"div",0),g.Ub(),g.Ub(),g.Vb(44,"div",15),g.Vb(45,"div",16),g.Ic(46,"Artworks"),g.Ub(),g.Vb(47,"button",17),g.dc("click",(function(){return g.yc(n),g.gc().uploadImage()})),g.Qb(48,"i",18),g.Ic(49," Upload"),g.Ub(),g.Gc(50,Re,3,0,"button",19),g.Gc(51,ze,3,0,"button",20),g.Gc(52,Fe,2,2,"div",0),g.Ub(),g.Ub(),g.Ub()}if(2&t){var i=g.vc(6),o=g.gc();g.Cb(9),g.nc("contextMenu",i)("contextMenuSubject",o.folder)("contextMenuTriggerLeft",!0),g.Cb(3),g.nc("ngIf",o.folder.info&&o.folder.info.description),g.Cb(7),g.nc("ngModel",o.name),g.Cb(5),g.Kc("",o.folder.type," "),g.Cb(1),g.nc("ngIf",o.isAlbum),g.Cb(5),g.Jc(o.folder.trackCount),g.Cb(5),g.Jc(o.folder.folderCount),g.Cb(1),g.nc("ngIf",o.folder.tag.artist),g.Cb(1),g.nc("ngIf",o.folder.tag.album),g.Cb(2),g.nc("ngIf",o.folder.tag.year),g.Cb(1),g.nc("ngIf",o.folder.tag.genres),g.Cb(1),g.nc("ngIf",o.folder.tag.mbReleaseID),g.Cb(1),g.nc("ngIf",o.folder.tag.mbArtistID),g.Cb(1),g.nc("ngIf",o.folder.parentID),g.Cb(7),g.nc("ngIf",o.isAlbum&&o.folder.tag&&(o.folder.tag.mbReleaseID||o.folder.tag.mbReleaseGroupID)),g.Cb(1),g.nc("ngIf",o.isArtist&&o.folder.tag&&o.folder.tag.mbArtistID),g.Cb(1),g.nc("ngIf",o.folder.artworks&&o.folder.artworks.length>0)}}var Qe,je=((Qe=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,i,o,r,a,c,s,l){var d;return _classCallCheck(this,n),(d=e.call(this,t)).app=i,d.jam=o,d.notify=r,d.dialogsService=a,d.dialogOverlay=c,d.folderService=s,d.router=l,d.name="",d.isAlbum=!1,d.isArtist=!1,d}return _createClass(n,[{key:"ngOnInit",value:function(){var t=this;_get(_getPrototypeOf(n.prototype),"ngOnInit",this).call(this),this.folderService.foldersChange.pipe(Object(m.a)(this.unsubscribe)).subscribe((function(e){e.id===t.id&&t.refresh()}))}},{key:"ngOnDestroy",value:function(){_get(_getPrototypeOf(n.prototype),"ngOnDestroy",this).call(this)}},{key:"editFolderName",value:function(){var t=this,e=(this.name||"").trim();if(0!==e.length&&e!==this.folder.name){var n=this.id;this.jam.folder.name_update({id:n,name:e}).then((function(e){t.folderService.waitForQueueResult("Renaming Folder",e,[n])})).catch((function(e){t.notify.error(e)}))}else this.name=this.folder.name}},{key:"refresh",value:function(){var t=this;this.id&&this.jam.folder.id({id:this.id,folderTag:!0,folderParents:!0,folderArtworks:!0,folderCounts:!0}).then((function(e){t.display(e)})).catch((function(e){404===e.code?t.router.navigate(["/admin/folder/"]).catch((function(t){console.error(t)})):t.notify.error(e)}))}},{key:"uploadImage",value:function(){this.dialogOverlay.open({title:"Upload Folder Images",childComponent:ve,data:{folder:this.folder},panelClass:"overlay-panel-large-buttons"})}},{key:"searchImages",value:function(){this.dialogOverlay.open({title:"Search Artwork Images",childComponent:Wt,data:{folder:this.folder},panelClass:"overlay-panel-large-buttons"})}},{key:"removeFolder",value:function(){var t=this,e=this.folder;this.dialogsService.confirm("Remove Folder?",'Sure to remove Folder "'.concat(e.name,'"?'),(function(){t.jam.folder.delete({id:e.id}).then((function(n){e.parentID&&t.router.navigate(["/admin/folder/".concat(e.parentID,"/overview")]).catch((function(t){console.error(t)})),t.folderService.waitForQueueResult("Removing Folder",n,[e.id],e.parentID?[e.parentID]:[])})).catch((function(e){t.notify.error(e)}))}))}},{key:"moveFolder",value:function(){var t=this,e={selectID:this.id,disableIDs:[this.id]};this.dialogOverlay.open({title:"Move Folder to",childComponent:S,data:e,panelClass:"overlay-panel-large-buttons",onOkBtn:function(){return Object(f.a)(t,void 0,void 0,regeneratorRuntime.mark((function t(){var n=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.prev=0,this.jam.folder.parent_update({ids:[this.folder.id],folderID:e.folder.id}).then((function(t){n.folderService.waitForQueueResult("Moving Folder",t,[n.folder.id],[n.folder.parentID,e.folder.id])})).catch((function(t){n.notify.error(t)})),t.next=7;break;case 4:return t.prev=4,t.t0=t.catch(0),t.abrupt("return",(this.notify.error(t.t0),Promise.reject(t.t0)));case 7:case"end":return t.stop()}}),t,this,[[0,4]])})))},onCancelBtn:function(){return Object(f.a)(t,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Promise.resolve());case 1:case"end":return t.stop()}}),t)})))}})}},{key:"display",value:function(t){this.name="",this.isAlbum=!1,this.isArtist=!1,this.folder=t,t&&(this.name=t.name,this.isAlbum=y.f.includes(t.type),this.isArtist=t.type===y.e.artist)}}]),n}(C)).\u0275fac=function(t){return new(t||Qe)(g.Pb(v.a),g.Pb(O.e),g.Pb(y.k),g.Pb(O.i),g.Pb(O.g),g.Pb(M.b),g.Pb(O.a),g.Pb(v.c))},Qe.\u0275cmp=g.Jb({type:Qe,selectors:[["app-admin-folder"]],features:[g.zb],decls:2,vars:2,consts:[[4,"ngIf"],["class","folder",4,"ngIf"],[1,"folder"],[1,"actions"],["title","Refresh Folder",1,"button-on-control",3,"click"],[1,"icon-reload"],["folderActionMenu",""],["contextMenuItem","","title","Move Folder to another Folder",3,"execute"],["contextMenuItem","","title","Remove Folder",3,"execute"],[1,"button-on-control",3,"contextMenu","contextMenuSubject","contextMenuTriggerLeft"],[1,"content"],[3,"info",4,"ngIf"],[1,"properties"],[1,"label"],["type","text",3,"ngModel","ngModelChange","endEditRequest"],[1,"artworks"],[1,"section-title"],[1,"button-on-control",3,"click"],[1,"icon-upload-cloud"],["class","button-on-control","title","Album Images",3,"click",4,"ngIf"],["class","button-on-control","title","Artist Images",3,"click",4,"ngIf"],[1,"icon-right-bold"],[1,"icon-trash"],[3,"info"],["target","_blank","rel","noopener",3,"href"],[3,"routerLink"],["title","Album Images",1,"button-on-control",3,"click"],[1,"icon-picture"],["title","Artist Images",1,"button-on-control",3,"click"],[3,"folderID","artworks"]],template:function(t,e){1&t&&(g.Gc(0,Me,1,0,"app-loading",0),g.Gc(1,De,53,19,"div",1)),2&t&&(g.nc("ngIf",!e.folder),g.Cb(1),g.nc("ngIf",e.folder))},directives:[a.t,F.a,D.a,Q.a,j.a,wt,c.i,c.l,Ce.a,v.f,At],styles:["[_nghost-%COMP%]{overflow:hidden;display:block}[_nghost-%COMP%], [_nghost-%COMP%]   .folder[_ngcontent-%COMP%]{height:100%;width:100%}[_nghost-%COMP%]   .folder[_ngcontent-%COMP%]{display:flex;flex-direction:column}[_nghost-%COMP%]   .folder[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{padding:10px 15px;border-bottom:1px solid var(--background-border)}[_nghost-%COMP%]   .folder[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{overflow-y:auto;padding:15px;display:flex;flex-direction:column}[_nghost-%COMP%]   .folder[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .properties[_ngcontent-%COMP%]{width:100%;display:flex;flex-wrap:wrap;flex-direction:row}[_nghost-%COMP%]   .folder[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .properties[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{flex:0 0 50%}@media (max-width:522px){[_nghost-%COMP%]   .folder[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .properties[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{flex:0 0 100%}}[_nghost-%COMP%]   .folder[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .properties[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;flex-direction:row;padding-top:5px;padding-bottom:5px}[_nghost-%COMP%]   .folder[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .properties[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{flex:0 0 60%;color:var(--on-background-active)}[_nghost-%COMP%]   .folder[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .properties[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--on-background-active)}[_nghost-%COMP%]   .folder[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .properties[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:var(--on-background)}[_nghost-%COMP%]   .folder[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .properties[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{flex:0 0 40%;color:var(--on-background);max-width:80px;font-size:.8em;text-transform:uppercase;padding-right:8px}[_nghost-%COMP%]   .folder[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .artworks[_ngcontent-%COMP%], [_nghost-%COMP%]   .folder[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .folders[_ngcontent-%COMP%], [_nghost-%COMP%]   .folder[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .tracks[_ngcontent-%COMP%]{border-top:1px solid var(--background-border);padding-top:10px;padding-bottom:10px}"]}),Qe);function Te(t,e){1&t&&(g.Vb(0,"div",2),g.Vb(1,"div",3),g.Qb(2,"i",4),g.Ub(),g.Ub())}function Ee(t,e){1&t&&(g.Vb(0,"div",3),g.Ic(1,"No Hints"),g.Ub())}function Ge(t,e){if(1&t&&(g.Vb(0,"div",3),g.Qb(1,"i",9),g.Ic(2),g.Vb(3,"div",10),g.Ic(4),g.Ub(),g.Ub()),2&t){var n=e.$implicit;g.Cb(2),g.Kc(" ",n.hint.name," "),g.Cb(2),g.Jc(n.description)}}function Be(t,e){1&t&&g.Qb(0,"i",4)}function He(t,e){if(1&t&&(g.Tb(0),g.Ic(1),g.Sb()),2&t){var n=g.gc().$implicit;g.Cb(1),g.Jc(n.name)}}function Le(t,e){if(1&t&&(g.Vb(0,"button",11),g.dc("click",(function(){return e.$implicit.click()})),g.Gc(1,Be,1,0,"i",12),g.Gc(2,He,2,1,"ng-container",0),g.Ub()),2&t){var n=e.$implicit;g.Cb(1),g.nc("ngIf",n.running),g.Cb(1),g.nc("ngIf",!n.running)}}function Je(t,e){if(1&t&&(g.Vb(0,"div",2),g.Gc(1,Ee,2,0,"div",5),g.Gc(2,Ge,5,2,"div",6),g.Vb(3,"div",7),g.Gc(4,Le,3,2,"button",8),g.Ub(),g.Ub()),2&t){var n=g.gc(2);g.Cb(1),g.nc("ngIf",0===n.hints.length),g.Cb(1),g.nc("ngForOf",n.hints)("ngForTrackBy",n.trackByFn),g.Cb(2),g.nc("ngForOf",n.solutions)}}function We(t,e){if(1&t&&(g.Tb(0),g.Gc(1,Te,3,0,"div",1),g.Gc(2,Je,5,4,"div",1),g.Sb()),2&t){var n=g.gc();g.Cb(1),g.nc("ngIf",!(n.trackHealth.health&&n.hints)),g.Cb(1),g.nc("ngIf",n.trackHealth.health&&n.hints)}}var Ne,$e=((Ne=function(){function t(e,n,i,o,r){_classCallCheck(this,t),this.app=e,this.jam=n,this.notify=i,this.folderService=o,this.router=r,this.solutions=[],this.resolvedEvent=new g.n,this.unsubscribe=new b.a}return _createClass(t,[{key:"trackByFn",value:function(t,e){return e.hint.id}},{key:"ngOnChanges",value:function(t){this.display(this.trackHealth)}},{key:"ngOnDestroy",value:function(){this.unsubscribe.next(),this.unsubscribe.complete()}},{key:"ngOnInit",value:function(){var t=this;this.folderService.tracksChange.pipe(Object(m.a)(this.unsubscribe)).subscribe((function(e){var n=t.trackHealth;n&&n.track.id===e.id&&(n.health=void 0,t.jam.track.health({id:n.track.id,media:!0}).then((function(e){var i=e.find((function(t){return t.track.id===n.track.id}));i&&i.health?(n.track=i.track,n.health=i.health):n.health=[],0===n.health.length&&t.resolvedEvent.emit(),t.display(n)})).catch((function(e){t.notify.error(e)})))}))}},{key:"fixAll",value:function(){var t,e=_createForOfIteratorHelper(this.solutions);try{for(e.s();!(t=e.n()).done;){var n=t.value;n.fixable&&!n.running&&n.click()}}catch(i){e.e(i)}finally{e.f()}}},{key:"display",value:function(t){var e=this;this.hints=[],this.solutions=[],t.health&&(this.hints=t.health.map((function(n){return{hint:n,description:e.describeHint(n,t.track)}})))}},{key:"describeTagHint",value:function(t,e){var n=this,i="";return t.id===y.s.tagValuesExists?i=(t.details||[]).map((function(t){return t.reason.toUpperCase()})).join(", "):t.id===y.s.id3v2Garbage?i=(t.details||[]).map((function(t){return t.reason})).join(", "):t.id===y.s.id3v2Valid&&(i=(t.details||[]).map((function(t){return t.expected&&t.actual?"".concat(t.reason,"  (").concat(t.actual," instead of ").concat(t.expected,")"):t.reason})).join(", ")),this.solutions.find((function(t){return"Edit Tag"===t.name}))||this.solutions.push({name:"Edit Tag",click:function(){n.router.navigate(["/admin/folder/".concat(e.parentID,"/tags")]).catch((function(t){console.error(t)}))}}),i}},{key:"describeMp3GarbageHint",value:function(t,e){var n=this,i="";if(t.details.length>0&&(i="".concat(t.details[0].reason," (").concat(t.details[0].actual," bytes)")),!this.solutions.find((function(t){return"Fix MP3"===t.name}))){var o={name:"Fix MP3",fixable:!0,click:function(){o.running||(o.running=!0,n.jam.track.fix({id:e.id,fixID:t.id}).then((function(t){n.folderService.waitForQueueResult("Fixing Track MP3",t,[],[],[e.id])})).catch((function(t){n.notify.error(t)})))}};this.solutions.push(o)}return i}},{key:"describeMp3ErrorHint",value:function(t,e){var n=this,i="Stream Errors: ".concat((t.details||[]).length);if(!this.solutions.find((function(t){return"Fix Stream"===t.name}))){var o={name:"Fix Stream",fixable:!0,click:function(){o.running||(o.running=!0,n.jam.track.fix({id:e.id,fixID:t.id}).then((function(t){n.folderService.waitForQueueResult("Fixing Track Stream",t,[],[],[e.id])})).catch((function(t){n.notify.error(t)})))}};this.solutions.push(o)}return i}},{key:"describeID3v1Hint",value:function(t,e){var n=this;if(!this.solutions.find((function(t){return"Remove ID3v1"===t.name}))){var i={name:"Remove ID3v1",fixable:!0,click:function(){i.running||(i.running=!0,n.jam.track.fix({id:e.id,fixID:t.id}).then((function(t){n.folderService.waitForQueueResult("Remove ID3v1",t,[],[],[e.id])})).catch((function(t){n.notify.error(t)})))}};this.solutions.push(i)}return""}},{key:"describeMP3HeaderHint",value:function(t,e){var n=this,i="";if(t.id===y.s.mp3HeaderValid&&(i=(t.details||[]).map((function(t){return t.expected&&t.actual?"".concat(t.reason,"  (").concat(t.actual," instead of ").concat(t.expected,")"):t.reason})).join(", ")),!this.solutions.find((function(t){return"Fix Header"===t.name}))){var o={name:"Fix Header",fixable:!0,click:function(){o.running||(o.running=!0,n.jam.track.fix({id:e.id,fixID:t.id}).then((function(t){n.folderService.waitForQueueResult("Fixing Track Header",t,[],[],[e.id])})).catch((function(t){n.notify.error(t)})))}};this.solutions.push(o)}return i}},{key:"describeHint",value:function(t,e){switch(t.id){case y.s.tagValuesExists:case y.s.id3v2Garbage:case y.s.id3v2Exists:case y.s.id3v2Valid:return this.describeTagHint(t,e);case y.s.mp3Garbage:return this.describeMp3GarbageHint(t,e);case y.s.mp3MediaValid:return this.describeMp3ErrorHint(t,e);case y.s.id3v2NoId3v1:return this.describeID3v1Hint(t,e);case y.s.mp3HeaderExists:case y.s.mp3HeaderValid:return this.describeMP3HeaderHint(t,e)}return""}}]),t}()).\u0275fac=function(t){return new(t||Ne)(g.Pb(O.e),g.Pb(y.k),g.Pb(O.i),g.Pb(O.a),g.Pb(v.c))},Ne.\u0275cmp=g.Jb({type:Ne,selectors:[["app-track-health"]],inputs:{trackHealth:"trackHealth"},outputs:{resolvedEvent:"resolvedEvent"},features:[g.Ab],decls:1,vars:1,consts:[[4,"ngIf"],["class","hints",4,"ngIf"],[1,"hints"],[1,"hint"],[1,"icon-spin","icon-spinner"],["class","hint",4,"ngIf"],["class","hint",4,"ngFor","ngForOf","ngForTrackBy"],[1,"solutions"],["class","button-on-background",3,"click",4,"ngFor","ngForOf"],[1,"icon-warning"],[1,"details"],[1,"button-on-background",3,"click"],["class","icon-spin icon-spinner",4,"ngIf"]],template:function(t,e){1&t&&g.Gc(0,We,3,2,"ng-container",0),2&t&&g.nc("ngIf",e.trackHealth)},directives:[a.t,a.s],styles:["[_nghost-%COMP%]{height:100%;width:100%;overflow-y:auto;overflow-x:auto;display:block}[_nghost-%COMP%]   .icon-warning[_ngcontent-%COMP%]{color:var(--accent)}[_nghost-%COMP%]   .details[_ngcontent-%COMP%]{padding-left:28px;font-size:.8em;display:block;padding-top:5px}[_nghost-%COMP%]   .hint[_ngcontent-%COMP%], [_nghost-%COMP%]   .solutions[_ngcontent-%COMP%]{padding-bottom:15px}[_nghost-%COMP%]   .solutions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-right:5px}[_nghost-%COMP%]   .detail[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{text-transform:uppercase;letter-spacing:1.25px;font-size:11px;min-width:80px;margin-right:10px;display:inline-block}"]}),Ne);function qe(t,e){1&t&&g.Qb(0,"app-loading")}function Ke(t,e){if(1&t){var n=g.Wb();g.Vb(0,"div",9),g.Vb(1,"div",10),g.Ic(2),g.Ub(),g.Vb(3,"div",11),g.Vb(4,"app-track-health",12),g.dc("resolvedEvent",(function(){g.yc(n);var t=e.$implicit;return g.gc().trackHealthResolved(t)})),g.Ub(),g.Ub(),g.Ub()}if(2&t){var i=e.$implicit;g.Cb(2),g.Kc(" ",i.track.name," "),g.Cb(2),g.nc("trackHealth",i)}}var Ye,Xe=((Ye=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,i,o,r,a){var c;return _classCallCheck(this,n),(c=e.call(this,t)).app=i,c.jam=o,c.notify=r,c.folderService=a,c.modes=[],c.mediaCheck=!1,c}return _createClass(n,[{key:"onFilterChange",value:function(){this.reDisplay()}},{key:"ngOnInit",value:function(){var t=this;_get(_getPrototypeOf(n.prototype),"ngOnInit",this).call(this),this.folderService.foldersChange.pipe(Object(m.a)(this.unsubscribe)).subscribe((function(e){e.id===t.id&&t.refresh()}))}},{key:"ngOnDestroy",value:function(){_get(_getPrototypeOf(n.prototype),"ngOnDestroy",this).call(this)}},{key:"checkChange",value:function(){this.refresh()}},{key:"trackHealthResolved",value:function(t){this.all&&(this.all=this.all.filter((function(e){return e!==t})),this.reDisplay())}},{key:"refresh",value:function(){var t=this;this.hints=void 0,this.jam.track.health({parentID:this.id,media:this.mediaCheck}).then((function(e){t.display(e)})).catch((function(e){t.notify.error(e)}))}},{key:"reDisplay",value:function(){var t=this;this.hints=this.filter?this.all.filter((function(e){return e.health&&e.health.find((function(e){return e.name===t.filter}))})):this.all.slice(0)}},{key:"display",value:function(t){this.all=t,this.modes=[];var e,n=_createForOfIteratorHelper(t);try{for(n.s();!(e=n.n()).done;){var i=e.value;if(i.health){var o,r=_createForOfIteratorHelper(i.health);try{for(r.s();!(o=r.n()).done;){var a=o.value;this.modes.includes(a.name)||this.modes.push(a.name)}}catch(c){r.e(c)}finally{r.f()}}}}catch(c){n.e(c)}finally{n.f()}this.reDisplay()}}]),n}(C)).\u0275fac=function(t){return new(t||Ye)(g.Pb(v.a),g.Pb(O.e),g.Pb(y.k),g.Pb(O.i),g.Pb(O.a))},Ye.\u0275cmp=g.Jb({type:Ye,selectors:[["app-admin-tracks-health"]],features:[g.zb],decls:12,vars:5,consts:[[1,"health"],[1,"actions"],["title","Refresh List",1,"button-on-control",3,"click"],[1,"icon-reload"],["type","checkbox",3,"ngModel","checked","ngModelChange","change"],[1,"content"],[4,"ngIf"],["name","Track Health Issues",3,"list"],["class","track",4,"ngFor","ngForOf"],[1,"track"],[1,"meta"],[1,"track-health"],[3,"trackHealth","resolvedEvent"]],template:function(t,e){1&t&&(g.Vb(0,"div",0),g.Vb(1,"div",1),g.Vb(2,"button",2),g.dc("click",(function(){return e.refresh()})),g.Qb(3,"i",3),g.Ic(4," Refresh"),g.Ub(),g.Vb(5,"label"),g.Vb(6,"input",4),g.dc("ngModelChange",(function(t){return e.mediaCheck=t}))("change",(function(){return e.checkChange()})),g.Ub(),g.Ic(7," Check Media "),g.Ub(),g.Ub(),g.Vb(8,"div",5),g.Gc(9,qe,1,0,"app-loading",6),g.Qb(10,"app-background-text-list",7),g.Gc(11,Ke,5,2,"div",8),g.Ub(),g.Ub()),2&t&&(g.Cb(6),g.nc("ngModel",e.mediaCheck)("checked",e.mediaCheck),g.Cb(3),g.nc("ngIf",!e.hints),g.Cb(1),g.nc("list",e.hints),g.Cb(1),g.nc("ngForOf",e.hints))},directives:[c.a,c.i,c.l,a.t,T.a,a.s,F.a,$e],styles:["[_nghost-%COMP%], [_nghost-%COMP%]   .health[_ngcontent-%COMP%]{height:100%;width:100%}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]{display:flex;flex-direction:column}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{padding:10px 15px;border-bottom:1px solid var(--background-border)}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{padding:15px;overflow-y:auto;overflow-x:auto}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .track[_ngcontent-%COMP%]{flex-flow:row nowrap}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .track[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]{width:30%;overflow:hidden;padding-right:15px;text-overflow:ellipsis}[_nghost-%COMP%]   .health[_ngcontent-%COMP%]   .track[_ngcontent-%COMP%]   .track-health[_ngcontent-%COMP%]{width:70%}"]}),Ye),Ze=n("pnwl");function tn(t,e){if(1&t&&(g.Vb(0,"tr",13),g.dc("click",(function(){var t=e.$implicit;return t.selected=!t.selected})),g.Vb(1,"td",4),g.Ic(2),g.Ub(),g.Vb(3,"td",5),g.Ic(4),g.Ub(),g.Vb(5,"td",6),g.Ic(6),g.Ub(),g.Vb(7,"td",7),g.Ic(8),g.Ub(),g.Vb(9,"td",8),g.Ic(10),g.Ub(),g.Vb(11,"td",9),g.Ic(12),g.Ub(),g.Vb(13,"td",10),g.Ic(14),g.Ub(),g.Vb(15,"td",11),g.Ic(16),g.hc(17,"duration"),g.Ub(),g.Ub()),2&t){var n=e.$implicit;g.Gb("selected",n.selected),g.Cb(2),g.Jc(n.track.tag.trackNr),g.Cb(2),g.Jc(n.track.tag.title),g.Cb(2),g.Jc(n.track.tag.artist),g.Cb(2),g.Jc(n.track.tag.album),g.Cb(2),g.Jc(n.track.media.format),g.Cb(2),g.Jc(n.track.media.bitRate),g.Cb(2),g.Jc(n.track.media.sampleRate),g.Cb(2),g.Jc(g.ic(17,10,n.track.duration))}}function en(t,e){if(1&t&&(g.Vb(0,"table",2),g.Vb(1,"tr",3),g.Vb(2,"td",4),g.Ic(3,"Track Nr."),g.Ub(),g.Vb(4,"td",5),g.Ic(5,"Title"),g.Ub(),g.Vb(6,"td",6),g.Ic(7,"Artist"),g.Ub(),g.Vb(8,"td",7),g.Ic(9,"Album"),g.Ub(),g.Vb(10,"td",8),g.Ic(11,"Format"),g.Ub(),g.Vb(12,"td",9),g.Ic(13,"BitRate"),g.Ub(),g.Vb(14,"td",10),g.Ic(15,"SampleRate"),g.Ub(),g.Vb(16,"td",11),g.Ic(17,"Duration"),g.Ub(),g.Ub(),g.Gc(18,tn,18,12,"tr",12),g.Ub()),2&t){var n=g.gc();g.Cb(18),g.nc("ngForOf",n.trackItems)}}var nn,on=((nn=function(){function t(e){_classCallCheck(this,t),this.router=e,this.tracks=[]}return _createClass(t,[{key:"getSortValue",value:function(t,e){switch(t){case"number":return e.track.tag.trackNr;case"name":return e.track.name;case"artist":return e.track.tag.artist;case"album":return e.track.tag.album;case"duration":return e.track.duration}}},{key:"ngOnChanges",value:function(t){this.trackItems=(this.tracks||[]).map((function(t){return{track:t}}))}},{key:"toTrackFolder",value:function(t){this.router.navigate(["/admin/folder/".concat(t.parentID,"/overview")]).catch((function(t){console.error(t)}))}}]),t}()).\u0275fac=function(t){return new(t||nn)(g.Pb(v.c))},nn.\u0275cmp=g.Jb({type:nn,selectors:[["app-admin-track-list"]],inputs:{tracks:"tracks"},features:[g.Ab],decls:2,vars:2,consts:[["name","Tracks",3,"list"],["class","tracks",4,"ngIf"],[1,"tracks"],[1,"track","heading"],[1,"number"],[1,"title"],[1,"artist"],[1,"album"],[1,"format"],[1,"bitrate"],[1,"samplerate"],[1,"duration"],["class","track",3,"selected","click",4,"ngFor","ngForOf"],[1,"track",3,"click"]],template:function(t,e){1&t&&(g.Qb(0,"app-background-text-list",0),g.Gc(1,en,19,1,"table",1)),2&t&&(g.nc("list",e.tracks),g.Cb(1),g.nc("ngIf",e.tracks&&e.tracks.length>0))},directives:[T.a,a.t,a.s],pipes:[Ze.a],styles:["[_nghost-%COMP%]{width:100%;overflow:auto;display:block}[_nghost-%COMP%]   .tracks[_ngcontent-%COMP%]{padding:15px;width:100%}[_nghost-%COMP%]   .heading[_ngcontent-%COMP%], [_nghost-%COMP%]   .tracks[_ngcontent-%COMP%]{font-size:.9em}[_nghost-%COMP%]   .track[_ngcontent-%COMP%]{border-bottom:1px solid var(--control-border)}[_nghost-%COMP%]   .track[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:5px 10px}[_nghost-%COMP%]   .track[_ngcontent-%COMP%]:hover{background-color:var(--background-hover)}[_nghost-%COMP%]   .track.selected[_ngcontent-%COMP%]{background-color:var(--background-active)}"]}),nn);function rn(t,e){1&t&&g.Qb(0,"app-loading")}function an(t,e){1&t&&(g.Qb(0,"i",12),g.Ic(1," Move Tracks\u2026"))}function cn(t,e){1&t&&(g.Qb(0,"i",13),g.Ic(1," Delete Tracks\u2026"))}function sn(t,e){if(1&t){var n=g.Wb();g.Vb(0,"div",3),g.Vb(1,"div",4),g.Vb(2,"button",5),g.dc("click",(function(){return g.yc(n),g.gc().refresh()})),g.Qb(3,"i",6),g.Ic(4," Refresh"),g.Ub(),g.Vb(5,"context-menu",null,7),g.Gc(7,an,2,0,"ng-template",8),g.dc("execute",(function(){return g.yc(n),g.gc().moveTracks()})),g.Gc(8,cn,2,0,"ng-template",9),g.dc("execute",(function(){return g.yc(n),g.gc().deleteTracks()})),g.Ub(),g.Vb(9,"button",10),g.Ic(10,"\u2026"),g.Ub(),g.Ub(),g.Qb(11,"app-admin-track-list",11),g.Ub()}if(2&t){var i=g.vc(6),o=g.gc();g.Cb(9),g.nc("contextMenu",i)("contextMenuTriggerLeft",!0),g.Cb(2),g.nc("tracks",o.folder.tracks)}}var ln,dn=((ln=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,i,o,r,a,c){var s;return _classCallCheck(this,n),(s=e.call(this,t)).jam=i,s.notify=o,s.folderService=r,s.dialogsService=a,s.dialogOverlay=c,s}return _createClass(n,[{key:"ngOnInit",value:function(){var t=this;_get(_getPrototypeOf(n.prototype),"ngOnInit",this).call(this),this.folderService.foldersChange.pipe(Object(m.a)(this.unsubscribe)).subscribe((function(e){e.id===t.id&&t.refresh()}))}},{key:"ngOnDestroy",value:function(){_get(_getPrototypeOf(n.prototype),"ngOnDestroy",this).call(this)}},{key:"deleteTracks",value:function(){var t=this,e=this.getTrackIDs();0!==e.length&&this.dialogsService.confirm("Remove Tracks?","Sure to remove ".concat(e.length," Track").concat(e.length>1?"s":"","?"),(function(){var n,i=_createForOfIteratorHelper(e);try{var o=function(){var e=n.value;t.jam.track.delete({id:e}).then((function(n){t.folderService.waitForQueueResult("Removing Track",n,[],[],[e])})).catch((function(e){t.notify.error(e)}))};for(i.s();!(n=i.n()).done;)o()}catch(r){i.e(r)}finally{i.f()}}))}},{key:"getTrackIDs",value:function(){var t=this.tracks.trackItems.filter((function(t){return t.selected})).map((function(t){return t.track.id}));return t.length>0?t:this.folder.tracks.map((function(t){return t.id}))}},{key:"moveTracks",value:function(){var t=this,e=this.getTrackIDs();if(0!==e.length){var n={selectID:this.id};this.dialogOverlay.open({title:"Move Tracks to",childComponent:S,data:n,panelClass:"overlay-panel-large-buttons",onOkBtn:function(){return Object(f.a)(t,void 0,void 0,regeneratorRuntime.mark((function t(){var i=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(this.jam.track.parent_update({ids:e,folderID:n.folder.id}).then((function(t){i.folderService.waitForQueueResult("Moving Tracks",t,[],[n.folder.id].concat(i.folder.parentID?[i.folder.parentID]:[]),e)})).catch((function(t){i.notify.error(t)})),Promise.resolve()));case 1:case"end":return t.stop()}}),t,this)})))},onCancelBtn:function(){return Object(f.a)(t,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Promise.resolve());case 1:case"end":return t.stop()}}),t)})))}})}}},{key:"refresh",value:function(){var t=this;this.folder=void 0,this.jam.folder.id({id:this.id,folderTracks:!0,trackTag:!0,trackMedia:!0}).then((function(e){t.folder=e})).catch((function(e){t.notify.error(e)}))}}]),n}(C)).\u0275fac=function(t){return new(t||ln)(g.Pb(v.a),g.Pb(y.k),g.Pb(O.i),g.Pb(O.a),g.Pb(O.g),g.Pb(M.b))},ln.\u0275cmp=g.Jb({type:ln,selectors:[["app-admin-folder-tracks"]],viewQuery:function(t,e){var n;1&t&&g.Oc(on,!0),2&t&&g.uc(n=g.ec())&&(e.tracks=n.first)},features:[g.zb],decls:3,vars:3,consts:[[4,"ngIf"],["name","Tracks",3,"list"],["class","tracks",4,"ngIf"],[1,"tracks"],[1,"actions"],["title","Refresh Folder",1,"button-on-control",3,"click"],[1,"icon-reload"],["tracksActionMenu",""],["contextMenuItem","","title","Move Tracks to another Folder",3,"execute"],["contextMenuItem","","title","Delete Tracks",3,"execute"],[1,"button-on-control",3,"contextMenu","contextMenuTriggerLeft"],[1,"content",3,"tracks"],[1,"icon-right-bold"],[1,"icon-trash"]],template:function(t,e){1&t&&(g.Gc(0,rn,1,0,"app-loading",0),g.Qb(1,"app-background-text-list",1),g.Gc(2,sn,12,3,"div",2)),2&t&&(g.nc("ngIf",!e.folder),g.Cb(1),g.nc("list",null==e.folder?null:e.folder.tracks),g.Cb(1),g.nc("ngIf",e.folder&&e.folder.tracks&&e.folder.tracks.length>0))},directives:[a.t,T.a,F.a,D.a,Q.a,j.a,on],styles:["[_nghost-%COMP%]{display:block;overflow:hidden}[_nghost-%COMP%], [_nghost-%COMP%]   .tracks[_ngcontent-%COMP%]{height:100%;width:100%}[_nghost-%COMP%]   .tracks[_ngcontent-%COMP%]{display:flex;flex-direction:column}[_nghost-%COMP%]   .tracks[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{padding:10px 15px;border-bottom:1px solid var(--background-border)}[_nghost-%COMP%]   .tracks[_ngcontent-%COMP%]   app-admin-track-list[_ngcontent-%COMP%]{overflow-y:auto}"]}),ln),hn=n("9S5+");function un(t,e){if(1&t){var n=g.Wb();g.Vb(0,"button",9),g.dc("click",(function(){g.yc(n);var t=g.gc(3);return t.refresh(t.current.pos,!1)})),g.Qb(1,"i",10),g.Ic(2," Refresh"),g.Ub()}}function gn(t,e){if(1&t){var n=g.Wb();g.Vb(0,"button",9),g.dc("click",(function(){return g.yc(n),g.gc(3).fixAll()})),g.Ic(1,"Fix all fixable"),g.Ub()}}function pn(t,e){if(1&t){var n=g.Wb();g.Vb(0,"div",5),g.Vb(1,"button",6),g.dc("click",(function(){return g.yc(n),g.gc(2).start()})),g.Qb(2,"i",7),g.Ic(3," Next"),g.Ub(),g.Gc(4,un,3,0,"button",8),g.Gc(5,gn,2,0,"button",8),g.Ub()}if(2&t){var i=g.gc(2);g.Cb(4),g.nc("ngIf",i.current),g.Cb(1),g.nc("ngIf",i.current&&i.current.health&&i.current.health.length>0)}}function fn(t,e){if(1&t){var n=g.Wb();g.Vb(0,"div",5),g.Vb(1,"button",9),g.dc("click",(function(){return g.yc(n),g.gc(2).stop()})),g.Qb(2,"i",11),g.Ic(3," Stop"),g.Ub(),g.Vb(4,"button",12),g.Qb(5,"i",13),g.Ub(),g.Ub()}}function bn(t,e){if(1&t&&(g.Tb(0),g.Gc(1,pn,6,2,"div",4),g.Gc(2,fn,6,0,"div",4),g.Sb()),2&t){var n=g.gc();g.Cb(1),g.nc("ngIf",!n.searching),g.Cb(1),g.nc("ngIf",n.searching)}}function mn(t,e){1&t&&g.Qb(0,"app-loading")}function vn(t,e){if(1&t&&(g.Vb(0,"span"),g.Ic(1),g.Ub()),2&t){var n=g.gc(3);g.Cb(1),g.Lc("",n.current.pos+1," / ",n.folders.length,"")}}function Cn(t,e){if(1&t){var n=g.Wb();g.Vb(0,"div",18),g.Vb(1,"div",19),g.Ic(2),g.Ub(),g.Vb(3,"div",20),g.Vb(4,"app-track-health",21),g.dc("resolvedEvent",(function(){g.yc(n);var t=e.$implicit;return g.gc(4).trackHealthResolved(t)})),g.Ub(),g.Ub(),g.Ub()}if(2&t){var i=e.$implicit;g.Cb(2),g.Kc(" ",i.track.name," "),g.Cb(2),g.nc("trackHealth",i)}}function Mn(t,e){if(1&t&&(g.Tb(0),g.Gc(1,Cn,5,2,"div",17),g.Sb()),2&t){var n=g.gc(3);g.Cb(1),g.nc("ngForOf",n.current.health)("ngForTrackBy",n.trackByFn)}}var On=function(t){return["/admin/folder",t,"tags"]};function yn(t,e){if(1&t&&(g.Tb(0),g.Vb(1,"div",14),g.Gc(2,vn,2,2,"span",2),g.Vb(3,"a",15),g.Qb(4,"i",16),g.Ic(5),g.Ub(),g.Ub(),g.Gc(6,Mn,2,2,"ng-container",2),g.Sb()),2&t){var n=g.gc(2);g.Cb(2),g.nc("ngIf",n.current),g.Cb(1),g.nc("routerLink",g.sc(4,On,n.current.folder.id)),g.Cb(2),g.Kc(" ",n.current.folder.name,""),g.Cb(1),g.nc("ngIf",n.current&&n.current.health)}}function Pn(t,e){if(1&t&&(g.Vb(0,"div"),g.Gc(1,yn,7,6,"ng-container",2),g.Ub()),2&t){var n=g.gc();g.Cb(1),g.nc("ngIf",n.current)}}var _n,kn=((_n=function(){function t(e,n,i,o,r,a){var c=this;_classCallCheck(this,t),this.app=e,this.jam=n,this.notify=i,this.uiState=o,this.folderService=r,this.userStorage=a,this.searching=!1,this.unsubscribe=new b.a,a.userChange.pipe(Object(m.a)(this.unsubscribe)).subscribe((function(t){c.loadFromStorage()}))}return _createClass(t,[{key:"trackHealthResolved",value:function(t){this.current&&this.current.health&&(this.current.health=this.current.health.filter((function(e){return e!==t})))}},{key:"trackByFn",value:function(t,e){return e.track.id}},{key:"stop",value:function(){this.searching=!1}},{key:"start",value:function(){!this.searching&&this.folders&&(this.searching=!0,this.request())}},{key:"request",value:function(){if(this.searching){var t=0;this.current&&(t=this.current.pos+1),this.refresh(t,!0)}}},{key:"fixAll",value:function(){!this.searching&&this.current&&this.trackHealthComponents&&this.trackHealthComponents.forEach((function(t){t.fixAll()}))}},{key:"refresh",value:function(e,n){var i=this;this.current=void 0,this.searching=!0;var o=this.folders[e];if(o){var r={folder:o,pos:e};this.current=r,this.userStorage.set(t.localStorageName,{folderID:o.id}),this.jam.track.health({parentID:o.id,media:!0}).then((function(t){t.length>0?(r.health=t,i.searching=!1):n?i.request():(r.health=[],i.searching=!1)})).catch((function(t){i.current=void 0,i.searching=!1,i.notify.error(t)}))}else this.searching=!1}},{key:"ngOnInit",value:function(){var t=this.uiState.data["app-admin-radar"];t&&(this.folders=t.folders,this.current=t.current,this.folders)||this.loadFolders()}},{key:"ngOnDestroy",value:function(){this.uiState.data["app-admin-radar"]={folders:this.folders,current:this.current},this.current=void 0,this.searching=!1,this.folders=void 0,this.unsubscribe.next(),this.unsubscribe.complete()}},{key:"loadFromStorage",value:function(){var e=this.userStorage.get(t.localStorageName);if(e&&e.folderID){var n=this.folders.findIndex((function(t){return t.id===e.folderID}));n>=0&&(this.current={folder:this.folders[n],pos:n},this.refresh(n,!1))}}},{key:"loadFolders",value:function(){var t=this;this.jam.folder.search({types:[y.e.album,y.e.multialbum],folderCounts:!0}).then((function(e){t.folders=e.items.filter((function(t){return t.trackCount>0})),t.loadFromStorage()})).catch((function(e){t.notify.error(e)}))}}]),t}()).localStorageName="admin.radar",_n.\u0275fac=function(t){return new(t||_n)(g.Pb(O.e),g.Pb(y.k),g.Pb(O.i),g.Pb(O.o),g.Pb(O.a),g.Pb(O.p))},_n.\u0275cmp=g.Jb({type:_n,selectors:[["app-admin-radar"]],viewQuery:function(t,e){var n;1&t&&g.Oc($e,!0),2&t&&g.uc(n=g.ec())&&(e.trackHealthComponents=n)},decls:6,vars:3,consts:[[1,"radar"],["section","Health Radar"],[4,"ngIf"],[1,"content"],["class","buttons",4,"ngIf"],[1,"buttons"],[1,"button-primary",3,"click"],[1,"icon-play"],["class","button-on-control",3,"click",4,"ngIf"],[1,"button-on-control",3,"click"],[1,"icon-reload"],[1,"icon-stop"],[1,"button-on-control"],[1,"icon-spin","icon-spinner"],[1,"current"],[3,"routerLink"],[1,"icon-folder"],["class","track",4,"ngFor","ngForOf","ngForTrackBy"],[1,"track"],[1,"meta"],[1,"track-health"],[3,"trackHealth","resolvedEvent"]],template:function(t,e){1&t&&(g.Vb(0,"div",0),g.Vb(1,"app-view-header-slim",1),g.Gc(2,bn,3,2,"ng-container",2),g.Ub(),g.Vb(3,"div",3),g.Gc(4,mn,1,0,"app-loading",2),g.Gc(5,Pn,2,1,"div",2),g.Ub(),g.Ub()),2&t&&(g.Cb(2),g.nc("ngIf",e.folders),g.Cb(2),g.nc("ngIf",!e.folders),g.Cb(1),g.nc("ngIf",e.folders))},directives:[hn.a,a.t,F.a,v.f,a.s,$e],styles:["[_nghost-%COMP%]{height:100%;width:100%;overflow-y:auto;overflow-x:auto;display:block}[_nghost-%COMP%]   .radar[_ngcontent-%COMP%]{display:flex;flex-direction:column}[_nghost-%COMP%]   .radar[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{padding:15px}[_nghost-%COMP%]   .radar[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]{min-width:130px;display:inline-block}[_nghost-%COMP%]   .radar[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{margin-right:5px}[_nghost-%COMP%]   .radar[_ngcontent-%COMP%]   .current[_ngcontent-%COMP%]{padding-top:15px;padding-bottom:15px;border-bottom:1px solid var(--background-border)}[_nghost-%COMP%]   .radar[_ngcontent-%COMP%]   .current[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{padding-right:15px}[_nghost-%COMP%]   .radar[_ngcontent-%COMP%]   .track[_ngcontent-%COMP%]{border-bottom:1px solid var(--background-border)}[_nghost-%COMP%]   .radar[_ngcontent-%COMP%]   .track[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]{padding-top:15px;padding-bottom:15px}[_nghost-%COMP%]   .radar[_ngcontent-%COMP%]   .track[_ngcontent-%COMP%]   .track-health[_ngcontent-%COMP%]{padding-left:15px}@media (max-width:768px){[_nghost-%COMP%]   .radar[_ngcontent-%COMP%]   .current[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block}[_nghost-%COMP%]   .radar[_ngcontent-%COMP%]   .track[_ngcontent-%COMP%]   .track-health[_ngcontent-%COMP%]{padding-left:0}}"]}),_n),xn=function(){return{standalone:!0}};function wn(t,e){if(1&t){var n=g.Wb();g.Vb(0,"form"),g.Vb(1,"div",1),g.Vb(2,"label",2),g.Ic(3,"Root name"),g.Ub(),g.Vb(4,"input",3),g.dc("ngModelChange",(function(t){return g.yc(n),g.gc().edit.name=t})),g.Ub(),g.Ub(),g.Vb(5,"div",1),g.Vb(6,"label",4),g.Ic(7,"Path"),g.Ub(),g.Vb(8,"input",5),g.dc("ngModelChange",(function(t){return g.yc(n),g.gc().edit.path=t})),g.Ub(),g.Ub(),g.Vb(9,"div",1),g.Vb(10,"label"),g.Ic(11,"Scan Strategy"),g.Ub(),g.Vb(12,"fieldset"),g.Vb(13,"label",6),g.Vb(14,"input",7),g.dc("ngModelChange",(function(t){return g.yc(n),g.gc().edit.strategy=t})),g.Ub(),g.Ic(15," Auto"),g.Ub(),g.Vb(16,"label",6),g.Vb(17,"input",7),g.dc("ngModelChange",(function(t){return g.yc(n),g.gc().edit.strategy=t})),g.Ub(),g.Ic(18," Artist/Album"),g.Ub(),g.Vb(19,"label",6),g.Vb(20,"input",7),g.dc("ngModelChange",(function(t){return g.yc(n),g.gc().edit.strategy=t})),g.Ub(),g.Ic(21," Compilations"),g.Ub(),g.Vb(22,"label",6),g.Vb(23,"input",7),g.dc("ngModelChange",(function(t){return g.yc(n),g.gc().edit.strategy=t})),g.Ub(),g.Ic(24," Audiobook"),g.Ub(),g.Ub(),g.Ub(),g.Ub()}if(2&t){var i=g.gc();g.Cb(4),g.nc("ngModel",i.edit.name)("ngModelOptions",g.rc(12,xn)),g.Cb(4),g.nc("ngModel",i.edit.path)("ngModelOptions",g.rc(13,xn)),g.Cb(6),g.nc("ngModel",i.edit.strategy)("value",i.RootScanStrategy.auto),g.Cb(3),g.nc("ngModel",i.edit.strategy)("value",i.RootScanStrategy.artistalbum),g.Cb(3),g.nc("ngModel",i.edit.strategy)("value",i.RootScanStrategy.compilation),g.Cb(3),g.nc("ngModel",i.edit.strategy)("value",i.RootScanStrategy.audiobook)}}var In,Un=((In=function(){function t(){_classCallCheck(this,t),this.RootScanStrategy=y.r}return _createClass(t,[{key:"dialogInit",value:function(t,e){this.edit=e.data}}]),t}()).\u0275fac=function(t){return new(t||In)},In.\u0275cmp=g.Jb({type:In,selectors:[["app-dialog-root"]],decls:1,vars:1,consts:[[4,"ngIf"],[1,"root-form-control"],["for","root-name"],["id","root-name","type","text",3,"ngModel","ngModelOptions","ngModelChange"],["for","root-path"],["id","root-path","type","text",3,"ngModel","ngModelOptions","ngModelChange"],[1,"select"],["type","radio","name","strategy",3,"ngModel","value","ngModelChange"]],template:function(t,e){1&t&&g.Gc(0,wn,25,14,"form",0),2&t&&g.nc("ngIf",e.edit)},directives:[a.t,c.w,c.j,c.k,c.c,c.i,c.l,c.q],styles:["[_nghost-%COMP%]   input[type=text][_ngcontent-%COMP%]{width:100%;line-height:1.3em;padding:5px;min-width:300px}[_nghost-%COMP%]   input[type=radio][_ngcontent-%COMP%]{margin-right:5px}[_nghost-%COMP%]   .root-form-control[_ngcontent-%COMP%]{margin-bottom:8px;display:block}[_nghost-%COMP%]   .select[_ngcontent-%COMP%]{margin-right:15px;display:block;font-size:.8em;line-height:1.5em}"]}),In),Sn=n("gjEl");function Vn(t,e){1&t&&(g.Vb(0,"span"),g.Ic(1,"Not scanned"),g.Ub())}function An(t,e){if(1&t&&(g.Vb(0,"span",19),g.Ic(1,"Error:"),g.Qb(2,"br"),g.Ic(3),g.Ub()),2&t){var n=g.gc().$implicit;g.Cb(3),g.Jc(n.status.error)}}function Rn(t,e){1&t&&(g.Tb(0),g.Ic(1,"Working\u2026"),g.Sb())}function zn(t,e){if(1&t&&(g.Tb(0),g.Ic(1,"Last Change:"),g.Qb(2,"br"),g.Ic(3),g.hc(4,"date"),g.Sb()),2&t){var n=g.gc(2).$implicit;g.Cb(3),g.Jc(g.jc(4,1,n.status.lastScan,"medium"))}}function Fn(t,e){if(1&t&&(g.Vb(0,"span"),g.Gc(1,Rn,2,0,"ng-container",11),g.Gc(2,zn,5,4,"ng-container",11),g.Ub()),2&t){var n=g.gc().$implicit;g.Cb(1),g.nc("ngIf",n.status.scanning),g.Cb(1),g.nc("ngIf",!n.status.scanning)}}function Dn(t,e){if(1&t){var n=g.Wb();g.Vb(0,"tr",10),g.dc("dblclick",(function(){g.yc(n);var t=e.$implicit;return g.gc(2).editRoot(t)})),g.Vb(1,"td",4),g.Ic(2),g.Ub(),g.Vb(3,"td",5),g.Ic(4),g.Ub(),g.Vb(5,"td",6),g.Ic(6),g.Ub(),g.Vb(7,"td",7),g.Gc(8,Vn,2,0,"span",11),g.Gc(9,An,4,1,"span",12),g.Gc(10,Fn,3,2,"span",11),g.Ub(),g.Vb(11,"td",8),g.Vb(12,"a",13),g.dc("click",(function(){g.yc(n);var t=e.$implicit;return g.gc(2).refreshRoot(t)})),g.Qb(13,"i",14),g.Ub(),g.Vb(14,"a",15),g.dc("click",(function(){g.yc(n);var t=e.$implicit;return g.gc(2).editRoot(t)})),g.Qb(15,"i",16),g.Ub(),g.Vb(16,"a",17),g.dc("click",(function(){g.yc(n);var t=e.$implicit;return g.gc(2).deleteRoot(t)})),g.Qb(17,"i",18),g.Ub(),g.Ub(),g.Ub()}if(2&t){var i=e.$implicit;g.Cb(2),g.Jc(i.name),g.Cb(2),g.Jc(i.path),g.Cb(2),g.Jc(i.strategy),g.Cb(2),g.nc("ngIf",!i.status),g.Cb(1),g.nc("ngIf",i.status&&i.status.error),g.Cb(1),g.nc("ngIf",i.status&&!i.status.error)}}function Qn(t,e){if(1&t&&(g.Vb(0,"table",2),g.Vb(1,"tr",3),g.Vb(2,"td",4),g.Ic(3,"Name"),g.Ub(),g.Vb(4,"td",5),g.Ic(5,"Path"),g.Ub(),g.Vb(6,"td",6),g.Ic(7,"Strategy"),g.Ub(),g.Vb(8,"td",7),g.Ic(9,"Status"),g.Ub(),g.Vb(10,"td",8),g.Ic(11,"Actions"),g.Ub(),g.Ub(),g.Gc(12,Dn,18,6,"tr",9),g.Ub()),2&t){var n=g.gc();g.Cb(12),g.nc("ngForOf",n.roots)}}var jn,Tn,En=((Tn=function(){function t(e,n,i,o,r,a,c){_classCallCheck(this,t),this.router=e,this.route=n,this.app=i,this.notify=o,this.dialogs=r,this.rootService=a,this.dialogOverlay=c,this.roots=[]}return _createClass(t,[{key:"refreshRoot",value:function(t,e){this.rootService.rescanRoot(t,e)}},{key:"editRoot",value:function(t){var e=this,n={root:t,name:t.name,path:t.path,strategy:t.strategy};this.dialogOverlay.open({title:"Edit Root",childComponent:Un,data:n,onOkBtn:function(){return Object(f.a)(e,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.rootService.applyDialogRoot(n);case 3:t.next=8;break;case 5:return t.prev=5,t.t0=t.catch(0),t.abrupt("return",(this.notify.error(t.t0),Promise.reject(t.t0)));case 8:case"end":return t.stop()}}),t,this,[[0,5]])})))},onCancelBtn:function(){return Object(f.a)(e,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Promise.resolve());case 1:case"end":return t.stop()}}),t)})))}})}},{key:"deleteRoot",value:function(t){var e=this;this.dialogs.confirm("Delete Root","Do you want to the delete the root folder?",(function(){e.rootService.removeRoot(t)}))}}]),t}()).\u0275fac=function(t){return new(t||Tn)(g.Pb(v.c),g.Pb(v.a),g.Pb(O.e),g.Pb(O.i),g.Pb(O.g),g.Pb(O.c),g.Pb(M.b))},Tn.\u0275cmp=g.Jb({type:Tn,selectors:[["app-admin-root-list"]],inputs:{roots:"roots"},decls:2,vars:2,consts:[["name","Roots",3,"list"],["class","roots",4,"ngIf"],[1,"roots"],[1,"root","heading"],[1,"title"],[1,"path"],[1,"strategy"],[1,"status"],[1,"actions"],["class","root",3,"dblclick",4,"ngFor","ngForOf"],[1,"root",3,"dblclick"],[4,"ngIf"],["class","error",4,"ngIf"],["title","Rescan Root","appClickStop","",3,"click"],[1,"icon-rescan"],["title","Edit Root","appClickStop","",3,"click"],[1,"icon-edit"],["title","Delete Root","appClickStop","",3,"click"],[1,"icon-remove"],[1,"error"]],template:function(t,e){1&t&&(g.Qb(0,"app-background-text-list",0),g.Gc(1,Qn,13,1,"table",1)),2&t&&(g.nc("list",e.roots),g.Cb(1),g.nc("ngIf",e.roots&&e.roots.length>0))},directives:[T.a,a.t,a.s,Sn.a],pipes:[a.f],styles:["[_nghost-%COMP%]{width:100%;overflow:auto;display:block}[_nghost-%COMP%]   .roots[_ngcontent-%COMP%]{padding:15px;width:100%}[_nghost-%COMP%]   .heading[_ngcontent-%COMP%], [_nghost-%COMP%]   .roots[_ngcontent-%COMP%]{font-size:.9em}[_nghost-%COMP%]   .root[_ngcontent-%COMP%]{border-bottom:1px solid var(--control-border)}[_nghost-%COMP%]   .root[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:5px 10px}[_nghost-%COMP%]   .root[_ngcontent-%COMP%]:hover{background-color:var(--background-hover)}[_nghost-%COMP%]   .root.selected[_ngcontent-%COMP%]{background-color:var(--background-active)}[_nghost-%COMP%]   .error[_ngcontent-%COMP%]{color:var(--accent)}[_nghost-%COMP%]   .actions[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{margin-right:5px}"]}),Tn),Gn=((jn=function(){function t(e,n,i,o,r,a,c){_classCallCheck(this,t),this.router=e,this.route=n,this.app=i,this.notify=o,this.dialogs=r,this.rootService=a,this.dialogOverlay=c,this.unsubscribe=new b.a}return _createClass(t,[{key:"ngOnInit",value:function(){var t=this;this.rootService.rootsChange.pipe(Object(m.a)(this.unsubscribe)).subscribe((function(e){t.roots=(e||[]).sort((function(t,e){return t.name.localeCompare(e.name)}))}),(function(e){t.notify.error(e)})),this.rootService.refreshRoots()}},{key:"ngOnDestroy",value:function(){this.unsubscribe.next(),this.unsubscribe.complete()}},{key:"refresh",value:function(){this.rootService.refreshRoots()}},{key:"newRoot",value:function(){var t=this,e={name:"",path:"",strategy:y.r.auto};this.dialogOverlay.open({title:"New Root",childComponent:Un,data:e,onOkBtn:function(){return Object(f.a)(t,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.rootService.applyDialogRoot(e);case 3:t.next=8;break;case 5:return t.prev=5,t.t0=t.catch(0),t.abrupt("return",(this.notify.error(t.t0),Promise.reject(t.t0)));case 8:case"end":return t.stop()}}),t,this,[[0,5]])})))},onCancelBtn:function(){return Object(f.a)(t,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Promise.resolve());case 1:case"end":return t.stop()}}),t)})))}})}},{key:"refreshRoots",value:function(t){this.rootService.rescanRoots(t)}}],[{key:"getSortValue",value:function(t,e){switch(t){case"name":return e.name;case"path":return e.path;default:return}}}]),t}()).\u0275fac=function(t){return new(t||jn)(g.Pb(v.c),g.Pb(v.a),g.Pb(O.e),g.Pb(O.i),g.Pb(O.g),g.Pb(O.c),g.Pb(M.b))},jn.\u0275cmp=g.Jb({type:jn,selectors:[["app-admin-root"]],decls:16,vars:1,consts:[[1,"roots"],["section","Roots"],["title","Refresh List",1,"button-on-control",3,"click"],[1,"icon-reload"],["title","Add new Root",1,"button-on-control",3,"click"],[1,"icon-list-add"],["title","Rescan Roots",1,"button-on-control",3,"click"],[1,"icon-rescan"],["title","Rescan Roots & all meta data (artists, albums, series)",1,"button-on-control",3,"click"],[1,"content"],[3,"roots"]],template:function(t,e){1&t&&(g.Vb(0,"div",0),g.Vb(1,"app-view-header-slim",1),g.Vb(2,"button",2),g.dc("click",(function(){return e.refresh()})),g.Qb(3,"i",3),g.Ic(4," Refresh"),g.Ub(),g.Vb(5,"button",4),g.dc("click",(function(){return e.newRoot()})),g.Qb(6,"i",5),g.Ic(7," Add"),g.Ub(),g.Vb(8,"button",6),g.dc("click",(function(){return e.refreshRoots()})),g.Qb(9,"i",7),g.Ic(10," Rescan"),g.Ub(),g.Vb(11,"button",8),g.dc("click",(function(){return e.refreshRoots(!0)})),g.Qb(12,"i",7),g.Ic(13," Rescan (with meta)"),g.Ub(),g.Ub(),g.Vb(14,"div",9),g.Qb(15,"app-admin-root-list",10),g.Ub(),g.Ub()),2&t&&(g.Cb(15),g.nc("roots",e.roots))},directives:[hn.a,En],styles:["[_nghost-%COMP%]{width:100%;overflow-x:auto;display:block}[_nghost-%COMP%], [_nghost-%COMP%]   .roots[_ngcontent-%COMP%]{height:100%;overflow-y:auto}[_nghost-%COMP%]   .roots[_ngcontent-%COMP%]{overflow-x:hidden}"]}),jn);function Bn(t,e){1&t&&g.Qb(0,"app-loading")}function Hn(t,e){if(1&t){var n=g.Wb();g.Tb(0),g.Vb(1,"div"),g.Vb(2,"div",6),g.Ic(3,"Server"),g.Ub(),g.Vb(4,"div",7),g.Vb(5,"label"),g.Vb(6,"input",8),g.dc("ngModelChange",(function(t){return g.yc(n),g.gc().settings.library.scanAtStart=t}))("ngModelChange",(function(){return g.yc(n),g.gc().onChange()})),g.Ub(),g.Ic(7," Scan all Roots on Server Start "),g.Ub(),g.Ub(),g.Ub(),g.Vb(8,"div"),g.Vb(9,"div",6),g.Ic(10,"External Services"),g.Ub(),g.Vb(11,"div",7),g.Vb(12,"label"),g.Vb(13,"input",9),g.dc("ngModelChange",(function(t){return g.yc(n),g.gc().settings.externalServices.enabled=t}))("ngModelChange",(function(){return g.yc(n),g.gc().onChange()})),g.Ub(),g.Ic(14," Allow Request to External Services "),g.Ub(),g.Ub(),g.Ub(),g.Vb(15,"div"),g.Vb(16,"div",6),g.Ic(17,"Chat"),g.Ub(),g.Vb(18,"div",7),g.Vb(19,"label",10),g.Ic(20,"Maximum Number of Messages"),g.Ub(),g.Vb(21,"input",11),g.dc("ngModelChange",(function(t){return g.yc(n),g.gc().settings.chat.maxMessages=t}))("ngModelChange",(function(){return g.yc(n),g.gc().onChange()})),g.Ub(),g.Ub(),g.Vb(22,"div",7),g.Vb(23,"div",12),g.Vb(24,"label",13),g.Ic(25,"Maximum Age of Message"),g.Ub(),g.Vb(26,"input",14),g.dc("ngModelChange",(function(t){return g.yc(n),g.gc().settings.chat.maxAge.value=t}))("ngModelChange",(function(){return g.yc(n),g.gc().onChange()})),g.Ub(),g.Ub(),g.Vb(27,"select",15),g.dc("ngModelChange",(function(t){return g.yc(n),g.gc().settings.chat.maxAge.unit=t}))("ngModelChange",(function(){return g.yc(n),g.gc().onChange()})),g.Vb(28,"option",16),g.Ic(29,"year"),g.Ub(),g.Vb(30,"option",16),g.Ic(31,"years"),g.Ub(),g.Vb(32,"option",16),g.Ic(33,"month"),g.Ub(),g.Vb(34,"option",16),g.Ic(35,"months"),g.Ub(),g.Vb(36,"option",16),g.Ic(37,"day"),g.Ub(),g.Vb(38,"option",16),g.Ic(39,"days"),g.Ub(),g.Vb(40,"option",16),g.Ic(41,"minute"),g.Ub(),g.Vb(42,"option",16),g.Ic(43,"minutes"),g.Ub(),g.Vb(44,"option",16),g.Ic(45,"second"),g.Ub(),g.Vb(46,"option",16),g.Ic(47,"seconds"),g.Ub(),g.Ub(),g.Ub(),g.Ub(),g.Vb(48,"div"),g.Vb(49,"div",6),g.Ic(50,"Artist Index"),g.Ub(),g.Vb(51,"div",7),g.Vb(52,"label",17),g.Ic(53,"Ignored Articles in Artist Names"),g.Ub(),g.Vb(54,"textarea",18),g.dc("ngModelChange",(function(t){return g.yc(n),g.gc().ignoreArticles=t}))("ngModelChange",(function(){return g.yc(n),g.gc().onChange()})),g.Ub(),g.Ub(),g.Ub(),g.Sb()}if(2&t){var i=g.gc();g.Cb(6),g.nc("ngModel",i.settings.library.scanAtStart),g.Cb(7),g.nc("ngModel",i.settings.externalServices.enabled),g.Cb(8),g.nc("ngModel",i.settings.chat.maxMessages),g.Cb(5),g.nc("ngModel",i.settings.chat.maxAge.value),g.Cb(1),g.nc("ngModel",i.settings.chat.maxAge.unit),g.Cb(1),g.nc("value","year"),g.Cb(2),g.nc("value","years"),g.Cb(2),g.nc("value","month"),g.Cb(2),g.nc("value","months"),g.Cb(2),g.nc("value","day"),g.Cb(2),g.nc("value","days"),g.Cb(2),g.nc("value","minute"),g.Cb(2),g.nc("value","minutes"),g.Cb(2),g.nc("value","second"),g.Cb(2),g.nc("value","seconds"),g.Cb(8),g.nc("ngModel",i.ignoreArticles)}}var Ln,Jn,Wn=((Jn=function(){function t(e,n,i){_classCallCheck(this,t),this.app=e,this.jam=n,this.notify=i}return _createClass(t,[{key:"ngOnInit",value:function(){this.refresh()}},{key:"onChange",value:function(){}},{key:"refresh",value:function(){var t=this;this.jam.admin.settings().then((function(e){t.display(e)})).catch((function(e){t.notify.error(e)}))}},{key:"save",value:function(){var t=this,e=this.settings;e.index.ignoreArticles=this.ignoreArticles.split("\n").map((function(t){return t.trim()})).filter((function(t){return t.length>0})),this.settings=void 0,this.jam.admin.settings_update(e).then((function(){t.notify.success("Settings updated"),t.settings=e})).catch((function(n){t.notify.error(n),t.settings=e}))}},{key:"display",value:function(t){this.settings=t,this.ignoreArticles=t.index.ignoreArticles.join("\n")}}]),t}()).\u0275fac=function(t){return new(t||Jn)(g.Pb(O.e),g.Pb(y.k),g.Pb(O.i))},Jn.\u0275cmp=g.Jb({type:Jn,selectors:[["app-admin-settings"]],decls:8,vars:2,consts:[[1,"settings"],["section","Admin Settings"],["title","Save",1,"button-on-control",3,"click"],[1,"icon-floppy"],[1,"content"],[4,"ngIf"],[1,"section-title"],[1,"section-entry"],["type","checkbox","title","Scan all Roots on Server Start",3,"ngModel","ngModelChange"],["type","checkbox","title","Allow Request to External Services",3,"ngModel","ngModelChange"],["for","max_messages"],["id","max_messages","type","number",3,"ngModel","ngModelChange"],[1,"chat-max-age"],["for","max_age"],["id","max_age","type","number",3,"ngModel","ngModelChange"],["placeholder","Unit of Age",3,"ngModel","ngModelChange"],[3,"value"],["for","ignore_articles"],["id","ignore_articles","rows","10","cols","20",3,"ngModel","ngModelChange"]],template:function(t,e){1&t&&(g.Vb(0,"div",0),g.Vb(1,"app-view-header-slim",1),g.Vb(2,"button",2),g.dc("click",(function(){return e.save()})),g.Qb(3,"i",3),g.Ic(4," Save Settings"),g.Ub(),g.Ub(),g.Vb(5,"div",4),g.Gc(6,Bn,1,0,"app-loading",5),g.Gc(7,Hn,55,16,"ng-container",5),g.Ub(),g.Ub()),2&t&&(g.Cb(6),g.nc("ngIf",!e.settings),g.Cb(1),g.nc("ngIf",e.settings))},directives:[hn.a,a.t,F.a,c.a,c.i,c.l,c.o,c.c,c.t,c.n,c.v],styles:["[_nghost-%COMP%]   .settings[_ngcontent-%COMP%]{overflow-y:auto;overflow-x:hidden;height:100%}[_nghost-%COMP%]   .settings[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{padding:15px 15px 0}[_nghost-%COMP%]   .settings[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .chat-max-age[_ngcontent-%COMP%]{display:inline-block}[_nghost-%COMP%]   .settings[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .section-entry[_ngcontent-%COMP%]{padding-bottom:15px}[_nghost-%COMP%]   .settings[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-size:12px;padding-bottom:3px}[_nghost-%COMP%]   .settings[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{margin-top:-1px;display:inline-block;vertical-align:middle}"]}),Jn),Nn=((Ln=function t(){_classCallCheck(this,t)}).\u0275fac=function(t){return new(t||Ln)},Ln.\u0275cmp=g.Jb({type:Ln,selectors:[["app-admin-start"]],decls:4,vars:0,consts:[[1,"start"],["section","Administration"],[1,"content"]],template:function(t,e){1&t&&(g.Vb(0,"div",0),g.Qb(1,"app-view-header-slim",1),g.Vb(2,"div",2),g.Qb(3,"app-admin-section-cards"),g.Ub(),g.Ub())},styles:["[_nghost-%COMP%]{width:100%;overflow-x:auto;display:block}[_nghost-%COMP%], [_nghost-%COMP%]   .start[_ngcontent-%COMP%]{height:100%;overflow-y:auto}[_nghost-%COMP%]   .start[_ngcontent-%COMP%]{overflow-x:hidden}"]}),Ln),$n=function(){return{standalone:!0}};function qn(t,e){if(1&t){var n=g.Wb();g.Vb(0,"div"),g.Vb(1,"form"),g.Vb(2,"div",1),g.Vb(3,"label"),g.Ic(4,"Name"),g.Ub(),g.Vb(5,"input",2),g.dc("ngModelChange",(function(t){return g.yc(n),g.gc().edit.edit.name=t})),g.Ub(),g.Ub(),g.Vb(6,"div",1),g.Vb(7,"label"),g.Ic(8,"Email"),g.Ub(),g.Vb(9,"input",3),g.dc("ngModelChange",(function(t){return g.yc(n),g.gc().edit.edit.email=t})),g.Ub(),g.Ub(),g.Vb(10,"div",4),g.Ic(11,"Roles"),g.Ub(),g.Vb(12,"div",5),g.Vb(13,"label"),g.Vb(14,"input",6),g.dc("ngModelChange",(function(t){return g.yc(n),g.gc().edit.edit.roleAdmin=t})),g.Ub(),g.Ic(15," Administrator "),g.Ub(),g.Qb(16,"br"),g.Vb(17,"label"),g.Vb(18,"input",7),g.dc("ngModelChange",(function(t){return g.yc(n),g.gc().edit.edit.rolePodcast=t})),g.Ub(),g.Ic(19," Manage Podcasts "),g.Ub(),g.Qb(20,"br"),g.Vb(21,"label"),g.Vb(22,"input",7),g.dc("ngModelChange",(function(t){return g.yc(n),g.gc().edit.edit.roleStream=t})),g.Ub(),g.Ic(23," Can Stream/Download "),g.Ub(),g.Qb(24,"br"),g.Vb(25,"label"),g.Vb(26,"input",8),g.dc("ngModelChange",(function(t){return g.yc(n),g.gc().edit.edit.roleUpload=t})),g.Ub(),g.Ic(27," Can Upload "),g.Ub(),g.Ub(),g.Qb(28,"hr"),g.Vb(29,"div",1),g.Qb(30,"input",9,10),g.Vb(32,"label",11),g.Ic(33,"Your Admin Password"),g.Ub(),g.Vb(34,"input",12),g.dc("ngModelChange",(function(t){return g.yc(n),g.gc().edit.edit.password=t})),g.Ub(),g.Ub(),g.Ub(),g.Ub()}if(2&t){var i=g.gc();g.Cb(5),g.nc("ngModel",i.edit.edit.name)("ngModelOptions",g.rc(14,$n)),g.Cb(4),g.nc("ngModel",i.edit.edit.email)("ngModelOptions",g.rc(15,$n)),g.Cb(5),g.nc("ngModel",i.edit.edit.roleAdmin)("ngModelOptions",g.rc(16,$n)),g.Cb(4),g.nc("ngModel",i.edit.edit.rolePodcast)("ngModelOptions",g.rc(17,$n)),g.Cb(4),g.nc("ngModel",i.edit.edit.roleStream)("ngModelOptions",g.rc(18,$n)),g.Cb(4),g.nc("ngModel",i.edit.edit.roleUpload)("ngModelOptions",g.rc(19,$n)),g.Cb(8),g.nc("ngModel",i.edit.edit.password)("ngModelOptions",g.rc(20,$n))}}var Kn,Yn,Xn=((Yn=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"dialogInit",value:function(t,e){this.edit=e.data}}]),t}()).\u0275fac=function(t){return new(t||Yn)},Yn.\u0275cmp=g.Jb({type:Yn,selectors:[["app-dialog-user"]],decls:1,vars:1,consts:[[4,"ngIf"],[1,"user-form-control"],["type","text","name","username",3,"ngModel","ngModelOptions","ngModelChange"],["type","email","name","mail",3,"ngModel","ngModelOptions","ngModelChange"],[1,"user-form-section"],[1,"user-form-roles"],["type","checkbox","title","Allow User to administrate",3,"ngModel","ngModelOptions","ngModelChange"],["type","checkbox","title","Allow User to manage podcasts",3,"ngModel","ngModelOptions","ngModelChange"],["type","checkbox","title","Allow User to upload files",3,"ngModel","ngModelOptions","ngModelChange"],["type","text","name","user","autocomplete","username",1,"dummy"],["name",""],[1,"label-pass"],["name","pass","type","password","autocomplete","password",3,"ngModel","ngModelOptions","ngModelChange"]],template:function(t,e){1&t&&g.Gc(0,qn,35,21,"div",0),2&t&&g.nc("ngIf",e.edit)},directives:[a.t,c.w,c.j,c.k,c.c,c.i,c.l,c.a],styles:["[_nghost-%COMP%] > div[_ngcontent-%COMP%]{margin-left:15px;margin-right:15px}[_nghost-%COMP%]   input[type=email][_ngcontent-%COMP%], [_nghost-%COMP%]   input[type=text][_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]   input[_ngcontent-%COMP%]{line-height:1.3em;padding:5px}[_nghost-%COMP%]   .label-pass[_ngcontent-%COMP%]{padding-right:15px;font-size:.8em}[_nghost-%COMP%]   .dummy[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .user-form-control[_ngcontent-%COMP%]{margin-bottom:8px;display:block}[_nghost-%COMP%]   .user-form-roles[_ngcontent-%COMP%]{margin-bottom:10px}[_nghost-%COMP%]   .user-form-roles[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{line-height:1.5em}"]}),Yn),Zn=((Kn=function(){function t(e,n){_classCallCheck(this,t),this.jam=e,this.notify=n,this.hasChanged=!1,this.unsubscribe=new b.a}return _createClass(t,[{key:"ngOnDestroy",value:function(){this.unsubscribe.next(),this.unsubscribe.complete()}},{key:"dialogInit",value:function(t,e){this.user=e.data,this.setImageSource()}},{key:"dialogResult",value:function(){return this.hasChanged}},{key:"setImageSource",value:function(){this.userAvatar=[this.jam.base.image_url(this.user.id,60),"?",this.randomRefreshString()].join("")}},{key:"randomRefreshString",value:function(){return Math.floor(9999999*Math.random()).toString()}},{key:"onDropFile",value:function(t){t.preventDefault(),this.uploadFile(t.dataTransfer.files)}},{key:"onDragOverFile",value:function(t){t.stopPropagation(),t.preventDefault()}},{key:"selectFile",value:function(t){this.uploadFile(t.target.files)}},{key:"uploadFile",value:function(t){var e=this;0!==t.length&&this.jam.user.imageUpload_update({id:this.user.id},t[0]).pipe(Object(m.a)(this.unsubscribe)).subscribe((function(t){t.type===gt.f.UploadProgress||t instanceof gt.j&&(e.setImageSource(),e.hasChanged=!0)}),(function(t){e.setImageSource(),e.notify.error(t)}),(function(){e.notify.success("Upload done")}))}}]),t}()).\u0275fac=function(t){return new(t||Kn)(g.Pb(y.k),g.Pb(O.i))},Kn.\u0275cmp=g.Jb({type:Kn,selectors:[["app-dialog-avatar"]],decls:6,vars:1,consts:[[1,"drop-zone",3,"drop","dragover"],[1,"root-form-control"],[3,"src"],["type","file","placeholder","Upload image","accept",".png,.jpeg,.jpg",3,"change"]],template:function(t,e){1&t&&(g.Vb(0,"div",0),g.dc("drop",(function(t){return e.onDropFile(t)}))("dragover",(function(t){return e.onDragOverFile(t)})),g.Vb(1,"form"),g.Vb(2,"div",1),g.Qb(3,"img",2),g.Ub(),g.Ub(),g.Vb(4,"form"),g.Vb(5,"input",3),g.dc("change",(function(t){return e.selectFile(t)})),g.Ub(),g.Ub(),g.Ub()),2&t&&(g.Cb(3),g.nc("src",e.userAvatar,g.Ac))},directives:[c.w,c.j,c.k],styles:["[_nghost-%COMP%]   .drop-zone[_ngcontent-%COMP%]{margin:10px 20px;border:2px dotted var(--secondary)}[_nghost-%COMP%]   input[type=text][_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]   .root-form-control[_ngcontent-%COMP%]{margin-bottom:8px;display:block;text-align:center}"]}),Kn),ti=function(){return{standalone:!0}};function ei(t,e){if(1&t){var n=g.Wb();g.Vb(0,"div",1),g.Vb(1,"form"),g.Qb(2,"input",2),g.Vb(3,"label"),g.Ic(4,"Your Admin Password"),g.Ub(),g.Vb(5,"input",3),g.dc("ngModelChange",(function(t){return g.yc(n),g.gc().data.password=t})),g.Ub(),g.Ub(),g.Vb(6,"form"),g.Qb(7,"input",4),g.Vb(8,"label"),g.Ic(9,"New Password for User "),g.Vb(10,"span"),g.Ic(11),g.Ub(),g.Ub(),g.Vb(12,"input",5),g.dc("ngModelChange",(function(t){return g.yc(n),g.gc().data.newPassword=t})),g.Ub(),g.Ub(),g.Ub()}if(2&t){var i=g.gc();g.Cb(5),g.nc("ngModel",i.data.password)("ngModelOptions",g.rc(5,ti)),g.Cb(6),g.Jc(i.data.user.name),g.Cb(1),g.nc("ngModel",i.data.newPassword)("ngModelOptions",g.rc(6,ti))}}var ni,ii=((ni=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"dialogInit",value:function(t,e){this.data=e.data}},{key:"dialogResult",value:function(){return!0}}]),t}()).\u0275fac=function(t){return new(t||ni)},ni.\u0275cmp=g.Jb({type:ni,selectors:[["app-dialog-user-pass"]],decls:1,vars:1,consts:[["class","user-form-control",4,"ngIf"],[1,"user-form-control"],["type","text","name","user","autocomplete","username",1,"dummy"],["name","pass","type","password","autocomplete","current-password",3,"ngModel","ngModelOptions","ngModelChange"],["type","text","name","new_name",1,"dummy"],["name","new_password","autocomplete","off","type","password","autocomplete","new-password",3,"ngModel","ngModelOptions","ngModelChange"]],template:function(t,e){1&t&&g.Gc(0,ei,13,7,"div",0),2&t&&g.nc("ngIf",e.data)},directives:[a.t,c.w,c.j,c.k,c.c,c.i,c.l],styles:["[_nghost-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:10px}[_nghost-%COMP%]   label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:700}[_nghost-%COMP%]   .dummy[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   input[_ngcontent-%COMP%]{line-height:1.3em;padding:5px;width:100%;margin-bottom:15px}"]}),ni),oi=n("24wo");function ri(t,e){1&t&&g.Qb(0,"i",20)}function ai(t,e){1&t&&g.Qb(0,"i",20)}function ci(t,e){1&t&&g.Qb(0,"i",20)}function si(t,e){1&t&&g.Qb(0,"i",20)}function li(t,e){if(1&t){var n=g.Wb();g.Vb(0,"tr",9),g.dc("dblclick",(function(){g.yc(n);var t=e.$implicit;return g.gc(2).editUser(t)})),g.Vb(1,"td",3),g.Qb(2,"app-coverart-image",10),g.Ub(),g.Vb(3,"td",4),g.Ic(4),g.Ub(),g.Vb(5,"td",5),g.Ic(6),g.Ub(),g.Vb(7,"td",6),g.Gc(8,ri,1,0,"i",11),g.Ub(),g.Vb(9,"td",6),g.Gc(10,ai,1,0,"i",11),g.Ub(),g.Vb(11,"td",6),g.Gc(12,ci,1,0,"i",11),g.Ub(),g.Vb(13,"td",6),g.Gc(14,si,1,0,"i",11),g.Ub(),g.Vb(15,"td",7),g.Vb(16,"a",12),g.dc("click",(function(){g.yc(n);var t=e.$implicit;return g.gc(2).editUserAvatar(t)})),g.Qb(17,"i",13),g.Ub(),g.Vb(18,"a",14),g.dc("click",(function(){g.yc(n);var t=e.$implicit;return g.gc(2).setUserPassword(t)})),g.Qb(19,"i",15),g.Ub(),g.Vb(20,"a",16),g.dc("click",(function(){g.yc(n);var t=e.$implicit;return g.gc(2).editUser(t)})),g.Qb(21,"i",17),g.Ub(),g.Vb(22,"a",18),g.dc("click",(function(){g.yc(n);var t=e.$implicit;return g.gc(2).deleteUser(t)})),g.Qb(23,"i",19),g.Ub(),g.Ub(),g.Ub()}if(2&t){var i=e.$implicit;g.Cb(2),g.nc("coverArtObj",i)("alt",i.name)("size",28)("round",!0),g.Cb(2),g.Jc(i.name),g.Cb(2),g.Jc(i.email),g.Cb(2),g.nc("ngIf",i.roles.admin),g.Cb(2),g.nc("ngIf",i.roles.podcast),g.Cb(2),g.nc("ngIf",i.roles.upload),g.Cb(2),g.nc("ngIf",i.roles.stream)}}function di(t,e){if(1&t&&(g.Vb(0,"table",1),g.Vb(1,"tr",2),g.Vb(2,"td",3),g.Ic(3,"Avatar"),g.Ub(),g.Vb(4,"td",4),g.Ic(5,"Name"),g.Ub(),g.Vb(6,"td",5),g.Ic(7,"Email"),g.Ub(),g.Vb(8,"td",6),g.Ic(9,"Administrator"),g.Ub(),g.Vb(10,"td",6),g.Ic(11,"Manage Podcasts"),g.Ub(),g.Vb(12,"td",6),g.Ic(13,"Can Upload"),g.Ub(),g.Vb(14,"td",6),g.Ic(15,"Can Stream"),g.Ub(),g.Vb(16,"td",7),g.Ic(17,"Actions"),g.Ub(),g.Ub(),g.Gc(18,li,24,10,"tr",8),g.Ub()),2&t){var n=g.gc();g.Cb(18),g.nc("ngForOf",n.users)}}var hi,ui,gi,pi=((ui=function(){function t(e,n,i,o,r,a,c){_classCallCheck(this,t),this.router=e,this.route=n,this.app=i,this.notify=o,this.dialogs=r,this.userService=a,this.dialogOverlay=c,this.users=[],this.unsubscribe=new b.a}return _createClass(t,[{key:"ngOnDestroy",value:function(){this.unsubscribe.next(),this.unsubscribe.complete()}},{key:"editUser",value:function(t){var e=this,n={user:t,edit:{password:"",id:t.id,name:t.name,email:t.email,roleAdmin:t.roles.admin,rolePodcast:t.roles.podcast,roleStream:t.roles.stream,roleUpload:t.roles.upload}};this.dialogOverlay.open({childComponent:Xn,title:"Edit User",data:n,onOkBtn:function(){return Object(f.a)(e,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.userService.applyDialogUser(n);case 3:this.notify.success("User edited"),t.next=9;break;case 6:return t.prev=6,t.t0=t.catch(0),t.abrupt("return",(this.notify.error(t.t0),Promise.reject(t.t0)));case 9:case"end":return t.stop()}}),t,this,[[0,6]])})))},onCancelBtn:function(){return Promise.resolve()}})}},{key:"editUserAvatar",value:function(t){var e=this;this.dialogOverlay.open({childComponent:Zn,title:"Edit User Avatar",data:t}).afterClosed().pipe(Object(m.a)(this.unsubscribe)).subscribe((function(){e.userService.refreshUser(t.id)}))}},{key:"setUserPassword",value:function(t){var e=this,n={user:t,password:"",newPassword:""};this.dialogOverlay.open({childComponent:ii,title:"Set User Password",data:n,onOkBtn:function(){return Object(f.a)(e,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.userService.setPassword(t.id,n.password,n.newPassword);case 3:this.notify.success("Password changed"),e.next=9;break;case 6:return e.prev=6,e.t0=e.catch(0),e.abrupt("return",(this.notify.error(e.t0),Promise.reject(e.t0)));case 9:case"end":return e.stop()}}),e,this,[[0,6]])})))},onCancelBtn:function(){return Promise.resolve()}})}},{key:"deleteUser",value:function(t){var e=this;this.dialogs.confirm("Delete User","Do you want to the delete the user?",(function(){e.userService.removeUser(t).then((function(){e.notify.success("User deleted")})).catch((function(t){e.notify.error(t)}))}))}}]),t}()).\u0275fac=function(t){return new(t||ui)(g.Pb(v.c),g.Pb(v.a),g.Pb(O.e),g.Pb(O.i),g.Pb(O.g),g.Pb(O.d),g.Pb(M.b))},ui.\u0275cmp=g.Jb({type:ui,selectors:[["app-admin-user-list"]],inputs:{users:"users"},decls:1,vars:1,consts:[["class","users",4,"ngIf"],[1,"users"],[1,"user","heading"],[1,"avatar"],[1,"title"],[1,"email"],[1,"role"],[1,"actions"],["class","user",3,"dblclick",4,"ngFor","ngForOf"],[1,"user",3,"dblclick"],[3,"coverArtObj","alt","size","round"],["class","icon-checkmark",4,"ngIf"],["title","Change Avatar",3,"click"],[1,"icon-picture"],["title","Set Password",3,"click"],[1,"icon-key"],["title","Edit User",3,"click"],[1,"icon-edit"],["title","Delete User",3,"click"],[1,"icon-remove"],[1,"icon-checkmark"]],template:function(t,e){1&t&&g.Gc(0,di,19,1,"table",0),2&t&&g.nc("ngIf",e.users&&e.users.length>0)},directives:[a.t,a.s,oi.a],styles:["[_nghost-%COMP%]{width:100%;overflow:auto;display:block}[_nghost-%COMP%]   .users[_ngcontent-%COMP%]{padding:15px;width:100%}[_nghost-%COMP%]   .heading[_ngcontent-%COMP%], [_nghost-%COMP%]   .users[_ngcontent-%COMP%]{font-size:.9em}[_nghost-%COMP%]   .user[_ngcontent-%COMP%]{border-bottom:1px solid var(--control-border)}[_nghost-%COMP%]   .user[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:5px 10px}[_nghost-%COMP%]   .user[_ngcontent-%COMP%]:hover{background-color:var(--background-hover)}[_nghost-%COMP%]   .user.selected[_ngcontent-%COMP%]{background-color:var(--background-active)}[_nghost-%COMP%]   .icon-checkmark[_ngcontent-%COMP%]{color:var(--primary)}[_nghost-%COMP%]   .actions[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{margin-right:5px}"]}),ui),fi=((hi=function(){function t(e,n,i,o,r,a){_classCallCheck(this,t),this.app=e,this.dialogs=n,this.jam=i,this.notify=o,this.userService=r,this.dialogOverlay=a,this.unsubscribe=new b.a}return _createClass(t,[{key:"getSortValue",value:function(t,e){switch(t){case"name":return e.name;case"email":return e.email;case"roleAdmin":return e.roles.admin?1:0;case"rolePodcast":return e.roles.podcast?1:0;case"roleUpload":return e.roles.upload?1:0;case"roleStream":return e.roles.stream?1:0;default:return}}},{key:"ngOnInit",value:function(){var t=this;this.userService.usersChange.pipe(Object(m.a)(this.unsubscribe)).subscribe((function(e){t.users=(e||[]).sort((function(t,e){return t.name.localeCompare(e.name)}))}),(function(e){t.notify.error(e)})),this.userService.refreshUsers()}},{key:"ngOnDestroy",value:function(){this.unsubscribe.next(),this.unsubscribe.complete()}},{key:"refresh",value:function(){this.userService.refreshUsers()}},{key:"newUser",value:function(){var t=this,e={edit:{password:"",id:"",name:"",email:"",roleAdmin:!1,rolePodcast:!1,roleStream:!0,roleUpload:!1}};this.dialogOverlay.open({title:"New User",childComponent:Xn,data:e,onOkBtn:function(){return Object(f.a)(t,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.userService.applyDialogUser(e);case 3:this.notify.success("User created"),t.next=9;break;case 6:return t.prev=6,t.t0=t.catch(0),t.abrupt("return",(this.notify.error(t.t0),Promise.reject(t.t0)));case 9:case"end":return t.stop()}}),t,this,[[0,6]])})))},onCancelBtn:function(){return Promise.resolve()}})}}]),t}()).\u0275fac=function(t){return new(t||hi)(g.Pb(O.e),g.Pb(O.g),g.Pb(y.k),g.Pb(O.i),g.Pb(O.d),g.Pb(M.b))},hi.\u0275cmp=g.Jb({type:hi,selectors:[["app-admin-users"]],decls:10,vars:1,consts:[[1,"users"],["section","Users"],["title","Add new User",1,"button-on-control",3,"click"],[1,"icon-list-add"],["title","Refresh List",1,"button-on-control",3,"click"],[1,"icon-reload"],[1,"content"],[3,"users"]],template:function(t,e){1&t&&(g.Vb(0,"div",0),g.Vb(1,"app-view-header-slim",1),g.Vb(2,"button",2),g.dc("click",(function(){return e.newUser()})),g.Qb(3,"i",3),g.Ic(4," Add"),g.Ub(),g.Vb(5,"button",4),g.dc("click",(function(){return e.refresh()})),g.Qb(6,"i",5),g.Ic(7," Refresh"),g.Ub(),g.Ub(),g.Vb(8,"div",6),g.Qb(9,"app-admin-user-list",7),g.Ub(),g.Ub()),2&t&&(g.Cb(9),g.nc("users",e.users))},directives:[hn.a,pi],styles:["[_nghost-%COMP%]{width:100%;overflow-x:auto;display:block}[_nghost-%COMP%], [_nghost-%COMP%]   .users[_ngcontent-%COMP%]{height:100%;overflow-y:auto}[_nghost-%COMP%]   .users[_ngcontent-%COMP%]{overflow-x:hidden}[_nghost-%COMP%]   .users[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{padding:0 15px 15px}[_nghost-%COMP%]   .users[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{text-transform:uppercase;letter-spacing:1.25px;font-size:13.2px;margin-bottom:10px;color:var(--on-control-ambient)}@media (max-width:522px){[_nghost-%COMP%]   .users[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{padding-left:10px;padding-right:10px}}"]}),hi),bi=[{path:"",component:p,children:[{path:"",pathMatch:"full",component:Nn,data:{name:"Admin"}},{path:"user",component:fi,data:{name:"Users",icon:"icon-user"}},{path:"root",component:Gn,data:{name:"Roots",icon:"icon-root"}},{path:"folder",redirectTo:"folder/"},{path:"folder/:id",component:ht,data:{id:"folder",name:"Folders",icon:"icon-folder",link:"folder"},children:[{path:"overview",component:je},{path:"health",component:pe},{path:"sub-folders",component:X},{path:"tracks",component:dn},{path:"tracks-health",component:Xe},{path:"tags",loadChildren:function(){return n.e(9).then(n.bind(null,"hAXf")).then((function(t){return t.TagEditorModule}))}}]},{path:"radar",component:kn,data:{name:"Health Radar",icon:"icon-health"}},{path:"settings",component:Wn,data:{name:"Admin Settings"}}]}],mi=v.g.forChild(bi),vi=((gi=function(){function t(e){_classCallCheck(this,t),this.route=e,this.unsubscribe=new b.a}return _createClass(t,[{key:"ngOnInit",value:function(){var t=this;this.route&&this.route.params.pipe(Object(m.a)(this.unsubscribe)).subscribe((function(e){t.resolve(e),t.refresh()}))}},{key:"idChanged",value:function(){}},{key:"refresh",value:function(){}},{key:"ngOnDestroy",value:function(){this.unsubscribe.next(),this.unsubscribe.complete()}},{key:"resolve",value:function(t){this.id=t.id,this.idChanged()}}]),t}()).\u0275fac=function(t){return new(t||gi)(g.Pb(v.a))},gi.\u0275cmp=g.Jb({type:gi,selectors:[["app-admin-base-view-id"]],decls:0,vars:0,template:function(t,e){},styles:[""]}),gi);function Ci(t,e){if(1&t&&(g.Tb(0),g.Ic(1),g.Sb()),2&t){var n=g.gc(2);g.Cb(1),g.Kc("(",n.folderService.current.count,")")}}function Mi(t,e){if(1&t&&(g.Vb(0,"div",7),g.Vb(1,"span",3),g.Ic(2,"Other requests in queue:"),g.Ub(),g.Ic(3),g.Ub()),2&t){var n=g.gc(2);g.Cb(3),g.Kc(" ",n.folderService.queue.length," ")}}function Oi(t,e){if(1&t&&(g.Vb(0,"div",1),g.Vb(1,"div",2),g.Vb(2,"span",3),g.Ic(3,"Current:"),g.Ub(),g.Qb(4,"i",4),g.Ic(5),g.Gc(6,Ci,2,1,"ng-container",5),g.Ub(),g.Gc(7,Mi,4,1,"div",6),g.Ub()),2&t){var n=g.gc();g.Cb(5),g.Kc(" ",n.folderService.current.title," "),g.Cb(1),g.nc("ngIf",n.folderService.current.count>1),g.Cb(1),g.nc("ngIf",n.folderService.queue.length>0)}}var yi,Pi=((yi=function t(e){_classCallCheck(this,t),this.folderService=e}).\u0275fac=function(t){return new(t||yi)(g.Pb(O.a))},yi.\u0275cmp=g.Jb({type:yi,selectors:[["app-admin-queue-requests"]],decls:1,vars:1,consts:[["class","queue-overlay",4,"ngIf"],[1,"queue-overlay"],[1,"current"],[1,"label"],[1,"icon-spin","icon-spinner"],[4,"ngIf"],["class","other",4,"ngIf"],[1,"other"]],template:function(t,e){1&t&&g.Gc(0,Oi,8,3,"div",0),2&t&&g.nc("ngIf",e.folderService.current)},directives:[a.t],styles:["[_nghost-%COMP%]   .queue-overlay[_ngcontent-%COMP%]{position:fixed;right:16px;bottom:16px;padding:15px;background-color:var(--control);color:var(--on-control);border:1px solid var(--control-border);z-index:1000}[_nghost-%COMP%]   .queue-overlay[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{text-transform:uppercase;font-size:.8em;letter-spacing:1px;color:var(--on-control-ambient)}[_nghost-%COMP%]   .queue-overlay[_ngcontent-%COMP%]   .other[_ngcontent-%COMP%]{border-top:1px solid var(--background-border)}"]}),yi),_i=function(t){return["/admin",t]};function ki(t,e){if(1&t&&(g.Vb(0,"a",6),g.Qb(1,"i"),g.Vb(2,"span"),g.Ic(3),g.Ub(),g.Ub()),2&t){var n=e.$implicit;g.nc("routerLink",g.sc(4,_i,n.id)),g.Cb(1),g.Eb(n.icon),g.Cb(2),g.Jc(n.text)}}function xi(t,e){if(1&t&&(g.Vb(0,"div",4),g.Gc(1,ki,4,6,"a",5),g.Ub()),2&t){var n=g.gc();g.Cb(1),g.nc("ngForOf",n.sections)("ngForTrackBy",n.trackByFn)}}var wi,Ii=((wi=function(){function t(e,n){_classCallCheck(this,t),this.app=e,this.router=n,this.collapsed={},this.sections=[],this.showMobileNavig=!1,this.sections=bi[0].children.filter((function(t){return t.path.length>0&&t.data&&t.data.name})).map((function(t){return{id:t.data&&t.data.link?t.data.link:t.path,text:t.data?t.data.name:"",icon:t.data&&t.data.icon?t.data.icon:"icon-admin"}}))}return _createClass(t,[{key:"ngOnInit",value:function(){var t=this;this.app.view.currentSidebar=this,this.router.events.forEach((function(){t.showMobileNavig=!1})).catch((function(t){console.error(t)}))}},{key:"ngOnDestroy",value:function(){this.app.view.currentSidebar=void 0}},{key:"trackByFn",value:function(t,e){return e.id}},{key:"toggleMobileNavig",value:function(){this.showMobileNavig=!this.showMobileNavig}}]),t}()).\u0275fac=function(t){return new(t||wi)(g.Pb(O.e),g.Pb(v.c))},wi.\u0275cmp=g.Jb({type:wi,selectors:[["app-admin-sidebar"]],decls:5,vars:5,consts:[[1,"navigation"],[1,"list"],[1,"header",3,"click"],["class","collapse",4,"ngIf"],[1,"collapse"],["class","item","routerLinkActive","active",3,"routerLink",4,"ngFor","ngForOf","ngForTrackBy"],["routerLinkActive","active",1,"item",3,"routerLink"]],template:function(t,e){1&t&&(g.Vb(0,"section",0),g.Vb(1,"div",1),g.Vb(2,"div",2),g.dc("click",(function(){return e.collapsed.main=!e.collapsed.main})),g.Ic(3,"Administration"),g.Ub(),g.Gc(4,xi,2,2,"div",3),g.Ub(),g.Ub()),2&t&&(g.Gb("show",e.showMobileNavig),g.Cb(1),g.Gb("active",e.collapsed.main),g.Cb(3),g.nc("ngIf",!e.collapsed.main))},directives:[a.t,a.s,v.f,v.e],styles:['@charset "UTF-8";[_nghost-%COMP%]{position:relative;flex:0 1 100%;display:flex;flex-direction:column;height:100%}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]{padding:15px;flex-grow:1;width:100%;overflow-y:auto;overflow-x:hidden;background-color:var(--control);color:var(--on-control)}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]{display:flex;flex-flow:column wrap;margin-bottom:15px}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{color:var(--on-control-ambient);font-size:11px;text-transform:uppercase;letter-spacing:1px;margin-bottom:5px;cursor:pointer;border-right:3px solid transparent}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]:hover{color:var(--on-control-ambient-hover);border-right-color:var(--primary)}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]:after{font-family:jam;content:"\ue804";padding-left:4px}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{color:var(--on-control);padding:5px 0;display:flex;flex-flow:row nowrap;align-items:center;border-right:3px solid transparent;transition:all .1s ease-in-out;transform-origin:left center}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   app-coverart-image[_ngcontent-%COMP%]{margin-right:6px}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{width:25px;display:block}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]:hover{color:var(--on-control-hover);border-right-color:var(--primary)}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .item.active[_ngcontent-%COMP%]{transform:scale(1.1)}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]{margin-top:8px;padding-left:4px}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{color:var(--on-control);font-size:14px;font-weight:700}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .active[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]:after{content:"\ue807"}@media (max-width:768px){[_nghost-%COMP%]{height:auto}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]{display:none;position:fixed;z-index:10;max-height:calc(100% - 60px);overflow-y:auto;flex-flow:row wrap;border-bottom:1px solid var(--control-box-border)}[_nghost-%COMP%]   .navigation.show[_ngcontent-%COMP%]{display:flex}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .index-list[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]{flex:1}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{border-right-width:0}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]:after{content:""}}']}),wi),Ui=n("8sYl"),Si=function(t){return["/admin",t]};function Vi(t,e){if(1&t&&(g.Vb(0,"div",1),g.Vb(1,"div",2),g.Qb(2,"app-iconart-image",3),g.Ub(),g.Vb(3,"div",4),g.Vb(4,"a",5),g.Ic(5),g.Ub(),g.Ub(),g.Ub()),2&t){var n=e.$implicit;g.nc("routerLink",g.sc(3,Si,n.id)),g.Cb(2),g.nc("icon",n.icon),g.Cb(3),g.Jc(n.text)}}var Ai,Ri,zi=((Ai=function(){function t(){_classCallCheck(this,t),this.sections=[],this.sections=bi[0].children.filter((function(t){return t.path.length>0&&t.data&&t.data.name})).map((function(t){return{id:t.data&&t.data.link?t.data.link:t.path,text:t.data?t.data.name:"",icon:t.data&&t.data.icon?t.data.icon:"icon-admin"}}))}return _createClass(t,[{key:"trackByFn",value:function(t,e){return e.id}}]),t}()).\u0275fac=function(t){return new(t||Ai)},Ai.\u0275cmp=g.Jb({type:Ai,selectors:[["app-admin-section-cards"]],decls:1,vars:2,consts:[["class","section-card no-hover",3,"routerLink",4,"ngFor","ngForOf","ngForTrackBy"],[1,"section-card","no-hover",3,"routerLink"],[1,"image"],[3,"icon"],[1,"footer"],[1,"footer-content"]],template:function(t,e){1&t&&g.Gc(0,Vi,6,5,"div",0),2&t&&g.nc("ngForOf",e.sections)("ngForTrackBy",e.trackByFn)},directives:[a.s,v.d,Ui.a],styles:['[_nghost-%COMP%]{display:flex;flex-flow:row wrap}@media (max-width:768px){[_nghost-%COMP%]{justify-content:space-around}}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]{margin:15px;width:calc(25% - 30px);position:relative;overflow:hidden;display:flex;cursor:pointer}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]:before{content:"";display:block;margin-top:100%}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%], [_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .fav[_ngcontent-%COMP%]{position:absolute;top:1px;padding:5px;transform:translateY(-31px);transition:transform .3s}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .fav[_ngcontent-%COMP%]{right:1px;border-bottom-left-radius:3px;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]{left:1px;font-size:.8em;border-bottom-right-radius:3px}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]{padding:5px;position:absolute;bottom:1px;left:1px;right:1px;overflow:hidden;height:auto}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]   .footer-buttons[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]:hover   .date[_ngcontent-%COMP%], [_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]:hover   .fav[_ngcontent-%COMP%]{transform:translateY(0)}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]:hover   .footer[_ngcontent-%COMP%]   .footer-buttons[_ngcontent-%COMP%]{display:block}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%], [_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .fav[_ngcontent-%COMP%], [_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]{background-color:var(--background-transparent);color:var(--on-background-active)}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], [_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .fav[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], [_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--on-background-active)}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, [_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .fav[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, [_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:var(--on-background)}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .footer-subline[_ngcontent-%COMP%]{display:block;font-size:.8em}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .footer-buttons[_ngcontent-%COMP%]{height:40px;padding-top:10px;white-space:nowrap}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .footer-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-bottom:5px;margin-right:5px}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .footer-buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{float:right;margin-right:5px}@media (max-width:1600px){[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]{width:calc(25% - 30px)}}@media (max-width:1200px){[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]{width:calc(33.33333% - 30px)}}@media (max-width:522px){[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]{width:calc(50% - 30px)}}@media (max-width:400px){[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]{margin:10px}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]{font-size:.8em}}[_nghost-%COMP%]   .section-card[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{min-height:135px;min-width:135px;display:flex;align-items:center;justify-content:center}']}),Ai),Fi=n("E9Yb"),Di=n("XFci"),Qi=n("QhIf"),ji=n("khyI"),Ti=n("jtIS"),Ei=n("sbl8"),Gi=n("WDtg"),Bi=n("1U9M"),Hi=n("AHRB"),Li=n("Ir1b"),Ji=n("Nejy"),Wi=n("PRhZ"),Ni=n("6plP"),$i=n("4HtZ"),qi=n("/w5H"),Ki=n("xlge"),Yi=n("rRf+"),Xi=n("ApzM"),Zi=n("jwGM"),to=n("rxhz"),eo=n("wAuK"),no=n("lLkq"),io=n("LcLR"),oo=n("sgvu"),ro=n("2pzp"),ao=n("JBM9"),co=n("UAU/"),so=n("R0FO"),lo=n("8cVO"),ho=n("vi5Q"),uo=n("cH1L"),go=n("7xKE"),po=n("gc66"),fo=n("ld3O"),bo=n("Zxx5"),mo=n("JhIW"),vo=n("8ApH"),Co=n("1VP0"),Mo=n("ivK/"),Oo=n("nF5c"),yo=n("Ofbq"),Po=((Ri=function t(){_classCallCheck(this,t)}).\u0275mod=g.Nb({type:Ri}),Ri.\u0275inj=g.Mb({factory:function(t){return new(t||Ri)},providers:[],imports:[[a.c,h.a,c.e,s.e,u.b,d.a,r.f,l.a,mi]]}),Ri);g.Bc(p,[a.q,a.r,a.s,a.t,a.A,a.w,a.x,a.y,a.z,a.u,a.v,Fi.a,Di.a,Qi.a,ji.a,Ti.a,Ei.a,Gi.a,Bi.a,T.a,oi.a,Hi.a,Li.a,Ji.a,Wi.a,Ni.a,$i.a,hn.a,qi.a,Ki.a,Ui.a,Yi.a,Ce.a,F.a,Xi.a,Zi.a,to.a,eo.a,no.a,io.a,oo.a,tt.a,ro.a,ao.a,co.a,so.a,Sn.a,lo.a,ho.a,c.w,c.n,c.v,c.c,c.o,c.r,c.a,c.t,c.u,c.q,c.i,c.j,c.s,c.g,c.f,c.p,c.b,c.d,c.l,c.m,c.k,u.a,j.a,D.a,Q.a,uo.b,r.a,r.b,r.c,r.d,go.a,po.a,fo.a,bo.a,mo.a,v.h,v.d,v.f,v.e,v.i,p,Wt,Zn,S,ve,z,Un,Xn,ii,yt,vi,C,Pi,Ii,Ct,At,Jt,ne,J,En,U,wt,zi,$e,pi,on,ht,pe,je,dn,X,kn,Gn,Wn,Nn,Xe,fi],[a.b,a.G,a.p,a.k,a.E,a.g,a.C,a.F,a.d,a.f,a.i,a.j,a.l,vo.a,P.a,Ze.a,It.a,Co.a,Mo.a,Oo.a,yo.a]),g.Bc(Nn,[a.q,a.r,a.s,a.t,a.A,a.w,a.x,a.y,a.z,a.u,a.v,Fi.a,Di.a,Qi.a,ji.a,Ti.a,Ei.a,Gi.a,Bi.a,T.a,oi.a,Hi.a,Li.a,Ji.a,Wi.a,Ni.a,$i.a,hn.a,qi.a,Ki.a,Ui.a,Yi.a,Ce.a,F.a,Xi.a,Zi.a,to.a,eo.a,no.a,io.a,oo.a,tt.a,ro.a,ao.a,co.a,so.a,Sn.a,lo.a,ho.a,c.w,c.n,c.v,c.c,c.o,c.r,c.a,c.t,c.u,c.q,c.i,c.j,c.s,c.g,c.f,c.p,c.b,c.d,c.l,c.m,c.k,u.a,j.a,D.a,Q.a,uo.b,r.a,r.b,r.c,r.d,go.a,po.a,fo.a,bo.a,mo.a,v.h,v.d,v.f,v.e,v.i,p,Wt,Zn,S,ve,z,Un,Xn,ii,yt,vi,C,Pi,Ii,Ct,At,Jt,ne,J,En,U,wt,zi,$e,pi,on,ht,pe,je,dn,X,kn,Gn,Wn,Nn,Xe,fi],[a.b,a.G,a.p,a.k,a.E,a.g,a.C,a.F,a.d,a.f,a.i,a.j,a.l,vo.a,P.a,Ze.a,It.a,Co.a,Mo.a,Oo.a,yo.a])},P7EQ:function(t,e,n){"use strict";function i(t){for(var e="",n=new Uint8Array(t),i=n.byteLength,o=0;o<i;o++)e+=String.fromCharCode(n[o]);return window.btoa(e)}n.d(e,"a",(function(){return i}))},pCJo:function(t,e,n){"use strict";function i(t,e){if(void 0===t&&void 0===e)throw new Error("Trying to compare two undefined values");if(void 0===t||void 0===e)return 0;var n=String(t),i=String(e),o=function(t,e){for(var n,i=[],o=0,r=0;r<=e.length;r++)for(var a=0;a<=t.length;a++)n=r&&a?t.charAt(a-1)===e.charAt(r-1)?o:Math.min(i[a],i[a-1],o)+1:r+a,o=i[a],i[a]=n;return i.pop()}(n,i);return n.length>i.length?1-o/n.length:1-o/i.length}function o(t,e){var n={};return function(t,e){for(var n=e||2,i="-".concat(t.toLowerCase().replace(/[^\w, ]+/,""),"-"),o=[],r=0;r<i.length-n+1;r+=1)o.push(i.slice(r,r+n));return o}(t,e||2).forEach((function(t){t in n?n[t]+=1:n[t]=1})),n}function r(t){if("string"!=typeof t)throw new Error("Must use a string as argument to FuzzySet functions");return t.toLowerCase()}n.d(e,"f",(function(){return c})),n.d(e,"g",(function(){return s})),n.d(e,"a",(function(){return l})),n.d(e,"d",(function(){return d})),n.d(e,"e",(function(){return h})),n.d(e,"b",(function(){return u})),n.d(e,"c",(function(){return g}));var a=function(){function t(e,n,i,o){var r=this;_classCallCheck(this,t),this.exactSet={},this.matchDict={},this.items={},this.arr=e||[],this.useLevenshtein=n||!0,this.gramSizeLower=i||2,this.gramSizeUpper=o||3;for(var a=this.gramSizeLower;a<this.gramSizeUpper+1;a+=1)this.items[a]=[];this.arr.forEach((function(t){r.add(t)}))}return _createClass(t,[{key:"get",value:function(t,e){var n=this._get(t);return!n&&e?e:n}},{key:"add",value:function(t){if(!(r(t)in this.exactSet))for(var e=this.gramSizeLower;e<this.gramSizeUpper+1;e+=1)this._add(t,e)}},{key:"length",value:function(){var t=0;for(var e in this.exactSet)Object.prototype.hasOwnProperty.call(this.exactSet,e)&&(t+=1);return t}},{key:"isEmpty",value:function(){for(var t in this.exactSet)if(Object.prototype.hasOwnProperty.call(this.exactSet,t))return!1;return!0}},{key:"values",value:function(){var t=[];for(var e in this.exactSet)Object.prototype.hasOwnProperty.call(this.exactSet,e)&&t.push(this.exactSet[e]);return t}},{key:"_get",value:function(t){var e=r(t),n=this.exactSet[e];if(n)return[[1,n]];for(var i=[],o=this.gramSizeUpper;o>=this.gramSizeLower;o-=1)if(i=this.__get(t,o))return i}},{key:"__get",value:function(t,e){var n,a=r(t),c={},s=o(a,e),l=this.items[e],d=0;for(var h in s)if(Object.prototype.hasOwnProperty.call(s,h)){var u=s[h];if(d+=Math.pow(u,2),h in this.matchDict){var g,p=_createForOfIteratorHelper(this.matchDict[h]);try{for(p.s();!(g=p.n()).done;){var f=g.value,b=f[0];n=f[1],b in c?c[b]+=u*n:c[b]=u*n}}catch(I){p.e(I)}finally{p.f()}}}if(!function(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}(c)){var m,v=Math.sqrt(d),C=[];Object.keys(c).forEach((function(t){m=c[t];var e=parseInt(t,10);C.push([m/(v*l[e][0]),l[e][1]])}));var M=function(t,e){return t[0]<e[0]?1:t[0]>e[0]?-1:0};if(C.sort(M),this.useLevenshtein){for(var O=[],y=Math.min(50,C.length),P=0;P<y;P+=1)O.push([i(C[P][1],a),C[P][1]]);(C=O).sort(M)}for(var _=[],k=0,x=C;k<x.length;k++){var w=x[k];w[0]===C[0][0]&&_.push([w[0],this.exactSet[w[1]]])}return _}}},{key:"_add",value:function(t,e){var n=r(t),i=this.items[e]||[],a=i.length;i.push(0);var c=o(n,e),s=0;for(var l in c)if(Object.prototype.hasOwnProperty.call(c,l)){var d=c[l];s+=Math.pow(d,2),l in this.matchDict?this.matchDict[l].push([a,d]):this.matchDict[l]=[[a,d]]}var h=Math.sqrt(s);i[a]=[h,n],this.items[e]=i,this.exactSet[n]=t}}]),t}();function c(t){return t.split(/[.,\\/ -]/).map((function(t){return t.trim()})).filter((function(t){return t.length>0}))}function s(t){return t.replace(/\.[^/.]+$/,"")}function l(t){return t.substring(t.lastIndexOf(".")+1,t.length)||t}function d(t,e){return e.includes(l(t))}function h(t,e){return t.toString().replace(/:/g," - ").replace(/[?/!\\]/g,e)}function u(t){if(!t)return 0;var e=s(t).split(/[ \-_.:;?!~,`"&|()<>{}[\]\r\n/\\]+/).map(Number).filter((function(t){return!isNaN(t)}));return e.length>0?e[0]:0}function g(t,e){var n=new a;n.add(t);var i=n.get(e);return i?i[0][0]:0}},rIor:function(t,e,n){"use strict";n.d(e,"a",(function(){return u})),n.d(e,"b",(function(){return g})),n.d(e,"c",(function(){return p}));var i=n("fXoL"),o=n("ofXK"),r=n("jhN1"),a=["wrapper"],c=["sourceImage"];function s(t,e){if(1&t){var n=i.Wb();i.Vb(0,"img",5,6),i.dc("load",(function(){return i.yc(n),i.gc().imageLoadedInView()})),i.Ub()}if(2&t){var o=i.gc();i.Fc("visibility",o.imageVisible?"visible":"hidden")("transform",o.safeTransformStyle),i.nc("src",o.safeImgDataUrl,i.Ac)}}function l(t,e){if(1&t){var n=i.Wb();i.Tb(0),i.Vb(1,"span",10),i.dc("mousedown",(function(t){i.yc(n);var e=i.gc(2);return e.startMove(t,e.moveTypes.Resize,"topleft")}))("touchstart",(function(t){i.yc(n);var e=i.gc(2);return e.startMove(t,e.moveTypes.Resize,"topleft")})),i.Qb(2,"span",11),i.Ub(),i.Vb(3,"span",12),i.Qb(4,"span",11),i.Ub(),i.Vb(5,"span",13),i.dc("mousedown",(function(t){i.yc(n);var e=i.gc(2);return e.startMove(t,e.moveTypes.Resize,"topright")}))("touchstart",(function(t){i.yc(n);var e=i.gc(2);return e.startMove(t,e.moveTypes.Resize,"topright")})),i.Qb(6,"span",11),i.Ub(),i.Vb(7,"span",14),i.Qb(8,"span",11),i.Ub(),i.Vb(9,"span",15),i.dc("mousedown",(function(t){i.yc(n);var e=i.gc(2);return e.startMove(t,e.moveTypes.Resize,"bottomright")}))("touchstart",(function(t){i.yc(n);var e=i.gc(2);return e.startMove(t,e.moveTypes.Resize,"bottomright")})),i.Qb(10,"span",11),i.Ub(),i.Vb(11,"span",16),i.Qb(12,"span",11),i.Ub(),i.Vb(13,"span",17),i.dc("mousedown",(function(t){i.yc(n);var e=i.gc(2);return e.startMove(t,e.moveTypes.Resize,"bottomleft")}))("touchstart",(function(t){i.yc(n);var e=i.gc(2);return e.startMove(t,e.moveTypes.Resize,"bottomleft")})),i.Qb(14,"span",11),i.Ub(),i.Vb(15,"span",18),i.Qb(16,"span",11),i.Ub(),i.Vb(17,"span",19),i.dc("mousedown",(function(t){i.yc(n);var e=i.gc(2);return e.startMove(t,e.moveTypes.Resize,"top")}))("touchstart",(function(t){i.yc(n);var e=i.gc(2);return e.startMove(t,e.moveTypes.Resize,"top")})),i.Ub(),i.Vb(18,"span",20),i.dc("mousedown",(function(t){i.yc(n);var e=i.gc(2);return e.startMove(t,e.moveTypes.Resize,"right")}))("touchstart",(function(t){i.yc(n);var e=i.gc(2);return e.startMove(t,e.moveTypes.Resize,"right")})),i.Ub(),i.Vb(19,"span",21),i.dc("mousedown",(function(t){i.yc(n);var e=i.gc(2);return e.startMove(t,e.moveTypes.Resize,"bottom")}))("touchstart",(function(t){i.yc(n);var e=i.gc(2);return e.startMove(t,e.moveTypes.Resize,"bottom")})),i.Ub(),i.Vb(20,"span",22),i.dc("mousedown",(function(t){i.yc(n);var e=i.gc(2);return e.startMove(t,e.moveTypes.Resize,"left")}))("touchstart",(function(t){i.yc(n);var e=i.gc(2);return e.startMove(t,e.moveTypes.Resize,"left")})),i.Ub(),i.Sb()}}function d(t,e){if(1&t){var n=i.Wb();i.Vb(0,"div",7),i.dc("keydown",(function(t){return i.yc(n),i.gc().keyboardAccess(t)})),i.Vb(1,"div",8),i.dc("mousedown",(function(t){i.yc(n);var e=i.gc();return e.startMove(t,e.moveTypes.Move)}))("touchstart",(function(t){i.yc(n);var e=i.gc();return e.startMove(t,e.moveTypes.Move)})),i.Ub(),i.Gc(2,l,21,0,"ng-container",9),i.Ub()}if(2&t){var o=i.gc();i.Fc("top",o.cropper.y1,"px")("left",o.cropper.x1,"px")("width",o.cropper.x2-o.cropper.x1,"px")("height",o.cropper.y2-o.cropper.y1,"px")("margin-left","center"===o.alignImage?o.marginLeft:null)("visibility",o.imageVisible?"visible":"hidden"),i.Gb("rounded",o.roundCropper),i.Cb(2),i.nc("ngIf",!o.hideResizeSquares)}}var h={Move:"move",Resize:"resize",Pinch:"pinch"},u=function(){var t=function(){function t(e,n){_classCallCheck(this,t),this.sanitizer=e,this.cd=n,this.Hammer="undefined"!=typeof window?window.Hammer:null,this.setImageMaxSizeRetries=0,this.cropperScaledMinWidth=20,this.cropperScaledMinHeight=20,this.exifTransform={rotate:0,flip:!1},this.autoRotateSupported=new Promise((function(t){var e=new Image;e.onload=function(){t(1===e.width&&2===e.height)},e.src="data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAEAAgMBEQACEQEDEQH/xABKAAEAAAAAAAAAAAAAAAAAAAALEAEAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAAAAAAAAAAAAAAAEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwA/8H//2Q=="})),this.stepSize=3,this.marginLeft="0px",this.imageVisible=!1,this.moveTypes=h,this.format="png",this.maintainAspectRatio=!0,this.transform={},this.aspectRatio=1,this.resizeToWidth=0,this.resizeToHeight=0,this.cropperMinWidth=0,this.cropperMinHeight=0,this.canvasRotation=0,this.initialStepSize=3,this.roundCropper=!1,this.onlyScaleDown=!1,this.imageQuality=92,this.autoCrop=!0,this.containWithinAspectRatio=!1,this.hideResizeSquares=!1,this.cropper={x1:-100,y1:-100,x2:1e4,y2:1e4},this.alignImage="center",this.disabled=!1,this.imageCropped=new i.n,this.startCropImage=new i.n,this.imageLoaded=new i.n,this.cropperReady=new i.n,this.loadImageFailed=new i.n,this.initCropper()}return _createClass(t,[{key:"ngOnChanges",value:function(t){this.onChangesInputImage(t),this.originalImage&&this.originalImage.complete&&this.exifTransform&&(t.containWithinAspectRatio||t.canvasRotation)&&this.transformOriginalImage(),t.cropper&&(this.setMaxSize(),this.setCropperScaledMinSize(),this.checkCropperPosition(!1),this.doAutoCrop(),this.cd.markForCheck()),t.aspectRatio&&this.imageVisible&&this.resetCropperPosition(),t.transform&&(this.transform=this.transform||{},this.setCssTransform(),this.doAutoCrop())}},{key:"onChangesInputImage",value:function(t){(t.imageChangedEvent||t.imageURL||t.imageBase64||t.imageFile)&&this.initCropper(),t.imageChangedEvent&&this.isValidImageChangedEvent()&&this.loadImageFile(this.imageChangedEvent.target.files[0]),t.imageURL&&this.imageURL&&this.loadImageFromURL(this.imageURL),t.imageBase64&&this.imageBase64&&this.loadBase64Image(this.imageBase64),t.imageFile&&this.imageFile&&this.loadImageFile(this.imageFile)}},{key:"isValidImageChangedEvent",value:function(){return this.imageChangedEvent&&this.imageChangedEvent.target&&this.imageChangedEvent.target.files&&this.imageChangedEvent.target.files.length>0}},{key:"setCssTransform",value:function(){this.safeTransformStyle=this.sanitizer.bypassSecurityTrustStyle("scaleX("+(this.transform.scale||1)*(this.transform.flipH?-1:1)+")scaleY("+(this.transform.scale||1)*(this.transform.flipV?-1:1)+")rotate("+(this.transform.rotate||0)+"deg)")}},{key:"ngOnInit",value:function(){this.stepSize=this.initialStepSize,this.activatePinchGesture()}},{key:"initCropper",value:function(){this.imageVisible=!1,this.transformedImage=null,this.safeImgDataUrl="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=",this.moveStart={active:!1,type:null,position:null,x1:0,y1:0,x2:0,y2:0,clientX:0,clientY:0},this.maxSize={width:0,height:0},this.originalSize={width:0,height:0},this.transformedSize={width:0,height:0},this.cropper.x1=-100,this.cropper.y1=-100,this.cropper.x2=1e4,this.cropper.y2=1e4}},{key:"loadImage",value:function(t,e){this.isValidImageType(e)?this.loadBase64Image(t):this.loadImageFailed.emit()}},{key:"loadImageFile",value:function(t){var e=this,n=new FileReader;n.onload=function(n){return e.loadImage(n.target.result,t.type)},n.readAsDataURL(t)}},{key:"isValidImageType",value:function(t){return/image\/(png|jpg|jpeg|bmp|gif|tiff|webp)/.test(t)}},{key:"loadBase64Image",value:function(t){var e=this;this.autoRotateSupported.then((function(n){return e.checkExifAndLoadBase64Image(t,n)})).then((function(){return e.transformOriginalImage()})).catch((function(t){e.loadImageFailed.emit(),e.originalImage=null,e.originalBase64=null,console.error(t)}))}},{key:"checkExifAndLoadBase64Image",value:function(t,e){var n=this;return new Promise((function(i,o){n.originalImage=new Image,n.originalImage.onload=function(){n.originalBase64=t,n.exifTransform=function(t){switch("string"==typeof t&&(t=function(t){var e=new DataView(function(t){t=t.replace(/^data\:([^\;]+)\;base64,/gim,"");for(var e=atob(t),n=e.length,i=new Uint8Array(n),o=0;o<n;o++)i[o]=e.charCodeAt(o);return i.buffer}(t));if(65496!=e.getUint16(0,!1))return-2;for(var n=e.byteLength,i=2;i<n;){if(e.getUint16(i+2,!1)<=8)return-1;var o=e.getUint16(i,!1);if(i+=2,65505==o){if(1165519206!=e.getUint32(i+=2,!1))return-1;var r=18761==e.getUint16(i+=6,!1);i+=e.getUint32(i+4,r);var a=e.getUint16(i,r);i+=2;for(var c=0;c<a;c++)if(274==e.getUint16(i+12*c,r))return e.getUint16(i+12*c+8,r)}else{if(65280!=(65280&o))break;i+=e.getUint16(i,!1)}}return-1}(t)),t){case 2:return{rotate:0,flip:!0};case 3:return{rotate:2,flip:!1};case 4:return{rotate:2,flip:!0};case 5:return{rotate:1,flip:!0};case 6:return{rotate:1,flip:!1};case 7:return{rotate:3,flip:!0};case 8:return{rotate:3,flip:!1};default:return{rotate:0,flip:!1}}}(e?-1:t),n.originalSize.width=n.originalImage.naturalWidth,n.originalSize.height=n.originalImage.naturalHeight,i()},n.originalImage.onerror=o,n.originalImage.src=t}))}},{key:"loadImageFromURL",value:function(t){var e=this,n=new Image;n.onerror=function(){return e.loadImageFailed.emit()},n.onload=function(){var t=document.createElement("canvas"),i=t.getContext("2d");t.width=n.width,t.height=n.height,i.drawImage(n,0,0),e.loadBase64Image(t.toDataURL())},n.crossOrigin="anonymous",n.src=t}},{key:"transformOriginalImage",value:function(){if(!this.originalImage||!this.originalImage.complete||!this.exifTransform)return Promise.reject(new Error("No image loaded"));var t=this.transformImageBase64();return this.setTransformedImage(t)}},{key:"transformImageBase64",value:function(){var t=this.canvasRotation+this.exifTransform.rotate;if(0===t&&!this.exifTransform.flip)return this.originalBase64;var e=this.getTransformedSize(),n=document.createElement("canvas");n.width=e.width,n.height=e.height;var i=n.getContext("2d");return i.setTransform(this.exifTransform.flip?-1:1,0,0,1,n.width/2,n.height/2),i.rotate(Math.PI*(t/2)),i.drawImage(this.originalImage,-this.originalSize.width/2,-this.originalSize.height/2),n.toDataURL()}},{key:"getTransformedSize",value:function(){var t=this.canvasRotation+this.exifTransform.rotate;if(this.containWithinAspectRatio){if(t%2){var e=this.originalSize.height/this.aspectRatio;return{width:Math.max(this.originalSize.height,this.originalSize.width*this.aspectRatio),height:Math.max(this.originalSize.width,e)}}var n=this.originalSize.width/this.aspectRatio;return{width:Math.max(this.originalSize.width,this.originalSize.height*this.aspectRatio),height:Math.max(this.originalSize.height,n)}}return t%2?{height:this.originalSize.width,width:this.originalSize.height}:{width:this.originalSize.width,height:this.originalSize.height}}},{key:"setTransformedImage",value:function(t){var e=this;return new Promise((function(n){e.transformedBase64=t,e.safeImgDataUrl=e.sanitizer.bypassSecurityTrustResourceUrl(t),e.transformedImage=new Image,e.transformedImage.onload=function(){e.transformedSize.width=e.transformedImage.naturalWidth,e.transformedSize.height=e.transformedImage.naturalHeight,e.cd.markForCheck(),n()},e.transformedImage.src=e.transformedBase64}))}},{key:"imageLoadedInView",value:function(){var t=this;null!=this.transformedImage&&(this.imageLoaded.emit(),this.setImageMaxSizeRetries=0,setTimeout((function(){return t.checkImageMaxSizeRecursively()})))}},{key:"checkImageMaxSizeRecursively",value:function(){var t=this;this.setImageMaxSizeRetries>40?this.loadImageFailed.emit():this.sourceImageLoaded()?(this.setMaxSize(),this.setCropperScaledMinSize(),this.resetCropperPosition(),this.cropperReady.emit(Object.assign({},this.maxSize)),this.cd.markForCheck()):(this.setImageMaxSizeRetries++,setTimeout((function(){return t.checkImageMaxSizeRecursively()}),50))}},{key:"sourceImageLoaded",value:function(){return this.sourceImage&&this.sourceImage.nativeElement&&this.sourceImage.nativeElement.offsetWidth>0}},{key:"onResize",value:function(){this.resizeCropperPosition(),this.setMaxSize(),this.setCropperScaledMinSize()}},{key:"activatePinchGesture",value:function(){this.Hammer?new this.Hammer(this.wrapper.nativeElement).get("pinch").set({enable:!0}):Object(i.W)()&&console.warn("[NgxImageCropper] Could not find HammerJS - Pinch Gesture won't work")}},{key:"resizeCropperPosition",value:function(){var t=this.sourceImage.nativeElement;this.maxSize.width===t.offsetWidth&&this.maxSize.height===t.offsetHeight||(this.cropper.x1=this.cropper.x1*t.offsetWidth/this.maxSize.width,this.cropper.x2=this.cropper.x2*t.offsetWidth/this.maxSize.width,this.cropper.y1=this.cropper.y1*t.offsetHeight/this.maxSize.height,this.cropper.y2=this.cropper.y2*t.offsetHeight/this.maxSize.height)}},{key:"resetCropperPosition",value:function(){var t=this.sourceImage.nativeElement;if(this.maintainAspectRatio)if(t.offsetWidth/this.aspectRatio<t.offsetHeight){this.cropper.x1=0,this.cropper.x2=t.offsetWidth;var e=t.offsetWidth/this.aspectRatio;this.cropper.y1=(t.offsetHeight-e)/2,this.cropper.y2=this.cropper.y1+e}else{this.cropper.y1=0,this.cropper.y2=t.offsetHeight;var n=t.offsetHeight*this.aspectRatio;this.cropper.x1=(t.offsetWidth-n)/2,this.cropper.x2=this.cropper.x1+n}else this.cropper.x1=0,this.cropper.x2=t.offsetWidth,this.cropper.y1=0,this.cropper.y2=t.offsetHeight;this.doAutoCrop(),this.imageVisible=!0}},{key:"keyboardAccess",value:function(t){this.changeKeyboardStepSize(t),this.keyboardMoveCropper(t)}},{key:"changeKeyboardStepSize",value:function(t){t.key>="1"&&t.key<="9"&&(this.stepSize=+t.key)}},{key:"keyboardMoveCropper",value:function(t){if(["ArrowUp","ArrowDown","ArrowRight","ArrowLeft"].includes(t.key)){var e=t.shiftKey?h.Resize:h.Move,n=t.altKey?this.getInvertedPositionForKey(t.key):this.getPositionForKey(t.key),i=this.getEventForKey(t.key,this.stepSize);t.preventDefault(),t.stopPropagation(),this.startMove({clientX:0,clientY:0},e,n),this.moveImg(i),this.moveStop()}}},{key:"getPositionForKey",value:function(t){switch(t){case"ArrowUp":return"top";case"ArrowRight":return"right";case"ArrowDown":return"bottom";case"ArrowLeft":default:return"left"}}},{key:"getInvertedPositionForKey",value:function(t){switch(t){case"ArrowUp":return"bottom";case"ArrowRight":return"left";case"ArrowDown":return"top";case"ArrowLeft":default:return"right"}}},{key:"getEventForKey",value:function(t,e){switch(t){case"ArrowUp":return{clientX:0,clientY:-1*e};case"ArrowRight":return{clientX:e,clientY:0};case"ArrowDown":return{clientX:0,clientY:e};case"ArrowLeft":default:return{clientX:-1*e,clientY:0}}}},{key:"startMove",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.moveStart&&this.moveStart.active&&this.moveStart.type===h.Pinch||(t.preventDefault&&t.preventDefault(),this.moveStart=Object.assign({active:!0,type:e,position:n,clientX:this.getClientX(t),clientY:this.getClientY(t)},this.cropper))}},{key:"startPinch",value:function(t){this.safeImgDataUrl&&(t.preventDefault&&t.preventDefault(),this.moveStart=Object.assign({active:!0,type:h.Pinch,position:"center",clientX:this.cropper.x1+(this.cropper.x2-this.cropper.x1)/2,clientY:this.cropper.y1+(this.cropper.y2-this.cropper.y1)/2},this.cropper))}},{key:"moveImg",value:function(t){this.moveStart.active&&(t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),this.moveStart.type===h.Move?(this.move(t),this.checkCropperPosition(!0)):this.moveStart.type===h.Resize&&(this.resize(t),this.checkCropperPosition(!1)),this.cd.detectChanges())}},{key:"onPinch",value:function(t){this.moveStart.active&&(t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),this.moveStart.type===h.Pinch&&(this.resize(t),this.checkCropperPosition(!1)),this.cd.detectChanges())}},{key:"setMaxSize",value:function(){if(this.sourceImage){var t=this.sourceImage.nativeElement;this.maxSize.width=t.offsetWidth,this.maxSize.height=t.offsetHeight,this.marginLeft=this.sanitizer.bypassSecurityTrustStyle("calc(50% - "+this.maxSize.width/2+"px)")}}},{key:"setCropperScaledMinSize",value:function(){this.transformedImage?(this.setCropperScaledMinWidth(),this.setCropperScaledMinHeight()):(this.cropperScaledMinWidth=20,this.cropperScaledMinHeight=20)}},{key:"setCropperScaledMinWidth",value:function(){this.cropperScaledMinWidth=this.cropperMinWidth>0?Math.max(20,this.cropperMinWidth/this.transformedImage.width*this.maxSize.width):20}},{key:"setCropperScaledMinHeight",value:function(){this.cropperScaledMinHeight=this.maintainAspectRatio?Math.max(20,this.cropperScaledMinWidth/this.aspectRatio):this.cropperMinHeight>0?Math.max(20,this.cropperMinHeight/this.transformedImage.height*this.maxSize.height):20}},{key:"checkCropperPosition",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.cropper.x1<0&&(this.cropper.x2-=t?this.cropper.x1:0,this.cropper.x1=0),this.cropper.y1<0&&(this.cropper.y2-=t?this.cropper.y1:0,this.cropper.y1=0),this.cropper.x2>this.maxSize.width&&(this.cropper.x1-=t?this.cropper.x2-this.maxSize.width:0,this.cropper.x2=this.maxSize.width),this.cropper.y2>this.maxSize.height&&(this.cropper.y1-=t?this.cropper.y2-this.maxSize.height:0,this.cropper.y2=this.maxSize.height)}},{key:"moveStop",value:function(){this.moveStart.active&&(this.moveStart.active=!1,this.doAutoCrop())}},{key:"pinchStop",value:function(){this.moveStart.active&&(this.moveStart.active=!1,this.doAutoCrop())}},{key:"move",value:function(t){var e=this.getClientX(t)-this.moveStart.clientX,n=this.getClientY(t)-this.moveStart.clientY;this.cropper.x1=this.moveStart.x1+e,this.cropper.y1=this.moveStart.y1+n,this.cropper.x2=this.moveStart.x2+e,this.cropper.y2=this.moveStart.y2+n}},{key:"resize",value:function(t){var e=this.getClientX(t)-this.moveStart.clientX,n=this.getClientY(t)-this.moveStart.clientY;switch(this.moveStart.position){case"left":this.cropper.x1=Math.min(this.moveStart.x1+e,this.cropper.x2-this.cropperScaledMinWidth);break;case"topleft":this.cropper.x1=Math.min(this.moveStart.x1+e,this.cropper.x2-this.cropperScaledMinWidth),this.cropper.y1=Math.min(this.moveStart.y1+n,this.cropper.y2-this.cropperScaledMinHeight);break;case"top":this.cropper.y1=Math.min(this.moveStart.y1+n,this.cropper.y2-this.cropperScaledMinHeight);break;case"topright":this.cropper.x2=Math.max(this.moveStart.x2+e,this.cropper.x1+this.cropperScaledMinWidth),this.cropper.y1=Math.min(this.moveStart.y1+n,this.cropper.y2-this.cropperScaledMinHeight);break;case"right":this.cropper.x2=Math.max(this.moveStart.x2+e,this.cropper.x1+this.cropperScaledMinWidth);break;case"bottomright":this.cropper.x2=Math.max(this.moveStart.x2+e,this.cropper.x1+this.cropperScaledMinWidth),this.cropper.y2=Math.max(this.moveStart.y2+n,this.cropper.y1+this.cropperScaledMinHeight);break;case"bottom":this.cropper.y2=Math.max(this.moveStart.y2+n,this.cropper.y1+this.cropperScaledMinHeight);break;case"bottomleft":this.cropper.x1=Math.min(this.moveStart.x1+e,this.cropper.x2-this.cropperScaledMinWidth),this.cropper.y2=Math.max(this.moveStart.y2+n,this.cropper.y1+this.cropperScaledMinHeight);break;case"center":var i=t.scale,o=Math.abs(this.moveStart.x2-this.moveStart.x1)*i,r=Math.abs(this.moveStart.y2-this.moveStart.y1)*i,a=this.cropper.x1,c=this.cropper.y1;this.cropper.x1=Math.min(this.moveStart.clientX-o/2,this.cropper.x2-this.cropperScaledMinWidth),this.cropper.y1=Math.min(this.moveStart.clientY-r/2,this.cropper.y2-this.cropperScaledMinHeight),this.cropper.x2=Math.max(this.moveStart.clientX+o/2,a+this.cropperScaledMinWidth),this.cropper.y2=Math.max(this.moveStart.clientY+r/2,c+this.cropperScaledMinHeight)}this.maintainAspectRatio&&this.checkAspectRatio()}},{key:"checkAspectRatio",value:function(){var t=0,e=0;switch(this.moveStart.position){case"top":this.cropper.x2=this.cropper.x1+(this.cropper.y2-this.cropper.y1)*this.aspectRatio,t=Math.max(this.cropper.x2-this.maxSize.width,0),e=Math.max(0-this.cropper.y1,0),(t>0||e>0)&&(this.cropper.x2-=e*this.aspectRatio>t?e*this.aspectRatio:t,this.cropper.y1+=e*this.aspectRatio>t?e:t/this.aspectRatio);break;case"bottom":this.cropper.x2=this.cropper.x1+(this.cropper.y2-this.cropper.y1)*this.aspectRatio,t=Math.max(this.cropper.x2-this.maxSize.width,0),e=Math.max(this.cropper.y2-this.maxSize.height,0),(t>0||e>0)&&(this.cropper.x2-=e*this.aspectRatio>t?e*this.aspectRatio:t,this.cropper.y2-=e*this.aspectRatio>t?e:t/this.aspectRatio);break;case"topleft":this.cropper.y1=this.cropper.y2-(this.cropper.x2-this.cropper.x1)/this.aspectRatio,t=Math.max(0-this.cropper.x1,0),e=Math.max(0-this.cropper.y1,0),(t>0||e>0)&&(this.cropper.x1+=e*this.aspectRatio>t?e*this.aspectRatio:t,this.cropper.y1+=e*this.aspectRatio>t?e:t/this.aspectRatio);break;case"topright":this.cropper.y1=this.cropper.y2-(this.cropper.x2-this.cropper.x1)/this.aspectRatio,t=Math.max(this.cropper.x2-this.maxSize.width,0),e=Math.max(0-this.cropper.y1,0),(t>0||e>0)&&(this.cropper.x2-=e*this.aspectRatio>t?e*this.aspectRatio:t,this.cropper.y1+=e*this.aspectRatio>t?e:t/this.aspectRatio);break;case"right":case"bottomright":this.cropper.y2=this.cropper.y1+(this.cropper.x2-this.cropper.x1)/this.aspectRatio,t=Math.max(this.cropper.x2-this.maxSize.width,0),e=Math.max(this.cropper.y2-this.maxSize.height,0),(t>0||e>0)&&(this.cropper.x2-=e*this.aspectRatio>t?e*this.aspectRatio:t,this.cropper.y2-=e*this.aspectRatio>t?e:t/this.aspectRatio);break;case"left":case"bottomleft":this.cropper.y2=this.cropper.y1+(this.cropper.x2-this.cropper.x1)/this.aspectRatio,t=Math.max(0-this.cropper.x1,0),e=Math.max(this.cropper.y2-this.maxSize.height,0),(t>0||e>0)&&(this.cropper.x1+=e*this.aspectRatio>t?e*this.aspectRatio:t,this.cropper.y2-=e*this.aspectRatio>t?e:t/this.aspectRatio);break;case"center":this.cropper.x2=this.cropper.x1+(this.cropper.y2-this.cropper.y1)*this.aspectRatio,this.cropper.y2=this.cropper.y1+(this.cropper.x2-this.cropper.x1)/this.aspectRatio;var n=Math.max(0-this.cropper.x1,0),i=Math.max(this.cropper.x2-this.maxSize.width,0),o=Math.max(this.cropper.y2-this.maxSize.height,0),r=Math.max(0-this.cropper.y1,0);(n>0||i>0||o>0||r>0)&&(this.cropper.x1+=o*this.aspectRatio>n?o*this.aspectRatio:n,this.cropper.x2-=r*this.aspectRatio>i?r*this.aspectRatio:i,this.cropper.y1+=r*this.aspectRatio>i?r:i/this.aspectRatio,this.cropper.y2-=o*this.aspectRatio>n?o:n/this.aspectRatio)}}},{key:"doAutoCrop",value:function(){this.autoCrop&&this.crop()}},{key:"crop",value:function(){if(this.sourceImage&&this.sourceImage.nativeElement&&null!=this.transformedImage){this.startCropImage.emit();var t=this.getImagePosition(),e=t.x2-t.x1,n=t.y2-t.y1,i=document.createElement("canvas");i.width=e,i.height=n;var o=i.getContext("2d");if(o){null!=this.backgroundColor&&(o.fillStyle=this.backgroundColor,o.fillRect(0,0,e,n));var r=(this.transform.scale||1)*(this.transform.flipH?-1:1),a=(this.transform.scale||1)*(this.transform.flipV?-1:1);o.setTransform(r,0,0,a,this.transformedSize.width/2,this.transformedSize.height/2),o.translate(-t.x1/r,-t.y1/a),o.rotate((this.transform.rotate||0)*Math.PI/180),o.drawImage(this.transformedImage,-this.transformedSize.width/2,-this.transformedSize.height/2);var c={width:e,height:n,imagePosition:t,cropperPosition:Object.assign({},this.cropper)};this.containWithinAspectRatio&&(c.offsetImagePosition=this.getOffsetImagePosition());var s=this.getResizeRatio(e,n);return 1!==s&&(c.width=Math.round(e*s),c.height=this.maintainAspectRatio?Math.round(c.width/this.aspectRatio):Math.round(n*s),function(t,e,n){var i=t.width,o=t.height,r=i/(e=Math.round(e)),a=o/(n=Math.round(n)),c=Math.ceil(r/2),s=Math.ceil(a/2),l=t.getContext("2d");if(l){for(var d=l.getImageData(0,0,i,o),h=l.createImageData(e,n),u=d.data,g=h.data,p=0;p<n;p++)for(var f=0;f<e;f++){var b=4*(f+p*e),m=p*a,v=0,C=0,M=0,O=0,y=0,P=0,_=0,k=Math.floor(f*r),x=Math.floor(p*a),w=Math.ceil((f+1)*r),I=Math.ceil((p+1)*a);w=Math.min(w,i),I=Math.min(I,o);for(var U=x;U<I;U++)for(var S=Math.abs(m-U)/s,V=f*r,A=S*S,R=k;R<w;R++){var z=Math.abs(V-R)/c,F=Math.sqrt(A+z*z);if(!(F>=1)){var D=4*(R+U*i);_+=(v=2*F*F*F-3*F*F+1)*u[D+3],M+=v,u[D+3]<255&&(v=v*u[D+3]/250),O+=v*u[D],y+=v*u[D+1],P+=v*u[D+2],C+=v}}g[b]=O/C,g[b+1]=y/C,g[b+2]=P/C,g[b+3]=_/M}t.width=e,t.height=n,l.putImageData(h,0,0)}}(i,c.width,c.height)),c.base64=this.cropToBase64(i),this.imageCropped.emit(c),c}}return null}},{key:"getImagePosition",value:function(){var t=this.transformedSize.width/this.sourceImage.nativeElement.offsetWidth,e={x1:Math.round(this.cropper.x1*t),y1:Math.round(this.cropper.y1*t),x2:Math.round(this.cropper.x2*t),y2:Math.round(this.cropper.y2*t)};return this.containWithinAspectRatio||(e.x1=Math.max(e.x1,0),e.y1=Math.max(e.y1,0),e.x2=Math.min(e.x2,this.transformedSize.width),e.y2=Math.min(e.y2,this.transformedSize.height)),e}},{key:"getOffsetImagePosition",value:function(){var t,e,n=this.transformedSize.width/this.sourceImage.nativeElement.offsetWidth;(this.canvasRotation+this.exifTransform.rotate)%2?(t=(this.transformedSize.width-this.originalSize.height)/2,e=(this.transformedSize.height-this.originalSize.width)/2):(t=(this.transformedSize.width-this.originalSize.width)/2,e=(this.transformedSize.height-this.originalSize.height)/2);var i={x1:Math.round(this.cropper.x1*n)-t,y1:Math.round(this.cropper.y1*n)-e,x2:Math.round(this.cropper.x2*n)-t,y2:Math.round(this.cropper.y2*n)-e};return this.containWithinAspectRatio||(i.x1=Math.max(i.x1,0),i.y1=Math.max(i.y1,0),i.x2=Math.min(i.x2,this.transformedSize.width),i.y2=Math.min(i.y2,this.transformedSize.height)),i}},{key:"cropToBase64",value:function(t){return t.toDataURL("image/"+this.format,this.getQuality())}},{key:"getQuality",value:function(){return Math.min(1,Math.max(0,this.imageQuality/100))}},{key:"getResizeRatio",value:function(t,e){if(this.resizeToWidth>0){if(!this.onlyScaleDown||t>this.resizeToWidth)return this.resizeToWidth/t}else if(this.resizeToHeight>0&&(!this.onlyScaleDown||e>this.resizeToHeight))return this.resizeToHeight/e;return 1}},{key:"getClientX",value:function(t){return(t.touches&&t.touches[0]?t.touches[0].clientX:t.clientX)||0}},{key:"getClientY",value:function(t){return(t.touches&&t.touches[0]?t.touches[0].clientY:t.clientY)||0}}]),t}();return t.\u0275fac=function(e){return new(e||t)(i.Pb(r.b),i.Pb(i.h))},t.\u0275cmp=i.Jb({type:t,selectors:[["image-cropper"]],viewQuery:function(t,e){var n;1&t&&(i.Ec(a,!0),i.Oc(c,!0)),2&t&&(i.uc(n=i.ec())&&(e.wrapper=n.first),i.uc(n=i.ec())&&(e.sourceImage=n.first))},hostVars:4,hostBindings:function(t,e){1&t&&i.dc("resize",(function(){return e.onResize()}),!1,i.xc)("mousemove",(function(t){return e.moveImg(t)}),!1,i.wc)("touchmove",(function(t){return e.moveImg(t)}),!1,i.wc)("pinchmove",(function(t){return e.onPinch(t)}),!1,i.wc)("mouseup",(function(){return e.moveStop()}),!1,i.wc)("touchend",(function(){return e.moveStop()}),!1,i.wc)("pinchend",(function(){return e.pinchStop()}),!1,i.wc),2&t&&(i.Fc("text-align",e.alignImage),i.Gb("disabled",e.disabled))},inputs:{format:"format",maintainAspectRatio:"maintainAspectRatio",transform:"transform",aspectRatio:"aspectRatio",resizeToWidth:"resizeToWidth",resizeToHeight:"resizeToHeight",cropperMinWidth:"cropperMinWidth",cropperMinHeight:"cropperMinHeight",canvasRotation:"canvasRotation",initialStepSize:"initialStepSize",roundCropper:"roundCropper",onlyScaleDown:"onlyScaleDown",imageQuality:"imageQuality",autoCrop:"autoCrop",containWithinAspectRatio:"containWithinAspectRatio",hideResizeSquares:"hideResizeSquares",cropper:"cropper",alignImage:"alignImage",disabled:"disabled",imageChangedEvent:"imageChangedEvent",imageURL:"imageURL",imageBase64:"imageBase64",imageFile:"imageFile",backgroundColor:"backgroundColor"},outputs:{imageCropped:"imageCropped",startCropImage:"startCropImage",imageLoaded:"imageLoaded",cropperReady:"cropperReady",loadImageFailed:"loadImageFailed"},features:[i.Ab],decls:5,vars:10,consts:[[3,"pinchstart"],["wrapper",""],["class","source-image",3,"src","visibility","transform","load",4,"ngIf"],[1,"overlay"],["class","cropper","tabindex","0",3,"rounded","top","left","width","height","margin-left","visibility","keydown",4,"ngIf"],[1,"source-image",3,"src","load"],["sourceImage",""],["tabindex","0",1,"cropper",3,"keydown"],[1,"move",3,"mousedown","touchstart"],[4,"ngIf"],[1,"resize","topleft",3,"mousedown","touchstart"],[1,"square"],[1,"resize","top"],[1,"resize","topright",3,"mousedown","touchstart"],[1,"resize","right"],[1,"resize","bottomright",3,"mousedown","touchstart"],[1,"resize","bottom"],[1,"resize","bottomleft",3,"mousedown","touchstart"],[1,"resize","left"],[1,"resize-bar","top",3,"mousedown","touchstart"],[1,"resize-bar","right",3,"mousedown","touchstart"],[1,"resize-bar","bottom",3,"mousedown","touchstart"],[1,"resize-bar","left",3,"mousedown","touchstart"]],template:function(t,e){1&t&&(i.Vb(0,"div",0,1),i.dc("pinchstart",(function(t){return e.startPinch(t)})),i.Gc(2,s,2,5,"img",2),i.Qb(3,"div",3),i.Gc(4,d,3,15,"div",4),i.Ub()),2&t&&(i.Fc("background",e.imageVisible&&e.backgroundColor,i.Ib),i.Cb(2),i.nc("ngIf",e.safeImgDataUrl),i.Cb(1),i.Fc("width",e.maxSize.width,"px")("height",e.maxSize.height,"px")("margin-left","center"===e.alignImage?e.marginLeft:null),i.Cb(1),i.nc("ngIf",e.imageVisible))},directives:[o.t],styles:['[_nghost-%COMP%]{display:flex;position:relative;width:100%;max-width:100%;max-height:100%;overflow:hidden;padding:5px;text-align:center}[_nghost-%COMP%] > div[_ngcontent-%COMP%]{width:100%;position:relative}[_nghost-%COMP%] > div[_ngcontent-%COMP%]   img.source-image[_ngcontent-%COMP%]{max-width:100%;max-height:100%;transform-origin:center}[_nghost-%COMP%]   .overlay[_ngcontent-%COMP%]{position:absolute;pointer-events:none;touch-action:none;outline:var(--cropper-overlay-color,#fff) solid 100vw;top:0;left:0}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]{position:absolute;display:flex;color:#53535c;background:0 0;outline:rgba(255,255,255,.3) solid 100vw;outline:var(--cropper-outline-color,rgba(255,255,255,.3)) solid 100vw;touch-action:none}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]:after{position:absolute;content:"";top:0;bottom:0;left:0;right:0;pointer-events:none;border:1px dashed;opacity:.75;color:inherit;z-index:1}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .move[_ngcontent-%COMP%]{width:100%;cursor:move;border:1px solid rgba(255,255,255,.5)}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]:focus   .move[_ngcontent-%COMP%]{border-color:#1e90ff;border-width:2px}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize[_ngcontent-%COMP%]{position:absolute;display:inline-block;line-height:6px;padding:8px;opacity:.85;z-index:1}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize[_ngcontent-%COMP%]   .square[_ngcontent-%COMP%]{display:inline-block;background:#53535c;width:6px;height:6px;border:1px solid rgba(255,255,255,.5);box-sizing:content-box}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize.topleft[_ngcontent-%COMP%]{top:-12px;left:-12px;cursor:nwse-resize}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize.top[_ngcontent-%COMP%]{top:-12px;left:calc(50% - 12px);cursor:ns-resize}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize.topright[_ngcontent-%COMP%]{top:-12px;right:-12px;cursor:nesw-resize}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize.right[_ngcontent-%COMP%]{top:calc(50% - 12px);right:-12px;cursor:ew-resize}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize.bottomright[_ngcontent-%COMP%]{bottom:-12px;right:-12px;cursor:nwse-resize}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize.bottom[_ngcontent-%COMP%]{bottom:-12px;left:calc(50% - 12px);cursor:ns-resize}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize.bottomleft[_ngcontent-%COMP%]{bottom:-12px;left:-12px;cursor:nesw-resize}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize.left[_ngcontent-%COMP%]{top:calc(50% - 12px);left:-12px;cursor:ew-resize}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize-bar[_ngcontent-%COMP%]{position:absolute;z-index:1}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize-bar.top[_ngcontent-%COMP%]{top:-11px;left:11px;width:calc(100% - 22px);height:22px;cursor:ns-resize}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize-bar.right[_ngcontent-%COMP%]{top:11px;right:-11px;height:calc(100% - 22px);width:22px;cursor:ew-resize}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize-bar.bottom[_ngcontent-%COMP%]{bottom:-11px;left:11px;width:calc(100% - 22px);height:22px;cursor:ns-resize}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize-bar.left[_ngcontent-%COMP%]{top:11px;left:-11px;height:calc(100% - 22px);width:22px;cursor:ew-resize}[_nghost-%COMP%]   .cropper.rounded[_ngcontent-%COMP%]{outline-color:transparent}[_nghost-%COMP%]   .cropper.rounded[_ngcontent-%COMP%]:after{border-radius:100%;box-shadow:0 0 0 100vw rgba(255,255,255,.3);box-shadow:0 0 0 100vw var(--cropper-outline-color,rgba(255,255,255,.3))}@media (orientation:portrait){[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]{outline-width:100vh}[_nghost-%COMP%]   .cropper.rounded[_ngcontent-%COMP%]:after{box-shadow:0 0 0 100vh rgba(255,255,255,.3);box-shadow:0 0 0 100vh var(--cropper-outline-color,rgba(255,255,255,.3))}}[_nghost-%COMP%]   .cropper.rounded[_ngcontent-%COMP%]   .move[_ngcontent-%COMP%]{border-radius:100%}.disabled[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .move[_ngcontent-%COMP%], .disabled[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize[_ngcontent-%COMP%], .disabled[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize-bar[_ngcontent-%COMP%]{display:none}'],changeDetection:0}),t}(),g=function(){var t=function t(){_classCallCheck(this,t)};return t.\u0275mod=i.Nb({type:t}),t.\u0275inj=i.Mb({factory:function(e){return new(e||t)},imports:[[o.c]]}),t}();function p(t){for(var e=t.split(","),n=e[0].replace("data:","").replace(";base64",""),i=atob(e[1]),o=new ArrayBuffer(i.length),r=new Uint8Array(o),a=0;a<i.length;a+=1)r[a]=i.charCodeAt(a);return new Blob([o],{type:n})}}}]);