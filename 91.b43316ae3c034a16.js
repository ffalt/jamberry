"use strict";(self.webpackChunkjamberry=self.webpackChunkjamberry||[]).push([[91],{6091:(ki,ie,m)=>{m.r(ie),m.d(ie,{TagEditorModule:()=>Ii});var $e=m(4150),y=m(177),u=m(4341),we=m(207),z=m(9193),Xe=m(5015),oe=m(6156),ae=m(6499),V=m(1413),G=m(6977),h=m(467);class Y{cell}var $=m(1042),f=m(6879),w=m(3132);const se=["2 Tone","2-Step Garage","4-Beat","A Cappella","Abstract","Acid","Acid Breaks","Acid House","Acid Jazz","Acid Punk","Acid Rock","Acid Techno","Acid Trance","Acousmatic Music","Acoustic","Adult Contemporary","African","African Blues","African Heavy Metal","African Hip Hop","Afro / Cosmic Disco","Afro-Cuban Jazz","Afrobeat","Aggrotech","Alternative","Alternative Country","Alternative Dance","Alternative Hip Hop","Alternative Metal","Alternative Rock","Ambient","Ambient Dub","Ambient House","American Folk Revival","Americana","Anarcho Punk","Anime","Anti-folk","Apala","Arab Pop","Art Punk","Art Rock","Asian","Asian American Jazz","Asian Underground","Atlanta Hip Hop","Audio Theatre","Audiobook","Australian Country Music","Australian Hip Hop","AustroPop","Avant-garde","Avant-garde Jazz","Avant-garde Metal","Avantgarde","Ax\xe9","Bachata","Background Music","Baila","Baithak Gana","Bakersfield sound","Balearic Beat","Balearic Trance","Ballad","Baltimore Club","Banda","Baroque","Baroque Pop","Bass","Bassline","Baul","Beat","Beat Music","Beautiful Music","Bebop","Benga","Berlin School","Bhangra","Big Band","Big Beat","Big Room","Bikutsi","BitPop","Black Metal","Blue-Eyed Soul","Bluegrass","Blues","Blues Country","Blues Rock","Blues Shouter","Bolero","Bongo Flava","Boogie","Boogie-Woogie","Booty Bass","Bossa Nova","Bounce Music","Bouncy House","Bouncy Techno","Bouyon","Brazilian","Brazilian Rock","Breakbeat","Breakbeat Hardcore","Breakcore","Breakstep","Brega","Brick City club","Brill Building","British Blues","British Dance Band","British Folk revival","British Hip Hop","BritPop","Broken Beat","Brostep","Bubblegum Dance","Bubblegum Pop","Bullerengue","C-Pop","Cabaret","Cadence-lypso","Cajun","Cajun fiddle tunes","Calypso","Canadian Blues","Canci\xf3n","Canterbury scene","Canzone","Cape Jazz","Caribbean","Celtic","Celtic Metal","Celtic Music","Celtic Punk","Cha Cha Cha","Chalga","Chamber Jazz","Chamber Music","Chanson","Chap Hop","Chicago Blues","Chicago Hip Hop","Chicago House","Chicano Rap","Chicha","Chill-out","Chillout","Chillstep","Chillwave","Chimurenga","Chinese Rock","Chiptune","Chopped & Screwed","Choro","Chorus","Christian Country Music","Christian Gangsta Rap","Christian Hip Hop","Christian Metal","Christian Pop","Christian Punk","Christian Rap","Christian Rock","Chutney","Chutney soca","Classic Country","Classic female Blues","Classic Rock","Classical","Classical crossover","Close harmony","Club","Club-House","Coldwave","Comedy","Compas","Complextro","Congolese rumba","Conscious Hip Hop","Contemporary Christian","Contemporary Folk","Contemporary R&B","Continental Jazz","Cool Jazz","Country","Country Blues","Country Pop","Country Rap","Country Rock","Country-Rap","Coup\xe9-D\xe9cal\xe9","Western Music","CowPunk","Criolla","Crossover","Crossover Jazz","Crossover Thrash","Crunk","Crunkcore","Crust Punk","Crustgrind","Cult","Cumbia","Cumbia Rap","Cybergrind","D-beat","Dance","Dance Hall","Dance-Pop","Dance-Punk","Dance-Rock","Dancehall","Dancehall Music","Dangdut","Dansband Music","Dark Ambient","Dark Cabaret","Dark Electro","Dark Wave","Darkcore","Darkcore jungle","Darkstep","Darkwave","Death 'n' roll","Death industrial","Death Metal","Death-Doom","Deathcore","DeathRock","Deep Funk","Deep House","Delta Blues","Desert Rock","Detroit Blues","Detroit Hip Hop","Detroit Techno","Digital hardcore","Disco","Disco polo","Diva House","Dixieland","Djent","Doom Metal","Doomcore","Downtempo","Dream","Dream Pop","Dream Trance","Drill","Drill & Bass","Drone Metal","Drone Music","Drum & Bass","Drum Solo","Drumstep","Dub","Dub Techno","Dubstep","Dubstyle","Dubtronica","Duet","Dunedin Sound","Dutch House","East Coast Hip Hop","Easy Listening","EBM","Eclectic","Electric Blues","Electro","Electro House","Electro Music","Electro Swing","Electro-Industrial","Electroacoustic","Electroacoustic Music","Electroclash","Electronic","Electronic Body Music","Electronic Rock","Electronica","Electronicore","ElectroPop","ElectroPunk","Elevator Music","Emo","Ethereal Wave","Ethnic","Ethnic electronica","Ethno Jazz","Euro Disco","Euro-House","Euro-Techno","Eurobeat","Eurodance","European free Jazz","EuroPop","Experimental","Experimental Hip Hop","Experimental Music","Experimental Rock","Fado","Fann at-Tanbura","Fast Fusion","Fidget House","Fijiri","Filk Music","Filmi","Flamenco","Florida Breaks","Folk","Folk Metal","Folk Pop","Folk Punk","Folk Rock","Folk-Rock","Folklore","Folktronica","Forr\xf3","Franco-Country","Freak Folk","Freakbeat","Free Funk","Free Improvisation","Free Jazz","Free Tekno","Freestyle","Freestyle Music","Freestyle Rap","French House","French Pop","Frevo","Fuji Music","Full On","Funk","Funk Carioca","Funk Metal","Funkstep","Funktronica","Funky House","Furniture Music","Fusion","Future Garage","Future House","FuturePop","G-Funk","Gabba","Game","Game Boy Music","Gamelan","Gangsta Rap","Garage","Garage House","Garage Punk","Garage Rock","Genge","Ghetto House","Ghettotech","Glam Metal","Glam Rock","Glitch","Glitch Hop","Global","Go-go","Goa","Goa Trance","Golden Age Hip Hop","Goregrind","Gospel","Gospel Blues","Gothic","Gothic Metal","Gothic Rock","Grime","Grindcore","Grindie","Groove Metal","Grunge","Grupera","Guajira","Gypsy Jazz","Gypsy Punk","Happy Hardcore","Hard Bop","Hard House","Hard NRG","Hard Rock","Hard Trance","Hardbag","Hardcore","Hardcore Rap","Hardcore Hip Hop","Hardcore Punk","Hardstep","Hardstyle","Heavy Metal","Hellbilly Music","Hi-NRG","Highlife","Hill Country Blues","Hip Hop","Hip Hop Soul","Hip House","Hip Pop","Hip Hop","Hiplife","Hokum","Hokum Blues","Honky Tonk","Horror Punk","Horrorcore","House","House Music","Houston Hip Hop","Huayno","Humour","Hyphy","IDM","Igbo highlife","Igbo Rap","Illbient","Indian Pop","Indie","Indie Folk","Indie Pop","Indie Rock","Indietronica","Industrial","Industrial Folk","Industrial Hip Hop","Industrial Metal","Industrial Music","Industrial Rock","Industro-Goth","Instrumental","Instrumental Country","Instrumental Hip Hop","Instrumental Pop","Instrumental Rock","Iranian Pop","Isicathamiya","Isolationism","Italo Dance","Italo Disco","Italo House","J-Pop","Jam Band","Jangle Pop","Japanoise","Jazz","Jazz Blues","Jazz Fusion","Jazz House","Jazz Rap","Jazz Rock","Jazz-Funk","Jazz+Funk","Jerkin'","Jersey Club","Jit","JPop","J\xf9j\xfa","Jump Blues","Jump-up","Jumpstyle","Jungle","K-Pop","Kadongo Kamu","Kansas City Blues","Kansas City Jazz","Kapuka","Keroncong","Khaliji","Kizomba","Krautrock","Kuduro","Kwaito","Kwassa Kwassa","Kwela","La\xefk\xf3","Lambada","Laptronica","Latin","Latin alternative","Latin ballad","Latin Christian","Latin House","Latin Jazz","Latin Metal","Latin Pop","Latin Rock","Latin Swing","Lavani","Leftfield","Lento Violento","Liquid Dubstep","Liquid Funk","Livetronica","Liwa","Lo-fi","Lo-Fi","Louisiana Blues","Louisiana Swamp Pop","Lounge","Lounge Music","Lovers Rock","Low Bap","Lowercase","Luk Krung","Luk Thung","Lyrical Hip Hop","M-Base","Mafioso Rap","Mainstream Jazz","M\xe1kina","Makossa","Maloya","Mambo","MandoPop","Manila Sound","Maracatu","Mariachi","Marrabenta","Math Rock","Mathcore","Mbalax","Mbaqanga","Mbube","Medieval Metal","Meditative","Melbourne Bounce","Melodic Death Metal","Melodic Metalcore","Memphis Blues","Merengue","MerenRap","M\xe9ringue","Metal","Metalcore","Mexican Pop","Mexican Son","Miami Bass","Microhouse","Middle of the road","Midwest Hip Hop","Minimal Techno","Minimal Wave","Modal Jazz","Moombahcore","Moombahton","Morlam","Morna","Mosambique","Motswako","M\xfasica Criolla","M\xfasica Popular Brasileira","M\xfasica Sertaneja","Musical","Musique Concr\xe8te","Nagoya Kei","Nashville Sound","National Folk","Native American","NDW","Ndombolo","NederPop","Neo Soul","Neo-Bop Jazz","Neo-Psychedelia","Neo-Swing","Neoclassical","Neoclassical Metal","Neofolk","Neotraditional Country","Nerdcore","Neue Deutsche Welle","NeuroFunk","Neurohop","New Age","New Beat","New jack swing","New Jersey Hip Hop","New Prog","New Rave","New Romantic","New Romanticism","New School Hip Hop","New Wave","New-age Music","Nintendocore","Nitzhonot","No wave","Noise","Noise Rock","Noisegrind","Nortec","Norte\xf1o","Northern Soul","Novelty Ragtime","Nu Jazz","Nu Metal","Nu Skool Breaks","Nu-Breakz","Nu-Disco","Nu-Funk","Nu-Gaze","Nu-NRG","Nueva canci\xf3n","Old School Hip Hop","Oldies","Opera","Operatic Pop","Orchestral Jazz","Original Pilipino Music","Other","Outlaw Country","Outsider House","P-Funk","Pagan Metal","Pagode","Paisley Underground","Palm-wine","Piedmont Blues","Pinoy Pop","Podcast","Political Hip Hop","Polka","Polsk Punk","Pop","Pop Punk","Pop Rap","Pop Rock","Pop Soul","Pop Sunda","Pop-Folk","Pop-Funk","Porn Groove","Porro","Post-Bop","Post-Disco","Post-Grunge","Post-Hardcore","Post-Metal","Post-Punk","Post-Punk Revival","Post-Rock","Power Ballad","Power Electronics","Power Metal","Power Noise","Power Pop","Powerviolence","Pranks","Primus","Progressive Bluegrass","Progressive Country","Progressive Folk","Progressive House","Progressive Metal","Progressive Pop","Progressive Rock","Progressive Trance","Protest Song","Psybient","Psychedelic","Psychedelic Folk","Psychedelic Pop","Psychedelic Rock","Psychedelic Trance","Psychobilly","Punkabilly","Psytrance","Punk","Punk Blues","Punk Jazz","Punk Rock","Punta","Punta Rock","R&B","Raga Rock","Ragga","Ragga Jungle","Raggacore","Ragini","Ragtime","Ra\xef","Ranchera","Rap","Rap Metal","Rap Music","Rap Opera","Rap Rock","Rapcore","Rara tech","Rasin","Rave","Reactionary Bluegrass","Rebetiko","Red Dirt","Reggae","Reggae Espa\xf1ol","Spanish Reggae","Reggae Fusion","Reggaestep","Reggaeton","Regional Mexican","Retro","Revival","Rhythm & Blues","Rhythmic Soul","Riot grrrl","Rock","Rock & Roll","Rock en Espa\xf1ol","Rock in Opposition","Rockabilly","Rocksteady","Rumba","Russian Pop","Sadcore","Sakara","Salsa","Salsa rom\xe1ntica","Samba","Samba Rock","Sambass","Satire","Sawt","Schlager","Screamo","Sega","Seggae","Semba","Sertanejo","Shangaan electro","Shibuya-kei","Shoegaze","Showtunes","Singer-songwriter","Ska","Ska Jazz","Ska Punk","Skate Punk","Skiffle","Skweee","Slow Jam","Slow Rock","Slowcore","Sludge Metal","Smooth Jazz","Snap Music","Soca","Soft Rock","Son","Son Cubano","Sonata","Songo","Songo-Salsa","Sophisti-Pop","Soukous","Soul","Soul Blues","Soul Jazz","Sound Clip","Soundtrack","Southern Hip Hop","Southern Rock","Southern Soul","Space","Space Age Pop","Space Disco","Space Music","Space Rock","Speech","Speed garage","Speed Metal","Speedcore","St.Louis Blues","St.Louis Hip Hop","Stoner Rock","Straight-ahead Jazz","Street Punk","Stride Jazz","Sufi Rock","SungPoetry","Sunshine Pop","Suomisaundi","Surf Pop","Surf Rock","Swamp Blues","Swing","Symphonic black Metal","Symphonic Metal","Symphonic Rock","Symphony","Synthpop","SynthPop","Synthwave","Taarab","Tango","Tech House","Tech Trance","Techdombe","Technical death Metal","Techno","Techno-Industrial","Techstep","Tecno Brega","Tecnobrega","Teen Pop","Tejano","Terror","Texas Blues","Texas Country","Thai Pop","Third stream","Thrash Metal","Thrashcore","Timba","Top 40","Trad Jazz","Traditional Country Music","Traditional Pop Music","Trailer","Trance","Trance Music","TRap","TRapstep","Tribal","Tribal House","Trip hop","Trip-Hop","Trival","Trop Rock","Tropical","Tropical House","Tropicalia","TropiPop","Truck-driving Country","Turkish Pop","Turntablism","Twin Cities Hip Hop","Twoubadou","UK Funky","UK Garage","UK Hardcore","Unblack Metal","Underground Hip Hop","Uplifting Trance","Urban Pasifika","V-Pop","Vallenato","Vaporwave","Video game Music","Viking Metal","VisPop","Visual Kei","Vocal","Vocal Jazz","Vocal Trance","War Metal","Weltmusik","West Coast Blues","West Coast Hip Hop","West Coast Jazz","Western swing","Witch House","Wonky","Wonky Pop","World Fusion","World Music","Worldbeat","Zouglou","Zouk","Zouk-Lambada","Zydeco"];var l=function(a){return a[a.Filename=1]="Filename",a[a.IdText=2]="IdText",a[a.IdBin=3]="IdBin",a[a.Text=4]="Text",a[a.TextList=5]="TextList",a[a.LangDescText=6]="LangDescText",a[a.PlayCounter=7]="PlayCounter",a[a.Popularimeter=8]="Popularimeter",a[a.MusicCDId=9]="MusicCDId",a[a.EventTimingCodes=10]="EventTimingCodes",a[a.SYLT=11]="SYLT",a[a.GEOB=12]="GEOB",a[a.ETCO=13]="ETCO",a[a.PCST=14]="PCST",a[a.LINK=15]="LINK",a[a.AENC=16]="AENC",a[a.Pic=17]="Pic",a[a.RVAD=18]="RVAD",a[a.RGAD=19]="RGAD",a[a.RVAD2=20]="RVAD2",a[a.CTOC=21]="CTOC",a[a.CHAP=22]="CHAP",a[a.Bool=23]="Bool",a[a.Unknown=24]="Unknown",a}(l||{});const M={internal_file:{title:"Filename",versions:[2,3,4],impl:l.Filename},UFI:{title:"Unique file identifier",versions:[2],impl:l.IdText,upgrade:"UFID"},TOT:{title:"Original album/Movie/Show title",versions:[2],impl:l.Text,upgrade:"TOAL"},CDM:{title:"Compressed Data Metaframe",versions:[2],impl:l.Unknown},CRM:{title:"Encrypted meta",versions:[2],impl:l.Unknown},TT1:{title:"Content group",versions:[2],impl:l.Text,upgrade:"TIT1"},TT2:{title:"Title",versions:[2],impl:l.Text,upgrade:"TIT2"},TT3:{title:"Subtitle",versions:[2],impl:l.Text,upgrade:"TIT3"},TP1:{title:"Artist",versions:[2],impl:l.Text,upgrade:"TPE1"},TP2:{title:"Album Artist",versions:[2],impl:l.Text,upgrade:"TPE2"},TP3:{title:"Conductor",versions:[2],impl:l.Text,upgrade:"TPE3"},TP4:{title:"Remixer",versions:[2],impl:l.Text,upgrade:"TPE4"},TCM:{title:"Composer",versions:[2],impl:l.Text,upgrade:"TCOM"},TXT:{title:"Lyricist",versions:[2],impl:l.Text,upgrade:"TEXT"},TLA:{title:"Languages",versions:[2],impl:l.Text,upgrade:"TLAN"},TCO:{title:"Genre",versions:[2],impl:l.Text,upgrade:"TCON"},TAL:{title:"Album",versions:[2],impl:l.Text,upgrade:"TALB"},TPA:{title:"Part of a set",versions:[2],impl:l.Text,upgrade:"TPOS"},TRK:{title:"Track number",versions:[2],impl:l.Text,upgrade:"TRCK"},TRC:{title:"ISRC (international standard recording code)",versions:[2],impl:l.Text,upgrade:"TSRC"},TYE:{title:"Year",versions:[2],impl:l.Text,upgrade:"TYER"},TDA:{title:"Date",versions:[2],impl:l.Text,upgrade:"TDAT"},TIM:{title:"Time",versions:[2],impl:l.Text,upgrade:"TIME"},TRD:{title:"Recording dates",versions:[2],impl:l.Text,upgrade:"TRDA"},TMT:{title:"Media type",versions:[2],impl:l.Text,upgrade:"TMED"},TBP:{title:"BPM",versions:[2],impl:l.Text,upgrade:"TBPM"},TCR:{title:"Copyright message",versions:[2],impl:l.Text,upgrade:"TCOP"},TPB:{title:"Publisher",versions:[2],impl:l.Text,upgrade:"TPUB"},TEN:{title:"Encoded by",versions:[2],impl:l.Text,upgrade:"TENC"},TSS:{title:"Encoding Software/Hardware",versions:[2],impl:l.Text,upgrade:"TSSE"},TOF:{title:"Original filename",versions:[2],impl:l.Text,upgrade:"TOFN"},TLE:{title:"Length",versions:[2],impl:l.Text,upgrade:"TLEN"},TSI:{title:"Size",versions:[2],impl:l.Text,upgrade:"TSIZ"},TDY:{title:"Playlist delay",versions:[2],impl:l.Text,upgrade:"TDLY"},TKE:{title:"Initial key",versions:[2],impl:l.Text,upgrade:"TKEY"},TOL:{title:"Original lyricist",versions:[2],impl:l.Text,upgrade:"TOLY"},TOA:{title:"Original artist",versions:[2],impl:l.Text,upgrade:"TOPE"},TOR:{title:"Original release year",versions:[2],impl:l.Text,upgrade:"TORY"},TXX:{title:"User defined text",versions:[2],impl:l.IdText,upgrade:"TXXX"},WAF:{title:"Official audio file webpage",versions:[2],impl:l.Text,upgrade:"WOAF"},WAR:{title:"Official artist/performer webpage",versions:[2],impl:l.Text,upgrade:"WOAR"},WAS:{title:"Official audio source webpage",versions:[2],impl:l.Text,upgrade:"WOAS"},WCM:{title:"Commercial information",versions:[2],impl:l.Text,upgrade:"WCOM"},WCP:{title:"Copyright/Legal information",versions:[2],impl:l.Text,upgrade:"WCOP"},WPB:{title:"Publishers official webpage",versions:[2],impl:l.Text,upgrade:"WPUB"},WXX:{title:"User defined URL link frame",versions:[2],impl:l.IdText,upgrade:"WXXX"},IPL:{title:"Involved people list",versions:[2],impl:l.TextList,upgrade:"IPLS"},ETC:{title:"Event timing codes",versions:[2],impl:l.EventTimingCodes,upgrade:"ETCO"},MLL:{title:"MPEG location lookup table",versions:[2],impl:l.Unknown,upgrade:"MLLT"},STC:{title:"Synchronised tempo codes",versions:[2],impl:l.Unknown,upgrade:"SYTC"},ULT:{title:"Lyrics",versions:[2],impl:l.LangDescText,upgrade:"USLT"},SLT:{title:"Synchronised Lyrics",versions:[2],impl:l.SYLT,upgrade:"SYLT"},COM:{title:"Comments",versions:[2],impl:l.LangDescText,upgrade:"COMM"},RVA:{title:"Relative volume adjustment",versions:[2],impl:l.RVAD,upgrade:"RVAD"},EQU:{title:"Equalisation",versions:[2],impl:l.Unknown,upgrade:"EQUA"},REV:{title:"Reverb",versions:[2],impl:l.Unknown,upgrade:"RVRB"},PIC:{title:"Attached picture",versions:[2],impl:l.Pic,upgrade:"APIC"},GEO:{title:"General encapsulated object",versions:[2],impl:l.GEOB,upgrade:"GEOB"},CNT:{title:"Play counter",versions:[2],impl:l.PlayCounter,upgrade:"PCNT"},POP:{title:"Popularimeter",versions:[2],impl:l.Popularimeter,upgrade:"POPM"},BUF:{title:"Recommended buffer size",versions:[2],impl:l.Unknown,upgrade:"RBUF"},CRA:{title:"Audio encryption",versions:[2],impl:l.AENC,upgrade:"AENC"},LNK:{title:"Linked information",versions:[2],impl:l.LINK,upgrade:"LINK"},NCO:{title:"MusicMatch Binary",versions:[2],impl:l.Unknown,upgrade:"NCON"},PRI:{title:"Private frame",versions:[2],impl:l.IdBin,upgrade:"PRIV"},TCP:{title:"iTunes Compilation Flag",versions:[2],impl:l.Bool,upgrade:"TCMP"},TST:{title:"Title sort order",versions:[2],impl:l.Text,upgrade:"XSOT"},TSP:{title:"Artist sort order",versions:[2],impl:l.Text,upgrade:"XSOP"},TSA:{title:"Album sort order",versions:[2],impl:l.Text,upgrade:"XSOA"},TS2:{title:"Album Artist sort order",versions:[2],impl:l.Text,upgrade:"TSO2"},TSC:{title:"Composer sort order",versions:[2],impl:l.Text,upgrade:"TSOC"},TDR:{title:"Release time",versions:[2],impl:l.Text,upgrade:"TDRL"},TDS:{title:"iTunes podcast description",versions:[2],impl:l.Text,upgrade:"TDES"},TID:{title:"Podcast URL",versions:[2],impl:l.Text,upgrade:"TGID"},WFD:{title:"Podcast feed URL",versions:[2],impl:l.Text,upgrade:"WFED"},PCS:{title:"iTunes podcast marker",versions:[2],impl:l.PCST,upgrade:"PCST"},XSOA:{title:"Album sort order",versions:[3],impl:l.Text,upgrade:"TSOA"},XSOP:{title:"Performer sort order",versions:[3],impl:l.Text,upgrade:"TSOP"},XSOT:{title:"Title sort order",versions:[3],impl:l.Text,upgrade:"TSOT"},XDOR:{title:"Original release time",versions:[3],impl:l.Text,upgrade:"TDOR"},TIT1:{title:"Group",versions:[3,4],impl:l.Text},TIT2:{title:"Title",versions:[3,4],impl:l.Text},TIT3:{title:"Subtitle",versions:[3,4],impl:l.Text},TALB:{title:"Album",versions:[3,4],impl:l.Text},TOAL:{title:"Original album",versions:[3,4],impl:l.Text},TRCK:{title:"Track number",versions:[3,4],impl:l.Text},TPOS:{title:"Part of a set",versions:[3,4],impl:l.Text},TSRC:{title:"ISRC (international standard recording code)",versions:[3,4],impl:l.Text},TPE1:{title:"Artist",versions:[3,4],impl:l.Text},TPE2:{title:"Album Artist",versions:[3,4],impl:l.Text},TPE3:{title:"Conductor",versions:[3,4],impl:l.Text},TPE4:{title:"Remixer",versions:[3,4],impl:l.Text},TOPE:{title:"Original artist",versions:[3,4],impl:l.Text},TEXT:{title:"Lyricist",versions:[3,4],impl:l.Text},TOLY:{title:"Original lyricist",versions:[3,4],impl:l.Text},TCOM:{title:"Composer",versions:[3,4],impl:l.Text},TENC:{title:"Encoded by",versions:[3,4],impl:l.Text},TBPM:{title:"BPM",versions:[3,4],impl:l.Text},TLEN:{title:"Length",versions:[3,4],impl:l.Text},TKEY:{title:"Initial key",versions:[3,4],impl:l.Text},TLAN:{title:"Languages",versions:[3,4],impl:l.Text},TCON:{title:"Genre",versions:[3,4],impl:l.Text},TFLT:{title:"File type",versions:[3,4],impl:l.Text},TMED:{title:"Media type",versions:[3,4],impl:l.Text},TCOP:{title:"Copyright message",versions:[3,4],impl:l.Text},TPUB:{title:"Publisher",versions:[3,4],impl:l.Text},TOWN:{title:"File owner",versions:[3,4],impl:l.Text},TRSN:{title:"Internet radio station name",versions:[3,4],impl:l.Text},TRSO:{title:"Internet radio station owner",versions:[3,4],impl:l.Text},TOFN:{title:"Original filename",versions:[3,4],impl:l.Text},TDLY:{title:"Playlist delay",versions:[3,4],impl:l.Text},TSSE:{versions:[3,4],title:"Encoding Software/Hardware",impl:l.Text},TSST:{versions:[3,4],title:"Set subtitle",impl:l.Text},TDAT:{title:"Date",versions:[3],impl:l.Text},TIME:{title:"Time",versions:[3],impl:l.Text},TORY:{title:"Original release year",versions:[3],impl:l.Text},TRDA:{title:"Recording dates",versions:[3],impl:l.Text},TSIZ:{title:"Size",versions:[3],impl:l.Text},TYER:{title:"Year",versions:[3],impl:l.Text},TMCL:{versions:[4],title:"Musician credits list",impl:l.TextList},TIPL:{versions:[4],title:"Involved people list",impl:l.TextList},TMOO:{title:"Mood",versions:[4],impl:l.Text},TPRO:{title:"Produced notice",versions:[4],impl:l.Text},TDOR:{title:"Original release time",versions:[4],impl:l.Text},TDRC:{versions:[4],title:"Recording time",impl:l.Text},TDRL:{versions:[3,4],title:"Release time",impl:l.Text},TDTG:{versions:[4],title:"Tagging time",impl:l.Text},TSOA:{versions:[4],title:"Album sort order",impl:l.Text},TSOP:{versions:[4],title:"Artist sort order",impl:l.Text},TSOT:{versions:[4],title:"Title sort order",impl:l.Text},WCOM:{title:"Commercial information",versions:[3,4],impl:l.Text},WCOP:{title:"Copyright/Legal information",versions:[3,4],impl:l.Text},WOAF:{title:"Official audio file webpage",versions:[3,4],impl:l.Text},WOAR:{title:"Official artist/performer webpage",versions:[3,4],impl:l.Text},WOAS:{title:"Official audio source webpage",versions:[3,4],impl:l.Text},WORS:{title:"Official internet radio station homepage",versions:[3,4],impl:l.Text},WPAY:{title:"Payment",versions:[3,4],impl:l.Text},WPUB:{title:"Publishers official webpage",versions:[3,4],impl:l.Text},TXXX:{title:"User defined text",versions:[3,4],impl:l.IdText},WXXX:{title:"User defined URL link frame",versions:[3,4],impl:l.IdText},UFID:{title:"Unique file identifier",versions:[3,4],impl:l.IdText},MCDI:{title:"Music CD identifier",versions:[3,4],impl:l.MusicCDId},ETCO:{title:"Event timing codes",versions:[3,4],impl:l.ETCO},MLLT:{title:"MPEG location lookup table",versions:[3,4],impl:l.Unknown},SYTC:{title:"Synchronised tempo codes",versions:[3,4],impl:l.Unknown},USLT:{title:"Lyrics",versions:[3,4],impl:l.LangDescText},SYLT:{title:"Synchronised Lyrics",versions:[3,4],impl:l.SYLT},COMM:{title:"Comments",versions:[3,4],impl:l.LangDescText},RVAD:{title:"Relative volume adjustment",versions:[3,4],impl:l.RVAD},RVA2:{title:"Relative volume adjustment 2",versions:[4],impl:l.RVAD2},EQUA:{title:"Equalisation",versions:[3,4],impl:l.Unknown},RVRB:{title:"Reverb",versions:[3,4],impl:l.Unknown},APIC:{title:"Attached picture",versions:[3,4],impl:l.Pic},GEOB:{title:"General encapsulated object",versions:[3,4],impl:l.GEOB},PCNT:{title:"Play counter",versions:[3,4],impl:l.PlayCounter},POPM:{title:"Popularimeter",versions:[3,4],impl:l.Popularimeter},RBUF:{title:"Recommended buffer size",versions:[3,4],impl:l.Unknown},AENC:{title:"Audio encryption",versions:[3,4],impl:l.AENC},LINK:{title:"Linked information",versions:[3,4],impl:l.LINK},POSS:{title:"Position synchronisation",versions:[3,4],impl:l.Unknown},USER:{title:"Terms of use",versions:[3,4],impl:l.Unknown},OWNE:{title:"Ownership",versions:[3,4],impl:l.Unknown},COMR:{title:"Commercial",versions:[3,4],impl:l.Unknown},ENCR:{title:"Encryption method registration",versions:[3,4],impl:l.Unknown},GRID:{title:"Group ID registration",versions:[3,4],impl:l.Unknown},PRIV:{title:"Private frame",versions:[3,4],impl:l.IdBin},IPLS:{title:"Involved people list",versions:[3],impl:l.TextList},SIGN:{title:"Signature",versions:[4],impl:l.Unknown},SEEK:{title:"Seek",versions:[4],impl:l.Unknown},ASPI:{title:"Audio seek point index",versions:[4],impl:l.Unknown},RGAD:{title:"Replay Gain Adjustment",versions:[3,4],impl:l.RGAD},TCMP:{title:"iTunes Compilation Flag",versions:[3,4],impl:l.Bool},TSO2:{title:"Album Artist sort order",versions:[3,4],impl:l.Text},TSOC:{title:"Composer sort order",versions:[3,4],impl:l.Text},PCST:{title:"iTunes podcast marker",versions:[3,4],impl:l.PCST},TDES:{title:"iTunes podcast description",versions:[3,4],impl:l.Text},TKWD:{title:"iTunes podcast keywords",versions:[3,4],impl:l.Unknown},TGID:{title:"Podcast URL",versions:[3,4],impl:l.Text},TDEN:{title:"Encoding time",versions:[3,4],impl:l.Text},WFED:{title:"Podcast feed URL",versions:[3,4],impl:l.Text},GRP1:{title:"Group Number",versions:[3,4],impl:l.Text},NCON:{title:"MusicMatch Binary",versions:[3,4],impl:l.Unknown},CTOC:{title:"Chapter TOC",versions:[4],impl:l.CTOC},CHAP:{title:"Chapter",versions:[4],impl:l.CHAP},XHD3:{title:"mp3hd",versions:[3,4],impl:l.Unknown},CM1:{title:"User defined text",versions:[2],impl:l.Text,upgrade:"TXXX"}},X={ASIN:"ASIN Id",CATALOGNUMBER:"Catalog Nr",SCRIPT:"Script",BARCODE:"Barcode",originalyear:"Original Year",replaygain_track_gain:"Replaygain track gain",replaygain_album_gain:"Replaygain album gain",replaygain_track_peak:"Replaygain track peak",replaygain_album_peak:"Replaygain album peak",Artists:"Artists",Supplier:"Supplier","Release type":"Release type","Acoustid Id":"Acoustid Id","MusicBrainz Track Disambiguation":"MusicBrainz Track Disambiguation","MusicBrainz Album Type":"MusicBrainz Album Type","MusicBrainz Album Artist Id":"MusicBrainz Album Artist Id","MusicBrainz Artist Id":"MusicBrainz Artist Id","MusicBrainz Album Id":"MusicBrainz Album Id","MusicBrainz Release Track Id":"MusicBrainz Release Track Id","MusicBrainz Release Group Id":"MusicBrainz Release Group Id","MusicBrainz Recording Id":"MusicBrainz Recording Id","MusicBrainz Album Status":"MusicBrainz Album Status","MusicBrainz Album Release Country":"MusicBrainz Album Release Country","MusicBrainz TRM Id":"MusicBrainz TRM Id","Discogs Artist ID":"Discogs Artist Id","Discogs Label ID":"Discogs Label Id","Discogs Master Release ID":"Discogs Master Release Id","Discogs Release ID":"Discogs Master Release Id","Discogs Votes":"Discogs Votes","Discogs Rating":"Discogs Rating"},x={"http://musicbrainz.org":"MusicBrainz Track Id"},B={"http://musicbrainz.org":"MusicBrainz Track Id","":"Default Comment"},I="internal_file",L=[{id:I,width:200,force:!0},{id:"TRCK",width:60,force:!0},{id:"TIT2",width:200,force:!0},{id:"TALB",width:200,force:!0},{id:"TPE1",width:140,force:!0},{id:"TPE2",width:140,force:!0},{id:"TOPE",width:140},{id:"TCON",width:100,force:!0},{id:"TPOS",width:60,force:!0},{id:"TIT1",width:200,force:!0},{id:"GRP1",width:60,force:!0},{id:"TMOO",width:100},{id:"APIC",width:100,force:!0},{id:"USLT",width:200,force:!0},{id:"TSOP",width:140},{id:"TSO2",width:140},{id:"TXXX",subid:"Artists",width:140},{id:"IPLS",width:140},{id:"TIPL",width:140},{id:"TMCL",width:140},{id:"TYER",width:100},{id:"TDOR",width:100,force:!0},{id:"TDRC",width:100,force:!0},{id:"TDRL",width:80},{id:"TDAT",width:60},{id:"TORY",width:60},{id:"TXXX",subid:"originalyear",width:60},{id:"TXXX",subid:"MusicBrainz Album Type",width:100,force:!0},{id:"TXXX",subid:"MusicBrainz Album Status",width:60,force:!0},{id:"TXXX",subid:"MusicBrainz Album Release Country",width:60},{id:"TXXX",subid:"MusicBrainz Track Disambiguation",width:100},{id:"TXXX",subid:"Release type",width:100},{id:"TXXX",subid:"SCRIPT",width:60},{id:"TLAN",width:60},{id:"TMED",width:40},{id:"TLEN",width:60},{id:"TIME",width:60},{id:"TKEY",width:60},{id:"TBPM",width:60},{id:"APIC",width:80},{id:"TPUB",width:140},{id:"WPUB",width:140},{id:"WCOP",width:140},{id:"TCOP",width:140},{id:"TCOM",width:140},{id:"TSOC",width:140},{id:"MCDI",width:40},{id:"TXXX",subid:"Acoustid Id",width:40},{id:"TXXX",subid:"ASIN",width:100},{id:"UFID",subid:"http://musicbrainz.org",width:80},{id:"TXXX",subid:"MusicBrainz Release Track Id",width:80},{id:"TXXX",subid:"MusicBrainz Album Id",width:80},{id:"TXXX",subid:"MusicBrainz Album Artist Id",width:80},{id:"TXXX",subid:"MusicBrainz Artist Id",width:80},{id:"TXXX",subid:"MusicBrainz Release Group Id",width:80},{id:"TSSE",width:80},{id:"TFLT",width:80},{id:"TSST",width:80},{id:"TXXX",subid:"Ripping tool",width:80},{id:"TXXX",subid:"Ripping date",width:80},{id:"TDEN",width:80},{id:"TXXX",subid:"Rip date",width:80},{id:"TXXX",subid:"Source",width:80},{id:"TXXX",subid:"Supplier",width:80},{id:"TENC",width:80},{id:"TXXX",subid:"ASIN",width:110},{id:"TSRC",width:110},{id:"TXXX",subid:"BARCODE",width:110},{id:"PRIV",subid:"http://www.cdtag.com",width:100},{id:"TXXX",subid:"CATALOGNUMBER",width:110},{id:"TCMP",width:40},{id:"COMM",width:140},{id:"WXXX",width:140},{id:"GEOB",width:140}],Fe={0:"Other",1:"32x32 pixels 'file icon' (PNG only)",2:"Other file icon",3:"Cover (front)",4:"Cover (back)",5:"Leaflet page",6:"Media (e.g. lable side of CD)",7:"Lead artist/lead performer/soloist",8:"Artist/performer",9:"Conductor",10:"Band/Orchestra",11:"Composer",12:"Lyricist/text writer",13:"Recording Location",14:"During recording",15:"During performance",16:"Movie/video screen capture",17:"A bright coloured fish",18:"Illustration",19:"Band/artist logotype",20:"Publisher/Studio logotype"};var S=m(2702);function re(a){const i={};for(const t of a.cells)if(t.column.def.id!==I)for(const o of t.frames){const n=i[t.column.def.id]||[];n.push(o),i[t.column.def.id]=n}return{version:4,frames:i}}function le(a){let i=(0,S.GV)(a);if(i=i.filter(t=>!isNaN(Number(t))),i.length>0)return i[0]}function F(a){const i=a.cells.find(t=>"TPOS"===t.column.def.id);return`${a.track.parentID}|${i&&i.frames.length>0?i.frames[0].value.text:""}`}function Ue(a,i){const t=[];let o="";if(i.frames.TPOS&&i.frames.TPOS.length>0){const s=i.frames.TPOS[0];let r=(s.value.text||"").split("/")[0];const c=(s.value.text||"").split("/")[1]||"99";if(Number(c)>1){for(;r.length<c.length;)r=`0${r}`;o+=`${r}-`}}if(i.frames.TRCK&&i.frames.TRCK.length>0){const s=i.frames.TRCK[0];let r=(s.value.text||"").split("/")[0];const c=(s.value.text||"").split("/")[1]||"99";for(;r.length<c.length;)r=`0${r}`;o+=r}t.push(o),i.frames.TIT2&&i.frames.TIT2.length>0&&t.push(i.frames.TIT2[0].value.text),i.frames.TPE1&&i.frames.TPE1.length>0&&t.push(i.frames.TPE1[0].value.text);const n=`.${(0,S.lg)(a.name)}`;return`${(0,S.X$)(t.join(" - "),"")}${n}`}class R{jam;columns=[];edits=[];constructor(i){this.jam=i}removeColumnText(i,t){const o=this.columns.indexOf(i);for(const n of this.edits){const s=n.cells[o],r=s.frames.length>0?s.frames[0].value.text:void 0;r&&this.updateEditTextCell(n,i,r.replace(t,""))}}updateEditTextCell(i,t,o){const n=this.columns.indexOf(t),s=i.cells[n],r=o||"";let c=[];r.length>0&&(c=[{id:s.column.def.id,value:l.LangDescText===t.def.impl?{id:"",language:"",text:r}:{id:s.column.def.subid,text:r}}]),(0===s.frames.length||s.frames[0].value.text!==r)&&(i.cells[n]={parent:i,track:s.track,column:t,frames:c,changed:!0},i.changed=!0)}setColumnTrackNrFromFile(i){const t={};for(const o of this.edits){const n=F(o);t[n]=(t[n]||0)+1}for(const o of this.edits){const n=le(o.track.name);if(n){const r=`${n}/${(t[F(o)]||0).toString()}`;this.updateEditTextCell(o,i,r)}}}setColumnFilenames(i){const t=this.columns.indexOf(i);for(const o of this.edits){const s=Ue(o.cells[t].track,re(o));this.updateEditTextCell(o,i,s)}}setColumnTrackNrByIndex(i){const t={},o={};for(const n of this.edits){const s=F(n);t[s]=(t[s]||0)+1}for(const n of this.edits){const s=F(n);o[s]=(o[s]||0)+1;const r=`${(o[s]||0).toString()}/${(t[s]||0).toString()}`;this.updateEditTextCell(n,i,r)}}addIndexToTitleCol(i){const t=this.columns.indexOf(i);this.edits.forEach((o,n)=>{const s=o.cells[t];let r=s.frames.length>0?s.frames[0].value.text:"";r=`${r} ${(n+1).toString()}`.trim(),this.updateEditTextCell(o,i,r)})}setColumnPartOfSet(i){const t=this.columns.indexOf(i),o=[];for(const n of this.edits)o.includes(n.track.parentID)||o.push(n.track.parentID);for(const n of this.edits){const r=`${(o.indexOf(n.cells[t].track.parentID)+1).toString()}/${o.length.toString()}`;this.updateEditTextCell(n,i,r)}}setColumnTotalTrack(i){const t={};for(const n of this.edits)t[n.track.parentID]=(t[n.track.parentID]||0)+1;const o=this.columns.indexOf(i);this.edits.forEach((n,s)=>{const r=n.cells[o];let c;r.frames.length>0?(c=r.frames[0].value.text.split("/")[0],isNaN(Number(c))||(c=Number(c).toString())):c=le(n.track.name),c||(c=(s+1).toString());const _=`${c||""}/${(t[n.track.parentID]||0).toString()}`;this.updateEditTextCell(n,i,_)})}setAlbumArtistFrames(i){const t=this.columns.findIndex(o=>"TPE1"===o.def.id);if(t>=0)for(const o of this.edits){const n=o.cells[t],s=n.frames.length>0?n.frames[0].value.text:void 0;s&&this.updateEditTextCell(o,i,s)}}setReleaseDateFromYearFrames(i){this.copyColumn(this.columns.findIndex(t=>"TYER"===t.def.id),i)}getCellText(i){return i.frames.length>0?i.frames[0].value.text:void 0}insertFromColumn(i,t,o){const n=this.columns.indexOf(o);if(i>=0)for(const s of this.edits){const r=this.getCellText(s.cells[i]),c=this.getCellText(s.cells[n])||"";if(r){const _=c.slice(0,t)+r+c.slice(t);this.updateEditTextCell(s,o,_)}}}copyColumn(i,t){if(i>=0)for(const o of this.edits){const n=o.cells[i],s=n.frames.length>0?n.frames[0].value.text:void 0;s&&this.updateEditTextCell(o,t,s)}}appendFromColumn(i,t){const o=this.columns.indexOf(t);if(i>=0)for(const n of this.edits){const s=this.getCellText(n.cells[i]);if(s){const r=this.getCellText(n.cells[o])||"";this.updateEditTextCell(n,t,r+s)}}}setColumnText(i,t){for(const o of this.edits)this.updateEditTextCell(o,i,t)}appendColumnText(i,t){const o=this.columns.indexOf(i);for(const n of this.edits){const s=this.getCellText(n.cells[o])||"";this.updateEditTextCell(n,i,s+t)}}setColumnFromTitleFrames(i){this.copyColumn(this.columns.findIndex(t=>"TIT2"===t.def.id),i)}clearColumn(i){const t=this.columns.indexOf(i);for(const o of this.edits)o.cells[t].frames.length>0&&(o.cells[t]={parent:o,track:o.cells[t].track,column:o.cells[t].column,frames:[],changed:!0},o.changed=!0)}findMissingLyrics(i=[]){var t=this;return(0,h.A)(function*(){const o=t.findOrAddColumn(i,{frameDef:M.USLT,id:"USLT"}),n=t.findOrAddColumn(i,{frameDef:M.TPE1,id:"TPE1"}),s=t.findOrAddColumn(i,{frameDef:M.TIT2,id:"TIT2"}),r=t.columns.indexOf(o),c=t.columns.indexOf(n),_=t.columns.indexOf(s);for(const p of t.edits)if(!t.getCellText(p.cells[r])){const C=t.getCellText(p.cells[c]),T=t.getCellText(p.cells[_]);if(T&&C){const O=yield t.jam.metadata.lyricsovhSearch({title:T,artist:C});O?.data?.lyrics&&t.updateEditTextCell(p,o,O.data.lyrics)}}})()}setAudiobookFrames(i=[]){const t=this.findOrAddColumn(i,{frameDef:M.TCON,id:"TCON"}),o=this.findOrAddColumn(i,{frameDef:M.TXXX,id:"TXXX",subid:"MusicBrainz Album Type"});for(const n of this.edits)this.updateEditTextCell(n,t,"Audiobook"),this.updateEditTextCell(n,o,"album/audiobook")}setAudioSeriesFrames(i=[]){const t=this.findOrAddColumn(i,{frameDef:M.TCON,id:"TCON"}),o=this.findOrAddColumn(i,{frameDef:M.TXXX,id:"TXXX",subid:"MusicBrainz Album Type"});for(const n of this.edits)this.updateEditTextCell(n,t,"Audio Series"),this.updateEditTextCell(n,o,"album/audiodrama")}setSoundtrackFrames(i=[]){const t=this.findOrAddColumn(i,{frameDef:M.TCON,id:"TCON"}),o=this.findOrAddColumn(i,{frameDef:M.TXXX,id:"TXXX",subid:"MusicBrainz Album Type"});for(const n of this.edits)this.updateEditTextCell(n,t,"Soundtrack"),this.updateEditTextCell(n,o,"album/soundtrack")}setVariousArtistFrames(i=[]){const t=this.findOrAddColumn(i,{frameDef:M.TXXX,id:"TXXX",subid:"MusicBrainz Album Type"}),o=this.findOrAddColumn(i,{frameDef:M.TXXX,id:"TXXX",subid:"MusicBrainz Album Artist Id"}),n=this.findOrAddColumn(i,{frameDef:M.TPE2,id:"TPE2"});for(const s of this.edits)this.updateEditTextCell(s,t,"album/compilation"),this.updateEditTextCell(s,n,w.tP),this.updateEditTextCell(s,o,w.Fm)}setBootlegFrames(i=[]){const t=this.findOrAddColumn(i,{frameDef:M.TXXX,id:"TXXX",subid:"MusicBrainz Album Status"}),o=this.findOrAddColumn(i,{frameDef:M.TXXX,id:"TXXX",subid:"MusicBrainz Album Type"});for(const n of this.edits)this.updateEditTextCell(n,t,"bootleg"),this.updateEditTextCell(n,o,"album/live")}build(i){this.edits=[],this.upgradeTrackTags(i),this.buildColumns(i),this.buildEdits(i)}upgradeTrackTags(i){for(const t of i)this.upgradeTrackTag(t)}upgradeTrackTag(i){const t=i.tagRaw;if(t&&void 0!==t.version&&t.version<4){let o=R.getRawTagFrames(t);const n={version:4,frames:{}},s=this.upgradeDateFramesTov24Date(o);s&&(o=o.filter(r=>!s.dateFrames.includes(r)),o.push(s.newFrame));for(const r of o){const c=this.ensureID3v2FrameVersionDef(r.id,4);c?(r.id=c,n.frames[c]=n.frames[c]||[],n.frames[c].push(r)):console.error("upgradeTrackTag","missing id3v2 update",r.id,"=>",c)}i.tagRaw=n}}ensureID3v2FrameVersionDef(i,t){const o=M[i];if(!o)return;if(o.versions.indexOf(t)>=0)return i;if(o.versions[0]>t){const r=Object.keys(M).find(_=>M[_].upgrade===i);if(!r)return void console.error(`ensureID3v2FrameVersionDef: Missing v2.${o.versions} -> v2.${t} mapping ${i}`);const c=M[r];return c.versions.indexOf(t)<0?c.versions[0]>t?this.ensureID3v2FrameVersionDef(r,t):void 0:r}if(!o.upgrade)return void console.error(`ensureID3v2FrameVersionDef: Missing v2.${o.versions} -> v2.${t} mapping ${i}`);const n=o.upgrade,s=M[n];return s.versions.indexOf(t)<0?s.versions[0]<t?this.ensureID3v2FrameVersionDef(n,t):void 0:n}upgradeDateFramesTov24Date(i){const t=i.find(c=>["TYER","TYE"].indexOf(c.id)>=0),o=i.find(c=>["TDAT","TDA"].indexOf(c.id)>=0),n=i.find(c=>["TIME","TIM"].indexOf(c.id)>=0);if(!t&&!o&&!n)return;const s=[],r=[];return t&&t.value&&Object.prototype.hasOwnProperty.call(t.value,"text")&&(s.push(t),r.push(t.value.text)),o&&o.value&&Object.prototype.hasOwnProperty.call(o.value,"text")&&(s.push(o),r.push(o.value.text)),n&&n.value&&Object.prototype.hasOwnProperty.call(n.value,"text")&&(s.push(n),r.push(n.value.text)),{newFrame:{id:"TDRC",value:{text:r.join("-")}},dateFrames:s}}findOrAddColumn(i,t){const o=this.columns.find(s=>s.def.id===t.id&&s.def.subid===t.subid);if(o)return o;const n=this.frameDef2Column(t.id,t.subid,t.frameDef,L.findIndex(s=>R.matchColumn({id:t.id,value:t.subid?{id:t.subid}:void 0},s)));return this.columns.push(n),this.buildEdits(i),n}updateColumns(i,t){const o=[],n=[];for(const s of this.columns)t.find(c=>c.id===s.def.id&&c.subid===s.def.subid)||o.push(s);for(const s of t)if(!this.columns.find(c=>c.def.id===s.id&&c.def.subid===s.subid)){const c=this.frameDef2Column(s.id,s.subid,s.frameDef,0);n.push(c)}this.columns=this.columns.filter(s=>!o.includes(s)).concat(n),this.buildEdits(i)}static getRawTagFrames(i){let t=[];return Object.keys(i.frames).forEach(o=>{t=t.concat(i.frames[o])}),t}static getFrameDefName(i,t,o){let n=o.title;const s=t||"";return o.impl===l.IdText?"TXXX"===i&&X[s]?n=X[s]:"UFID"===i&&x[s]?n=x[s]:t&&(n+=` (${t})`):o.impl===l.LangDescText?"COMM"===i&&B[s]?n=B[s]:t&&(n+=` (${t})`):o.impl===l.IdBin&&t&&(n+=` (${t})`),n}static matchColumn(i,t){return!!(!t.subid||i.value&&i.value.id&&i.value.id===t.subid)&&i.id===t.id}getAutoCompleteList(i,t){if("TCON"===i.def.id)return se;if("TXXX"===i.def.id&&"MusicBrainz Album Type"===i.def.subid)return["album","album/compilation","album/soundtrack","album/spokenword","album/interview","album/audiobook","album/audiodrama","album/live","album/remix","album/dj-mix","album/mixtape/street","single","ep","broadcast","other","other/spokenword","other/audiodrama","other/interview"];if("TXXX"===i.def.id&&"MusicBrainz Album Status"===i.def.subid)return["official","promotional","bootleg","pseudo-release"];if("TPOS"===i.def.id)return["1/1","1/2","2/2","1/3","2/3","3/3","1/4","2/4","3/4","4/4"];const o=this.columns.indexOf(i),n=[];for(const s of this.edits){const r=s.cells[o];if(r!==t&&r.frames.length>0&&r.frames[0].value&&r.frames[0].value.text){const c=r.frames[0].value.text;n.includes(c)||n.push(c)}}return"TPE2"===i.def.id&&!n.includes(w.tP)&&n.push(w.tP),n}setColumnActions(i,t,o,n){const s=[];[l.IdText,l.Text,l.LangDescText].includes(n)&&(i.multi=!0,"TRCK"===t?(s.push({icon:"icon-down-thin",title:"Set Track Nr by Index",click:()=>{this.setColumnTrackNrByIndex(i)}}),s.push({icon:"icon-down-thin",title:"Set Track Nr by Filename",click:()=>{this.setColumnTrackNrFromFile(i)}}),s.push({icon:"icon-down-thin",title:"Set Total Tracks",click:()=>{this.setColumnTotalTrack(i)}})):"TPOS"===t?s.push({icon:"icon-down-thin",title:"Try find Part of Set",click:()=>{this.setColumnPartOfSet(i)}}):"TIT2"===t?s.push({icon:"icon-down-thin",title:"Add Index Nr to Title",click:()=>{this.addIndexToTitleCol(i)}}):"TPE2"===t?s.push({icon:"icon-down-thin",title:"Copy from Artist Column",click:()=>{this.setAlbumArtistFrames(i)}}):"TALB"===t?s.push({icon:"icon-down-thin",title:"Copy from Title Column",click:()=>{this.setColumnFromTitleFrames(i)}}):"TDOR"===t?s.push({icon:"icon-down-thin",title:"Copy from Year Column",click:()=>{this.setReleaseDateFromYearFrames(i)}}):"USLT"===t&&s.push({icon:"icon-down-thin",title:"Search for missing Lyrics",click:()=>{this.findMissingLyrics().catch(r=>{console.error(r)})}})),n!==l.Filename?s.push({icon:"icon-remove",title:"Clear all Cells in this Column",click:()=>{this.clearColumn(i)}}):n===l.Filename&&s.push({icon:"icon-down-thin",title:"Set Filenames by Meta Data",click:()=>{this.setColumnFilenames(i)}}),i.actions=s}frameDef2Column(i,t,o,n){const s=R.getFrameDefName(i,t,o);let r=o.impl;"UFID"===i&&x[t||""]&&(r=l.IdText);const c={def:{id:i,subid:t,name:s,width:n>=0?L[n].width:100,impl:r},sort:n>=0?n+1:-1,actions:[]};return this.setColumnActions(c,i,t,r),c.getAutoCompleteList=_=>this.getAutoCompleteList(c,_),c}frame2Column(i,t){const o={def:{id:i.id,name:i.id+(i.value&&i.value.id?` - ${i.value.id}`:""),subid:i.value&&i.value.id?i.value.id:void 0,width:t>=0?L[t].width:100,impl:l.Unknown},sort:t,actions:[]};return o.getAutoCompleteList=n=>this.getAutoCompleteList(o,n),o}buildColumns(i){this.columns=[],i&&0!==i.length&&(L.forEach((t,o)=>{if(t.force){const n=this.frameDef2Column(t.id,t.subid,M[t.id],o);this.columns.push(n)}}),i.forEach(t=>{if(!t.tagRaw||!t.tagRaw.frames)return;const o=R.getRawTagFrames(t.tagRaw);o.unshift({id:I,value:{text:t.name}});for(const n of o)if(!this.columns.find(r=>R.matchColumn(n,r.def))){const r=M[n.id],c=L.findIndex(_=>R.matchColumn(n,_));if(r){let _;n.value&&void 0!==n.value.id&&(_=n.value.id),this.columns.push(this.frameDef2Column(n.id,_,M[n.id],c))}else this.columns.push(this.frame2Column(n,c))}}))}buildEdits(i){this.columns.sort((n,s)=>n.sort<0?1:s.sort<0?-1:n.sort-s.sort);const t=(n,s,r,c,_)=>this.columns.map(p=>{const d=_?_.cells.find(C=>C.column.def.id===p.def.id&&C.column.def.subid===p.def.subid):void 0;return{parent:c,track:n,tag:s,column:p,frames:d?d.frames:r.filter(C=>R.matchColumn(C,p.def)),changed:!!d&&d.changed}}),o=this.edits||[];this.edits=i.map(n=>{let s=[];s.push({id:I,value:{text:n.name}}),n.tagRaw&&Object.keys(n.tagRaw.frames).forEach(_=>{s=s.concat(n.tagRaw?.frames[_]||[])});const r=o.find(_=>_.track===n),c={track:n,tag:n.tagRaw,cells:[],editing:!1,changed:!!r&&r.changed,saving:!1};return c.cells=t(n,n.tagRaw,s,c,r),c})}}var e=m(4438),ce=m(4672),_e=m(9638),de=m(8726),ue=m(3427),pe=m(3299);const je=()=>({allowEmpty:!0});function He(a,i){if(1&a&&(e.j41(0,"app-autocomplete-option-header"),e.EFF(1),e.k0s()),2&a){const t=e.XpG().$implicit;e.R7$(),e.JRh(t.header)}}function ze(a,i){if(1&a&&(e.DNE(0,He,2,1,"app-autocomplete-option-header"),e.j41(1,"app-autocomplete-option",4),e.EFF(2),e.k0s()),2&a){const t=i.$implicit,o=e.XpG().control;e.vxM(0,t.header?0:-1),e.R7$(),e.Y8G("option",t)("control",o),e.R7$(),e.JRh(t.data.text)}}function Ve(a,i){1&a&&e.Z7z(0,ze,3,4,"app-autocomplete-option",4,e.fX1),2&a&&e.Dyx(i.control.options)}let U=(()=>{class a{list=[];focused=!1;edit="";standalone=!1;field="text";value="";data;getList;onAutoComplete;valueChange=new e.bkB;ngOnChanges(t){t.value&&t.value.currentValue&&t.value.currentValue!==this.edit&&(this.edit=t.value.currentValue)}autocompleteGetData(t){var o=this;return(0,h.A)(function*(){return 0===t.length?o.list.map(n=>({data:n})):o.list.filter(n=>n.text.includes(t)).map(n=>({data:n}))})()}autocompleteSelectResult(t){return this.edit=t.data.text,this.edit}autocompleteEnter(t){this.edit=t}onValueChange(){this.value!==this.edit&&this.valueChange.emit(this.edit)}onFocus(){this.focused=!0,void 0===this.edit&&(this.edit=""),this.getList&&(this.list=this.getList(this.data).map(t=>({text:t})))}onBlur(){this.focused=!1,this.list=[]}static \u0275fac=function(o){return new(o||a)};static \u0275cmp=e.VBU({type:a,selectors:[["app-tag-editor-autocomplete"]],inputs:{standalone:"standalone",field:"field",value:"value",data:"data",getList:"getList",onAutoComplete:"onAutoComplete"},outputs:{valueChange:"valueChange"},features:[e.OA$],decls:5,vars:10,consts:[["autocomplete","appAutocomplete"],["appAutocompleteContent",""],[1,"input-group"],["type","text","name","auto","autocomplete","off",3,"ngModelChange","change","focus","blur","value","appAutocomplete","appAutocompleteControl","appAutocompleteSettings","ngModel"],[3,"option","control"]],template:function(o,n){if(1&o){const s=e.RV6();e.j41(0,"app-autocomplete",null,0),e.DNE(2,Ve,2,0,"ng-template",1),e.k0s(),e.j41(3,"div",2)(4,"input",3),e.mxI("ngModelChange",function(c){return e.eBV(s),e.DH7(n.edit,c)||(n.edit=c),e.Njj(c)}),e.bIt("change",function(){return e.eBV(s),e.Njj(n.onValueChange())})("focus",function(){return e.eBV(s),e.Njj(n.onFocus())})("blur",function(){return e.eBV(s),e.Njj(n.onBlur())}),e.k0s()()}if(2&o){const s=e.sdS(1);e.R7$(3),e.AVh("focused",n.focused)("cell",!n.standalone),e.R7$(),e.Y8G("value",n.edit)("appAutocomplete",s)("appAutocompleteControl",n)("appAutocompleteSettings",e.lJ4(9,je)),e.R50("ngModel",n.edit)}},dependencies:[u.me,u.BC,u.vS,ce.s,_e.aP,de.r,ue.P,pe.I],styles:["[_nghost-%COMP%]{width:100%}[_nghost-%COMP%]   .input-group[_ngcontent-%COMP%]{height:100%;width:100%}[_nghost-%COMP%]   .input-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{height:100%;width:100%;background-color:var(--input);color:var(--on-input);border-radius:3px;padding-left:3px;padding-right:3px}[_nghost-%COMP%]   .input-group.cell[_ngcontent-%COMP%]{display:block;border:none}[_nghost-%COMP%]   .input-group.cell[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding-left:0;padding-right:0;border-radius:0;border:none;color:inherit;background-color:inherit}"],changeDetection:0})}return a})();const Ye=(a,i)=>i.title,Je=()=>({standalone:!0});function Ke(a,i){if(1&a){const t=e.RV6();e.j41(0,"div",0)(1,"label")(2,"input",1),e.mxI("ngModelChange",function(n){const s=e.eBV(t).$implicit;return e.DH7(s.enabled,n)||(s.enabled=n),e.Njj(n)}),e.k0s(),e.EFF(3),e.k0s(),e.j41(4,"app-tag-editor-autocomplete",2),e.mxI("valueChange",function(n){const s=e.eBV(t).$implicit;return e.DH7(s.value,n)||(s.value=n),e.Njj(n)}),e.k0s()()}if(2&a){const t=i.$implicit;e.R7$(2),e.Y8G("ngModelOptions",e.lJ4(6,Je)),e.R50("ngModel",t.enabled),e.R7$(),e.SpI(" ",t.title,""),e.R7$(),e.Y8G("getList",t.getList)("standalone",!0),e.R50("value",t.value)}}let ge=(()=>{class a{data;edit={title:{title:"Album Title",value:"",enabled:!0,autocomplete:[]},artist:{title:"Artist",value:"",enabled:!1,autocomplete:[]},albumArtist:{title:"Album Artist",value:"",enabled:!0,autocomplete:[]},originalReleaseTime:{title:"Original Release Time",value:"",enabled:!0,autocomplete:[]},recordingTime:{title:"Recording Time",value:"",enabled:!0,autocomplete:[]},genre:{title:"Genre",value:"",enabled:!0,autocomplete:[]},part:{title:"Part of Set",value:"",enabled:!0,autocomplete:[]},status:{title:"Album Status",value:"",enabled:!0,autocomplete:[]},type:{title:"Album Type",value:"",enabled:!0,autocomplete:[]}};edits=Object.keys(this.edit).map(t=>{const o=this.edit[t];return o.getList=()=>this.getAutoCompleteList(o),o});getAutoCompleteList(t){return t.autocomplete}dialogInit(t,o){this.data=o.data}static \u0275fac=function(o){return new(o||a)};static \u0275cmp=e.VBU({type:a,selectors:[["app-dialog-album"]],decls:4,vars:0,consts:[[1,"user-form-control"],["type","checkbox",3,"ngModelChange","ngModelOptions","ngModel"],[3,"valueChange","getList","standalone","value"]],template:function(o,n){1&o&&(e.j41(0,"div")(1,"form"),e.Z7z(2,Ke,5,7,"div",0,Ye),e.k0s()()),2&o&&(e.R7$(2),e.Dyx(n.edits))},dependencies:[u.qT,u.Zm,u.BC,u.cb,u.vS,u.cV,U],styles:["[_nghost-%COMP%]   .user-form-control[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]{width:100%}"]})}return a})();const qe=(a,i)=>i.id;function We(a,i){if(1&a){const t=e.RV6();e.j41(0,"div",7)(1,"div",8)(2,"label")(3,"input",9),e.mxI("ngModelChange",function(n){const s=e.eBV(t).$implicit;return e.DH7(s.checked,n)||(s.checked=n),e.Njj(n)}),e.bIt("change",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.checkChange())}),e.k0s(),e.EFF(4),e.k0s()(),e.j41(5,"div",10),e.EFF(6),e.k0s()()}if(2&a){const t=i.$implicit;e.R7$(3),e.Y8G("checked",t.checked),e.R50("ngModel",t.checked),e.R7$(),e.SpI(" ",t.name||t.frameDef.title," "),e.R7$(2),e.SpI(" ",t.id," ")}}let me=(()=>{class a{data;filteredColumns=[];allColumns=[];version=4;urls={2:"http://id3.org/id3v2-00",3:"http://id3.org/id3v2.3.0",4:"http://id3.org/id3v2.4.0-frames"};trackByFn(t,o){return o.id}checkChange(){this.setResult()}setResult(){this.data&&(this.data.resultColumns=this.filteredColumns.filter(t=>t.checked))}refresh(){this.filteredColumns=this.allColumns.filter(t=>t.frameDef.versions.includes(this.version)),this.setResult()}setVersion(t){this.version=t,this.refresh()}dialogInit(t,o){this.data=o.data,this.allColumns=[];const n=this.data?.columns||[];Object.keys(M).forEach(s=>{const r=function Be(a){return"TXXX"===a?Object.keys(X).map(i=>({subid:i,name:X[i]})):"UFID"===a?Object.keys(x).map(i=>({subid:i,name:x[i]})):"COMM"===a?Object.keys(B).map(i=>({subid:i,name:B[i]})):[]}(s);if(0===r.length){const c=n.find(_=>_.def.id===s);this.allColumns.push({id:s,frameDef:M[s],column:c,checked:!!c})}else for(const c of r){const _=n.find(p=>p.def.id===s&&p.def.subid===c.subid);this.allColumns.push({id:s,subid:c.subid,name:c.name,frameDef:M[s],column:_,checked:!!_})}}),this.allColumns=this.allColumns.sort((s,r)=>(s.name||s.frameDef.title).localeCompare(r.name||r.frameDef.title)),this.refresh()}static \u0275fac=function(o){return new(o||a)};static \u0275cmp=e.VBU({type:a,selectors:[["app-dialog-choose-columns"]],decls:20,vars:5,consts:()=>{let t;return t=$localize`:␟367a4acc6ee5c0c00dafae1ce57a32bed7ed035e␟2271963085536331910:ID3v2 Tag Version`,[t,[1,"choose-version"],[1,"select"],["type","radio","name","release",3,"click","checked"],["target","_blank","rel","noopener",3,"href"],[1,"icon-info"],[1,"columns"],[1,"column"],[1,"title"],["type","checkbox",3,"ngModelChange","change","checked","ngModel"],[1,"id"]]},template:function(o,n){1&o&&(e.j41(0,"form",1)(1,"fieldset")(2,"span"),e.pXf(3,0),e.k0s(),e.j41(4,"label",2)(5,"input",3),e.bIt("click",function(){return n.setVersion(4)}),e.k0s(),e.EFF(6," 2.4"),e.k0s(),e.j41(7,"label",2)(8,"input",3),e.bIt("click",function(){return n.setVersion(3)}),e.k0s(),e.EFF(9," 2.3"),e.k0s(),e.j41(10,"label",2)(11,"input",3),e.bIt("click",function(){return n.setVersion(2)}),e.k0s(),e.EFF(12," 2.2"),e.k0s(),e.nrm(13,"br"),e.j41(14,"a",4),e.nrm(15,"i",5),e.EFF(16),e.k0s()()(),e.j41(17,"div",6),e.Z7z(18,We,7,4,"div",7,qe),e.k0s()),2&o&&(e.R7$(5),e.Y8G("checked",4===n.version),e.R7$(3),e.Y8G("checked",3===n.version),e.R7$(3),e.Y8G("checked",2===n.version),e.R7$(3),e.Y8G("href",n.urls[n.version],e.B4B),e.R7$(2),e.SpI(" ",n.urls[n.version],""),e.R7$(2),e.Dyx(n.filteredColumns))},dependencies:[u.qT,u.Zm,u.BC,u.cb,u.vS,u.cV],styles:["[_nghost-%COMP%]   .choose-version[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{margin-left:15px}[_nghost-%COMP%]   .choose-version[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{font-size:.8em}[_nghost-%COMP%]   .columns[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap}[_nghost-%COMP%]   .column[_ngcontent-%COMP%]{width:33%;border-top-width:1px;border-top-style:solid;border-bottom-width:0;border-bottom-style:solid;border-color:var(--control-border);padding-top:5px;padding-bottom:5px;padding-right:15px;display:flex;flex-flow:row nowrap;align-items:center;font-size:.8em}[_nghost-%COMP%]   .column[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{color:var(--on-control-hover)}[_nghost-%COMP%]   .column[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.8em;color:var(--on-control)}[_nghost-%COMP%]   .column[_ngcontent-%COMP%]   .id[_ngcontent-%COMP%]{margin-left:auto;width:80px;padding-right:15px;text-align:right;font-size:.8em}[_nghost-%COMP%]   .column[_ngcontent-%COMP%]:last-child{border-bottom-width:1px}@media (max-width: 1400px){[_nghost-%COMP%]   .column[_ngcontent-%COMP%]{width:50%}}@media (max-width: 768px){[_nghost-%COMP%]   .column[_ngcontent-%COMP%]{width:100%}}"]})}return a})(),J=(()=>{class a{data;unsubscribe=new V.B;dialogInit(t,o){this.data=o.data,this.data&&(this.data.close=()=>{t.close()}),t.beforeClose().pipe((0,G.Q)(this.unsubscribe)).subscribe(()=>{this.data=void 0})}ngOnDestroy(){this.unsubscribe.next(),this.unsubscribe.complete()}static \u0275fac=function(o){return new(o||a)};static \u0275cmp=e.VBU({type:a,selectors:[["app-dialog-match-release"]],decls:1,vars:1,consts:[[3,"data"]],template:function(o,n){1&o&&e.nrm(0,"app-match-release",0),2&o&&e.Y8G("data",n.data)}})}return a})();var N=m(1312),he=m(3048),Qe=m(8723),Ze=m(2415),Te=m(3830),Ce=m(6721);const et=["inputEl"];let fe=(()=>{class a{original="";val="";cell;navigKeyDownRequest=new e.bkB;navigBlur=new e.bkB;navigChange=new e.bkB;input;ngOnChanges(){this.changeCell(this.cell)}onNavigKeyDown(t){this.cell&&this.navigKeyDownRequest.emit({cell:this.cell,event:t})}changeCell(t){t&&(this.original=0!==t.frames.length&&t.frames[0].value&&t.frames[0].value.text?this.original=t.frames[0].value.text:"",this.val=this.original)}ngAfterViewInit(){setTimeout(()=>{this.input?.nativeElement&&this.input.nativeElement.focus()},0)}onEnter(){this.onChange(),this.navigBlur.emit()}onChange(){this.cell&&this.val!==this.original&&(0===this.cell.frames.length&&this.cell.frames.push({id:this.cell.column.def.id,value:{id:this.cell.column.def.subid,text:this.val}}),this.cell.frames[0].value.text=this.val,this.navigChange.emit())}onBlur(){this.onChange(),this.navigBlur.emit()}autocompleteEnter(t){this.val=t}autocompleteGetData(t){return(0,h.A)(function*(){return[]})()}autocompleteSelectResult(t){return this.val=t.data,this.val}static \u0275fac=function(o){return new(o||a)};static \u0275cmp=e.VBU({type:a,selectors:[["app-cell-editor-txt"]],viewQuery:function(o,n){if(1&o&&e.GBs(et,7),2&o){let s;e.mGM(s=e.lsd())&&(n.input=s.first)}},inputs:{cell:"cell"},outputs:{navigKeyDownRequest:"navigKeyDownRequest",navigBlur:"navigBlur",navigChange:"navigChange"},features:[e.OA$],decls:2,vars:1,consts:[["inputEl",""],["type","text","autocomplete","off",3,"ngModelChange","blur","keydown.enter","ngModel"]],template:function(o,n){if(1&o){const s=e.RV6();e.j41(0,"input",1,0),e.mxI("ngModelChange",function(c){return e.eBV(s),e.DH7(n.val,c)||(n.val=c),e.Njj(c)}),e.bIt("blur",function(){return e.eBV(s),e.Njj(n.onBlur())})("keydown.enter",function(){return e.eBV(s),e.Njj(n.onEnter())}),e.k0s()}2&o&&e.R50("ngModel",n.val)},dependencies:[u.me,u.BC,u.vS],styles:["[_nghost-%COMP%]{width:100%;height:100%}[_nghost-%COMP%]   input[_ngcontent-%COMP%]{width:100%;height:100%;text-align:left}"]})}return a})();function tt(a,i){if(1&a){const t=e.RV6();e.j41(0,"image-cropper",5),e.bIt("cropperReady",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.cropperReady())})("loadImageFailed",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.loadImageFailed())})("imageLoaded",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.imageLoaded())})("imageCropped",function(n){e.eBV(t);const s=e.XpG();return e.Njj(s.imageCropped(n))}),e.k0s()}if(2&a){const t=e.XpG();e.Y8G("maintainAspectRatio",t.maintainAspectRatio)("format","jpeg")("imageBase64",t.current.source)}}let Me=(()=>{class a{edit;maintainAspectRatio=!0;current={};dialogInit(t,o){this.edit=o.data,this.edit&&(this.edit.result=this.edit.frames.map(n=>({id:n.id,value:{...n.value}})),this.edit.result.length>0&&this.displayFrame(this.edit.result[0]))}displayFrame(t){const o=`data:${t.value.mimeType||"image/jpeg"};base64,${t.value.bin}`;this.current.frame=t,this.current.source=o}onDropFile(t){t.preventDefault(),this.uploadFile(t.dataTransfer?.files)}selectFile(t){this.uploadFile(t.target.files)}onDragOverFile(t){t.stopPropagation(),t.preventDefault()}splitBase64(t){return{mimeType:t.slice(5,t.indexOf(";")),base64:t.slice(t.indexOf("base64,")+7)}}buildFrame(t){const{mimeType:o,base64:n}=this.splitBase64(t);return{id:"APIC",value:{mimeType:o,description:"",bin:n,pictureType:3}}}uploadFile(t){if(!t||0===t.length)return;const o=t[0],n=new FileReader;n.readAsDataURL(o),n.onload=s=>{const r=s.target.result;this.current.frame||(this.current.frame=this.buildFrame(r),this.edit?.result&&this.edit.result.push(this.current.frame)),this.current.source=r;const{mimeType:c,base64:_}=this.splitBase64(r);this.current.frame.value.mimeType=c,this.current.frame.value.bin=_},n.onerror=s=>{console.error(s)}}loadImageFailed(){}cropperReady(){}imageLoaded(){}imageCropped(t){if(this.current?.frame&&t.base64){const{mimeType:o,base64:n}=this.splitBase64(t.base64);this.current.frame.value.mimeType=o,this.current.frame.value.bin=n}}static \u0275fac=function(o){return new(o||a)};static \u0275cmp=e.VBU({type:a,selectors:[["app-dialog-tag-image"]],decls:8,vars:3,consts:()=>{let t,o;return t=$localize`:␟d833321cc90a0b0a52714c6d5ec97fbe6c7cfa5c␟2501989539336327542:Upload image`,o=$localize`:␟9adf24384bd663ce0cf256940aae864e83991330␟6234579371454134968:Maintain Aspect Ratio`,[o,["type","checkbox",3,"ngModelChange","checked","ngModel"],[1,"drop-zone",3,"drop","dragover"],[3,"maintainAspectRatio","format","imageBase64"],["type","file","placeholder",t,"accept",".png,.jpeg,.jpg",3,"change"],[3,"cropperReady","loadImageFailed","imageLoaded","imageCropped","maintainAspectRatio","format","imageBase64"]]},template:function(o,n){1&o&&(e.j41(0,"label")(1,"input",1),e.mxI("ngModelChange",function(r){return e.DH7(n.maintainAspectRatio,r)||(n.maintainAspectRatio=r),r}),e.k0s(),e.qex(2),e.pXf(3,0),e.bVm(),e.k0s(),e.j41(4,"div",2),e.bIt("drop",function(r){return n.onDropFile(r)})("dragover",function(r){return n.onDragOverFile(r)}),e.DNE(5,tt,1,3,"image-cropper",3),e.j41(6,"form")(7,"input",4),e.bIt("change",function(r){return n.selectFile(r)}),e.k0s()()()),2&o&&(e.R7$(),e.Y8G("checked",n.maintainAspectRatio),e.R50("ngModel",n.maintainAspectRatio),e.R7$(4),e.vxM(5,n.current.source?5:-1))},dependencies:[u.qT,u.Zm,u.BC,u.cb,u.vS,u.cV,oe._D],styles:["[_nghost-%COMP%]   .drop-zone[_ngcontent-%COMP%]{padding:10px 20px;border-width:2px;border-style:dotted;border-color:var(--secondary)}"]})}return a})();function nt(a,i){if(1&a){const t=e.RV6();e.j41(0,"textarea",1),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.currentLyrics.value.text,n)||(s.currentLyrics.value.text=n),e.Njj(n)}),e.k0s()}if(2&a){const t=e.XpG();e.R50("ngModel",t.currentLyrics.value.text)}}let Oe=(()=>{class a{edit;currentLyrics;dialogInit(t,o){this.edit=o.data,this.edit&&(this.edit.result=this.edit.frames.map(n=>({id:n.id,value:{...n.value}})),0===this.edit.result.length&&this.edit.result.push({id:"USLT",value:{id:"",language:"",text:""}}),this.currentLyrics=this.edit.result[0])}static \u0275fac=function(o){return new(o||a)};static \u0275cmp=e.VBU({type:a,selectors:[["app-dialog-tag-lyrics"]],decls:1,vars:1,consts:()=>{let t,o;return t=$localize`:␟037aa3ea211cc632fa094de77aaefe2ab6e097a2␟6110089012347909146:off`,o=$localize`:␟037aa3ea211cc632fa094de77aaefe2ab6e097a2␟6110089012347909146:off`,[["autocomplete","off","autocorrect",t,"autocapitalize",o,"spellcheck","false",3,"ngModel"],["autocomplete","off","autocorrect",t,"autocapitalize",o,"spellcheck","false",3,"ngModelChange","ngModel"]]},template:function(o,n){1&o&&e.DNE(0,nt,1,1,"textarea",0),2&o&&e.vxM(0,n.currentLyrics?0:-1)},dependencies:[u.me,u.BC,u.vS],styles:["[_nghost-%COMP%]   textarea[_ngcontent-%COMP%]{width:100%;height:100%}"]})}return a})();function it(a,i){if(1&a&&(e.j41(0,"div",0),e.EFF(1),e.k0s()),2&a){const t=i.$implicit;e.Y8G("title",t),e.R7$(),e.JRh(t)}}let Ee=(()=>{class a{lines;static \u0275fac=function(o){return new(o||a)};static \u0275cmp=e.VBU({type:a,selectors:[["app-cell-editor-display"]],inputs:{lines:"lines"},decls:2,vars:0,consts:[[3,"title"]],template:function(o,n){1&o&&e.Z7z(0,it,2,2,"div",0,e.Vm6),2&o&&e.Dyx(n.lines)},styles:["[_nghost-%COMP%]   div[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;text-align:left;padding-left:6px;padding-right:6px}"],changeDetection:0})}return a})();const ot=["cellContainer"];function at(a,i){if(1&a&&e.nrm(0,"app-cell-editor-display",1),2&a){const t=e.XpG();e.Y8G("lines",t.lines)}}function st(a,i){1&a&&e.eu8(0,null,0)}let Pe=(()=>{class a extends Y{dialogOverlay;resolver;cell=void 0;navigKeyDownRequest=new e.bkB;lines=[];inactive=!0;container;unsubscribe=new V.B;componentRef;constructor(t,o){super(),this.dialogOverlay=t,this.resolver=o}ngOnDestroy(){this.clearEdit(),this.unsubscribe.next(),this.unsubscribe.complete()}clickEvent(){this.edit()}onCellEditorNavigationKeyDown(t){this.navigKeyDownRequest.emit(t)}ngOnChanges(t){t.cell&&this.display()}navigTo(){}static picFrameToString(t){return Fe[t.value.pictureType]||"image"}static popularimeterFrameToString(t){return`${t.value.rating} - ${t.value.email} - ${t.value.count}`}static boolFrameToString(t){return`${t.value.bool}`}static textListFrameToString(t){return t.value.list.join("\n")}static textFrameToString(t){return t.value.text}static idTextFrameToString(t){return t.value.text}static playCounterFrameToString(t){return`${t.value.num}`}static geobFrameToString(t){return`Binary ${t.value&&t.value.bin?t.value.bin.length:0} bytes`}static idBinFrameToString(t){return`Binary ${t.value&&t.value.bin?t.value.bin.length:0} bytes`}static langDescFrameToString(t){return t.value.text}edit(){switch(this.cell?.column.def.impl){case l.Filename:case l.IdText:case l.LangDescText:case l.Text:"USLT"===this.cell.column.def.id?this.editLyrics():this.startEdit(fe);break;case l.Bool:this.editBool();break;case l.Pic:this.editPictures()}}startEdit(t){this.inactive&&(this.inactive=!1,setTimeout(()=>{this.createComponent(t),this.componentRef&&(this.componentRef.instance.cell=this.cell,this.componentRef.instance.ngOnChanges&&this.componentRef.instance.ngOnChanges({cell:{current:this.cell}}),this.componentRef.instance.navigBlur&&this.componentRef.instance.navigBlur.pipe((0,G.Q)(this.unsubscribe)).subscribe(()=>{this.clearEdit(),this.inactive=!0}),this.componentRef.instance.navigChange&&this.componentRef.instance.navigChange.pipe((0,G.Q)(this.unsubscribe)).subscribe(()=>{this.setChanged()}))}))}clearEdit(){this.componentRef&&this.componentRef.destroy(),this.container&&this.container.clear()}createComponent(t){if(this.clearEdit(),this.container){const o=this.resolver.resolveComponentFactory(t);this.componentRef=this.container.createComponent(o)}}editBool(){this.cell&&(0===this.cell.frames.length&&this.cell.frames.push({id:this.cell.column.def.id,value:{bool:!1}}),this.cell.frames[0].value.bool=!this.cell.frames[0].value.bool,this.setChanged())}setChanged(){this.cell&&(this.cell.changed=!0,this.cell.parent.changed=!0,this.display())}editPictures(){var t=this;const o=this.cell;if(o){const n={frames:o.frames};this.dialogOverlay.open({title:"Tag Pictures",childComponent:Me,data:n,onOkBtn:(s=(0,h.A)(function*(){return o.frames=n.result||[],t.setChanged(),Promise.resolve()}),function(){return s.apply(this,arguments)}),onCancelBtn:function(){var s=(0,h.A)(function*(){return Promise.resolve()});return function(){return s.apply(this,arguments)}}()})}var s}editLyrics(){var t=this;const o=this.cell;if(o){const n={frames:o.frames};this.dialogOverlay.open({title:"Tag Lyrics",childComponent:Oe,data:n,panelClass:"overlay-panel-large-buttons",onOkBtn:(s=(0,h.A)(function*(){return o.frames=n.result?n.result.filter(r=>r.value.text.length>0):[],t.setChanged(),Promise.resolve()}),function(){return s.apply(this,arguments)}),onCancelBtn:function(){var s=(0,h.A)(function*(){return Promise.resolve()});return function(){return s.apply(this,arguments)}}()})}var s}display(){this.lines=this.cell?this.cell.frames.map(t=>this.frameToString(t)):[]}frameToString(t){switch(this.cell?.column.def.impl){case l.Filename:case l.Text:return a.textFrameToString(t);case l.LangDescText:return a.langDescFrameToString(t);case l.IdText:return a.idTextFrameToString(t);case l.Pic:return a.picFrameToString(t);case l.TextList:return a.textListFrameToString(t);case l.IdBin:return a.idBinFrameToString(t);case l.GEOB:return a.geobFrameToString(t);case l.Bool:return a.boolFrameToString(t);case l.Popularimeter:return a.popularimeterFrameToString(t);case l.PlayCounter:return a.playCounterFrameToString(t);default:return`TODO CELLEDITOR: ${this.cell?.column.def.name}`}}static \u0275fac=function(o){return new(o||a)(e.rXU(he.iD),e.rXU(e.OM3))};static \u0275cmp=e.VBU({type:a,selectors:[["app-cell-editor"]],viewQuery:function(o,n){if(1&o&&e.GBs(ot,5,e.c1b),2&o){let s;e.mGM(s=e.lsd())&&(n.container=s.first)}},hostBindings:function(o,n){1&o&&e.bIt("click",function(r){return n.clickEvent(r)})},inputs:{cell:"cell"},outputs:{navigKeyDownRequest:"navigKeyDownRequest"},features:[e.Jv_([{provide:Y,useExisting:(0,e.Rfq)(()=>a)}]),e.Vt3,e.OA$],decls:2,vars:2,consts:[["cellContainer",""],[3,"lines"]],template:function(o,n){1&o&&e.DNE(0,at,1,1,"app-cell-editor-display",1)(1,st,2,0,"ng-container"),2&o&&(e.vxM(0,n.inactive?0:-1),e.R7$(),e.vxM(1,n.inactive?-1:1))},dependencies:[Ee]})}return a})();const rt=(a,i)=>i.def.id,lt=(a,i)=>i.title;function ct(a,i){if(1&a){const t=e.RV6();e.j41(0,"div",15),e.qex(1),e.pXf(2,5),e.bVm(),e.j41(3,"div",16)(4,"app-tag-editor-autocomplete",22),e.mxI("valueChange",function(n){e.eBV(t);const s=e.XpG(2);return e.DH7(s.multiStr,n)||(s.multiStr=n),e.Njj(n)}),e.k0s()(),e.j41(5,"button",19),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2);return e.Njj(n.editor.setColumnText(n.activeCol,n.multiStr))}),e.pXf(6,6),e.k0s(),e.j41(7,"button",19),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2);return e.Njj(n.editor.appendColumnText(n.activeCol,n.multiStr))}),e.pXf(8,7),e.k0s(),e.j41(9,"button",19),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2);return e.Njj(n.editor.removeColumnText(n.activeCol,n.multiStr))}),e.pXf(10,8),e.k0s()()}if(2&a){const t=e.XpG(2);e.R7$(4),e.Y8G("getList",t.activeCol.getAutoCompleteList),e.R50("value",t.multiStr)}}function _t(a,i){if(1&a&&(e.j41(0,"option",18),e.EFF(1),e.k0s()),2&a){const t=i.$implicit;e.Y8G("value",i.$index),e.R7$(),e.JRh(t.def.name)}}function dt(a,i){if(1&a){const t=e.RV6();e.j41(0,"div",15),e.EFF(1),e.nrm(2,"br"),e.j41(3,"button",19),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.click())}),e.nrm(4,"i",23),e.k0s()()}if(2&a){const t=i.$implicit;e.R7$(),e.SpI(" ",t.title,"")}}function ut(a,i){if(1&a){const t=e.RV6();e.j41(0,"div",9)(1,"div",10)(2,"div",11)(3,"a",12),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.close())})("keydown.enter",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.close())}),e.nrm(4,"i",13),e.k0s()(),e.qex(5),e.pXf(6,0),e.bVm(),e.j41(7,"span"),e.EFF(8),e.k0s()(),e.j41(9,"div",14),e.DNE(10,ct,11,2,"div",15),e.j41(11,"div",15),e.qex(12),e.pXf(13,1),e.bVm(),e.j41(14,"div",16)(15,"select",17),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.sourceColumnIndex,n)||(s.sourceColumnIndex=n),e.Njj(n)}),e.Z7z(16,_t,2,2,"option",18,rt),e.k0s()(),e.j41(18,"button",19),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.editor.copyColumn(n.sourceColumnIndex,n.activeCol))}),e.pXf(19,2),e.k0s(),e.j41(20,"button",19),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.editor.appendFromColumn(n.sourceColumnIndex,n.activeCol))}),e.pXf(21,3),e.k0s(),e.j41(22,"div",20)(23,"button",19),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.editor.insertFromColumn(n.sourceColumnIndex,0,n.activeCol))}),e.pXf(24,4),e.k0s(),e.nrm(25,"input",21),e.k0s()(),e.Z7z(26,dt,5,1,"div",15,lt),e.k0s()()}if(2&a){const t=e.XpG();e.R7$(8),e.JRh(t.activeCol.def.name),e.R7$(2),e.vxM(10,t.activeCol.multi?10:-1),e.R7$(5),e.R50("ngModel",t.sourceColumnIndex),e.R7$(),e.Dyx(t.editor.columns),e.R7$(10),e.Dyx(t.activeCol.actions)}}let Se=(()=>{class a{editor;activeCol;requestClose=new e.bkB;sourceColumnIndex=0;multiStr="";close(){this.requestClose.emit()}static \u0275fac=function(o){return new(o||a)};static \u0275cmp=e.VBU({type:a,selectors:[["app-admin-tag-editor-column-tool"]],inputs:{editor:"editor",activeCol:"activeCol"},outputs:{requestClose:"requestClose"},decls:1,vars:1,consts:()=>{let t,o,n,s,r,c,_,p,d,C;return t=$localize`:␟f4e529ae5ffd73001d1ff4bbdeeb0a72e342e5c8␟7819314041543176992:Close`,o=$localize`:␟d731f73de19f7407b321fce2ff8de9425d72c662␟1607698600866936391:Current Column:`,n=$localize`:␟37b491bdf12da2468699e357868ea7284bbeb61d␟5804004197558421795:Column Source`,s=$localize`:␟1979da7460819153e11d2078244645d94291b69c␟4323470180912194028:Copy`,r=$localize`:␟0d03d787306410e77e4703cc6da4486836dec357␟7771562252675241359:Append`,c=$localize`:␟e97cdb4e187e8c55422b6e55c4285b93e2570553␟6908115012584116794:Insert at`,_=$localize`:␟8fd7e975ff82c96b835d595a37b7c823e0e6b047␟6476905889975409604:Column Text`,p=$localize`:␟55dd9f44e64851bca3b7bfc9283a5ff36f030228␟4359847060009771702:Set`,d=$localize`:␟0d03d787306410e77e4703cc6da4486836dec357␟7771562252675241359:Append`,C=$localize`:␟019d4bd6a5690f0cfa0ecf346a4e6bf7f0d8debb␟4814285799071780083:Remove`,[o,n,s,r,c,_,p,d,C,[1,"column-tools"],[1,"column-tools-title"],[1,"close-panel"],["tabindex","0","title",t,1,"close",3,"click","keydown.enter"],["aria-hidden","true"],[1,"column-tool-content"],[1,"column-tool"],[1,"input-box"],[3,"ngModelChange","ngModel"],[3,"value"],[1,"button-on-background",3,"click"],[1,"button-with-add-on","button-insert-at"],["type","number"],[3,"valueChange","getList","value"],[1,"icon-down-thin"]]},template:function(o,n){1&o&&e.DNE(0,ut,28,3,"div",9),2&o&&e.vxM(0,n.activeCol&&n.editor?0:-1)},dependencies:[u.xH,u.y7,u.wz,u.BC,u.vS,U],styles:['[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]{border:1px solid var(--control-border);padding-bottom:15px}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .close-panel[_ngcontent-%COMP%]{float:right;display:inline-block;overflow:hidden;width:2.5rem;height:2.5rem;max-width:2.5rem;max-height:2.5rem;margin-top:-15px}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .close-panel[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:2.5rem;height:2.5rem;border:none;background-color:transparent;font-size:1.5rem;transition:.25s linear}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .close-panel[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]:before, [_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .close-panel[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]:after{position:absolute;content:"";width:.75rem;height:.125rem;background-color:var(--on-control-hover);overflow:hidden}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .close-panel[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]:before{transform:rotate(-45deg)}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .close-panel[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]:after{transform:rotate(45deg)}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .close-panel[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]:hover{transform:rotate(360deg)}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .close-panel[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]:hover:before, [_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .close-panel[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]:hover:after{background-color:var(--accent)}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .column-tools-title[_ngcontent-%COMP%]{padding-top:15px;padding-left:15px;padding-right:15px}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .column-tools-title[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--on-control-active)}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .input-box[_ngcontent-%COMP%]{border-radius:3px;padding-left:3px;padding-right:3px;align-items:center;background-color:var(--input);border:1px solid var(--input-border)}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .input-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{flex:1;border:none;min-height:20px;background-color:var(--input);color:var(--on-input)}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .input-box[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:var(--on-input);font-size:14px;cursor:pointer}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .input-box[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]:hover{color:var(--on-input-hover)}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .input-box[_ngcontent-%COMP%]{display:flex}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .button-insert-at[_ngcontent-%COMP%]{display:inline-flex}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .button-insert-at[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:50px;border-color:var(--on-control-ambient)}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   app-tag-editor-autocomplete[_ngcontent-%COMP%]{flex:1;border:none;min-height:24px;height:24px;background-color:var(--input);color:var(--on-input)}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{flex:1;border:none;height:24px;background-color:var(--input);color:var(--on-input);width:100%}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .column-tool-content[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}[_nghost-%COMP%]   .column-tools[_ngcontent-%COMP%]   .column-tool[_ngcontent-%COMP%]{padding:15px 15px 0;font-size:.8em;align-self:center}']})}return a})();const pt=["actionMenu"],Re=(a,i)=>i.def.id+i.def.subid,gt=(a,i)=>i.track.id,mt=(a,i)=>i.column.def.id+i.column.def.subid;function ht(a,i){1&a&&e.nrm(0,"app-loading")}function Tt(a,i){1&a&&(e.nrm(0,"i",11),e.qex(1),e.pXf(2,1),e.bVm())}function Ct(a,i){1&a&&(e.nrm(0,"i",11),e.qex(1),e.pXf(2,2),e.bVm())}function ft(a,i){1&a&&(e.nrm(0,"i",11),e.qex(1),e.pXf(2,3),e.bVm())}function Mt(a,i){1&a&&(e.nrm(0,"i",11),e.qex(1),e.pXf(2,4),e.bVm())}function Ot(a,i){1&a&&(e.nrm(0,"i",11),e.qex(1),e.pXf(2,5),e.bVm())}function Et(a,i){1&a&&(e.nrm(0,"i",11),e.qex(1),e.pXf(2,6),e.bVm())}function Pt(a,i){if(1&a){const t=e.RV6();e.j41(0,"div",12),e.qex(1),e.pXf(2,7),e.bVm(),e.nrm(3,"br"),e.qex(4),e.pXf(5,8),e.bVm(),e.nrm(6,"br"),e.j41(7,"button",16),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2);return e.Njj(n.loadRecursive())}),e.nrm(8,"i",17),e.qex(9),e.pXf(10,9),e.bVm(),e.k0s()()}}function St(a,i){if(1&a){const t=e.RV6();e.j41(0,"button",26),e.bIt("click",function(){e.eBV(t);const n=e.XpG(3);return e.Njj(n.save())}),e.nrm(1,"i",27),e.k0s()}}function Rt(a,i){1&a&&(e.j41(0,"button",24),e.nrm(1,"i",28),e.k0s())}function At(a,i){if(1&a){const t=e.RV6();e.j41(0,"div",13)(1,"button",18),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2);return e.Njj(n.refresh())}),e.nrm(2,"i",17),e.k0s(),e.j41(3,"button",19),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2);return e.Njj(n.brainz())}),e.nrm(4,"app-mb-icon",20),e.k0s(),e.j41(5,"button",21),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2);return e.Njj(n.chooseColumns())}),e.nrm(6,"i",22),e.k0s(),e.DNE(7,St,2,0,"button",23)(8,Rt,2,0,"button",24),e.j41(9,"button",25),e.bIt("click",function(n){e.eBV(t);const s=e.XpG(2);return e.Njj(s.onContextMenu(n))}),e.EFF(10,"\u2026"),e.k0s()()}if(2&a){const t=e.XpG(2);e.R7$(4),e.Y8G("size",12),e.R7$(3),e.vxM(7,t.isSaving?-1:7),e.R7$(),e.vxM(8,t.isSaving?8:-1)}}function bt(a,i){1&a&&e.nrm(0,"app-loading")}function Nt(a,i){if(1&a){const t=e.RV6();e.j41(0,"th",32),e.bIt("click",function(){const n=e.eBV(t).$implicit,s=e.XpG(3);return e.Njj(s.activeCol=n)}),e.j41(1,"div")(2,"span",33),e.EFF(3),e.k0s()()()}if(2&a){const t=i.$implicit;e.R7$(2),e.Y8G("title",t.def.id),e.R7$(),e.JRh(t.def.name)}}function vt(a,i){1&a&&e.nrm(0,"col"),2&a&&e.xc7("min-width",i.$implicit.def.width||60,"px")}function Dt(a,i){if(1&a){const t=e.RV6();e.j41(0,"i",37),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2).$implicit,s=e.XpG(3);return e.Njj(s.saveEdit(n))}),e.k0s()}}function It(a,i){1&a&&e.nrm(0,"i",36)}function kt(a,i){if(1&a&&e.DNE(0,Dt,1,0,"i",27)(1,It,1,0,"i",36),2&a){const t=e.XpG().$implicit;e.vxM(0,t.saving?-1:0),e.R7$(),e.vxM(1,t.saving?1:-1)}}function xt(a,i){if(1&a){const t=e.RV6();e.j41(0,"td")(1,"app-cell-editor",38),e.bIt("navigKeyDownRequest",function(n){e.eBV(t);const s=e.XpG(4);return e.Njj(s.onCellEditorNavigationKeyDown(n))}),e.k0s()()}if(2&a){const t=i.$implicit;e.R7$(),e.AVh("changed",t.changed),e.Y8G("cell",t)}}function Lt(a,i){if(1&a&&(e.j41(0,"tr")(1,"td",34)(2,"div",35),e.DNE(3,kt,2,2),e.k0s()(),e.Z7z(4,xt,2,3,"td",null,mt),e.k0s()),2&a){const t=i.$implicit;e.R7$(3),e.vxM(3,t.changed?3:-1),e.R7$(),e.Dyx(t.cells)}}function yt(a,i){if(1&a&&(e.j41(0,"div",15)(1,"table")(2,"thead")(3,"tr",29),e.nrm(4,"th"),e.Z7z(5,Nt,4,2,"th",30,Re),e.k0s()(),e.j41(7,"colgroup"),e.nrm(8,"col"),e.Z7z(9,vt,1,2,"col",31,Re),e.k0s(),e.j41(11,"tbody"),e.Z7z(12,Lt,6,1,"tr",null,gt),e.k0s()()()),2&a){const t=e.XpG(2);e.R7$(5),e.Dyx(t.editor.columns),e.R7$(3),e.xc7("min-width",40,"px"),e.R7$(),e.Dyx(t.editor.columns),e.R7$(3),e.Dyx(t.editor.edits)}}function Gt(a,i){if(1&a){const t=e.RV6();e.DNE(0,Pt,11,0,"div",12)(1,At,11,3,"div",13),e.j41(2,"app-admin-tag-editor-column-tool",14),e.bIt("requestClose",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.activeCol=void 0)}),e.k0s(),e.DNE(3,bt,1,0,"app-loading")(4,yt,14,2,"div",15)}if(2&a){const t=e.XpG();e.vxM(0,t.canLoadRecursive?0:-1),e.R7$(),e.vxM(1,t.tracks&&t.tracks.length>0&&t.editor.edits?1:-1),e.R7$(),e.Y8G("editor",t.editor)("activeCol",t.activeCol),e.R7$(),e.vxM(3,t.tracks?-1:3),e.R7$(),e.vxM(4,t.tracks&&t.tracks.length>0&&t.editor.edits?4:-1)}}let K=(()=>{class a{app;folderService;contextMenuService;jam;notify;dialogOverlay;folder;tracks;editor;canLoadRecursive=!1;activeCol;isSaving=!1;id;cellEditors;actionMenu;constructor(t,o,n,s,r,c){this.app=t,this.folderService=o,this.contextMenuService=n,this.jam=s,this.notify=r,this.dialogOverlay=c,this.editor=new R(s)}onScroll(){}canDeactivate(){return!this.isSaving}ngOnChanges(){this.refresh()}refresh(){this.folder=void 0,this.tracks=void 0,this.activeCol=void 0,this.id&&this.jam.folder.id({id:this.id,folderIncFolders:!0,folderIncTracks:!0,folderIncParents:!0,folderIncTag:!0,trackIncTag:!0,trackIncRawTag:!0,folderChildIncTag:!0}).then(t=>{this.display(t)}).catch(t=>{this.notify.error(t)})}loadRecursive(){this.folder&&(this.canLoadRecursive=!1,this.tracks=void 0,this.jam.track.search({childOfID:this.folder.id,trackIncTag:!0,trackIncRawTag:!0,orderBy:f.Bm.filename}).then(t=>{this.tracks=t.items,this.editor.build(this.tracks)}).catch(t=>{this.notify.error(t)}))}onCellEditorNavigationKeyDown(t){if((0,$.ZQ)(t.event)){const o=this.editor.edits.findIndex(s=>s===t.cell.parent),n=this.editor.edits[o+((0,$.D3)(t.event)?1:-1)];if(n){const s=n.cells[t.cell.parent.cells.indexOf(t.cell)];if(s){const r=this.cellEditors.find(c=>c.cell===s);r&&setTimeout(()=>{r.navigTo()})}}}else if((0,$.Vf)(t.event)){const o=t.cell.parent.cells[t.cell.parent.cells.indexOf(t.cell)+((0,$.P9)(t.event)?1:-1)];if(o){const n=this.cellEditors.find(s=>s.cell===o);n&&setTimeout(()=>{n.navigTo()})}}}save(){if(this.isSaving)return;const t=this.editor.edits.filter(s=>s.changed);if(0===t.length)return;const o=[];for(const s of t)s.saving=!0,o.push(this.prepareEditSave(s));const n=o.shift();n&&(this.isSaving=!0,this.runSave(n,o).then(()=>{this.isSaving=!1}).catch(s=>{this.isSaving=!1;for(const r of t)r.saving=!1;this.notify.error(s)}))}prepareEditSave(t){const o={edit:t,track:t.track};let n=t.cells.filter(r=>r.changed);const s=n.find(r=>r.column.def.id===I);if(s){n=n.filter(c=>c.column.def.id!==I);const r=s.frames[0].value.text;r&&t.track.name!==r&&(o.filename=r)}return n.length>0&&(o.rawTag=re(t)),o}saveEdit(t){if(!t.changed||this.isSaving)return;this.isSaving=!0;const o=this.prepareEditSave(t);this.runSave(o,[]).then(()=>{this.isSaving=!1}).catch(n=>{this.isSaving=!1,this.notify.error(n)})}chooseColumns(){var t=this;this.isSaving&&this.notify.error(Error("Saving is in progress"));const o={columns:this.editor.columns,resultColumns:[]};var n;this.dialogOverlay.open({title:"Choose Columns",childComponent:me,panelClass:"overlay-panel-large-buttons",data:o,onOkBtn:(n=(0,h.A)(function*(){try{t.tracks&&t.editor.updateColumns(t.tracks,o.resultColumns)}catch(s){return t.notify.error(s),Promise.reject(s)}}),function(){return n.apply(this,arguments)}),onCancelBtn:function(){var n=(0,h.A)(function*(){return Promise.resolve()});return function(){return n.apply(this,arguments)}}()})}brainz(){if(!this.folder||!this.tracks)return;this.canDeactivate()||this.notify.error(Error("Saving is in progress"));const t={folder:this.folder,matchings:this.tracks.map(o=>({track:o})),apply:()=>{for(const o of t.matchings)o.track&&o.rawTag&&(o.track.tagRaw=o.rawTag);if(this.tracks){this.editor.build(this.tracks);for(const o of t.matchings)if(o.track&&o.rawTag){const n=this.editor.edits.find(s=>s.track===o.track);if(n){n.changed=!0;for(const s of n.cells)s.column.def.id!==I&&(s.changed=!0)}}}}};this.dialogOverlay.open({title:"Release Matching",childComponent:J,data:t,panelClass:"overlay-panel-large"})}editAlbumValues(){var o;(this.canDeactivate()||this.notify.error(Error("Saving is in progress")),this.tracks)&&this.dialogOverlay.open({title:"Edit Album Values",childComponent:ge,data:{tracks:this.tracks},onOkBtn:(o=(0,h.A)(function*(){return Promise.resolve()}),function(){return o.apply(this,arguments)}),onCancelBtn:function(){var o=(0,h.A)(function*(){return Promise.resolve()});return function(){return o.apply(this,arguments)}}()})}onContextMenu(t){this.contextMenuService.show.next({contextMenu:this.actionMenu,event:t,item:void 0}),t.preventDefault(),t.stopPropagation()}runSave(t,o){var n=this;return(0,h.A)(function*(){try{if(t.filename){const r=yield n.jam.track.rename({id:t.track.id,name:t.filename});n.folderService.waitForQueueResult("Renaming Track",r,[t.track.parentID],[],[t.track.id])}if(t.rawTag){const r=yield n.jam.track.rawTagSet({id:t.track.id,tag:t.rawTag});n.folderService.waitForQueueResult("Writing Track Tag",r,[t.track.parentID],[],[t.track.id])}t.edit.saving=!1,t.rawTag&&(t.edit.tag=t.rawTag),t.edit.changed=!1}catch(r){return Promise.reject(r)}const s=o.shift();s&&(yield n.runSave(s,o))})()}display(t){this.folder=t,this.tracks=t.tracks||[],this.editor.build(this.tracks),this.canLoadRecursive=0===this.tracks.length&&(t.folders||[]).length>0,this.canLoadRecursive&&t.type===f.DZ.multialbum&&this.loadRecursive()}static \u0275fac=function(o){return new(o||a)(e.rXU(N.d3),e.rXU(N.pp),e.rXU(z.Kf),e.rXU(f.UA),e.rXU(N.FL),e.rXU(he.iD))};static \u0275cmp=e.VBU({type:a,selectors:[["app-admin-tag-editor"]],viewQuery:function(o,n){if(1&o&&(e.GBs(pt,5),e.GBs(Y,5)),2&o){let s;e.mGM(s=e.lsd())&&(n.actionMenu=s.first),e.mGM(s=e.lsd())&&(n.cellEditors=s)}},hostBindings:function(o,n){1&o&&e.bIt("beforeunload",function(){return n.canDeactivate()},!1,e.tSv)},inputs:{id:"id"},features:[e.OA$],decls:10,vars:2,consts:()=>{let t,o,n,s,r,c,_,p,d,C,T,O,A,b,v,D;return t=$localize`:␟d00dbae4a3e4f5fb5287c3ef6fde8035dc5a79f5␟9064106308242024618:Set Audiobook Frames`,o=$localize`:␟116ee2407dea6f965ec08ff5bb957760df6e2a85␟6656311361426574635:Set Audio Series Frames`,n=$localize`:␟2e873296abc631156e0a97d7e843751195b38829␟63335187416623423:Set Soundtrack Frames`,s=$localize`:␟257a97bb09d914993dd99f36ffd6e9a6a93f8a17␟5117338775318483791:Set Bootleg Frames`,r=$localize`:␟eeb69f5267a060943ed0dc902afd909d53a412f8␟6494641063048624386:Set Various Artists Compilation Frames`,c=$localize`:␟16a5908d3ecf5faa7a16cf0303c1ae1fb559a6cc␟6928752720245775068:Search & Fill Missing Lyrics Frames`,_=$localize`:␟c41714c6798a576f0adf11857f08f0db361d15d7␟3968113785629853013:Load all Tracks`,p=$localize`:␟60b5e271ee1483cf2fc9c49d0b861258f490661d␟930157484605471697:This folder does not contain any tracks with tags.`,d=$localize`:␟2ea320c88da8bc29388471e4b48d5c1f0c8d620e␟7184376553461822627:Do you want to load all tracks from subfolders?`,C=$localize`:␟dca3a8d76fb406f412af59611c7bf2dd739df4b5␟6250552114791622521:Load recursive`,T=$localize`:␟c8d1785038d461ec66b5799db21864182b35900a␟1102717806459547726:Refresh`,O=$localize`:␟3f74c61be995a66526e146600cd47c901b71604f␟6520843897216456434:Match with MusicBrainz`,A=$localize`:␟9695ccaa90cd56b8b6822739823bd35e4ef835b7␟1194863084167414951:Choose Columns`,b=$localize`:␟52c9a103b812f258bcddc3d90a6e3f46871d25fe␟3768927257183755959:Save`,v=$localize`:␟52c9a103b812f258bcddc3d90a6e3f46871d25fe␟3768927257183755959:Save`,D=$localize`:␟ac0f81713a84217c9bd1d9bb460245d8190b073f␟5937251202465808296:More`,[["actionMenu",""],t,o,n,s,r,c,p,d,C,["contextMenuItem","",3,"execute"],[1,"icon-edit"],[1,"load-recursive"],[1,"actions"],[3,"requestClose","editor","activeCol"],[1,"editor"],["title",_,1,"button-on-control",3,"click"],[1,"icon-reload"],["title",T,1,"button-on-control",3,"click"],["title",O,1,"button-on-control",3,"click"],[3,"size"],["title",A,1,"button-on-control",3,"click"],[1,"icon-list-add"],["title",b,1,"button-on-control"],["title",v,1,"button-on-control"],["title",D,1,"button-on-control",3,"click"],["title",b,1,"button-on-control",3,"click"],[1,"icon-floppy"],[1,"icon-spin","icon-spnner"],[1,"header-row"],[1,"header-row-title"],[3,"min-width"],[1,"header-row-title",3,"click"],[3,"title"],[1,"col-state"],[1,"cell-editor"],[1,"icon-spin","icon-spinner"],[1,"icon-floppy",3,"click"],[1,"cell-editor",3,"navigKeyDownRequest","cell"]]},template:function(o,n){if(1&o){const s=e.RV6();e.DNE(0,ht,1,0,"app-loading"),e.j41(1,"context-menu",null,0),e.DNE(3,Tt,3,0,"ng-template",10),e.bIt("execute",function(){return e.eBV(s),e.Njj(n.editor.setAudiobookFrames(n.tracks))}),e.DNE(4,Ct,3,0,"ng-template",10),e.bIt("execute",function(){return e.eBV(s),e.Njj(n.editor.setAudioSeriesFrames(n.tracks))}),e.DNE(5,ft,3,0,"ng-template",10),e.bIt("execute",function(){return e.eBV(s),e.Njj(n.editor.setSoundtrackFrames(n.tracks))}),e.DNE(6,Mt,3,0,"ng-template",10),e.bIt("execute",function(){return e.eBV(s),e.Njj(n.editor.setBootlegFrames(n.tracks))}),e.DNE(7,Ot,3,0,"ng-template",10),e.bIt("execute",function(){return e.eBV(s),e.Njj(n.editor.setVariousArtistFrames(n.tracks))}),e.DNE(8,Et,3,0,"ng-template",10),e.bIt("execute",function(){return e.eBV(s),e.Njj(n.editor.findMissingLyrics(n.tracks))}),e.k0s(),e.DNE(9,Gt,5,6)}2&o&&(e.vxM(0,n.folder?-1:0),e.R7$(9),e.vxM(9,n.folder?9:-1))},dependencies:[Qe.q,Ze.m,Te.E,Ce.J,Pe,Se],styles:["[_nghost-%COMP%]{height:100%;width:100%;overflow:hidden;display:flex;flex-direction:column}[_nghost-%COMP%]   .actions[_ngcontent-%COMP%]{padding:10px 15px 0;border-bottom-color:var(--background-border);border-bottom-width:1px;border-bottom-style:solid}[_nghost-%COMP%]   .actions[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{margin-right:5px;margin-bottom:10px}[_nghost-%COMP%]   .actions[_ngcontent-%COMP%] > label[_ngcontent-%COMP%]{text-transform:uppercase;letter-spacing:1px;font-size:11px;margin-left:5px;margin-right:5px}[_nghost-%COMP%]   .load-recursive[_ngcontent-%COMP%]{text-align:center;margin-top:30px;margin-left:30px;margin-right:30px}[_nghost-%COMP%]   .load-recursive[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-top:10px}[_nghost-%COMP%]   .editor[_ngcontent-%COMP%]{width:100%;height:100%;display:block;position:relative;overflow:auto}[_nghost-%COMP%]   .editor[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{table-layout:fixed;border-width:0;width:auto}[_nghost-%COMP%]   .editor[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .cell-editor[_ngcontent-%COMP%]{width:100%;height:34px;border-top-width:1px;border-top-style:solid;border-left-width:1px;border-left-style:solid;text-align:left;padding-bottom:1px;padding-top:1px;font-size:11px;color:var(--on-background);border-color:var(--background-border);overflow:hidden;display:flex;align-items:center}[_nghost-%COMP%]   .editor[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .cell-editor.changed[_ngcontent-%COMP%]{padding-bottom:0;padding-top:0;border-width:1px;border-style:solid;border-left-width:2px;border-top-width:2px;border-color:var(--background-box)}[_nghost-%COMP%]   .editor[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .cell-editor[_ngcontent-%COMP%]:focus-within{padding-bottom:0;padding-top:0;border-width:1px;border-style:solid;border-left-width:2px;border-top-width:2px;color:var(--on-background-highlight)}[_nghost-%COMP%]   .editor[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{border-right-width:1px;border-right-style:solid;border-right-color:var(--background-border)}[_nghost-%COMP%]   .editor[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr.header-row[_ngcontent-%COMP%]{border-top-width:1px;border-top-style:solid;border-top-color:var(--background-border)}[_nghost-%COMP%]   .editor[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr.header-row[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;font-size:.8em;padding-left:4px;padding-right:4px;border-top:none;border-bottom:none;color:var(--on-background-highlight);background-color:var(--background);position:sticky}[_nghost-%COMP%]   .editor[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr.header-row[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{padding:0;visibility:hidden}[_nghost-%COMP%]   .editor[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr.header-row[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:hover   .actions[_ngcontent-%COMP%]{visibility:inherit}[_nghost-%COMP%]   .editor[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th.header-row-title[_ngcontent-%COMP%]{cursor:pointer;-webkit-user-select:none;user-select:none}[_nghost-%COMP%]   .editor[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border:none;max-width:200px}[_nghost-%COMP%]   .editor[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td.col-state[_ngcontent-%COMP%]{text-align:center;width:40px}[_nghost-%COMP%]   .editor[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td.col-state[_ngcontent-%COMP%]   .cell-editor[_ngcontent-%COMP%]{padding-top:6px;font-size:18px}[_nghost-%COMP%]   .editor[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:last-of-type   .cell-editor[_ngcontent-%COMP%]{border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:var(--background-border)}"]})}return a})(),q=(()=>{class a{route;id;child;unsubscribe=new V.B;constructor(t){this.route=t}ngOnInit(){this.route.parent?.parent?.params&&this.route.parent.parent.params.pipe((0,G.Q)(this.unsubscribe)).subscribe(t=>{this.id=t.id})}ngOnDestroy(){this.unsubscribe.next(),this.unsubscribe.complete()}canDeactivate(){return!(!this.child||!this.child.canDeactivate())}static \u0275fac=function(o){return new(o||a)(e.rXU(ae.nX))};static \u0275cmp=e.VBU({type:a,selectors:[["app-admin-folder-tag-editor"]],viewQuery:function(o,n){if(1&o&&e.GBs(K,7),2&o){let s;e.mGM(s=e.lsd())&&(n.child=s.first)}},decls:1,vars:1,consts:[[3,"id"]],template:function(o,n){1&o&&e.nrm(0,"app-admin-tag-editor",0),2&o&&e.Y8G("id",n.id)},styles:["[_nghost-%COMP%]{height:100%;width:100%;overflow:hidden;display:block}"]})}return a})();const wt=ae.iI.forChild([{path:"",component:q}]);function Kt(a,i){if(1&a&&e.nrm(0,"img",0),2&a){const t=e.XpG();e.Y8G("src",t.src,e.B4B)("alt",null==t.image?null:t.image.title)}}let Ae=(()=>{class a{image;src;ngOnChanges(){this.src=void 0,this.image&&(this.src=`data:${this.image.mimeType||"image/jpeg"};base64,${this.image.base64}`)}static \u0275fac=function(o){return new(o||a)};static \u0275cmp=e.VBU({type:a,selectors:[["app-image-base64"]],inputs:{image:"image"},features:[e.OA$],decls:1,vars:1,consts:[[3,"src","alt"]],template:function(o,n){1&o&&e.DNE(0,Kt,1,2,"img",0),2&o&&e.vxM(0,n.src?0:-1)},styles:["[_nghost-%COMP%]{display:block}[_nghost-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:auto}"]})}return a})();var qt=m(1893),Wt=m(3903);const Qt=(a,i)=>i.image.id;function Zt(a,i){1&a&&e.nrm(0,"i",7)}function en(a,i){if(1&a&&(e.j41(0,"div",12),e.nrm(1,"app-image-base64",13),e.k0s(),e.j41(2,"div",14)(3,"div",15)(4,"label"),e.nrm(5,"input",16),e.EFF(6),e.k0s()()()),2&a){const t=e.XpG().$implicit;e.R7$(),e.Y8G("image",t.base64),e.R7$(4),e.Y8G("checked",t.checked),e.R7$(),e.SpI(" ",t.image.types,"")}}function tn(a,i){if(1&a&&(e.j41(0,"div",11),e.DNE(1,en,7,3),e.k0s()),2&a){const t=i.$implicit;e.R7$(),e.vxM(1,t.base64?1:-1)}}function nn(a,i){if(1&a&&(e.j41(0,"div",8),e.nrm(1,"app-background-text-list",9),e.j41(2,"div",10),e.Z7z(3,tn,2,1,"div",11,Qt),e.k0s()()),2&a){const t=e.XpG();e.R7$(),e.Y8G("list",t.images),e.R7$(2),e.Dyx(t.images)}}let W=(()=>{class a{app;jam;notify;data;isImageSearchRunning=!1;showFrontImagesOnly=!0;images;coverArtArchive;constructor(t,o,n){this.app=t,this.jam=o,this.notify=n}trackByFn(t,o){return o.image.id}ngOnChanges(){this.data?this.loadCoverartImages(this.data).catch(t=>{this.notify.error(t)}):(this.images=void 0,this.coverArtArchive=void 0)}onToggleShowFrontImagesOnly(){if(!this.showFrontImagesOnly&&this.coverArtArchive)for(const t of this.coverArtArchive)!t.base64&&!t.requested&&this.getBase64Image(t).catch(o=>{console.error(o)});this.coverArtArchive&&(this.images=this.coverArtArchive.filter(t=>t.image.front||!this.showFrontImagesOnly))}getChecked(){return this.coverArtArchive?this.coverArtArchive.filter(t=>t.checked&&t.base64):[]}loadImages(t){var o=this;return(0,h.A)(function*(){if(t.images){o.coverArtArchive=t.images.map(r=>{if(0===r.types.length&&r.types.push("Other"),r.image&&(r.image=r.image.replace("http:","https:")),r.thumbnails){const _=r.thumbnails;Object.keys(_).forEach(p=>{_[p]=_[p].replace("http:","https:")})}return{image:r,checked:!1}});const n=o.coverArtArchive.filter(r=>r.image.front||r.image.types.includes("Front")).sort((r,c)=>r.image.types.length-c.image.types.length);o.images=o.showFrontImagesOnly?n:o.coverArtArchive,o.images.forEach(r=>{o.getBase64Image(r).catch(c=>{console.error(c)})});let s=n.find(r=>1===r.image.types.length);s||(s=n[0]),s&&(s.checked=!0)}else o.images=void 0,o.coverArtArchive=[]})()}loadCoverartImages(t){var o=this;return(0,h.A)(function*(){if(t.mbReleaseID){o.isImageSearchRunning=!0;let n=yield o.jam.metadata.coverartarchiveLookup({type:f.vM.release,mbID:t.mbReleaseID});yield o.loadImages(n.data),o.coverArtArchive&&0===o.coverArtArchive.length&&t.mbReleaseGroupID&&(o.images=void 0,o.coverArtArchive=void 0,n=yield o.jam.metadata.coverartarchiveLookup({type:f.vM.releaseGroup,mbID:t.mbReleaseGroupID}),yield o.loadImages(n.data)),o.isImageSearchRunning=!1}})()}getBase64Image(t){var o=this;return(0,h.A)(function*(){if(t.requested)return;const n=t.image.thumbnails[500]||t.image.thumbnails.small;let s;t.requested=!0;try{s=yield o.jam.metadata.coverartarchiveImageBinary({url:n})}catch(r){console.error(r)}t.requested=!1,s?t.base64={title:n,mimeType:s.contentType,base64:(0,qt.J)(s.buffer)}:o.notify.error({error:"Invalid result from https://coverartarchive.org"})})()}static \u0275fac=function(o){return new(o||a)(e.rXU(N.d3),e.rXU(f.UA),e.rXU(N.FL))};static \u0275cmp=e.VBU({type:a,selectors:[["app-match-coverart"]],inputs:{data:"data"},features:[e.OA$],decls:10,vars:4,consts:()=>{let t,o;return t=$localize`:␟2f1af3c61d7c0984f04ef0e8c4838aa7e6d90d93␟6069974144025121503:Front only`,o=$localize`:␟2689f5742c952b88d105a84ff9e924d15e269dba␟2840633634490107011:Coverart`,[t,o,[1,"match-album-images"],[1,"front-only-choice"],["type","checkbox",3,"ngModelChange","change","checked","ngModel"],[1,"section"],["href","https://coverartarchive.org/","rel","noopener","target","_blank"],[1,"icon-spin","icon-spinner"],[1,"match-images"],["name","Images",3,"list"],[1,"media-cards"],[1,"media-card","no-hover"],[1,"image"],[3,"image"],[1,"footer"],[1,"footer-content"],["type","checkbox",3,"checked"]]},template:function(o,n){1&o&&(e.j41(0,"div",2)(1,"label",3)(2,"input",4),e.mxI("ngModelChange",function(r){return e.DH7(n.showFrontImagesOnly,r)||(n.showFrontImagesOnly=r),r}),e.bIt("change",function(){return n.onToggleShowFrontImagesOnly()}),e.k0s(),e.qex(3),e.pXf(4,0),e.bVm(),e.k0s(),e.j41(5,"div",5)(6,"a",6),e.pXf(7,1),e.k0s()(),e.DNE(8,Zt,1,0,"i",7)(9,nn,5,1,"div",8),e.k0s()),2&o&&(e.R7$(2),e.Y8G("checked",n.showFrontImagesOnly),e.R50("ngModel",n.showFrontImagesOnly),e.R7$(6),e.vxM(8,n.isImageSearchRunning?8:-1),e.R7$(),e.vxM(9,n.images&&!n.isImageSearchRunning?9:-1))},dependencies:[Wt.F,u.Zm,u.BC,u.vS,Ae],styles:["[_nghost-%COMP%]{padding-top:15px}[_nghost-%COMP%]   .section[_ngcontent-%COMP%]{color:var(--on-background-highlight);text-transform:uppercase;padding-bottom:10px;white-space:nowrap}[_nghost-%COMP%]   .section[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--on-background-highlight)}[_nghost-%COMP%]   .section[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:var(--on-background)}[_nghost-%COMP%]   .front-only-choice[_ngcontent-%COMP%]{float:right;font-size:.8em}[_nghost-%COMP%]   .match-images[_ngcontent-%COMP%]{min-height:200px;display:flex;flex-flow:row wrap}@media (max-width: 768px){[_nghost-%COMP%]   .match-images[_ngcontent-%COMP%]{justify-content:space-around}}[_nghost-%COMP%]   .match-images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{max-width:200px;max-height:200px}"]})}return a})();function on(a,i){if(1&a&&(e.j41(0,"span",0),e.nI1(1,"number"),e.qSk(),e.j41(2,"svg",1),e.nrm(3,"rect",2),e.k0s()()),2&a){const t=e.XpG();e.Mz_("title","Score: ",e.bMT(1,4,t.score),""),e.R7$(3),e.BMQ("y",12-10*t.score)("fill",t.color)}}let be=(()=>{class a{score;color;getMatchColor(t){return t>.7?"green":t>.3?"yellow":"red"}ngOnChanges(){this.color=void 0===this.score?void 0:this.getMatchColor(this.score)}static \u0275fac=function(o){return new(o||a)};static \u0275cmp=e.VBU({type:a,selectors:[["app-score-box"]],inputs:{score:"score"},features:[e.OA$],decls:1,vars:1,consts:[[3,"title"],["xmlns","http://www.w3.org/2000/svg","width","10","height","12"],["height","12","width","10"]],template:function(o,n){1&o&&e.DNE(0,on,4,6,"span",0),2&o&&e.vxM(0,n.score?0:-1)},dependencies:[y.QX],styles:["[_nghost-%COMP%]{width:100%;height:100%}[_nghost-%COMP%]   svg[_ngcontent-%COMP%]{overflow:hidden;vertical-align:middle;background-color:var(--background-hover);border:1px solid var(--background-border)}"]})}return a})();var Ne=m(8592);function an(a,i){if(1&a&&(e.j41(0,"div")(1,"span",15),e.pXf(2,5),e.k0s(),e.EFF(3,"\xa0"),e.j41(4,"span",17),e.EFF(5),e.k0s()()),2&a){const t=e.XpG(2).$implicit;e.R7$(5),e.JRh(t.abdata.moods)}}function sn(a,i){1&a&&(e.j41(0,"div")(1,"span",15),e.pXf(2,6),e.k0s(),e.EFF(3,"\xa0"),e.j41(4,"span",17),e.pXf(5,7),e.k0s()())}function rn(a,i){if(1&a&&(e.j41(0,"div")(1,"span",15),e.pXf(2,1),e.k0s(),e.EFF(3,"\xa0"),e.j41(4,"span",16),e.EFF(5),e.k0s(),e.EFF(6,"\xa0 "),e.j41(7,"span",15),e.pXf(8,2),e.k0s(),e.EFF(9,"\xa0"),e.j41(10,"span",17),e.EFF(11),e.k0s(),e.EFF(12,"\xa0 "),e.j41(13,"span",15),e.pXf(14,3),e.k0s(),e.EFF(15,"\xa0"),e.j41(16,"span",17),e.EFF(17),e.nI1(18,"mbArtistCredits"),e.k0s(),e.EFF(19,"\xa0 "),e.j41(20,"span",15),e.pXf(21,4),e.k0s(),e.EFF(22,"\xa0"),e.j41(23,"span",17),e.EFF(24),e.k0s(),e.EFF(25,"\xa0 "),e.DNE(26,an,6,1,"div")(27,sn,6,0,"div"),e.k0s()),2&a){const t=e.XpG().$implicit;e.R7$(5),e.JRh(t.mbTrack.position),e.R7$(6),e.JRh(t.mbTrack.title||"?"),e.R7$(6),e.JRh(e.bMT(18,6,t.mbTrack.artistCredit)),e.R7$(7),e.JRh((null==t.mbRelease?null:t.mbRelease.title)||"?"),e.R7$(2),e.vxM(26,t.abdata?26:-1),e.R7$(),e.vxM(27,t.lyrics?27:-1)}}function ln(a,i){if(1&a){const t=e.RV6();e.j41(0,"div",11),e.bIt("dragstart",function(n){const s=e.eBV(t).$implicit,r=e.XpG();return e.Njj(r.drag(n,s))}),e.j41(1,"div",12),e.nrm(2,"span",13),e.k0s(),e.j41(3,"div",14),e.EFF(4),e.DNE(5,rn,28,8,"div"),e.k0s()()}if(2&a){const t=i.$implicit;e.R7$(4),e.SpI(" ",t.track.name," "),e.R7$(),e.vxM(5,t.mbTrack?5:-1)}}let ve=(()=>{class a{cd;matchings=[];dragStartRequest=new e.bkB;constructor(t){this.cd=t}drag(t,o){this.cd.markForCheck(),t.dataTransfer&&t.dataTransfer.setData("text",o.track.id)}static \u0275fac=function(o){return new(o||a)(e.rXU(e.gRc))};static \u0275cmp=e.VBU({type:a,selectors:[["app-match-file-list"]],inputs:{matchings:"matchings"},outputs:{dragStartRequest:"dragStartRequest"},decls:5,vars:1,consts:()=>{let t,o,n,s,r,c,_,p;return t=$localize`:␟47d8f933b9e780457fa67f554a6541ece2e319c2␟813409290835006132:${"\ufffd0\ufffd"}:INTERPOLATION: Tracks`,o=$localize`:␟62105695c62cfa82a2676943102f9fc3c887bc48␟443542841142643147:TrackNr:`,n=$localize`:␟8737210008395d7b014e5118d2ed198ae9745215␟2517309683610083249:Title:`,s=$localize`:␟7918b6e7567484cccee5e53dca8985639a43479e␟3140202407838809744:Artist:`,r=$localize`:␟ce99fbb2724383169925d4042ed56a458b5cdfc8␟1276947660844876641:Album:`,c=$localize`:␟06c55f883d53d51c34401167ec5fec8dda96de4e␟6458132837581302237:Moods:`,_=$localize`:␟35242a5d250cd67e3698ca65dc94729706a57e9e␟1342610846383662061:Lyrics:`,p=$localize`:␟0594812d4c50c2adbd1a892a3497c4e5c19e4b32␟6286037250766429054:yes`,[t,o,n,s,r,c,_,p,[1,"match-file-list"],[1,"match-file-list-header"],["draggable","true",1,"match-file"],["draggable","true",1,"match-file",3,"dragstart"],[1,"handle"],[1,"grippy"],[1,"title"],[1,"label"],[1,"currentRelease"],[1,"value"]]},template:function(o,n){1&o&&(e.j41(0,"div",8)(1,"div",9),e.pXf(2,0),e.k0s(),e.Z7z(3,ln,6,2,"div",10,e.fX1),e.k0s()),2&o&&(e.R7$(2),e.uP7(n.matchings.length),e.nnv(2),e.R7$(),e.Dyx(n.matchings))},dependencies:[Ne.f],styles:['[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]{display:flex;flex-flow:column wrap;-webkit-user-select:none;user-select:none;width:100%;padding-top:5px;background-color:var(--background);color:var(--on-background);margin-bottom:15px}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file-list-header[_ngcontent-%COMP%]{text-align:center;padding-bottom:5px}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]{min-height:48px;display:flex;flex-flow:row nowrap;align-items:center;align-content:space-evenly;width:100%;line-height:1.25em;margin-bottom:1px;border-top-width:1px;border-top-style:solid;border-bottom-width:0;border-bottom-style:solid;border-bottom-color:var(--background-border);border-top-color:var(--background-border);padding:10px 10px 10px 0}@media (max-width: 1000px){[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]{height:auto}}@media (max-width: 522px){[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]{font-size:.9em}}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .number[_ngcontent-%COMP%]{min-width:32px;text-align:right}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .play-count[_ngcontent-%COMP%]{min-width:20px;text-align:right}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .rating[_ngcontent-%COMP%]{min-width:30px;text-align:center}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .play-date[_ngcontent-%COMP%]{min-width:100px}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .fav[_ngcontent-%COMP%]{min-width:30px;text-align:center}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{flex-grow:1}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .length[_ngcontent-%COMP%]{min-width:80px;text-align:right}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{margin-left:15px}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:last-of-type{margin-right:15px}@media (max-width: 400px){[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{margin-left:0}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:last-of-type{margin-right:0}}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]:hover{background-color:var(--background-hover)}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]:last-child{border-bottom-width:1px}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .small-screen-icon[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{color:var(--on-background-highlight)}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--on-background);font-size:.8em}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{padding:0;display:inline-block;margin:0 10px 0 0}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{font-size:.8em;vertical-align:middle}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   a.title-link[_ngcontent-%COMP%]{font-size:inherit;margin-right:10px;color:var(--on-background-highlight)}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--on-background)}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:var(--on-background-hover)}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]{width:0;margin-left:0;cursor:move}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]   span.grippy[_ngcontent-%COMP%]{display:inline-block;width:26px;height:8px;transform:rotate(90deg);margin-left:-8px}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]   span.grippy[_ngcontent-%COMP%], [_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]   span.grippy[_ngcontent-%COMP%]:before{background-image:radial-gradient(#7b7b7b 40%,transparent 40%);background-size:4px 4px;background-position:0 100%;background-repeat:repeat-x}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]   span.grippy[_ngcontent-%COMP%]:before{content:"";display:block;width:100%;height:33%}@media (max-width: 1000px){[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]{height:auto;min-height:48px}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{display:block}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:inline-block;margin-left:0}}@media (max-width: 400px){[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]{flex-flow:row wrap;align-items:inherit;width:100%;font-size:.9em}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .small-screen-icon[_ngcontent-%COMP%]{display:inline-block}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]{order:2;width:25%;text-align:center}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]   span.grippy[_ngcontent-%COMP%]{transform:rotate(0)}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{order:6;margin-left:0;margin-right:0;padding-right:0;padding-left:0;width:100%}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{margin-left:0;margin-right:0;padding-right:0;padding-left:0;overflow:hidden;text-overflow:ellipsis}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{width:100%;margin-left:0;margin-right:0;overflow:hidden;text-overflow:ellipsis}}@media (max-width: 1200px){[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .fav[_ngcontent-%COMP%]{display:none}}@media (max-width: 400px){[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .number[_ngcontent-%COMP%], [_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .play-count[_ngcontent-%COMP%], [_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .rating[_ngcontent-%COMP%], [_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .play-date[_ngcontent-%COMP%], [_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .length[_ngcontent-%COMP%]{margin-left:0;margin-right:0;padding-right:0;padding-left:0;font-size:.8em;width:30%;flex-grow:1;text-align:center}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .number[_ngcontent-%COMP%]{order:1;width:25%;text-align:left}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .play-count[_ngcontent-%COMP%]{order:2}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .rating[_ngcontent-%COMP%]{order:3}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .play-date[_ngcontent-%COMP%]{order:4}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .length[_ngcontent-%COMP%]{order:5;width:25%;text-align:right}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{order:6}}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:11px}[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .match-file[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   span.value[_ngcontent-%COMP%]{color:var(--on-background-highlight);padding-right:5px}@media (max-width: 768px){[_nghost-%COMP%]   .match-file-list[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]{display:none}}']})}return a})(),cn=(()=>{class a{transform(t){return JSON.stringify(t,void 0," ")}static \u0275fac=function(o){return new(o||a)};static \u0275pipe=e.EJ8({name:"json",type:a,pure:!0})}return a})();var _n=m(3631);const dn=(a,i)=>({"button-primary":a,"button-on-background":i}),un=a=>({missing:a});function pn(a,i){if(1&a&&(e.j41(0,"span",18),e.EFF(1),e.k0s()),2&a){const t=e.XpG(2).$implicit;e.R7$(),e.JRh(t.mbGroup.artistCredit[0].name)}}function gn(a,i){1&a&&e.EFF(0),2&a&&e.SpI(" /",i.$implicit," ")}function mn(a,i){if(1&a&&e.Z7z(0,gn,1,1,null,null,e.fX1),2&a){const t=e.XpG(2).$implicit;e.Dyx(t.mbGroup.secondaryTypes)}}function hn(a,i){1&a&&e.nrm(0,"i",26)}function Tn(a,i){1&a&&e.nrm(0,"i",27)}function Cn(a,i){if(1&a&&(e.j41(0,"span",18),e.EFF(1),e.DNE(2,hn,1,0,"i",26)(3,Tn,1,0,"i",27),e.k0s()),2&a){const t=i.$implicit;e.R7$(),e.SpI("",t.tracks.length," "),e.R7$(),e.vxM(2,t.complete?2:-1),e.R7$(),e.vxM(3,t.complete?-1:3)}}function fn(a,i){if(1&a&&(e.j41(0,"span",24),e.pXf(1,6),e.k0s(),e.j41(2,"span",18),e.EFF(3),e.k0s()),2&a){const t=e.XpG(2).$implicit;e.R7$(3),e.JRh(t.currentRelease.totalTrack)}}function Mn(a,i){if(1&a&&(e.j41(0,"div",19)(1,"span",24),e.pXf(2,0),e.k0s(),e.j41(3,"span",18),e.nrm(4,"app-score-box",25),e.k0s(),e.j41(5,"span",24),e.pXf(6,1),e.k0s(),e.DNE(7,pn,2,1,"span",18),e.j41(8,"span",24),e.pXf(9,2),e.k0s(),e.j41(10,"span",18),e.EFF(11),e.DNE(12,mn,2,0),e.k0s(),e.nrm(13,"br"),e.j41(14,"span",24),e.pXf(15,3),e.k0s(),e.j41(16,"span",18),e.EFF(17),e.k0s(),e.j41(18,"span",24),e.pXf(19,4),e.k0s(),e.j41(20,"span",18),e.EFF(21),e.k0s(),e.nrm(22,"br"),e.j41(23,"span",24),e.pXf(24,5),e.k0s(),e.Z7z(25,Cn,4,3,"span",18,e.fX1),e.DNE(27,fn,4,1),e.k0s()),2&a){const t=e.XpG().$implicit;e.R7$(4),e.Y8G("score",t.currentRelease.score),e.R7$(3),e.vxM(7,t.mbGroup.artistCredit?7:-1),e.R7$(4),e.SpI("",t.mbGroup.primaryType," "),e.R7$(),e.vxM(12,t.mbGroup.secondaryTypes?12:-1),e.R7$(5),e.JRh(t.currentRelease.mbRelease.date||"?"),e.R7$(4),e.JRh(t.currentRelease.mbRelease.country||"?"),e.R7$(4),e.Dyx(t.currentRelease.media),e.R7$(2),e.vxM(27,t.currentRelease.media.length>1?27:-1)}}function On(a,i){if(1&a){const t=e.RV6();e.j41(0,"button",28),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit;return e.Njj(n.expanded=!n.expanded)}),e.pXf(1,7),e.k0s()}}function En(a,i){if(1&a){const t=e.RV6();e.j41(0,"button",28),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit;return e.Njj(n.selecting=!n.selecting)}),e.pXf(1,8),e.k0s()}}function Pn(a,i){if(1&a){const t=e.RV6();e.j41(0,"button",29),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,s=e.XpG(2);return e.Njj(s.chooseRelease(n,n.currentRelease))}),e.pXf(1,9),e.k0s()}if(2&a){const t=e.XpG().$implicit;e.Y8G("ngClass",e.l_i(1,dn,t.currentRelease.complete,!t.currentRelease.complete))}}function Sn(a,i){1&a&&e.EFF(0," / ")}function Rn(a,i){if(1&a&&(e.DNE(0,Sn,1,0),e.EFF(1)),2&a){const t=i.$implicit;e.vxM(0,i.$index>0?0:-1),e.R7$(),e.SpI(" ",t.trackCount," ")}}function An(a,i){if(1&a&&e.Z7z(0,Rn,2,2,null,null,e.fX1),2&a){const t=e.XpG().$implicit;e.Dyx(t.mbRelease.media)}}function bn(a,i){1&a&&e.EFF(0," ? ")}function Nn(a,i){if(1&a){const t=e.RV6();e.j41(0,"label",31),e.bIt("click",function(){const n=e.eBV(t).$implicit,s=e.XpG(2).$implicit,r=e.XpG(2);return e.Njj(r.matcher.setRelease(s,n))}),e.nrm(1,"input",32),e.j41(2,"span",24),e.pXf(3,10),e.k0s(),e.j41(4,"span",18),e.nrm(5,"app-score-box",25),e.k0s(),e.j41(6,"span",24),e.pXf(7,11),e.k0s(),e.j41(8,"span",18),e.EFF(9),e.k0s(),e.j41(10,"span",24),e.pXf(11,12),e.k0s(),e.j41(12,"span",18),e.EFF(13),e.k0s(),e.j41(14,"span",24),e.pXf(15,13),e.k0s(),e.j41(16,"span",18),e.DNE(17,An,2,0)(18,bn,1,0),e.k0s()()}if(2&a){const t=i.$implicit,o=e.XpG(2).$implicit;e.R7$(),e.Y8G("checked",t===o.currentRelease),e.R7$(4),e.Y8G("score",t.score),e.R7$(4),e.JRh(t.mbRelease.date||"?"),e.R7$(4),e.JRh(t.mbRelease.country||"?"),e.R7$(4),e.vxM(17,t.mbRelease.media?17:-1),e.R7$(),e.vxM(18,t.mbRelease.media?-1:18)}}function vn(a,i){if(1&a&&(e.j41(0,"div")(1,"form")(2,"fieldset"),e.Z7z(3,Nn,19,6,"label",30,e.fX1),e.k0s()()()),2&a){const t=e.XpG().$implicit;e.R7$(3),e.Dyx(t.releases)}}function Dn(a,i){1&a&&e.nrm(0,"i",34)}function In(a,i){1&a&&e.nrm(0,"i",35)}function kn(a,i){if(1&a){const t=e.RV6();e.j41(0,"div",33),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit;return e.Njj(n.expanded=!n.expanded)}),e.nrm(1,"i"),e.nI1(2,"stringToggle"),e.qex(3),e.pXf(4,14),e.bVm(),e.EFF(5),e.DNE(6,Dn,1,0,"i",34)(7,In,1,0,"i",35),e.k0s()}if(2&a){const t=e.XpG().$implicit;e.R7$(),e.HbH(e.brH(2,5,t.expanded,"icon-minus","icon-plus")),e.R7$(4),e.SpI(" ",t.mbMedia.position," "),e.R7$(),e.vxM(6,t.complete?6:-1),e.R7$(),e.vxM(7,t.complete?-1:7)}}function xn(a,i){if(1&a){const t=e.RV6();e.j41(0,"div",38),e.nI1(1,"number"),e.nI1(2,"json"),e.nrm(3,"app-score-box",25),e.j41(4,"a",39),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,s=e.XpG(4).$implicit,r=e.XpG(2);return e.Njj(r.matcher.removeMatching(s,s.currentRelease,n))}),e.nrm(5,"i",40),e.k0s(),e.EFF(6),e.k0s()}if(2&a){const t=e.XpG().$implicit;e.FCK("title","Score: ",e.bMT(1,5,t.currentMatch.score)," ",e.bMT(2,7,t.currentMatch.scores),""),e.R7$(3),e.Y8G("score",t.currentMatch.score),e.R7$(3),e.SpI(" ",t.currentMatch.match.track.name," ")}}function Ln(a,i){if(1&a){const t=e.RV6();e.j41(0,"div",37),e.bIt("drop",function(n){const s=e.eBV(t).$implicit,r=e.XpG(4).$implicit,c=e.XpG(2);return e.Njj(c.drop(n,r,r.currentRelease,s))})("dragover",function(n){e.eBV(t);const s=e.XpG(6);return e.Njj(s.allowDrop(n))}),e.EFF(1),e.nI1(2,"mbArtistCredits"),e.DNE(3,xn,7,9,"div",38),e.k0s()}if(2&a){const t=i.$implicit;e.Y8G("ngClass",e.eq3(7,un,!t.currentMatch)),e.R7$(),e.E5c(" ",t.mbTrack.position," - ",t.mbTrack.title," - ",e.bMT(2,5,t.mbTrack.artistCredit)," "),e.R7$(2),e.vxM(3,t.currentMatch?3:-1)}}function yn(a,i){if(1&a&&(e.j41(0,"div"),e.Z7z(1,Ln,4,9,"div",36,e.fX1),e.k0s()),2&a){const t=e.XpG().$implicit;e.R7$(),e.Dyx(t.tracks)}}function Gn(a,i){if(1&a&&(e.j41(0,"div"),e.DNE(1,kn,8,9,"div")(2,yn,3,0,"div"),e.k0s()),2&a){const t=i.$implicit,o=e.XpG(2).$implicit;e.R7$(),e.vxM(1,o.currentRelease.media.length>1?1:-1),e.R7$(),e.vxM(2,t.expanded||o.currentRelease.media.length<2?2:-1)}}function $n(a,i){if(1&a&&(e.j41(0,"div",23),e.Z7z(1,Gn,3,2,"div",null,e.fX1),e.k0s()),2&a){const t=e.XpG().$implicit;e.R7$(),e.Dyx(t.currentRelease.media)}}function wn(a,i){if(1&a&&(e.j41(0,"div",16)(1,"div",17)(2,"span",18),e.EFF(3),e.k0s()(),e.DNE(4,Mn,28,7,"div",19),e.j41(5,"div",20),e.DNE(6,On,2,0,"button",21)(7,En,2,0,"button",21)(8,Pn,2,4,"button",22)(9,vn,5,0,"div"),e.k0s(),e.DNE(10,$n,3,0,"div",23),e.k0s()),2&a){const t=i.$implicit,o=e.XpG(2);e.R7$(3),e.JRh(t.mbGroup.title),e.R7$(),e.vxM(4,t.currentRelease?4:-1),e.R7$(2),e.vxM(6,o.matcher.isRunning?-1:6),e.R7$(),e.vxM(7,!o.matcher.isRunning&&t.releases.length>1?7:-1),e.R7$(),e.vxM(8,!o.matcher.isRunning&&t.currentRelease?8:-1),e.R7$(),e.vxM(9,t.selecting?9:-1),e.R7$(),e.vxM(10,t.expanded&&t.currentRelease?10:-1)}}function Xn(a,i){if(1&a&&(e.j41(0,"div",15),e.Z7z(1,wn,11,7,"div",16,e.fX1),e.k0s()),2&a){const t=e.XpG();e.R7$(),e.Dyx(t.matcher.matchTree.groups)}}let P,De=(()=>{class a{matcher;chooseReleaseRequest=new e.bkB;chooseRelease(t,o){this.chooseReleaseRequest.emit({group:t,release:o})}allowDrop(t){t.preventDefault()}drop(t,o,n,s){if(t.preventDefault(),!t.dataTransfer)return;const r=t.dataTransfer.getData("text");this.matcher?.selectMatch(r,o,n,s)}static \u0275fac=function(o){return new(o||a)};static \u0275cmp=e.VBU({type:a,selectors:[["app-match-results"]],inputs:{matcher:"matcher"},outputs:{chooseReleaseRequest:"chooseReleaseRequest"},decls:1,vars:1,consts:()=>{let t,o,n,s,r,c,_,p,d,C,T,O,A,b,v,D,g,Le,ye,Ge;return t=$localize`:␟9c5fdf21ec2cc7baa6f062f2dc417af45c8dbe60␟2332107018974972998:Score:`,o=$localize`:␟181d9cc99eed91d7852bd736b8a79c5907b45171␟2179591033024116895:Artist: `,n=$localize`:␟61402178af0b9f5caed0039f945af2a1aa44a199␟5368772156211954254:Type: `,s=$localize`:␟05fa0bded36de6e73a1fa44838b627349dace044␟6899410641137821757:Date:`,r=$localize`:␟33d64f1b5578cd3ff6413272a9bf0384e9c8626b␟4863373404095396982:Country:`,c=$localize`:␟65bf4c02f9a036e9636d10cf81f1b20d7ed4aaf9␟5867760138967480184:Tracks:`,_=$localize`:␟531e01644fee19759b4ce5a878390932ef913389␟8058716232090816784:All tracks matched`,p=$localize`:␟095b08f20cb01fbf9e6c14b9cc035aac5590010d␟7216252099739448639:Unmatched tracks!`,d=$localize`:␟7879085ff555563b56e31cc46b16fe088b1e491e␟8270728553315605434:Total Tracks:`,C=$localize`:␟cb98522066062d775f3b81f29c898a7cc76292c0␟1575810254412583888:Tracks`,T=$localize`:␟43e86094b83c2bf239e942d85e71da6e8d64fb63␟4587452935087847438:Releases`,O=$localize`:␟0ba8f2b283773330626571f482bea4faf3353d3b␟5992669063673581330:Choose `,A=$localize`:␟9c5fdf21ec2cc7baa6f062f2dc417af45c8dbe60␟2332107018974972998:Score:`,b=$localize`:␟05fa0bded36de6e73a1fa44838b627349dace044␟6899410641137821757:Date:`,v=$localize`:␟33d64f1b5578cd3ff6413272a9bf0384e9c8626b␟4863373404095396982:Country:`,D=$localize`:␟65bf4c02f9a036e9636d10cf81f1b20d7ed4aaf9␟5867760138967480184:Tracks:`,g=$localize`:␟531e01644fee19759b4ce5a878390932ef913389␟8058716232090816784:All tracks matched`,Le=$localize`:␟095b08f20cb01fbf9e6c14b9cc035aac5590010d␟7216252099739448639:Unmatched tracks!`,ye=$localize`:␟8a27a855a00b08d2ca981207638ea9097032412b␟3250391385569692601:Media`,Ge=$localize`:␟588011b76eaa42ff648f34c6418d8732f3b894b8␟6043994951771855575:Remove Matching`,[t,o,n,s,r,c,d,C,T,O,A,b,v,D,ye,[1,"match-results"],[1,"match-releasegroup"],[1,"match-releasegroup-title"],[1,"value"],[1,"match-release-info"],[1,"match-select-releases"],[1,"button-on-background"],[1,"button-primary",3,"ngClass"],[1,"match-tracks-info"],[1,"label"],[3,"score"],["title",_,1,"icon-checkmark"],["title",p,1,"icon-warning"],[1,"button-on-background",3,"click"],[1,"button-primary",3,"click","ngClass"],[1,"select"],[1,"select",3,"click"],["type","radio","name","release",3,"checked"],[3,"click"],["title",g,1,"icon-checkmark"],["title",Le,1,"icon-warning"],[1,"match-track-info",3,"ngClass"],[1,"match-track-info",3,"drop","dragover","ngClass"],[3,"title"],["title",Ge,3,"click"],[1,"icon-trash"]]},template:function(o,n){1&o&&e.DNE(0,Xn,3,0,"div",15),2&o&&e.vxM(0,n.matcher?0:-1)},dependencies:[y.YU,u.qT,u.cb,u.cV,be,y.QX,cn,Ne.f,_n.W],styles:["[_nghost-%COMP%]   .match-results[_ngcontent-%COMP%]{flex:1 1 auto;overflow-y:auto;overflow-x:auto}[_nghost-%COMP%]   .match-results[_ngcontent-%COMP%]   .icon-checkmark[_ngcontent-%COMP%]{color:var(--primary)}[_nghost-%COMP%]   .match-results[_ngcontent-%COMP%]   .icon-warning[_ngcontent-%COMP%]{color:var(--accent)}[_nghost-%COMP%]   .match-results[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:var(--on-background-highlight);padding-right:5px}[_nghost-%COMP%]   .match-results[_ngcontent-%COMP%]   .match-releasegroup[_ngcontent-%COMP%]{padding:5px 5px 5px 15px}[_nghost-%COMP%]   .match-results[_ngcontent-%COMP%]   .match-releasegroup[_ngcontent-%COMP%]   .match-release-info[_ngcontent-%COMP%], [_nghost-%COMP%]   .match-results[_ngcontent-%COMP%]   .match-releasegroup[_ngcontent-%COMP%]   .match-tracks-info[_ngcontent-%COMP%]{font-size:.8em}[_nghost-%COMP%]   .match-results[_ngcontent-%COMP%]   .match-releasegroup[_ngcontent-%COMP%]   .match-release-info[_ngcontent-%COMP%], [_nghost-%COMP%]   .match-results[_ngcontent-%COMP%]   .match-releasegroup[_ngcontent-%COMP%]   .match-tracks-info[_ngcontent-%COMP%], [_nghost-%COMP%]   .match-results[_ngcontent-%COMP%]   .match-releasegroup[_ngcontent-%COMP%]   .match-select-releases[_ngcontent-%COMP%]{padding-top:4px}[_nghost-%COMP%]   .match-results[_ngcontent-%COMP%]   .match-releasegroup[_ngcontent-%COMP%]   .match-select-releases[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:.7em;line-height:.7em;vertical-align:top}[_nghost-%COMP%]   .match-results[_ngcontent-%COMP%]   .match-releasegroup[_ngcontent-%COMP%]   app-image-base64[_ngcontent-%COMP%]{height:32px;width:32px}[_nghost-%COMP%]   .match-results[_ngcontent-%COMP%]   .match-releasegroup[_ngcontent-%COMP%]   .match-track-info[_ngcontent-%COMP%]{padding-top:2px;padding-bottom:2px;border-top:1px solid var(--background-border)}[_nghost-%COMP%]   .match-results[_ngcontent-%COMP%]   .match-releasegroup[_ngcontent-%COMP%]   .match-track-info.missing[_ngcontent-%COMP%]{color:var(--accent)}[_nghost-%COMP%]   .match-results[_ngcontent-%COMP%]   .match-releasegroup[_ngcontent-%COMP%]   .match-release[_ngcontent-%COMP%]{white-space:nowrap;padding:5px 5px 5px 42px}"]})}return a})();function j(a){return a.replace(/[& \-.]/g,"").toLowerCase()}function Q(a){const i=j(a);return P||(P={},se.forEach(t=>{P[j(t)]=t})),P[i]}function Z(a,i){const t=a.slice(0);for(const o of i){const n=t.find(s=>s.name===o.name);n?n.count+=o.count:t.push(o)}return t}function Ie(a){if(!a)return[];const i=[];for(const t of a){const o=Q(t.name);if(o){const n=i.find(s=>s.name===o);n?n.count+=1:i.push({name:o,count:1})}}return i}function zn(a,i){1&a&&e.nrm(0,"i",6)}function Vn(a,i){if(1&a){const t=e.RV6();e.j41(0,"label",11)(1,"input",12),e.mxI("ngModelChange",function(n){const s=e.eBV(t).$implicit;return e.DH7(s.checked,n)||(s.checked=n),e.Njj(n)}),e.k0s(),e.EFF(2),e.k0s()}if(2&a){const t=i.$implicit;e.Mz_("title","Usage Count: ",t.tag.count,""),e.R7$(),e.R50("ngModel",t.checked),e.R7$(),e.Lme(" ",t.tag.name," [",t.tag.count,"] ")}}function Yn(a,i){if(1&a){const t=e.RV6();e.Z7z(0,Vn,3,5,"label",11,e.fX1),e.j41(2,"label",7)(3,"input",12),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.customGenre.checked,n)||(s.customGenre.checked=n),e.Njj(n)}),e.k0s(),e.j41(4,"input",13),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.customGenre.text,n)||(s.customGenre.text=n),e.Njj(n)}),e.k0s()()}if(2&a){const t=e.XpG();e.Dyx(t.genres),e.R7$(3),e.R50("ngModel",t.customGenre.checked),e.R7$(),e.R50("ngModel",t.customGenre.text)}}function Jn(a,i){if(1&a&&e.nrm(0,"app-match-coverart",8),2&a){const t=e.XpG();e.Y8G("data",t.coverArtSearch)}}let ee=(()=>{class a{app;jam;isRunning=!1;loadLyricsRequest=new e.bkB;loadMoodsRequest=new e.bkB;coverArt;isGenreSearchRunning=!1;genres;customGenre={text:"",checked:!0};coverArtSearch;constructor(t,o){this.app=t,this.jam=o}getGenres(){const t=(this.genres||[]).filter(o=>o.checked).map(o=>o.tag.name);return this.customGenre.checked&&this.customGenre.text.trim().length>0&&t.push(this.customGenre.text.trim()),t}getCoverArtImages(){return this.coverArt?this.coverArt.getChecked():[]}loadGenres(t,o,n){var s=this;return(0,h.A)(function*(){s.isGenreSearchRunning=!0;const r=[];o.mbGroup.secondaryTypes&&o.mbGroup.secondaryTypes.find(d=>["audiobook","audio drama","spokenword"].includes(d))&&r.push({count:1,name:"Audiobook"});for(const d of t)if(d.track.tag?.genres&&d.track.tag.genres.length>0){const C=d.track.tag.genres[0],T=r.find(O=>O.name===C);T?T.count++:r.push({count:1,name:C})}let c=function Fn(a){if(!a||!a.length)return[];const i=[];for(const t of a){const o=t.name.split("/").map(n=>n.trim()).filter(n=>n.length>0);for(const n of o){const s=Q(n);if(s){const r=i.find(c=>c.name===s);r?r.count+=t.count:i.push({name:s,count:t.count})}}}return i.sort((t,o)=>o.count-t.count)}(r),_=[];n.mbRelease.tags&&(_=_.concat(n.mbRelease.tags)),o.mbGroup.tags&&(_=_.concat(o.mbGroup.tags)),c=Z(c,function Un(a){if(!a||!a.length)return[];const i=[];for(const t of a){const o=t.name.split(";").map(n=>n.trim()).filter(n=>n.length>0);for(const n of o){const s=Q(n);if(s){const r=i.find(c=>c.name===s);r?r.count+=t.count:i.push({name:s,count:t.count})}}}return i.sort((t,o)=>o.count-t.count)}(_));const p=(yield s.jam.metadata.lastfmLookup({type:f._1.album,mbID:n.mbRelease.id})).data;if(p.album&&(c=Z(c,function jn(a){return a.tags?Ie(a.tags):[]}(p.album))),0===c.length&&n.mbRelease.artistCredit.length>0){const d=(yield s.jam.metadata.lastfmLookup({type:f._1.artist,mbID:n.mbRelease.artistCredit[0].artist.id})).data;d&&d.artist&&(c=Z(c,function Hn(a){return a?Ie(a.tags):[]}(d.artist)))}s.genres=c.sort((d,C)=>C.count-d.count).map((d,C)=>({tag:d,checked:0===C})),s.isGenreSearchRunning=!1})()}static \u0275fac=function(o){return new(o||a)(e.rXU(N.d3),e.rXU(f.UA))};static \u0275cmp=e.VBU({type:a,selectors:[["app-match-apply"]],viewQuery:function(o,n){if(1&o&&e.GBs(W,5),2&o){let s;e.mGM(s=e.lsd())&&(n.coverArt=s.first)}},inputs:{isRunning:"isRunning"},outputs:{loadLyricsRequest:"loadLyricsRequest",loadMoodsRequest:"loadMoodsRequest"},decls:14,vars:7,consts:()=>{let t,o,n,s;return t=$localize`:␟33c750c68c3e29d7fee57a180f508d8d202bdd04␟1790640569414740156:Genres`,o=$localize`:␟ac0f81713a84217c9bd1d9bb460245d8190b073f␟5937251202465808296:More`,n=$localize`:␟64573fe39daeccde26bea87757731f84dbbb1e20␟8931780837517904129:Load Lyrics`,s=$localize`:␟fcc14666a1cf83864f70059f03a0a3855d901235␟896097993346243998:Load AcousticBrainz Moods`,[t,o,n,s,[1,"match-apply"],[1,"section"],[1,"icon-spin","icon-spinner"],[1,"select"],[3,"data"],[1,"match-track-moods"],[1,"button-on-background",3,"click"],[1,"select",3,"title"],["type","checkbox",3,"ngModelChange","ngModel"],["type","text",3,"ngModelChange","ngModel"]]},template:function(o,n){1&o&&(e.j41(0,"div",4)(1,"div")(2,"div",5),e.pXf(3,0),e.k0s(),e.DNE(4,zn,1,0,"i",6)(5,Yn,5,2,"label",7),e.k0s(),e.DNE(6,Jn,1,1,"app-match-coverart",8),e.j41(7,"div",9)(8,"div",5),e.pXf(9,1),e.k0s(),e.j41(10,"button",10),e.bIt("click",function(){return n.loadLyricsRequest.emit()}),e.pXf(11,2),e.k0s(),e.j41(12,"button",10),e.bIt("click",function(){return n.loadMoodsRequest.emit()}),e.pXf(13,3),e.k0s()()()),2&o&&(e.R7$(4),e.vxM(4,n.isGenreSearchRunning?4:-1),e.R7$(),e.vxM(5,n.genres&&!n.isGenreSearchRunning?5:-1),e.R7$(),e.vxM(6,n.coverArtSearch?6:-1),e.R7$(4),e.AVh("disabled",!n.isRunning),e.R7$(2),e.AVh("disabled",!n.isRunning))},dependencies:[u.me,u.Zm,u.BC,u.vS,W],styles:["[_nghost-%COMP%]   .match-apply[_ngcontent-%COMP%]{flex:1 1 auto;overflow-y:auto;overflow-x:auto;padding:15px}[_nghost-%COMP%]   .match-apply[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{padding-bottom:10px}[_nghost-%COMP%]   .match-apply[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{padding-right:4px;font-size:.9em;text-transform:uppercase}[_nghost-%COMP%]   .match-apply[_ngcontent-%COMP%]   .select[_ngcontent-%COMP%]{padding-top:2px;padding-bottom:2px;display:block;font-size:.9em}[_nghost-%COMP%]   .match-apply[_ngcontent-%COMP%]   .select[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{margin-right:4px}[_nghost-%COMP%]   .match-apply[_ngcontent-%COMP%]   .select[_ngcontent-%COMP%]:hover{background-color:var(--background-hover)}[_nghost-%COMP%]   .section[_ngcontent-%COMP%]{color:var(--on-background-highlight);text-transform:uppercase;padding-bottom:10px;white-space:nowrap}[_nghost-%COMP%]   app-match-coverart[_ngcontent-%COMP%]{border-top:1px solid var(--background-border)}[_nghost-%COMP%]   .match-track-moods[_ngcontent-%COMP%]{border-top:1px solid var(--background-border);padding-top:15px}"]})}return a})();class Kn{frameValues={};build(){return this.frameValues}text(i,t){return t&&(this.frameValues[i]=[{id:i,value:{text:t}}]),this}idText(i,t,o){if(o){const n={id:i,value:{id:t,text:o}},s=(this.frameValues[i]||[]).filter(r=>r.value.id!==t);this.frameValues[i]=s.concat([n])}return this}nrAndTotal(i,t,o){if(t){const n=t.toString()+(o?`/${o.toString()}`:"");this.frameValues[i]=[{id:i,value:{text:n}}]}return this}keyTextList(i,t,o){if(o){const n=this.frameValues[i]||[],s=n.length>0?n[0]:{id:i,value:{list:[]}};s.value.list.push(t),s.value.list.push(o),this.frameValues[i]=[s]}return this}bool(i,t){return void 0!==t&&(this.frameValues[i]=[{id:i,value:{bool:t}}]),this}idLangText(i,t,o,n){if(t){const s=n||"",r=(this.frameValues[i]||[]).filter(_=>_.value.id!==s);this.frameValues[i]=r.concat([{id:i,value:{id:s,language:o||"",text:t}}])}return this}addPicture(i,t,o,n,s){return this.frameValues[i]=(this.frameValues[i]||[]).concat([{id:i,value:{description:o||"",pictureType:t,bin:s,mimeType:n}}]),this}addChapter(i,t,o,n,s,r,c){return this.frameValues[i]=(this.frameValues[i]||[]).concat([{id:i,value:{id:t,start:o,end:n,offset:s,offsetEnd:r},subframes:c}]),this}}class qn{rawBuilder=new Kn;buildFrames(){return this.rawBuilder.build()}artist(i){return this.rawBuilder.text("TPE1",i),this}artistSort(i){return this.rawBuilder.text("TSOP",i),this}albumArtist(i){return this.rawBuilder.text("TPE2",i),this}albumArtistSort(i){return this.rawBuilder.text("TSO2",i),this}album(i){return this.rawBuilder.text("TALB",i),this}albumSort(i){return this.rawBuilder.text("TSOA",i),this}originalAlbum(i){return this.rawBuilder.text("TOAL",i),this}originalArtist(i){return this.rawBuilder.text("TOPE",i),this}originalDate(i){return this.rawBuilder.text("TDOR",i),this}title(i){return this.rawBuilder.text("TIT2",i),this}work(i){return this.rawBuilder.text("TIT1",i),this}titleSort(i){return this.rawBuilder.text("TSOT",i),this}genre(i){return this.rawBuilder.text("TCON",i),this}bmp(i){return this.rawBuilder.text("TBPM",i?i.toString():void 0),this}mood(i){return this.rawBuilder.text("TMOO",i),this}media(i){return this.rawBuilder.text("TMED",i),this}language(i){return this.rawBuilder.text("TLAN",i),this}grouping(i){return this.rawBuilder.text("GRP1",i),this}date(i){return this.rawBuilder.text("TDRC",i),this}track(i,t){return this.rawBuilder.nrAndTotal("TRCK",i,t),this}disc(i,t){return this.rawBuilder.nrAndTotal("TPOS",i,t),this}year(i){return this.rawBuilder.text("TORY",i?i.toString():void 0),this}artists(i){return this.rawBuilder.idText("TXXX","Artists",i),this}isCompilation(i){return void 0!==i&&this.rawBuilder.bool("TCMP",1===i||"true"===i||!0===i),this}originalYear(i){return this.rawBuilder.text("TYER",i),this}composer(i){return this.rawBuilder.text("TCOM",i),this}composerSort(i){return this.rawBuilder.text("TSOC",i),this}remixer(i){return this.rawBuilder.text("TPE4",i),this}label(i){return this.rawBuilder.text("TPUB",i),this}subtitle(i){return this.rawBuilder.text("TIT3",i),this}discSubtitle(i){return this.rawBuilder.text("TSST",i),this}lyricist(i){return this.rawBuilder.text("TEXT",i),this}lyrics(i,t,o){return this.rawBuilder.idLangText("USLT",i,t,o),this}encoder(i){return this.rawBuilder.text("TENC",i),this}encoderSettings(i){return this.rawBuilder.text("TSSE",i),this}key(i){return this.rawBuilder.text("TKEY",i),this}copyright(i){return this.rawBuilder.text("TCOP",i),this}isrc(i){return this.rawBuilder.text("TSRC",i),this}barcode(i){return this.rawBuilder.idText("TXXX","BARCODE",i),this}asin(i){return this.rawBuilder.idText("TXXX","ASIN",i),this}catalogNumber(i){return this.rawBuilder.idText("TXXX","CATALOGNUMBER",i),this}script(i){return this.rawBuilder.idText("TXXX","SCRIPT",i),this}license(i){return this.rawBuilder.idText("TXXX","LICENSE",i),this}website(i){return this.rawBuilder.text("WOAR",i),this}movement(i){return this.rawBuilder.text("MVNM",i),this}movementNr(i,t){return this.rawBuilder.nrAndTotal("MVIN",i,t),this}writer(i){return this.rawBuilder.idText("TXXX","Writer",i),this}custom(i,t){return this.rawBuilder.idText("TXXX","VERSION",t),this}musicianCredit(i,t){return this.rawBuilder.keyTextList("TMCL",i,t),this}involved(i,t){return this.rawBuilder.keyTextList("TIPL",i,t),this}discogsArtistID(i){return this.rawBuilder.idText("TXXX","Discogs Artist ID",i),this}discogsAlbumArtistID(i){return this.rawBuilder.idText("TXXX","Discogs Album Artist ID",i),this}discogsLabelID(i){return this.rawBuilder.idText("TXXX","Discogs Label ID",i),this}discogsMasterReleaseID(i){return this.rawBuilder.idText("TXXX","Discogs Master Release ID",i),this}discogsReleaseID(i){return this.rawBuilder.idText("TXXX","Discogs Release ID",i),this}discogsVotes(i){return this.rawBuilder.idText("TXXX","Discogs Votes",i),this}discogsRating(i){return this.rawBuilder.idText("TXXX","Discogs Rating",i),this}mbAlbumStatus(i){return this.rawBuilder.idText("TXXX","MusicBrainz Album Status",i),this}mbAlbumType(i){return this.rawBuilder.idText("TXXX","MusicBrainz Album Type",i),this}mbAlbumReleaseCountry(i){return this.rawBuilder.idText("TXXX","MusicBrainz Album Release Country",i),this}mbTrackID(i){return this.rawBuilder.idText("UFID","http://musicbrainz.org",i),this}mbReleaseTrackID(i){return this.rawBuilder.idText("TXXX","MusicBrainz Release Track Id",i),this}mbAlbumID(i){return this.rawBuilder.idText("TXXX","MusicBrainz Album Id",i),this}mbOriginalAlbumID(i){return this.rawBuilder.idText("TXXX","MusicBrainz Original Album Id",i),this}mbArtistID(i){return this.rawBuilder.idText("TXXX","MusicBrainz Artist Id",i),this}mbOriginalArtistID(i){return this.rawBuilder.idText("TXXX","MusicBrainz Original Artist Id",i),this}mbAlbumArtistID(i){return this.rawBuilder.idText("TXXX","MusicBrainz Album Artist Id",i),this}mbReleaseGroupID(i){return this.rawBuilder.idText("TXXX","MusicBrainz Release Group Id",i),this}mbWorkID(i){return this.rawBuilder.idText("TXXX","MusicBrainz Work Id",i),this}mbTRMID(i){return this.rawBuilder.idText("TXXX","MusicBrainz TRM Id",i),this}mbDiscID(i){return this.rawBuilder.idText("TXXX","MusicBrainz Disc Id",i),this}acoustidID(i){return this.rawBuilder.idText("TXXX","Acoustid Id",i),this}acoustidFingerprint(i){return this.rawBuilder.idText("TXXX","Acoustid Fingerprint",i),this}musicIPPUID(i){return this.rawBuilder.idText("TXXX","MusicIP PUID",i),this}comment(i,t){return this.rawBuilder.idText("COMM",i,t),this}trackLength(i){return this.rawBuilder.text("TLEN",i?i.toString():void 0),this}mbTrackDisambiguation(i){return this.rawBuilder.idText("TXXX","MusicBrainz Track Disambiguation",i),this}addPicture(i,t,o,n){return this.rawBuilder.addPicture("APIC",i,t,o,n),this}chapter(i,t,o,n,s,r){return this.rawBuilder.addChapter("CHAP",i,t,o,n,s,r),this}}function ii(a,i,t){if(!a.mbTrack)return;const o=a.mbTrack,n=a.mbRelease,s=a.mbGroup,r=a.mbMedia,c=new qn;return function Qn(a,i,t,o,n,s){a.mbTrackID(t.recording?.id).date(o?.date).originalDate(n?.firstReleaseDate).album(o?.title).albumSort(o?.sortName).title(t.title).media(s?.format).track(t.position,s?.trackCount).disc(s?.position,o?.media.length).trackLength(t.length).language(o?.textRepresentation.language).script(o?.textRepresentation.script).barcode(o?.barcode).isrc(t.recording?.isrcs&&t.recording.isrcs.length>0?t.recording.isrcs[0]:void 0).mbAlbumStatus(o?.status?o.status.toLowerCase():void 0).mbAlbumReleaseCountry(o?.country).mbAlbumID(o?.id).mbReleaseTrackID(t.id).mbReleaseGroupID(o?.releaseGroup.id).mbTrackDisambiguation(t.recording?.disambiguation).asin(o?.asin).discSubtitle(s?.title),t.recording?.aliases&&t.recording.aliases.length>0&&t.recording.aliases[0].sortName&&t.recording.aliases[0].sortName!==t.title&&a.titleSort(t.recording.aliases[0].sortName);const r=o?.artistCredit[0];if(r&&a.albumArtist(r.name).albumArtistSort(r.artist.sortName).mbAlbumArtistID(r.artist.id),t.artistCredit&&t.artistCredit.length>0){const _=t.artistCredit.map(d=>`${d.artist.name} ${d.joinphrase}`).join(" ").replace(/ {2}/g," ").trim(),p=t.artistCredit.map(d=>(d.artist.sortName?d.artist.sortName:"").trim()).filter(d=>d.length>0).join(" & ").replace(/ {2}/g," ").trim();a.artist(_).artistSort(p).mbArtistID(t.artistCredit[0].artist.id)}else r&&a.artist(r.name).artistSort(r.artist.sortName).mbArtistID(r.artist.id);const c=o?.labelInfo[0];c&&(c.label&&a.label(c.label.name),a.catalogNumber(c.catalogNumber))}(c,0,o,n,s,r),function Zn(a,i,t,o){let n=[];o?.releaseGroup.primaryType&&n.push(o.releaseGroup.primaryType),o?.releaseGroup.secondaryTypes&&(n=n.concat(o.releaseGroup.secondaryTypes)),n.length>0&&a.mbAlbumType(n.map(s=>s.toLowerCase()).join("/")),n.includes("compilation")&&a.isCompilation(!0)}(c,0,0,n),function Wn(a,i,t){if(t&&t.length>0)a.genre(t.slice(0,2).join("/"));else if(i.track.tagRaw){const o=i.track.tagRaw.frames.TCON;if(o){const n=o.map(s=>s.value.text);a.genre(n.slice(0,2).join("/"))}}}(c,a,i),function ei(a,i,t){if(t&&t.length>0)for(const o of t){let n=0;o.image.types.includes("Medium")?n=6:o.image.types.includes("Booklet")?n=5:o.image.types.includes("Front")?n=3:o.image.types.includes("Back")&&(n=4),o.base64&&a.addPicture(n,"",o.base64.mimeType,o.base64.base64)}else if(i.track.tagRaw){const o=i.track.tagRaw.frames.APIC;if(o)for(const n of o)a.addPicture(n.value.pictureType,n.value.description,n.value.mimeType,n.value.bin)}}(c,a,t),function ti(a,i){i.abdata?.moods&&i.abdata.moods.length>0&&a.mood(i.abdata.moods.join("/"))}(c,a),function ni(a,i,t){if(i.acoustidEntries&&t.recording?.id){const o=i.acoustidEntries.find(n=>n.recordingID===t.recording?.id);o&&a.acoustidID(o.acoustID)}}(c,a,o),a.lyrics&&c.lyrics(a.lyrics.lyrics),{version:4,frames:c.buildFrames()}}function oi(a,i){const t=[];if(a)for(const o of a)if(o.recordings)for(const n of o.recordings)if(n.releasegroups&&n.id)for(const s of n.releasegroups)if(s.id&&s.releases)for(const r of s.releases)if(r.id&&r.mediums)for(const c of r.mediums)t.push({releaseGroupID:s.id,releaseGroupName:s.title,releaseID:r.id,releaseName:r.title,mediaNr:c.position,mediaTrackCount:c.track_count,recordingID:n.id,recordingName:n.title,recordingDuration:n.duration,trackID:i.id,trackName:i.name,trackDuration:i.duration,score:o.score,acoustID:o.id});return t}class ai{releasegroups=[];add(i){let t=this.releasegroups.find(c=>c.id===i.releaseGroupID);t||(t={id:i.releaseGroupID,name:i.releaseGroupName,releases:[],score:0},this.releasegroups.push(t));let o=t.releases.find(c=>c.id===i.releaseID);o||(o={id:i.releaseID,name:i.releaseName,mediums:[],score:0},t.releases.push(o));let n=o.mediums.find(c=>c.nr===i.mediaNr);n||(n={nr:i.mediaNr,recordings:[],trackCount:i.mediaTrackCount,score:0},o.mediums.push(n));let s=n.recordings.find(c=>c.id===i.recordingID);s||(s={id:i.recordingID,name:i.recordingName,duration:i.recordingDuration,matches:[]},n.recordings.push(s));const r=s.matches.find(c=>c.trackID===i.trackID);r?r.score<i.score&&(r.score=i.score):s.matches.push({trackID:i.trackID,trackName:i.trackName,trackDuration:i.trackDuration,score:i.score,acoustID:i.acoustID})}}function ke(a){return a.replace(/[ .\-()[\]]/g,"").toLowerCase()}class ri{mbTrack;index;currentMatch;matchings=[];abData;constructor(i,t,o){this.mbTrack=i,this.index=o,this.matchings=this.createMatchingScores(t),this.currentMatch=this.matchings[0]}createMatchingScores(i){let t=[];return i.forEach((o,n)=>{const s={match:o,score:0,scores:this.createScores(o,n)};s.score=function si(a){const i=a.map(t=>[t.score*t.weight,t.weight]).reduce((t,o)=>[t[0]+o[0],t[1]+o[1]],[0,0]);return i[0]/i[1]}(s.scores),t.push(s)}),t=t.filter(o=>o.score>0).sort((o,n)=>n.score-o.score),t}createScores(i,t){const o=[];return this.scoreTitle(i,o),this.scoreTrackNr(i,o),this.scoreDuration(i,o),this.scoreAcoustid(i,o),o.push({name:"index",score:t===this.index?1:0,weight:.1}),o}scoreAcoustid(i,t){if(i.acoustidEntries&&this.mbTrack.recording?.id){const o=this.mbTrack.recording.id,n=i.acoustidEntries.find(s=>s.recordingID===o);n&&t.push({name:"acoustid",score:n.score,weight:1})}}scoreDuration(i,t){if(void 0!==this.mbTrack.length){const o=Math.abs(1e3*Math.round(i.track.duration||0)-(this.mbTrack.length||0));let n=0;0===o?n=1:o<1e3?n=.8:o<1e4&&(n=.2),t.push({name:"duration",score:n,weight:.2})}}scoreTrackNr(i,t){const o=i.track.tag?.trackNr||(0,S.Ne)(i.track.name);o>0&&t.push({name:"trackNr",score:o===this.mbTrack.position?1:0,weight:.2})}scoreTitle(i,t){const o=i.track.tag?.title||(0,S.ur)(i.track.name);if(o&&o.trim().length>0){const n=[ke(this.mbTrack.title||this.mbTrack.recording?.title||"Unknown")];for(const r of this.mbTrack.recording?.aliases||[]){const c=ke(r.name);n.push(c)}const s=n.map(r=>({title:r,score:(0,S.It)(o,r)})).sort((r,c)=>c.score-r.score);s.length>0&&t.push({name:"title",score:s[0].score,weight:1})}}}class ci{mbMedia;tracks=[];score=0;expanded;complete=!1;constructor(i,t,o){this.mbMedia=i,this.tracks=(i.tracks||[]).map((n,s)=>new ri(n,t,o+s))}updateScore(){this.score=0,this.complete=this.tracks.length>0;for(const i of this.tracks)i.currentMatch?this.score+=i.currentMatch.score:this.complete=!1;this.tracks.length>0?this.score=this.score/this.tracks.length:this.complete=!1}}class _i{mbRelease;media=[];score=0;loaded=!1;isLoading=!1;sortDate=0;totalTrack=0;expanded;complete;constructor(i){this.mbRelease=i,this.sortDate=function li(a){const i=(a||"").split("-");return new Date(i[0]?Number(i[0]):9999,i[1]?Number(i[1]):12,i[2]?Number(i[2]):31).valueOf()}(i.date),this.totalTrack=this.mbRelease.media.reduce((t,o)=>t+o.trackCount,0)}updateScore(){this.score=0,this.complete=this.media.length>0;for(const i of this.media)i.updateScore(),this.score=Math.max(i.score,this.score),i.complete||(this.complete=!1)}setLookupRelease(i,t){this.mbRelease=i,this.totalTrack=this.mbRelease.media.reduce((n,s)=>n+s.trackCount,0);let o=0;this.media=i.media.map(n=>{const s=new ci(n,t,o);return o+=n.trackCount,s}),this.cleanDuplicateMatchings(),this.updateScore()}cleanDuplicateMatchings(){const i={};for(const t of this.media)for(const o of t.tracks)o.currentMatch&&(i[o.currentMatch.match.track.id]=i[o.currentMatch.match.track.id]||[],i[o.currentMatch.match.track.id].push(o));for(const t of Object.keys(i)){let o=i[t];if(o.length>1){o=o.sort((n,s)=>(s.currentMatch?.score||0)-(n.currentMatch?.score||0)),o.shift();for(const n of o)n.currentMatch=void 0}}}}class di{mbGroup;releases=[];score=0;expanded;selecting;currentRelease;constructor(i){this.mbGroup=i;for(const t of i.releases||[])this.releases.push(new _i(t));this.releases=this.releases.sort((t,o)=>t.sortDate-o.sortDate)}findRelease(i){return this.releases.find(t=>t.mbRelease.id===i)}updateScore(){for(const i of this.releases)i.updateScore();this.score=this.currentRelease?this.currentRelease.score:0}enough(i){return!(!this.currentRelease||this.currentRelease.totalTrack!==i||!this.currentRelease.complete)}}class xe{groups=[];enough(i){return!!this.groups.find(t=>t.enough(i))}addReleaseGroup(i){const t=new di(i);return this.groups.push(t),t}findReleaseGroup(i){return this.groups.find(t=>t.mbGroup.id===i)}sort(){for(const i of this.groups)i.updateScore();this.groups=this.groups.sort((i,t)=>t.score-i.score)}}var k=function(a){return a[a.acoustID=0]="acoustID",a[a.musicbrainzRefresh=1]="musicbrainzRefresh",a[a.musicbrainzByTags=2]="musicbrainzByTags",a[a.auto=3]="auto",a}(k||{});class H{q;id;name;matchings=[];constructor(i){this.q=i,this.id=`musicbrainz-${JSON.stringify(i)}`,this.name=`MusicBrainz Search for ${Object.keys(i).filter(t=>"type"!==t).map(t=>`${t}: "${i[t]}"`).join(", ")}`}}class te{jam;notify;isRunning=!1;isAborted=!1;manual=!1;currentAction;folder;matchings=[];matchTree=new xe;manualSearchData={artists:[],albums:[],artist:"",releaseGroup:"",getAutoCompleteAlbumList:()=>{if(0===this.manualSearchData.albums.length)for(const i of this.matchings){const t=(i.track?.tag?.album||"").trim();t.length>0&&!this.manualSearchData.albums.includes(t)&&this.manualSearchData.albums.push(t)}return this.manualSearchData.albums},getAutoCompleteArtistList:()=>{if(0===this.manualSearchData.artists.length)for(const i of this.matchings){const t=(i.track?.tag?.artist||"").trim();t.length>0&&!this.manualSearchData.artists.includes(t)&&this.manualSearchData.artists.push(t)}return this.manualSearchData.artists}};constructor(i,t){this.jam=i,this.notify=t}static cleanAlbumName(i){let t=i.indexOf("("),o=i;return t>1&&(o=o.slice(0,t)),t=o.indexOf("["),t>1&&(o=o.slice(0,t)),o=o.trim(),0===o.length?i:o}abort(){this.matchings=[],this.isAborted=!0}stop(){this.isRunning&&(this.isAborted=!0)}start(i){this.isRunning||(this.isAborted=!1,this.isRunning=!0,this.run(i).then(()=>{this.matchTree.sort(),this.isRunning=!1,this.isAborted=!1,this.currentAction=""}).catch(t=>{this.notify.error(t),this.isRunning=!1,this.isAborted=!1,this.currentAction=""}))}clear(){this.isRunning||(this.matchTree=new xe)}manualSearch(){this.isRunning||(this.isAborted=!1,this.isRunning=!0,this.searchManual().then(()=>{this.isRunning=!1,this.isAborted=!1,this.currentAction=""}).catch(i=>{this.notify.error(i),this.isRunning=!1,this.isAborted=!1,this.currentAction=""}))}prepare(i,t){this.matchings=i,this.folder=t,this.isRunning||(this.isAborted=!1)}selectMatch(i,t,o,n){const s=this.matchings.find(c=>c.track.id===i);if(!s)return;let r=n.matchings.find(c=>c.match.track.id===i);r||(r={match:s,score:1,scores:[]},n.matchings.push(r)),r.score=1,r.scores.find(c=>"Manual Match"===c.name)||r.scores.push({name:"Manual Match",score:1,weight:1});for(const c of o.media)for(const _ of c.tracks)_.currentMatch&&_.currentMatch.match.track.id===s.track.id&&(_.currentMatch=void 0);n.currentMatch=r,t.updateScore()}setManualSearch(){if(this.manual=!0,0===this.manualSearchData.artist.length){const i=this.manualSearchData.getAutoCompleteArtistList();i.length>0&&(this.manualSearchData.artist=i[0])}if(0===this.manualSearchData.releaseGroup.length){const i=this.manualSearchData.getAutoCompleteAlbumList();i.length>0?this.manualSearchData.releaseGroup=i[0]:this.folder&&(this.manualSearchData.releaseGroup=this.folder.name)}}apply(i,t){for(const o of t.media)for(const n of o.tracks)n.currentMatch&&(n.currentMatch.match.mbTrack=n.mbTrack,n.currentMatch.match.mbMedia=o.mbMedia,n.currentMatch.match.mbRelease=t.mbRelease,n.currentMatch.match.mbGroup=i.mbGroup)}stopApply(){for(const i of this.matchings)i.mbTrack=void 0,i.mbMedia=void 0,i.mbRelease=void 0,i.mbGroup=void 0,i.genres=void 0}setRunning(i){this.currentAction=i,this.isRunning=!0}stopRunning(){this.isRunning=!1,this.currentAction=""}searchManual(){var i=this;return(0,h.A)(function*(){const t={type:f.gE.releaseGroup};if(i.manualSearchData.artist&&i.manualSearchData.artist.trim().length>0&&(t.artist=i.manualSearchData.artist),i.manualSearchData.releaseGroup&&i.manualSearchData.releaseGroup.trim().length>0&&(t.releasegroup=i.manualSearchData.releaseGroup),Object.keys(t).length>1){const o=new H(t);yield i.runQuery(o,[])}})()}setRelease(i,t){i.currentRelease=t,t.loaded||this.loadRelease(t).catch(o=>{this.notify.error(o)})}removeMatching(i,t,o){o.currentMatch=void 0,i.updateScore()}loadLyrics(i){this.isRunning||!i||(this.setRunning("Searching Lyrics"),this.loadLyricsOVH(i).then(()=>{this.stopRunning()}).catch(t=>{this.stopRunning(),this.notify.error(t)}))}loadMoods(i){this.isRunning||!i||(this.setRunning("Searching Moods"),this.loadAcousticBrainz(i).then(()=>{this.stopRunning()}).catch(t=>{this.stopRunning(),this.notify.error(t)}))}loadAcousticBrainz(i){var t=this;return(0,h.A)(function*(){for(const o of i.media)for(const n of o.tracks)if(!n.abData&&n.currentMatch?.match?.mbTrack?.recording?.id){const s=(yield t.jam.metadata.acousticbrainzLookup({mbID:n.currentMatch.match.mbTrack.recording.id})).data;if(s.highlevel){const r=[],c=[],_=[],p=[],d=Object.keys(s.highlevel);for(const T of d){const O=s.highlevel[T].value;s.highlevel[T].probability>.8&&!O.includes("not_")&&(T.startsWith("mood_")||"timbre"===T||"danceability"===T?c.includes(O)||c.push(O):T.startsWith("genre_")?r.includes(O)||r.push(O):T.startsWith("tonal_")||"voice_instrumental"===T?_.includes(O)||_.push(O):p.includes(O)||p.push(O))}const C={genres:r,moods:c,tonal:_,other:p};n.abData=C,n.currentMatch.match.abdata=C}}})()}shouldStop(){return this.matchTree.enough(this.matchings.length)||this.isAborted}acoustId(){var i=this;return(0,h.A)(function*(){i.currentAction="Checking files with AcoustID";let t=[];for(const n of i.matchings){if(!n.acoustidEntries){i.currentAction=`Checking files with AcoustID: ${n.track.name}`;try{const s=yield i.jam.metadata.acoustidLookup({trackID:n.track.id});n.acoustidEntries=oi(s.data,n.track)}catch(s){console.error(s)}if(i.isAborted)return}n.acoustidEntries&&(t=t.concat(n.acoustidEntries))}const o=new ai;for(const n of t)o.add(n);for(const n of o.releasegroups){if(i.shouldStop())return;let s=i.matchTree.findReleaseGroup(n.id);if(s||(s=yield i.addReleaseGroupByID(n.id)),s&&!s.currentRelease&&(yield i.loadBestMatchingCurrentRelease(s),i.shouldStop()))return;i.matchTree.sort()}})()}loadLyricsOVH(i){var t=this;return(0,h.A)(function*(){for(const o of i.media)for(const n of o.tracks)if(n.currentMatch&&!n.currentMatch.match.lyrics&&n.mbTrack.artistCredit&&n.mbTrack.artistCredit.length>0){const s=n.mbTrack.artistCredit[0].name,r=n.mbTrack.title;n.currentMatch.match.lyrics=(yield t.jam.metadata.lyricsovhSearch({title:r,artist:s})).data}})()}loadRelease(i){var t=this;return(0,h.A)(function*(){if(i&&!i.loaded&&!i.isLoading){i.isLoading=!0;try{t.currentAction=`Loading MusicBrainz Release: ${i.mbRelease.id}`;const o=yield t.jam.metadata.musicbrainzLookup({type:f.kv.release,mbID:i.mbRelease.id});if(!o.data?.release)return Promise.reject(Error("Got empty data"));i.setLookupRelease(o.data.release,t.matchings),i.loaded=!0,i.isLoading=!1}catch(o){return i.isLoading=!1,Promise.reject(o)}}})()}addReleaseGroupByReleaseID(i){var t=this;return(0,h.A)(function*(){t.currentAction=`Loading MusicBrainz Release: ${i}`;const o=yield t.jam.metadata.musicbrainzLookup({type:f.kv.release,mbID:i});return o.data.release?t.addReleaseGroupByID(o.data.release.releaseGroup.id):Promise.reject(Error("Got empty data"))})()}addReleaseGroupByID(i){var t=this;return(0,h.A)(function*(){let o=t.matchTree.findReleaseGroup(i);if(!o){t.currentAction=`Loading MusicBrainz Release Group: ${i}`;const n=yield t.jam.metadata.musicbrainzLookup({type:f.kv.releaseGroup,mbID:i});o=t.matchTree.addReleaseGroup(n.data.releaseGroup)}return o})()}buildQuickQueries(){const i=[],t=[],o=[];for(const n of this.matchings)if(n.track.tag&&n.track.tag.album){const s=te.cleanAlbumName(n.track.tag.album);n.track.tag.album&&!t.includes(s)&&t.push(s),n.track.tag.artist&&!o.includes(n.track.tag.artist)&&o.push(n.track.tag.artist)}return 1===t.length&&i.push(new H({type:f.gE.releaseGroup,releasegroup:t[0],artist:o.length>0?o[0]:void 0})),this.folder?.tag&&i.push(new H({type:f.gE.releaseGroup,releasegroup:this.folder.name,artist:this.folder.tag.artist})),i}buildQueries(){const i=[],o=(n,s,r)=>{const c={type:n.type};for(const _ of Object.keys(n)){const p=n[_];if(void 0===p||""===p||""===p.toString().trim())return;const d=p.toString().split("(");d.length>0&&(c[_]=d[0])}r&&(c.tracks=this.matchings.length),((n,s)=>{const r=i.find(c=>c.id===n.id);r?r.matchings.push(s):(n.matchings.push(s),i.push(n))})(new H(c),s)};for(const n of this.matchings)o({type:f.gE.releaseGroup,releasegroup:n.track.tag?.album,artist:n.track.tag?.artist},n);for(const n of this.matchings)o({type:f.gE.release,release:n.track.tag?.album,artist:n.track.tag?.artist},n,!0);for(const n of this.matchings)o({type:f.gE.release,release:n.track.tag?.album,artist:n.track.tag?.artist},n);for(const n of this.matchings)if(n.track.tag?.title)o({type:f.gE.recording,recording:n.track.tag.title,release:n.track.tag.album,artist:n.track.tag.artist},n);else{const s=(0,S.ur)(n.track.name);o({type:f.gE.recording,recording:s,release:n.track.tag?.album,artist:n.track.tag?.artist},n)}for(const n of this.matchings)if(n.track.tag?.title)o({type:f.gE.recording,recording:n.track.tag.title,release:n.track.tag.album},n),o({type:f.gE.recording,recording:n.track.tag.title,artist:n.track.tag.artist},n);else{const s=(0,S.ur)(n.track.name);o({type:f.gE.recording,recording:s,release:n.track.tag?.album},n),o({type:f.gE.recording,recording:s,artist:n.track.tag?.artist},n)}for(const n of this.matchings)o({type:f.gE.releaseGroup,releasegroup:n.track.tag?.album},n),o({type:f.gE.release,release:n.track.tag?.album},n,!0),o({type:f.gE.release,release:n.track.tag?.album},n);for(const n of this.matchings)if(n.track.tag?.title)o({type:f.gE.recording,recording:n.track.tag.title},n);else{const s=(0,S.ur)(n.track.name);o({type:f.gE.recording,recording:s},n)}return i}loadBestMatchingCurrentRelease(i){var t=this;return(0,h.A)(function*(){const o=i.releases.sort((n,s)=>{const r=Math.abs((n.totalTrack||0)-t.matchings.length),c=Math.abs((s.totalTrack||0)-t.matchings.length);return r===c?n.sortDate-s.sortDate:r-c});for(const n of o){if(t.shouldStop())return;if(yield t.loadRelease(n),n.complete)return void(i.currentRelease=n)}i.releases.length>0&&(yield t.loadRelease(i.releases[0]),i.currentRelease=i.releases[0])})()}loadByReleaseGroups(i){var t=this;return(0,h.A)(function*(){for(const o of i){if(t.shouldStop())return;let n=t.matchTree.findReleaseGroup(o.id);n||(n=yield t.addReleaseGroupByID(o.id)),n&&!n.currentRelease&&(yield t.loadBestMatchingCurrentRelease(n))}})()}loadByReleases(i){var t=this;return(0,h.A)(function*(){for(const o of i){if(t.shouldStop())return;let n=t.matchTree.findReleaseGroup(o.releaseGroup.id);n||(n=yield t.addReleaseGroupByID(o.releaseGroup.id)),n&&!n.currentRelease&&(yield t.loadBestMatchingCurrentRelease(n))}})()}loadByRecordings(i){var t=this;return(0,h.A)(function*(){for(const o of i){if(t.shouldStop())return;if(o.releases)for(const n of o.releases){if(t.shouldStop())return;let s=t.matchTree.findReleaseGroup(n.releaseGroup.id);s||(s=yield t.addReleaseGroupByID(n.releaseGroup.id)),s&&!s.currentRelease&&(yield t.loadBestMatchingCurrentRelease(s))}}})()}runQuery(i,t){var o=this;return(0,h.A)(function*(){if(o.shouldStop())return;o.currentAction=i.name;const n=(yield o.jam.metadata.musicbrainzSearch(i.q)).data;if(n.releaseGroups?yield o.loadByReleaseGroups(n.releaseGroups):n.releases?yield o.loadByReleases(n.releases):n.recordings?yield o.loadByRecordings(n.recordings):console.error("TODO",n),o.matchTree.sort(),o.shouldStop())return;const s=t.shift();s&&(yield o.runQuery(s,t))})()}musicBrainzByQuickTags(){var i=this;return(0,h.A)(function*(){const t=i.buildQuickQueries(),o=t.shift();o&&(yield i.runQuery(o,t))})()}musicBrainzByTags(){var i=this;return(0,h.A)(function*(){const t=i.buildQueries(),o=t.shift();o&&(yield i.runQuery(o,t))})()}musicBrainzRefresh(){var i=this;return(0,h.A)(function*(){for(const t of i.matchings){if(i.shouldStop())return;if(t.track.tag){let o;if(t.track.tag.mbReleaseGroupID&&(o=yield i.addReleaseGroupByID(t.track.tag.mbReleaseGroupID)),!o&&t.track.tag.mbReleaseID&&(o=yield i.addReleaseGroupByReleaseID(t.track.tag.mbReleaseID)),o){if(t.track.tag.mbReleaseID){const n=o.findRelease(t.track.tag.mbReleaseID);n?yield i.loadRelease(n):console.error("Could not find the release with id",t.track.tag.mbReleaseID),o.currentRelease=n,o.enough(i.matchings.length)||(o.currentRelease=void 0)}o.currentRelease||(yield i.loadBestMatchingCurrentRelease(o))}}}})()}run(i){var t=this;return(0,h.A)(function*(){switch(i){case k.acoustID:yield t.acoustId();break;case k.musicbrainzByTags:if(yield t.musicBrainzByQuickTags(),t.shouldStop())return;yield t.musicBrainzByTags();break;case k.musicbrainzRefresh:yield t.musicBrainzRefresh();break;case k.auto:if(yield t.musicBrainzRefresh(),t.shouldStop()||(yield t.musicBrainzByQuickTags(),t.shouldStop())||(yield t.acoustId(),t.shouldStop()))return;yield t.musicBrainzByTags()}})()}}const ui=["actionMenu"];function pi(a,i){1&a&&(e.j41(0,"a",18),e.nrm(1,"i",26),e.qex(2),e.pXf(3,1),e.bVm(),e.k0s())}function gi(a,i){1&a&&(e.j41(0,"a",18),e.nrm(1,"i",27),e.qex(2),e.pXf(3,2),e.bVm(),e.k0s())}function mi(a,i){if(1&a){const t=e.RV6();e.j41(0,"app-match-results",28),e.bIt("chooseReleaseRequest",function(n){e.eBV(t);const s=e.XpG();return e.Njj(s.chooseRelease(n))}),e.k0s()}if(2&a){const t=e.XpG();e.Y8G("matcher",t.matcher)}}function hi(a,i){if(1&a&&(e.j41(0,"div",23),e.nrm(1,"i",29),e.EFF(2),e.k0s()),2&a){const t=e.XpG();e.R7$(2),e.SpI(" ",t.matcher.currentAction,"")}}function Ti(a,i){1&a&&(e.j41(0,"button",31),e.nrm(1,"i",29),e.k0s())}function Ci(a,i){if(1&a){const t=e.RV6();e.j41(0,"button",33),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2);return e.Njj(n.apply())}),e.pXf(1,4),e.k0s()}}function fi(a,i){if(1&a){const t=e.RV6();e.j41(0,"div",24)(1,"div",30),e.DNE(2,Ti,2,0,"button",31)(3,Ci,2,0,"button",31),e.j41(4,"button",32),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.stopApply())}),e.pXf(5,3),e.k0s()()()}if(2&a){const t=e.XpG();e.R7$(2),e.vxM(2,t.matcher.isRunning?2:-1),e.R7$(),e.vxM(3,t.matcher.isRunning?-1:3)}}function Mi(a,i){1&a&&e.pXf(0,5)}function Oi(a,i){1&a&&e.pXf(0,6)}function Ei(a,i){1&a&&e.pXf(0,7)}function Pi(a,i){1&a&&e.pXf(0,8)}function Si(a,i){if(1&a){const t=e.RV6();e.j41(0,"div")(1,"button",34),e.bIt("click",function(){e.eBV(t);const n=e.XpG(3);return e.Njj(n.matcher.start(n.RunType.auto))}),e.pXf(2,9),e.k0s(),e.j41(3,"button",35),e.bIt("click",function(n){e.eBV(t);const s=e.XpG(3);return e.Njj(s.onContextMenu(n))}),e.EFF(4,"\xa0\u2026\xa0"),e.k0s()()}}function Ri(a,i){if(1&a){const t=e.RV6();e.j41(0,"div")(1,"button",32),e.bIt("click",function(){e.eBV(t);const n=e.XpG(3);return e.Njj(n.matcher.stop())}),e.pXf(2,10),e.k0s()()}}function Ai(a,i){if(1&a&&(e.j41(0,"div",30),e.DNE(1,Si,5,0,"div")(2,Ri,3,0,"div"),e.k0s()),2&a){const t=e.XpG(2);e.R7$(),e.vxM(1,t.matcher.isRunning?-1:1),e.R7$(),e.vxM(2,t.matcher.isRunning?2:-1)}}function bi(a,i){if(1&a){const t=e.RV6();e.j41(0,"div")(1,"button",33),e.bIt("click",function(){e.eBV(t);const n=e.XpG(3);return e.Njj(n.matcher.manualSearch())}),e.pXf(2,13),e.k0s(),e.j41(3,"button",32),e.bIt("click",function(){e.eBV(t);const n=e.XpG(3);return e.Njj(n.matcher.clear())}),e.pXf(4,14),e.k0s(),e.j41(5,"button",32),e.bIt("click",function(){e.eBV(t);const n=e.XpG(3);return e.Njj(n.matcher.manual=!1)}),e.pXf(6,15),e.k0s()()}}function Ni(a,i){if(1&a){const t=e.RV6();e.j41(0,"div")(1,"button",32),e.bIt("click",function(){e.eBV(t);const n=e.XpG(3);return e.Njj(n.matcher.stop())}),e.pXf(2,16),e.k0s()()}}function vi(a,i){if(1&a){const t=e.RV6();e.j41(0,"div",30)(1,"div",36)(2,"div")(3,"div"),e.pXf(4,11),e.k0s(),e.j41(5,"app-tag-editor-autocomplete",37),e.mxI("valueChange",function(n){e.eBV(t);const s=e.XpG(2);return e.DH7(s.matcher.manualSearchData.releaseGroup,n)||(s.matcher.manualSearchData.releaseGroup=n),e.Njj(n)}),e.k0s()(),e.j41(6,"div")(7,"div"),e.pXf(8,12),e.k0s(),e.j41(9,"app-tag-editor-autocomplete",37),e.mxI("valueChange",function(n){e.eBV(t);const s=e.XpG(2);return e.DH7(s.matcher.manualSearchData.artist,n)||(s.matcher.manualSearchData.artist=n),e.Njj(n)}),e.k0s()()(),e.DNE(10,bi,7,0,"div")(11,Ni,3,0,"div"),e.k0s()}if(2&a){const t=e.XpG(2);e.R7$(5),e.Y8G("getList",t.matcher.manualSearchData.getAutoCompleteAlbumList)("standalone",!0),e.R50("value",t.matcher.manualSearchData.releaseGroup),e.R7$(4),e.Y8G("getList",t.matcher.manualSearchData.getAutoCompleteArtistList)("standalone",!0),e.R50("value",t.matcher.manualSearchData.artist),e.R7$(),e.vxM(10,t.matcher.isRunning?-1:10),e.R7$(),e.vxM(11,t.matcher.isRunning?11:-1)}}function Di(a,i){if(1&a&&(e.j41(0,"div",24),e.DNE(1,Ai,3,2,"div",30)(2,vi,12,8,"div",30),e.k0s()),2&a){const t=e.XpG();e.R7$(),e.vxM(1,t.matcher.manual?-1:1),e.R7$(),e.vxM(2,t.matcher.manual?2:-1)}}let ne=(()=>{class a{app;jam;notify;contextMenuService;data;rightActive=!0;matchApply;actionMenu;matcher;current;RunType=k;constructor(t,o,n,s){this.app=t,this.jam=o,this.notify=n,this.contextMenuService=s,this.matcher=new te(o,n)}ngOnChanges(){this.data?this.matcher.prepare(this.data.matchings.map(t=>({track:t.track})),this.data.folder):this.matcher.abort()}ngOnDestroy(){this.matcher.abort()}apply(){const t=this.matchApply.getGenres();for(const o of this.matcher.matchings)o.genres=t;if(this.data){const o=this.matchApply.getCoverArtImages();for(const n of this.data.matchings){const s=this.matcher.matchings.find(r=>r.track.id===n.track.id);n.rawTag=s?ii(s,t,o):void 0}this.data.apply&&this.data.apply(),this.data.close&&this.data.close()}}chooseRelease({group:t,release:o}){this.stopApply(),this.current={group:t,release:o},this.matchApply.coverArtSearch={mbReleaseID:o.mbRelease.id,mbReleaseGroupID:t.mbGroup.id},this.matcher.apply(t,o),this.data&&this.matchApply.loadGenres(this.data.matchings,t,o).catch(n=>{this.notify.error(n)})}stopApply(){this.current=void 0,this.matchApply.genres=void 0,this.matcher.stopApply()}loadLyricsRequest(){this.current&&this.matcher.loadLyrics(this.current.group.currentRelease)}loadMoodsRequest(){this.current&&this.matcher.loadMoods(this.current.group.currentRelease)}onContextMenu(t){this.contextMenuService.show.next({contextMenu:this.actionMenu,event:t,item:void 0}),t.preventDefault(),t.stopPropagation()}static \u0275fac=function(o){return new(o||a)(e.rXU(N.d3),e.rXU(f.UA),e.rXU(N.FL),e.rXU(z.Kf))};static \u0275cmp=e.VBU({type:a,selectors:[["app-match-release"]],viewQuery:function(o,n){if(1&o&&(e.GBs(ee,5),e.GBs(ui,5)),2&o){let s;e.mGM(s=e.lsd())&&(n.matchApply=s.first),e.mGM(s=e.lsd())&&(n.actionMenu=s.first)}},hostVars:2,hostBindings:function(o,n){2&o&&e.AVh("right-active",n.rightActive)},inputs:{data:"data"},features:[e.OA$],decls:16,vars:9,consts:()=>{let t,o,n,s,r,c,_,p,d,C,T,O,A,b,v,D;return t=$localize`:␟d8bda62007c2bacc6bd73d2797ba6fab5eb96daf␟1739704243369512276:Show Tracks`,o=$localize`:␟f1bca2b5b0d2d87b0641062e24bb678109d06c8d␟1818664258537534853:Show Matchings`,n=$localize`:␟d7b35c384aecd25a516200d6921836374613dfe7␟2159130950882492111:Cancel`,s=$localize`:␟c2d0ac9f528bbd5f53fd34269fde8b59e029621b␟4391289919356861627:Apply`,r=$localize`:␟f8b6e885edfef63c69668c4d6a9580133a00ead7␟3795661313994709664:Manual Search with MusicBrainz`,c=$localize`:␟be9ffa65590ff07f22e4cd0b96ba46657cd645d2␟6390950868913125525:Match with AcoustID`,_=$localize`:␟4eefd958f9ebadbe763175761b9e1f266f8867d4␟6034730998727247542:Match with MusicBrainz (Text)`,p=$localize`:␟c66e707e109490f913f700b7ca5d4eca128bc84c␟8911327935348537973:Match with MusicBrainz (Musicbrainz IDs)`,d=$localize`:␟bc7ebf67b7122e93bd293232982b1b45f3e5d8bc␟9028301309562848662:Auto Match`,C=$localize`:␟1d0d5c9a36e72bd9643ff1ede69736ae063d652b␟3133539296286953705:Stop`,T=$localize`:␟37a750182b4e4604bcc5c232d8c485c4721cd80d␟766537929493990192:Album Name`,O=$localize`:␟378660a509ecaa4d2dd3b4b0b8975760cfe3576d␟2492300395471245755:Artist`,A=$localize`:␟7e892ba15f2c6c17e83510e273b3e10fc32ea016␟4580988005648117665:Search`,b=$localize`:␟99ee4faa69cd2ea8e3678c1f557c0ff1f05aae46␟8700121026680200191:Clear`,v=$localize`:␟f4e529ae5ffd73001d1ff4bbdeeb0a72e342e5c8␟7819314041543176992:Close`,D=$localize`:␟1d0d5c9a36e72bd9643ff1ede69736ae063d652b␟3133539296286953705:Stop`,[["actionMenu",""],t,o,n,s,r,c,_,p,d,C,T,O,A,b,v,D,[1,"toggle",3,"click"],[1,"button-on-control"],[1,"content"],[1,"match-files",3,"matchings"],[1,"match-releases",3,"loadLyricsRequest","loadMoodsRequest","hidden","isRunning"],[1,"match-releases",3,"matcher"],[1,"current-log"],[1,"buttons"],["contextMenuItem","",3,"execute"],[1,"icon-left"],[1,"icon-right"],[1,"match-releases",3,"chooseReleaseRequest","matcher"],[1,"icon-spin","icon-spinner"],[1,"match-actions"],[1,"button-primary"],[1,"button-accent",3,"click"],[1,"button-primary",3,"click"],[1,"button-on-control","button-with-add-on",3,"click"],[1,"button-on-control","button-add-on",3,"click"],[1,"match-search"],[3,"valueChange","getList","standalone","value"]]},template:function(o,n){if(1&o){const s=e.RV6();e.j41(0,"div",17),e.bIt("click",function(){return e.eBV(s),e.Njj(n.rightActive=!n.rightActive)}),e.DNE(1,pi,4,0,"a",18)(2,gi,4,0,"a",18),e.k0s(),e.j41(3,"div",19),e.nrm(4,"app-match-file-list",20),e.j41(5,"app-match-apply",21),e.bIt("loadLyricsRequest",function(){return e.eBV(s),e.Njj(n.loadLyricsRequest())})("loadMoodsRequest",function(){return e.eBV(s),e.Njj(n.loadMoodsRequest())}),e.k0s(),e.DNE(6,mi,1,1,"app-match-results",22),e.k0s(),e.DNE(7,hi,3,1,"div",23)(8,fi,6,2,"div",24),e.j41(9,"context-menu",null,0),e.DNE(11,Mi,1,0,"ng-template",25),e.bIt("execute",function(){return e.eBV(s),e.Njj(n.matcher.setManualSearch())}),e.DNE(12,Oi,1,0,"ng-template",25),e.bIt("execute",function(){return e.eBV(s),e.Njj(n.matcher.start(n.RunType.acoustID))}),e.DNE(13,Ei,1,0,"ng-template",25),e.bIt("execute",function(){return e.eBV(s),e.Njj(n.matcher.start(n.RunType.musicbrainzByTags))}),e.DNE(14,Pi,1,0,"ng-template",25),e.bIt("execute",function(){return e.eBV(s),e.Njj(n.matcher.start(n.RunType.musicbrainzRefresh))}),e.k0s(),e.DNE(15,Di,3,2,"div",24)}2&o&&(e.R7$(),e.vxM(1,n.rightActive?1:-1),e.R7$(),e.vxM(2,n.rightActive?-1:2),e.R7$(2),e.Y8G("matchings",n.matcher.matchings),e.R7$(),e.Y8G("hidden",!n.current)("isRunning",n.matcher.isRunning),e.R7$(),e.vxM(6,n.current?-1:6),e.R7$(),e.vxM(7,n.matcher.isRunning?7:-1),e.R7$(),e.vxM(8,n.current?8:-1),e.R7$(7),e.vxM(15,n.current?-1:15))},styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;width:100%;height:100%;overflow:hidden}[_nghost-%COMP%]   .toggle[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex:1 1 auto;overflow-y:auto}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]{overflow-y:auto;overflow-x:auto;display:block;height:100%;width:50%;font-size:.8em;padding-right:15px}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-releases[_ngcontent-%COMP%]{border-left:1px solid var(--background-border);display:flex;flex-direction:column;flex:1 1 auto;width:50%;font-size:.9em}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-releases[hidden][_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .buttons[_ngcontent-%COMP%]{flex:0 0 auto;padding:5px;display:flex;align-items:center;justify-content:center;border-top:1px solid var(--background-border)}[_nghost-%COMP%]   .buttons[_ngcontent-%COMP%]   .match-actions[_ngcontent-%COMP%]{text-align:center;vertical-align:middle;margin-top:10px;margin-bottom:30px}[_nghost-%COMP%]   .buttons[_ngcontent-%COMP%]   .match-actions[_ngcontent-%COMP%]   app-tag-editor-autocomplete[_ngcontent-%COMP%]{height:28px;display:block}[_nghost-%COMP%]   .buttons[_ngcontent-%COMP%]   .match-actions[_ngcontent-%COMP%]   .match-search[_ngcontent-%COMP%]{display:flex;flex-direction:row;text-align:left;margin-bottom:10px}@media (max-width: 768px){[_nghost-%COMP%]   .buttons[_ngcontent-%COMP%]   .match-actions[_ngcontent-%COMP%]   .match-search[_ngcontent-%COMP%]{flex-direction:column}}[_nghost-%COMP%]   .buttons[_ngcontent-%COMP%]   .match-actions[_ngcontent-%COMP%]   .match-search[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{flex:1;padding-left:10px;padding-right:10px}[_nghost-%COMP%]   .buttons[_ngcontent-%COMP%]   .match-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:10px;margin-right:10px}[_nghost-%COMP%]   .buttons[_ngcontent-%COMP%]   .match-actions[_ngcontent-%COMP%]   .match-progress[_ngcontent-%COMP%]{display:block;font-size:.9em}[_nghost-%COMP%]   .current-log[_ngcontent-%COMP%]{font-size:.8em;padding:5px}@media (max-width: 768px){[_nghost-%COMP%]   .toggle[_ngcontent-%COMP%]{display:block;position:relative;width:100%;height:auto;text-align:center;padding-top:5px;padding-bottom:5px}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]{overflow-y:auto}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]{height:auto;width:100%;overflow-y:inherit;display:block;padding-right:0}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-releases[_ngcontent-%COMP%]{height:auto;width:100%;display:none;border-left:none}.right-active[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-releases[_ngcontent-%COMP%]{display:block}.right-active[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .match-files[_ngcontent-%COMP%]{display:none}}"]})}return a})(),Ii=(()=>{class a{static \u0275fac=function(o){return new(o||a)};static \u0275mod=e.$C({type:a});static \u0275inj=e.G2t({imports:[y.MD,Xe.G,u.YN,oe.xv,z.rc,$e.E9,we.rL,wt]})}return a})();e.wjB(J,function(){return[ne]},[]),e.wjB(q,function(){return[K]},[]),e.wjB(ne,function(){return[Te.E,Ce.J,ve,De,ee,U]},[])}}]);